(function(){var commonjsGlobal=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function unwrapExports(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x["default"]:x}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}var riot_1=createCommonjsModule(function(module,exports){(function(global,factory){factory(exports)})(commonjsGlobal,function(exports){"use strict";var __TAGS_CACHE=[];var __TAG_IMPL={};var YIELD_TAG="yield";var GLOBAL_MIXIN="__global_mixin";var ATTRS_PREFIX="riot-";var REF_DIRECTIVES=["ref","data-ref"];var IS_DIRECTIVE="data-is";var CONDITIONAL_DIRECTIVE="if";var LOOP_DIRECTIVE="each";var LOOP_NO_REORDER_DIRECTIVE="no-reorder";var SHOW_DIRECTIVE="show";var HIDE_DIRECTIVE="hide";var KEY_DIRECTIVE="key";var RIOT_EVENTS_KEY="__riot-events__";var T_STRING="string";var T_OBJECT="object";var T_UNDEF="undefined";var T_FUNCTION="function";var XLINK_NS="http://www.w3.org/1999/xlink";var SVG_NS="http://www.w3.org/2000/svg";var XLINK_REGEX=/^xlink:(\w+)/;var WIN=typeof window===T_UNDEF?undefined:window;var RE_SPECIAL_TAGS=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/;var RE_SPECIAL_TAGS_NO_OPTION=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/;var RE_EVENTS_PREFIX=/^on/;var RE_HTML_ATTRS=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;var CASE_SENSITIVE_ATTRIBUTES={viewbox:"viewBox",preserveaspectratio:"preserveAspectRatio"};var RE_BOOL_ATTRS=/^(?:disabled|checked|readonly|required|allowfullscreen|auto(?:focus|play)|compact|controls|default|formnovalidate|hidden|ismap|itemscope|loop|multiple|muted|no(?:resize|shade|validate|wrap)?|open|reversed|seamless|selected|sortable|truespeed|typemustmatch)$/;var IE_VERSION=(WIN&&WIN.document||{}).documentMode|0;function $$(selector,ctx){return[].slice.call((ctx||document).querySelectorAll(selector))}function $(selector,ctx){return(ctx||document).querySelector(selector)}function createFrag(){return document.createDocumentFragment()}function createDOMPlaceholder(){return document.createTextNode("")}function isSvg(el){var owner=el.ownerSVGElement;return!!owner||owner===null}function mkEl(name){return name==="svg"?document.createElementNS(SVG_NS,name):document.createElement(name)}function setInnerHTML(container,html,isSvg){if(isSvg){var node=container.ownerDocument.importNode((new DOMParser).parseFromString('<svg xmlns="'+SVG_NS+'">'+html+"</svg>","application/xml").documentElement,true);container.appendChild(node)}else{container.innerHTML=html}}function toggleVisibility(dom,show){dom.style.display=show?"":"none";dom.hidden=show?false:true}function remAttr(dom,name){dom.removeAttribute(name)}function styleObjectToString(style){return Object.keys(style).reduce(function(acc,prop){return acc+" "+prop+": "+style[prop]+";"},"")}function getAttr(dom,name){return dom.getAttribute(name)}function setAttr(dom,name,val){var xlink=XLINK_REGEX.exec(name);if(xlink&&xlink[1]){dom.setAttributeNS(XLINK_NS,xlink[1],val)}else{dom.setAttribute(name,val)}}function safeInsert(root,curr,next){root.insertBefore(curr,next.parentNode&&next)}function walkAttrs(html,fn){if(!html){return}var m;while(m=RE_HTML_ATTRS.exec(html)){fn(m[1].toLowerCase(),m[2]||m[3]||m[4])}}function walkNodes(dom,fn,context){if(dom){var res=fn(dom,context);var next;if(res===false){return}dom=dom.firstChild;while(dom){next=dom.nextSibling;walkNodes(dom,fn,res);dom=next}}}var dom=Object.freeze({$$:$$,$:$,createFrag:createFrag,createDOMPlaceholder:createDOMPlaceholder,isSvg:isSvg,mkEl:mkEl,setInnerHTML:setInnerHTML,toggleVisibility:toggleVisibility,remAttr:remAttr,styleObjectToString:styleObjectToString,getAttr:getAttr,setAttr:setAttr,safeInsert:safeInsert,walkAttrs:walkAttrs,walkNodes:walkNodes});var styleNode;var cssTextProp;var byName={};var remainder=[];var needsInject=false;if(WIN){styleNode=function(){var newNode=mkEl("style");var userNode=$("style[type=riot]");setAttr(newNode,"type","text/css");if(userNode){if(userNode.id){newNode.id=userNode.id}userNode.parentNode.replaceChild(newNode,userNode)}else{document.head.appendChild(newNode)}return newNode}();cssTextProp=styleNode.styleSheet}var styleManager={styleNode:styleNode,add:function add(css,name){if(name){byName[name]=css}else{remainder.push(css)}needsInject=true},inject:function inject(){if(!WIN||!needsInject){return}needsInject=false;var style=Object.keys(byName).map(function(k){return byName[k]}).concat(remainder).join("\n");if(cssTextProp){cssTextProp.cssText=style}else{styleNode.innerHTML=style}}};var skipRegex=function(){var beforeReChars="[{(,;:?=|&!^~>%*/";var beforeReWords=["case","default","do","else","in","instanceof","prefix","return","typeof","void","yield"];var wordsLastChar=beforeReWords.reduce(function(s,w){return s+w.slice(-1)},"");var RE_REGEX=/^\/(?=[^*>/])[^[/\\]*(?:(?:\\.|\[(?:\\.|[^\]\\]*)*\])[^[\\/]*)*?\/[gimuy]*/;var RE_VN_CHAR=/[$\w]/;function prev(code,pos){while(--pos>=0&&/\s/.test(code[pos])){}return pos}function _skipRegex(code,start){var re=/.*/g;var pos=re.lastIndex=start++;var match=re.exec(code)[0].match(RE_REGEX);if(match){var next=pos+match[0].length;pos=prev(code,pos);var c=code[pos];if(pos<0||~beforeReChars.indexOf(c)){return next}if(c==="."){if(code[pos-1]==="."){start=next}}else if(c==="+"||c==="-"){if(code[--pos]!==c||(pos=prev(code,pos))<0||!RE_VN_CHAR.test(code[pos])){start=next}}else if(~wordsLastChar.indexOf(c)){var end=pos+1;while(--pos>=0&&RE_VN_CHAR.test(code[pos])){}if(~beforeReWords.indexOf(code.slice(pos+1,end))){start=next}}}return start}return _skipRegex}();var brackets=function(UNDEF){var REGLOB="g",R_MLCOMMS=/\/\*[^*]*\*+(?:[^*\/][^*]*\*+)*\//g,R_STRINGS=/"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'|`[^`\\]*(?:\\[\S\s][^`\\]*)*`/g,S_QBLOCKS=R_STRINGS.source+"|"+/(?:\breturn\s+|(?:[$\w\)\]]|\+\+|--)\s*(\/)(?![*\/]))/.source+"|"+/\/(?=[^*\/])[^[\/\\]*(?:(?:\[(?:\\.|[^\]\\]*)*\]|\\.)[^[\/\\]*)*?([^<]\/)[gim]*/.source,UNSUPPORTED=RegExp("[\\"+"x00-\\x1F<>a-zA-Z0-9'\",;\\\\]"),NEED_ESCAPE=/(?=[[\]()*+?.^$|])/g,S_QBLOCK2=R_STRINGS.source+"|"+/(\/)(?![*\/])/.source,FINDBRACES={"(":RegExp("([()])|"+S_QBLOCK2,REGLOB),"[":RegExp("([[\\]])|"+S_QBLOCK2,REGLOB),"{":RegExp("([{}])|"+S_QBLOCK2,REGLOB)},DEFAULT="{ }";var _pairs=["{","}","{","}",/{[^}]*}/,/\\([{}])/g,/\\({)|{/g,RegExp("\\\\(})|([[({])|(})|"+S_QBLOCK2,REGLOB),DEFAULT,/^\s*{\^?\s*([$\w]+)(?:\s*,\s*(\S+))?\s+in\s+(\S.*)\s*}/,/(^|[^\\]){=[\S\s]*?}/];var cachedBrackets=UNDEF,_regex,_cache=[],_settings;function _loopback(re){return re}function _rewrite(re,bp){if(!bp){bp=_cache}return new RegExp(re.source.replace(/{/g,bp[2]).replace(/}/g,bp[3]),re.global?REGLOB:"")}function _create(pair){if(pair===DEFAULT){return _pairs}var arr=pair.split(" ");if(arr.length!==2||UNSUPPORTED.test(pair)){throw new Error('Unsupported brackets "'+pair+'"')}arr=arr.concat(pair.replace(NEED_ESCAPE,"\\").split(" "));arr[4]=_rewrite(arr[1].length>1?/{[\S\s]*?}/:_pairs[4],arr);arr[5]=_rewrite(pair.length>3?/\\({|})/g:_pairs[5],arr);arr[6]=_rewrite(_pairs[6],arr);arr[7]=RegExp("\\\\("+arr[3]+")|([[({])|("+arr[3]+")|"+S_QBLOCK2,REGLOB);arr[8]=pair;return arr}function _brackets(reOrIdx){return reOrIdx instanceof RegExp?_regex(reOrIdx):_cache[reOrIdx]}_brackets.split=function split(str,tmpl,_bp){if(!_bp){_bp=_cache}var parts=[],match,isexpr,start,pos,re=_bp[6];var qblocks=[];var prevStr="";var mark,lastIndex;isexpr=start=re.lastIndex=0;while(match=re.exec(str)){lastIndex=re.lastIndex;pos=match.index;if(isexpr){if(match[2]){var ch=match[2];var rech=FINDBRACES[ch];var ix=1;rech.lastIndex=lastIndex;while(match=rech.exec(str)){if(match[1]){if(match[1]===ch){++ix}else if(!--ix){break}}else{rech.lastIndex=pushQBlock(match.index,rech.lastIndex,match[2])}}re.lastIndex=ix?str.length:rech.lastIndex;continue}if(!match[3]){re.lastIndex=pushQBlock(pos,lastIndex,match[4]);continue}}if(!match[1]){unescapeStr(str.slice(start,pos));start=re.lastIndex;re=_bp[6+(isexpr^=1)];re.lastIndex=start}}if(str&&start<str.length){unescapeStr(str.slice(start))}parts.qblocks=qblocks;return parts;function unescapeStr(s){if(prevStr){s=prevStr+s;prevStr=""}if(tmpl||isexpr){parts.push(s&&s.replace(_bp[5],"$1"))}else{parts.push(s)}}function pushQBlock(_pos,_lastIndex,slash){if(slash){_lastIndex=skipRegex(str,_pos)}if(tmpl&&_lastIndex>_pos+2){mark="‚Åó"+qblocks.length+"~";qblocks.push(str.slice(_pos,_lastIndex));prevStr+=str.slice(start,_pos)+mark;start=_lastIndex}return _lastIndex}};_brackets.hasExpr=function hasExpr(str){return _cache[4].test(str)};_brackets.loopKeys=function loopKeys(expr){var m=expr.match(_cache[9]);return m?{key:m[1],pos:m[2],val:_cache[0]+m[3].trim()+_cache[1]}:{val:expr.trim()}};_brackets.array=function array(pair){return pair?_create(pair):_cache};function _reset(pair){if((pair||(pair=DEFAULT))!==_cache[8]){_cache=_create(pair);_regex=pair===DEFAULT?_loopback:_rewrite;_cache[9]=_regex(_pairs[9])}cachedBrackets=pair}function _setSettings(o){var b;o=o||{};b=o.brackets;Object.defineProperty(o,"brackets",{set:_reset,get:function(){return cachedBrackets},enumerable:true});_settings=o;_reset(b)}Object.defineProperty(_brackets,"settings",{set:_setSettings,get:function(){return _settings}});_brackets.settings=typeof riot!=="undefined"&&riot.settings||{};_brackets.set=_reset;_brackets.skipRegex=skipRegex;_brackets.R_STRINGS=R_STRINGS;_brackets.R_MLCOMMS=R_MLCOMMS;_brackets.S_QBLOCKS=S_QBLOCKS;_brackets.S_QBLOCK2=S_QBLOCK2;return _brackets}();var tmpl=function(){var _cache={};function _tmpl(str,data){if(!str){return str}return(_cache[str]||(_cache[str]=_create(str))).call(data,_logErr.bind({data:data,tmpl:str}))}_tmpl.hasExpr=brackets.hasExpr;_tmpl.loopKeys=brackets.loopKeys;_tmpl.clearCache=function(){_cache={}};_tmpl.errorHandler=null;function _logErr(err,ctx){err.riotData={tagName:ctx&&ctx.__&&ctx.__.tagName,_riot_id:ctx&&ctx._riot_id};if(_tmpl.errorHandler){_tmpl.errorHandler(err)}else if(typeof console!=="undefined"&&typeof console.error==="function"){console.error(err.message);console.log("<%s> %s",err.riotData.tagName||"Unknown tag",this.tmpl);console.log(this.data)}}function _create(str){var expr=_getTmpl(str);if(expr.slice(0,11)!=="try{return "){expr="return "+expr}return new Function("E",expr+";")}var RE_DQUOTE=/\u2057/g;var RE_QBMARK=/\u2057(\d+)~/g;function _getTmpl(str){var parts=brackets.split(str.replace(RE_DQUOTE,'"'),1);var qstr=parts.qblocks;var expr;if(parts.length>2||parts[0]){var i,j,list=[];for(i=j=0;i<parts.length;++i){expr=parts[i];if(expr&&(expr=i&1?_parseExpr(expr,1,qstr):'"'+expr.replace(/\\/g,"\\\\").replace(/\r\n?|\n/g,"\\n").replace(/"/g,'\\"')+'"')){list[j++]=expr}}expr=j<2?list[0]:"["+list.join(",")+'].join("")'}else{expr=_parseExpr(parts[1],0,qstr)}if(qstr.length){expr=expr.replace(RE_QBMARK,function(_,pos){return qstr[pos].replace(/\r/g,"\\r").replace(/\n/g,"\\n")})}return expr}var RE_CSNAME=/^(?:(-?[_A-Za-z\xA0-\xFF][-\w\xA0-\xFF]*)|\u2057(\d+)~):/;var RE_BREND={"(":/[()]/g,"[":/[[\]]/g,"{":/[{}]/g};function _parseExpr(expr,asText,qstr){expr=expr.replace(/\s+/g," ").trim().replace(/\ ?([[\({},?\.:])\ ?/g,"$1");if(expr){var list=[],cnt=0,match;while(expr&&(match=expr.match(RE_CSNAME))&&!match.index){var key,jsb,re=/,|([[{(])|$/g;expr=RegExp.rightContext;key=match[2]?qstr[match[2]].slice(1,-1).trim().replace(/\s+/g," "):match[1];while(jsb=(match=re.exec(expr))[1]){skipBraces(jsb,re)}jsb=expr.slice(0,match.index);expr=RegExp.rightContext;list[cnt++]=_wrapExpr(jsb,1,key)}expr=!cnt?_wrapExpr(expr,asText):cnt>1?"["+list.join(",")+'].join(" ").trim()':list[0]}return expr;function skipBraces(ch,re){var mm,lv=1,ir=RE_BREND[ch];ir.lastIndex=re.lastIndex;while(mm=ir.exec(expr)){if(mm[0]===ch){++lv}else if(!--lv){break}}re.lastIndex=lv?expr.length:ir.lastIndex}}var JS_CONTEXT='"in this?this:'+(typeof window!=="object"?"global":"window")+").",JS_VARNAME=/[,{][\$\w]+(?=:)|(^ *|[^$\w\.{])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\w]))([$_A-Za-z][$\w]*)/g,JS_NOPROPS=/^(?=(\.[$\w]+))\1(?:[^.[(]|$)/;function _wrapExpr(expr,asText,key){var tb;expr=expr.replace(JS_VARNAME,function(match,p,mvar,pos,s){if(mvar){pos=tb?0:pos+match.length;if(mvar!=="this"&&mvar!=="global"&&mvar!=="window"){match=p+'("'+mvar+JS_CONTEXT+mvar;if(pos){tb=(s=s[pos])==="."||s==="("||s==="["}}else if(pos){tb=!JS_NOPROPS.test(s.slice(pos))}}return match});if(tb){expr="try{return "+expr+"}catch(e){E(e,this)}"}if(key){expr=(tb?"function(){"+expr+"}.call(this)":"("+expr+")")+'?"'+key+'":""'}else if(asText){expr="function(v){"+(tb?expr.replace("return ","v="):"v=("+expr+")")+';return v||v===0?v:""}.call(this)'}return expr}_tmpl.version=brackets.version="v3.0.8";return _tmpl}();var observable$1=function(el){el=el||{};var callbacks={},slice=Array.prototype.slice;Object.defineProperties(el,{on:{value:function(event,fn){if(typeof fn=="function"){(callbacks[event]=callbacks[event]||[]).push(fn)}return el},enumerable:false,writable:false,configurable:false},off:{value:function(event,fn){if(event=="*"&&!fn){callbacks={}}else{if(fn){var arr=callbacks[event];for(var i=0,cb;cb=arr&&arr[i];++i){if(cb==fn){arr.splice(i--,1)}}}else{delete callbacks[event]}}return el},enumerable:false,writable:false,configurable:false},one:{value:function(event,fn){function on(){el.off(event,on);fn.apply(el,arguments)}return el.on(event,on)},enumerable:false,writable:false,configurable:false},trigger:{value:function(event){var arguments$1=arguments;var arglen=arguments.length-1,args=new Array(arglen),fns,fn,i;for(i=0;i<arglen;i++){args[i]=arguments$1[i+1]}fns=slice.call(callbacks[event]||[],0);for(i=0;fn=fns[i];++i){fn.apply(el,args)}if(callbacks["*"]&&event!="*"){el.trigger.apply(el,["*",event].concat(args))}return el},enumerable:false,writable:false,configurable:false}});return el};function isBoolAttr(value){return RE_BOOL_ATTRS.test(value)}function isFunction(value){return typeof value===T_FUNCTION}function isObject(value){return value&&typeof value===T_OBJECT}function isUndefined(value){return typeof value===T_UNDEF}function isString(value){return typeof value===T_STRING}function isBlank(value){return isNil(value)||value===""}function isNil(value){return isUndefined(value)||value===null}function isArray(value){return Array.isArray(value)||value instanceof Array}function isWritable(obj,key){var descriptor=getPropDescriptor(obj,key);return isUndefined(obj[key])||descriptor&&descriptor.writable}var check=Object.freeze({isBoolAttr:isBoolAttr,isFunction:isFunction,isObject:isObject,isUndefined:isUndefined,isString:isString,isBlank:isBlank,isNil:isNil,isArray:isArray,isWritable:isWritable});function each(list,fn){var len=list?list.length:0;var i=0;for(;i<len;i++){fn(list[i],i)}return list}function contains(array,item){return array.indexOf(item)!==-1}function toCamel(str){return str.replace(/-(\w)/g,function(_,c){return c.toUpperCase()})}function startsWith(str,value){return str.slice(0,value.length)===value}function defineProperty(el,key,value,options){Object.defineProperty(el,key,extend({value:value,enumerable:false,writable:false,configurable:true},options));return el}var uid=function(){var i=-1;return function(){return++i}}();var getPropDescriptor=function(o,k){return Object.getOwnPropertyDescriptor(o,k)};function extend(src){var obj;var i=1;var args=arguments;var l=args.length;for(;i<l;i++){if(obj=args[i]){for(var key in obj){if(isWritable(src,key)){src[key]=obj[key]}}}}return src}var misc=Object.freeze({each:each,contains:contains,toCamel:toCamel,startsWith:startsWith,defineProperty:defineProperty,uid:uid,getPropDescriptor:getPropDescriptor,extend:extend});var settings$1=extend(Object.create(brackets.settings),{skipAnonymousTags:true,autoUpdate:true});function handleEvent(dom,handler,e){var ptag=this.__.parent;var item=this.__.item;if(!item){while(ptag&&!item){item=ptag.__.item;ptag=ptag.__.parent}}if(isWritable(e,"currentTarget")){e.currentTarget=dom}if(isWritable(e,"target")){e.target=e.srcElement}if(isWritable(e,"which")){e.which=e.charCode||e.keyCode}e.item=item;handler.call(this,e);if(!settings$1.autoUpdate){return}if(!e.preventUpdate){var p=getImmediateCustomParentTag(this);if(p.isMounted){p.update()}}}function setEventHandler(name,handler,dom,tag){var eventName;var cb=handleEvent.bind(tag,dom,handler);dom[name]=null;eventName=name.replace(RE_EVENTS_PREFIX,"");if(!contains(tag.__.listeners,dom)){tag.__.listeners.push(dom)}if(!dom[RIOT_EVENTS_KEY]){dom[RIOT_EVENTS_KEY]={}}if(dom[RIOT_EVENTS_KEY][name]){dom.removeEventListener(eventName,dom[RIOT_EVENTS_KEY][name])}dom[RIOT_EVENTS_KEY][name]=cb;dom.addEventListener(eventName,cb,false)}function updateDataIs(expr,parent,tagName){var tag=expr.tag||expr.dom._tag;var ref;var ref$1=tag?tag.__:{};var head=ref$1.head;var isVirtual=expr.dom.tagName==="VIRTUAL";if(tag&&expr.tagName===tagName){tag.update();return}if(tag){if(isVirtual){ref=createDOMPlaceholder();head.parentNode.insertBefore(ref,head)}tag.unmount(true)}if(!isString(tagName)){return}expr.impl=__TAG_IMPL[tagName];if(!expr.impl){return}expr.tag=tag=initChildTag(expr.impl,{root:expr.dom,parent:parent,tagName:tagName},expr.dom.innerHTML,parent);each(expr.attrs,function(a){return setAttr(tag.root,a.name,a.value)});expr.tagName=tagName;tag.mount();if(isVirtual){makeReplaceVirtual(tag,ref||tag.root)}parent.__.onUnmount=function(){var delName=tag.opts.dataIs;arrayishRemove(tag.parent.tags,delName,tag);arrayishRemove(tag.__.parent.tags,delName,tag);tag.unmount()}}function normalizeAttrName(attrName){if(!attrName){return null}attrName=attrName.replace(ATTRS_PREFIX,"");if(CASE_SENSITIVE_ATTRIBUTES[attrName]){attrName=CASE_SENSITIVE_ATTRIBUTES[attrName]}return attrName}function updateExpression(expr){if(this.root&&getAttr(this.root,"virtualized")){return}var dom=expr.dom;var attrName=normalizeAttrName(expr.attr);var isToggle=contains([SHOW_DIRECTIVE,HIDE_DIRECTIVE],attrName);var isVirtual=expr.root&&expr.root.tagName==="VIRTUAL";var ref=this.__;var isAnonymous=ref.isAnonymous;var parent=dom&&(expr.parent||dom.parentNode);var isStyleAttr=attrName==="style";var isClassAttr=attrName==="class";var value;if(expr._riot_id){if(expr.__.wasCreated){expr.update()}else{expr.mount();if(isVirtual){makeReplaceVirtual(expr,expr.root)}}return}if(expr.update){return expr.update()}var context=isToggle&&!isAnonymous?inheritParentProps.call(this):this;value=tmpl(expr.expr,context);var hasValue=!isBlank(value);var isObj=isObject(value);if(isObj){if(isClassAttr){value=tmpl(JSON.stringify(value),this)}else if(isStyleAttr){value=styleObjectToString(value)}}if(expr.attr&&(!expr.wasParsedOnce||!hasValue||value===false)){remAttr(dom,getAttr(dom,expr.attr)?expr.attr:attrName)}if(expr.bool){value=value?attrName:false}if(expr.isRtag){return updateDataIs(expr,this,value)}if(expr.wasParsedOnce&&expr.value===value){return}expr.value=value;expr.wasParsedOnce=true;if(isObj&&!isClassAttr&&!isStyleAttr&&!isToggle){return}if(!hasValue){value=""}if(!attrName){value+="";if(parent){expr.parent=parent;if(parent.tagName==="TEXTAREA"){parent.value=value;if(!IE_VERSION){dom.nodeValue=value}}else{dom.nodeValue=value}}return}if(isFunction(value)){setEventHandler(attrName,value,dom,this)}else if(isToggle){toggleVisibility(dom,attrName===HIDE_DIRECTIVE?!value:value)}else{if(expr.bool){dom[attrName]=value}if(attrName==="value"&&dom.value!==value){dom.value=value}else if(hasValue&&value!==false){setAttr(dom,attrName,value)}if(isStyleAttr&&dom.hidden){toggleVisibility(dom,false)}}}function updateAllExpressions(expressions){each(expressions,updateExpression.bind(this))}var IfExpr={init:function init(dom,tag,expr){remAttr(dom,CONDITIONAL_DIRECTIVE);this.tag=tag;this.expr=expr;this.stub=createDOMPlaceholder();this.pristine=dom;var p=dom.parentNode;p.insertBefore(this.stub,dom);p.removeChild(dom);return this},update:function update(){this.value=tmpl(this.expr,this.tag);if(this.value&&!this.current){this.current=this.pristine.cloneNode(true);this.stub.parentNode.insertBefore(this.current,this.stub);this.expressions=parseExpressions.apply(this.tag,[this.current,true])}else if(!this.value&&this.current){unmountAll(this.expressions);if(this.current._tag){this.current._tag.unmount()}else if(this.current.parentNode){this.current.parentNode.removeChild(this.current)}this.current=null;this.expressions=[]}if(this.value){updateAllExpressions.call(this.tag,this.expressions)}},unmount:function unmount(){unmountAll(this.expressions||[])}};var RefExpr={init:function init(dom,parent,attrName,attrValue){this.dom=dom;this.attr=attrName;this.rawValue=attrValue;this.parent=parent;this.hasExp=tmpl.hasExpr(attrValue);return this},update:function update(){var old=this.value;var customParent=this.parent&&getImmediateCustomParentTag(this.parent);var tagOrDom=this.dom.__ref||this.tag||this.dom;this.value=this.hasExp?tmpl(this.rawValue,this.parent):this.rawValue;if(!isBlank(old)&&customParent){arrayishRemove(customParent.refs,old,tagOrDom)}if(!isBlank(this.value)&&isString(this.value)){if(customParent){arrayishAdd(customParent.refs,this.value,tagOrDom,null,this.parent.__.index)}if(this.value!==old){setAttr(this.dom,this.attr,this.value)}}else{remAttr(this.dom,this.attr)}if(!this.dom.__ref){this.dom.__ref=tagOrDom}},unmount:function unmount(){var tagOrDom=this.tag||this.dom;var customParent=this.parent&&getImmediateCustomParentTag(this.parent);if(!isBlank(this.value)&&customParent){arrayishRemove(customParent.refs,this.value,tagOrDom)}}};function mkitem(expr,key,val,base){var item=base?Object.create(base):{};item[expr.key]=key;if(expr.pos){item[expr.pos]=val}return item}function unmountRedundant(items,tags){var i=tags.length;var j=items.length;while(i>j){i--;remove.apply(tags[i],[tags,i])}}function remove(tags,i){tags.splice(i,1);this.unmount();arrayishRemove(this.parent,this,this.__.tagName,true)}function moveNestedTags(i){var this$1=this;each(Object.keys(this.tags),function(tagName){moveChildTag.apply(this$1.tags[tagName],[tagName,i])})}function move(root,nextTag,isVirtual){if(isVirtual){moveVirtual.apply(this,[root,nextTag])}else{safeInsert(root,this.root,nextTag.root)}}function insert(root,nextTag,isVirtual){if(isVirtual){makeVirtual.apply(this,[root,nextTag])}else{safeInsert(root,this.root,nextTag.root)}}function append(root,isVirtual){if(isVirtual){makeVirtual.call(this,root)}else{root.appendChild(this.root)}}function getItemId(keyAttr,originalItem,keyedItem,hasKeyAttrExpr){if(keyAttr){return hasKeyAttrExpr?tmpl(keyAttr,keyedItem):originalItem[keyAttr]}return originalItem}function _each(dom,parent,expr){var mustReorder=typeof getAttr(dom,LOOP_NO_REORDER_DIRECTIVE)!==T_STRING||remAttr(dom,LOOP_NO_REORDER_DIRECTIVE);var keyAttr=getAttr(dom,KEY_DIRECTIVE);var hasKeyAttrExpr=keyAttr?tmpl.hasExpr(keyAttr):false;var tagName=getTagName(dom);var impl=__TAG_IMPL[tagName];var parentNode=dom.parentNode;var placeholder=createDOMPlaceholder();var child=getTag(dom);var ifExpr=getAttr(dom,CONDITIONAL_DIRECTIVE);var tags=[];var isLoop=true;var innerHTML=dom.innerHTML;var isAnonymous=!__TAG_IMPL[tagName];var isVirtual=dom.tagName==="VIRTUAL";var oldItems=[];var hasKeys;remAttr(dom,LOOP_DIRECTIVE);remAttr(dom,KEY_DIRECTIVE);expr=tmpl.loopKeys(expr);expr.isLoop=true;if(ifExpr){remAttr(dom,CONDITIONAL_DIRECTIVE)}parentNode.insertBefore(placeholder,dom);parentNode.removeChild(dom);expr.update=function updateEach(){expr.value=tmpl(expr.val,parent);var items=expr.value;var frag=createFrag();var isObject$$1=!isArray(items)&&!isString(items);var root=placeholder.parentNode;var tmpItems=[];if(!root){return}if(isObject$$1){hasKeys=items||false;items=hasKeys?Object.keys(items).map(function(key){return mkitem(expr,items[key],key)}):[]}else{hasKeys=false}if(ifExpr){items=items.filter(function(item,i){if(expr.key&&!isObject$$1){return!!tmpl(ifExpr,mkitem(expr,item,i,parent))}return!!tmpl(ifExpr,extend(Object.create(parent),item))})}each(items,function(_item,i){var item=!hasKeys&&expr.key?mkitem(expr,_item,i):_item;var itemId=getItemId(keyAttr,_item,item,hasKeyAttrExpr);var doReorder=mustReorder&&typeof _item===T_OBJECT&&!hasKeys;var oldPos=oldItems.indexOf(itemId);var isNew=oldPos===-1;var pos=!isNew&&doReorder?oldPos:i;var tag=tags[pos];var mustAppend=i>=oldItems.length;var mustCreate=doReorder&&isNew||!doReorder&&!tag;if(mustCreate){tag=createTag(impl,{parent:parent,isLoop:isLoop,isAnonymous:isAnonymous,tagName:tagName,root:dom.cloneNode(isAnonymous),item:item,index:i},innerHTML);tag.mount();if(mustAppend){append.apply(tag,[frag||root,isVirtual])}else{insert.apply(tag,[root,tags[i],isVirtual])}if(!mustAppend){oldItems.splice(i,0,item)}tags.splice(i,0,tag);if(child){arrayishAdd(parent.tags,tagName,tag,true)}}else if(pos!==i&&doReorder){if(keyAttr||contains(items,oldItems[pos])){move.apply(tag,[root,tags[i],isVirtual]);tags.splice(i,0,tags.splice(pos,1)[0]);oldItems.splice(i,0,oldItems.splice(pos,1)[0])}if(expr.pos){tag[expr.pos]=i}if(!child&&tag.tags){moveNestedTags.call(tag,i)}}tag.__.item=item;tag.__.index=i;tag.__.parent=parent;tmpItems[i]=itemId;if(!mustCreate){tag.update(item)}});unmountRedundant(items,tags);oldItems=tmpItems.slice();root.insertBefore(frag,placeholder)};expr.unmount=function(){each(tags,function(t){t.unmount()})};return expr}function parseExpressions(root,mustIncludeRoot){var this$1=this;var expressions=[];walkNodes(root,function(dom){var type=dom.nodeType;var attr;var tagImpl;if(!mustIncludeRoot&&dom===root){return}if(type===3&&dom.parentNode.tagName!=="STYLE"&&tmpl.hasExpr(dom.nodeValue)){expressions.push({dom:dom,expr:dom.nodeValue})}if(type!==1){return}var isVirtual=dom.tagName==="VIRTUAL";if(attr=getAttr(dom,LOOP_DIRECTIVE)){if(isVirtual){setAttr(dom,"loopVirtual",true)}expressions.push(_each(dom,this$1,attr));return false}if(attr=getAttr(dom,CONDITIONAL_DIRECTIVE)){expressions.push(Object.create(IfExpr).init(dom,this$1,attr));return false}if(attr=getAttr(dom,IS_DIRECTIVE)){if(tmpl.hasExpr(attr)){expressions.push({isRtag:true,expr:attr,dom:dom,attrs:[].slice.call(dom.attributes)});return false}}tagImpl=getTag(dom);if(isVirtual){if(getAttr(dom,"virtualized")){dom.parentElement.removeChild(dom)}if(!tagImpl&&!getAttr(dom,"virtualized")&&!getAttr(dom,"loopVirtual")){tagImpl={tmpl:dom.outerHTML}}}if(tagImpl&&(dom!==root||mustIncludeRoot)){if(isVirtual&&!getAttr(dom,IS_DIRECTIVE)){setAttr(dom,"virtualized",true);var tag=createTag({tmpl:dom.outerHTML},{root:dom,parent:this$1},dom.innerHTML);expressions.push(tag)}else{expressions.push(initChildTag(tagImpl,{root:dom,parent:this$1},dom.innerHTML,this$1));return false}}parseAttributes.apply(this$1,[dom,dom.attributes,function(attr,expr){if(!expr){return}expressions.push(expr)}])});return expressions}function parseAttributes(dom,attrs,fn){var this$1=this;each(attrs,function(attr){if(!attr){return false}var name=attr.name;var bool=isBoolAttr(name);var expr;if(contains(REF_DIRECTIVES,name)&&dom.tagName.toLowerCase()!==YIELD_TAG){expr=Object.create(RefExpr).init(dom,this$1,name,attr.value)}else if(tmpl.hasExpr(attr.value)){expr={dom:dom,expr:attr.value,attr:name,bool:bool}}fn(attr,expr)})}var reHasYield=/<yield\b/i;var reYieldAll=/<yield\s*(?:\/>|>([\S\s]*?)<\/yield\s*>|>)/gi;var reYieldSrc=/<yield\s+to=['"]([^'">]*)['"]\s*>([\S\s]*?)<\/yield\s*>/gi;var reYieldDest=/<yield\s+from=['"]?([-\w]+)['"]?\s*(?:\/>|>([\S\s]*?)<\/yield\s*>)/gi;var rootEls={tr:"tbody",th:"tr",td:"tr",col:"colgroup"};var tblTags=IE_VERSION&&IE_VERSION<10?RE_SPECIAL_TAGS:RE_SPECIAL_TAGS_NO_OPTION;var GENERIC="div";var SVG="svg";function specialTags(el,tmpl,tagName){var select=tagName[0]==="o",parent=select?"select>":"table>";el.innerHTML="<"+parent+tmpl.trim()+"</"+parent;parent=el.firstChild;if(select){parent.selectedIndex=-1}else{var tname=rootEls[tagName];if(tname&&parent.childElementCount===1){parent=$(tname,parent)}}return parent}function replaceYield(tmpl,html){if(!reHasYield.test(tmpl)){return tmpl}var src={};html=html&&html.replace(reYieldSrc,function(_,ref,text){src[ref]=src[ref]||text;return""}).trim();return tmpl.replace(reYieldDest,function(_,ref,def){return src[ref]||def||""}).replace(reYieldAll,function(_,def){return html||def||""})}function mkdom(tmpl,html,isSvg$$1){var match=tmpl&&tmpl.match(/^\s*<([-\w]+)/);var tagName=match&&match[1].toLowerCase();var el=mkEl(isSvg$$1?SVG:GENERIC);tmpl=replaceYield(tmpl,html);if(tblTags.test(tagName)){el=specialTags(el,tmpl,tagName)}else{setInnerHTML(el,tmpl,isSvg$$1)}return el}function Tag$1(el,opts){var ref=this;var name=ref.name;var tmpl=ref.tmpl;var css=ref.css;var attrs=ref.attrs;var onCreate=ref.onCreate;if(!__TAG_IMPL[name]){tag$1(name,tmpl,css,attrs,onCreate);__TAG_IMPL[name].class=this.constructor}mountTo(el,name,opts,this);if(css){styleManager.inject()}return this}function tag$1(name,tmpl,css,attrs,fn){if(isFunction(attrs)){fn=attrs;if(/^[\w-]+\s?=/.test(css)){attrs=css;css=""}else{attrs=""}}if(css){if(isFunction(css)){fn=css}else{styleManager.add(css)}}name=name.toLowerCase();__TAG_IMPL[name]={name:name,tmpl:tmpl,attrs:attrs,fn:fn};return name}function tag2$1(name,tmpl,css,attrs,fn){if(css){styleManager.add(css,name)}__TAG_IMPL[name]={name:name,tmpl:tmpl,attrs:attrs,fn:fn};return name}function mount$1(selector,tagName,opts){var tags=[];var elem,allTags;function pushTagsTo(root){if(root.tagName){var riotTag=getAttr(root,IS_DIRECTIVE),tag;if(tagName&&riotTag!==tagName){riotTag=tagName;setAttr(root,IS_DIRECTIVE,tagName)}tag=mountTo(root,riotTag||root.tagName.toLowerCase(),opts);if(tag){tags.push(tag)}}else if(root.length){each(root,pushTagsTo)}}styleManager.inject();if(isObject(tagName)){opts=tagName;tagName=0}if(isString(selector)){selector=selector==="*"?allTags=selectTags():selector+selectTags(selector.split(/, */));elem=selector?$$(selector):[]}else{elem=selector}if(tagName==="*"){tagName=allTags||selectTags();if(elem.tagName){elem=$$(tagName,elem)}else{var nodeList=[];each(elem,function(_el){return nodeList.push($$(tagName,_el))});elem=nodeList}tagName=0}pushTagsTo(elem);return tags}var mixins={};var globals=mixins[GLOBAL_MIXIN]={};var mixins_id=0;function mixin$1(name,mix,g){if(isObject(name)){mixin$1("__"+mixins_id+++"__",name,true);return}var store=g?globals:mixins;if(!mix){if(isUndefined(store[name])){throw new Error("Unregistered mixin: "+name)}return store[name]}store[name]=isFunction(mix)?extend(mix.prototype,store[name]||{})&&mix:extend(store[name]||{},mix)}function update$1(){return each(__TAGS_CACHE,function(tag){return tag.update()})}function unregister$1(name){__TAG_IMPL[name]=null}var version$1="v3.7.4";var core=Object.freeze({Tag:Tag$1,tag:tag$1,tag2:tag2$1,mount:mount$1,mixin:mixin$1,update:update$1,unregister:unregister$1,version:version$1});function updateOpts(isLoop,parent,isAnonymous,opts,instAttrs){if(isLoop&&isAnonymous){return}var ctx=isLoop?inheritParentProps.call(this):parent||this;each(instAttrs,function(attr){if(attr.expr){updateExpression.call(ctx,attr.expr)}opts[toCamel(attr.name).replace(ATTRS_PREFIX,"")]=attr.expr?attr.expr.value:attr.value})}function setMountState(value){var ref=this.__;var isAnonymous=ref.isAnonymous;defineProperty(this,"isMounted",value);if(!isAnonymous){if(value){this.trigger("mount")}else{this.trigger("unmount");this.off("*");this.__.wasCreated=false}}}function createTag(impl,conf,innerHTML){if(impl===void 0){impl={}}if(conf===void 0){conf={}}var tag=conf.context||{};var opts=extend({},conf.opts);var parent=conf.parent;var isLoop=conf.isLoop;var isAnonymous=!!conf.isAnonymous;var skipAnonymous=settings$1.skipAnonymousTags&&isAnonymous;var item=conf.item;var index=conf.index;var instAttrs=[];var implAttrs=[];var expressions=[];var root=conf.root;var tagName=conf.tagName||getTagName(root);var isVirtual=tagName==="virtual";var isInline=!isVirtual&&!impl.tmpl;var dom;if(!skipAnonymous){observable$1(tag)}if(impl.name&&root._tag){root._tag.unmount(true)}defineProperty(tag,"isMounted",false);defineProperty(tag,"__",{isAnonymous:isAnonymous,instAttrs:instAttrs,innerHTML:innerHTML,tagName:tagName,index:index,isLoop:isLoop,isInline:isInline,listeners:[],virts:[],wasCreated:false,tail:null,head:null,parent:null,item:null});defineProperty(tag,"_riot_id",uid());defineProperty(tag,"root",root);extend(tag,{opts:opts},item);defineProperty(tag,"parent",parent||null);defineProperty(tag,"tags",{});defineProperty(tag,"refs",{});if(isInline||isLoop&&isAnonymous){dom=root}else{if(!isVirtual){root.innerHTML=""}dom=mkdom(impl.tmpl,innerHTML,isSvg(root))}defineProperty(tag,"update",function tagUpdate(data){var nextOpts={};var canTrigger=tag.isMounted&&!skipAnonymous;if(isAnonymous&&parent){extend(tag,parent)}extend(tag,data);updateOpts.apply(tag,[isLoop,parent,isAnonymous,nextOpts,instAttrs]);if(canTrigger&&tag.isMounted&&isFunction(tag.shouldUpdate)&&!tag.shouldUpdate(data,nextOpts)){return tag}extend(opts,nextOpts);if(canTrigger){tag.trigger("update",data)}updateAllExpressions.call(tag,expressions);if(canTrigger){tag.trigger("updated")}return tag});defineProperty(tag,"mixin",function tagMixin(){each(arguments,function(mix){var instance;var obj;var props=[];var propsBlacklist=["init","__proto__"];mix=isString(mix)?mixin$1(mix):mix;if(isFunction(mix)){instance=new mix}else{instance=mix}var proto=Object.getPrototypeOf(instance);do{props=props.concat(Object.getOwnPropertyNames(obj||instance))}while(obj=Object.getPrototypeOf(obj||instance));each(props,function(key){if(!contains(propsBlacklist,key)){var descriptor=getPropDescriptor(instance,key)||getPropDescriptor(proto,key);var hasGetterSetter=descriptor&&(descriptor.get||descriptor.set);if(!tag.hasOwnProperty(key)&&hasGetterSetter){Object.defineProperty(tag,key,descriptor)}else{tag[key]=isFunction(instance[key])?instance[key].bind(tag):instance[key]}}});if(instance.init){instance.init.bind(tag)(opts)}});return tag});defineProperty(tag,"mount",function tagMount(){root._tag=tag;parseAttributes.apply(parent,[root,root.attributes,function(attr,expr){if(!isAnonymous&&RefExpr.isPrototypeOf(expr)){expr.tag=tag}attr.expr=expr;instAttrs.push(attr)}]);walkAttrs(impl.attrs,function(k,v){implAttrs.push({name:k,value:v})});parseAttributes.apply(tag,[root,implAttrs,function(attr,expr){if(expr){expressions.push(expr)}else{setAttr(root,attr.name,attr.value)}}]);updateOpts.apply(tag,[isLoop,parent,isAnonymous,opts,instAttrs]);var globalMixin=mixin$1(GLOBAL_MIXIN);if(globalMixin&&!skipAnonymous){for(var i in globalMixin){if(globalMixin.hasOwnProperty(i)){tag.mixin(globalMixin[i])}}}if(impl.fn){impl.fn.call(tag,opts)}if(!skipAnonymous){tag.trigger("before-mount")}each(parseExpressions.apply(tag,[dom,isAnonymous]),function(e){return expressions.push(e)});tag.update(item);if(!isAnonymous&&!isInline){while(dom.firstChild){root.appendChild(dom.firstChild)}}defineProperty(tag,"root",root);if(!skipAnonymous&&tag.parent){var p=getImmediateCustomParentTag(tag.parent);p.one(!p.isMounted?"mount":"updated",function(){setMountState.call(tag,true)})}else{setMountState.call(tag,true)}tag.__.wasCreated=true;return tag});defineProperty(tag,"unmount",function tagUnmount(mustKeepRoot){var el=tag.root;var p=el.parentNode;var tagIndex=__TAGS_CACHE.indexOf(tag);if(!skipAnonymous){tag.trigger("before-unmount")}walkAttrs(impl.attrs,function(name){if(startsWith(name,ATTRS_PREFIX)){name=name.slice(ATTRS_PREFIX.length)}remAttr(root,name)});tag.__.listeners.forEach(function(dom){Object.keys(dom[RIOT_EVENTS_KEY]).forEach(function(eventName){dom.removeEventListener(eventName,dom[RIOT_EVENTS_KEY][eventName])})});if(tagIndex!==-1){__TAGS_CACHE.splice(tagIndex,1)}if(parent&&!isAnonymous){var ptag=getImmediateCustomParentTag(parent);if(isVirtual){Object.keys(tag.tags).forEach(function(tagName){return arrayishRemove(ptag.tags,tagName,tag.tags[tagName])})}else{arrayishRemove(ptag.tags,tagName,tag)}}if(tag.__.virts){each(tag.__.virts,function(v){if(v.parentNode){v.parentNode.removeChild(v)}})}unmountAll(expressions);each(instAttrs,function(a){return a.expr&&a.expr.unmount&&a.expr.unmount()});if(mustKeepRoot){setInnerHTML(el,"")}else if(p){p.removeChild(el)}if(tag.__.onUnmount){tag.__.onUnmount()}if(!tag.isMounted){setMountState.call(tag,true)}setMountState.call(tag,false);delete tag.root._tag;return tag});return tag}function getTag(dom){return dom.tagName&&__TAG_IMPL[getAttr(dom,IS_DIRECTIVE)||getAttr(dom,IS_DIRECTIVE)||dom.tagName.toLowerCase()]}function moveChildTag(tagName,newPos){var parent=this.parent;var tags;if(!parent){return}tags=parent.tags[tagName];if(isArray(tags)){tags.splice(newPos,0,tags.splice(tags.indexOf(this),1)[0])}else{arrayishAdd(parent.tags,tagName,this)}}function initChildTag(child,opts,innerHTML,parent){var tag=createTag(child,opts,innerHTML);var tagName=opts.tagName||getTagName(opts.root,true);var ptag=getImmediateCustomParentTag(parent);defineProperty(tag,"parent",ptag);tag.__.parent=parent;arrayishAdd(ptag.tags,tagName,tag);if(ptag!==parent){arrayishAdd(parent.tags,tagName,tag)}return tag}function getImmediateCustomParentTag(tag){var ptag=tag;while(ptag.__.isAnonymous){if(!ptag.parent){break}ptag=ptag.parent}return ptag}function unmountAll(expressions){each(expressions,function(expr){if(expr.unmount){expr.unmount(true)}else if(expr.tagName){expr.tag.unmount(true)}else if(expr.unmount){expr.unmount()}})}function getTagName(dom,skipDataIs){var child=getTag(dom);var namedTag=!skipDataIs&&getAttr(dom,IS_DIRECTIVE);return namedTag&&!tmpl.hasExpr(namedTag)?namedTag:child?child.name:dom.tagName.toLowerCase()}function arrayishAdd(obj,key,value,ensureArray,index){var dest=obj[key];var isArr=isArray(dest);var hasIndex=!isUndefined(index);if(dest&&dest===value){return}if(!dest&&ensureArray){obj[key]=[value]}else if(!dest){obj[key]=value}else{if(isArr){var oldIndex=dest.indexOf(value);if(oldIndex===index){return}if(oldIndex!==-1){dest.splice(oldIndex,1)}if(hasIndex){dest.splice(index,0,value)}else{dest.push(value)}}else{obj[key]=[dest,value]}}}function arrayishRemove(obj,key,value,ensureArray){if(isArray(obj[key])){var index=obj[key].indexOf(value);if(index!==-1){obj[key].splice(index,1)}if(!obj[key].length){delete obj[key]}else if(obj[key].length===1&&!ensureArray){obj[key]=obj[key][0]}}else if(obj[key]===value){delete obj[key]}}function mountTo(root,tagName,opts,ctx){var impl=__TAG_IMPL[tagName];var implClass=__TAG_IMPL[tagName].class;var context=ctx||(implClass?Object.create(implClass.prototype):{});var innerHTML=root._innerHTML=root._innerHTML||root.innerHTML;var conf=extend({root:root,opts:opts,context:context},{parent:opts?opts.parent:null});var tag;if(impl&&root){tag=createTag(impl,conf,innerHTML)}if(tag&&tag.mount){tag.mount(true);if(!contains(__TAGS_CACHE,tag)){__TAGS_CACHE.push(tag)}}return tag}function makeReplaceVirtual(tag,ref){var frag=createFrag();makeVirtual.call(tag,frag);ref.parentNode.replaceChild(frag,ref)}function makeVirtual(src,target){var this$1=this;var head=createDOMPlaceholder();var tail=createDOMPlaceholder();var frag=createFrag();var sib;var el;this.root.insertBefore(head,this.root.firstChild);this.root.appendChild(tail);this.__.head=el=head;this.__.tail=tail;while(el){sib=el.nextSibling;frag.appendChild(el);this$1.__.virts.push(el);el=sib}if(target){src.insertBefore(frag,target.__.head)}else{src.appendChild(frag)}}function inheritParentProps(){if(this.parent){return extend(Object.create(this),this.parent)}return this}function moveVirtual(src,target){var this$1=this;var el=this.__.head;var sib;var frag=createFrag();while(el){sib=el.nextSibling;frag.appendChild(el);el=sib;if(el===this$1.__.tail){frag.appendChild(el);src.insertBefore(frag,target.__.head);break}}}function selectTags(tags){if(!tags){var keys=Object.keys(__TAG_IMPL);return keys+selectTags(keys)}return tags.filter(function(t){return!/[^-\w]/.test(t)}).reduce(function(list,t){var name=t.trim().toLowerCase();return list+",["+IS_DIRECTIVE+'="'+name+'"]'},"")}var tags=Object.freeze({getTag:getTag,moveChildTag:moveChildTag,initChildTag:initChildTag,getImmediateCustomParentTag:getImmediateCustomParentTag,unmountAll:unmountAll,getTagName:getTagName,arrayishAdd:arrayishAdd,arrayishRemove:arrayishRemove,mountTo:mountTo,makeReplaceVirtual:makeReplaceVirtual,makeVirtual:makeVirtual,inheritParentProps:inheritParentProps,moveVirtual:moveVirtual,selectTags:selectTags});var settings=settings$1;var util={tmpl:tmpl,brackets:brackets,styleManager:styleManager,vdom:__TAGS_CACHE,styleNode:styleManager.styleNode,dom:dom,check:check,misc:misc,tags:tags};var Tag=Tag$1;var tag=tag$1;var tag2=tag2$1;var mount=mount$1;var mixin=mixin$1;var update=update$1;var unregister=unregister$1;var version=version$1;var observable=observable$1;var riot$1=extend({},core,{observable:observable$1,settings:settings,util:util});exports.settings=settings;exports.util=util;exports.Tag=Tag;exports.tag=tag;exports.tag2=tag2;exports.mount=mount;exports.mixin=mixin;exports.update=update;exports.unregister=unregister;exports.version=version;exports.observable=observable;exports["default"]=riot$1;Object.defineProperty(exports,"__esModule",{value:true})})});var riot$1=unwrapExports(riot_1);var _extends$1=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function _classCallCheck$1(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var consoleLogger={type:"logger",log:function log(args){this.output("log",args)},warn:function warn(args){this.output("warn",args)},error:function error(args){this.output("error",args)},output:function output(type,args){var _console;if(console&&console[type]){(_console=console)[type].apply(_console,_toConsumableArray(args))}}};var Logger=function(){function Logger(concreteLogger){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck$1(this,Logger);this.init(concreteLogger,options)}Logger.prototype.init=function init(concreteLogger){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.prefix=options.prefix||"i18next:";this.logger=concreteLogger||consoleLogger;this.options=options;this.debug=options.debug};Logger.prototype.setDebug=function setDebug(bool){this.debug=bool};Logger.prototype.log=function log(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return this.forward(args,"log","",true)};Logger.prototype.warn=function warn(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}return this.forward(args,"warn","",true)};Logger.prototype.error=function error(){for(var _len3=arguments.length,args=Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}return this.forward(args,"error","")};Logger.prototype.deprecate=function deprecate(){for(var _len4=arguments.length,args=Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}return this.forward(args,"warn","WARNING DEPRECATED: ",true)};Logger.prototype.forward=function forward(args,lvl,prefix,debugOnly){if(debugOnly&&!this.debug){return null}if(typeof args[0]==="string"){args[0]=""+prefix+this.prefix+" "+args[0]}return this.logger[lvl](args)};Logger.prototype.create=function create(moduleName){return new Logger(this.logger,_extends$1({prefix:this.prefix+":"+moduleName+":"},this.options))};return Logger}();var baseLogger=new Logger;function _classCallCheck$2(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EventEmitter=function(){function EventEmitter(){_classCallCheck$2(this,EventEmitter);this.observers={}}EventEmitter.prototype.on=function on(events,listener){var _this=this;events.split(" ").forEach(function(event){_this.observers[event]=_this.observers[event]||[];_this.observers[event].push(listener)})};EventEmitter.prototype.off=function off(event,listener){var _this2=this;if(!this.observers[event]){return}this.observers[event].forEach(function(){if(!listener){delete _this2.observers[event]}else{var index=_this2.observers[event].indexOf(listener);if(index>-1){_this2.observers[event].splice(index,1)}}})};EventEmitter.prototype.emit=function emit(event){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}if(this.observers[event]){var cloned=[].concat(this.observers[event]);cloned.forEach(function(observer){observer.apply(undefined,args)})}if(this.observers["*"]){var _cloned=[].concat(this.observers["*"]);_cloned.forEach(function(observer){var _ref;observer.apply(observer,(_ref=[event]).concat.apply(_ref,args))})}};return EventEmitter}();function makeString(object){if(object==null){return""}return""+object}function copy(a,s,t){a.forEach(function(m){if(s[m]){t[m]=s[m]}})}function getLastOfPath(object,path,Empty){function cleanKey(key){return key&&key.indexOf("###")>-1?key.replace(/###/g,"."):key}function canNotTraverseDeeper(){return!object||typeof object==="string"}var stack=typeof path!=="string"?[].concat(path):path.split(".");while(stack.length>1){if(canNotTraverseDeeper()){return{}}var key=cleanKey(stack.shift());if(!object[key]&&Empty){object[key]=new Empty}object=object[key]}if(canNotTraverseDeeper()){return{}}return{obj:object,k:cleanKey(stack.shift())}}function setPath(object,path,newValue){var _getLastOfPath=getLastOfPath(object,path,Object),obj=_getLastOfPath.obj,k=_getLastOfPath.k;obj[k]=newValue}function pushPath(object,path,newValue,concat){var _getLastOfPath2=getLastOfPath(object,path,Object),obj=_getLastOfPath2.obj,k=_getLastOfPath2.k;obj[k]=obj[k]||[];if(concat){obj[k]=obj[k].concat(newValue)}if(!concat){obj[k].push(newValue)}}function getPath(object,path){var _getLastOfPath3=getLastOfPath(object,path),obj=_getLastOfPath3.obj,k=_getLastOfPath3.k;if(!obj){return undefined}return obj[k]}function deepExtend(target,source,overwrite){for(var prop in source){if(prop in target){if(typeof target[prop]==="string"||target[prop]instanceof String||typeof source[prop]==="string"||source[prop]instanceof String){if(overwrite){target[prop]=source[prop]}}else{deepExtend(target[prop],source[prop],overwrite)}}else{target[prop]=source[prop]}}return target}function regexEscape(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escape$1(data){if(typeof data==="string"){return data.replace(/[&<>"'\/]/g,function(s){return _entityMap[s]})}return data}var _extends$2=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function _defaults$1(obj,defaults){var keys=Object.getOwnPropertyNames(defaults);for(var i=0;i<keys.length;i++){var key=keys[i];var value=Object.getOwnPropertyDescriptor(defaults,key);if(value&&value.configurable&&obj[key]===undefined){Object.defineProperty(obj,key,value)}}return obj}function _classCallCheck$3(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn$1(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits$1(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):_defaults$1(subClass,superClass)}}var ResourceStore=function(_EventEmitter){_inherits$1(ResourceStore,_EventEmitter);function ResourceStore(data){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{ns:["translation"],defaultNS:"translation"};_classCallCheck$3(this,ResourceStore);var _this=_possibleConstructorReturn$1(this,_EventEmitter.call(this));_this.data=data||{};_this.options=options;return _this}ResourceStore.prototype.addNamespaces=function addNamespaces(ns){if(this.options.ns.indexOf(ns)<0){this.options.ns.push(ns)}};ResourceStore.prototype.removeNamespaces=function removeNamespaces(ns){var index=this.options.ns.indexOf(ns);if(index>-1){this.options.ns.splice(index,1)}};ResourceStore.prototype.getResource=function getResource(lng,ns,key){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var keySeparator=options.keySeparator||this.options.keySeparator;if(keySeparator===undefined){keySeparator="."}var path=[lng,ns];if(key&&typeof key!=="string"){path=path.concat(key)}if(key&&typeof key==="string"){path=path.concat(keySeparator?key.split(keySeparator):key)}if(lng.indexOf(".")>-1){path=lng.split(".")}return getPath(this.data,path)};ResourceStore.prototype.addResource=function addResource(lng,ns,key,value){var options=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{silent:false};var keySeparator=this.options.keySeparator;if(keySeparator===undefined){keySeparator="."}var path=[lng,ns];if(key){path=path.concat(keySeparator?key.split(keySeparator):key)}if(lng.indexOf(".")>-1){path=lng.split(".");value=ns;ns=path[1]}this.addNamespaces(ns);setPath(this.data,path,value);if(!options.silent){this.emit("added",lng,ns,key,value)}};ResourceStore.prototype.addResources=function addResources(lng,ns,resources){for(var m in resources){if(typeof resources[m]==="string"){this.addResource(lng,ns,m,resources[m],{silent:true})}}this.emit("added",lng,ns,resources)};ResourceStore.prototype.addResourceBundle=function addResourceBundle(lng,ns,resources,deep,overwrite){var path=[lng,ns];if(lng.indexOf(".")>-1){path=lng.split(".");deep=resources;resources=ns;ns=path[1]}this.addNamespaces(ns);var pack=getPath(this.data,path)||{};if(deep){deepExtend(pack,resources,overwrite)}else{pack=_extends$2({},pack,resources)}setPath(this.data,path,pack);this.emit("added",lng,ns,resources)};ResourceStore.prototype.removeResourceBundle=function removeResourceBundle(lng,ns){if(this.hasResourceBundle(lng,ns)){delete this.data[lng][ns]}this.removeNamespaces(ns);this.emit("removed",lng,ns)};ResourceStore.prototype.hasResourceBundle=function hasResourceBundle(lng,ns){return this.getResource(lng,ns)!==undefined};ResourceStore.prototype.getResourceBundle=function getResourceBundle(lng,ns){if(!ns){ns=this.options.defaultNS}if(this.options.compatibilityAPI==="v1"){return _extends$2({},this.getResource(lng,ns))}return this.getResource(lng,ns)};ResourceStore.prototype.toJSON=function toJSON(){return this.data};return ResourceStore}(EventEmitter);var postProcessor={processors:{},addPostProcessor:function addPostProcessor(module){this.processors[module.name]=module},handle:function handle(processors,value,key,options,translator){var _this=this;processors.forEach(function(processor){if(_this.processors[processor]){value=_this.processors[processor].process(value,key,options,translator)}});return value}};var _extends$3=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _typeof$1=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _defaults$2(obj,defaults){var keys=Object.getOwnPropertyNames(defaults);for(var i=0;i<keys.length;i++){var key=keys[i];var value=Object.getOwnPropertyDescriptor(defaults,key);if(value&&value.configurable&&obj[key]===undefined){Object.defineProperty(obj,key,value)}}return obj}function _classCallCheck$4(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn$2(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits$2(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):_defaults$2(subClass,superClass)}}var Translator=function(_EventEmitter){_inherits$2(Translator,_EventEmitter);function Translator(services){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck$4(this,Translator);var _this=_possibleConstructorReturn$2(this,_EventEmitter.call(this));copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector"],services,_this);_this.options=options;_this.logger=baseLogger.create("translator");return _this}Translator.prototype.changeLanguage=function changeLanguage(lng){if(lng){this.language=lng}};Translator.prototype.exists=function exists(key){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{interpolation:{}};var resolved=this.resolve(key,options);return resolved&&resolved.res!==undefined};Translator.prototype.extractFromKey=function extractFromKey(key,options){var nsSeparator=options.nsSeparator||this.options.nsSeparator;if(nsSeparator===undefined){nsSeparator=":"}var keySeparator=options.keySeparator||this.options.keySeparator||".";var namespaces=options.ns||this.options.defaultNS;if(nsSeparator&&key.indexOf(nsSeparator)>-1){var parts=key.split(nsSeparator);if(nsSeparator!==keySeparator||nsSeparator===keySeparator&&this.options.ns.indexOf(parts[0])>-1){namespaces=parts.shift()}key=parts.join(keySeparator)}if(typeof namespaces==="string"){namespaces=[namespaces]}return{key:key,namespaces:namespaces}};Translator.prototype.translate=function translate(keys){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if((typeof options==="undefined"?"undefined":_typeof$1(options))!=="object"){options=this.options.overloadTranslationOptionHandler(arguments)}if(keys===undefined||keys===null||keys===""){return""}if(typeof keys==="number"){keys=String(keys)}if(typeof keys==="string"){keys=[keys]}var keySeparator=options.keySeparator||this.options.keySeparator||".";var _extractFromKey=this.extractFromKey(keys[keys.length-1],options),key=_extractFromKey.key,namespaces=_extractFromKey.namespaces;var namespace=namespaces[namespaces.length-1];var lng=options.lng||this.language;var appendNamespaceToCIMode=options.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(lng&&lng.toLowerCase()==="cimode"){if(appendNamespaceToCIMode){var nsSeparator=options.nsSeparator||this.options.nsSeparator;return namespace+nsSeparator+key}return key}var resolved=this.resolve(keys,options);var res=resolved&&resolved.res;var usedKey=resolved&&resolved.usedKey||key;var resType=Object.prototype.toString.apply(res);var noObject=["[object Number]","[object Function]","[object RegExp]"];var joinArrays=options.joinArrays!==undefined?options.joinArrays:this.options.joinArrays;if(res&&typeof res!=="string"&&noObject.indexOf(resType)<0&&!(joinArrays&&resType==="[object Array]")){if(!options.returnObjects&&!this.options.returnObjects){this.logger.warn("accessing an object - but returnObjects options is not enabled!");return this.options.returnedObjectHandler?this.options.returnedObjectHandler(usedKey,res,options):"key '"+key+" ("+this.language+")' returned an object instead of string."}if(options.keySeparator||this.options.keySeparator){var copy$$1=resType==="[object Array]"?[]:{};for(var m in res){if(Object.prototype.hasOwnProperty.call(res,m)){copy$$1[m]=this.translate(""+usedKey+keySeparator+m,_extends$3({},options,{joinArrays:false,ns:namespaces}))}}res=copy$$1}}else if(joinArrays&&resType==="[object Array]"){res=res.join(joinArrays);if(res){res=this.extendTranslation(res,keys,options)}}else{var usedDefault=false;var _usedKey=false;if(!this.isValidLookup(res)&&options.defaultValue!==undefined){usedDefault=true;res=options.defaultValue}if(!this.isValidLookup(res)){_usedKey=true;res=key}if(_usedKey||usedDefault){this.logger.log("missingKey",lng,namespace,key,res);var lngs=[];var fallbackLngs=this.languageUtils.getFallbackCodes(this.options.fallbackLng,options.lng||this.language);if(this.options.saveMissingTo==="fallback"&&fallbackLngs&&fallbackLngs[0]){for(var i=0;i<fallbackLngs.length;i++){lngs.push(fallbackLngs[i])}}else if(this.options.saveMissingTo==="all"){lngs=this.languageUtils.toResolveHierarchy(options.lng||this.language)}else{lngs.push(options.lng||this.language)}if(this.options.saveMissing){if(this.options.missingKeyHandler){this.options.missingKeyHandler(lngs,namespace,key,res)}else if(this.backendConnector&&this.backendConnector.saveMissing){this.backendConnector.saveMissing(lngs,namespace,key,res)}}this.emit("missingKey",lngs,namespace,key,res)}res=this.extendTranslation(res,keys,options);if(_usedKey&&res===key&&this.options.appendNamespaceToMissingKey){res=namespace+":"+key}if(_usedKey&&this.options.parseMissingKeyHandler){res=this.options.parseMissingKeyHandler(res)}}return res};Translator.prototype.extendTranslation=function extendTranslation(res,key,options){var _this2=this;if(options.interpolation){this.interpolator.init(_extends$3({},options,{interpolation:_extends$3({},this.options.interpolation,options.interpolation)}))}var data=options.replace&&typeof options.replace!=="string"?options.replace:options;if(this.options.interpolation.defaultVariables){data=_extends$3({},this.options.interpolation.defaultVariables,data)}res=this.interpolator.interpolate(res,data,options.lng||this.language);if(options.nest!==false){res=this.interpolator.nest(res,function(){return _this2.translate.apply(_this2,arguments)},options)}if(options.interpolation){this.interpolator.reset()}var postProcess=options.postProcess||this.options.postProcess;var postProcessorNames=typeof postProcess==="string"?[postProcess]:postProcess;if(res!==undefined&&postProcessorNames&&postProcessorNames.length&&options.applyPostProcessor!==false){res=postProcessor.handle(postProcessorNames,res,key,options,this)}return res};Translator.prototype.resolve=function resolve(keys){var _this3=this;var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var found=void 0;var usedKey=void 0;if(typeof keys==="string"){keys=[keys]}keys.forEach(function(k){if(_this3.isValidLookup(found)){return}var extracted=_this3.extractFromKey(k,options);var key=extracted.key;usedKey=key;var namespaces=extracted.namespaces;if(_this3.options.fallbackNS){namespaces=namespaces.concat(_this3.options.fallbackNS)}var needsPluralHandling=options.count!==undefined&&typeof options.count!=="string";var needsContextHandling=options.context!==undefined&&typeof options.context==="string"&&options.context!=="";var codes=options.lngs?options.lngs:_this3.languageUtils.toResolveHierarchy(options.lng||_this3.language);namespaces.forEach(function(ns){if(_this3.isValidLookup(found)){return}codes.forEach(function(code){if(_this3.isValidLookup(found)){return}var finalKey=key;var finalKeys=[finalKey];var pluralSuffix=void 0;if(needsPluralHandling){pluralSuffix=_this3.pluralResolver.getSuffix(code,options.count)}if(needsPluralHandling&&needsContextHandling){finalKeys.push(finalKey+pluralSuffix)}if(needsContextHandling){finalKeys.push(finalKey+=""+_this3.options.contextSeparator+options.context)}if(needsPluralHandling){finalKeys.push(finalKey+=pluralSuffix)}var possibleKey=void 0;while(possibleKey=finalKeys.pop()){if(!_this3.isValidLookup(found)){found=_this3.getResource(code,ns,possibleKey,options)}}})})});return{res:found,usedKey:usedKey}};Translator.prototype.isValidLookup=function isValidLookup(res){return res!==undefined&&!(!this.options.returnNull&&res===null)&&!(!this.options.returnEmptyString&&res==="")};Translator.prototype.getResource=function getResource(code,ns,key){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};return this.resourceStore.getResource(code,ns,key,options)};return Translator}(EventEmitter);function _classCallCheck$5(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function capitalize(string){return string.charAt(0).toUpperCase()+string.slice(1)}var LanguageUtil=function(){function LanguageUtil(options){_classCallCheck$5(this,LanguageUtil);this.options=options;this.whitelist=this.options.whitelist||false;this.logger=baseLogger.create("languageUtils")}LanguageUtil.prototype.getScriptPartFromCode=function getScriptPartFromCode(code){if(!code||code.indexOf("-")<0){return null}var p=code.split("-");if(p.length===2){return null}p.pop();return this.formatLanguageCode(p.join("-"))};LanguageUtil.prototype.getLanguagePartFromCode=function getLanguagePartFromCode(code){if(!code||code.indexOf("-")<0){return code}var p=code.split("-");return this.formatLanguageCode(p[0])};LanguageUtil.prototype.formatLanguageCode=function formatLanguageCode(code){if(typeof code==="string"&&code.indexOf("-")>-1){var specialCases=["hans","hant","latn","cyrl","cans","mong","arab"];var p=code.split("-");if(this.options.lowerCaseLng){p=p.map(function(part){return part.toLowerCase()})}else if(p.length===2){p[0]=p[0].toLowerCase();p[1]=p[1].toUpperCase();if(specialCases.indexOf(p[1].toLowerCase())>-1){p[1]=capitalize(p[1].toLowerCase())}}else if(p.length===3){p[0]=p[0].toLowerCase();if(p[1].length===2){p[1]=p[1].toUpperCase()}if(p[0]!=="sgn"&&p[2].length===2){p[2]=p[2].toUpperCase()}if(specialCases.indexOf(p[1].toLowerCase())>-1){p[1]=capitalize(p[1].toLowerCase())}if(specialCases.indexOf(p[2].toLowerCase())>-1){p[2]=capitalize(p[2].toLowerCase())}}return p.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?code.toLowerCase():code};LanguageUtil.prototype.isWhitelisted=function isWhitelisted(code){if(this.options.load==="languageOnly"||this.options.nonExplicitWhitelist){code=this.getLanguagePartFromCode(code)}return!this.whitelist||!this.whitelist.length||this.whitelist.indexOf(code)>-1};LanguageUtil.prototype.getFallbackCodes=function getFallbackCodes(fallbacks,code){if(!fallbacks){return[]}if(typeof fallbacks==="string"){fallbacks=[fallbacks]}if(Object.prototype.toString.apply(fallbacks)==="[object Array]"){return fallbacks}if(!code){return fallbacks.default||[]}var found=fallbacks[code];if(!found){found=fallbacks[this.getScriptPartFromCode(code)]}if(!found){found=fallbacks[this.formatLanguageCode(code)]}if(!found){found=fallbacks.default}return found||[]};LanguageUtil.prototype.toResolveHierarchy=function toResolveHierarchy(code,fallbackCode){var _this=this;var fallbackCodes=this.getFallbackCodes(fallbackCode||this.options.fallbackLng||[],code);var codes=[];var addCode=function addCode(c){if(!c){return}if(_this.isWhitelisted(c)){codes.push(c)}else{_this.logger.warn("rejecting non-whitelisted language code: "+c)}};if(typeof code==="string"&&code.indexOf("-")>-1){if(this.options.load!=="languageOnly"){addCode(this.formatLanguageCode(code))}if(this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"){addCode(this.getScriptPartFromCode(code))}if(this.options.load!=="currentOnly"){addCode(this.getLanguagePartFromCode(code))}}else if(typeof code==="string"){addCode(this.formatLanguageCode(code))}fallbackCodes.forEach(function(fc){if(codes.indexOf(fc)<0){addCode(_this.formatLanguageCode(fc))}});return codes};return LanguageUtil}();function _classCallCheck$6(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var sets=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","he","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21}];var _rulesPluralsTypes={1:function _(n){return Number(n>1)},2:function _(n){return Number(n!=1)},3:function _(n){return 0},4:function _(n){return Number(n%10==1&&n%100!=11?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2)},5:function _(n){return Number(n===0?0:n==1?1:n==2?2:n%100>=3&&n%100<=10?3:n%100>=11?4:5)},6:function _(n){return Number(n==1?0:n>=2&&n<=4?1:2)},7:function _(n){return Number(n==1?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2)},8:function _(n){return Number(n==1?0:n==2?1:n!=8&&n!=11?2:3)},9:function _(n){return Number(n>=2)},10:function _(n){return Number(n==1?0:n==2?1:n<7?2:n<11?3:4)},11:function _(n){return Number(n==1||n==11?0:n==2||n==12?1:n>2&&n<20?2:3)},12:function _(n){return Number(n%10!=1||n%100==11)},13:function _(n){return Number(n!==0)},14:function _(n){return Number(n==1?0:n==2?1:n==3?2:3)},15:function _(n){return Number(n%10==1&&n%100!=11?0:n%10>=2&&(n%100<10||n%100>=20)?1:2)},16:function _(n){return Number(n%10==1&&n%100!=11?0:n!==0?1:2)},17:function _(n){return Number(n==1||n%10==1?0:1)},18:function _(n){return Number(n==0?0:n==1?1:2)},19:function _(n){return Number(n==1?0:n===0||n%100>1&&n%100<11?1:n%100>10&&n%100<20?2:3)},20:function _(n){return Number(n==1?0:n===0||n%100>0&&n%100<20?1:2)},21:function _(n){return Number(n%100==1?1:n%100==2?2:n%100==3||n%100==4?3:0)}};function createRules(){var rules={};sets.forEach(function(set){set.lngs.forEach(function(l){rules[l]={numbers:set.nr,plurals:_rulesPluralsTypes[set.fc]}})});return rules}var PluralResolver=function(){function PluralResolver(languageUtils){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck$6(this,PluralResolver);this.languageUtils=languageUtils;this.options=options;this.logger=baseLogger.create("pluralResolver");this.rules=createRules()}PluralResolver.prototype.addRule=function addRule(lng,obj){this.rules[lng]=obj};PluralResolver.prototype.getRule=function getRule(code){return this.rules[code]||this.rules[this.languageUtils.getLanguagePartFromCode(code)]};PluralResolver.prototype.needsPlural=function needsPlural(code){var rule=this.getRule(code);return rule&&rule.numbers.length>1};PluralResolver.prototype.getSuffix=function getSuffix(code,count){var _this=this;var rule=this.getRule(code);if(rule){var idx=rule.noAbs?rule.plurals(count):rule.plurals(Math.abs(count));var suffix=rule.numbers[idx];if(this.options.simplifyPluralSuffix&&rule.numbers.length===2&&rule.numbers[0]===1){if(suffix===2){suffix="plural"}else if(suffix===1){suffix=""}}var returnSuffix=function returnSuffix(){return _this.options.prepend&&suffix.toString()?_this.options.prepend+suffix.toString():suffix.toString()};if(this.options.compatibilityJSON==="v1"){if(suffix===1){return""}if(typeof suffix==="number"){return"_plural_"+suffix.toString()}return returnSuffix()}else if(this.options.compatibilityJSON==="v2"||rule.numbers.length===2&&rule.numbers[0]===1){return returnSuffix()}else if(rule.numbers.length===2&&rule.numbers[0]===1){return returnSuffix()}return this.options.prepend&&idx.toString()?this.options.prepend+idx.toString():idx.toString()}this.logger.warn("no plural rule found for: "+code);return""};return PluralResolver}();var _extends$4=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function _classCallCheck$7(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Interpolator=function(){function Interpolator(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck$7(this,Interpolator);this.logger=baseLogger.create("interpolator");this.init(options,true)}Interpolator.prototype.init=function init(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var reset=arguments[1];if(reset){this.options=options;this.format=options.interpolation&&options.interpolation.format||function(value){return value};this.escape=options.interpolation&&options.interpolation.escape||escape$1}if(!options.interpolation){options.interpolation={escapeValue:true}}var iOpts=options.interpolation;this.escapeValue=iOpts.escapeValue!==undefined?iOpts.escapeValue:true;this.prefix=iOpts.prefix?regexEscape(iOpts.prefix):iOpts.prefixEscaped||"{{";this.suffix=iOpts.suffix?regexEscape(iOpts.suffix):iOpts.suffixEscaped||"}}";this.formatSeparator=iOpts.formatSeparator?iOpts.formatSeparator:iOpts.formatSeparator||",";this.unescapePrefix=iOpts.unescapeSuffix?"":iOpts.unescapePrefix||"-";this.unescapeSuffix=this.unescapePrefix?"":iOpts.unescapeSuffix||"";this.nestingPrefix=iOpts.nestingPrefix?regexEscape(iOpts.nestingPrefix):iOpts.nestingPrefixEscaped||regexEscape("$t(");this.nestingSuffix=iOpts.nestingSuffix?regexEscape(iOpts.nestingSuffix):iOpts.nestingSuffixEscaped||regexEscape(")");this.maxReplaces=iOpts.maxReplaces?iOpts.maxReplaces:1e3;this.resetRegExp()};Interpolator.prototype.reset=function reset(){if(this.options){this.init(this.options)}};Interpolator.prototype.resetRegExp=function resetRegExp(){var regexpStr=this.prefix+"(.+?)"+this.suffix;this.regexp=new RegExp(regexpStr,"g");var regexpUnescapeStr=""+this.prefix+this.unescapePrefix+"(.+?)"+this.unescapeSuffix+this.suffix;this.regexpUnescape=new RegExp(regexpUnescapeStr,"g");var nestingRegexpStr=this.nestingPrefix+"(.+?)"+this.nestingSuffix;this.nestingRegexp=new RegExp(nestingRegexpStr,"g")};Interpolator.prototype.interpolate=function interpolate(str,data,lng){var _this=this;var match=void 0;var value=void 0;var replaces=void 0;function regexSafe(val){return val.replace(/\$/g,"$$$$")}var handleFormat=function handleFormat(key){if(key.indexOf(_this.formatSeparator)<0){return getPath(data,key)}var p=key.split(_this.formatSeparator);var k=p.shift().trim();var f=p.join(_this.formatSeparator).trim();return _this.format(getPath(data,k),f,lng)};this.resetRegExp();replaces=0;while(match=this.regexpUnescape.exec(str)){value=handleFormat(match[1].trim());str=str.replace(match[0],value);this.regexpUnescape.lastIndex=0;replaces++;if(replaces>=this.maxReplaces){break}}replaces=0;while(match=this.regexp.exec(str)){value=handleFormat(match[1].trim());if(typeof value!=="string"){value=makeString(value)}if(!value){this.logger.warn("missed to pass in variable "+match[1]+" for interpolating "+str);value=""}value=this.escapeValue?regexSafe(this.escape(value)):regexSafe(value);str=str.replace(match[0],value);this.regexp.lastIndex=0;replaces++;if(replaces>=this.maxReplaces){break}}return str};Interpolator.prototype.nest=function nest(str,fc){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var match=void 0;var value=void 0;var clonedOptions=_extends$4({},options);clonedOptions.applyPostProcessor=false;function handleHasOptions(key){if(key.indexOf(",")<0){return key}var p=key.split(",");key=p.shift();var optionsString=p.join(",");optionsString=this.interpolate(optionsString,clonedOptions);optionsString=optionsString.replace(/'/g,'"');try{clonedOptions=JSON.parse(optionsString)}catch(e){this.logger.error("failed parsing options string in nesting for key "+key,e)}return key}while(match=this.nestingRegexp.exec(str)){value=fc(handleHasOptions.call(this,match[1].trim()),clonedOptions);if(value&&match[0]===str&&typeof value!=="string"){return value}if(typeof value!=="string"){value=makeString(value)}if(!value){this.logger.warn("missed to resolve "+match[1]+" for nesting "+str);value=""}str=str.replace(match[0],value);this.regexp.lastIndex=0}return str};return Interpolator}();var _extends$5=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i){break}}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]){_i["return"]()}}finally{if(_d){throw _e}}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();function _defaults$3(obj,defaults){var keys=Object.getOwnPropertyNames(defaults);for(var i=0;i<keys.length;i++){var key=keys[i];var value=Object.getOwnPropertyDescriptor(defaults,key);if(value&&value.configurable&&obj[key]===undefined){Object.defineProperty(obj,key,value)}}return obj}function _classCallCheck$8(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn$3(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits$3(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):_defaults$3(subClass,superClass)}}function remove(arr,what){var found=arr.indexOf(what);while(found!==-1){arr.splice(found,1);found=arr.indexOf(what)}}var Connector=function(_EventEmitter){_inherits$3(Connector,_EventEmitter);function Connector(backend,store,services){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck$8(this,Connector);var _this=_possibleConstructorReturn$3(this,_EventEmitter.call(this));_this.backend=backend;_this.store=store;_this.languageUtils=services.languageUtils;_this.options=options;_this.logger=baseLogger.create("backendConnector");_this.state={};_this.queue=[];if(_this.backend&&_this.backend.init){_this.backend.init(services,options.backend,options)}return _this}Connector.prototype.queueLoad=function queueLoad(languages,namespaces,callback){var _this2=this;var toLoad=[];var pending=[];var toLoadLanguages=[];var toLoadNamespaces=[];languages.forEach(function(lng){var hasAllNamespaces=true;namespaces.forEach(function(ns){var name=lng+"|"+ns;if(_this2.store.hasResourceBundle(lng,ns)){_this2.state[name]=2}else if(_this2.state[name]<0){}else if(_this2.state[name]===1){if(pending.indexOf(name)<0){pending.push(name)}}else{_this2.state[name]=1;hasAllNamespaces=false;if(pending.indexOf(name)<0){pending.push(name)}if(toLoad.indexOf(name)<0){toLoad.push(name)}if(toLoadNamespaces.indexOf(ns)<0){toLoadNamespaces.push(ns)}}});if(!hasAllNamespaces){toLoadLanguages.push(lng)}});if(toLoad.length||pending.length){this.queue.push({pending:pending,loaded:{},errors:[],callback:callback})}return{toLoad:toLoad,pending:pending,toLoadLanguages:toLoadLanguages,toLoadNamespaces:toLoadNamespaces}};Connector.prototype.loaded=function loaded(name,err,data){var _this3=this;var _name$split=name.split("|"),_name$split2=_slicedToArray(_name$split,2),lng=_name$split2[0],ns=_name$split2[1];if(err){this.emit("failedLoading",lng,ns,err)}if(data){this.store.addResourceBundle(lng,ns,data)}this.state[name]=err?-1:2;this.queue.forEach(function(q){pushPath(q.loaded,[lng],ns);remove(q.pending,name);if(err){q.errors.push(err)}if(q.pending.length===0&&!q.done){_this3.emit("loaded",q.loaded);q.done=true;if(q.errors.length){q.callback(q.errors)}else{q.callback()}}});this.queue=this.queue.filter(function(q){return!q.done})};Connector.prototype.read=function read(lng,ns,fcName){var tried=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var _this4=this;var wait=arguments.length>4&&arguments[4]!==undefined?arguments[4]:250;var callback=arguments[5];if(!lng.length){return callback(null,{})}return this.backend[fcName](lng,ns,function(err,data){if(err&&data&&tried<5){setTimeout(function(){_this4.read.call(_this4,lng,ns,fcName,tried+1,wait*2,callback)},wait);return}callback(err,data)})};Connector.prototype.load=function load(languages,namespaces,callback){var _this5=this;if(!this.backend){this.logger.warn("No backend was added via i18next.use. Will not load resources.");return callback&&callback()}var options=_extends$5({},this.backend.options,this.options.backend);if(typeof languages==="string"){languages=this.languageUtils.toResolveHierarchy(languages)}if(typeof namespaces==="string"){namespaces=[namespaces]}var toLoad=this.queueLoad(languages,namespaces,callback);if(!toLoad.toLoad.length){if(!toLoad.pending.length){callback()}return null}if(options.allowMultiLoading&&this.backend.readMulti){this.read(toLoad.toLoadLanguages,toLoad.toLoadNamespaces,"readMulti",null,null,function(err,data){if(err){_this5.logger.warn("loading namespaces "+toLoad.toLoadNamespaces.join(", ")+" for languages "+toLoad.toLoadLanguages.join(", ")+" via multiloading failed",err)}if(!err&&data){_this5.logger.log("successfully loaded namespaces "+toLoad.toLoadNamespaces.join(", ")+" for languages "+toLoad.toLoadLanguages.join(", ")+" via multiloading",data)}toLoad.toLoad.forEach(function(name){var _name$split3=name.split("|"),_name$split4=_slicedToArray(_name$split3,2),l=_name$split4[0],n=_name$split4[1];var bundle=getPath(data,[l,n]);if(bundle){_this5.loaded(name,err,bundle)}else{var error="loading namespace "+n+" for language "+l+" via multiloading failed";_this5.loaded(name,error);_this5.logger.error(error)}})})}else{toLoad.toLoad.forEach(function(name){_this5.loadOne(name)})}};Connector.prototype.reload=function reload(languages,namespaces){var _this6=this;if(!this.backend){this.logger.warn("No backend was added via i18next.use. Will not load resources.")}var options=_extends$5({},this.backend.options,this.options.backend);if(typeof languages==="string"){languages=this.languageUtils.toResolveHierarchy(languages)}if(typeof namespaces==="string"){namespaces=[namespaces]}if(options.allowMultiLoading&&this.backend.readMulti){this.read(languages,namespaces,"readMulti",null,null,function(err,data){if(err){_this6.logger.warn("reloading namespaces "+namespaces.join(", ")+" for languages "+languages.join(", ")+" via multiloading failed",err)}if(!err&&data){_this6.logger.log("successfully reloaded namespaces "+namespaces.join(", ")+" for languages "+languages.join(", ")+" via multiloading",data)}languages.forEach(function(l){namespaces.forEach(function(n){var bundle=getPath(data,[l,n]);if(bundle){_this6.loaded(l+"|"+n,err,bundle)}else{var error="reloading namespace "+n+" for language "+l+" via multiloading failed";_this6.loaded(l+"|"+n,error);_this6.logger.error(error)}})})})}else{languages.forEach(function(l){namespaces.forEach(function(n){_this6.loadOne(l+"|"+n,"re")})})}};Connector.prototype.loadOne=function loadOne(name){var _this7=this;var prefix=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var _name$split5=name.split("|"),_name$split6=_slicedToArray(_name$split5,2),lng=_name$split6[0],ns=_name$split6[1];this.read(lng,ns,"read",null,null,function(err,data){if(err){_this7.logger.warn(prefix+"loading namespace "+ns+" for language "+lng+" failed",err)}if(!err&&data){_this7.logger.log(prefix+"loaded namespace "+ns+" for language "+lng,data)}_this7.loaded(name,err,data)})};Connector.prototype.saveMissing=function saveMissing(languages,namespace,key,fallbackValue){if(this.backend&&this.backend.create){this.backend.create(languages,namespace,key,fallbackValue)}if(!languages||!languages[0]){return}this.store.addResource(languages[0],namespace,key,fallbackValue)};return Connector}(EventEmitter);var _extends$6=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function _defaults$4(obj,defaults){var keys=Object.getOwnPropertyNames(defaults);for(var i=0;i<keys.length;i++){var key=keys[i];var value=Object.getOwnPropertyDescriptor(defaults,key);if(value&&value.configurable&&obj[key]===undefined){Object.defineProperty(obj,key,value)}}return obj}function _classCallCheck$9(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn$4(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits$4(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):_defaults$4(subClass,superClass)}}var Connector$1=function(_EventEmitter){_inherits$4(Connector,_EventEmitter);function Connector(cache,store,services){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck$9(this,Connector);var _this=_possibleConstructorReturn$4(this,_EventEmitter.call(this));_this.cache=cache;_this.store=store;_this.services=services;_this.options=options;_this.logger=baseLogger.create("cacheConnector");if(_this.cache&&_this.cache.init){_this.cache.init(services,options.cache,options)}return _this}Connector.prototype.load=function load(languages,namespaces,callback){var _this2=this;if(!this.cache){return callback&&callback()}var options=_extends$6({},this.cache.options,this.options.cache);var loadLngs=typeof languages==="string"?this.services.languageUtils.toResolveHierarchy(languages):languages;if(options.enabled){this.cache.load(loadLngs,function(err,data){if(err){_this2.logger.error("loading languages "+loadLngs.join(", ")+" from cache failed",err)}if(data){for(var l in data){if(Object.prototype.hasOwnProperty.call(data,l)){for(var n in data[l]){if(Object.prototype.hasOwnProperty.call(data[l],n)){if(n!=="i18nStamp"){var bundle=data[l][n];if(bundle){_this2.store.addResourceBundle(l,n,bundle)}}}}}}}if(callback){callback()}})}else if(callback){callback()}};Connector.prototype.save=function save(){if(this.cache&&this.options.cache&&this.options.cache.enabled){this.cache.save(this.store.data)}};return Connector}(EventEmitter);function get(){return{debug:false,initImmediate:true,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:false,whitelist:false,nonExplicitWhitelist:false,load:"all",preload:false,simplifyPluralSuffix:true,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",saveMissing:false,saveMissingTo:"fallback",missingKeyHandler:false,postProcess:false,returnNull:true,returnEmptyString:true,returnObjects:false,joinArrays:false,returnedObjectHandler:function returnedObjectHandler(){},parseMissingKeyHandler:false,appendNamespaceToMissingKey:false,appendNamespaceToCIMode:false,overloadTranslationOptionHandler:function handle(args){return{defaultValue:args[1]}},interpolation:{escapeValue:true,format:function format(value,_format,lng){return value},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",maxReplaces:1e3}}}function transformOptions(options){if(typeof options.ns==="string"){options.ns=[options.ns]}if(typeof options.fallbackLng==="string"){options.fallbackLng=[options.fallbackLng]}if(typeof options.fallbackNS==="string"){options.fallbackNS=[options.fallbackNS]}if(options.whitelist&&options.whitelist.indexOf("cimode")<0){options.whitelist.push("cimode")}return options}var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function _defaults(obj,defaults){var keys=Object.getOwnPropertyNames(defaults);for(var i=0;i<keys.length;i++){var key=keys[i];var value=Object.getOwnPropertyDescriptor(defaults,key);if(value&&value.configurable&&obj[key]===undefined){Object.defineProperty(obj,key,value)}}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):_defaults(subClass,superClass)}}function noop(){}var I18n=function(_EventEmitter){_inherits(I18n,_EventEmitter);function I18n(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments[1];_classCallCheck(this,I18n);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));_this.options=transformOptions(options);_this.services={};_this.logger=baseLogger;_this.modules={external:[]};if(callback&&!_this.isInitialized&&!options.isClone){var _ret;if(!_this.options.initImmediate){return _ret=_this.init(options,callback),_possibleConstructorReturn(_this,_ret)}setTimeout(function(){_this.init(options,callback)},0)}return _this}I18n.prototype.init=function init(){var _this2=this;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments[1];if(typeof options==="function"){callback=options;options={}}this.options=_extends({},get(),this.options,transformOptions(options));this.format=this.options.interpolation.format;if(!callback){callback=noop}function createClassOnDemand(ClassOrObject){if(!ClassOrObject){return null}if(typeof ClassOrObject==="function"){return new ClassOrObject}return ClassOrObject}if(!this.options.isClone){if(this.modules.logger){baseLogger.init(createClassOnDemand(this.modules.logger),this.options)}else{baseLogger.init(null,this.options)}var lu=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);var s=this.services;s.logger=baseLogger;s.resourceStore=this.store;s.resourceStore.on("added removed",function(lng,ns){s.cacheConnector.save()});s.languageUtils=lu;s.pluralResolver=new PluralResolver(lu,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix});s.interpolator=new Interpolator(this.options);s.backendConnector=new Connector(createClassOnDemand(this.modules.backend),s.resourceStore,s,this.options);s.backendConnector.on("*",function(event){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}_this2.emit.apply(_this2,[event].concat(args))});s.backendConnector.on("loaded",function(loaded){s.cacheConnector.save()});s.cacheConnector=new Connector$1(createClassOnDemand(this.modules.cache),s.resourceStore,s,this.options);s.cacheConnector.on("*",function(event){for(var _len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){args[_key2-1]=arguments[_key2]}_this2.emit.apply(_this2,[event].concat(args))});if(this.modules.languageDetector){s.languageDetector=createClassOnDemand(this.modules.languageDetector);s.languageDetector.init(s,this.options.detection,this.options)}this.translator=new Translator(this.services,this.options);this.translator.on("*",function(event){for(var _len3=arguments.length,args=Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){args[_key3-1]=arguments[_key3]}_this2.emit.apply(_this2,[event].concat(args))});this.modules.external.forEach(function(m){if(m.init){m.init(_this2)}})}var storeApi=["getResource","addResource","addResources","addResourceBundle","removeResourceBundle","hasResourceBundle","getResourceBundle"];storeApi.forEach(function(fcName){_this2[fcName]=function(){var _store;return(_store=_this2.store)[fcName].apply(_store,arguments)}});var load=function load(){_this2.changeLanguage(_this2.options.lng,function(err,t){_this2.isInitialized=true;_this2.logger.log("initialized",_this2.options);_this2.emit("initialized",_this2.options);callback(err,t)})};if(this.options.resources||!this.options.initImmediate){load()}else{setTimeout(load,0)}return this};I18n.prototype.loadResources=function loadResources(){var _this3=this;var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:noop;if(!this.options.resources){if(this.language&&this.language.toLowerCase()==="cimode"){return callback()}var toLoad=[];var append=function append(lng){if(!lng){return}var lngs=_this3.services.languageUtils.toResolveHierarchy(lng);lngs.forEach(function(l){if(toLoad.indexOf(l)<0){toLoad.push(l)}})};if(!this.language){var fallbacks=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);fallbacks.forEach(function(l){return append(l)})}else{append(this.language)}if(this.options.preload){this.options.preload.forEach(function(l){return append(l)})}this.services.cacheConnector.load(toLoad,this.options.ns,function(){_this3.services.backendConnector.load(toLoad,_this3.options.ns,callback)})}else{callback(null)}};I18n.prototype.reloadResources=function reloadResources(lngs,ns){if(!lngs){lngs=this.languages}if(!ns){ns=this.options.ns}this.services.backendConnector.reload(lngs,ns)};I18n.prototype.use=function use(module){if(module.type==="backend"){this.modules.backend=module}if(module.type==="cache"){this.modules.cache=module}if(module.type==="logger"||module.log&&module.warn&&module.error){this.modules.logger=module}if(module.type==="languageDetector"){this.modules.languageDetector=module}if(module.type==="postProcessor"){postProcessor.addPostProcessor(module)}if(module.type==="3rdParty"){this.modules.external.push(module)}return this};I18n.prototype.changeLanguage=function changeLanguage(lng,callback){var _this4=this;var done=function done(err,l){_this4.translator.changeLanguage(l);if(l){_this4.emit("languageChanged",l);_this4.logger.log("languageChanged",l)}if(callback){callback(err,function(){return _this4.t.apply(_this4,arguments)})}};var setLng=function setLng(l){if(l){_this4.language=l;_this4.languages=_this4.services.languageUtils.toResolveHierarchy(l);if(_this4.services.languageDetector){_this4.services.languageDetector.cacheUserLanguage(l)}}_this4.loadResources(function(err){done(err,l)})};if(!lng&&this.services.languageDetector&&!this.services.languageDetector.async){setLng(this.services.languageDetector.detect())}else if(!lng&&this.services.languageDetector&&this.services.languageDetector.async){this.services.languageDetector.detect(setLng)}else{setLng(lng)}};I18n.prototype.getFixedT=function getFixedT(lng,ns){var _this5=this;var fixedT=function fixedT(key,opts){for(var _len4=arguments.length,rest=Array(_len4>2?_len4-2:0),_key4=2;_key4<_len4;_key4++){rest[_key4-2]=arguments[_key4]}var options=_extends({},opts);if((typeof opts==="undefined"?"undefined":_typeof(opts))!=="object"){options=_this5.options.overloadTranslationOptionHandler([key,opts].concat(rest))}options.lng=options.lng||fixedT.lng;options.lngs=options.lngs||fixedT.lngs;options.ns=options.ns||fixedT.ns;return _this5.t(key,options)};if(typeof lng==="string"){fixedT.lng=lng}else{fixedT.lngs=lng}fixedT.ns=ns;return fixedT};I18n.prototype.t=function t(){var _translator;return this.translator&&(_translator=this.translator).translate.apply(_translator,arguments)};I18n.prototype.exists=function exists(){var _translator2;return this.translator&&(_translator2=this.translator).exists.apply(_translator2,arguments)};I18n.prototype.setDefaultNamespace=function setDefaultNamespace(ns){this.options.defaultNS=ns};I18n.prototype.loadNamespaces=function loadNamespaces(ns,callback){var _this6=this;if(!this.options.ns){return callback&&callback()}if(typeof ns==="string"){ns=[ns]}ns.forEach(function(n){if(_this6.options.ns.indexOf(n)<0){_this6.options.ns.push(n)}});this.loadResources(callback)};I18n.prototype.loadLanguages=function loadLanguages(lngs,callback){if(typeof lngs==="string"){lngs=[lngs]}var preloaded=this.options.preload||[];var newLngs=lngs.filter(function(lng){return preloaded.indexOf(lng)<0});if(!newLngs.length){return callback()}this.options.preload=preloaded.concat(newLngs);this.loadResources(callback)};I18n.prototype.dir=function dir(lng){if(!lng){lng=this.languages&&this.languages.length>0?this.languages[0]:this.language}if(!lng){return"rtl"}var rtlLngs=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"];return rtlLngs.indexOf(this.services.languageUtils.getLanguagePartFromCode(lng))>=0?"rtl":"ltr"};I18n.prototype.createInstance=function createInstance(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments[1];return new I18n(options,callback)};I18n.prototype.cloneInstance=function cloneInstance(){var _this7=this;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:noop;var mergedOptions=_extends({},this.options,options,{isClone:true});var clone=new I18n(mergedOptions);var membersToCopy=["store","services","language"];membersToCopy.forEach(function(m){clone[m]=_this7[m]});clone.translator=new Translator(clone.services,clone.options);clone.translator.on("*",function(event){for(var _len5=arguments.length,args=Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++){args[_key5-1]=arguments[_key5]}clone.emit.apply(clone,[event].concat(args))});clone.init(mergedOptions,callback);clone.translator.options=clone.options;return clone};return I18n}(EventEmitter);var i18next$1=new I18n;var changeLanguage=i18next$1.changeLanguage.bind(i18next$1);var cloneInstance=i18next$1.cloneInstance.bind(i18next$1);var createInstance=i18next$1.createInstance.bind(i18next$1);var dir=i18next$1.dir.bind(i18next$1);var exists=i18next$1.exists.bind(i18next$1);var getFixedT=i18next$1.getFixedT.bind(i18next$1);var init=i18next$1.init.bind(i18next$1);var loadLanguages=i18next$1.loadLanguages.bind(i18next$1);var loadNamespaces=i18next$1.loadNamespaces.bind(i18next$1);var loadResources=i18next$1.loadResources.bind(i18next$1);var off=i18next$1.off.bind(i18next$1);var on=i18next$1.on.bind(i18next$1);var setDefaultNamespace=i18next$1.setDefaultNamespace.bind(i18next$1);var t=i18next$1.t.bind(i18next$1);var use=i18next$1.use.bind(i18next$1);var arr=[];var each=arr.forEach;var slice=arr.slice;function defaults(obj){each.call(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===undefined){obj[prop]=source[prop]}}}});return obj}var cookie={create:function create(name,value,minutes,domain){var expires=void 0;if(minutes){var date=new Date;date.setTime(date.getTime()+minutes*60*1e3);expires="; expires="+date.toGMTString()}else{expires=""}domain=domain?"domain="+domain+";":"";document.cookie=name+"="+value+expires+";"+domain+"path=/"},read:function read(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)===0){return c.substring(nameEQ.length,c.length)}}return null},remove:function remove(name){this.create(name,"",-1)}};var cookie$1={name:"cookie",lookup:function lookup(options){var found=void 0;if(options.lookupCookie&&typeof document!=="undefined"){var c=cookie.read(options.lookupCookie);if(c){found=c}}return found},cacheUserLanguage:function cacheUserLanguage(lng,options){if(options.lookupCookie&&typeof document!=="undefined"){cookie.create(options.lookupCookie,lng,options.cookieMinutes,options.cookieDomain)}}};var querystring={name:"querystring",lookup:function lookup(options){var found=void 0;if(typeof window!=="undefined"){var query=window.location.search.substring(1);var params=query.split("&");for(var i=0;i<params.length;i++){var pos=params[i].indexOf("=");if(pos>0){var key=params[i].substring(0,pos);if(key===options.lookupQuerystring){found=params[i].substring(pos+1)}}}}return found}};var hasLocalStorageSupport=void 0;try{hasLocalStorageSupport=window!=="undefined"&&window.localStorage!==null;var testKey="i18next.translate.boo";window.localStorage.setItem(testKey,"foo");window.localStorage.removeItem(testKey)}catch(e){hasLocalStorageSupport=false}var localStorage={name:"localStorage",lookup:function lookup(options){var found=void 0;if(options.lookupLocalStorage&&hasLocalStorageSupport){var lng=window.localStorage.getItem(options.lookupLocalStorage);if(lng){found=lng}}return found},cacheUserLanguage:function cacheUserLanguage(lng,options){if(options.lookupLocalStorage&&hasLocalStorageSupport){window.localStorage.setItem(options.lookupLocalStorage,lng)}}};var navigator$1={name:"navigator",lookup:function lookup(options){var found=[];if(typeof navigator!=="undefined"){if(navigator.languages){for(var i=0;i<navigator.languages.length;i++){found.push(navigator.languages[i])}}if(navigator.userLanguage){found.push(navigator.userLanguage)}if(navigator.language){found.push(navigator.language)}}return found.length>0?found:undefined}};var htmlTag={name:"htmlTag",lookup:function lookup(options){var found=void 0;var htmlTag=options.htmlTag||(typeof document!=="undefined"?document.documentElement:null);if(htmlTag&&typeof htmlTag.getAttribute==="function"){found=htmlTag.getAttribute("lang")}return found}};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor){descriptor.writable=true}Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps){defineProperties(Constructor.prototype,protoProps)}if(staticProps){defineProperties(Constructor,staticProps)}return Constructor}}();function _classCallCheck$10(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function getDefaults(){return{order:["querystring","cookie","localStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}}var Browser=function(){function Browser(services){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck$10(this,Browser);this.type="languageDetector";this.detectors={};this.init(services,options)}_createClass(Browser,[{key:"init",value:function init(services){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i18nOptions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};this.services=services;this.options=defaults(options,this.options||{},getDefaults());this.i18nOptions=i18nOptions;this.addDetector(cookie$1);this.addDetector(querystring);this.addDetector(localStorage);this.addDetector(navigator$1);this.addDetector(htmlTag)}},{key:"addDetector",value:function addDetector(detector){this.detectors[detector.name]=detector}},{key:"detect",value:function detect(detectionOrder){var _this=this;if(!detectionOrder){detectionOrder=this.options.order}var detected=[];detectionOrder.forEach(function(detectorName){if(_this.detectors[detectorName]){var lookup=_this.detectors[detectorName].lookup(_this.options);if(lookup&&typeof lookup==="string"){lookup=[lookup]}if(lookup){detected=detected.concat(lookup)}}});var found=void 0;detected.forEach(function(lng){if(found){return}var cleanedLng=_this.services.languageUtils.formatLanguageCode(lng);if(_this.services.languageUtils.isWhitelisted(cleanedLng)){found=cleanedLng}});return found||this.i18nOptions.fallbackLng[0]}},{key:"cacheUserLanguage",value:function cacheUserLanguage(lng,caches){var _this2=this;if(!caches){caches=this.options.caches}if(!caches){return}if(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(lng)>-1){return}caches.forEach(function(cacheName){if(_this2.detectors[cacheName]){_this2.detectors[cacheName].cacheUserLanguage(lng,_this2.options)}})}}]);return Browser}();Browser.type="languageDetector";var ja={word:{manage:"ÁÆ°ÁêÜÁîªÈù¢",dashboard:"„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ"}};var en={};var i18n={init:()=>{return new Promise((resolve,reject)=>{i18next$1.use(Browser).init({fallbackLng:"ja",resources:{ja:{translation:ja},en:{translation:en}}},err=>{if(err){reject(err);return}resolve()})})},get:()=>{return i18next$1}};const i18n$1=i18next$1;function append(arr1,arr2){if(arr2==null){return arr1}var pad=arr1.length,i=-1,len=arr2.length;while(++i<len){arr1[pad+i]=arr2[i]}return arr1}var append_1=append;function identity(val){return val}var identity_1=identity;function prop(name){return function(obj){return obj[name]}}var prop_1=prop;function hasOwn(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var hasOwn_1=hasOwn;var _hasDontEnumBug;var _dontEnums;function checkDontEnum(){_dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];_hasDontEnumBug=true;for(var key in{toString:null}){_hasDontEnumBug=false}}function forIn(obj,fn,thisObj){var key,i=0;if(_hasDontEnumBug==null){checkDontEnum()}for(key in obj){if(exec(fn,obj,key,thisObj)===false){break}}if(_hasDontEnumBug){var ctor=obj.constructor,isProto=!!ctor&&obj===ctor.prototype;while(key=_dontEnums[i++]){if((key!=="constructor"||!isProto&&hasOwn_1(obj,key))&&obj[key]!==Object.prototype[key]){if(exec(fn,obj,key,thisObj)===false){break}}}}}function exec(fn,obj,key,thisObj){return fn.call(thisObj,obj[key],key,obj)}var forIn_1=forIn;function forOwn(obj,fn,thisObj){forIn_1(obj,function(val,key){if(hasOwn_1(obj,key)){return fn.call(thisObj,obj[key],key,obj)}})}var forOwn_1=forOwn;var _rKind=/^\[object (.*)\]$/;var _toString=Object.prototype.toString;var UNDEF;function kindOf(val){if(val===null){return"Null"}else if(val===UNDEF){return"Undefined"}else{return _rKind.exec(_toString.call(val))[1]}}var kindOf_1=kindOf;function isKind(val,kind){return kindOf_1(val)===kind}var isKind_1=isKind;var isArray=Array.isArray||function(val){return isKind_1(val,"Array")};var isArray_1=isArray;function containsMatch(array,pattern){var i=-1,length=array.length;while(++i<length){if(deepMatches(array[i],pattern)){return true}}return false}function matchArray(target,pattern){var i=-1,patternLength=pattern.length;while(++i<patternLength){if(!containsMatch(target,pattern[i])){return false}}return true}function matchObject(target,pattern){var result=true;forOwn_1(pattern,function(val,key){if(!deepMatches(target[key],val)){return result=false}});return result}function deepMatches(target,pattern){if(target&&typeof target==="object"&&pattern&&typeof pattern==="object"){if(isArray_1(target)&&isArray_1(pattern)){return matchArray(target,pattern)}else{return matchObject(target,pattern)}}else{return target===pattern}}var deepMatches_1=deepMatches;function makeIterator(src,thisObj){if(src==null){return identity_1}switch(typeof src){case"function":return typeof thisObj!=="undefined"?function(val,i,arr){return src.call(thisObj,val,i,arr)}:src;case"object":return function(val){return deepMatches_1(val,src)};case"string":case"number":return prop_1(src)}}var makeIterator_=makeIterator;function collect(arr,callback,thisObj){callback=makeIterator_(callback,thisObj);var results=[];if(arr==null){return results}var i=-1,len=arr.length;while(++i<len){var value=callback(arr[i],i,arr);if(value!=null){append_1(results,value)}}return results}var collect_1=collect;function indexOf(arr,item,fromIndex){fromIndex=fromIndex||0;if(arr==null){return-1}var len=arr.length,i=fromIndex<0?len+fromIndex:fromIndex;while(i<len){if(arr[i]===item){return i}i++}return-1}var indexOf_1=indexOf;function combine(arr1,arr2){if(arr2==null){return arr1}var i=-1,len=arr2.length;while(++i<len){if(indexOf_1(arr1,arr2[i])===-1){arr1.push(arr2[i])}}return arr1}var combine_1=combine;function filter(arr,callback,thisObj){callback=makeIterator_(callback,thisObj);var results=[];if(arr==null){return results}var i=-1,len=arr.length,value;while(++i<len){value=arr[i];if(callback(value,i,arr)){results.push(value)}}return results}var filter_1=filter;function compact(arr){return filter_1(arr,function(val){return val!=null})}var compact_1=compact;function contains(arr,val){return indexOf_1(arr,val)!==-1}var contains_1=contains;function unique(arr,compare){compare=compare||isEqual;return filter_1(arr,function(item,i,arr){var n=arr.length;while(++i<n){if(compare(item,arr[i])){return false}}return true})}function isEqual(a,b){return a===b}var unique_1=unique;function some(arr,callback,thisObj){callback=makeIterator_(callback,thisObj);var result=false;if(arr==null){return result}var i=-1,len=arr.length;while(++i<len){if(callback(arr[i],i,arr)){result=true;break}}return result}var some_1=some;function slice$1(arr,start,end){var len=arr.length;if(start==null){start=0}else if(start<0){start=Math.max(len+start,0)}else{start=Math.min(start,len)}if(end==null){end=len}else if(end<0){end=Math.max(len+end,0)}else{end=Math.min(end,len)}var result=[];while(start<end){result.push(arr[start++])}return result}var slice_1=slice$1;function difference(arr){var arrs=slice_1(arguments,1),result=filter_1(unique_1(arr),function(needle){return!some_1(arrs,function(haystack){return contains_1(haystack,needle)})});return result}var difference_1=difference;function is(x,y){if(x===y){return x!==0||1/x===1/y}return x!==x&&y!==y}var is_1=is;function every(arr,callback,thisObj){callback=makeIterator_(callback,thisObj);var result=true;if(arr==null){return result}var i=-1,len=arr.length;while(++i<len){if(!callback(arr[i],i,arr)){result=false;break}}return result}var every_1=every;function equals(a,b,callback){callback=callback||is_1;if(!isArray_1(a)||!isArray_1(b)){return callback(a,b)}if(a.length!==b.length){return false}return every_1(a,makeCompare(callback),b)}function makeCompare(callback){return function(value,i){return i in this&&callback(value,this[i])}}var equals_1=equals;function findIndex(arr,iterator,thisObj){iterator=makeIterator_(iterator,thisObj);if(arr==null){return-1}var i=-1,len=arr.length;while(++i<len){if(iterator(arr[i],i,arr)){return i}}return-1}var findIndex_1=findIndex;function find(arr,iterator,thisObj){var idx=findIndex_1(arr,iterator,thisObj);return idx>=0?arr[idx]:void 0}var find_1=find;function findLastIndex(arr,iterator,thisObj){iterator=makeIterator_(iterator,thisObj);if(arr==null){return-1}var n=arr.length;while(--n>=0){if(iterator(arr[n],n,arr)){return n}}return-1}var findLastIndex_1=findLastIndex;function findLast(arr,iterator,thisObj){var idx=findLastIndex_1(arr,iterator,thisObj);return idx>=0?arr[idx]:void 0}var findLast_1=findLast;function flattenTo(arr,result,level){if(level===0){append_1(result,arr);return result}var value,i=-1,len=arr.length;while(++i<len){value=arr[i];if(isArray_1(value)){flattenTo(value,result,level-1)}else{result.push(value)}}return result}function flatten(arr,level){if(arr==null){return[]}level=level==null?-1:level;return flattenTo(arr,[],level)}var flatten_1=flatten;function forEach(arr,callback,thisObj){if(arr==null){return}var i=-1,len=arr.length;while(++i<len){if(callback.call(thisObj,arr[i],i,arr)===false){break}}}var forEach_1=forEach;function groupBy(arr,categorize,thisObj){if(categorize){categorize=makeIterator_(categorize,thisObj)}else{categorize=identity_1}var buckets={};forEach_1(arr,function(element){var bucket=categorize(element);if(!(bucket in buckets)){buckets[bucket]=[]}buckets[bucket].push(element)});return buckets}var groupBy_1=groupBy;function indicesOf(arr,item,fromIndex){var results=[];if(arr==null){return results}fromIndex=typeof fromIndex==="number"?fromIndex:0;var length=arr.length;var cursor=fromIndex>=0?fromIndex:length+fromIndex;while(cursor<length){if(arr[cursor]===item){results.push(cursor)}cursor++}return results}var indicesOf_1=indicesOf;function insert(arr,rest_items){var diff=difference_1(slice_1(arguments,1),arr);if(diff.length){Array.prototype.push.apply(arr,diff)}return arr.length}var insert_1=insert;function intersection(arr){var arrs=slice_1(arguments,1),result=filter_1(unique_1(arr),function(needle){return every_1(arrs,function(haystack){return contains_1(haystack,needle)})});return result}var intersection_1=intersection;function invoke(arr,methodName,var_args){if(arr==null){return arr}var args=slice_1(arguments,2);var i=-1,len=arr.length,value;while(++i<len){value=arr[i];value[methodName].apply(value,args)}return arr}var invoke_1=invoke;function isValidString(val){return val!=null&&val!==""}function join(items,separator){separator=separator||"";return filter_1(items,isValidString).join(separator)}var join_1=join;function last(arr){if(arr==null||arr.length<1){return undefined}return arr[arr.length-1]}var last_1=last;function lastIndexOf(arr,item,fromIndex){if(arr==null){return-1}var len=arr.length;fromIndex=fromIndex==null||fromIndex>=len?len-1:fromIndex;fromIndex=fromIndex<0?len+fromIndex:fromIndex;while(fromIndex>=0){if(arr[fromIndex]===item){return fromIndex}fromIndex--}return-1}var lastIndexOf_1=lastIndexOf;function map(arr,callback,thisObj){callback=makeIterator_(callback,thisObj);var results=[];if(arr==null){return results}var i=-1,len=arr.length;while(++i<len){results[i]=callback(arr[i],i,arr)}return results}var map_1=map;function max(arr,iterator,thisObj){if(arr==null||!arr.length){return Infinity}else if(arr.length&&!iterator){return Math.max.apply(Math,arr)}else{iterator=makeIterator_(iterator,thisObj);var result,compare=-Infinity,value,temp;var i=-1,len=arr.length;while(++i<len){value=arr[i];temp=iterator(value,i,arr);if(temp>compare){compare=temp;result=value}}return result}}var max_1=max;function min(arr,iterator,thisObj){if(arr==null||!arr.length){return-Infinity}else if(arr.length&&!iterator){return Math.min.apply(Math,arr)}else{iterator=makeIterator_(iterator,thisObj);var result,compare=Infinity,value,temp;var i=-1,len=arr.length;while(++i<len){value=arr[i];temp=iterator(value,i,arr);if(temp<compare){compare=temp;result=value}}return result}}var min_1=min;var MIN_INT=-2147483648;var MAX_INT=2147483647;function random(){return random.get()}random.get=Math.random;var random_1=random;function rand(min,max){min=min==null?MIN_INT:min;max=max==null?MAX_INT:max;return min+(max-min)*random_1()}var rand_1=rand;function randInt(min,max){min=min==null?MIN_INT:~~min;max=max==null?MAX_INT:~~max;return Math.round(rand_1(min-.5,max+.499999999999))}var randInt_1=randInt;function pick(arr,nItems){if(nItems!=null){var result=[];if(nItems>0&&arr&&arr.length){nItems=nItems>arr.length?arr.length:nItems;while(nItems--){result.push(pickOne(arr))}}return result}return arr&&arr.length?pickOne(arr):void 0}function pickOne(arr){var idx=randInt_1(0,arr.length-1);return arr.splice(idx,1)[0]}var pick_1=pick;function pluck(arr,propName){return map_1(arr,propName)}var pluck_1=pluck;function range(start,stop,step){if(stop==null){stop=start;start=0}step=step||1;var result=[],nSteps=countSteps_1(stop-start,step),i=start;while(i<=stop){result.push(i);i+=step}return result}var range_1=range;function reduce(arr,fn,initVal){var hasInit=arguments.length>2,result=initVal;if(arr==null||!arr.length){if(!hasInit){throw new Error("reduce of empty array with no initial value")}else{return initVal}}var i=-1,len=arr.length;while(++i<len){if(!hasInit){result=arr[i];hasInit=true}else{result=fn(result,arr[i],i,arr)}}return result}var reduce_1=reduce;function reduceRight(arr,fn,initVal){var hasInit=arguments.length>2;if(arr==null||!arr.length){if(hasInit){return initVal}else{throw new Error("reduce of empty array with no initial value")}}var i=arr.length,result=initVal,value;while(--i>=0){value=arr[i];if(!hasInit){result=value;hasInit=true}else{result=fn(result,value,i,arr)}}return result}var reduceRight_1=reduceRight;function reject(arr,callback,thisObj){callback=makeIterator_(callback,thisObj);var results=[];if(arr==null){return results}var i=-1,len=arr.length,value;while(++i<len){value=arr[i];if(!callback(value,i,arr)){results.push(value)}}return results}var reject_1=reject;function remove$1(arr,item){var idx=indexOf_1(arr,item);if(idx!==-1){arr.splice(idx,1)}}var remove_1=remove$1;function removeAll(arr,item){var idx=indexOf_1(arr,item);while(idx!==-1){arr.splice(idx,1);idx=indexOf_1(arr,item,idx)}}var removeAll_1=removeAll;function reverse(array){var copy=array.slice();copy.reverse();return copy}var reverse_1=reverse;function shuffle(arr){var results=[],rnd;if(arr==null){return results}var i=-1,len=arr.length;while(++i<len){if(!i){results[0]=arr[0]}else{rnd=randInt_1(0,i);results[i]=results[rnd];results[rnd]=arr[i]}}return results}var shuffle_1=shuffle;function mergeSort(arr,compareFn){if(arr==null){return[]}else if(arr.length<2){return arr}if(compareFn==null){compareFn=defaultCompare}var mid,left,right;mid=~~(arr.length/2);left=mergeSort(arr.slice(0,mid),compareFn);right=mergeSort(arr.slice(mid,arr.length),compareFn);return merge(left,right,compareFn)}function defaultCompare(a,b){return a<b?-1:a>b?1:0}function merge(left,right,compareFn){var result=[];while(left.length&&right.length){if(compareFn(left[0],right[0])<=0){result.push(left.shift())}else{result.push(right.shift())}}if(left.length){result.push.apply(result,left)}if(right.length){result.push.apply(result,right)}return result}var sort=mergeSort;function sortBy(arr,callback,context){callback=makeIterator_(callback,context);return sort(arr,function(a,b){a=callback(a);b=callback(b);return a<b?-1:a>b?1:0})}var sortBy_1=sortBy;function split(array,segments){segments=segments||2;var results=[];if(array==null){return results}var minLength=Math.floor(array.length/segments),remainder=array.length%segments,i=0,len=array.length,segmentIndex=0,segmentLength;while(i<len){segmentLength=minLength;if(segmentIndex<remainder){segmentLength++}results.push(array.slice(i,i+segmentLength));segmentIndex++;i+=segmentLength}return results}var split_1=split;function take(n,callback,thisObj){var i=-1;var arr=[];if(!thisObj){while(++i<n){arr[i]=callback(i,n)}}else{while(++i<n){arr[i]=callback.call(thisObj,i,n)}}return arr}var take_1=take;function isFunction(val){return isKind_1(val,"Function")}var isFunction_1=isFunction;function toLookup(arr,key){var result={};if(arr==null){return result}var i=-1,len=arr.length,value;if(isFunction_1(key)){while(++i<len){value=arr[i];result[key(value)]=value}}else{while(++i<len){value=arr[i];result[value[key]]=value}}return result}var toLookup_1=toLookup;function union(arrs){var arguments$1=arguments;var results=[];var i=-1,len=arguments.length;while(++i<len){append_1(results,arguments$1[i])}return unique_1(results)}var union_1=union;function xor(arr1,arr2){arr1=unique_1(arr1);arr2=unique_1(arr2);var a1=filter_1(arr1,function(item){return!contains_1(arr2,item)}),a2=filter_1(arr2,function(item){return!contains_1(arr1,item)});return a1.concat(a2)}var xor_1=xor;function getLength(arr){return arr==null?0:arr.length}function zip(arr){var arguments$1=arguments;var len=arr?max_1(map_1(arguments,getLength)):0,results=[],i=-1;while(++i<len){results.push(map_1(arguments$1,function(item){return item==null?undefined:item[i]}))}return results}var zip_1=zip;var array={append:append_1,collect:collect_1,combine:combine_1,compact:compact_1,contains:contains_1,difference:difference_1,equals:equals_1,every:every_1,filter:filter_1,find:find_1,findIndex:findIndex_1,findLast:findLast_1,findLastIndex:findLastIndex_1,flatten:flatten_1,forEach:forEach_1,groupBy:groupBy_1,indexOf:indexOf_1,indicesOf:indicesOf_1,insert:insert_1,intersection:intersection_1,invoke:invoke_1,join:join_1,last:last_1,lastIndexOf:lastIndexOf_1,map:map_1,max:max_1,min:min_1,pick:pick_1,pluck:pluck_1,range:range_1,reduce:reduce_1,reduceRight:reduceRight_1,reject:reject_1,remove:remove_1,removeAll:removeAll_1,reverse:reverse_1,shuffle:shuffle_1,slice:slice_1,some:some_1,sort:sort,sortBy:sortBy_1,split:split_1,take:take_1,toLookup:toLookup_1,union:union_1,unique:unique_1,xor:xor_1,zip:zip_1};var array_1=array.find;var array_2=array.forEach;var index$1=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=="[object Array]"};var index=pathToRegexp;var parse_1=parse;var compile_1=compile;var tokensToFunction_1=tokensToFunction;var tokensToRegExp_1=tokensToRegExp;var PATH_REGEXP=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function parse(str,options){var tokens=[];var key=0;var index=0;var path="";var defaultDelimiter=options&&options.delimiter||"/";var res;while((res=PATH_REGEXP.exec(str))!=null){var m=res[0];var escaped=res[1];var offset=res.index;path+=str.slice(index,offset);index=offset+m.length;if(escaped){path+=escaped[1];continue}var next=str[index];var prefix=res[2];var name=res[3];var capture=res[4];var group=res[5];var modifier=res[6];var asterisk=res[7];if(path){tokens.push(path);path=""}var partial=prefix!=null&&next!=null&&next!==prefix;var repeat=modifier==="+"||modifier==="*";var optional=modifier==="?"||modifier==="*";var delimiter=res[2]||defaultDelimiter;var pattern=capture||group;tokens.push({name:name||key++,prefix:prefix||"",delimiter:delimiter,optional:optional,repeat:repeat,partial:partial,asterisk:!!asterisk,pattern:pattern?escapeGroup(pattern):asterisk?".*":"[^"+escapeString(delimiter)+"]+?"})}if(index<str.length){path+=str.substr(index)}if(path){tokens.push(path)}return tokens}function compile(str,options){return tokensToFunction(parse(str,options))}function encodeURIComponentPretty(str){return encodeURI(str).replace(/[\/?#]/g,function(c){return"%"+c.charCodeAt(0).toString(16).toUpperCase()})}function encodeAsterisk(str){return encodeURI(str).replace(/[?#]/g,function(c){return"%"+c.charCodeAt(0).toString(16).toUpperCase()})}function tokensToFunction(tokens){var matches=new Array(tokens.length);for(var i=0;i<tokens.length;i++){if(typeof tokens[i]==="object"){matches[i]=new RegExp("^(?:"+tokens[i].pattern+")$")}}return function(obj,opts){var path="";var data=obj||{};var options=opts||{};var encode=options.pretty?encodeURIComponentPretty:encodeURIComponent;for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data[token.name];var segment;if(value==null){if(token.optional){if(token.partial){path+=token.prefix}continue}else{throw new TypeError('Expected "'+token.name+'" to be defined')}}if(index$1(value)){if(!token.repeat){throw new TypeError('Expected "'+token.name+'" to not repeat, but received `'+JSON.stringify(value)+"`")}if(value.length===0){if(token.optional){continue}else{throw new TypeError('Expected "'+token.name+'" to not be empty')}}for(var j=0;j<value.length;j++){segment=encode(value[j]);if(!matches[i].test(segment)){throw new TypeError('Expected all "'+token.name+'" to match "'+token.pattern+'", but received `'+JSON.stringify(segment)+"`")}path+=(j===0?token.prefix:token.delimiter)+segment}continue}segment=token.asterisk?encodeAsterisk(value):encode(value);if(!matches[i].test(segment)){throw new TypeError('Expected "'+token.name+'" to match "'+token.pattern+'", but received "'+segment+'"')}path+=token.prefix+segment}return path}}function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function escapeGroup(group){return group.replace(/([=!:$\/()])/g,"\\$1")}function attachKeys(re,keys){re.keys=keys;return re}function flags(options){return options.sensitive?"":"i"}function regexpToRegexp(path,keys){var groups=path.source.match(/\((?!\?)/g);if(groups){for(var i=0;i<groups.length;i++){keys.push({name:i,prefix:null,delimiter:null,optional:false,repeat:false,partial:false,asterisk:false,pattern:null})}}return attachKeys(path,keys)}function arrayToRegexp(path,keys,options){var parts=[];for(var i=0;i<path.length;i++){parts.push(pathToRegexp(path[i],keys,options).source)}var regexp=new RegExp("(?:"+parts.join("|")+")",flags(options));return attachKeys(regexp,keys)}function stringToRegexp(path,keys,options){return tokensToRegExp(parse(path,options),keys,options)}function tokensToRegExp(tokens,keys,options){if(!index$1(keys)){options=keys||options;keys=[]}options=options||{};var strict=options.strict;var end=options.end!==false;var route="";for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){route+=escapeString(token)}else{var prefix=escapeString(token.prefix);var capture="(?:"+token.pattern+")";keys.push(token);if(token.repeat){capture+="(?:"+prefix+capture+")*"}if(token.optional){if(!token.partial){capture="(?:"+prefix+"("+capture+"))?"}else{capture=prefix+"("+capture+")?"}}else{capture=prefix+"("+capture+")"}route+=capture}}var delimiter=escapeString(options.delimiter||"/");var endsWithDelimiter=route.slice(-delimiter.length)===delimiter;if(!strict){route=(endsWithDelimiter?route.slice(0,-delimiter.length):route)+"(?:"+delimiter+"(?=$))?"}if(end){route+="$"}else{route+=strict&&endsWithDelimiter?"":"(?="+delimiter+"|$)"}return attachKeys(new RegExp("^"+route,flags(options)),keys)}function pathToRegexp(path,keys,options){if(!index$1(keys)){options=keys||options;keys=[]}options=options||{};if(path instanceof RegExp){return regexpToRegexp(path,keys)}if(index$1(path)){return arrayToRegexp(path,keys,options)}return stringToRegexp(path,keys,options)}index.parse=parse_1;index.compile=compile_1;index.tokensToFunction=tokensToFunction_1;index.tokensToRegExp=tokensToRegExp_1;var commonjsGlobal$1=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function unwrapExports$1(x){return x&&x.__esModule?x["default"]:x}function createCommonjsModule$1(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}var promise=createCommonjsModule$1(function(module){(function(root){var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof fn!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self){throw new TypeError("A promise cannot be resolved with itself.")}if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done){return}done=true;resolve(self,value)},function(reason){if(done){return}done=true;reject(self,reason)})}catch(ex){if(done){return}done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(args.length===0){return resolve([])}var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};Promise._setImmediateFn=function _setImmediateFn(fn){Promise._immediateFn=fn};Promise._setUnhandledRejectionFn=function _setUnhandledRejectionFn(fn){Promise._unhandledRejectionFn=fn};if("object"!=="undefined"&&module.exports){module.exports=Promise}else if(!root.Promise){root.Promise=Promise}})(commonjsGlobal$1)});var warning=function(){};{warning=function(condition,format,args){var arguments$1=arguments;var len=arguments.length;args=new Array(len>2?len-2:0);for(var key=2;key<len;key++){args[key-2]=arguments$1[key]}if(format===undefined){throw new Error("`warning(condition, format, ...args)` requires a warning "+"message argument")}if(format.length<10||/^[s\W]*$/.test(format)){throw new Error("The warning format should be able to uniquely identify this "+"warning. Please, use a more descriptive format than: "+format)}if(!condition){var argIndex=0;var message="Warning: "+format.replace(/%s/g,function(){return args[argIndex++]});if(typeof console!=="undefined"){console.error(message)}try{throw new Error(message)}catch(x){}}}}var browser=warning;var invariant=function(condition,format,a,b,c,d,e,f){{if(format===undefined){throw new Error("invariant requires an error message argument")}}if(!condition){var error;if(format===undefined){error=new Error("Minified exception occurred; use the non-minified dev environment "+"for the full error message and additional helpful warnings.")}else{var args=[a,b,c,d,e,f];var argIndex=0;error=new Error(format.replace(/%s/g,function(){return args[argIndex++]}));error.name="Invariant Violation"}error.framesToPop=1;throw error}};var browser$1=invariant;var isAbsolute=function isAbsolute(pathname){return pathname.charAt(0)==="/"};var spliceOne=function spliceOne(list,index){for(var i=index,k=i+1,n=list.length;k<n;i+=1,k+=1){list[i]=list[k]}list.pop()};var resolvePathname=function resolvePathname(to){var from=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var toParts=to&&to.split("/")||[];var fromParts=from&&from.split("/")||[];var isToAbs=to&&isAbsolute(to);var isFromAbs=from&&isAbsolute(from);var mustEndAbs=isToAbs||isFromAbs;if(to&&isAbsolute(to)){fromParts=toParts}else if(toParts.length){fromParts.pop();fromParts=fromParts.concat(toParts)}if(!fromParts.length){return"/"}var hasTrailingSlash=void 0;if(fromParts.length){var last=fromParts[fromParts.length-1];hasTrailingSlash=last==="."||last===".."||last===""}else{hasTrailingSlash=false}var up=0;for(var i=fromParts.length;i>=0;i--){var part=fromParts[i];if(part==="."){spliceOne(fromParts,i)}else if(part===".."){spliceOne(fromParts,i);up++}else if(up){spliceOne(fromParts,i);up--}}if(!mustEndAbs){for(;up--;up){fromParts.unshift("..")}}if(mustEndAbs&&fromParts[0]!==""&&(!fromParts[0]||!isAbsolute(fromParts[0]))){fromParts.unshift("")}var result=fromParts.join("/");if(hasTrailingSlash&&result.substr(-1)!=="/"){result+="/"}return result};var index$3=resolvePathname;var index$4=createCommonjsModule$1(function(module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var valueEqual=function valueEqual(a,b){if(a===b){return true}if(a==null||b==null){return false}if(Array.isArray(a)){return Array.isArray(b)&&a.length===b.length&&a.every(function(item,index){return valueEqual(item,b[index])})}var aType=typeof a==="undefined"?"undefined":_typeof(a);var bType=typeof b==="undefined"?"undefined":_typeof(b);if(aType!==bType){return false}if(aType==="object"){var aValue=a.valueOf();var bValue=b.valueOf();if(aValue!==a||bValue!==b){return valueEqual(aValue,bValue)}var aKeys=Object.keys(a);var bKeys=Object.keys(b);if(aKeys.length!==bKeys.length){return false}return aKeys.every(function(key){return valueEqual(a[key],b[key])})}return false};exports.default=valueEqual});var valueEqual=unwrapExports$1(index$4);var addLeadingSlash=function addLeadingSlash(path){return path.charAt(0)==="/"?path:"/"+path};var stripLeadingSlash=function stripLeadingSlash(path){return path.charAt(0)==="/"?path.substr(1):path};var hasBasename=function hasBasename(path,prefix){return new RegExp("^"+prefix+"(\\/|\\?|#|$)","i").test(path)};var stripBasename=function stripBasename(path,prefix){return hasBasename(path,prefix)?path.substr(prefix.length):path};var stripTrailingSlash=function stripTrailingSlash(path){return path.charAt(path.length-1)==="/"?path.slice(0,-1):path};var parsePath=function parsePath(path){var pathname=path||"/";var search="";var hash="";var hashIndex=pathname.indexOf("#");if(hashIndex!==-1){hash=pathname.substr(hashIndex);pathname=pathname.substr(0,hashIndex)}var searchIndex=pathname.indexOf("?");if(searchIndex!==-1){search=pathname.substr(searchIndex);pathname=pathname.substr(0,searchIndex)}return{pathname:pathname,search:search==="?"?"":search,hash:hash==="#"?"":hash}};var createPath=function createPath(location){var pathname=location.pathname,search=location.search,hash=location.hash;var path=pathname||"/";if(search&&search!=="?"){path+=search.charAt(0)==="?"?search:"?"+search}if(hash&&hash!=="#"){path+=hash.charAt(0)==="#"?hash:"#"+hash}return path};var _extends$1$1=Object.assign||function(target){var arguments$1=arguments;for(var i=1;i<arguments.length;i++){var source=arguments$1[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var createLocation=function createLocation(path,state,key,currentLocation){var location=void 0;if(typeof path==="string"){location=parsePath(path);location.state=state}else{location=_extends$1$1({},path);if(location.pathname===undefined){location.pathname=""}if(location.search){if(location.search.charAt(0)!=="?"){location.search="?"+location.search}}else{location.search=""}if(location.hash){if(location.hash.charAt(0)!=="#"){location.hash="#"+location.hash}}else{location.hash=""}if(state!==undefined&&location.state===undefined){location.state=state}}try{location.pathname=decodeURI(location.pathname)}catch(e){if(e instanceof URIError){throw new URIError('Pathname "'+location.pathname+'" could not be decoded. '+"This is likely caused by an invalid percent-encoding.")}else{throw e}}if(key){location.key=key}if(currentLocation){if(!location.pathname){location.pathname=currentLocation.pathname}else if(location.pathname.charAt(0)!=="/"){location.pathname=index$3(location.pathname,currentLocation.pathname)}}else{if(!location.pathname){location.pathname="/"}}return location};var locationsAreEqual=function locationsAreEqual(a,b){return a.pathname===b.pathname&&a.search===b.search&&a.hash===b.hash&&a.key===b.key&&valueEqual(a.state,b.state)};var createTransitionManager=function createTransitionManager(){var prompt=null;var setPrompt=function setPrompt(nextPrompt){browser(prompt==null,"A history supports only one prompt at a time");prompt=nextPrompt;return function(){if(prompt===nextPrompt){prompt=null}}};var confirmTransitionTo=function confirmTransitionTo(location,action,getUserConfirmation,callback){if(prompt!=null){var result=typeof prompt==="function"?prompt(location,action):prompt;if(typeof result==="string"){if(typeof getUserConfirmation==="function"){getUserConfirmation(result,callback)}else{browser(false,"A history needs a getUserConfirmation function in order to use a prompt message");callback(true)}}else{callback(result!==false)}}else{callback(true)}};var listeners=[];var appendListener=function appendListener(fn){var isActive=true;var listener=function listener(){if(isActive){fn.apply(undefined,arguments)}};listeners.push(listener);return function(){isActive=false;listeners=listeners.filter(function(item){return item!==listener})}};var notifyListeners=function notifyListeners(){var arguments$1=arguments;for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments$1[_key]}listeners.forEach(function(listener){return listener.apply(undefined,args)})};return{setPrompt:setPrompt,confirmTransitionTo:confirmTransitionTo,appendListener:appendListener,notifyListeners:notifyListeners}};var canUseDOM=!!(typeof window!=="undefined"&&window.document&&window.document.createElement);var addEventListener=function addEventListener(node,event,listener){return node.addEventListener?node.addEventListener(event,listener,false):node.attachEvent("on"+event,listener)};var removeEventListener=function removeEventListener(node,event,listener){return node.removeEventListener?node.removeEventListener(event,listener,false):node.detachEvent("on"+event,listener)};var getConfirmation=function getConfirmation(message,callback){return callback(window.confirm(message))};var supportsHistory=function supportsHistory(){var ua=window.navigator.userAgent;if((ua.indexOf("Android 2.")!==-1||ua.indexOf("Android 4.0")!==-1)&&ua.indexOf("Mobile Safari")!==-1&&ua.indexOf("Chrome")===-1&&ua.indexOf("Windows Phone")===-1){return false}return window.history&&"pushState"in window.history};var supportsPopStateOnHashChange=function supportsPopStateOnHashChange(){return window.navigator.userAgent.indexOf("Trident")===-1};var supportsGoWithoutReloadUsingHash=function supportsGoWithoutReloadUsingHash(){return window.navigator.userAgent.indexOf("Firefox")===-1};var isExtraneousPopstateEvent=function isExtraneousPopstateEvent(event){return event.state===undefined&&navigator.userAgent.indexOf("CriOS")===-1};var _typeof$2=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _extends$7=Object.assign||function(target){var arguments$1=arguments;for(var i=1;i<arguments.length;i++){var source=arguments$1[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var PopStateEvent="popstate";var HashChangeEvent="hashchange";var getHistoryState=function getHistoryState(){try{return window.history.state||{}}catch(e){return{}}};var createBrowserHistory=function createBrowserHistory(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};browser$1(canUseDOM,"Browser history needs a DOM");var globalHistory=window.history;var canUseHistory=supportsHistory();var needsHashChangeListener=!supportsPopStateOnHashChange();var _props$forceRefresh=props.forceRefresh,forceRefresh=_props$forceRefresh===undefined?false:_props$forceRefresh,_props$getUserConfirm=props.getUserConfirmation,getUserConfirmation=_props$getUserConfirm===undefined?getConfirmation:_props$getUserConfirm,_props$keyLength=props.keyLength,keyLength=_props$keyLength===undefined?6:_props$keyLength;var basename=props.basename?stripTrailingSlash(addLeadingSlash(props.basename)):"";var getDOMLocation=function getDOMLocation(historyState){var _ref=historyState||{},key=_ref.key,state=_ref.state;var _window$location=window.location,pathname=_window$location.pathname,search=_window$location.search,hash=_window$location.hash;var path=pathname+search+hash;browser(!basename||hasBasename(path,basename),"You are attempting to use a basename on a page whose URL path does not begin "+'with the basename. Expected path "'+path+'" to begin with "'+basename+'".');if(basename){path=stripBasename(path,basename)}return createLocation(path,state,key)};var createKey=function createKey(){return Math.random().toString(36).substr(2,keyLength)};var transitionManager=createTransitionManager();var setState=function setState(nextState){_extends$7(history,nextState);history.length=globalHistory.length;transitionManager.notifyListeners(history.location,history.action)};var handlePopState=function handlePopState(event){if(isExtraneousPopstateEvent(event)){return}handlePop(getDOMLocation(event.state))};var handleHashChange=function handleHashChange(){handlePop(getDOMLocation(getHistoryState()))};var forceNextPop=false;var handlePop=function handlePop(location){if(forceNextPop){forceNextPop=false;setState()}else{var action="POP";transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(ok){setState({action:action,location:location})}else{revertPop(location)}})}};var revertPop=function revertPop(fromLocation){var toLocation=history.location;var toIndex=allKeys.indexOf(toLocation.key);if(toIndex===-1){toIndex=0}var fromIndex=allKeys.indexOf(fromLocation.key);if(fromIndex===-1){fromIndex=0}var delta=toIndex-fromIndex;if(delta){forceNextPop=true;go(delta)}};var initialLocation=getDOMLocation(getHistoryState());var allKeys=[initialLocation.key];var createHref=function createHref(location){return basename+createPath(location)};var push=function push(path,state){browser(!((typeof path==="undefined"?"undefined":_typeof$2(path))==="object"&&path.state!==undefined&&state!==undefined),"You should avoid providing a 2nd state argument to push when the 1st "+"argument is a location-like object that already has state; it is ignored");var action="PUSH";var location=createLocation(path,state,createKey(),history.location);transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(!ok){return}var href=createHref(location);var key=location.key,state=location.state;if(canUseHistory){globalHistory.pushState({key:key,state:state},null,href);if(forceRefresh){window.location.href=href}else{var prevIndex=allKeys.indexOf(history.location.key);var nextKeys=allKeys.slice(0,prevIndex===-1?0:prevIndex+1);nextKeys.push(location.key);allKeys=nextKeys;setState({action:action,location:location})}}else{browser(state===undefined,"Browser history cannot push state in browsers that do not support HTML5 history");window.location.href=href}})};var replace=function replace(path,state){browser(!((typeof path==="undefined"?"undefined":_typeof$2(path))==="object"&&path.state!==undefined&&state!==undefined),"You should avoid providing a 2nd state argument to replace when the 1st "+"argument is a location-like object that already has state; it is ignored");var action="REPLACE";var location=createLocation(path,state,createKey(),history.location);transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(!ok){return}var href=createHref(location);var key=location.key,state=location.state;if(canUseHistory){globalHistory.replaceState({key:key,state:state},null,href);if(forceRefresh){window.location.replace(href)}else{var prevIndex=allKeys.indexOf(history.location.key);if(prevIndex!==-1){allKeys[prevIndex]=location.key}setState({action:action,location:location})}}else{browser(state===undefined,"Browser history cannot replace state in browsers that do not support HTML5 history");window.location.replace(href)}})};var go=function go(n){globalHistory.go(n)};var goBack=function goBack(){return go(-1)};var goForward=function goForward(){return go(1)};var listenerCount=0;var checkDOMListeners=function checkDOMListeners(delta){listenerCount+=delta;if(listenerCount===1){addEventListener(window,PopStateEvent,handlePopState);if(needsHashChangeListener){addEventListener(window,HashChangeEvent,handleHashChange)}}else if(listenerCount===0){removeEventListener(window,PopStateEvent,handlePopState);if(needsHashChangeListener){removeEventListener(window,HashChangeEvent,handleHashChange)}}};var isBlocked=false;var block=function block(){var prompt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var unblock=transitionManager.setPrompt(prompt);if(!isBlocked){checkDOMListeners(1);isBlocked=true}return function(){if(isBlocked){isBlocked=false;checkDOMListeners(-1)}return unblock()}};var listen=function listen(listener){var unlisten=transitionManager.appendListener(listener);checkDOMListeners(1);return function(){checkDOMListeners(-1);unlisten()}};var history={length:globalHistory.length,action:"POP",location:initialLocation,createHref:createHref,push:push,replace:replace,go:go,goBack:goBack,goForward:goForward,block:block,listen:listen};return history};var _extends$2$1=Object.assign||function(target){var arguments$1=arguments;for(var i=1;i<arguments.length;i++){var source=arguments$1[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var HashChangeEvent$1="hashchange";var HashPathCoders={hashbang:{encodePath:function encodePath(path){return path.charAt(0)==="!"?path:"!/"+stripLeadingSlash(path)},decodePath:function decodePath(path){return path.charAt(0)==="!"?path.substr(1):path}},noslash:{encodePath:stripLeadingSlash,decodePath:addLeadingSlash},slash:{encodePath:addLeadingSlash,decodePath:addLeadingSlash}};var getHashPath=function getHashPath(){var href=window.location.href;var hashIndex=href.indexOf("#");return hashIndex===-1?"":href.substring(hashIndex+1)};var pushHashPath=function pushHashPath(path){return window.location.hash=path};var replaceHashPath=function replaceHashPath(path){var hashIndex=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,hashIndex>=0?hashIndex:0)+"#"+path)};var createHashHistory=function createHashHistory(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};browser$1(canUseDOM,"Hash history needs a DOM");var globalHistory=window.history;var canGoWithoutReload=supportsGoWithoutReloadUsingHash();var _props$getUserConfirm=props.getUserConfirmation,getUserConfirmation=_props$getUserConfirm===undefined?getConfirmation:_props$getUserConfirm,_props$hashType=props.hashType,hashType=_props$hashType===undefined?"slash":_props$hashType;var basename=props.basename?stripTrailingSlash(addLeadingSlash(props.basename)):"";var _HashPathCoders$hashT=HashPathCoders[hashType],encodePath=_HashPathCoders$hashT.encodePath,decodePath=_HashPathCoders$hashT.decodePath;var getDOMLocation=function getDOMLocation(){var path=decodePath(getHashPath());browser(!basename||hasBasename(path,basename),"You are attempting to use a basename on a page whose URL path does not begin "+'with the basename. Expected path "'+path+'" to begin with "'+basename+'".');if(basename){path=stripBasename(path,basename)}return createLocation(path)};var transitionManager=createTransitionManager();var setState=function setState(nextState){_extends$2$1(history,nextState);history.length=globalHistory.length;transitionManager.notifyListeners(history.location,history.action)};var forceNextPop=false;var ignorePath=null;var handleHashChange=function handleHashChange(){var path=getHashPath();var encodedPath=encodePath(path);if(path!==encodedPath){replaceHashPath(encodedPath)}else{var location=getDOMLocation();var prevLocation=history.location;if(!forceNextPop&&locationsAreEqual(prevLocation,location)){return}if(ignorePath===createPath(location)){return}ignorePath=null;handlePop(location)}};var handlePop=function handlePop(location){if(forceNextPop){forceNextPop=false;setState()}else{var action="POP";transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(ok){setState({action:action,location:location})}else{revertPop(location)}})}};var revertPop=function revertPop(fromLocation){var toLocation=history.location;var toIndex=allPaths.lastIndexOf(createPath(toLocation));if(toIndex===-1){toIndex=0}var fromIndex=allPaths.lastIndexOf(createPath(fromLocation));if(fromIndex===-1){fromIndex=0}var delta=toIndex-fromIndex;if(delta){forceNextPop=true;go(delta)}};var path=getHashPath();var encodedPath=encodePath(path);if(path!==encodedPath){replaceHashPath(encodedPath)}var initialLocation=getDOMLocation();var allPaths=[createPath(initialLocation)];var createHref=function createHref(location){return"#"+encodePath(basename+createPath(location))};var push=function push(path,state){browser(state===undefined,"Hash history cannot push state; it is ignored");var action="PUSH";var location=createLocation(path,undefined,undefined,history.location);transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(!ok){return}var path=createPath(location);var encodedPath=encodePath(basename+path);var hashChanged=getHashPath()!==encodedPath;if(hashChanged){ignorePath=path;pushHashPath(encodedPath);var prevIndex=allPaths.lastIndexOf(createPath(history.location));var nextPaths=allPaths.slice(0,prevIndex===-1?0:prevIndex+1);nextPaths.push(path);allPaths=nextPaths;setState({action:action,location:location})}else{browser(false,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack");setState()}})};var replace=function replace(path,state){browser(state===undefined,"Hash history cannot replace state; it is ignored");var action="REPLACE";var location=createLocation(path,undefined,undefined,history.location);transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(!ok){return}var path=createPath(location);var encodedPath=encodePath(basename+path);var hashChanged=getHashPath()!==encodedPath;if(hashChanged){ignorePath=path;replaceHashPath(encodedPath)}var prevIndex=allPaths.indexOf(createPath(history.location));if(prevIndex!==-1){allPaths[prevIndex]=path}setState({action:action,location:location})})};var go=function go(n){browser(canGoWithoutReload,"Hash history go(n) causes a full page reload in this browser");globalHistory.go(n)};var goBack=function goBack(){return go(-1)};var goForward=function goForward(){return go(1)};var listenerCount=0;var checkDOMListeners=function checkDOMListeners(delta){listenerCount+=delta;if(listenerCount===1){addEventListener(window,HashChangeEvent$1,handleHashChange)}else if(listenerCount===0){removeEventListener(window,HashChangeEvent$1,handleHashChange)}};var isBlocked=false;var block=function block(){var prompt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var unblock=transitionManager.setPrompt(prompt);if(!isBlocked){checkDOMListeners(1);isBlocked=true}return function(){if(isBlocked){isBlocked=false;checkDOMListeners(-1)}return unblock()}};var listen=function listen(listener){var unlisten=transitionManager.appendListener(listener);checkDOMListeners(1);return function(){checkDOMListeners(-1);unlisten()}};var history={length:globalHistory.length,action:"POP",location:initialLocation,createHref:createHref,push:push,replace:replace,go:go,goBack:goBack,goForward:goForward,block:block,listen:listen};return history};var _typeof$1$1=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _extends$3$1=Object.assign||function(target){var arguments$1=arguments;for(var i=1;i<arguments.length;i++){var source=arguments$1[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var clamp=function clamp(n,lowerBound,upperBound){return Math.min(Math.max(n,lowerBound),upperBound)};var createMemoryHistory=function createMemoryHistory(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var getUserConfirmation=props.getUserConfirmation,_props$initialEntries=props.initialEntries,initialEntries=_props$initialEntries===undefined?["/"]:_props$initialEntries,_props$initialIndex=props.initialIndex,initialIndex=_props$initialIndex===undefined?0:_props$initialIndex,_props$keyLength=props.keyLength,keyLength=_props$keyLength===undefined?6:_props$keyLength;var transitionManager=createTransitionManager();var setState=function setState(nextState){_extends$3$1(history,nextState);history.length=history.entries.length;transitionManager.notifyListeners(history.location,history.action)};var createKey=function createKey(){return Math.random().toString(36).substr(2,keyLength)};var index=clamp(initialIndex,0,initialEntries.length-1);var entries=initialEntries.map(function(entry){return typeof entry==="string"?createLocation(entry,undefined,createKey()):createLocation(entry,undefined,entry.key||createKey())});var createHref=createPath;var push=function push(path,state){browser(!((typeof path==="undefined"?"undefined":_typeof$1$1(path))==="object"&&path.state!==undefined&&state!==undefined),"You should avoid providing a 2nd state argument to push when the 1st "+"argument is a location-like object that already has state; it is ignored");var action="PUSH";var location=createLocation(path,state,createKey(),history.location);transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(!ok){return}var prevIndex=history.index;var nextIndex=prevIndex+1;var nextEntries=history.entries.slice(0);if(nextEntries.length>nextIndex){nextEntries.splice(nextIndex,nextEntries.length-nextIndex,location)}else{nextEntries.push(location)}setState({action:action,location:location,index:nextIndex,entries:nextEntries})})};var replace=function replace(path,state){browser(!((typeof path==="undefined"?"undefined":_typeof$1$1(path))==="object"&&path.state!==undefined&&state!==undefined),"You should avoid providing a 2nd state argument to replace when the 1st "+"argument is a location-like object that already has state; it is ignored");var action="REPLACE";var location=createLocation(path,state,createKey(),history.location);transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(!ok){return}history.entries[history.index]=location;setState({action:action,location:location})})};var go=function go(n){var nextIndex=clamp(history.index+n,0,history.entries.length-1);var action="POP";var location=history.entries[nextIndex];transitionManager.confirmTransitionTo(location,action,getUserConfirmation,function(ok){if(ok){setState({action:action,location:location,index:nextIndex})}else{setState()}})};var goBack=function goBack(){return go(-1)};var goForward=function goForward(){return go(1)};var canGo=function canGo(n){var nextIndex=history.index+n;return nextIndex>=0&&nextIndex<history.entries.length};var block=function block(){var prompt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return transitionManager.setPrompt(prompt)};var listen=function listen(listener){return transitionManager.appendListener(listener)};var history={length:entries.length,action:"POP",location:entries[index],index:index,entries:entries,createHref:createHref,push:push,replace:replace,go:go,goBack:goBack,goForward:goForward,canGo:canGo,block:block,listen:listen};return history};var constants={BROWSER:"BROWSER",MEMORY:"MEMORY",HASH:"HASH"};var Router=function Router(type){if(type===void 0){type=constants.BROWSER}switch(type){case constants.BROWSER:this._history=createBrowserHistory();break;case constants.MEMORY:this._history=createMemoryHistory();break;case constants.HASH:this._history=createHashHistory();break;default:break}this._routes=[];this._unlistener=null;this._onBefore=null;this._onBeforeOnce=null;this._onAfter=null;this._onAfterOnce=null};Router.prototype.start=function start(autoExec){var this$1=this;if(autoExec===void 0){autoExec=true}this._unlistener=this._history.listen(function(location,action){this$1._change(location,action)});if(autoExec){this._change(this.getCurrentLocation(),this.getCurrentAction())}};Router.prototype.stop=function stop(){if(!this._unlistener){return}this._unlistener();this._unlistener=null};Router.prototype.on=function on(pattern,onEnter,onBefore,onAfter){var keys=[];var regexp=index(pattern,keys);this._routes.push({pattern:pattern,regexp:regexp,keys:keys,onEnter:onEnter,onBefore:onBefore,onAfter:onAfter});return this};Router.prototype.onBefore=function onBefore(func){this._onBefore=func;return this};Router.prototype.onBeforeOnce=function onBeforeOnce(func){this._onBeforeOnce=func;return this};Router.prototype.onAfter=function onAfter(func){this._onAfter=func;return this};Router.prototype.onAfterOnce=function onAfterOnce(func){this._onAfterOnce=func;return this};Router.prototype.navigateTo=function navigateTo(path){var this$1=this;return promise.resolve().then(function(){if(this$1.getCurrentLocation().pathname===path){console.warn("same path is passed.");return}this$1._history.push(path)})};Router.prototype.replace=function replace(path){var this$1=this;return promise.resolve().then(function(){if(this$1.getCurrentLocation().pathname===path){console.warn("same path is passed.");return}this$1._history.replace(path)})};Router.prototype.getCurrentLocation=function getCurrentLocation(){return this._history.location};Router.prototype.getCurrentAction=function getCurrentAction(){return this._history.action};Router.prototype.createHref=function createHref(pathname){return this._history.createHref({pathname:pathname})};Router.prototype._change=function _change(location){var this$1=this;var route=array_1(this._routes,function(route){return!!route.regexp.exec(location.pathname)});if(!route){return}var data=this._parseLocation(location,route);var isReplaced=false;var replace=function(path){isReplaced=true;this$1.replace(path)};promise.resolve().then(function(){if(!this$1._onBeforeOnce){return promise.resolve()}var onBeforeOnce=this$1._onBeforeOnce;this$1._onBeforeOnce=null;return onBeforeOnce(data)}).then(function(){if(!this$1._onBefore){return promise.resolve()}return this$1._onBefore(data)}).then(function(){if(!route.onBefore){return promise.resolve()}return route.onBefore(data,replace)}).then(function(){if(isReplaced||!route.onEnter){return promise.resolve()}return route.onEnter(data)}).then(function(){if(isReplaced||!route.onAfter){return promise.resolve()}return route.onAfter(data)}).then(function(){if(isReplaced||!this$1._onAfter){return promise.resolve()}return this$1._onAfter(data)}).then(function(){if(isReplaced||!this$1._onAfterOnce){return promise.resolve()}var onAfterOnce=this$1._onAfterOnce;this$1._onAfterOnce=null;return onAfterOnce(data)}).catch(function(err){console.error(err.message||"couldn't route. check the onBefore and onAfter functions.")})};Router.prototype._parseLocation=function _parseLocation(location,route){var params={};var list=route.regexp.exec(location.pathname).slice(1);array_2(route.keys,function(v,i){params[v.name]=list[i]});var queries={};array_2(location.search.slice(1).split("&"),function(v){if(!v){return}var pair=v.split("=");queries[pair[0]]=pair[1]});var hash=location.hash.slice(1);return{params:params,queries:queries,hash:hash,pathname:location.pathname}};Router.BROWSER=constants.BROWSER;Router.MEMORY=constants.MEMORY;Router.HASH=constants.HASH;var script=function(){const updateText=()=>{const json=JSON.stringify(this.opts.data,undefined,4);let text=json.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");text=text.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,match=>{let cls="number";if(/^"/.test(match)){if(/:$/.test(match)){cls="key"}else{cls="string"}}else if(/true|false/.test(match)){cls="boolean"}else if(/null/.test(match)){cls="null"}return'<span class="Prettyprint__'+cls+'">'+match+"</span>"});this.refs.canvas.innerHTML=text};this.on("mount",()=>{updateText()}).on("updated",()=>{updateText()})};riot$1.tag2("viron-prettyprint",'<pre class="Prettyprint__canvas" ref="canvas"></pre>',"",'class="Prettyprint"',function(opts){this.external(script)});var script$1=function(){this.title=this.opts.title;this.message=this.opts.message;if(!!this.opts.error){this.title=this.title||this.opts.error.name||this.opts.error.statusText||"Error";this.message=this.message||this.opts.error.message}this.detail=null;this.on("mount",()=>{const error=this.opts.error;if(!error){return}if(error instanceof Error){return}Promise.resolve().then(()=>{if(!!error.json){return error.json()}return error.text().then(text=>JSON.parse(text))}).then(json=>{const error=json.error;this.detail=error;!this.opts.title&&!!error.name&&(this.title=error.name);!this.opts.message&&!!error.data&&!!error.data.message&&(this.message=error.data.message);this.update()}).catch(()=>{return Promise.resolve()})})};riot$1.tag2("viron-error",'<div class="Error__title">{title}</div> <div class="Error__message" if="{!!message}">{message}</div> <viron-prettyprint if="{!!detail}" data="{detail}"></viron-prettyprint>',"",'class="Error"',function(opts){this.external(script$1)});var ComponentsRoute={onBefore:(store,route,replace)=>{const endpointKey=route.params.endpointKey;const endpoint=store.getter("endpoints.one",endpointKey);if(!endpoint){return Promise.resolve().then(()=>{replace("/")}).catch(err=>store.action("modals.add","viron-error",{error:err}))}return Promise.resolve().then(()=>store.action("current.update",endpointKey)).then(()=>{const isVironExist=store.getter("viron.existence");if(isVironExist){return Promise.resolve()}return Promise.resolve().then(()=>store.action("oas.setup",endpointKey,endpoint.url,endpoint.token)).then(()=>store.action("viron.get"))}).then(()=>{if(!route.params.page){return Promise.resolve().then(()=>{const pageName=store.getter("viron.pageIdOf",0);replace(`/${endpointKey}/${pageName}`)})}return store.action("page.get",route.params.page)}).catch(err=>{if(err.status!==401){return store.action("modals.add","viron-error",{error:err})}return Promise.resolve().then(()=>store.action("modals.add","viron-error",{title:"Ë™çË®ºÂàá„Çå",message:"Ë™çË®º„ÅåÂàá„Çå„Åæ„Åó„Åü„ÄÇÂÜçÂ∫¶„É≠„Ç∞„Ç§„É≥„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ"})).then(()=>{replace("/")})})},onEnter:(store,route)=>{return store.action("location.update",{name:"components",route:route})}};var EndpointsRoute={onBefore:store=>{return Promise.resolve().then(()=>Promise.all([store.action("current.remove"),store.action("page.remove"),store.action("oas.clear"),store.action("viron.remove")])).catch(err=>store.action("modals.add","viron-error",{error:err}))},onEnter:(store,route)=>{return store.action("location.update",{name:"endpoints",route:route})}};var EndpointimportRoute={onBefore:(store,route,replace)=>{const endpoint=JSON.parse(decodeURIComponent(route.queries.endpoint));const url=endpoint.url;if(!!store.getter("endpoints.oneByURL",url)){return Promise.resolve().then(()=>{replace("/");store.action("toasts.add",{message:`Êó¢„Å´„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà(${url})„ÅåÂ≠òÂú®„Åó„Åæ„Åô„ÄÇ`})})}return Promise.resolve().then(()=>store.action("endpoints.mergeOneWithKey",endpoint)).then(()=>store.action("modals.add","viron-error",{title:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàËøΩÂä†",message:`„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà(${url})„Åå‰∏ÄË¶ß„Å´ËøΩÂä†„Åï„Çå„Åæ„Åó„Åü„ÄÇ`})).then(()=>{replace("/")}).catch(err=>{replace("/");store.action("modals.add","viron-error",{title:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàËøΩÂä† Â§±Êïó",message:`„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà(${url})„ÇíËøΩÂä†Âá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ`,error:err})})}};var NotfoundRoute={onEnter:(store,route)=>{return store.action("location.update",{name:"notfound",route:route})}};var OauthredirectRoute={onBefore:(store,route,replace)=>{const endpointKey=route.params.endpointKey;const token=route.queries.token;const isAuthorized=!!token;let to;const tasks=[];if(isAuthorized){to=`/${endpointKey}`;tasks.push(store.action("auth.update",endpointKey,decodeURIComponent(token)))}else{to="/";tasks.push(store.action("auth.remove",endpointKey));tasks.push(store.action("modals.add","viron-error",{title:"Ë™çË®ºÂ§±Êïó",message:"OAuthË™çË®º„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇÊ≠£„Åó„ÅÑ„Ç¢„Ç´„Ç¶„É≥„Éà„ÅßÂÜçÂ∫¶„ÅäË©¶„Åó‰∏ã„Åï„ÅÑ„ÄÇË©≥„Åó„ÅÑ„Ç®„É©„ÉºÂéüÂõ†„Å´„Å§„ÅÑ„Å¶„ÅØÁÆ°ÁêÜËÄÖ„Å´Âïè„ÅÑÂêà„Çè„Åõ„Å¶‰∏ã„Åï„ÅÑ„ÄÇ"}))}return Promise.all(tasks).then(()=>{replace(to)}).catch(err=>store.action("modals.add","viron-error",{error:err}))}};let esr;var router={init:store=>{return Promise.resolve().then(()=>{const router=new Router(Router.HASH);router.onBefore(()=>Promise.all([store.action("application.startNavigation")])).on("/",route=>EndpointsRoute.onEnter(store,route),(route,replace)=>EndpointsRoute.onBefore(store,route,replace)).on("/oauthredirect/:endpointKey",()=>Promise.resolve(),(route,replace)=>OauthredirectRoute.onBefore(store,route,replace)).on("/endpointimport",()=>Promise.resolve(),(route,replace)=>EndpointimportRoute.onBefore(store,route,replace)).on("/:endpointKey/:page?",route=>ComponentsRoute.onEnter(store,route),(route,replace)=>ComponentsRoute.onBefore(store,route,replace)).on("*",route=>NotfoundRoute.onEnter(store,route)).onAfter(()=>Promise.all([store.action("application.endNavigation")])).onAfterOnce(()=>store.action("application.launch"));return router}).then(router=>{router.start();esr=router;return router})},getInstance:()=>{return esr}};const isTouchEventSupported="ontouchstart"in document;const TAP_ALLOW_RANGE=10;const TAP_HOLD_CLASSNAME="hold";var mixin={init:()=>{return Promise.resolve().then(()=>{riot$1.settings.autoUpdate=false;riot$1.mixin({init:function(){this.i18n=i18n.get()},listen:function(...args){const store=this.riotx.get();this.riotxChange(store,...args)},external:function(script){const tag=this;script.apply(tag)},close:function(){if(this.opts.isModal){this.opts.modalCloser()}if(this.opts.isMediapreview){this.opts.mediapreviewCloser()}if(this.opts.isDrawer){this.opts.drawerCloser()}if(this.opts.isPopover){this.opts.popoverCloser()}},getRouter:()=>{return router.getInstance()},getClickHandler:function(handlerName){if(isTouchEventSupported){return false}let context=this;while(handlerName.indexOf("parent.")===0){handlerName=handlerName.replace("parent.","");context=context.parent}return context[handlerName]},getTouchStartHandler:function(){if(!isTouchEventSupported){return false}return e=>{const initX=e.touches[0].pageX;const initY=e.touches[0].pageY;e.currentTarget.setAttribute("touch_start_x",initX);e.currentTarget.setAttribute("touch_start_y",initY);e.currentTarget.classList.add(TAP_HOLD_CLASSNAME)}},getTouchMoveHandler:function(){if(!isTouchEventSupported){return false}return e=>{const isPressed=e.currentTarget.classList.contains(TAP_HOLD_CLASSNAME);if(!isPressed){return}const initX=e.currentTarget.getAttribute("touch_start_x");const initY=e.currentTarget.getAttribute("touch_start_y");const curX=e.touches[0].pageX;const curY=e.touches[0].pageY;const distanceX=curX-initX;const distanceY=curY-initY;const hypotenuse=Math.sqrt(Math.pow(distanceX,2)+Math.pow(distanceY,2));if(hypotenuse>=TAP_ALLOW_RANGE){e.currentTarget.classList.remove(TAP_HOLD_CLASSNAME)}}},getTouchEndHandler:function(handlerName){if(!isTouchEventSupported){return false}let context=this;while(handlerName.indexOf("parent.")===0){handlerName=handlerName.replace("parent.","");context=context.parent}const handler=context[handlerName];return e=>{const isPressed=e.currentTarget.classList.contains(TAP_HOLD_CLASSNAME);if(isPressed){handler(e)}e.currentTarget.classList.remove(TAP_HOLD_CLASSNAME)}}})})}};var promise$1=createCommonjsModule(function(module){(function(root){var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof fn!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self){throw new TypeError("A promise cannot be resolved with itself.")}if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done){return}done=true;resolve(self,value)},function(reason){if(done){return}done=true;reject(self,reason)})}catch(ex){if(done){return}done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(args.length===0){return resolve([])}var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};Promise._setImmediateFn=function _setImmediateFn(fn){Promise._immediateFn=fn};Promise._setUnhandledRejectionFn=function _setUnhandledRejectionFn(fn){Promise._unhandledRejectionFn=fn};if("object"!=="undefined"&&module.exports){module.exports=Promise}else if(!root.Promise){root.Promise=Promise}})(commonjsGlobal)});(function(self){"use strict";if(self.fetch){return}var support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{new Blob;return true}catch(e){return false}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(support.arrayBuffer){var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"];var isDataView=function(obj){return obj&&DataView.prototype.isPrototypeOf(obj)};var isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&viewClasses.indexOf(Object.prototype.toString.call(obj))>-1}}function normalizeName(name){if(typeof name!=="string"){name=String(name)}if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)){throw new TypeError("Invalid character in header field name")}return name.toLowerCase()}function normalizeValue(value){if(typeof value!=="string"){value=String(value)}return value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:value===undefined,value:value}}};if(support.iterable){iterator[Symbol.iterator]=function(){return iterator}}return iterator}function Headers(headers){this.map={};if(headers instanceof Headers){headers.forEach(function(value,name){this.append(name,value)},this)}else if(Array.isArray(headers)){headers.forEach(function(header){this.append(header[0],header[1])},this)}else if(headers){Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}}Headers.prototype.append=function(name,value){name=normalizeName(name);value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+","+value:value};Headers.prototype["delete"]=function(name){delete this.map[normalizeName(name)]};Headers.prototype.get=function(name){name=normalizeName(name);return this.has(name)?this.map[name]:null};Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))};Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)};Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map){if(this.map.hasOwnProperty(name)){callback.call(thisArg,this.map[name],name,this)}}};Headers.prototype.keys=function(){var items=[];this.forEach(function(value,name){items.push(name)});return iteratorFor(items)};Headers.prototype.values=function(){var items=[];this.forEach(function(value){items.push(value)});return iteratorFor(items)};Headers.prototype.entries=function(){var items=[];this.forEach(function(value,name){items.push([name,value])});return iteratorFor(items)};if(support.iterable){Headers.prototype[Symbol.iterator]=Headers.prototype.entries}function consumed(body){if(body.bodyUsed){return Promise.reject(new TypeError("Already read"))}body.bodyUsed=true}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)};reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader;var promise=fileReaderReady(reader);reader.readAsArrayBuffer(blob);return promise}function readBlobAsText(blob){var reader=new FileReader;var promise=fileReaderReady(reader);reader.readAsText(blob);return promise}function readArrayBufferAsText(buf){var view=new Uint8Array(buf);var chars=new Array(view.length);for(var i=0;i<view.length;i++){chars[i]=String.fromCharCode(view[i])}return chars.join("")}function bufferClone(buf){if(buf.slice){return buf.slice(0)}else{var view=new Uint8Array(buf.byteLength);view.set(new Uint8Array(buf));return view.buffer}}function Body(){this.bodyUsed=false;this._initBody=function(body){this._bodyInit=body;if(!body){this._bodyText=""}else if(typeof body==="string"){this._bodyText=body}else if(support.blob&&Blob.prototype.isPrototypeOf(body)){this._bodyBlob=body}else if(support.formData&&FormData.prototype.isPrototypeOf(body)){this._bodyFormData=body}else if(support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)){this._bodyText=body.toString()}else if(support.arrayBuffer&&support.blob&&isDataView(body)){this._bodyArrayBuffer=bufferClone(body.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else if(support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(body)||isArrayBufferView(body))){this._bodyArrayBuffer=bufferClone(body)}else{throw new Error("unsupported BodyInit type")}if(!this.headers.get("content-type")){if(typeof body==="string"){this.headers.set("content-type","text/plain;charset=UTF-8")}else if(this._bodyBlob&&this._bodyBlob.type){this.headers.set("content-type",this._bodyBlob.type)}else if(support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)){this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8")}}};if(support.blob){this.blob=function(){var rejected=consumed(this);if(rejected){return rejected}if(this._bodyBlob){return Promise.resolve(this._bodyBlob)}else if(this._bodyArrayBuffer){return Promise.resolve(new Blob([this._bodyArrayBuffer]))}else if(this._bodyFormData){throw new Error("could not read FormData body as blob")}else{return Promise.resolve(new Blob([this._bodyText]))}};this.arrayBuffer=function(){if(this._bodyArrayBuffer){return consumed(this)||Promise.resolve(this._bodyArrayBuffer)}else{return this.blob().then(readBlobAsArrayBuffer)}}}this.text=function(){var rejected=consumed(this);if(rejected){return rejected}if(this._bodyBlob){return readBlobAsText(this._bodyBlob)}else if(this._bodyArrayBuffer){return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))}else if(this._bodyFormData){throw new Error("could not read FormData body as text")}else{return Promise.resolve(this._bodyText)}};if(support.formData){this.formData=function(){return this.text().then(decode)}}this.json=function(){return this.text().then(JSON.parse)};return this}var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method}function Request(input,options){options=options||{};var body=options.body;if(input instanceof Request){if(input.bodyUsed){throw new TypeError("Already read")}this.url=input.url;this.credentials=input.credentials;if(!options.headers){this.headers=new Headers(input.headers)}this.method=input.method;this.mode=input.mode;if(!body&&input._bodyInit!=null){body=input._bodyInit;input.bodyUsed=true}}else{this.url=String(input)}this.credentials=options.credentials||this.credentials||"omit";if(options.headers||!this.headers){this.headers=new Headers(options.headers)}this.method=normalizeMethod(options.method||this.method||"GET");this.mode=options.mode||this.mode||null;this.referrer=null;if((this.method==="GET"||this.method==="HEAD")&&body){throw new TypeError("Body not allowed for GET or HEAD requests")}this._initBody(body)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})};function decode(body){var form=new FormData;body.trim().split("&").forEach(function(bytes){if(bytes){var split=bytes.split("=");var name=split.shift().replace(/\+/g," ");var value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}});return form}function parseHeaders(rawHeaders){var headers=new Headers;rawHeaders.split(/\r?\n/).forEach(function(line){var parts=line.split(":");var key=parts.shift().trim();if(key){var value=parts.join(":").trim();headers.append(key,value)}});return headers}Body.call(Request.prototype);function Response(bodyInit,options){if(!options){options={}}this.type="default";this.status="status"in options?options.status:200;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in options?options.statusText:"OK";this.headers=new Headers(options.headers);this.url=options.url||"";this._initBody(bodyInit)}Body.call(Response.prototype);Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})};Response.error=function(){var response=new Response(null,{status:0,statusText:""});response.type="error";return response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(redirectStatuses.indexOf(status)===-1){throw new RangeError("Invalid status code")}return new Response(null,{status:status,headers:{location:url}})};self.Headers=Headers;self.Request=Request;self.Response=Response;self.fetch=function(input,init){return new Promise(function(resolve,reject){var request=new Request(input,init);var xhr=new XMLHttpRequest;xhr.onload=function(){var options={status:xhr.status,statusText:xhr.statusText,headers:parseHeaders(xhr.getAllResponseHeaders()||"")};options.url="responseURL"in xhr?xhr.responseURL:options.headers.get("X-Request-URL");var body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))};xhr.onerror=function(){reject(new TypeError("Network request failed"))};xhr.ontimeout=function(){reject(new TypeError("Network request failed"))};xhr.open(request.method,request.url,true);if(request.credentials==="include"){xhr.withCredentials=true}if("responseType"in xhr&&support.blob){xhr.responseType="blob"}request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)});xhr.send(typeof request._bodyInit==="undefined"?null:request._bodyInit)})};self.fetch.polyfill=true})(typeof self!=="undefined"?self:window);window.Promise=promise$1;var VERSION$1="0.9.4";function forEach$1(arr,callback,thisObj){if(arr==null){return}var i=-1,len=arr.length;while(++i<len){if(callback.call(thisObj,arr[i],i,arr)===false){break}}}var forEach_1$1=forEach$1;function hasOwn$1(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var hasOwn_1$1=hasOwn$1;var _hasDontEnumBug$1;var _dontEnums$1;function checkDontEnum$1(){_dontEnums$1=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];_hasDontEnumBug$1=true;for(var key in{toString:null}){_hasDontEnumBug$1=false}}function forIn$1(obj,fn,thisObj){var key,i=0;if(_hasDontEnumBug$1==null){checkDontEnum$1()}for(key in obj){if(exec$1(fn,obj,key,thisObj)===false){break}}if(_hasDontEnumBug$1){var ctor=obj.constructor,isProto=!!ctor&&obj===ctor.prototype;while(key=_dontEnums$1[i++]){if((key!=="constructor"||!isProto&&hasOwn_1$1(obj,key))&&obj[key]!==Object.prototype[key]){if(exec$1(fn,obj,key,thisObj)===false){break}}}}}function exec$1(fn,obj,key,thisObj){return fn.call(thisObj,obj[key],key,obj)}var forIn_1$1=forIn$1;function forOwn$1(obj,fn,thisObj){forIn_1$1(obj,function(val,key){if(hasOwn_1$1(obj,key)){return fn.call(thisObj,obj[key],key,obj)}})}var forOwn_1$1=forOwn$1;var keys=Object.keys||function(obj){var keys=[];forOwn_1$1(obj,function(val,key){keys.push(key)});return keys};var keys_1=keys;var getOwnPropertySymbols=Object.getOwnPropertySymbols;var hasOwnProperty=Object.prototype.hasOwnProperty;var propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map(function(n){return test2[n]});if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter});if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}var index$1$1=shouldUseNative()?Object.assign:function(target,source){var arguments$1=arguments;var from;var to=toObject(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments$1[s]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to};var commonjsGlobal$2=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function createCommonjsModule$2(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}var promise$2=createCommonjsModule$2(function(module){(function(root){var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof fn!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self){throw new TypeError("A promise cannot be resolved with itself.")}if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done){return}done=true;resolve(self,value)},function(reason){if(done){return}done=true;reject(self,reason)})}catch(ex){if(done){return}done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(args.length===0){return resolve([])}var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};Promise._setImmediateFn=function _setImmediateFn(fn){Promise._immediateFn=fn};Promise._setUnhandledRejectionFn=function _setUnhandledRejectionFn(fn){Promise._unhandledRejectionFn=fn};if("object"!=="undefined"&&module.exports){module.exports=Promise}else if(!root.Promise){root.Promise=Promise}})(commonjsGlobal$2)});var settings={debug:false,default:"@",changeBindName:"riotxChange"};var log=function(){var args=[],len=arguments.length;while(len--){args[len]=arguments[len]}if(!settings.debug){return}args.unshift("[riotx]");try{console.log.apply(console,args)}catch(e){console.log(args)}};var Store=function Store(_store){this.name=_store.name;if(!this.name){this.name=settings.default;log("Default store name. name="+this.name)}this.state=index$1$1({},_store.state);this._actions=index$1$1({},_store.actions);this._mutations=index$1$1({},_store.mutations);this._getters=index$1$1({},_store.getters);riot$1.observable(this)};Store.prototype.getter=function getter(name){var args=[],len=arguments.length-1;while(len-- >0){args[len]=arguments[len+1]}log("[getter]",name,args);var context={state:index$1$1({},this.state)};return this._getters[name].apply(null,[context].concat(args))};Store.prototype.commit=function commit(name){var this$1=this;var args=[],len=arguments.length-1;while(len-- >0){args[len]=arguments[len+1]}var _state=index$1$1({},this.state);log.apply(void 0,["[commit(before)]",name,_state].concat(args));var context={getter:function(name){var args=[],len=arguments.length-1;while(len-- >0){args[len]=arguments[len+1]}return this$1.getter.apply(this$1,[name].concat(args))},state:_state};var triggers=this._mutations[name].apply(null,[context].concat(args));log.apply(void 0,["[commit(after)]",name,_state].concat(args));index$1$1(this.state,_state);forEach_1$1(triggers,function(v){this$1.trigger(v,this$1.state,this$1)})};Store.prototype.action=function action(name){var this$1=this;var args=[],len=arguments.length-1;while(len-- >0){args[len]=arguments[len+1]}log("[action]",name,args);var context={getter:function(name){var args=[],len=arguments.length-1;while(len-- >0){args[len]=arguments[len+1]}return this$1.getter.apply(this$1,[name].concat(args))},state:index$1$1({},this.state),commit:function(){var args=[],len=arguments.length;while(len--){args[len]=arguments[len]}(ref=this$1).commit.apply(ref,args);var ref}};return promise$2.resolve().then(function(){return this$1._actions[name].apply(null,[context].concat(args))})};Store.prototype.change=function change(){var args=[],len=arguments.length;while(len--){args[len]=arguments[len]}(ref=this).on.apply(ref,args);var ref};var RiotX=function RiotX(){this.version=VERSION$1||"";this.Store=Store;this.stores={};var riotxChange=function(store,evtName,handler){var args=[],len=arguments.length-3;while(len-- >0){args[len]=arguments[len+3]}this._riotx_change_handlers.push({store:store,evtName:evtName,handler:handler});args.unshift(handler);args.unshift(evtName);store.change.apply(store,args)};riot$1.mixin({init:function(){var this$1=this;this.on("unmount",function(){this$1.off("*");forEach_1$1(this$1._riotx_change_handlers,function(obj){obj.store.off(obj.evtName,obj.handler)});delete this$1.riotx;delete this$1._riotx_change_handlers;delete this$1[settings.changeBindName]});if(settings.debug){this.on("*",function(eventName){log(eventName,this$1)})}this._riotx_change_handlers=[];this[settings.changeBindName]=riotxChange},riotx:this})};RiotX.prototype.add=function add(store){if(this.stores[store.name]){throw new Error("The store instance named `"+store.name+"` already exists.")}this.stores[store.name]=store;return this};RiotX.prototype.get=function get(name){if(name===void 0){name=settings.default}return this.stores[name]};RiotX.prototype.debug=function debug(flag){settings.debug=!!flag;return this};RiotX.prototype.setChangeBindName=function setChangeBindName(name){settings.changeBindName=name;return this};RiotX.prototype.reset=function reset(){this.stores={};return this};RiotX.prototype.size=function size(){return keys_1(this.stores).length};var index$1$2=new RiotX;"use strict";var getOwnPropertySymbols$1=Object.getOwnPropertySymbols;var hasOwnProperty$1=Object.prototype.hasOwnProperty;var propIsEnumerable$1=Object.prototype.propertyIsEnumerable;function toObject$1(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative$1(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map(function(n){return test2[n]});if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter});if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}var objectAssign=shouldUseNative$1()?Object.assign:function(target,source){var from;var to=toObject$1(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from){if(hasOwnProperty$1.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols$1){symbols=getOwnPropertySymbols$1(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable$1.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to};function hasOwn$2(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var hasOwn_1$2=hasOwn$2;var _hasDontEnumBug$2;var _dontEnums$2;function checkDontEnum$2(){_dontEnums$2=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];_hasDontEnumBug$2=true;for(var key in{toString:null}){_hasDontEnumBug$2=false}}function forIn$2(obj,fn,thisObj){var key,i=0;if(_hasDontEnumBug$2==null){checkDontEnum$2()}for(key in obj){if(exec$2(fn,obj,key,thisObj)===false){break}}if(_hasDontEnumBug$2){var ctor=obj.constructor,isProto=!!ctor&&obj===ctor.prototype;while(key=_dontEnums$2[i++]){if((key!=="constructor"||!isProto&&hasOwn_1$2(obj,key))&&obj[key]!==Object.prototype[key]){if(exec$2(fn,obj,key,thisObj)===false){break}}}}}function exec$2(fn,obj,key,thisObj){return fn.call(thisObj,obj[key],key,obj)}var forIn_1$2=forIn$2;function forOwn$2(obj,fn,thisObj){forIn_1$2(obj,function(val,key){if(hasOwn_1$2(obj,key)){return fn.call(thisObj,obj[key],key,obj)}})}var forOwn_1$2=forOwn$2;var exporter=(name,funcs)=>{const ret={};forOwn_1$2(funcs,(func,id)=>{ret[`${name}.${id}`]=func});return ret};var application=exporter("application",{launch:context=>{return Promise.resolve().then(()=>{context.commit("application.launch",true)})},startNavigation:context=>{return Promise.resolve().then(()=>{context.commit("application.navigation",true)})},endNavigation:context=>{return Promise.resolve().then(()=>{context.commit("application.navigation",false)})},startDrag:context=>{return Promise.resolve().then(()=>{context.commit("application.drag",true)})},endDrag:context=>{return Promise.resolve().then(()=>{context.commit("application.drag",false)})},toggleMenu:context=>{return Promise.resolve().then(()=>{context.commit("application.menuToggle")})},updateEndpointFilterText:(context,newFilterText)=>{return Promise.resolve().then(()=>{context.commit("application.endpointFilterText",newFilterText);context.commit("application.endpointTempFilterText",newFilterText)})},updateEndpointTempFilterText:(context,newTempFilterText)=>{return Promise.resolve().then(()=>{context.commit("application.endpointTempFilterText",newTempFilterText)})},resetEndpointFilterText:context=>{return Promise.resolve().then(()=>{context.commit("application.endpointFilterText","");context.commit("application.endpointTempFilterText","")})}});function kindOf$1(val){return Object.prototype.toString.call(val).slice(8,-1)}var kindOf_1$1=kindOf$1;function isKind$1(val,kind){return kindOf_1$1(val)===kind}var isKind_1$1=isKind$1;function isObject(val){return isKind_1$1(val,"Object")}var isObject_1=isObject;const jsonConverter=body=>{return JSON.stringify(body)};const urlEncodedStandardQueryStringConverter=body=>{const strings=[];const keys=Object.keys(body);keys.forEach(key=>{const value=body[key];const string=`${encodeURIComponent(key)}=${encodeURIComponent(value)}`;strings.push(string)});return strings.join("&")};const formDataConverter=body=>{const formData=new FormData;const keys=Object.keys(body);keys.forEach(key=>{const value=body[key];if(isObject_1(value)||Array.isArray(value)){formData.append(key,JSON.stringify(value))}else if(value!=null){formData.append(key,value)}});return formData};const commonFetch=(context,url,options)=>{options=objectAssign({mode:"cors",redirect:"follow",headers:{"Content-Type":"application/json"},cache:"no-store"},options);if(!!options.body&&(options.method==="POST"||options.method==="PUT")){switch(options.headers["Content-Type"]){case"application/json":options.body=jsonConverter(options.body);break;case"application/x-www-form-urlencoded":options.body=urlEncodedStandardQueryStringConverter(options.body);break;case"multipart/form-data":options.body=formDataConverter(options.body);break;default:break}}const networkingId=`networking_${Date.now()}`;return Promise.resolve().then(()=>context.commit("application.addNetworking",{id:networkingId,url:url,options:options})).then(()=>Promise.race([fetch(url,options),new Promise((resolve,reject)=>{setTimeout(()=>{reject(new Error("ÊôÇÈñì„Åå„Åã„Åã„ÇäÈÅé„Åé„Åü„Åü„ÇÅÈÄö‰ø°„Çí‰∏≠Êñ≠„Åó„Åæ„Åó„Åü„ÄÇ"))},1e3*10)})])).then(response=>{context.commit("application.removeNetworking",networkingId,context);return response}).then(response=>{if(!response.ok){return Promise.reject(response)}return Promise.resolve(response)}).catch(err=>{context.commit("application.removeNetworking",networkingId,context);throw err})};var auth=exporter("auth",{update:(context,endpointKey,token)=>{return Promise.resolve().then(()=>{context.commit("endpoints.updateToken",endpointKey,token)})},remove:(context,endpointKey)=>{return Promise.resolve().then(()=>{context.commit("endpoints.updateToken",endpointKey,null)})},validate:(context,endpointKey)=>{const endpoint=context.getter("endpoints.one",endpointKey);return Promise.resolve().then(()=>commonFetch(context,endpoint.url,{headers:{Authorization:endpoint.token}})).then(response=>{const token=response.headers.get("Authorization");if(!!token){context.commit("endpoints.updateToken",endpointKey,token)}return true}).catch(err=>{if(err.status!==401){throw err}context.commit("endpoints.updateToken",endpointKey,null);return false})},getTypes:(context,endpointKey)=>{const endpoint=context.getter("endpoints.one",endpointKey);const fetchUrl=`${new URL(endpoint.url).origin}/viron_authtype`;return Promise.resolve().then(()=>commonFetch(context,fetchUrl)).then(response=>response.json())},signinOAuth:(context,endpointKey,authtype)=>{return Promise.resolve().then(()=>{const endpoint=context.getter("endpoints.one",endpointKey);const origin=new URL(endpoint.url).origin;const redirect_url=encodeURIComponent(`${location.href}oauthredirect/${endpointKey}`);const fetchUrl=`${origin}${authtype.url}?redirect_url=${redirect_url}`;location.href=fetchUrl})},signinEmail:(context,endpointKey,authtype,email,password)=>{const endpoint=context.getter("endpoints.one",endpointKey);const fetchUrl=`${new URL(endpoint.url).origin}${authtype.url}`;return Promise.resolve().then(()=>commonFetch(context,fetchUrl,{method:authtype.method,body:{email:email,password:password}})).then(response=>{const token=response.headers.get("Authorization");context.commit("endpoints.updateToken",endpointKey,token)})}});function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};function resolve(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:"/";if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter$1(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."}function normalize(path){var isPathAbsolute=isAbsolute$1(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter$1(path.split("/"),function(p){return!!p}),!isPathAbsolute).join("/");if(!path&&!isPathAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isPathAbsolute?"/":"")+path}function isAbsolute$1(path){return path.charAt(0)==="/"}function join$1(){var paths=Array.prototype.slice.call(arguments,0);return normalize(filter$1(paths,function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p}).join("/"))}function relative(from,to){from=resolve(from).substr(1);to=resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!==""){break}}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!==""){break}}if(start>end){return[]}return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")}var sep="/";var delimiter=":";function dirname(path){var result=splitPath(path),root=result[0],dir=result[1];if(!root&&!dir){return"."}if(dir){dir=dir.substr(0,dir.length-1)}return root+dir}function basename$1(path,ext){var f=splitPath(path)[2];if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f}function extname(path){return splitPath(path)[3]}var path={extname:extname,basename:basename$1,dirname:dirname,sep:sep,delimiter:delimiter,relative:relative,join:join$1,isAbsolute:isAbsolute$1,normalize:normalize,resolve:resolve};function filter$1(xs,f){if(xs.filter){return xs.filter(f)}var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs)){res.push(xs[i])}}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0){start=str.length+start}return str.substr(start,len)};var path$1=Object.freeze({resolve:resolve,normalize:normalize,isAbsolute:isAbsolute$1,join:join$1,relative:relative,sep:sep,delimiter:delimiter,dirname:dirname,basename:basename$1,extname:extname,default:path});var require$$0=path$1&&path||path$1;"use strict";var contentDisposition_1=contentDisposition;var parse_1$1=parse$1;var basename=require$$0.basename;var ENCODE_URL_ATTR_CHAR_REGEXP=/[\x00-\x20"'()*,/:;<=>?@[\\\]{}\x7f]/g;var HEX_ESCAPE_REGEXP=/%[0-9A-Fa-f]{2}/;var HEX_ESCAPE_REPLACE_REGEXP=/%([0-9A-Fa-f]{2})/g;var NON_LATIN1_REGEXP=/[^\x20-\x7e\xa0-\xff]/g;var QESC_REGEXP=/\\([\u0000-\u007f])/g;var QUOTE_REGEXP=/([\\"])/g;var PARAM_REGEXP=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g;var TEXT_REGEXP=/^[\x20-\x7e\x80-\xff]+$/;var TOKEN_REGEXP=/^[!#$%&'*+.0-9A-Z^_`a-z|~-]+$/;var EXT_VALUE_REGEXP=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/;var DISPOSITION_TYPE_REGEXP=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/;function contentDisposition(filename,options){var opts=options||{};var type=opts.type||"attachment";var params=createparams(filename,opts.fallback);return format(new ContentDisposition(type,params))}function createparams(filename,fallback){if(filename===undefined){return}var params={};if(typeof filename!=="string"){throw new TypeError("filename must be a string")}if(fallback===undefined){fallback=true}if(typeof fallback!=="string"&&typeof fallback!=="boolean"){throw new TypeError("fallback must be a string or boolean")}if(typeof fallback==="string"&&NON_LATIN1_REGEXP.test(fallback)){throw new TypeError("fallback must be ISO-8859-1 string")}var name=basename(filename);var isQuotedString=TEXT_REGEXP.test(name);var fallbackName=typeof fallback!=="string"?fallback&&getlatin1(name):basename(fallback);var hasFallback=typeof fallbackName==="string"&&fallbackName!==name;if(hasFallback||!isQuotedString||HEX_ESCAPE_REGEXP.test(name)){params["filename*"]=name}if(isQuotedString||hasFallback){params.filename=hasFallback?fallbackName:name}return params}function format(obj){var parameters=obj.parameters;var type=obj.type;if(!type||typeof type!=="string"||!TOKEN_REGEXP.test(type)){throw new TypeError("invalid type")}var string=String(type).toLowerCase();if(parameters&&typeof parameters==="object"){var param;var params=Object.keys(parameters).sort();for(var i=0;i<params.length;i++){param=params[i];var val=param.substr(-1)==="*"?ustring(parameters[param]):qstring(parameters[param]);string+="; "+param+"="+val}}return string}function decodefield(str){var match=EXT_VALUE_REGEXP.exec(str);if(!match){throw new TypeError("invalid extended field value")}var charset=match[1].toLowerCase();var encoded=match[2];var value;var binary=encoded.replace(HEX_ESCAPE_REPLACE_REGEXP,pdecode);switch(charset){case"iso-8859-1":value=getlatin1(binary);break;case"utf-8":value=new Buffer(binary,"binary").toString("utf8");break;default:throw new TypeError("unsupported charset in extended field")}return value}function getlatin1(val){return String(val).replace(NON_LATIN1_REGEXP,"?")}function parse$1(string){if(!string||typeof string!=="string"){throw new TypeError("argument string is required")}var match=DISPOSITION_TYPE_REGEXP.exec(string);if(!match){throw new TypeError("invalid type format")}var index=match[0].length;var type=match[1].toLowerCase();var key;var names=[];var params={};var value;index=PARAM_REGEXP.lastIndex=match[0].substr(-1)===";"?index-1:index;while(match=PARAM_REGEXP.exec(string)){if(match.index!==index){throw new TypeError("invalid parameter format")}index+=match[0].length;key=match[1].toLowerCase();value=match[2];if(names.indexOf(key)!==-1){throw new TypeError("invalid duplicate parameter")}names.push(key);if(key.indexOf("*")+1===key.length){key=key.slice(0,-1);value=decodefield(value);params[key]=value;continue}if(typeof params[key]==="string"){continue}if(value[0]==='"'){value=value.substr(1,value.length-2).replace(QESC_REGEXP,"$1")}params[key]=value}if(index!==-1&&index!==string.length){throw new TypeError("invalid parameter format")}return new ContentDisposition(type,params)}function pdecode(str,hex){return String.fromCharCode(parseInt(hex,16))}function pencode(char){var hex=String(char).charCodeAt(0).toString(16).toUpperCase();return hex.length===1?"%0"+hex:"%"+hex}function qstring(val){var str=String(val);return'"'+str.replace(QUOTE_REGEXP,"\\$1")+'"'}function ustring(val){var str=String(val);var encoded=encodeURIComponent(str).replace(ENCODE_URL_ATTR_CHAR_REGEXP,pencode);return"UTF-8''"+encoded}function ContentDisposition(type,parameters){this.type=type;this.parameters=parameters}contentDisposition_1.parse=parse_1$1;var download=createCommonjsModule(function(module,exports){(function(root,factory){if(typeof undefined==="function"&&undefined.amd){undefined([],factory)}else{module.exports=factory()}})(commonjsGlobal,function(){return function download(data,strFileName,strMimeType){var self=window,defaultMime="application/octet-stream",mimeType=strMimeType||defaultMime,payload=data,url=!strFileName&&!strMimeType&&payload,anchor=document.createElement("a"),toString=function(a){return String(a)},myBlob=self.Blob||self.MozBlob||self.WebKitBlob||toString,fileName=strFileName||"download",blob,reader;myBlob=myBlob.call?myBlob.bind(self):Blob;if(String(this)==="true"){payload=[payload,mimeType];mimeType=payload[0];payload=payload[1]}if(url&&url.length<2048){fileName=url.split("/").pop().split("?")[0];anchor.href=url;if(anchor.href.indexOf(url)!==-1){var ajax=new XMLHttpRequest;ajax.open("GET",url,true);ajax.responseType="blob";ajax.onload=function(e){download(e.target.response,fileName,defaultMime)};setTimeout(function(){ajax.send()},0);return ajax}}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(payload)){if(payload.length>1024*1024*1.999&&myBlob!==toString){payload=dataUrlToBlob(payload);mimeType=payload.type||defaultMime}else{return navigator.msSaveBlob?navigator.msSaveBlob(dataUrlToBlob(payload),fileName):saver(payload)}}blob=payload instanceof myBlob?payload:new myBlob([payload],{type:mimeType});function dataUrlToBlob(strUrl){var parts=strUrl.split(/[:;,]/),type=parts[1],decoder=parts[2]=="base64"?atob:decodeURIComponent,binData=decoder(parts.pop()),mx=binData.length,i=0,uiArr=new Uint8Array(mx);for(i;i<mx;++i){uiArr[i]=binData.charCodeAt(i)}return new myBlob([uiArr],{type:type})}function saver(url,winMode){if("download"in anchor){anchor.href=url;anchor.setAttribute("download",fileName);anchor.className="download-js-link";anchor.innerHTML="downloading...";anchor.style.display="none";document.body.appendChild(anchor);setTimeout(function(){anchor.click();document.body.removeChild(anchor);if(winMode===true){setTimeout(function(){self.URL.revokeObjectURL(anchor.href)},250)}},66);return true}if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)){url=url.replace(/^data:([\w\/\-\+]+)/,defaultMime);if(!window.open(url)){if(confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")){location.href=url}}return true}var f=document.createElement("iframe");document.body.appendChild(f);if(!winMode){url="data:"+url.replace(/^data:([\w\/\-\+]+)/,defaultMime)}f.src=url;setTimeout(function(){document.body.removeChild(f)},333)}if(navigator.msSaveBlob){return navigator.msSaveBlob(blob,fileName)}if(self.URL){saver(self.URL.createObjectURL(blob),true)}else{if(typeof blob==="string"||blob.constructor===toString){try{return saver("data:"+mimeType+";base64,"+self.btoa(blob))}catch(y){return saver("data:"+mimeType+","+encodeURIComponent(blob))}}reader=new FileReader;reader.onload=function(e){saver(this.result)};reader.readAsDataURL(blob)}return true}})});var components=exporter("components",{get:(context,componentId,componentDef,query)=>{if(query===void 0)query={};const method=componentDef.api.method;if(method!=="get"){return Promise.reject("only `get` method is allowed.")}let path=componentDef.api.path;if(path.indexOf("/")!==0){path="/"+path}const api=context.getter("oas.apiByPathAndMethod",path,method);const currentEndpointKey=context.getter("current.all");const currentEndpoint=context.getter("endpoints.one",currentEndpointKey);const token=currentEndpoint.token;const networkingId=`networking_${Date.now()}`;return Promise.resolve().then(()=>context.commit("application.addNetworking",{id:networkingId})).then(()=>api(query,{requestInterceptor:req=>{req.headers["Authorization"]=token}})).then(res=>{if(!res.ok){return Promise.reject(res)}return res}).then(res=>{const token=res.headers["Authorization"];if(!!token){context.commit("endpoints.updateToken",currentEndpointKey,token)}context.commit("components.updateOne",componentId,componentDef,res.obj,res.headers);context.commit("application.removeNetworking",networkingId,context)}).catch(err=>{context.commit("application.removeNetworking",networkingId,context);throw err})},operate:(context,operationObject,params)=>{const api=context.getter("oas.api",operationObject.operationId);const token=context.getter("endpoints.one",context.getter("current.all")).token;const currentEndpointKey=context.getter("current.all");const networkingId=`networking_${Date.now()}`;return Promise.resolve().then(()=>context.commit("application.addNetworking",{id:networkingId})).then(()=>api(params,{requestInterceptor:req=>{req.headers["Authorization"]=token}})).then(res=>{if(!res.ok){return Promise.reject(res)}return res}).then(res=>{context.commit("application.removeNetworking",networkingId,context);const token=res.headers["Authorization"];if(!!token){context.commit("endpoints.updateToken",currentEndpointKey,token)}const contentDispositionHeader=res.headers["content-disposition"];if(!contentDispositionHeader){return res}const downloadFileInfo=contentDisposition_1.parse(contentDispositionHeader);if(downloadFileInfo.type!=="attachment"){return res}download(res.data,downloadFileInfo.parameters.filename,res.headers["content-type"]);return res}).catch(err=>{context.commit("application.removeNetworking",networkingId,context);throw err})},remove:(context,component_uid)=>{return Promise.resolve().then(()=>{context.commit("components.removeOne",component_uid)})},removeAll:context=>{return Promise.resolve().then(()=>{context.commit("components.removeAll")})}});var current=exporter("current",{update:(context,endpointKey)=>{return Promise.resolve().then(()=>{context.commit("current.all",endpointKey)})},remove:context=>{return Promise.resolve().then(()=>{context.commit("current.all",null)})}});var drawers=exporter("drawers",{add:(context,tagName,tagOpts,drawerOpts)=>{return Promise.resolve().then(()=>{context.commit("drawers.add",tagName,tagOpts,drawerOpts)})},remove:(context,drawerId)=>{return Promise.resolve().then(()=>{context.commit("drawers.remove",drawerId)})}});"use strict";var seed=1;function getNextValue(){seed=(seed*9301+49297)%233280;return seed/233280}function setSeed$1(_seed_){seed=_seed_}var randomFromSeed={nextValue:getNextValue,seed:setSeed$1};"use strict";var ORIGINAL="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";var alphabet;var previousSeed;var shuffled;function reset(){shuffled=false}function setCharacters(_alphabet_){if(!_alphabet_){if(alphabet!==ORIGINAL){alphabet=ORIGINAL;reset()}return}if(_alphabet_===alphabet){return}if(_alphabet_.length!==ORIGINAL.length){throw new Error("Custom alphabet for shortid must be "+ORIGINAL.length+" unique characters. You submitted "+_alphabet_.length+" characters: "+_alphabet_)}var unique=_alphabet_.split("").filter(function(item,ind,arr){return ind!==arr.lastIndexOf(item)});if(unique.length){throw new Error("Custom alphabet for shortid must be "+ORIGINAL.length+" unique characters. These characters were not unique: "+unique.join(", "))}alphabet=_alphabet_;reset()}function characters(_alphabet_){setCharacters(_alphabet_);return alphabet}function setSeed(seed){randomFromSeed.seed(seed);if(previousSeed!==seed){reset();previousSeed=seed}}function shuffle$1(){if(!alphabet){setCharacters(ORIGINAL)}var sourceArray=alphabet.split("");var targetArray=[];var r=randomFromSeed.nextValue();var characterIndex;while(sourceArray.length>0){r=randomFromSeed.nextValue();characterIndex=Math.floor(r*sourceArray.length);targetArray.push(sourceArray.splice(characterIndex,1)[0])}return targetArray.join("")}function getShuffled(){if(shuffled){return shuffled}shuffled=shuffle$1();return shuffled}function lookup(index){var alphabetShuffled=getShuffled();return alphabetShuffled[index]}var alphabet_1={characters:characters,seed:setSeed,lookup:lookup,shuffled:getShuffled};"use strict";var crypto=typeof window==="object"&&(window.crypto||window.msCrypto);function randomByte(){if(!crypto||!crypto.getRandomValues){return Math.floor(Math.random()*256)&48}var dest=new Uint8Array(1);crypto.getRandomValues(dest);return dest[0]&48}var randomByteBrowser=randomByte;"use strict";function encode(lookup,number){var loopCounter=0;var done;var str="";while(!done){str=str+lookup(number>>4*loopCounter&15|randomByteBrowser());done=number<Math.pow(16,loopCounter+1);loopCounter++}return str}var encode_1=encode;"use strict";function decode(id){var characters=alphabet_1.shuffled();return{version:characters.indexOf(id.substr(0,1))&15,worker:characters.indexOf(id.substr(1,1))&15}}var decode_1=decode;"use strict";var REDUCE_TIME=1459707606518;var version=6;var counter;var previousSeconds;function build(clusterWorkerId){var str="";var seconds=Math.floor((Date.now()-REDUCE_TIME)*.001);if(seconds===previousSeconds){counter++}else{counter=0;previousSeconds=seconds}str=str+encode_1(alphabet_1.lookup,version);str=str+encode_1(alphabet_1.lookup,clusterWorkerId);if(counter>0){str=str+encode_1(alphabet_1.lookup,counter)}str=str+encode_1(alphabet_1.lookup,seconds);return str}var build_1=build;"use strict";function isShortId(id){if(!id||typeof id!=="string"||id.length<6){return false}var characters=alphabet_1.characters();var len=id.length;for(var i=0;i<len;i++){if(characters.indexOf(id[i])===-1){return false}}return true}var isValid=isShortId;"use strict";var clusterWorkerIdBrowser=0;var lib=createCommonjsModule(function(module){"use strict";var clusterWorkerId=clusterWorkerIdBrowser||0;function seed(seedValue){alphabet_1.seed(seedValue);return module.exports}function worker(workerId){clusterWorkerId=workerId;return module.exports}function characters(newCharacters){if(newCharacters!==undefined){alphabet_1.characters(newCharacters)}return alphabet_1.shuffled()}function generate(){return build_1(clusterWorkerId)}module.exports=generate;module.exports.generate=generate;module.exports.seed=seed;module.exports.worker=worker;module.exports.characters=characters;module.exports.decode=decode_1;module.exports.isValid=isValid});"use strict";var shortid=lib;var endpoints=exporter("endpoints",{add:(context,url)=>{return Promise.resolve().then(()=>commonFetch(context,url)).catch(err=>{if(err.status!==401){throw err}const key=shortid.generate();const newEndpoint={key:key,url:url,token:null,title:"",name:"",description:"",version:"",color:"",thumbnail:null,tags:[],theme:"standard"};context.commit("endpoints.add",key,newEndpoint)})},update:(context,key,newEndpoint)=>{return Promise.resolve().then(()=>{context.commit("endpoints.update",key,newEndpoint)})},remove:(context,key)=>{return Promise.resolve().then(()=>{context.commit("endpoints.remove",key)})},removeAll:context=>{return Promise.resolve().then(()=>{context.commit("endpoints.removeAll")})},mergeAll:(context,endpoints)=>{return Promise.resolve().then(()=>{context.commit("endpoints.mergeAll",endpoints)})},mergeOneWithKey:(context,endpoint)=>{return Promise.resolve().then(()=>{const key=shortid.generate();endpoint.key=key;context.commit("endpoints.add",key,endpoint)})},tidyUpOrder:context=>{return Promise.resolve().then(()=>{context.commit("endpoints.tidyUpOrder")})},changeOrder:(context,endpointKey,newOrder)=>{return Promise.resolve().then(()=>{context.commit("endpoints.changeOrder",endpointKey,newOrder)})},cleanup:context=>{return Promise.resolve().then(()=>{context.commit("endpoints.cleanup")})}});var layout=exporter("layout",{updateSize:(context,width,height)=>{return Promise.resolve().then(()=>{context.commit("layout.updateSize",width,height)})},updateComponentsGridColumnCount:(context,count)=>{return Promise.resolve().then(()=>{context.commit("layout.updateComponentsGridColumnCount",count)})}});var location$1=exporter("location",{update:(context,obj)=>{return Promise.resolve().then(()=>{context.commit("location.all",obj)})}});let canCreateMediapreview=true;let timer;var mediapreviews=exporter("mediapreviews",{add:(context,tagOpts,mediapreviewOpts)=>{if(!canCreateMediapreview){console.warn("Â§öÈáç„Å´Ëµ∑Âãï„Åó„Å™„ÅÑ„Çà„ÅÜ„ÄÅ‰∏ÄÂÆöÊôÇÈñì„ÅÆ‰ΩúÊàê„ÇíË¶èÂà∂„Åô„Çã„ÄÇ");return Promise.resolve()}canCreateMediapreview=false;clearTimeout(timer);timer=setTimeout(()=>{canCreateMediapreview=true},300);return Promise.resolve().then(()=>{context.commit("mediapreviews.add",tagOpts,mediapreviewOpts)})},remove:(context,mediapreviewId)=>{return Promise.resolve().then(()=>{context.commit("mediapreviews.remove",mediapreviewId)})}});let canCreateModal=true;let timer$1;var modals=exporter("modals",{add:(context,tagName,tagOpts,modalOpts)=>{if(!canCreateModal){console.warn("Â§öÈáç„Å´Ëµ∑Âãï„Åó„Å™„ÅÑ„Çà„ÅÜ„ÄÅ‰∏ÄÂÆöÊôÇÈñì„ÅÆ„É¢„Éº„ÉÄ„É´‰ΩúÊàê„ÇíË¶èÂà∂„Åô„Çã„ÄÇ");return Promise.resolve()}canCreateModal=false;clearTimeout(timer$1);timer$1=setTimeout(()=>{canCreateModal=true},300);return Promise.resolve().then(()=>{context.commit("modals.add",tagName,tagOpts,modalOpts)})},remove:(context,modalId)=>{return Promise.resolve().then(()=>{context.commit("modals.remove",modalId)})}});var isArray$1=Array.isArray||function(val){return isKind_1$1(val,"Array")};var isArray_1$1=isArray$1;function forEach$2(arr,callback,thisObj){if(arr==null){return}var i=-1,len=arr.length;while(++i<len){if(callback.call(thisObj,arr[i],i,arr)===false){break}}}var forEach_1$2=forEach$2;function encode$2(obj){var query=[],arrValues,reg;forOwn_1$2(obj,function(val,key){if(isArray_1$1(val)){arrValues=key+"=";reg=new RegExp("&"+key+"+=$");forEach_1$2(val,function(aValue){arrValues+=encodeURIComponent(aValue)+"&"+key+"="});query.push(arrValues.replace(reg,""))}else{query.push(key+"="+encodeURIComponent(val))}});return query.length?"?"+query.join("&"):""}var encode_1$2=encode$2;const SwaggerClient=window.SwaggerClient;var oas=exporter("oas",{setup:(context,endpointKey,url,token)=>{return Promise.resolve().then(()=>SwaggerClient.http({url:url,headers:{Authorization:token}})).then(res=>{if(res.status===401){const err=new Error;err.name="401 Authorization Required";err.status=res.spec.status;return Promise.reject(err)}return res}).then(res=>SwaggerClient({spec:res.body})).then(client=>{const errors=client.errors;if(!!errors&&!!errors.length){return Promise.reject(errors)}return client}).then(client=>{context.commit("oas.client",client);context.commit("endpoints.update",endpointKey,client.spec.info)})},clear:context=>{return Promise.resolve().then(()=>{context.commit("oas.clearClient")})},getAutocomplete:(context,path,query)=>{const currentEndpointKey=context.getter("current.all");const currentEndpoint=context.getter("endpoints.one",currentEndpointKey);const token=currentEndpoint.token;const url=`${new URL(currentEndpoint.url).origin}${path}${encode_1$2(query)}`;return Promise.resolve().then(()=>commonFetch(context,url,{headers:{Authorization:token}})).then(res=>res.json())}});function identity$1(val){return val}var identity_1$1=identity$1;function prop$1(name){return function(obj){return obj[name]}}var prop_1$1=prop$1;function containsMatch$1(array,pattern){var i=-1,length=array.length;while(++i<length){if(deepMatches$1(array[i],pattern)){return true}}return false}function matchArray$1(target,pattern){var i=-1,patternLength=pattern.length;while(++i<patternLength){if(!containsMatch$1(target,pattern[i])){return false}}return true}function matchObject$1(target,pattern){var result=true;forOwn_1$2(pattern,function(val,key){if(!deepMatches$1(target[key],val)){return result=false}});return result}function deepMatches$1(target,pattern){if(target&&typeof target==="object"&&pattern&&typeof pattern==="object"){if(isArray_1$1(target)&&isArray_1$1(pattern)){return matchArray$1(target,pattern)}else{return matchObject$1(target,pattern)}}else{return target===pattern}}var deepMatches_1$1=deepMatches$1;function makeIterator$1(src,thisObj){if(src==null){return identity_1$1}switch(typeof src){case"function":return typeof thisObj!=="undefined"?function(val,i,arr){return src.call(thisObj,val,i,arr)}:src;case"object":return function(val){return deepMatches_1$1(val,src)};case"string":case"number":return prop_1$1(src)}}var makeIterator_$1=makeIterator$1;function some$1(obj,callback,thisObj){callback=makeIterator_$1(callback,thisObj);var result=false;forOwn_1$2(obj,function(val,key){if(callback(val,key,obj)){result=true;return false}});return result}var some_1$1=some$1;function find$1(obj,callback,thisObj){callback=makeIterator_$1(callback,thisObj);var result;some_1$1(obj,function(value,key,obj){if(callback(value,key,obj)){result=value;return true}});return result}var find_1$1=find$1;var page=exporter("page",{get:(context,pageId)=>{return Promise.resolve().then(()=>{const pages=context.getter("viron.pages");const page=find_1$1(pages,page=>{return page.id===pageId});context.commit("page.all",page)})},remove:context=>{return Promise.resolve().then(()=>{context.commit("page.all",null)})}});var popovers=exporter("popovers",{add:(context,tagName,tagOpts,popoverOpts)=>{return Promise.resolve().then(()=>{context.commit("popovers.add",tagName,tagOpts,popoverOpts)})},remove:(context,popoverId)=>{return Promise.resolve().then(()=>{context.commit("popovers.remove",popoverId)})},removeAll:context=>{return Promise.resolve().then(()=>{context.commit("popovers.removeAll")})}});var toasts=exporter("toasts",{add:(context,obj)=>{return Promise.resolve().then(()=>{context.commit("toasts.add",obj)})},remove:(context,toastId)=>{return Promise.resolve().then(()=>{context.commit("toasts.remove",toastId)})}});var sua=createCommonjsModule(function(module){(function(global){"use strict";function SUA(useragent){if(!useragent&&global&&global.navigator&&global.navigator.userAgent){useragent=global.navigator.userAgent}if(!useragent){throw new Error("useragent setup error. useragent not found.")}this.ie=!!(useragent.indexOf("MSIE")>=0||useragent.indexOf("Trident")>=0||useragent.indexOf("Edge")>=0),this.webkit=useragent.match(/(WebKit|Webkit)\/([\d.]+)/),this.android=useragent.match(/(Android)\s+([\d.]+)/),this.android23=useragent.match(/(Android)\s+(2\.3)([\d.]+)/),this.android4=useragent.match(/(Android)\s+(4)([\d.]+)/),this.android5=useragent.match(/(Android)\s+(5)([\d.]+)/),this.android6=useragent.match(/(Android)\s+(6)([\d.]+)/),this.android7=useragent.match(/(Android)\s+(7)([\d.]+)/),this.ipad=useragent.match(/(iPad).*OS\s([\d_]+)/),this.iphone=!this.ipad&&useragent.match(/(iPhone\sOS)\s([\d_]+)/),this.webos=useragent.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),this.touchpad=this.webos&&useragent.match(/TouchPad/),this.kindle=useragent.match(/(Kindle)/),this.silk=useragent.match(/(Silk)/),this.blackberry=useragent.match(/(BlackBerry).*/),this.bb10=useragent.match(/(BB10).*Version\/([\d.]+)/),this.rimtabletos=useragent.match(/(RIM\sTablet\sOS)\s([\d.]+)/),this.playbook=useragent.match(/PlayBook/),this.chrome=useragent.match(/Chrome\/([\d.]+)/)||useragent.match(/CriOS\/([\d.]+)/),this.firefox=useragent.match(/Firefox\/([\d.]+)/),this.wii=useragent.match(/Nintendo (Wii);/),this.wiiu=useragent.match(/Nintendo (WiiU)/),this.ds=useragent.match(/Nintendo (DS|3DS|DSi);/),this.nintendo_switch=useragent.match(/Nintendo (Switch);/),this.ps3=useragent.match(/PLAYSTATION 3/),this.psp=useragent.match(/(PlayStation Portable)/),this.psvita=useragent.match(/(PlayStation Vita)/),this.windowsphone=useragent.match(/(Windows Phone |Windows Phone OS )([\d.]+)/),this.safari=useragent.match(/(Version)\/([0-9\.]+).*Safari\/([0-9\.]+)/),this.trident=useragent.match(/Trident\/([\d\.]+)/),this.xbox=useragent.match(/Xbox/),this.iphone5=!("object"!=="undefined"&&module.exports)&&this.iphone&&screen&&screen.width===320&&screen.height===568,this.vivaldi=useragent.match(/Vivaldi\/([\d.]+)/);this.iphone3=this.iphone&&global.devicePixelRatio===1?true:false;this.browser={locale:undefined,lang:undefined,country:undefined};this.os={};if(this.webkit&&!this.ie){this.browser.webkit=true;this.browser.version=this.webkit[1]}if(this.trident){this.browser.trident=true;this.browser.version=this.trident[1]}if(this.android){this.os.android=true;this.os.version=this.android[2];try{this.browser.locale=useragent.match(/(Android)\s(.+);\s([^;]+);/)[3];this.browser.lang=this.browser.locale.substring(0,2);this.browser.country=this.browser.locale.substring(3)}catch(e){}}if(this.iphone){this.os.ios=this.os.iphone=true;this.os.version=this.iphone[2].replace(/_/g,".")}if(this.ipad){this.os.ios=this.os.ipad=true;this.os.version=this.ipad[2].replace(/_/g,".")}if(this.os.ios){var __ios_v_0=null;if(this.os.version){__ios_v_0=this.os.version.substring(0,1)}for(var i=3;i<10;i++){this["ios"+i]=__ios_v_0===""+i}}if(this.webos){this.os.webos=true;this.os.version=this.webos[2]}if(this.touchpad){this.os.touchpad=true}if(this.blackberry){this.os.blackberry=true}if(this.bb10){this.os.bb10=true;this.os.version=this.bb10[2]}if(this.rimtabletos){this.os.rimtabletos=true;this.os.version=this.rimtabletos[2]}if(this.playbook){this.browser.playbook=true}if(this.kindle){this.os.kindle=true}if(this.silk){this.browser.silk=true}if(!this.silk&&this.os.android&&useragent.match(/Kindle Fire/)){this.browser.silk=true}if(this.chrome&&!this.ie){this.browser.chrome=true;this.browser.version=this.chrome[1]}if(this.firefox){this.browser.firefox=true;this.browser.version=this.firefox[1];if(useragent.match(/Android/)){this.android=["Android","Android",""]}}if(this.wii||this.ds||this.wiiu||this.nintendo_switch){this.os.nintendo=true;if(this.wiiu||this.nintendo_switch){this.browser.nintendo=useragent.match(/NintendoBrowser\/([\d.]+)/);this.browser.version=this.browser.nintendo[1]}}if(this.windowsphone){this.browser.windowsphone=true;this.browser.version=this.windowsphone[2]}if(this.safari){this.browser.safari=true;this.browser.version=this.safari[2]}if(this.ie){this.browser.ie=/(MSIE|rv:?)\s?([\d\.]+)/.exec(useragent);this.edge=false;if(!this.browser.ie){this.browser.ie=/(Edge\/)(\d.+)/.exec(useragent);this.browser.version=this.browser.ie[2];this.edge=true;this.chrome=false;this.webkit=false}else if(!this.windowsphone){this.browser.version=this.browser.ie?this.browser.ie[2]:""}if(0<this.browser.version.indexOf(".")){this.browser.majorversion=this.browser.version.substring(0,this.browser.version.indexOf("."))}else{this.browser.majorversion=this.browser.version}}if(this.vivaldi){this.browser.vivaldi=true;this.browser.version=this.vivaldi[1]}this.os.tablet=!!(this.ipad||this.kindle||this.playbook||this.android&&!useragent.match(/Mobile/)||this.firefox&&useragent.match(/Tablet/));this.os.phone=!!(!this.os.tablet&&(this.android||this.iphone||this.webos||this.blackberry||this.bb10||this.chrome&&useragent.match(/Android/)||this.chrome&&useragent.match(/CriOS\/([\d.]+)/)||this.firefox&&useragent.match(/Mobile/)||this.windowsphone&&useragent.match(/IEMobile/)));this.mobile=!!(this.os.tablet||this.os.phone);this.webview={};if(useragent.match(/Twitter/)){this.webview.twitter=true}}SUA.VERSION="2.1.0";if("object"!=="undefined"&&module.exports){module.exports=SUA}if(!global.SUA){global.SUA=SUA}})(commonjsGlobal)});var ua=exporter("ua",{setup:context=>{return Promise.resolve().then(()=>{const ua=new sua(navigator.userAgent);context.commit("ua.all",ua)})}});const VIRON_URI="/viron";var viron=exporter("viron",{get:context=>{const operationObject=context.getter("oas.operationObject",VIRON_URI,"get");const api=context.getter("oas.api",operationObject.operationId);const currentEndpointKey=context.getter("current.all");const currentEndpoint=context.getter("endpoints.one",currentEndpointKey);const token=currentEndpoint.token;const networkingId=`networking_${Date.now()}`;return Promise.resolve().then(()=>context.commit("application.addNetworking",{id:networkingId})).then(()=>api({},{requestInterceptor:req=>{req.headers["Authorization"]=token}})).then(res=>{if(!res.ok){return Promise.reject(res)}return res}).then(res=>{const token=res.headers["Authorization"];if(!!token){context.commit("endpoints.updateToken",currentEndpointKey,token)}context.commit("viron.all",res.obj);const endpoint=objectAssign({},res.obj);delete endpoint.pages;context.commit("endpoints.update",currentEndpointKey,endpoint);context.commit("application.removeNetworking",networkingId,context)}).catch(err=>{context.commit("application.removeNetworking",networkingId,context);throw err})},remove:context=>{return Promise.resolve().then(()=>{context.commit("viron.all",null)})}});var actions=objectAssign({},application,auth,components,current,drawers,endpoints,layout,location$1,mediapreviews,modals,oas,page,popovers,toasts,ua,viron);var exporter$1=(name,funcs)=>{const ret={};forOwn_1$2(funcs,(func,id)=>{ret[`${name}.${id}`]=((context,...args)=>{return func(context.state,...args)})});return ret};var application$1=exporter$1("application",{all:state=>{return state.application},version:state=>{return state.application.version},latestVersion:state=>{return state.application.latestVersion},isLaunched:state=>{return state.application.isLaunched},isNavigating:state=>{return state.application.isNavigating},isNetworking:state=>{return state.application.isNetworking},isDragging:state=>{return state.application.isDragging},isMenuOpened:state=>{return state.application.isMenuOpened},endpointFilterText:state=>{return state.application.endpointFilterText},endpointTempFilterText:state=>{return state.application.endpointTempFilterText}});function findIndex$1(arr,iterator,thisObj){iterator=makeIterator_$1(iterator,thisObj);if(arr==null){return-1}var i=-1,len=arr.length;while(++i<len){if(iterator(arr[i],i,arr)){return i}}return-1}var findIndex_1$1=findIndex$1;function find$3(arr,iterator,thisObj){var idx=findIndex_1$1(arr,iterator,thisObj);return idx>=0?arr[idx]:void 0}var find_1$2=find$3;function indexOf$1(arr,item,fromIndex){fromIndex=fromIndex||0;if(arr==null){return-1}var len=arr.length,i=fromIndex<0?len+fromIndex:fromIndex;while(i<len){if(arr[i]===item){return i}i++}return-1}var indexOf_1$1=indexOf$1;function map$1(arr,callback,thisObj){callback=makeIterator_$1(callback,thisObj);var results=[];if(arr==null){return results}var i=-1,len=arr.length;while(++i<len){results[i]=callback(arr[i],i,arr)}return results}var map_1$1=map$1;function mergeSort$1(arr,compareFn){if(arr==null){return[]}else if(arr.length<2){return arr}if(compareFn==null){compareFn=defaultCompare$1}var mid,left,right;mid=~~(arr.length/2);left=mergeSort$1(arr.slice(0,mid),compareFn);right=mergeSort$1(arr.slice(mid,arr.length),compareFn);return merge$1(left,right,compareFn)}function defaultCompare$1(a,b){return a<b?-1:a>b?1:0}function merge$1(left,right,compareFn){var result=[];while(left.length&&right.length){if(compareFn(left[0],right[0])<=0){result.push(left.shift())}else{result.push(right.shift())}}if(left.length){result.push.apply(result,left)}if(right.length){result.push.apply(result,right)}return result}var sort$1=mergeSort$1;function sortBy$1(arr,callback,context){callback=makeIterator_$1(callback,context);return sort$1(arr,function(a,b){a=callback(a);b=callback(b);return a<b?-1:a>b?1:0})}var sortBy_1$1=sortBy$1;function filter$2(arr,callback,thisObj){callback=makeIterator_$1(callback,thisObj);var results=[];if(arr==null){return results}var i=-1,len=arr.length,value;while(++i<len){value=arr[i];if(callback(value,i,arr)){results.push(value)}}return results}var filter_1$1=filter$2;function unique$1(arr,compare){compare=compare||isEqual$1;return filter_1$1(arr,function(item,i,arr){var n=arr.length;while(++i<n){if(compare(item,arr[i])){return false}}return true})}function isEqual$1(a,b){return a===b}var unique_1$1=unique$1;function isNumber(val){return isKind_1$1(val,"Number")}var isNumber_1=isNumber;var components$1=exporter$1("components",{all:state=>{return state.state.components},one:(state,componentId)=>{return state.components[componentId]},def:(state,componentId)=>{return state.components[componentId].def},response:(state,componentId)=>{return state.components[componentId].response},columns:(state,componentId)=>{const component=state.components[componentId];const columns=component.columns;const tableLabels=component.def.table_labels||[];return sort$1(columns,(a,b)=>{let idxA=indexOf_1$1(tableLabels,a.key);let idxB=indexOf_1$1(tableLabels,b.key);if(idxA>=0){idxA=tableLabels.length-idxA}if(idxB>=0){idxB=tableLabels.length-idxB}return idxB-idxA})},operations:(state,componentId,category)=>{const component=state.components[componentId];let operations;switch(category){case"table":operations=component.tableOperations;break;case"row":operations=component.rowOperations;break;default:operations=component.operations||[];break}return operations},postOperation:(state,componentId,category)=>{const component=state.components[componentId];let operations;switch(category){case"table":operations=component.tableOperations;break;case"row":operations=component.rowOperations;break;default:operations=component.operations||[];break}const path=component.def.api.path;const operationObject=find_1$2(operations,operation=>{return operation.path===path&&operation.method==="post"});if(!operationObject){return null}return operationObject},searchParameters:(state,componentId)=>{return state.components[componentId]["searchParameters"]},primary:(state,componentId)=>{return state.components[componentId]["primary"]},pagination:(state,riotId)=>{return state.components[riotId].pagination||null},hasPagination:(state,riotId)=>{return state.components[riotId].def.pagination&&state.components[riotId].pagination.max>=2},autoRefreshSec:(state,riotId)=>{const autoRefreshSec=state.components[riotId].autoRefreshSec;if(!isNumber_1(autoRefreshSec)){return null}return autoRefreshSec},parameterObjectsForCrossSearch:state=>{let parameterObjects=[];forOwn_1$2(state.components,component=>{parameterObjects=parameterObjects.concat(component.searchParameters||[])});const weights={};parameterObjects=map_1$1(parameterObjects,parameterObject=>{const name=parameterObject.name;weights[name]||(weights[name]=0);weights[name]=weights[name]+1;return objectAssign({},parameterObject)});parameterObjects=unique_1$1(parameterObjects,(a,b)=>{return a.name===b.name});parameterObjects=sortBy_1$1(parameterObjects,parameterObject=>{return weights[parameterObject.name]*-1});return parameterObjects}});var current$1=exporter$1("current",{all:state=>{const version=state.application.version;return state.current[version]}});var drawers$1=exporter$1("drawers",{all:state=>{return state.drawers}});function slice$2(arr,start,end){var len=arr.length;if(start==null){start=0}else if(start<0){start=Math.max(len+start,0)}else{start=Math.min(start,len)}if(end==null){end=len}else if(end<0){end=Math.max(len+end,0)}else{end=Math.min(end,len)}var result=[];while(start<end){result.push(arr[start++])}return result}var slice_1$1=slice$2;function isPlainObject(value){return!!value&&typeof value==="object"&&value.constructor===Object}var isPlainObject_1=isPlainObject;function mixIn(target,objects){var i=0,n=arguments.length,obj;while(++i<n){obj=arguments[i];if(obj!=null){forOwn_1$2(obj,copyProp,target)}}return target}function copyProp(val,key){this[key]=val}var mixIn_1=mixIn;function clone(val){switch(kindOf_1$1(val)){case"Object":return cloneObject$1(val);case"Array":return cloneArray$1(val);case"RegExp":return cloneRegExp(val);case"Date":return cloneDate(val);default:return val}}function cloneObject$1(source){if(isPlainObject_1(source)){return mixIn_1({},source)}else{return source}}function cloneRegExp(r){var flags="";flags+=r.multiline?"m":"";flags+=r.global?"g":"";flags+=r.ignoreCase?"i":"";return new RegExp(r.source,flags)}function cloneDate(date){return new Date(+date)}function cloneArray$1(arr){return arr.slice()}var clone_1=clone;function deepClone(val,instanceClone){switch(kindOf_1$1(val)){case"Object":return cloneObject(val,instanceClone);case"Array":return cloneArray(val,instanceClone);default:return clone_1(val)}}function cloneObject(source,instanceClone){if(isPlainObject_1(source)){var out={};forOwn_1$2(source,function(val,key){this[key]=deepClone(val,instanceClone)},out);return out}else if(instanceClone){return instanceClone(source)}else{return source}}function cloneArray(arr,instanceClone){var out=[],i=-1,n=arr.length;while(++i<n){out[i]=deepClone(arr[i],instanceClone)}return out}var deepClone_1=deepClone;function size(obj){var count=0;forOwn_1$2(obj,function(){count++});return count}var size_1=size;function toString(val){return val==null?"":val.toString()}var toString_1=toString;function contains$1(str,substring,fromIndex){str=toString_1(str);substring=toString_1(substring);return str.indexOf(substring,fromIndex)!==-1}var contains_1$1=contains$1;const sortByOrder=endpoints=>{let endpointsByOrder=[];forOwn_1$2(endpoints,(endpoint,key)=>{endpoint.key=key;endpointsByOrder.push(endpoint)});endpointsByOrder=sortBy_1$1(endpointsByOrder,endpoint=>{return endpoint.order});return endpointsByOrder};const filterBy=(endpoints,filterText)=>{filterText=filterText||"";filterText=filterText.replace(/„ÄÄ/g," ");filterText=filterText.replace(/,/g," ");const targetTexts=filter_1$1((filterText||"").split(" "),targetText=>{return!!targetText});if(!targetTexts.length){return endpoints}return filter_1$1(endpoints,endpoint=>{let isMatched=false;forEach_1$2(targetTexts,targetText=>{if(contains_1$1(endpoint.url,targetText)){isMatched=true}if(contains_1$1(endpoint.title,targetText)){isMatched=true}if(contains_1$1(endpoint.name,targetText)){isMatched=true}if(contains_1$1(endpoint.description,targetText)){isMatched=true}if(contains_1$1(endpoint.memo,targetText)){isMatched=true}forEach_1$2(endpoint.tags||[],tag=>{if(contains_1$1(tag,targetText)){isMatched=true}})});return isMatched})};var endpoints$1=exporter$1("endpoints",{all:state=>{const version=state.application.version;return state.endpoints[version]||{}},allByOrder:state=>{const version=state.application.version;let endpoints=objectAssign({},state.endpoints[version]);endpoints=sortByOrder(endpoints);return endpoints},allByOrderFiltered:state=>{const version=state.application.version;let endpoints=objectAssign({},state.endpoints[version]);endpoints=sortByOrder(endpoints);endpoints=filterBy(endpoints,state.application.endpointFilterText);return endpoints},namesFiltered:(state,maxSize)=>{const version=state.application.version;let endpoints=objectAssign({},state.endpoints[version]);endpoints=sortByOrder(endpoints);let names=[];forEach_1$2(endpoints,endpoint=>{if(!!endpoint.name){names.push(endpoint.name)}});names=unique_1$1(names,(a,b)=>{return a===b});let filterText=state.application.endpointTempFilterText;filterText=filterText.replace(/„ÄÄ/g," ");filterText=filterText.replace(/,/g," ");const targetTexts=filter_1$1((filterText||"").split(" "),targetText=>{return!!targetText});if(!!targetTexts.length){names=filter_1$1(names,name=>{let isMatched=true;forEach_1$2(targetTexts,targetText=>{if(!contains_1$1(name,targetText)){isMatched=false}});return isMatched})}if(!!maxSize){names=slice_1$1(names,0,maxSize)}return names},tagsFiltered:(state,maxSize)=>{const version=state.application.version;let endpoints=objectAssign({},state.endpoints[version]);endpoints=sortByOrder(endpoints);let tags=[];forEach_1$2(endpoints,endpoint=>{forEach_1$2(endpoint.tags||[],tag=>{tags.push(tag)})});tags=unique_1$1(tags,(a,b)=>{return a===b});let filterText=state.application.endpointTempFilterText;filterText=filterText.replace(/„ÄÄ/g," ");filterText=filterText.replace(/,/g," ");const targetTexts=filter_1$1((filterText||"").split(" "),targetText=>{return!!targetText});if(!!targetTexts.length){tags=filter_1$1(tags,name=>{let isMatched=true;forEach_1$2(targetTexts,targetText=>{if(!contains_1$1(name,targetText)){isMatched=false}});return isMatched})}if(!!maxSize){tags=slice_1$1(tags,0,maxSize)}return tags},count:state=>{const version=state.application.version;const endpoints=state.endpoints[version]||{};return size_1(endpoints)},allWithoutToken:state=>{const version=state.application.version;const endpoints=deepClone_1(state.endpoints[version]);forOwn_1$2(endpoints,endpoint=>{delete endpoint.token});return endpoints},one:(state,key)=>{const version=state.application.version;const endpoints=state.endpoints[version]||{};return endpoints[key]},oneByURL:(state,url)=>{const version=state.application.version;const endpoints=state.endpoints[version]||{};return find_1$1(endpoints,endpoint=>{return endpoint.url===url})}});var constants$1={layoutThreshold:640,layoutTypeDesktop:"desktop",layoutTypeMobile:"mobile",authtypeEmail:"email",authtypeOauth:"oauth"};var layout$1=exporter$1("layout",{type:state=>{return state.layout.type},isDesktop:state=>{return state.layout.type===constants$1.layoutTypeDesktop},isMobile:state=>{return state.layout.type===constants$1.layoutTypeMobile},size:state=>{return state.layout.size},componentsGridColumnCount:state=>{return state.layout.componentsGridColumnCount}});var location$2=exporter$1("location",{all:state=>{return state.location},isTop:state=>{return state.location.name==="endpoints"},name:state=>{return state.location.name},route:state=>{return state.location.route}});var mediapreviews$1=exporter$1("mediapreviews",{all:state=>{return state.mediapreviews}});var modals$1=exporter$1("modals",{all:state=>{return state.modals}});var oas$1=exporter$1("oas",{client:state=>{return state.oas.client},spec:state=>{return state.oas.client.spec},originalSpec:state=>{return state.oas.client.originalSpec},apis:state=>{return state.oas.client.apis},flatApis:state=>{const apis={};forOwn_1$2(state.oas.client.apis,obj=>{forOwn_1$2(obj,(api,operationId)=>{apis[operationId]=api})});return apis},api:(state,operationId)=>{const apis={};forOwn_1$2(state.oas.client.apis,obj=>{forOwn_1$2(obj,(api,operationId)=>{apis[operationId]=api})});return apis[operationId]},apiByPathAndMethod:(state,path,method)=>{const operationObject=state.oas.client.spec.paths[path][method];const operationId=operationObject.operationId;const apis={};forOwn_1$2(state.oas.client.apis,obj=>{forOwn_1$2(obj,(api,operationId)=>{apis[operationId]=api})});return apis[operationId]},pathItemObject:(state,path)=>{return state.oas.client.spec.paths[path]},pathItemObjectMethodNameByOperationId:(state,operationId)=>{let ret;forOwn_1$2(state.oas.client.spec.paths,pathItemObject=>{if(!!ret){return}forOwn_1$2(pathItemObject,(operationObject,method)=>{if(!!ret){return}if(operationObject.operationId===operationId){ret=method}})});return ret},operationObject:(state,path,method)=>{return state.oas.client.spec.paths[path][method]},operationObjectsAsAction:(state,component)=>{const methods=["get","put","post","delete"];const basePath=component.api.path;const primaryKey=component.primary;const actions=component.actions||[];const pathRefs=[];forEach_1$2(methods,method=>{if(method==="get"){return}const isOperationObjectDefined=!!state.oas.client.spec.paths[basePath]&&!!state.oas.client.spec.paths[basePath][method];if(!isOperationObjectDefined){return}pathRefs.push({path:basePath,method:method,appendTo:"self"})});if(!!primaryKey){const listBasePath=`${basePath}/{${primaryKey}}`;forEach_1$2(methods,method=>{const isOperationObjectDefined=!!state.oas.client.spec.paths[listBasePath]&&!!state.oas.client.spec.paths[listBasePath][method];if(!isOperationObjectDefined){return}pathRefs.push({path:listBasePath,method:method,appendTo:"row"})})}forEach_1$2(actions,actionBasePath=>{const appendTo=actionBasePath.indexOf(`{${primaryKey}}`)>=0?"row":"self";forEach_1$2(methods,method=>{const isOperationObjectDefined=!!state.oas.client.spec.paths[actionBasePath]&&!!state.oas.client.spec.paths[actionBasePath][method];if(!isOperationObjectDefined){return}pathRefs.push({path:actionBasePath,method:method,appendTo:appendTo})})});const operationObjects=[];forEach_1$2(pathRefs,ref=>{const operationObject=state.oas.client.spec.paths[ref.path][ref.method];operationObjects.push(objectAssign({operationObject:operationObject},ref))});return operationObjects},operationId:(state,path,method)=>{return state.oas.client.spec.paths[path][method].operationId},parameterObjects:(state,path,method)=>{return state.oas.client.spec.paths[path][method].parameters||[]},responseObjects:(state,path,method)=>{return state.oas.client.spec.paths[path][method].responses},responseObject:(state,path,method,statusCode)=>{if(statusCode===void 0)statusCode=200;return state.oas.client.spec.paths[path][method].responses[statusCode]},schemaObject:(state,path,method,statusCode)=>{if(statusCode===void 0)statusCode=200;return state.oas.client.spec.paths[path][method].responses[statusCode].schema}});function contains$3(arr,val){return indexOf_1$1(arr,val)!==-1}var contains_1$2=contains$3;function reject$1(arr,callback,thisObj){callback=makeIterator_$1(callback,thisObj);var results=[];if(arr==null){return results}var i=-1,len=arr.length,value;while(++i<len){value=arr[i];if(!callback(value,i,arr)){results.push(value)}}return results}var reject_1$1=reject$1;var page$1=exporter$1("page",{all:state=>{return state.page||{}},id:state=>{const page=state.page;if(!page){return""}return page.id},name:state=>{const page=state.page;if(!page){return""}return page.name},components:state=>{const page=state.page;if(!page){return[]}return page.components},componentsInline:state=>{const page=state.page;if(!page){return[]}return filter_1$1(page.components,component=>{return contains_1$2(["number"],component.style)})},componentsTable:state=>{const page=state.page;if(!page){return[]}return filter_1$1(page.components,component=>{return contains_1$2(["table"],component.style)})},componentsNotTable:state=>{const page=state.page;if(!page){return[]}return reject_1$1(page.components,component=>{return component.style==="table"})},componentsCount:state=>{const page=state.page;if(!page){return 0}return(page.components||[]).length}});var popovers$1=exporter$1("popovers",{all:state=>{return state.popovers}});var toasts$1=exporter$1("toasts",{all:state=>{return state.toasts}});var ua$1=exporter$1("ua",{all:state=>{return state.ua},isChrome:state=>{return!!state.ua.chrome},isSafari:state=>{return!!state.ua.safari},isEdge:state=>{return!!state.ua.edge},isFirefox:state=>{return!!state.ua.firefox},usingBrowser:state=>{const ua=state.ua;if(!!ua.chrome){return"chrome"}if(!!ua.safari){return"safari"}if(!!ua.edge){return"edge"}if(!!ua.firefox){return"firefox"}return null}});function filterValues(obj,callback,thisObj){callback=makeIterator_$1(callback,thisObj);var output={};forOwn_1$2(obj,function(value,key,obj){if(callback(value,key,obj)){output[key]=value}});return output}var filter$5=filterValues;function values(obj){var vals=[];forOwn_1$2(obj,function(val,key){vals.push(val)});return vals}var values_1=values;const SECTION_DASHBOARD="dashboard";const SECTION_MANAGE="manage";var viron$1=exporter$1("viron",{all:state=>{if(!state.viron){return null}return state.viron},existence:state=>{return!!state.viron},pages:state=>{return state.viron.pages},pageIdOf:(state,idx)=>{return state.viron.pages[idx].id},name:state=>{if(!state.viron){return null}return state.viron.name},thumbnail:state=>{if(!state.viron){return null}return state.viron.thumbnail},color:state=>{if(!state.viron){return null}return state.viron.color},theme:state=>{const defaultTheme="standard";if(!state.viron){return defaultTheme}if(!contains_1$2(["standard","midnight","terminal"],state.viron.theme)){return defaultTheme}return state.viron.theme},dashboard:state=>{if(!state.viron){return[]}return values_1(filter$5(state.viron.pages,page=>{if(page.section!==SECTION_DASHBOARD){return false}return true}))},manage:state=>{if(!state.viron){return[]}return values_1(filter$5(state.viron.pages,page=>{if(page.section!==SECTION_MANAGE){return false}return true}))},menu:state=>{const menu=[];if(!state.viron||!state.viron.sections){return menu}const sections=state.viron.sections;forEach_1$2(sections,section=>{menu.push({name:section.label||section.id,id:section.id,groups:[]})});const pages=state.viron.pages;forEach_1$2(pages,page=>{const targetSection=find_1$2(menu,section=>{return section.id===page.section});const groupName=page.group;const isIndependent=!groupName;if(isIndependent){targetSection.groups.push({pages:[{name:page.name,id:page.id}],isIndependent:isIndependent})}else{if(!find_1$2(targetSection.groups,group=>{return group.name===groupName})){targetSection.groups.push({name:groupName,pages:[],isIndependent:isIndependent})}const targetGroup=find_1$2(targetSection.groups,group=>{return group.name===groupName});targetGroup.pages.push({name:page.name,id:page.id})}});return menu}});var getters=objectAssign({},application$1,components$1,current$1,drawers$1,endpoints$1,layout$1,location$2,mediapreviews$1,modals$1,oas$1,page$1,popovers$1,toasts$1,ua$1,viron$1);var exporter$2=(name,funcs)=>{const ret={};forOwn_1$2(funcs,(func,id)=>{ret[`${name}.${id}`]=((context,...args)=>{return func(context.state,...args)})});return ret};var application$2=exporter$2("application",{launch:(state,bool)=>{state.application.isLaunched=bool;return["application"]},navigation:(state,bool)=>{state.application.isNavigating=bool;return["application"]},addNetworking:(state,info)=>{state.application.networkings.push(objectAssign({id:`networking_${Date.now()}`},info));state.application.isNetworking=true;return["application"]},removeNetworking:(state,networkingId,context)=>{state.application.networkings=reject_1$1(state.application.networkings,networking=>{return networking.id===networkingId});if(!!context){setTimeout(()=>{context.commit("application.isNetworking")},500)}else if(!state.application.networkings.length){state.application.isNetworking=false}return["application"]},isNetworking:state=>{state.application.isNetworking=!!state.application.networkings.length;return["application"]},drag:(state,bool)=>{state.application.isDragging=bool;return["application"]},menuToggle:state=>{state.application.isMenuOpened=!state.application.isMenuOpened;return["application"]},endpointFilterText:(state,newFilterText)=>{state.application.endpointFilterText=newFilterText;return["application"]},endpointTempFilterText:(state,newTempFilterText)=>{state.application.endpointTempFilterText=newTempFilterText;return["application"]}});var components$2=exporter$2("components",{updateOne:(state,componentId,componentDef,response,headers)=>{state.components[componentId]={def:componentDef,response:response};const method=componentDef.api.method;const path=componentDef.api.path;const queries=componentDef.query;const parameters=state.oas.client.spec.paths[path][method].parameters||[];state.components[componentId]["searchParameters"]=filter_1$1(parameters,parameter=>{if(parameter.in!=="query"){return false}if(!find_1$2(queries,query=>{return query.key===parameter.name})){return false}return true});if(componentDef.pagination){state.components[componentId]["pagination"]={current:Number(headers["x-pagination-current-page"]||0),size:Number(headers["x-pagination-limit"]||0),max:Number(headers["x-pagination-total-pages"]||0)}}if(isNumber_1(componentDef.auto_refresh_sec)){state.components[componentId]["autoRefreshSec"]=componentDef.auto_refresh_sec}if(componentDef.style==="table"){const properties=state.oas.client.spec.paths[path][method].responses[200].schema.items.properties;const columns=[];forOwn_1$2(properties,(property,key)=>{columns.push(objectAssign({key:key},property))});state.components[componentId]["columns"]=columns;const tableOperations=[];const rowOperations=[];forEach_1$2(["put","post","delete"],method=>{const operationObject=!!state.oas.client.spec.paths[path]&&state.oas.client.spec.paths[path][method];if(!operationObject){return}tableOperations.push(objectAssign({method:method,path:path},operationObject))});const primary=componentDef.primary;state.components[componentId]["primary"]=primary;if(!!primary){forEach_1$2(["get","put","post","delete"],method=>{const operationObject=!!state.oas.client.spec.paths[`${path}/{${primary}}`]&&state.oas.client.spec.paths[`${path}/{${primary}}`][method];if(!operationObject){return}rowOperations.push(objectAssign({method:method,path:`${path}/{${primary}}`},operationObject))})}forEach_1$2(componentDef.actions||[],action=>{const isRowRelated=action.indexOf(`{${primary}}`)>=0;forEach_1$2(["get","put","post","delete"],method=>{const operationObject=!!state.oas.client.spec.paths[action]&&state.oas.client.spec.paths[action][method];if(!operationObject){return}let target;if(isRowRelated){target=rowOperations}else{target=tableOperations}target.push(objectAssign({method:method,path:action},operationObject))})});state.components[componentId]["tableOperations"]=tableOperations;state.components[componentId]["rowOperations"]=rowOperations}return["components",componentId]},removeOne:(state,componentId)=>{delete state.components[componentId];return["components",componentId]},removeAll:state=>{state.components={};return["components"]}});var store$1=createCommonjsModule(function(module,exports){"use strict";(function(root,factory){if(typeof undefined==="function"&&undefined.amd){undefined([],factory)}else{module.exports=factory()}})(commonjsGlobal,function(){var store={},win=typeof window!="undefined"?window:commonjsGlobal,doc=win.document,localStorageName="localStorage",scriptTag="script",storage;store.disabled=false;store.version="1.3.20";store.set=function(key,value){};store.get=function(key,defaultVal){};store.has=function(key){return store.get(key)!==undefined};store.remove=function(key){};store.clear=function(){};store.transact=function(key,defaultVal,transactionFn){if(transactionFn==null){transactionFn=defaultVal;defaultVal=null}if(defaultVal==null){defaultVal={}}var val=store.get(key,defaultVal);transactionFn(val);store.set(key,val)};store.getAll=function(){};store.forEach=function(){};store.serialize=function(value){return JSON.stringify(value)};store.deserialize=function(value){if(typeof value!="string"){return undefined}try{return JSON.parse(value)}catch(e){return value||undefined}};function isLocalStorageNameSupported(){try{return localStorageName in win&&win[localStorageName]}catch(err){return false}}if(isLocalStorageNameSupported()){storage=win[localStorageName];store.set=function(key,val){if(val===undefined){return store.remove(key)}storage.setItem(key,store.serialize(val));return val};store.get=function(key,defaultVal){var val=store.deserialize(storage.getItem(key));return val===undefined?defaultVal:val};store.remove=function(key){storage.removeItem(key)};store.clear=function(){storage.clear()};store.getAll=function(){var ret={};store.forEach(function(key,val){ret[key]=val});return ret};store.forEach=function(callback){for(var i=0;i<storage.length;i++){var key=storage.key(i);callback(key,store.get(key))}}}else if(doc&&doc.documentElement.addBehavior){var storageOwner,storageContainer;try{storageContainer=new ActiveXObject("htmlfile");storageContainer.open();storageContainer.write("<"+scriptTag+">document.w=window</"+scriptTag+'><iframe src="/favicon.ico"></iframe>');storageContainer.close();storageOwner=storageContainer.w.frames[0].document;storage=storageOwner.createElement("div")}catch(e){storage=doc.createElement("div");storageOwner=doc.body}var withIEStorage=function(storeFunction){return function(){var args=Array.prototype.slice.call(arguments,0);args.unshift(storage);storageOwner.appendChild(storage);storage.addBehavior("#default#userData");storage.load(localStorageName);var result=storeFunction.apply(store,args);storageOwner.removeChild(storage);return result}};var forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");var ieKeyFix=function(key){return key.replace(/^d/,"___$&").replace(forbiddenCharsRegex,"___")};store.set=withIEStorage(function(storage,key,val){key=ieKeyFix(key);if(val===undefined){return store.remove(key)}storage.setAttribute(key,store.serialize(val));storage.save(localStorageName);return val});store.get=withIEStorage(function(storage,key,defaultVal){key=ieKeyFix(key);var val=store.deserialize(storage.getAttribute(key));return val===undefined?defaultVal:val});store.remove=withIEStorage(function(storage,key){key=ieKeyFix(key);storage.removeAttribute(key);storage.save(localStorageName)});store.clear=withIEStorage(function(storage){var attributes=storage.XMLDocument.documentElement.attributes;storage.load(localStorageName);for(var i=attributes.length-1;i>=0;i--){storage.removeAttribute(attributes[i].name)}storage.save(localStorageName)});store.getAll=function(storage){var ret={};store.forEach(function(key,val){ret[key]=val});return ret};store.forEach=withIEStorage(function(storage,callback){var attributes=storage.XMLDocument.documentElement.attributes;for(var i=0,attr;attr=attributes[i];++i){callback(attr.name,store.deserialize(storage.getAttribute(attr.name)))}})}try{var testKey="__storejs__";store.set(testKey,testKey);if(store.get(testKey)!=testKey){store.disabled=true}store.remove(testKey)}catch(e){store.disabled=true}store.enabled=!store.disabled;return store})});var current$2=exporter$2("current",{all:(state,endpointKey)=>{const version=state.application.version;state.current[version]=endpointKey;store$1.set("current",state.current);return["current"]}});var drawers$2=exporter$2("drawers",{add:(state,tagName,tagOpts,drawerOpts)=>{if(tagOpts===void 0)tagOpts={};if(drawerOpts===void 0)drawerOpts={};state.drawers.unshift({id:`drawer_${Date.now()}`,tagName:tagName,tagOpts:tagOpts,drawerOpts:drawerOpts});return["drawers"]},remove:(state,drawerID)=>{state.drawers=reject_1$1(state.drawers,drawer=>{return drawer.id===drawerID});return["drawers"]}});const putEndpointsInOrder=endpoints=>{const bigNumber=9999;let ordered=[];forOwn_1$2(endpoints,(endpoint,key)=>{ordered.push({key:key,order:isNumber_1(endpoint.order)?endpoint.order:bigNumber})});ordered=sortBy_1$1(ordered,obj=>{return obj.order});forEach_1$2(ordered,(obj,order)=>{endpoints[obj.key].order=order});return endpoints};var endpoints$2=exporter$2("endpoints",{add:(state,endpointKey,endpoint)=>{if(!isNumber_1(endpoint.order)){endpoint.order=-1}const version=state.application.version;let newEndpoints=objectAssign({},state.endpoints[version]);newEndpoints[endpointKey]=endpoint;newEndpoints=putEndpointsInOrder(newEndpoints);state.endpoints[version]=newEndpoints;store$1.set("endpoints",state.endpoints);return["endpoints"]},remove:(state,endpointKey)=>{const version=state.application.version;let newEndpoints=objectAssign({},state.endpoints[version]);delete newEndpoints[endpointKey];newEndpoints=putEndpointsInOrder(newEndpoints);state.endpoints[version]=newEndpoints;store$1.set("endpoints",state.endpoints);return["endpoints"]},removeAll:state=>{const version=state.application.version;state.endpoints[version]={};store$1.set("endpoints",state.endpoints);return["endpoints"]},update:(state,endpointKey,endpoint)=>{const version=state.application.version;const endpoints=state.endpoints[version];if(!endpoint){delete endpoints[endpointKey]}else{endpoints[endpointKey]=objectAssign({},endpoints[endpointKey],endpoint)}store$1.set("endpoints",state.endpoints);return["endpoints"]},updateToken:(state,endpointKey,token)=>{const version=state.application.version;const endpoints=state.endpoints[version];if(!!endpoints[endpointKey]){endpoints[endpointKey].token=token}store$1.set("endpoints",state.endpoints);return["endpoints"]},mergeAll:(state,endpoints)=>{const version=state.application.version;let modifiedEndpoints=objectAssign({},state.endpoints[version]);forOwn_1$2(endpoints,endpoint=>{let duplicatedEndpoint=find_1$1(modifiedEndpoints,val=>{return endpoint.url===val.url});if(!duplicatedEndpoint){const key=shortid.generate();endpoint.key=key;modifiedEndpoints[key]=endpoint}else{objectAssign(duplicatedEndpoint,endpoint)}});modifiedEndpoints=putEndpointsInOrder(modifiedEndpoints);state.endpoints[version]=modifiedEndpoints;store$1.set("endpoints",state.endpoints);return["endpoints"]},tidyUpOrder:state=>{const version=state.application.version;const newEndpoints=putEndpointsInOrder(objectAssign({},state.endpoints[version]));state.endpoints[version]=newEndpoints;store$1.set("endpoints",state.endpoints);return["endpoints"]},changeOrder:(state,endpointKey,newOrder)=>{const version=state.application.version;let newEndpoints=objectAssign({},state.endpoints[version]);newEndpoints[endpointKey].order=newOrder-.5;newEndpoints=putEndpointsInOrder(newEndpoints);state.endpoints[version]=newEndpoints;store$1.set("endpoints",state.endpoints);return["endpoints"]},cleanup:state=>{const version=state.application.version;let newEndpoints=objectAssign({},state.endpoints[version]);forOwn_1$2(newEndpoints,(endpoint,key)=>{if(!isObject_1(endpoint)){delete newEndpoints[key]}});state.endpoints[version]=newEndpoints;store$1.set("endpoints",state.endpoints);return["endpoints"]}});var layout$2=exporter$2("layout",{updateSize:(state,width,height)=>{state.layout.size.width=width;state.layout.size.height=height;if(width>constants$1.layoutThreshold){state.layout.type=constants$1.layoutTypeDesktop}else{state.layout.type=constants$1.layoutTypeMobile}return["layout"]},updateComponentsGridColumnCount:(state,count)=>{state.layout.componentsGridColumnCount=count;return["layout"]}});var location$3=exporter$2("location",{all:(state,obj)=>{state.location=objectAssign({},state.location,obj);return["location"]},name:(state,name)=>{state.location.name=name;return["location"]},route:(state,route)=>{state.location.route=route;return["location"]}});var mediapreviews$2=exporter$2("mediapreviews",{add:(state,tagOpts,mediapreviewOpts)=>{if(tagOpts===void 0)tagOpts={};if(mediapreviewOpts===void 0)mediapreviewOpts={};state.mediapreviews.push({id:`mediapreview_${Date.now()}`,tagOpts:tagOpts,mediapreviewOpts:mediapreviewOpts});return["mediapreviews"]},remove:(state,mediapreviewID)=>{state.mediapreviews=reject_1$1(state.mediapreviews,mediapreview=>{return mediapreview.id===mediapreviewID});return["mediapreviews"]}});var modals$2=exporter$2("modals",{add:(state,tagName,tagOpts,modalOpts)=>{if(tagOpts===void 0)tagOpts={};if(modalOpts===void 0)modalOpts={};state.modals.push({id:`modal_${Date.now()}`,tagName:tagName,tagOpts:tagOpts,modalOpts:modalOpts});return["modals"]},remove:(state,modalID)=>{state.modals=reject_1$1(state.modals,modal=>{return modal.id===modalID});return["modals"]}});var oas$2=exporter$2("oas",{client:(state,client)=>{state.oas.client=client;return["oas"]},clearClient:state=>{state.oas.client=null;return["oas"]}});var page$2=exporter$2("page",{all:(state,page)=>{state.page=page;return["page"]}});var popovers$2=exporter$2("popovers",{add:(state,tagName,tagOpts,popoverOpts)=>{if(tagOpts===void 0)tagOpts={};if(popoverOpts===void 0)popoverOpts={};state.popovers.push({id:`popover_${Date.now()}`,tagName:tagName,tagOpts:tagOpts,popoverOpts:objectAssign({direction:"T",width:100,x:0,y:0},popoverOpts)});return["popovers"]},remove:(state,popoverID)=>{state.popovers=reject_1$1(state.popovers,popover=>{return popover.id===popoverID});return["popovers"]},removeAll:state=>{state.popovers=[];return["popovers"]}});const generateId=()=>{return`toast_${Date.now()}`};const TOAST_TIMEOUT=3*1e3;var toasts$2=exporter$2("toasts",{add:(state,obj)=>{const data=objectAssign({timeout:TOAST_TIMEOUT,autoHide:true},obj,{id:generateId()});state.toasts.push(data);return["toasts"]},remove:(state,toastId)=>{state.toasts=reject_1$1(state.toasts,toast=>{return toast.id===toastId});return["toasts"]}});var ua$2=exporter$2("ua",{all:(state,ua)=>{state.ua=ua;return["ua"]}});function combine$1(arr1,arr2){if(arr2==null){return arr1}var i=-1,len=arr2.length;while(++i<len){if(indexOf_1$1(arr1,arr2[i])===-1){arr1.push(arr2[i])}}return arr1}var combine_1$1=combine$1;var viron$2=exporter$2("viron",{all:(state,viron)=>{if(!!viron){viron.sections=viron.sections||[];if(!find_1$2(viron.sections,section=>{return section.id==="manage"})){viron.sections=combine_1$1([{id:"manage",label:i18n$1.t("word.manage")}],viron.sections)}if(!find_1$2(viron.sections,section=>{return section.id==="dashboard"})){viron.sections=combine_1$1([{id:"dashboard",label:i18n$1.t("word.dashboard")}],viron.sections)}}state.viron=viron;return["viron"]}});var mutations=objectAssign({},application$2,components$2,current$2,drawers$2,endpoints$2,layout$2,location$3,mediapreviews$2,modals$2,oas$2,page$2,popovers$2,toasts$2,ua$2,viron$2);var exporter$3=(name,any)=>{const ret={};ret[name]=any;return ret};var application$3=exporter$3("application",{version:(()=>{const url=new URL(window.location.href);if(url.hostname==="localhost"){return"local"}return url.pathname.replace(/viron/,"").replace(/\//g,"")})(),latestVersion:"v1",isLaunched:false,isNavigating:false,networkings:[],isNetworking:false,isDragging:false,isMenuOpened:true,endpointFilterText:"",endpointTempFilterText:""});var components$3=exporter$3("components",{});if(!isObject_1(store$1.get("current"))){store$1.set("current",{})}var current$3=exporter$3("current",store$1.get("current",{}));var drawers$3=exporter$3("drawers",[]);var endpoints$3=exporter$3("endpoints",store$1.get("endpoints",{}));var layout$3=exporter$3("layout",{type:(()=>{const width=window.innerWidth;if(width>constants$1.layoutThreshold){return constants$1.layoutTypeDesktop}return constants$1.layoutTypeMobile})(),size:{width:window.innerWidth,height:window.innerHeight},componentsGridColumnCount:(()=>{const htmlStyles=window.getComputedStyle(document.querySelector("html"));const columnCount=Number(htmlStyles.getPropertyValue("--page-components-grid-column-count"));return columnCount})()});var location$4=exporter$3("location",{name:"",route:{params:{},queries:{},hash:""}});var mediapreviews$3=exporter$3("mediapreviews",[]);var modals$3=exporter$3("modals",[]);var oas$3=exporter$3("oas",{client:null});var page$3=exporter$3("page",null);var popovers$3=exporter$3("popovers",[]);var signinShowKey=exporter$3("signinShowKey",null);var toasts$3=exporter$3("toasts",[]);var ua$3=exporter$3("ua",{});var viron$3=exporter$3("viron",null);var states=objectAssign({},application$3,components$3,current$3,drawers$3,endpoints$3,layout$3,location$4,mediapreviews$3,modals$3,oas$3,page$3,popovers$3,signinShowKey,toasts$3,ua$3,viron$3);const getComponentStateName=riotId=>{return`component_${riotId}`};var store={init:()=>{return Promise.resolve().then(()=>{const store=new index$1$2.Store({state:states,actions:actions,mutations:mutations,getters:getters});index$1$2.add(store);return store})}};riot$1.tag2("viron-icon-search",'<svg viewbox="-3434 14059.999 15.999 16.003"> <path d="M3710.818-13811.056l-3.051-3.05a6.957,6.957,0,0,1-3.768,1.1,7.008,7.008,0,0,1-7-7,7.008,7.008,0,0,1,7-7,7.008,7.008,0,0,1,7,7,6.957,6.957,0,0,1-1.107,3.773l3.051,3.049a.205.205,0,0,1,0,.284l-1.839,1.839a.206.206,0,0,1-.142.058A.206.206,0,0,1,3710.818-13811.056ZM3700-13820a4,4,0,0,0,4,4,4,4,0,0,0,4-4,4,4,0,0,0-4-4A4,4,0,0,0,3700-13820Z" transform="translate(-7131 27887)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconSearch {opts.class}"',function(opts){});riot$1.tag2("viron-icon-reload",'<svg viewbox="-1791 11377 14.063 16"> <path d="M43.991,5.189a.469.469,0,0,0-.679-.126L41.791,6.2a.469.469,0,0,0-.123.613,4.082,4.082,0,0,1,.582,2.09,4.219,4.219,0,1,1-8.437,0,4.224,4.224,0,0,1,3.75-4.193v1.38a.469.469,0,0,0,.75.375l3.75-2.812a.469.469,0,0,0,0-.75L38.312.094a.469.469,0,0,0-.75.375V1.891a7.049,7.049,0,1,0,6.428,3.3Z" transform="translate(-1822 11377)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconReload {opts.class}"',function(opts){});var highcharts=createCommonjsModule(function(module){(function(S,N){"object"==="object"&&module.exports?module.exports=S.document?N(S):N:S.Highcharts=N(S)})("undefined"!==typeof window?window:commonjsGlobal,function(S){var N=function(){var a="undefined"===typeof S?window:S,D=a.document,B=a.navigator&&a.navigator.userAgent||"",G=D&&D.createElementNS&&!!D.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,p=/(edge|msie|trident)/i.test(B)&&!a.opera,g=/Firefox/.test(B),l=g&&4>parseInt(B.split("Firefox/")[1],10);return a.Highcharts?a.Highcharts.error(16,!0):{product:"Highcharts",version:"6.0.3",deg2rad:2*Math.PI/360,doc:D,hasBidiBug:l,hasTouch:D&&void 0!==D.documentElement.ontouchstart,isMS:p,isWebKit:/AppleWebKit/.test(B),isFirefox:g,isTouchDevice:/(Mobile|Android|Windows Phone)/.test(B),SVG_NS:"http://www.w3.org/2000/svg",chartCount:0,seriesTypes:{},symbolSizes:{},svg:G,win:a,marginNames:["plotTop","marginRight","marginBottom","plotLeft"],noop:function(){},charts:[]}}();(function(a){a.timers=[];var D=a.charts,B=a.doc,G=a.win;a.error=function(p,g){p=a.isNumber(p)?"Highcharts error #"+p+": www.highcharts.com/errors/"+p:p;if(g){throw Error(p)}G.console&&console.log(p)};a.Fx=function(a,g,l){this.options=g;this.elem=a;this.prop=l};a.Fx.prototype={dSetter:function(){var a=this.paths[0],g=this.paths[1],l=[],r=this.now,n=a.length,w;if(1===r){l=this.toD}else if(n===g.length&&1>r){for(;n--;){w=parseFloat(a[n]),l[n]=isNaN(w)?g[n]:r*parseFloat(g[n]-w)+w}}else{l=g}this.elem.attr("d",l,null,!0)},update:function(){var a=this.elem,g=this.prop,l=this.now,r=this.options.step;if(this[g+"Setter"]){this[g+"Setter"]()}else{a.attr?a.element&&a.attr(g,l,null,!0):a.style[g]=l+this.unit}r&&r.call(a,l,this)},run:function(p,g,l){var r=this,n=r.options,w=function(a){return w.stopped?!1:r.step(a)},v=G.requestAnimationFrame||function(a){setTimeout(a,13)},e=function(){a.timers=a.grep(a.timers,function(a){return a()});a.timers.length&&v(e)};p===g?(delete n.curAnim[this.prop],n.complete&&0===a.keys(n.curAnim).length&&n.complete()):(this.startTime=+new Date,this.start=p,this.end=g,this.unit=l,this.now=this.start,this.pos=0,w.elem=this.elem,w.prop=this.prop,w()&&1===a.timers.push(w)&&v(e))},step:function(p){var g=+new Date,l,r=this.options,n=this.elem,w=r.complete,v=r.duration,e=r.curAnim;n.attr&&!n.element?p=!1:p||g>=v+this.startTime?(this.now=this.end,this.pos=1,this.update(),l=e[this.prop]=!0,a.objectEach(e,function(a){!0!==a&&(l=!1)}),l&&w&&w.call(n),p=!1):(this.pos=r.easing((g-this.startTime)/v),this.now=this.start+(this.end-this.start)*this.pos,this.update(),p=!0);return p},initPath:function(p,g,l){function r(a){var b,f;for(d=a.length;d--;){b="M"===a[d]||"L"===a[d],f=/[a-zA-Z]/.test(a[d+3]),b&&f&&a.splice(d+1,0,a[d+1],a[d+2],a[d+1],a[d+2])}}function n(a,b){for(;a.length<f;){a[0]=b[f-a.length];var e=a.slice(0,c);[].splice.apply(a,[0,0].concat(e));y&&(e=a.slice(a.length-c),[].splice.apply(a,[a.length,0].concat(e)),d--)}a[0]="M"}function w(a,d){for(var e=(f-a.length)/c;0<e&&e--;){b=a.slice().splice(a.length/H-c,c*H),b[0]=d[f-c-e*c],m&&(b[c-6]=b[c-2],b[c-5]=b[c-1]),[].splice.apply(a,[a.length/H,0].concat(b)),y&&e--}}g=g||"";var v,e=p.startX,h=p.endX,m=-1<g.indexOf("C"),c=m?7:3,f,b,d;g=g.split(" ");l=l.slice();var y=p.isArea,H=y?2:1,J;m&&(r(g),r(l));if(e&&h){for(d=0;d<e.length;d++){if(e[d]===h[0]){v=d;break}else if(e[0]===h[h.length-e.length+d]){v=d;J=!0;break}}void 0===v&&(g=[])}g.length&&a.isNumber(v)&&(f=l.length+v*H*c,J?(n(g,l),w(l,g)):(n(l,g),w(g,l)));return[g,l]}};a.Fx.prototype.fillSetter=a.Fx.prototype.strokeSetter=function(){this.elem.attr(this.prop,a.color(this.start).tweenTo(a.color(this.end),this.pos),null,!0)};a.extend=function(a,g){var l;a||(a={});for(l in g){a[l]=g[l]}return a};a.merge=function(){var p,g=arguments,l,r={},n=function(l,v){"object"!==typeof l&&(l={});a.objectEach(v,function(e,h){!a.isObject(e,!0)||a.isClass(e)||a.isDOMElement(e)?l[h]=v[h]:l[h]=n(l[h]||{},e)});return l};!0===g[0]&&(r=g[1],g=Array.prototype.slice.call(g,2));l=g.length;for(p=0;p<l;p++){r=n(r,g[p])}return r};a.pInt=function(a,g){return parseInt(a,g||10)};a.isString=function(a){return"string"===typeof a};a.isArray=function(a){a=Object.prototype.toString.call(a);return"[object Array]"===a||"[object Array Iterator]"===a};a.isObject=function(p,g){return!!p&&"object"===typeof p&&(!g||!a.isArray(p))};a.isDOMElement=function(p){return a.isObject(p)&&"number"===typeof p.nodeType};a.isClass=function(p){var g=p&&p.constructor;return!(!a.isObject(p,!0)||a.isDOMElement(p)||!g||!g.name||"Object"===g.name)};a.isNumber=function(a){return"number"===typeof a&&!isNaN(a)};a.erase=function(a,g){for(var l=a.length;l--;){if(a[l]===g){a.splice(l,1);break}}};a.defined=function(a){return void 0!==a&&null!==a};a.attr=function(p,g,l){var r;a.isString(g)?a.defined(l)?p.setAttribute(g,l):p&&p.getAttribute&&(r=p.getAttribute(g)):a.defined(g)&&a.isObject(g)&&a.objectEach(g,function(a,l){p.setAttribute(l,a)});return r};a.splat=function(p){return a.isArray(p)?p:[p]};a.syncTimeout=function(a,g,l){if(g){return setTimeout(a,g,l)}a.call(0,l)};a.pick=function(){var a=arguments,g,l,r=a.length;for(g=0;g<r;g++){if(l=a[g],void 0!==l&&null!==l){return l}}};a.css=function(p,g){a.isMS&&!a.svg&&g&&void 0!==g.opacity&&(g.filter="alpha(opacity="+100*g.opacity+")");a.extend(p.style,g)};a.createElement=function(p,g,l,r,n){p=B.createElement(p);var w=a.css;g&&a.extend(p,g);n&&w(p,{padding:0,border:"none",margin:0});l&&w(p,l);r&&r.appendChild(p);return p};a.extendClass=function(p,g){var l=function(){};l.prototype=new p;a.extend(l.prototype,g);return l};a.pad=function(a,g,l){return Array((g||2)+1-String(a).length).join(l||0)+a};a.relativeLength=function(a,g,l){return/%$/.test(a)?g*parseFloat(a)/100+(l||0):parseFloat(a)};a.wrap=function(a,g,l){var r=a[g];a[g]=function(){var a=Array.prototype.slice.call(arguments),g=arguments,v=this;v.proceed=function(){r.apply(v,arguments.length?arguments:g)};a.unshift(r);a=l.apply(this,a);v.proceed=null;return a}};a.getTZOffset=function(p){var g=a.Date;return 6e4*(g.hcGetTimezoneOffset&&g.hcGetTimezoneOffset(p)||g.hcTimezoneOffset||0)};a.dateFormat=function(p,g,l){if(!a.defined(g)||isNaN(g)){return a.defaultOptions.lang.invalidDate||""}p=a.pick(p,"%Y-%m-%d %H:%M:%S");var r=a.Date,n=new r(g-a.getTZOffset(g)),w=n[r.hcGetHours](),v=n[r.hcGetDay](),e=n[r.hcGetDate](),h=n[r.hcGetMonth](),m=n[r.hcGetFullYear](),c=a.defaultOptions.lang,f=c.weekdays,b=c.shortWeekdays,d=a.pad,r=a.extend({a:b?b[v]:f[v].substr(0,3),A:f[v],d:d(e),e:d(e,2," "),w:v,b:c.shortMonths[h],B:c.months[h],m:d(h+1),y:m.toString().substr(2,2),Y:m,H:d(w),k:w,I:d(w%12||12),l:w%12||12,M:d(n[r.hcGetMinutes]()),p:12>w?"AM":"PM",P:12>w?"am":"pm",S:d(n.getSeconds()),L:d(Math.round(g%1e3),3)},a.dateFormats);a.objectEach(r,function(a,b){for(;-1!==p.indexOf("%"+b);){p=p.replace("%"+b,"function"===typeof a?a(g):a)}});return l?p.substr(0,1).toUpperCase()+p.substr(1):p};a.formatSingle=function(p,g){var l=/\.([0-9])/,r=a.defaultOptions.lang;/f$/.test(p)?(l=(l=p.match(l))?l[1]:-1,null!==g&&(g=a.numberFormat(g,l,r.decimalPoint,-1<p.indexOf(",")?r.thousandsSep:""))):g=a.dateFormat(p,g);return g};a.format=function(p,g){for(var l="{",r=!1,n,w,v,e,h=[],m;p;){l=p.indexOf(l);if(-1===l){break}n=p.slice(0,l);if(r){n=n.split(":");w=n.shift().split(".");e=w.length;m=g;for(v=0;v<e;v++){m&&(m=m[w[v]])}n.length&&(m=a.formatSingle(n.join(":"),m));h.push(m)}else{h.push(n)}p=p.slice(l+1);l=(r=!r)?"}":"{"}h.push(p);return h.join("")};a.getMagnitude=function(a){return Math.pow(10,Math.floor(Math.log(a)/Math.LN10))};a.normalizeTickInterval=function(p,g,l,r,n){var w,v=p;l=a.pick(l,1);w=p/l;g||(g=n?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===r&&(1===l?g=a.grep(g,function(a){return 0===a%1}):.1>=l&&(g=[1/l])));for(r=0;r<g.length&&!(v=g[r],n&&v*l>=p||!n&&w<=(g[r]+(g[r+1]||g[r]))/2);r++){}return v=a.correctFloat(v*l,-Math.round(Math.log(.001)/Math.LN10))};a.stableSort=function(a,g){var l=a.length,r,n;for(n=0;n<l;n++){a[n].safeI=n}a.sort(function(a,n){r=g(a,n);return 0===r?a.safeI-n.safeI:r});for(n=0;n<l;n++){delete a[n].safeI}};a.arrayMin=function(a){for(var g=a.length,l=a[0];g--;){a[g]<l&&(l=a[g])}return l};a.arrayMax=function(a){for(var g=a.length,l=a[0];g--;){a[g]>l&&(l=a[g])}return l};a.destroyObjectProperties=function(p,g){a.objectEach(p,function(a,r){a&&a!==g&&a.destroy&&a.destroy();delete p[r]})};a.discardElement=function(p){var g=a.garbageBin;g||(g=a.createElement("div"));p&&g.appendChild(p);g.innerHTML=""};a.correctFloat=function(a,g){return parseFloat(a.toPrecision(g||14))};a.setAnimation=function(p,g){g.renderer.globalAnimation=a.pick(p,g.options.chart.animation,!0)};a.animObject=function(p){return a.isObject(p)?a.merge(p):{duration:p?500:0}};a.timeUnits={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5};a.numberFormat=function(p,g,l,r){p=+p||0;g=+g;var n=a.defaultOptions.lang,w=(p.toString().split(".")[1]||"").split("e")[0].length,v,e,h=p.toString().split("e");-1===g?g=Math.min(w,20):a.isNumber(g)||(g=2);e=(Math.abs(h[1]?h[0]:p)+Math.pow(10,-Math.max(g,w)-1)).toFixed(g);w=String(a.pInt(e));v=3<w.length?w.length%3:0;l=a.pick(l,n.decimalPoint);r=a.pick(r,n.thousandsSep);p=(0>p?"-":"")+(v?w.substr(0,v)+r:"");p+=w.substr(v).replace(/(\d{3})(?=\d)/g,"$1"+r);g&&(p+=l+e.slice(-g));h[1]&&(p+="e"+h[1]);return p};Math.easeInOutSine=function(a){return-.5*(Math.cos(Math.PI*a)-1)};a.getStyle=function(p,g,l){if("width"===g){return Math.min(p.offsetWidth,p.scrollWidth)-a.getStyle(p,"padding-left")-a.getStyle(p,"padding-right")}if("height"===g){return Math.min(p.offsetHeight,p.scrollHeight)-a.getStyle(p,"padding-top")-a.getStyle(p,"padding-bottom")}G.getComputedStyle||a.error(27,!0);if(p=G.getComputedStyle(p,void 0)){p=p.getPropertyValue(g),a.pick(l,"opacity"!==g)&&(p=a.pInt(p))}return p};a.inArray=function(p,g){return(a.indexOfPolyfill||Array.prototype.indexOf).call(g,p)};a.grep=function(p,g){return(a.filterPolyfill||Array.prototype.filter).call(p,g)};a.find=Array.prototype.find?function(a,g){return a.find(g)}:function(a,g){var l,r=a.length;for(l=0;l<r;l++){if(g(a[l],l)){return a[l]}}};a.map=function(a,g){for(var l=[],r=0,n=a.length;r<n;r++){l[r]=g.call(a[r],a[r],r,a)}return l};a.keys=function(p){return(a.keysPolyfill||Object.keys).call(void 0,p)};a.reduce=function(p,g,l){return(a.reducePolyfill||Array.prototype.reduce).call(p,g,l)};a.offset=function(a){var g=B.documentElement;a=a.parentElement?a.getBoundingClientRect():{top:0,left:0};return{top:a.top+(G.pageYOffset||g.scrollTop)-(g.clientTop||0),left:a.left+(G.pageXOffset||g.scrollLeft)-(g.clientLeft||0)}};a.stop=function(p,g){for(var l=a.timers.length;l--;){a.timers[l].elem!==p||g&&g!==a.timers[l].prop||(a.timers[l].stopped=!0)}};a.each=function(p,g,l){return(a.forEachPolyfill||Array.prototype.forEach).call(p,g,l)};a.objectEach=function(a,g,l){for(var r in a){a.hasOwnProperty(r)&&g.call(l,a[r],r,a)}};a.addEvent=function(p,g,l){var r,n,w=p.addEventListener||a.addEventListenerPolyfill;p.hcEvents&&!p.hasOwnProperty("hcEvents")&&(n={},a.objectEach(p.hcEvents,function(a,e){n[e]=a.slice(0)}),p.hcEvents=n);r=p.hcEvents=p.hcEvents||{};w&&w.call(p,g,l,!1);r[g]||(r[g]=[]);r[g].push(l);return function(){a.removeEvent(p,g,l)}};a.removeEvent=function(p,g,l){function r(e,m){var c=p.removeEventListener||a.removeEventListenerPolyfill;c&&c.call(p,e,m,!1)}function n(){var e,m;p.nodeName&&(g?(e={},e[g]=!0):e=v,a.objectEach(e,function(a,f){if(v[f]){for(m=v[f].length;m--;){r(f,v[f][m])}}}))}var w,v=p.hcEvents,e;v&&(g?(w=v[g]||[],l?(e=a.inArray(l,w),-1<e&&(w.splice(e,1),v[g]=w),r(g,l)):(n(),v[g]=[])):(n(),p.hcEvents={}))};a.fireEvent=function(p,g,l,r){var n;n=p.hcEvents;var w,v;l=l||{};if(B.createEvent&&(p.dispatchEvent||p.fireEvent)){n=B.createEvent("Events"),n.initEvent(g,!0,!0),a.extend(n,l),p.dispatchEvent?p.dispatchEvent(n):p.fireEvent(g,n)}else if(n){for(n=n[g]||[],w=n.length,l.target||a.extend(l,{preventDefault:function(){l.defaultPrevented=!0},target:p,type:g}),g=0;g<w;g++){(v=n[g])&&!1===v.call(p,l)&&l.preventDefault()}}r&&!l.defaultPrevented&&r(l)};a.animate=function(p,g,l){var r,n="",w,v,e;a.isObject(l)||(e=arguments,l={duration:e[2],easing:e[3],complete:e[4]});a.isNumber(l.duration)||(l.duration=400);l.easing="function"===typeof l.easing?l.easing:Math[l.easing]||Math.easeInOutSine;l.curAnim=a.merge(g);a.objectEach(g,function(e,m){a.stop(p,m);v=new a.Fx(p,l,m);w=null;"d"===m?(v.paths=v.initPath(p,p.d,g.d),v.toD=g.d,r=0,w=1):p.attr?r=p.attr(m):(r=parseFloat(a.getStyle(p,m))||0,"opacity"!==m&&(n="px"));w||(w=e);w&&w.match&&w.match("px")&&(w=w.replace(/px/g,""));v.run(r,w,n)})};a.seriesType=function(p,g,l,r,n){var w=a.getOptions(),v=a.seriesTypes;w.plotOptions[p]=a.merge(w.plotOptions[g],l);v[p]=a.extendClass(v[g]||function(){},r);v[p].prototype.type=p;n&&(v[p].prototype.pointClass=a.extendClass(a.Point,n));return v[p]};a.uniqueKey=function(){var a=Math.random().toString(36).substring(2,9),g=0;return function(){return"highcharts-"+a+"-"+g++}}();G.jQuery&&(G.jQuery.fn.highcharts=function(){var p=[].slice.call(arguments);if(this[0]){return p[0]?(new(a[a.isString(p[0])?p.shift():"Chart"])(this[0],p[0],p[1]),this):D[a.attr(this[0],"data-highcharts-chart")]}})})(N);(function(a){var D=a.each,B=a.isNumber,G=a.map,p=a.merge,g=a.pInt;a.Color=function(l){if(!(this instanceof a.Color)){return new a.Color(l)}this.init(l)};a.Color.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(a){return[g(a[1]),g(a[2]),g(a[3]),parseFloat(a[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(a){return[g(a[1]),g(a[2]),g(a[3]),1]}}],names:{none:"rgba(255,255,255,0)",white:"#ffffff",black:"#000000"},init:function(l){var g,n,w,v;if((this.input=l=this.names[l&&l.toLowerCase?l.toLowerCase():""]||l)&&l.stops){this.stops=G(l.stops,function(e){return new a.Color(e[1])})}else if(l&&l.charAt&&"#"===l.charAt()&&(g=l.length,l=parseInt(l.substr(1),16),7===g?n=[(l&16711680)>>16,(l&65280)>>8,l&255,1]:4===g&&(n=[(l&3840)>>4|(l&3840)>>8,(l&240)>>4|l&240,(l&15)<<4|l&15,1])),!n){for(w=this.parsers.length;w--&&!n;){v=this.parsers[w],(g=v.regex.exec(l))&&(n=v.parse(g))}}this.rgba=n||[]},get:function(a){var l=this.input,n=this.rgba,g;this.stops?(g=p(l),g.stops=[].concat(g.stops),D(this.stops,function(n,e){g.stops[e]=[g.stops[e][0],n.get(a)]})):g=n&&B(n[0])?"rgb"===a||!a&&1===n[3]?"rgb("+n[0]+","+n[1]+","+n[2]+")":"a"===a?n[3]:"rgba("+n.join(",")+")":l;return g},brighten:function(a){var l,n=this.rgba;if(this.stops){D(this.stops,function(n){n.brighten(a)})}else if(B(a)&&0!==a){for(l=0;3>l;l++){n[l]+=g(255*a),0>n[l]&&(n[l]=0),255<n[l]&&(n[l]=255)}}return this},setOpacity:function(a){this.rgba[3]=a;return this},tweenTo:function(a,g){var n=this.rgba,l=a.rgba;l.length&&n&&n.length?(a=1!==l[3]||1!==n[3],g=(a?"rgba(":"rgb(")+Math.round(l[0]+(n[0]-l[0])*(1-g))+","+Math.round(l[1]+(n[1]-l[1])*(1-g))+","+Math.round(l[2]+(n[2]-l[2])*(1-g))+(a?","+(l[3]+(n[3]-l[3])*(1-g)):"")+")"):g=a.input||"none";return g}};a.color=function(g){return new a.Color(g)}})(N);(function(a){var D,B,G=a.addEvent,p=a.animate,g=a.attr,l=a.charts,r=a.color,n=a.css,w=a.createElement,v=a.defined,e=a.deg2rad,h=a.destroyObjectProperties,m=a.doc,c=a.each,f=a.extend,b=a.erase,d=a.grep,y=a.hasTouch,H=a.inArray,J=a.isArray,t=a.isFirefox,K=a.isMS,x=a.isObject,C=a.isString,L=a.isWebKit,q=a.merge,A=a.noop,E=a.objectEach,F=a.pick,k=a.pInt,u=a.removeEvent,R=a.stop,M=a.svg,P=a.SVG_NS,I=a.symbolSizes,Q=a.win;D=a.SVGElement=function(){return this};f(D.prototype,{opacity:1,SVG_NS:P,textProps:"direction fontSize fontWeight fontFamily fontStyle color lineHeight width textAlign textDecoration textOverflow textOutline".split(" "),init:function(a,k){this.element="span"===k?w(k):m.createElementNS(this.SVG_NS,k);this.renderer=a},animate:function(z,k,b){k=a.animObject(F(k,this.renderer.globalAnimation,!0));0!==k.duration?(b&&(k.complete=b),p(this,z,k)):(this.attr(z,null,b),k.step&&k.step.call(this));return this},colorGradient:function(z,k,b){var u=this.renderer,f,O,d,e,y,m,h,M,A,I,x=[],t;z.radialGradient?O="radialGradient":z.linearGradient&&(O="linearGradient");O&&(d=z[O],y=u.gradients,h=z.stops,I=b.radialReference,J(d)&&(z[O]=d={x1:d[0],y1:d[1],x2:d[2],y2:d[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===O&&I&&!v(d.gradientUnits)&&(e=d,d=q(d,u.getRadialAttr(I,e),{gradientUnits:"userSpaceOnUse"})),E(d,function(a,z){"id"!==z&&x.push(z,a)}),E(h,function(a){x.push(a)}),x=x.join(","),y[x]?I=y[x].attr("id"):(d.id=I=a.uniqueKey(),y[x]=m=u.createElement(O).attr(d).add(u.defs),m.radAttr=e,m.stops=[],c(h,function(z){0===z[1].indexOf("rgba")?(f=a.color(z[1]),M=f.get("rgb"),A=f.get("a")):(M=z[1],A=1);z=u.createElement("stop").attr({offset:z[0],"stop-color":M,"stop-opacity":A}).add(m);m.stops.push(z)})),t="url("+u.url+"#"+I+")",b.setAttribute(k,t),b.gradient=x,z.toString=function(){return t})},applyTextOutline:function(z){var k=this.element,u,f,d,q,e;-1!==z.indexOf("contrast")&&(z=z.replace(/contrast/g,this.renderer.getContrast(k.style.fill)));z=z.split(" ");f=z[z.length-1];if((d=z[0])&&"none"!==d&&a.svg){this.fakeTS=!0;z=[].slice.call(k.getElementsByTagName("tspan"));this.ySetter=this.xSetter;d=d.replace(/(^[\d\.]+)(.*?)$/g,function(a,z,k){return 2*z+k});for(e=z.length;e--;){u=z[e],"highcharts-text-outline"===u.getAttribute("class")&&b(z,k.removeChild(u))}q=k.firstChild;c(z,function(a,z){0===z&&(a.setAttribute("x",k.getAttribute("x")),z=k.getAttribute("y"),a.setAttribute("y",z||0),null===z&&k.setAttribute("y",0));a=a.cloneNode(1);g(a,{class:"highcharts-text-outline",fill:f,stroke:f,"stroke-width":d,"stroke-linejoin":"round"});k.insertBefore(a,q)})}},attr:function(a,k,b,u){var z,f=this.element,d,c=this,O,q;"string"===typeof a&&void 0!==k&&(z=a,a={},a[z]=k);"string"===typeof a?c=(this[a+"Getter"]||this._defaultGetter).call(this,a,f):(E(a,function(z,k){O=!1;u||R(this,k);this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)$/.test(k)&&(d||(this.symbolAttr(a),d=!0),O=!0);!this.rotation||"x"!==k&&"y"!==k||(this.doTransform=!0);O||(q=this[k+"Setter"]||this._defaultSetter,q.call(this,z,k,f),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(k)&&this.updateShadows(k,z,q))},this),this.afterSetters());b&&b();return c},afterSetters:function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},updateShadows:function(a,k,b){for(var z=this.shadows,u=z.length;u--;){b.call(z[u],"height"===a?Math.max(k-(z[u].cutHeight||0),0):"d"===a?this.d:k,a,z[u])}},addClass:function(a,k){var z=this.attr("class")||"";-1===z.indexOf(a)&&(k||(a=(z+(z?" ":"")+a).replace("  "," ")),this.attr("class",a));return this},hasClass:function(a){return-1!==H(a,(this.attr("class")||"").split(" "))},removeClass:function(a){return this.attr("class",(this.attr("class")||"").replace(a,""))},symbolAttr:function(a){var z=this;c("x y r start end width height innerR anchorX anchorY".split(" "),function(k){z[k]=F(a[k],z[k])});z.attr({d:z.renderer.symbols[z.symbolName](z.x,z.y,z.width,z.height,z)})},clip:function(a){return this.attr("clip-path",a?"url("+this.renderer.url+"#"+a.id+")":"none")},crisp:function(a,k){var z=this,b={},u;k=k||a.strokeWidth||0;u=Math.round(k)%2/2;a.x=Math.floor(a.x||z.x||0)+u;a.y=Math.floor(a.y||z.y||0)+u;a.width=Math.floor((a.width||z.width||0)-2*u);a.height=Math.floor((a.height||z.height||0)-2*u);v(a.strokeWidth)&&(a.strokeWidth=k);E(a,function(a,k){z[k]!==a&&(z[k]=b[k]=a)});return b},css:function(a){var z=this.styles,b={},u=this.element,d,c="",q,e=!z,y=["textOutline","textOverflow","width"];a&&a.color&&(a.fill=a.color);z&&E(a,function(a,k){a!==z[k]&&(b[k]=a,e=!0)});e&&(z&&(a=f(z,b)),d=this.textWidth=a&&a.width&&"auto"!==a.width&&"text"===u.nodeName.toLowerCase()&&k(a.width),this.styles=a,d&&!M&&this.renderer.forExport&&delete a.width,K&&!M?n(this.element,a):(q=function(a,z){return"-"+z.toLowerCase()},E(a,function(a,z){-1===H(z,y)&&(c+=z.replace(/([A-Z])/g,q)+":"+a+";")}),c&&g(u,"style",c)),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),a&&a.textOutline&&this.applyTextOutline(a.textOutline)));return this},strokeWidth:function(){return this["stroke-width"]||0},on:function(a,k){var z=this,b=z.element;y&&"click"===a?(b.ontouchstart=function(a){z.touchEventFired=Date.now();a.preventDefault();k.call(b,a)},b.onclick=function(a){(-1===Q.navigator.userAgent.indexOf("Android")||1100<Date.now()-(z.touchEventFired||0))&&k.call(b,a)}):b["on"+a]=k;return this},setRadialReference:function(a){var z=this.renderer.gradients[this.element.gradient];this.element.radialReference=a;z&&z.radAttr&&z.animate(this.renderer.getRadialAttr(a,z.radAttr));return this},translate:function(a,k){return this.attr({translateX:a,translateY:k})},invert:function(a){this.inverted=a;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,k=this.translateY||0,b=this.scaleX,u=this.scaleY,f=this.inverted,d=this.rotation,c=this.matrix,q=this.element;f&&(a+=this.width,k+=this.height);a=["translate("+a+","+k+")"];v(c)&&a.push("matrix("+c.join(",")+")");f?a.push("rotate(90) scale(-1,1)"):d&&a.push("rotate("+d+" "+F(this.rotationOriginX,q.getAttribute("x"),0)+" "+F(this.rotationOriginY,q.getAttribute("y")||0)+")");(v(b)||v(u))&&a.push("scale("+F(b,1)+" "+F(u,1)+")");a.length&&q.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,k,u){var z,f,d,c,q={};f=this.renderer;d=f.alignedObjects;var e,O;if(a){if(this.alignOptions=a,this.alignByTranslate=k,!u||C(u)){this.alignTo=z=u||"renderer",b(d,this),d.push(this),u=null}}else{a=this.alignOptions,k=this.alignByTranslate,z=this.alignTo}u=F(u,f[z],f);z=a.align;f=a.verticalAlign;d=(u.x||0)+(a.x||0);c=(u.y||0)+(a.y||0);"right"===z?e=1:"center"===z&&(e=2);e&&(d+=(u.width-(a.width||0))/e);q[k?"translateX":"x"]=Math.round(d);"bottom"===f?O=1:"middle"===f&&(O=2);O&&(c+=(u.height-(a.height||0))/O);q[k?"translateY":"y"]=Math.round(c);this[this.placed?"animate":"attr"](q);this.placed=!0;this.alignAttr=q;return this},getBBox:function(a,k){var z,b=this.renderer,u,d=this.element,q=this.styles,O,y=this.textStr,m,h=b.cache,M=b.cacheKeys,A;k=F(k,this.rotation);u=k*e;O=q&&q.fontSize;v(y)&&(A=y.toString(),-1===A.indexOf("<")&&(A=A.replace(/[0-9]/g,"0")),A+=["",k||0,O,q&&q.width,q&&q.textOverflow].join());A&&!a&&(z=h[A]);if(!z){if(d.namespaceURI===this.SVG_NS||b.forExport){try{(m=this.fakeTS&&function(a){c(d.querySelectorAll(".highcharts-text-outline"),function(z){z.style.display=a})})&&m("none"),z=d.getBBox?f({},d.getBBox()):{width:d.offsetWidth,height:d.offsetHeight},m&&m("")}catch(W){}if(!z||0>z.width){z={width:0,height:0}}}else{z=this.htmlGetBBox()}b.isSVG&&(a=z.width,b=z.height,q&&"11px"===q.fontSize&&17===Math.round(b)&&(z.height=b=14),k&&(z.width=Math.abs(b*Math.sin(u))+Math.abs(a*Math.cos(u)),z.height=Math.abs(b*Math.cos(u))+Math.abs(a*Math.sin(u))));if(A&&0<z.height){for(;250<M.length;){delete h[M.shift()]}h[A]||M.push(A);h[A]=z}}return z},show:function(a){return this.attr({visibility:a?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var z=this;z.animate({opacity:0},{duration:a||150,complete:function(){z.attr({y:-9999})}})},add:function(a){var z=this.renderer,k=this.element,b;a&&(this.parentGroup=a);this.parentInverted=a&&a.inverted;void 0!==this.textStr&&z.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex){b=this.zIndexSetter()}b||(a?a.element:z.box).appendChild(k);if(this.onAdd){this.onAdd()}return this},safeRemoveChild:function(a){var z=a.parentNode;z&&z.removeChild(a)},destroy:function(){var a=this,k=a.element||{},u=a.renderer.isSVG&&"SPAN"===k.nodeName&&a.parentGroup,f=k.ownerSVGElement;k.onclick=k.onmouseout=k.onmouseover=k.onmousemove=k.point=null;R(a);a.clipPath&&f&&(c(f.querySelectorAll("[clip-path],[CLIP-PATH]"),function(k){k.getAttribute("clip-path").match(RegExp('[("]#'+a.clipPath.element.id+'[)"]'))&&k.removeAttribute("clip-path")}),a.clipPath=a.clipPath.destroy());if(a.stops){for(f=0;f<a.stops.length;f++){a.stops[f]=a.stops[f].destroy()}a.stops=null}a.safeRemoveChild(k);for(a.destroyShadows();u&&u.div&&0===u.div.childNodes.length;){k=u.parentGroup,a.safeRemoveChild(u.div),delete u.div,u=k}a.alignTo&&b(a.renderer.alignedObjects,a);E(a,function(k,z){delete a[z]});return null},shadow:function(a,k,b){var z=[],u,f,d=this.element,c,q,e,y;if(!a){this.destroyShadows()}else if(!this.shadows){q=F(a.width,3);e=(a.opacity||.15)/q;y=this.parentInverted?"(-1,-1)":"("+F(a.offsetX,1)+", "+F(a.offsetY,1)+")";for(u=1;u<=q;u++){f=d.cloneNode(0),c=2*q+1-2*u,g(f,{isShadow:"true",stroke:a.color||"#000000","stroke-opacity":e*u,"stroke-width":c,transform:"translate"+y,fill:"none"}),b&&(g(f,"height",Math.max(g(f,"height")-c,0)),f.cutHeight=c),k?k.element.appendChild(f):d.parentNode&&d.parentNode.insertBefore(f,d),z.push(f)}this.shadows=z}return this},destroyShadows:function(){c(this.shadows||[],function(a){this.safeRemoveChild(a)},this);this.shadows=void 0},xGetter:function(a){"circle"===this.element.nodeName&&("x"===a?a="cx":"y"===a&&(a="cy"));return this._defaultGetter(a)},_defaultGetter:function(a){a=F(this[a],this.element?this.element.getAttribute(a):null,0);/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a));return a},dSetter:function(a,k,b){a&&a.join&&(a=a.join(" "));/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");this[k]!==a&&(b.setAttribute(k,a),this[k]=a)},dashstyleSetter:function(a){var b,u=this["stroke-width"];"inherit"===u&&(u=1);if(a=a&&a.toLowerCase()){a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(b=a.length;b--;){a[b]=k(a[b])*u}a=a.join(",").replace(/NaN/g,"none");this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},opacitySetter:function(a,k,b){this[k]=a;b.setAttribute(k,a)},titleSetter:function(a){var k=this.element.getElementsByTagName("title")[0];k||(k=m.createElementNS(this.SVG_NS,"title"),this.element.appendChild(k));k.firstChild&&k.removeChild(k.firstChild);k.appendChild(m.createTextNode(String(F(a),"").replace(/<[^>]*>/g,"")))},textSetter:function(a){a!==this.textStr&&(delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this))},fillSetter:function(a,k,b){"string"===typeof a?b.setAttribute(k,a):a&&this.colorGradient(a,k,b)},visibilitySetter:function(a,k,b){"inherit"===a?b.removeAttribute(k):this[k]!==a&&b.setAttribute(k,a);this[k]=a},zIndexSetter:function(a,b){var u=this.renderer,z=this.parentGroup,f=(z||u).element||u.box,d,c=this.element,q,e,u=f===u.box;d=this.added;var y;v(a)&&(c.zIndex=a,a=+a,this[b]===a&&(d=!1),this[b]=a);if(d){(a=this.zIndex)&&z&&(z.handleZ=!0);b=f.childNodes;for(y=b.length-1;0<=y&&!q;y--){if(z=b[y],d=z.zIndex,e=!v(d),z!==c){if(0>a&&e&&!u&&!y){f.insertBefore(c,b[y]),q=!0}else if(k(d)<=a||e&&(!v(a)||0<=a)){f.insertBefore(c,b[y+1]||null),q=!0}}}q||(f.insertBefore(c,b[u?3:0]||null),q=!0)}return q},_defaultSetter:function(a,k,b){b.setAttribute(k,a)}});D.prototype.yGetter=D.prototype.xGetter;D.prototype.translateXSetter=D.prototype.translateYSetter=D.prototype.rotationSetter=D.prototype.verticalAlignSetter=D.prototype.rotationOriginXSetter=D.prototype.rotationOriginYSetter=D.prototype.scaleXSetter=D.prototype.scaleYSetter=D.prototype.matrixSetter=function(a,k){this[k]=a;this.doTransform=!0};D.prototype["stroke-widthSetter"]=D.prototype.strokeSetter=function(a,k,b){this[k]=a;this.stroke&&this["stroke-width"]?(D.prototype.fillSetter.call(this,this.stroke,"stroke",b),b.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===k&&0===a&&this.hasStroke&&(b.removeAttribute("stroke"),this.hasStroke=!1)};B=a.SVGRenderer=function(){this.init.apply(this,arguments)};f(B.prototype,{Element:D,SVG_NS:P,init:function(a,k,b,u,f,d){var z;u=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}).css(this.getStyle(u));z=u.element;a.appendChild(z);g(a,"dir","ltr");-1===a.innerHTML.indexOf("xmlns")&&g(z,"xmlns",this.SVG_NS);this.isSVG=!0;this.box=z;this.boxWrapper=u;this.alignedObjects=[];this.url=(t||L)&&m.getElementsByTagName("base").length?Q.location.href.replace(/#.*?$/,"").replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(m.createTextNode("Created with Highcharts 6.0.3"));this.defs=this.createElement("defs").add();this.allowHTML=d;this.forExport=f;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(k,b,!1);var c;t&&a.getBoundingClientRect&&(k=function(){n(a,{left:0,top:0});c=a.getBoundingClientRect();n(a,{left:Math.ceil(c.left)-c.left+"px",top:Math.ceil(c.top)-c.top+"px"})},k(),this.unSubPixelFix=G(Q,"resize",k))},getStyle:function(a){return this.style=f({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},setStyle:function(a){this.boxWrapper.css(this.getStyle(a))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();h(this.gradients||{});this.gradients=null;a&&(this.defs=a.destroy());this.unSubPixelFix&&this.unSubPixelFix();return this.alignedObjects=null},createElement:function(a){var k=new this.Element;k.init(this,a);return k},draw:A,getRadialAttr:function(a,k){return{cx:a[0]-a[2]/2+k.cx*a[2],cy:a[1]-a[2]/2+k.cy*a[2],r:k.r*a[2]}},getSpanWidth:function(a,k){var b=a.getBBox(!0).width;!M&&this.forExport&&(b=this.measureSpanWidth(k.firstChild.data,a.styles));return b},applyEllipsis:function(a,k,b,u){var f=a.rotation,z=b,d,c=0,q=b.length,e=function(a){k.removeChild(k.firstChild);a&&k.appendChild(m.createTextNode(a))},y;a.rotation=0;z=this.getSpanWidth(a,k);if(y=z>u){for(;c<=q;){d=Math.ceil((c+q)/2),z=b.substring(0,d)+"‚Ä¶",e(z),z=this.getSpanWidth(a,k),c===q?c=q+1:z>u?q=d-1:c=d}0===q&&e("")}a.rotation=f;return y},escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot"},buildText:function(a){var b=a.element,u=this,f=u.forExport,z=F(a.textStr,"").toString(),q=-1!==z.indexOf("<"),e=b.childNodes,y,h,A,I,x=g(b,"x"),t=a.styles,H=a.textWidth,l=t&&t.lineHeight,C=t&&t.textOutline,v=t&&"ellipsis"===t.textOverflow,R=t&&"nowrap"===t.whiteSpace,w=t&&t.fontSize,Q,J,r=e.length,t=H&&!a.added&&this.box,K=function(a){var f;f=/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:w||u.style.fontSize||12;return l?k(l):u.fontMetrics(f,a.getAttribute("style")?a:b).h},p=function(a){E(u.escapes,function(k,b){a=a.replace(new RegExp(k,"g"),b)});return a};Q=[z,v,R,l,C,w,H].join();if(Q!==a.textCache){for(a.textCache=Q;r--;){b.removeChild(e[r])}q||C||v||H||-1!==z.indexOf(" ")?(y=/<.*class="([^"]+)".*>/,h=/<.*style="([^"]+)".*>/,A=/<.*href="([^"]+)".*>/,t&&t.appendChild(b),z=q?z.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[z],z=d(z,function(a){return""!==a}),c(z,function(k,z){var d,q=0;k=k.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");d=k.split("|||");c(d,function(k){if(""!==k||1===d.length){var c={},e=m.createElementNS(u.SVG_NS,"tspan"),t,E;y.test(k)&&(t=k.match(y)[1],g(e,"class",t));h.test(k)&&(E=k.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),g(e,"style",E));A.test(k)&&!f&&(g(e,"onclick",'location.href="'+k.match(A)[1]+'"'),g(e,"class","highcharts-anchor"),n(e,{cursor:"pointer"}));k=p(k.replace(/<[a-zA-Z\/](.|\n)*?>/g,"")||" ");if(" "!==k){e.appendChild(m.createTextNode(k));q?c.dx=0:z&&null!==x&&(c.x=x);g(e,c);b.appendChild(e);!q&&J&&(!M&&f&&n(e,{display:"block"}),g(e,"dy",K(e)));if(H){c=k.replace(/([^\^])-/g,"$1- ").split(" ");t=1<d.length||z||1<c.length&&!R;var O=[],l,C=K(e),F=a.rotation;for(v&&(I=u.applyEllipsis(a,e,k,H));!v&&t&&(c.length||O.length);){a.rotation=0,l=u.getSpanWidth(a,e),k=l>H,void 0===I&&(I=k),k&&1!==c.length?(e.removeChild(e.firstChild),O.unshift(c.pop())):(c=O,O=[],c.length&&!R&&(e=m.createElementNS(P,"tspan"),g(e,{dy:C,x:x}),E&&g(e,"style",E),b.appendChild(e)),l>H&&(H=l)),c.length&&e.appendChild(m.createTextNode(c.join(" ").replace(/- /g,"-")))}a.rotation=F}q++}}});J=J||b.childNodes.length}),I&&a.attr("title",a.textStr),t&&t.removeChild(b),C&&a.applyTextOutline&&a.applyTextOutline(C)):b.appendChild(m.createTextNode(p(z)))}},getContrast:function(a){a=r(a).rgba;return 510<a[0]+a[1]+a[2]?"#000000":"#FFFFFF"},button:function(a,k,b,u,d,c,e,y,m){var z=this.label(a,k,b,m,null,null,null,null,"button"),h=0;z.attr(q({padding:8,r:2},d));var A,M,I,t;d=q({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},d);A=d.style;delete d.style;c=q(d,{fill:"#e6e6e6"},c);M=c.style;delete c.style;e=q(d,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},e);I=e.style;delete e.style;y=q(d,{style:{color:"#cccccc"}},y);t=y.style;delete y.style;G(z.element,K?"mouseover":"mouseenter",function(){3!==h&&z.setState(1)});G(z.element,K?"mouseout":"mouseleave",function(){3!==h&&z.setState(h)});z.setState=function(a){1!==a&&(z.state=h=a);z.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][a||0]);z.attr([d,c,e,y][a||0]).css([A,M,I,t][a||0])};z.attr(d).css(f({cursor:"default"},A));return z.on("click",function(a){3!==h&&u.call(z,a)})},crispLine:function(a,k){a[1]===a[4]&&(a[1]=a[4]=Math.round(a[1])-k%2/2);a[2]===a[5]&&(a[2]=a[5]=Math.round(a[2])+k%2/2);return a},path:function(a){var k={fill:"none"};J(a)?k.d=a:x(a)&&f(k,a);return this.createElement("path").attr(k)},circle:function(a,k,b){a=x(a)?a:{x:a,y:k,r:b};k=this.createElement("circle");k.xSetter=k.ySetter=function(a,k,b){b.setAttribute("c"+k,a)};return k.attr(a)},arc:function(a,k,b,u,d,f){x(a)?(u=a,k=u.y,b=u.r,a=u.x):u={innerR:u,start:d,end:f};a=this.symbol("arc",a,k,b,b,u);a.r=b;return a},rect:function(a,k,b,u,d,f){d=x(a)?a.r:d;var c=this.createElement("rect");a=x(a)?a:void 0===a?{}:{x:a,y:k,width:Math.max(b,0),height:Math.max(u,0)};void 0!==f&&(a.strokeWidth=f,a=c.crisp(a));a.fill="none";d&&(a.r=d);c.rSetter=function(a,k,b){g(b,{rx:a,ry:a})};return c.attr(a)},setSize:function(a,k,b){var u=this.alignedObjects,d=u.length;this.width=a;this.height=k;for(this.boxWrapper.animate({width:a,height:k},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:F(b,!0)?void 0:0});d--;){u[d].align()}},g:function(a){var k=this.createElement("g");return a?k.attr({class:"highcharts-"+a}):k},image:function(a,k,b,u,d){var c={preserveAspectRatio:"none"};1<arguments.length&&f(c,{x:k,y:b,width:u,height:d});c=this.createElement("image").attr(c);c.element.setAttributeNS?c.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):c.element.setAttribute("hc-svg-href",a);return c},symbol:function(a,k,b,u,d,q){var e=this,z,y=/^url\((.*?)\)$/,h=y.test(a),A=!h&&(this.symbols[a]?a:"circle"),M=A&&this.symbols[A],t=v(k)&&M&&M.call(this.symbols,Math.round(k),Math.round(b),u,d,q),x,E;M?(z=this.path(t),z.attr("fill","none"),f(z,{symbolName:A,x:k,y:b,width:u,height:d}),q&&f(z,q)):h&&(x=a.match(y)[1],z=this.image(x),z.imgwidth=F(I[x]&&I[x].width,q&&q.width),z.imgheight=F(I[x]&&I[x].height,q&&q.height),E=function(){z.attr({width:z.width,height:z.height})},c(["width","height"],function(a){z[a+"Setter"]=function(a,k){var b={},u=this["img"+k],d="width"===k?"translateX":"translateY";this[k]=a;v(u)&&(this.element&&this.element.setAttribute(k,u),this.alignByTranslate||(b[d]=((this[k]||0)-u)/2,this.attr(b)))}}),v(k)&&z.attr({x:k,y:b}),z.isImg=!0,v(z.imgwidth)&&v(z.imgheight)?E():(z.attr({width:0,height:0}),w("img",{onload:function(){var a=l[e.chartIndex];0===this.width&&(n(this,{position:"absolute",top:"-999em"}),m.body.appendChild(this));I[x]={width:this.width,height:this.height};z.imgwidth=this.width;z.imgheight=this.height;z.element&&E();this.parentNode&&this.parentNode.removeChild(this);e.imgCount--;if(!e.imgCount&&a&&a.onload){a.onload()}},src:x}),this.imgCount++));return z},symbols:{circle:function(a,k,b,u){return this.arc(a+b/2,k+u/2,b/2,u/2,{start:0,end:2*Math.PI,open:!1})},square:function(a,k,b,u){return["M",a,k,"L",a+b,k,a+b,k+u,a,k+u,"Z"]},triangle:function(a,k,b,u){return["M",a+b/2,k,"L",a+b,k+u,a,k+u,"Z"]},"triangle-down":function(a,k,b,u){return["M",a,k,"L",a+b,k,a+b/2,k+u,"Z"]},diamond:function(a,k,b,u){return["M",a+b/2,k,"L",a+b,k+u/2,a+b/2,k+u,a,k+u/2,"Z"]},arc:function(a,k,b,u,d){var f=d.start,c=d.r||b,q=d.r||u||b,e=d.end-.001;b=d.innerR;u=F(d.open,.001>Math.abs(d.end-d.start-2*Math.PI));var z=Math.cos(f),y=Math.sin(f),h=Math.cos(e),e=Math.sin(e);d=.001>d.end-f-Math.PI?0:1;c=["M",a+c*z,k+q*y,"A",c,q,0,d,1,a+c*h,k+q*e];v(b)&&c.push(u?"M":"L",a+b*h,k+b*e,"A",b,b,0,d,0,a+b*z,k+b*y);c.push(u?"":"Z");return c},callout:function(a,k,b,u,d){var f=Math.min(d&&d.r||0,b,u),c=f+6,q=d&&d.anchorX;d=d&&d.anchorY;var e;e=["M",a+f,k,"L",a+b-f,k,"C",a+b,k,a+b,k,a+b,k+f,"L",a+b,k+u-f,"C",a+b,k+u,a+b,k+u,a+b-f,k+u,"L",a+f,k+u,"C",a,k+u,a,k+u,a,k+u-f,"L",a,k+f,"C",a,k,a,k,a+f,k];q&&q>b?d>k+c&&d<k+u-c?e.splice(13,3,"L",a+b,d-6,a+b+6,d,a+b,d+6,a+b,k+u-f):e.splice(13,3,"L",a+b,u/2,q,d,a+b,u/2,a+b,k+u-f):q&&0>q?d>k+c&&d<k+u-c?e.splice(33,3,"L",a,d+6,a-6,d,a,d-6,a,k+f):e.splice(33,3,"L",a,u/2,q,d,a,u/2,a,k+f):d&&d>u&&q>a+c&&q<a+b-c?e.splice(23,3,"L",q+6,k+u,q,k+u+6,q-6,k+u,a+f,k+u):d&&0>d&&q>a+c&&q<a+b-c&&e.splice(3,3,"L",q-6,k,q,k-6,q+6,k,b-f,k);return e}},clipRect:function(k,b,u,d){var f=a.uniqueKey(),c=this.createElement("clipPath").attr({id:f}).add(this.defs);k=this.rect(k,b,u,d,0).add(c);k.id=f;k.clipPath=c;k.count=0;return k},text:function(a,k,b,u){var d={};if(u&&(this.allowHTML||!this.forExport)){return this.html(a,k,b)}d.x=Math.round(k||0);b&&(d.y=Math.round(b));if(a||0===a){d.text=a}a=this.createElement("text").attr(d);u||(a.xSetter=function(a,k,b){var u=b.getElementsByTagName("tspan"),d,f=b.getAttribute(k),c;for(c=0;c<u.length;c++){d=u[c],d.getAttribute(k)===f&&d.setAttribute(k,a)}b.setAttribute(k,a)});return a},fontMetrics:function(a,b){a=a||b&&b.style&&b.style.fontSize||this.style&&this.style.fontSize;a=/px/.test(a)?k(a):/em/.test(a)?parseFloat(a)*(b?this.fontMetrics(null,b.parentNode).f:16):12;b=24>a?a+3:Math.round(1.2*a);return{h:b,b:Math.round(.8*b),f:a}},rotCorr:function(a,k,b){var u=a;k&&b&&(u=Math.max(u*Math.cos(k*e),4));return{x:-a/3*Math.sin(k*e),y:u}},label:function(k,b,d,e,y,h,m,A,M){var z=this,I=z.g("button"!==M&&"label"),x=I.text=z.text("",0,0,m).attr({zIndex:1}),t,E,H=0,n=3,l=0,g,C,R,F,w,Q={},P,J,r=/^url\((.*?)\)$/.test(e),K=r,p,O,L,T;M&&I.addClass("highcharts-"+M);K=r;p=function(){return(P||0)%2/2};O=function(){var a=x.element.style,k={};E=(void 0===g||void 0===C||w)&&v(x.textStr)&&x.getBBox();I.width=(g||E.width||0)+2*n+l;I.height=(C||E.height||0)+2*n;J=n+z.fontMetrics(a&&a.fontSize,x).b;K&&(t||(I.box=t=z.symbols[e]||r?z.symbol(e):z.rect(),t.addClass(("button"===M?"":"highcharts-label-box")+(M?" highcharts-"+M+"-box":"")),t.add(I),a=p(),k.x=a,k.y=(A?-J:0)+a),k.width=Math.round(I.width),k.height=Math.round(I.height),t.attr(f(k,Q)),Q={})};L=function(){var a=l+n,k;k=A?0:J;v(g)&&E&&("center"===w||"right"===w)&&(a+={center:.5,right:1}[w]*(g-E.width));if(a!==x.x||k!==x.y){x.attr("x",a),void 0!==k&&x.attr("y",k)}x.x=a;x.y=k};T=function(a,k){t?t.attr(a,k):Q[a]=k};I.onAdd=function(){x.add(I);I.attr({text:k||0===k?k:"",x:b,y:d});t&&v(y)&&I.attr({anchorX:y,anchorY:h})};I.widthSetter=function(k){g=a.isNumber(k)?k:null};I.heightSetter=function(a){C=a};I["text-alignSetter"]=function(a){w=a};I.paddingSetter=function(a){v(a)&&a!==n&&(n=I.padding=a,L())};I.paddingLeftSetter=function(a){v(a)&&a!==l&&(l=a,L())};I.alignSetter=function(a){a={left:0,center:.5,right:1}[a];a!==H&&(H=a,E&&I.attr({x:R}))};I.textSetter=function(a){void 0!==a&&x.textSetter(a);O();L()};I["stroke-widthSetter"]=function(a,k){a&&(K=!0);P=this["stroke-width"]=a;T(k,a)};I.strokeSetter=I.fillSetter=I.rSetter=function(a,k){"r"!==k&&("fill"===k&&a&&(K=!0),I[k]=a);T(k,a)};I.anchorXSetter=function(a,k){y=I.anchorX=a;T(k,Math.round(a)-p()-R)};I.anchorYSetter=function(a,k){h=I.anchorY=a;T(k,a-F)};I.xSetter=function(a){I.x=a;H&&(a-=H*((g||E.width)+2*n));R=Math.round(a);I.attr("translateX",R)};I.ySetter=function(a){F=I.y=Math.round(a);I.attr("translateY",F)};var U=I.css;return f(I,{css:function(a){if(a){var k={};a=q(a);c(I.textProps,function(b){void 0!==a[b]&&(k[b]=a[b],delete a[b])});x.css(k)}return U.call(I,a)},getBBox:function(){return{width:E.width+2*n,height:E.height+2*n,x:E.x-n,y:E.y-n}},shadow:function(a){a&&(O(),t&&t.shadow(a));return I},destroy:function(){u(I.element,"mouseenter");u(I.element,"mouseleave");x&&(x=x.destroy());t&&(t=t.destroy());D.prototype.destroy.call(I);I=z=O=L=T=null}})}});a.Renderer=B})(N);(function(a){var D=a.attr,B=a.createElement,G=a.css,p=a.defined,g=a.each,l=a.extend,r=a.isFirefox,n=a.isMS,w=a.isWebKit,v=a.pick,e=a.pInt,h=a.SVGRenderer,m=a.win,c=a.wrap;l(a.SVGElement.prototype,{htmlCss:function(a){var b=this.element;if(b=a&&"SPAN"===b.tagName&&a.width){delete a.width,this.textWidth=b,this.updateTransform()}a&&"ellipsis"===a.textOverflow&&(a.whiteSpace="nowrap",a.overflow="hidden");this.styles=l(this.styles,a);G(this.element,a);return this},htmlGetBBox:function(){var a=this.element;return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,d=this.translateX||0,c=this.translateY||0,h=this.x||0,m=this.y||0,t=this.textAlign||"left",n={left:0,center:.5,right:1}[t],x=this.styles;G(b,{marginLeft:d,marginTop:c});this.shadows&&g(this.shadows,function(a){G(a,{marginLeft:d+1,marginTop:c+1})});this.inverted&&g(b.childNodes,function(d){a.invertChild(d,b)});if("SPAN"===b.tagName){var l=this.rotation,v=e(this.textWidth),q=x&&x.whiteSpace,A=[l,t,b.innerHTML,this.textWidth,this.textAlign].join();A!==this.cTT&&(x=a.fontMetrics(b.style.fontSize).b,p(l)&&this.setSpanRotation(l,n,x),G(b,{width:"",whiteSpace:q||"nowrap"}),b.offsetWidth>v&&/[ \-]/.test(b.textContent||b.innerText)&&G(b,{width:v+"px",display:"block",whiteSpace:q||"normal"}),this.getSpanCorrection(b.offsetWidth,x,n,l,t));G(b,{left:h+(this.xCorr||0)+"px",top:m+(this.yCorr||0)+"px"});w&&(x=b.offsetHeight);this.cTT=A}}else{this.alignOnAdd=!0}},setSpanRotation:function(a,b,d){var c={},f=this.renderer.getTransformKey();c[f]=c.transform="rotate("+a+"deg)";c[f+(r?"Origin":"-origin")]=c.transformOrigin=100*b+"% "+d+"px";G(this.element,c)},getSpanCorrection:function(a,b,d){this.xCorr=-a*d;this.yCorr=-b}});l(h.prototype,{getTransformKey:function(){return n&&!/Edge/.test(m.navigator.userAgent)?"-ms-transform":w?"-webkit-transform":r?"MozTransform":m.opera?"-o-transform":""},html:function(a,b,d){var f=this.createElement("span"),e=f.element,h=f.renderer,m=h.isSVG,w=function(a,b){g(["opacity","visibility"],function(d){c(a,d+"Setter",function(a,d,f,c){a.call(this,d,f,c);b[f]=d})})};f.textSetter=function(a){a!==e.innerHTML&&delete this.bBox;this.textStr=a;e.innerHTML=v(a,"");f.htmlUpdateTransform()};m&&w(f,f.element.style);f.xSetter=f.ySetter=f.alignSetter=f.rotationSetter=function(a,b){"align"===b&&(b="textAlign");f[b]=a;f.htmlUpdateTransform()};f.attr({text:a,x:Math.round(b),y:Math.round(d)}).css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize,position:"absolute"});e.style.whiteSpace="nowrap";f.css=f.htmlCss;m&&(f.add=function(a){var b,d=h.box.parentNode,c=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;){c.push(a),a=a.parentGroup}g(c.reverse(),function(a){function e(k,b){a[b]=k;n?q[h.getTransformKey()]="translate("+(a.x||a.translateX)+"px,"+(a.y||a.translateY)+"px)":"translateX"===b?q.left=k+"px":q.top=k+"px";a.doTransform=!0}var q,k=D(a.element,"class");k&&(k={className:k});b=a.div=a.div||B("div",k,{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px",display:a.display,opacity:a.opacity,pointerEvents:a.styles&&a.styles.pointerEvents},b||d);q=b.style;l(a,{classSetter:function(a){this.element.setAttribute("class",a);b.className=a},on:function(){c[0].div&&f.on.apply({element:c[0].div},arguments);return a},translateXSetter:e,translateYSetter:e});w(a,q)})}}else{b=d}b.appendChild(e);f.added=!0;f.alignOnAdd&&f.htmlUpdateTransform();return f});return f}})})(N);(function(a){function D(){var n=a.defaultOptions.global,l=r.moment;if(n.timezone){if(l){return function(a){return-l.tz(a,n.timezone).utcOffset()}}a.error(25)}return n.useUTC&&n.getTimezoneOffset}function B(){var n=a.defaultOptions.global,g,v=n.useUTC,e=v?"getUTC":"get",h=v?"setUTC":"set",m="Minutes Hours Day Date Month FullYear".split(" "),c=m.concat(["Milliseconds","Seconds"]);a.Date=g=n.Date||r.Date;g.hcTimezoneOffset=v&&n.timezoneOffset;g.hcGetTimezoneOffset=D();g.hcMakeTime=function(a,b,d,c,e,h){var f;v?(f=g.UTC.apply(0,arguments),f+=p(f)):f=new g(a,b,l(d,1),l(c,0),l(e,0),l(h,0)).getTime();return f};for(n=0;n<m.length;n++){g["hcGet"+m[n]]=e+m[n]}for(n=0;n<c.length;n++){g["hcSet"+c[n]]=h+c[n]}}var G=a.color,p=a.getTZOffset,g=a.merge,l=a.pick,r=a.win;a.defaultOptions={colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" "),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),decimalPoint:".",numericSymbols:"kMGTPE".split(""),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0},chart:{borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{text:"",align:"center",widthAdjust:-44},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:a.svg,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",padding:8,snap:a.isTouchDevice?25:10,backgroundColor:G("#f7f7f7").setOpacity(.85).get(),borderWidth:1,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}};a.setOptions=function(n){a.defaultOptions=g(!0,a.defaultOptions,n);B();return a.defaultOptions};a.getOptions=function(){return a.defaultOptions};a.defaultPlotOptions=a.defaultOptions.plotOptions;B()})(N);(function(a){var D=a.correctFloat,B=a.defined,G=a.destroyObjectProperties,p=a.isNumber,g=a.merge,l=a.pick,r=a.deg2rad;a.Tick=function(a,g,l,e){this.axis=a;this.pos=g;this.type=l||"";this.isNewLabel=this.isNew=!0;l||e||this.addLabel()};a.Tick.prototype={addLabel:function(){var a=this.axis,w=a.options,v=a.chart,e=a.categories,h=a.names,m=this.pos,c=w.labels,f=a.tickPositions,b=m===f[0],d=m===f[f.length-1],h=e?l(e[m],h[m],m):m,e=this.label,f=f.info,y;a.isDatetimeAxis&&f&&(y=w.dateTimeLabelFormats[f.higherRanks[m]||f.unitName]);this.isFirst=b;this.isLast=d;w=a.labelFormatter.call({axis:a,chart:v,isFirst:b,isLast:d,dateTimeLabelFormat:y,value:a.isLog?D(a.lin2log(h)):h,pos:m});B(e)?e&&e.attr({text:w}):(this.labelLength=(this.label=e=B(w)&&c.enabled?v.renderer.text(w,0,0,c.useHTML).css(g(c.style)).add(a.labelGroup):null)&&e.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(a){var g=this.axis,n=a.x,e=g.chart.chartWidth,h=g.chart.spacing,m=l(g.labelLeft,Math.min(g.pos,h[3])),h=l(g.labelRight,Math.max(g.pos+g.len,e-h[1])),c=this.label,f=this.rotation,b={left:0,center:.5,right:1}[g.labelAlign],d=c.getBBox().width,y=g.getSlotWidth(),H=y,J=1,t,p={};if(f){0>f&&n-b*d<m?t=Math.round(n/Math.cos(f*r)-m):0<f&&n+b*d>h&&(t=Math.round((e-n)/Math.cos(f*r)))}else if(e=n+(1-b)*d,n-b*d<m?H=a.x+H*(1-b)-m:e>h&&(H=h-a.x+H*b,J=-1),H=Math.min(y,H),H<y&&"center"===g.labelAlign&&(a.x+=J*(y-H-b*(y-Math.min(d,H)))),d>H||g.autoRotation&&(c.styles||{}).width){t=H}t&&(p.width=t,(g.options.labels.style||{}).textOverflow||(p.textOverflow="ellipsis"),c.css(p))},getPosition:function(a,g,l,e){var h=this.axis,m=h.chart,c=e&&m.oldChartHeight||m.chartHeight;return{x:a?h.translate(g+l,null,null,e)+h.transB:h.left+h.offset+(h.opposite?(e&&m.oldChartWidth||m.chartWidth)-h.right-h.left:0),y:a?c-h.bottom+h.offset-(h.opposite?h.height:0):c-h.translate(g+l,null,null,e)-h.transB}},getLabelPosition:function(a,g,l,e,h,m,c,f){var b=this.axis,d=b.transA,y=b.reversed,n=b.staggerLines,v=b.tickRotCorr||{x:0,y:0},t=h.y;B(t)||(t=0===b.side?l.rotation?-8:-l.getBBox().height:2===b.side?v.y+8:Math.cos(l.rotation*r)*(v.y-l.getBBox(!1,0).height/2));a=a+h.x+v.x-(m&&e?m*d*(y?-1:1):0);g=g+t-(m&&!e?m*d*(y?1:-1):0);n&&(l=c/(f||1)%n,b.opposite&&(l=n-l-1),g+=b.labelOffset/n*l);return{x:a,y:Math.round(g)}},getMarkPath:function(a,g,l,e,h,m){return m.crispLine(["M",a,g,"L",a+(h?0:-l),g+(h?l:0)],e)},renderGridLine:function(a,g,l){var e=this.axis,h=e.options,m=this.gridLine,c={},f=this.pos,b=this.type,d=e.tickmarkOffset,y=e.chart.renderer,n=b?b+"Grid":"grid",v=h[n+"LineWidth"],t=h[n+"LineColor"],h=h[n+"LineDashStyle"];m||(c.stroke=t,c["stroke-width"]=v,h&&(c.dashstyle=h),b||(c.zIndex=1),a&&(c.opacity=0),this.gridLine=m=y.path().attr(c).addClass("highcharts-"+(b?b+"-":"")+"grid-line").add(e.gridGroup));if(!a&&m&&(a=e.getPlotLinePath(f+d,m.strokeWidth()*l,a,!0))){m[this.isNew?"attr":"animate"]({d:a,opacity:g})}},renderMark:function(a,g,v){var e=this.axis,h=e.options,m=e.chart.renderer,c=this.type,f=c?c+"Tick":"tick",b=e.tickSize(f),d=this.mark,y=!d,n=a.x;a=a.y;var r=l(h[f+"Width"],!c&&e.isXAxis?1:0),h=h[f+"Color"];b&&(e.opposite&&(b[0]=-b[0]),y&&(this.mark=d=m.path().addClass("highcharts-"+(c?c+"-":"")+"tick").add(e.axisGroup),d.attr({stroke:h,"stroke-width":r})),d[y?"attr":"animate"]({d:this.getMarkPath(n,a,b[0],d.strokeWidth()*v,e.horiz,m),opacity:g}))},renderLabel:function(a,g,v,e){var h=this.axis,m=h.horiz,c=h.options,f=this.label,b=c.labels,d=b.step,y=h.tickmarkOffset,H=!0,n=a.x;a=a.y;f&&p(n)&&(f.xy=a=this.getLabelPosition(n,a,f,m,b,y,e,d),this.isFirst&&!this.isLast&&!l(c.showFirstLabel,1)||this.isLast&&!this.isFirst&&!l(c.showLastLabel,1)?H=!1:!m||h.isRadial||b.step||b.rotation||g||0===v||this.handleOverflow(a),d&&e%d&&(H=!1),H&&p(a.y)?(a.opacity=v,f[this.isNewLabel?"attr":"animate"](a),this.isNewLabel=!1):(f.attr("y",-9999),this.isNewLabel=!0))},render:function(a,g,v){var e=this.axis,h=e.horiz,m=this.getPosition(h,this.pos,e.tickmarkOffset,g),c=m.x,f=m.y,e=h&&c===e.pos+e.len||!h&&f===e.pos?-1:1;v=l(v,1);this.isActive=!0;this.renderGridLine(g,v,e);this.renderMark(m,v,e);this.renderLabel(m,g,v,a);this.isNew=!1},destroy:function(){G(this,this.axis)}}})(N);var V=function(a){var D=a.addEvent,B=a.animObject,G=a.arrayMax,p=a.arrayMin,g=a.color,l=a.correctFloat,r=a.defaultOptions,n=a.defined,w=a.deg2rad,v=a.destroyObjectProperties,e=a.each,h=a.extend,m=a.fireEvent,c=a.format,f=a.getMagnitude,b=a.grep,d=a.inArray,y=a.isArray,H=a.isNumber,J=a.isString,t=a.merge,K=a.normalizeTickInterval,x=a.objectEach,C=a.pick,L=a.removeEvent,q=a.splat,A=a.syncTimeout,E=a.Tick,F=function(){this.init.apply(this,arguments)};a.extend(F.prototype,{defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,labels:{enabled:!0,style:{color:"#666666",cursor:"default",fontSize:"11px"},x:0},maxPadding:.01,minorTickLength:2,minorTickPosition:"outside",minPadding:.01,startOfWeek:1,startOnTick:!1,tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#666666"}},type:"linear",minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",tickColor:"#ccd6eb"},defaultYAxisOptions:{endOnTick:!0,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},maxPadding:.05,minPadding:.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{allowOverlap:!1,enabled:!1,formatter:function(){return a.numberFormat(this.total,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"#000000",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,b){var k=b.isX,u=this;u.chart=a;u.horiz=a.inverted&&!u.isZAxis?!k:k;u.isXAxis=k;u.coll=u.coll||(k?"xAxis":"yAxis");u.opposite=b.opposite;u.side=b.side||(u.horiz?u.opposite?0:2:u.opposite?1:3);u.setOptions(b);var f=this.options,c=f.type;u.labelFormatter=f.labels.formatter||u.defaultLabelFormatter;u.userOptions=b;u.minPixelPadding=0;u.reversed=f.reversed;u.visible=!1!==f.visible;u.zoomEnabled=!1!==f.zoomEnabled;u.hasNames="category"===c||!0===f.categories;u.categories=f.categories||u.hasNames;u.names=u.names||[];u.plotLinesAndBandsGroups={};u.isLog="logarithmic"===c;u.isDatetimeAxis="datetime"===c;u.positiveValuesOnly=u.isLog&&!u.allowNegativeLog;u.isLinked=n(f.linkedTo);u.ticks={};u.labelEdge=[];u.minorTicks={};u.plotLinesAndBands=[];u.alternateBands={};u.len=0;u.minRange=u.userMinRange=f.minRange||f.maxZoom;u.range=f.range;u.offset=f.offset||0;u.stacks={};u.oldStacks={};u.stacksTouched=0;u.max=null;u.min=null;u.crosshair=C(f.crosshair,q(a.options.tooltip.crosshairs)[k?0:1],!1);b=u.options.events;-1===d(u,a.axes)&&(k?a.axes.splice(a.xAxis.length,0,u):a.axes.push(u),a[u.coll].push(u));u.series=u.series||[];a.inverted&&!u.isZAxis&&k&&void 0===u.reversed&&(u.reversed=!0);x(b,function(a,k){D(u,k,a)});u.lin2log=f.linearToLogConverter||u.lin2log;u.isLog&&(u.val2lin=u.log2lin,u.lin2val=u.lin2log)},setOptions:function(a){this.options=t(this.defaultOptions,"yAxis"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],t(r[this.coll],a))},defaultLabelFormatter:function(){var k=this.axis,b=this.value,d=k.categories,f=this.dateTimeLabelFormat,e=r.lang,q=e.numericSymbols,e=e.numericSymbolMagnitude||1e3,h=q&&q.length,m,y=k.options.labels.format,k=k.isLog?Math.abs(b):k.tickInterval;if(y){m=c(y,this)}else if(d){m=b}else if(f){m=a.dateFormat(f,b)}else if(h&&1e3<=k){for(;h--&&void 0===m;){d=Math.pow(e,h+1),k>=d&&0===10*b%d&&null!==q[h]&&0!==b&&(m=a.numberFormat(b/d,-1)+q[h])}}void 0===m&&(m=1e4<=Math.abs(b)?a.numberFormat(b,-1):a.numberFormat(b,-1,void 0,""));return m},getSeriesExtremes:function(){var a=this,u=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.threshold=null;a.softThreshold=!a.isXAxis;a.buildStacks&&a.buildStacks();e(a.series,function(k){if(k.visible||!u.options.chart.ignoreHiddenSeries){var d=k.options,f=d.threshold,c;a.hasVisibleSeries=!0;a.positiveValuesOnly&&0>=f&&(f=null);if(a.isXAxis){d=k.xData,d.length&&(k=p(d),c=G(d),H(k)||k instanceof Date||(d=b(d,H),k=p(d)),a.dataMin=Math.min(C(a.dataMin,d[0],k),k),a.dataMax=Math.max(C(a.dataMax,d[0],c),c))}else if(k.getExtremes(),c=k.dataMax,k=k.dataMin,n(k)&&n(c)&&(a.dataMin=Math.min(C(a.dataMin,k),k),a.dataMax=Math.max(C(a.dataMax,c),c)),n(f)&&(a.threshold=f),!d.softThreshold||a.positiveValuesOnly){a.softThreshold=!1}}})},translate:function(a,b,d,f,c,e){var k=this.linkedParent||this,u=1,q=0,h=f?k.oldTransA:k.transA;f=f?k.oldMin:k.min;var m=k.minPixelPadding;c=(k.isOrdinal||k.isBroken||k.isLog&&c)&&k.lin2val;h||(h=k.transA);d&&(u*=-1,q=k.len);k.reversed&&(u*=-1,q-=u*(k.sector||k.len));b?(a=(a*u+q-m)/h+f,c&&(a=k.lin2val(a))):(c&&(a=k.val2lin(a)),a=H(f)?u*(a-f)*h+q+u*m+(H(e)?h*e:0):void 0);return a},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,d,f,c){var k=this.chart,u=this.left,q=this.top,e,h,m=d&&k.oldChartHeight||k.chartHeight,y=d&&k.oldChartWidth||k.chartWidth,A;e=this.transB;var t=function(a,k,b){if(a<k||a>b){f?a=Math.min(Math.max(k,a),b):A=!0}return a};c=C(c,this.translate(a,null,null,d));a=d=Math.round(c+e);e=h=Math.round(m-c-e);H(c)?this.horiz?(e=q,h=m-this.bottom,a=d=t(a,u,u+this.width)):(a=u,d=y-this.right,e=h=t(e,q,q+this.height)):(A=!0,f=!1);return A&&!f?null:k.renderer.crispLine(["M",a,e,"L",d,h],b||1)},getLinearTickPositions:function(a,b,d){var k,u=l(Math.floor(b/a)*a);d=l(Math.ceil(d/a)*a);var f=[],c;l(u+a)===u&&(c=20);if(this.single){return[b]}for(b=u;b<=d;){f.push(b);b=l(b+a,c);if(b===k){break}k=b}return f},getMinorTickInterval:function(){var a=this.options;return!0===a.minorTicks?C(a.minorTickInterval,"auto"):!1===a.minorTicks?null:a.minorTickInterval},getMinorTickPositions:function(){var a=this,b=a.options,d=a.tickPositions,f=a.minorTickInterval,c=[],q=a.pointRangePadding||0,h=a.min-q,q=a.max+q,m=q-h;if(m&&m/f<a.len/3){if(a.isLog){e(this.paddedTicks,function(k,b,u){b&&c.push.apply(c,a.getLogTickPositions(f,u[b-1],u[b],!0))})}else if(a.isDatetimeAxis&&"auto"===this.getMinorTickInterval()){c=c.concat(a.getTimeTicks(a.normalizeTimeTickInterval(f),h,q,b.startOfWeek))}else{for(b=h+(d[0]-h)%f;b<=q&&b!==c[0];b+=f){c.push(b)}}}0!==c.length&&a.trimTicks(c);return c},adjustForMinRange:function(){var a=this.options,b=this.min,d=this.max,f,c,q,h,m,y,A,t;this.isXAxis&&void 0===this.minRange&&!this.isLog&&(n(a.min)||n(a.max)?this.minRange=null:(e(this.series,function(a){y=a.xData;for(h=A=a.xIncrement?1:y.length-1;0<h;h--){if(m=y[h]-y[h-1],void 0===q||m<q){q=m}}}),this.minRange=Math.min(5*q,this.dataMax-this.dataMin)));d-b<this.minRange&&(c=this.dataMax-this.dataMin>=this.minRange,t=this.minRange,f=(t-d+b)/2,f=[b-f,C(a.min,b-f)],c&&(f[2]=this.isLog?this.log2lin(this.dataMin):this.dataMin),b=G(f),d=[b+t,C(a.max,b+t)],c&&(d[2]=this.isLog?this.log2lin(this.dataMax):this.dataMax),d=p(d),d-b<t&&(f[0]=d-t,f[1]=C(a.min,d-t),b=G(f)));this.min=b;this.max=d},getClosest:function(){var a;this.categories?a=1:e(this.series,function(k){var b=k.closestPointRange,u=k.visible||!k.chart.options.chart.ignoreHiddenSeries;!k.noSharedTooltip&&n(b)&&u&&(a=n(a)?Math.min(a,b):b)});return a},nameToX:function(a){var k=y(this.categories),b=k?this.categories:this.names,f=a.options.x,c;a.series.requireSorting=!1;n(f)||(f=!1===this.options.uniqueNames?a.series.autoIncrement():d(a.name,b));-1===f?k||(c=b.length):c=f;void 0!==c&&(this.names[c]=a.name);return c},updateNames:function(){var a=this;0<this.names.length&&(this.names.length=0,this.minRange=this.userMinRange,e(this.series||[],function(k){k.xIncrement=null;if(!k.points||k.isDirtyData){k.processData(),k.generatePoints()}e(k.points,function(b,u){var d;b.options&&(d=a.nameToX(b),void 0!==d&&d!==b.x&&(b.x=d,k.xData[u]=d))})}))},setAxisTranslation:function(a){var k=this,b=k.max-k.min,d=k.axisPointRange||0,f,c=0,q=0,h=k.linkedParent,m=!!k.categories,y=k.transA,A=k.isXAxis;if(A||m||d){f=k.getClosest(),h?(c=h.minPointOffset,q=h.pointRangePadding):e(k.series,function(a){var b=m?1:A?C(a.options.pointRange,f,0):k.axisPointRange||0;a=a.options.pointPlacement;d=Math.max(d,b);k.single||(c=Math.max(c,J(a)?0:b/2),q=Math.max(q,"on"===a?0:b))}),h=k.ordinalSlope&&f?k.ordinalSlope/f:1,k.minPointOffset=c*=h,k.pointRangePadding=q*=h,k.pointRange=Math.min(d,b),A&&(k.closestPointRange=f)}a&&(k.oldTransA=y);k.translationSlope=k.transA=y=k.options.staticScale||k.len/(b+q||1);k.transB=k.horiz?k.left:k.bottom;k.minPixelPadding=y*c},minFromRange:function(){return this.max-this.range},setTickInterval:function(k){var b=this,d=b.chart,c=b.options,q=b.isLog,h=b.log2lin,y=b.isDatetimeAxis,A=b.isXAxis,t=b.isLinked,x=c.maxPadding,g=c.minPadding,E=c.tickInterval,v=c.tickPixelInterval,F=b.categories,r=b.threshold,J=b.softThreshold,p,w,L,B;y||F||t||this.getTickAmount();L=C(b.userMin,c.min);B=C(b.userMax,c.max);t?(b.linkedParent=d[b.coll][c.linkedTo],d=b.linkedParent.getExtremes(),b.min=C(d.min,d.dataMin),b.max=C(d.max,d.dataMax),c.type!==b.linkedParent.options.type&&a.error(11,1)):(!J&&n(r)&&(b.dataMin>=r?(p=r,g=0):b.dataMax<=r&&(w=r,x=0)),b.min=C(L,p,b.dataMin),b.max=C(B,w,b.dataMax));q&&(b.positiveValuesOnly&&!k&&0>=Math.min(b.min,C(b.dataMin,b.min))&&a.error(10,1),b.min=l(h(b.min),15),b.max=l(h(b.max),15));b.range&&n(b.max)&&(b.userMin=b.min=L=Math.max(b.dataMin,b.minFromRange()),b.userMax=B=b.max,b.range=null);m(b,"foundExtremes");b.beforePadding&&b.beforePadding();b.adjustForMinRange();!(F||b.axisPointRange||b.usePercentage||t)&&n(b.min)&&n(b.max)&&(h=b.max-b.min)&&(!n(L)&&g&&(b.min-=h*g),!n(B)&&x&&(b.max+=h*x));H(c.softMin)&&(b.min=Math.min(b.min,c.softMin));H(c.softMax)&&(b.max=Math.max(b.max,c.softMax));H(c.floor)&&(b.min=Math.max(b.min,c.floor));H(c.ceiling)&&(b.max=Math.min(b.max,c.ceiling));J&&n(b.dataMin)&&(r=r||0,!n(L)&&b.min<r&&b.dataMin>=r?b.min=r:!n(B)&&b.max>r&&b.dataMax<=r&&(b.max=r));b.tickInterval=b.min===b.max||void 0===b.min||void 0===b.max?1:t&&!E&&v===b.linkedParent.options.tickPixelInterval?E=b.linkedParent.tickInterval:C(E,this.tickAmount?(b.max-b.min)/Math.max(this.tickAmount-1,1):void 0,F?1:(b.max-b.min)*v/Math.max(b.len,v));A&&!k&&e(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();b.postProcessTickInterval&&(b.tickInterval=b.postProcessTickInterval(b.tickInterval));b.pointRange&&!E&&(b.tickInterval=Math.max(b.pointRange,b.tickInterval));k=C(c.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);!E&&b.tickInterval<k&&(b.tickInterval=k);y||q||E||(b.tickInterval=K(b.tickInterval,null,f(b.tickInterval),C(c.allowDecimals,!(.5<b.tickInterval&&5>b.tickInterval&&1e3<b.max&&9999>b.max)),!!this.tickAmount));this.tickAmount||(b.tickInterval=b.unsquish());this.setTickPositions()},setTickPositions:function(){var a=this.options,b,d=a.tickPositions;b=this.getMinorTickInterval();var c=a.tickPositioner,f=a.startOnTick,q=a.endOnTick;this.tickmarkOffset=this.categories&&"between"===a.tickmarkPlacement&&1===this.tickInterval?.5:0;this.minorTickInterval="auto"===b&&this.tickInterval?this.tickInterval/5:b;this.single=this.min===this.max&&n(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==a.allowDecimals);this.tickPositions=b=d&&d.slice();!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()],b[0]===b[1]&&(b.length=1)),this.tickPositions=b,c&&(c=c.apply(this,[this.min,this.max])))&&(this.tickPositions=b=c);this.paddedTicks=b.slice(0);this.trimTicks(b,f,q);this.isLinked||(this.single&&2>b.length&&(this.min-=.5,this.max+=.5),d||c||this.adjustTickAmount())},trimTicks:function(a,b,d){var k=a[0],c=a[a.length-1],f=this.minPointOffset||0;if(!this.isLinked){if(b&&-Infinity!==k){this.min=k}else{for(;this.min-f>a[0];){a.shift()}}if(d){this.max=c}else{for(;this.max+f<a[a.length-1];){a.pop()}}0===a.length&&n(k)&&a.push((c+k)/2)}},alignToOthers:function(){var a={},b,d=this.options;!1===this.chart.options.chart.alignTicks||!1===d.alignTicks||this.isLog||e(this.chart[this.coll],function(k){var d=k.options,d=[k.horiz?d.left:d.top,d.width,d.height,d.pane].join();k.series.length&&(a[d]?b=!0:a[d]=1)});return b},getTickAmount:function(){var a=this.options,b=a.tickAmount,d=a.tickPixelInterval;!n(a.tickInterval)&&this.len<d&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(b=2);!b&&this.alignToOthers()&&(b=Math.ceil(this.len/d)+1);4>b&&(this.finalTickAmt=b,b=5);this.tickAmount=b},adjustTickAmount:function(){var a=this.tickInterval,b=this.tickPositions,d=this.tickAmount,c=this.finalTickAmt,f=b&&b.length;if(f<d){for(;b.length<d;){b.push(l(b[b.length-1]+a))}this.transA*=(f-1)/(d-1);this.max=b[b.length-1]}else{f>d&&(this.tickInterval*=2,this.setTickPositions())}if(n(c)){for(a=d=b.length;a--;){(3===c&&1===a%2||2>=c&&0<a&&a<d-1)&&b.splice(a,1)}this.finalTickAmt=void 0}},setScale:function(){var a,b;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;e(this.series,function(b){if(b.isDirtyData||b.isDirty||b.xAxis.isDirty){a=!0}});b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()?(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=b||this.min!==this.oldMin||this.max!==this.oldMax)):this.cleanStacks&&this.cleanStacks()},setExtremes:function(a,b,d,c,f){var k=this,q=k.chart;d=C(d,!0);e(k.series,function(a){delete a.kdTree});f=h(f,{min:a,max:b});m(k,"setExtremes",f,function(){k.userMin=a;k.userMax=b;k.eventArgs=f;d&&q.redraw(c)})},zoom:function(a,b){var k=this.dataMin,d=this.dataMax,c=this.options,f=Math.min(k,C(c.min,k)),c=Math.max(d,C(c.max,d));if(a!==this.min||b!==this.max){this.allowZoomOutside||(n(k)&&(a<f&&(a=f),a>c&&(a=c)),n(d)&&(b<f&&(b=f),b>c&&(b=c))),this.displayBtn=void 0!==a||void 0!==b,this.setExtremes(a,b,!1,void 0,{trigger:"zoom"})}return!0},setAxisSize:function(){var b=this.chart,d=this.options,c=d.offsets||[0,0,0,0],f=this.horiz,q=this.width=Math.round(a.relativeLength(C(d.width,b.plotWidth-c[3]+c[1]),b.plotWidth)),e=this.height=Math.round(a.relativeLength(C(d.height,b.plotHeight-c[0]+c[2]),b.plotHeight)),h=this.top=Math.round(a.relativeLength(C(d.top,b.plotTop+c[0]),b.plotHeight,b.plotTop)),d=this.left=Math.round(a.relativeLength(C(d.left,b.plotLeft+c[3]),b.plotWidth,b.plotLeft));this.bottom=b.chartHeight-e-h;this.right=b.chartWidth-q-d;this.len=Math.max(f?q:e,0);this.pos=f?d:h},getExtremes:function(){var a=this.isLog,b=this.lin2log;return{min:a?l(b(this.min)):this.min,max:a?l(b(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,k=this.lin2log,d=b?k(this.min):this.min,b=b?k(this.max):this.max;null===a?a=d:d>a?a=d:b<a&&(a=b);return this.translate(a,0,1,0,1)},autoLabelAlign:function(a){a=(C(a,0)-90*this.side+720)%360;return 15<a&&165>a?"right":195<a&&345>a?"left":"center"},tickSize:function(a){var b=this.options,k=b[a+"Length"],d=C(b[a+"Width"],"tick"===a&&this.isXAxis?1:0);if(d&&k){return"inside"===b[a+"Position"]&&(k=-k),[k,d]}},labelMetrics:function(){var a=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style&&this.options.labels.style.fontSize,this.ticks[a]&&this.ticks[a].label)},unsquish:function(){var a=this.options.labels,b=this.horiz,d=this.tickInterval,c=d,f=this.len/(((this.categories?1:0)+this.max-this.min)/d),q,h=a.rotation,m=this.labelMetrics(),y,A=Number.MAX_VALUE,t,x=function(a){a/=f||1;a=1<a?Math.ceil(a):1;return a*d};b?(t=!a.staggerLines&&!a.step&&(n(h)?[h]:f<C(a.autoRotationLimit,80)&&a.autoRotation))&&e(t,function(a){var b;if(a===h||a&&-90<=a&&90>=a){y=x(Math.abs(m.h/Math.sin(w*a))),b=y+Math.abs(a/360),b<A&&(A=b,q=a,c=y)}}):a.step||(c=x(m.h));this.autoRotation=t;this.labelRotation=C(q,h);return c},getSlotWidth:function(){var a=this.chart,b=this.horiz,d=this.options.labels,c=Math.max(this.tickPositions.length-(this.categories?0:1),1),f=a.margin[3];return b&&2>(d.step||0)&&!d.rotation&&(this.staggerLines||1)*this.len/c||!b&&(d.style&&parseInt(d.style.width,10)||f&&f-a.spacing[3]||.33*a.chartWidth)},renderUnsquish:function(){var a=this.chart,b=a.renderer,d=this.tickPositions,c=this.ticks,f=this.options.labels,q=this.horiz,h=this.getSlotWidth(),m=Math.max(1,Math.round(h-2*(f.padding||5))),y={},A=this.labelMetrics(),x=f.style&&f.style.textOverflow,g,E=0,l,n;J(f.rotation)||(y.rotation=f.rotation||0);e(d,function(a){(a=c[a])&&a.labelLength>E&&(E=a.labelLength)});this.maxLabelLength=E;if(this.autoRotation){E>m&&E>A.h?y.rotation=this.labelRotation:this.labelRotation=0}else if(h&&(g={width:m+"px"},!x)){for(g.textOverflow="clip",l=d.length;!q&&l--;){if(n=d[l],m=c[n].label){m.styles&&"ellipsis"===m.styles.textOverflow?m.css({textOverflow:"clip"}):c[n].labelLength>h&&m.css({width:h+"px"}),m.getBBox().height>this.len/d.length-(A.h-A.f)&&(m.specCss={textOverflow:"ellipsis"})}}}y.rotation&&(g={width:(E>.5*a.chartHeight?.33*a.chartHeight:a.chartHeight)+"px"},x||(g.textOverflow="ellipsis"));if(this.labelAlign=f.align||this.autoLabelAlign(this.labelRotation)){y.align=this.labelAlign}e(d,function(a){var b=(a=c[a])&&a.label;b&&(b.attr(y),g&&b.css(t(g,b.specCss)),delete b.specCss,a.rotation=y.rotation)});this.tickRotCorr=b.rotCorr(A.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.hasVisibleSeries||n(this.min)&&n(this.max)&&this.tickPositions&&0<this.tickPositions.length},addTitle:function(a){var b=this.chart.renderer,k=this.horiz,d=this.opposite,c=this.options.title,f;this.axisTitle||((f=c.textAlign)||(f=(k?{low:"left",middle:"center",high:"right"}:{low:d?"right":"left",middle:"center",high:d?"left":"right"})[c.align]),this.axisTitle=b.text(c.text,0,0,c.useHTML).attr({zIndex:7,rotation:c.rotation||0,align:f}).addClass("highcharts-axis-title").css(c.style).add(this.axisGroup),this.axisTitle.isNew=!0);c.style.width||this.isRadial||this.axisTitle.css({width:this.len});this.axisTitle[a?"show":"hide"](!0)},generateTick:function(a){var b=this.ticks;b[a]?b[a].addLabel():b[a]=new E(this,a)},getOffset:function(){var a=this,b=a.chart,d=b.renderer,c=a.options,f=a.tickPositions,q=a.ticks,h=a.horiz,m=a.side,y=b.inverted&&!a.isZAxis?[1,0,3,2][m]:m,A,t,g=0,E,l=0,H=c.title,v=c.labels,F=0,r=b.axisOffset,b=b.clipOffset,J=[-1,1,1,-1][m],p=c.className,w=a.axisParent,K=this.tickSize("tick");A=a.hasData();a.showAxis=t=A||C(c.showEmpty,!0);a.staggerLines=a.horiz&&v.staggerLines;a.axisGroup||(a.gridGroup=d.g("grid").attr({zIndex:c.gridZIndex||1}).addClass("highcharts-"+this.coll.toLowerCase()+"-grid "+(p||"")).add(w),a.axisGroup=d.g("axis").attr({zIndex:c.zIndex||2}).addClass("highcharts-"+this.coll.toLowerCase()+" "+(p||"")).add(w),a.labelGroup=d.g("axis-labels").attr({zIndex:v.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels "+(p||"")).add(w));A||a.isLinked?(e(f,function(b,k){a.generateTick(b,k)}),a.renderUnsquish(),!1===v.reserveSpace||0!==m&&2!==m&&{1:"left",3:"right"}[m]!==a.labelAlign&&"center"!==a.labelAlign||e(f,function(a){F=Math.max(q[a].getLabelSize(),F)}),a.staggerLines&&(F*=a.staggerLines,a.labelOffset=F*(a.opposite?-1:1))):x(q,function(a,b){a.destroy();delete q[b]});H&&H.text&&!1!==H.enabled&&(a.addTitle(t),t&&!1!==H.reserveSpace&&(a.titleOffset=g=a.axisTitle.getBBox()[h?"height":"width"],E=H.offset,l=n(E)?0:C(H.margin,h?5:10)));a.renderLine();a.offset=J*C(c.offset,r[m]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};d=0===m?-a.labelMetrics().h:2===m?a.tickRotCorr.y:0;l=Math.abs(F)+l;F&&(l=l-d+J*(h?C(v.y,a.tickRotCorr.y+8*J):v.x));a.axisTitleMargin=C(E,l);r[m]=Math.max(r[m],a.axisTitleMargin+g+J*a.offset,l,A&&f.length&&K?K[0]+J*a.offset:0);c=c.offset?0:2*Math.floor(a.axisLine.strokeWidth()/2);b[y]=Math.max(b[y],c)},getLinePath:function(a){var b=this.chart,k=this.opposite,d=this.offset,c=this.horiz,f=this.left+(k?this.width:0)+d,d=b.chartHeight-this.bottom-(k?this.height:0)+d;k&&(a*=-1);return b.renderer.crispLine(["M",c?this.left:f,c?d:this.top,"L",c?b.chartWidth-this.right:f,c?d:b.chartHeight-this.bottom],a)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var a=this.horiz,b=this.left,d=this.top,c=this.len,f=this.options.title,q=a?b:d,e=this.opposite,h=this.offset,m=f.x||0,y=f.y||0,A=this.axisTitle,t=this.chart.renderer.fontMetrics(f.style&&f.style.fontSize,A),A=Math.max(A.getBBox(null,0).height-t.h-1,0),c={low:q+(a?0:c),middle:q+c/2,high:q+(a?c:0)}[f.align],b=(a?d+this.height:b)+(a?1:-1)*(e?-1:1)*this.axisTitleMargin+[-A,A,t.f,-A][this.side];return{x:a?c+m:b+(e?this.width:0)+h+m,y:a?b+y-(e?this.height:0)+h:c+y}},renderMinorTick:function(a){var b=this.chart.hasRendered&&H(this.oldMin),d=this.minorTicks;d[a]||(d[a]=new E(this,a,"minor"));b&&d[a].isNew&&d[a].render(null,!0);d[a].render(null,!1,1)},renderTick:function(a,b){var d=this.isLinked,k=this.ticks,c=this.chart.hasRendered&&H(this.oldMin);if(!d||a>=this.min&&a<=this.max){k[a]||(k[a]=new E(this,a)),c&&k[a].isNew&&k[a].render(b,!0,.1),k[a].render(b)}},render:function(){var b=this,d=b.chart,c=b.options,f=b.isLog,q=b.lin2log,h=b.isLinked,m=b.tickPositions,y=b.axisTitle,t=b.ticks,g=b.minorTicks,l=b.alternateBands,n=c.stackLabels,C=c.alternateGridColor,v=b.tickmarkOffset,F=b.axisLine,r=b.showAxis,J=B(d.renderer.globalAnimation),p,w;b.labelEdge.length=0;b.overlap=!1;e([t,g,l],function(a){x(a,function(a){a.isActive=!1})});if(b.hasData()||h){b.minorTickInterval&&!b.categories&&e(b.getMinorTickPositions(),function(a){b.renderMinorTick(a)}),m.length&&(e(m,function(a,d){b.renderTick(a,d)}),v&&(0===b.min||b.single)&&(t[-1]||(t[-1]=new E(b,-1,null,!0)),t[-1].render(-1))),C&&e(m,function(c,k){w=void 0!==m[k+1]?m[k+1]+v:b.max-v;0===k%2&&c<b.max&&w<=b.max+(d.polar?-v:v)&&(l[c]||(l[c]=new a.PlotLineOrBand(b)),p=c+v,l[c].options={from:f?q(p):p,to:f?q(w):w,color:C},l[c].render(),l[c].isActive=!0)}),b._addedPlotLB||(e((c.plotLines||[]).concat(c.plotBands||[]),function(a){b.addPlotBandOrLine(a)}),b._addedPlotLB=!0)}e([t,g,l],function(a){var b,c=[],k=J.duration;x(a,function(a,b){a.isActive||(a.render(b,!1,0),a.isActive=!1,c.push(b))});A(function(){for(b=c.length;b--;){a[c[b]]&&!a[c[b]].isActive&&(a[c[b]].destroy(),delete a[c[b]])}},a!==l&&d.hasRendered&&k?k:0)});F&&(F[F.isPlaced?"animate":"attr"]({d:this.getLinePath(F.strokeWidth())}),F.isPlaced=!0,F[r?"show":"hide"](!0));y&&r&&(c=b.getTitlePosition(),H(c.y)?(y[y.isNew?"attr":"animate"](c),y.isNew=!1):(y.attr("y",-9999),y.isNew=!0));n&&n.enabled&&b.renderStackTotals();b.isDirty=!1},redraw:function(){this.visible&&(this.render(),e(this.plotLinesAndBands,function(a){a.render()}));e(this.series,function(a){a.isDirty=!0})},keepProps:"extKey hcEvents names series userMax userMin".split(" "),destroy:function(a){var b=this,c=b.stacks,k=b.plotLinesAndBands,f;a||L(b);x(c,function(a,b){v(a);c[b]=null});e([b.ticks,b.minorTicks,b.alternateBands],function(a){v(a)});if(k){for(a=k.length;a--;){k[a].destroy()}}e("stackTotalGroup axisLine axisTitle axisGroup gridGroup labelGroup cross".split(" "),function(a){b[a]&&(b[a]=b[a].destroy())});for(f in b.plotLinesAndBandsGroups){b.plotLinesAndBandsGroups[f]=b.plotLinesAndBandsGroups[f].destroy()}x(b,function(a,c){-1===d(c,b.keepProps)&&delete b[c]})},drawCrosshair:function(a,b){var d,c=this.crosshair,k=C(c.snap,!0),f,q=this.cross;a||(a=this.cross&&this.cross.e);this.crosshair&&!1!==(n(b)||!k)?(k?n(b)&&(f=this.isXAxis?b.plotX:this.len-b.plotY):f=a&&(this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos),n(f)&&(d=this.getPlotLinePath(b&&(this.isXAxis?b.x:C(b.stackY,b.y)),null,null,null,f)||null),n(d)?(b=this.categories&&!this.isRadial,q||(this.cross=q=this.chart.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(b?"category ":"thin ")+c.className).attr({zIndex:C(c.zIndex,2)}).add(),q.attr({stroke:c.color||(b?g("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":C(c.width,1)}).css({"pointer-events":"none"}),c.dashStyle&&q.attr({dashstyle:c.dashStyle})),q.show().attr({d:d}),b&&!c.width&&q.attr({"stroke-width":this.transA}),this.cross.e=a):this.hideCrosshair()):this.hideCrosshair()},hideCrosshair:function(){this.cross&&this.cross.hide()}});return a.Axis=F}(N);(function(a){var D=a.Axis,B=a.Date,G=a.dateFormat,p=a.defaultOptions,g=a.defined,l=a.each,r=a.extend,n=a.getMagnitude,w=a.getTZOffset,v=a.normalizeTickInterval,e=a.pick,h=a.timeUnits;D.prototype.getTimeTicks=function(a,c,f,b){var d=[],m={},n=p.global.useUTC,v,t=new B(c-Math.max(w(c),w(f))),K=B.hcMakeTime,x=a.unitRange,C=a.count,L,q;if(g(c)){t[B.hcSetMilliseconds](x>=h.second?0:C*Math.floor(t.getMilliseconds()/C));if(x>=h.second){t[B.hcSetSeconds](x>=h.minute?0:C*Math.floor(t.getSeconds()/C))}if(x>=h.minute){t[B.hcSetMinutes](x>=h.hour?0:C*Math.floor(t[B.hcGetMinutes]()/C))}if(x>=h.hour){t[B.hcSetHours](x>=h.day?0:C*Math.floor(t[B.hcGetHours]()/C))}if(x>=h.day){t[B.hcSetDate](x>=h.month?1:C*Math.floor(t[B.hcGetDate]()/C))}x>=h.month&&(t[B.hcSetMonth](x>=h.year?0:C*Math.floor(t[B.hcGetMonth]()/C)),v=t[B.hcGetFullYear]());if(x>=h.year){t[B.hcSetFullYear](v-v%C)}if(x===h.week){t[B.hcSetDate](t[B.hcGetDate]()-t[B.hcGetDay]()+e(b,1))}v=t[B.hcGetFullYear]();b=t[B.hcGetMonth]();var A=t[B.hcGetDate](),E=t[B.hcGetHours]();if(B.hcTimezoneOffset||B.hcGetTimezoneOffset){q=(!n||!!B.hcGetTimezoneOffset)&&(f-c>4*h.month||w(c)!==w(f)),t=t.getTime(),L=w(t),t=new B(t+L)}n=t.getTime();for(c=1;n<f;){d.push(n),n=x===h.year?K(v+c*C,0):x===h.month?K(v,b+c*C):!q||x!==h.day&&x!==h.week?q&&x===h.hour?K(v,b,A,E+c*C,0,0,L)-L:n+x*C:K(v,b,A+c*C*(x===h.day?1:7)),c++}d.push(n);x<=h.hour&&1e4>d.length&&l(d,function(a){0===a%18e5&&"000000000"===G("%H%M%S%L",a)&&(m[a]="day")})}d.info=r(a,{higherRanks:m,totalRange:x*C});return d};D.prototype.normalizeTimeTickInterval=function(a,c){var f=c||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]];c=f[f.length-1];var b=h[c[0]],d=c[1],e;for(e=0;e<f.length&&!(c=f[e],b=h[c[0]],d=c[1],f[e+1]&&a<=(b*d[d.length-1]+h[f[e+1][0]])/2);e++){}b===h.year&&a<5*b&&(d=[1,2,5]);a=v(a/b,d,"year"===c[0]?Math.max(n(a/b),1):1);return{unitRange:b,count:a,unitName:c[0]}}})(N);(function(a){var D=a.Axis,B=a.getMagnitude,G=a.map,p=a.normalizeTickInterval,g=a.pick;D.prototype.getLogTickPositions=function(a,r,n,w){var l=this.options,e=this.len,h=this.lin2log,m=this.log2lin,c=[];w||(this._minorAutoInterval=null);if(.5<=a){a=Math.round(a),c=this.getLinearTickPositions(a,r,n)}else if(.08<=a){for(var e=Math.floor(r),f,b,d,y,H,l=.3<a?[1,2,4]:.15<a?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];e<n+1&&!H;e++){for(b=l.length,f=0;f<b&&!H;f++){d=m(h(e)*l[f]),d>r&&(!w||y<=n)&&void 0!==y&&c.push(y),y>n&&(H=!0),y=d}}}else{r=h(r),n=h(n),a=w?this.getMinorTickInterval():l.tickInterval,a=g("auto"===a?null:a,this._minorAutoInterval,l.tickPixelInterval/(w?5:1)*(n-r)/((w?e/this.tickPositions.length:e)||1)),a=p(a,null,B(a)),c=G(this.getLinearTickPositions(a,r,n),m),w||(this._minorAutoInterval=a/5)}w||(this.tickInterval=a);return c};D.prototype.log2lin=function(a){return Math.log(a)/Math.LN10};D.prototype.lin2log=function(a){return Math.pow(10,a)}})(N);(function(a,D){var B=a.arrayMax,G=a.arrayMin,p=a.defined,g=a.destroyObjectProperties,l=a.each,r=a.erase,n=a.merge,w=a.pick;a.PlotLineOrBand=function(a,e){this.axis=a;e&&(this.options=e,this.id=e.id)};a.PlotLineOrBand.prototype={render:function(){var g=this,e=g.axis,h=e.horiz,m=g.options,c=m.label,f=g.label,b=m.to,d=m.from,y=m.value,l=p(d)&&p(b),r=p(y),t=g.svgElem,K=!t,x=[],C=m.color,L=w(m.zIndex,0),q=m.events,x={class:"highcharts-plot-"+(l?"band ":"line ")+(m.className||"")},A={},E=e.chart.renderer,F=l?"bands":"lines",k=e.log2lin;e.isLog&&(d=k(d),b=k(b),y=k(y));r?(x={stroke:C,"stroke-width":m.width},m.dashStyle&&(x.dashstyle=m.dashStyle)):l&&(C&&(x.fill=C),m.borderWidth&&(x.stroke=m.borderColor,x["stroke-width"]=m.borderWidth));A.zIndex=L;F+="-"+L;(C=e.plotLinesAndBandsGroups[F])||(e.plotLinesAndBandsGroups[F]=C=E.g("plot-"+F).attr(A).add());K&&(g.svgElem=t=E.path().attr(x).add(C));if(r){x=e.getPlotLinePath(y,t.strokeWidth())}else if(l){x=e.getPlotBandPath(d,b,m)}else{return}K&&x&&x.length?(t.attr({d:x}),q&&a.objectEach(q,function(a,b){t.on(b,function(a){q[b].apply(g,[a])})})):t&&(x?(t.show(),t.animate({d:x})):(t.hide(),f&&(g.label=f=f.destroy())));c&&p(c.text)&&x&&x.length&&0<e.width&&0<e.height&&!x.flat?(c=n({align:h&&l&&"center",x:h?!l&&4:10,verticalAlign:!h&&l&&"middle",y:h?l?16:10:l?6:-4,rotation:h&&!l&&90},c),this.renderLabel(c,x,l,L)):f&&f.hide();return g},renderLabel:function(a,e,h,m){var c=this.label,f=this.axis.chart.renderer;c||(c={align:a.textAlign||a.align,rotation:a.rotation,class:"highcharts-plot-"+(h?"band":"line")+"-label "+(a.className||"")},c.zIndex=m,this.label=c=f.text(a.text,0,0,a.useHTML).attr(c).add(),c.css(a.style));m=e.xBounds||[e[1],e[4],h?e[6]:e[1]];e=e.yBounds||[e[2],e[5],h?e[7]:e[2]];h=G(m);f=G(e);c.align(a,!1,{x:h,y:f,width:B(m)-h,height:B(e)-f});c.show()},destroy:function(){r(this.axis.plotLinesAndBands,this);delete this.axis;g(this)}};a.extend(D.prototype,{getPlotBandPath:function(a,e){var h=this.getPlotLinePath(e,null,null,!0),m=this.getPlotLinePath(a,null,null,!0),c=[],f=this.horiz,b=1,d;a=a<this.min&&e<this.min||a>this.max&&e>this.max;if(m&&h){for(a&&(d=m.toString()===h.toString(),b=0),a=0;a<m.length;a+=6){f&&h[a+1]===m[a+1]?(h[a+1]+=b,h[a+4]+=b):f||h[a+2]!==m[a+2]||(h[a+2]+=b,h[a+5]+=b),c.push("M",m[a+1],m[a+2],"L",m[a+4],m[a+5],h[a+4],h[a+5],h[a+1],h[a+2],"z"),c.flat=d}}return c},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(g,e){var h=new a.PlotLineOrBand(this,g).render(),m=this.userOptions;h&&(e&&(m[e]=m[e]||[],m[e].push(g)),this.plotLinesAndBands.push(h));return h},removePlotBandOrLine:function(a){for(var e=this.plotLinesAndBands,h=this.options,m=this.userOptions,c=e.length;c--;){e[c].id===a&&e[c].destroy()}l([h.plotLines||[],m.plotLines||[],h.plotBands||[],m.plotBands||[]],function(f){for(c=f.length;c--;){f[c].id===a&&r(f,f[c])}})},removePlotBand:function(a){this.removePlotBandOrLine(a)},removePlotLine:function(a){this.removePlotBandOrLine(a)}})})(N,V);(function(a){var D=a.dateFormat,B=a.each,G=a.extend,p=a.format,g=a.isNumber,l=a.map,r=a.merge,n=a.pick,w=a.splat,v=a.syncTimeout,e=a.timeUnits;a.Tooltip=function(){this.init.apply(this,arguments)};a.Tooltip.prototype={init:function(a,e){this.chart=a;this.options=e;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.split=e.split&&!a.inverted;this.shared=e.shared||this.split},cleanSplit:function(a){B(this.chart.series,function(e){var c=e&&e.tt;c&&(!c.isActive||a?e.tt=c.destroy():c.isActive=!1)})},getLabel:function(){var a=this.chart.renderer,e=this.options;this.label||(this.split?this.label=a.g("tooltip"):(this.label=a.label("",0,0,e.shape||"callout",null,null,e.useHTML,null,"tooltip").attr({padding:e.padding,r:e.borderRadius}),this.label.attr({fill:e.backgroundColor,"stroke-width":e.borderWidth}).css(e.style).shadow(e.shadow)),this.label.attr({zIndex:8}).add());return this.label},update:function(a){this.destroy();r(!0,this.chart.options.tooltip.userOptions,a);this.init(this.chart,r(!0,this.options,a))},destroy:function(){this.label&&(this.label=this.label.destroy());this.split&&this.tt&&(this.cleanSplit(this.chart,!0),this.tt=this.tt.destroy());clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(a,e,c,f){var b=this,d=b.now,h=!1!==b.options.animation&&!b.isHidden&&(1<Math.abs(a-d.x)||1<Math.abs(e-d.y)),m=b.followPointer||1<b.len;G(d,{x:h?(2*d.x+a)/3:a,y:h?(d.y+e)/2:e,anchorX:m?void 0:h?(2*d.anchorX+c)/3:c,anchorY:m?void 0:h?(d.anchorY+f)/2:f});b.getLabel().attr(d);h&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){b&&b.move(a,e,c,f)},32))},hide:function(a){var e=this;clearTimeout(this.hideTimer);a=n(a,this.options.hideDelay,500);this.isHidden||(this.hideTimer=v(function(){e.getLabel()[a?"fadeOut":"hide"]();e.isHidden=!0},a))},getAnchor:function(a,e){var c,f=this.chart,b=f.inverted,d=f.plotTop,h=f.plotLeft,m=0,g=0,t,n;a=w(a);c=a[0].tooltipPos;this.followPointer&&e&&(void 0===e.chartX&&(e=f.pointer.normalize(e)),c=[e.chartX-f.plotLeft,e.chartY-d]);c||(B(a,function(a){t=a.series.yAxis;n=a.series.xAxis;m+=a.plotX+(!b&&n?n.left-h:0);g+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!b&&t?t.top-d:0)}),m/=a.length,g/=a.length,c=[b?f.plotWidth-g:m,this.shared&&!b&&1<a.length&&e?e.chartY-d:b?f.plotHeight-m:g]);return l(c,Math.round)},getPosition:function(a,e,c){var f=this.chart,b=this.distance,d={},h=f.inverted&&c.h||0,m,g=["y",f.chartHeight,e,c.plotY+f.plotTop,f.plotTop,f.plotTop+f.plotHeight],t=["x",f.chartWidth,a,c.plotX+f.plotLeft,f.plotLeft,f.plotLeft+f.plotWidth],l=!this.followPointer&&n(c.ttBelow,!f.inverted===!!c.negative),x=function(a,c,f,k,e,q){var m=f<k-b,y=k+b+f<c,u=k-b-f;k+=b;if(l&&y){d[a]=k}else if(!l&&m){d[a]=u}else if(m){d[a]=Math.min(q-f,0>u-h?u:u-h)}else if(y){d[a]=Math.max(e,k+h+f>c?k:k+h)}else{return!1}},C=function(a,c,f,k){var e;k<b||k>c-b?e=!1:d[a]=k<f/2?1:k>c-f/2?c-f-2:k-f/2;return e},r=function(a){var b=g;g=t;t=b;m=a},q=function(){!1!==x.apply(0,g)?!1!==C.apply(0,t)||m||(r(!0),q()):m?d.x=d.y=0:(r(!0),q())};(f.inverted||1<this.len)&&r();q();return d},defaultFormatter:function(a){var e=this.points||w(this),c;c=[a.tooltipFooterHeaderFormatter(e[0])];c=c.concat(a.bodyFormatter(e));c.push(a.tooltipFooterHeaderFormatter(e[0],!0));return c},refresh:function(a,e){var c,f=this.options,b,d=a,h,m={},g=[];c=f.formatter||this.defaultFormatter;var m=this.shared,t;f.enabled&&(clearTimeout(this.hideTimer),this.followPointer=w(d)[0].series.tooltipOptions.followPointer,h=this.getAnchor(d,e),e=h[0],b=h[1],!m||d.series&&d.series.noSharedTooltip?m=d.getLabelConfig():(B(d,function(a){a.setState("hover");g.push(a.getLabelConfig())}),m={x:d[0].category,y:d[0].y},m.points=g,d=d[0]),this.len=g.length,m=c.call(m,this),t=d.series,this.distance=n(t.tooltipOptions.distance,16),!1===m?this.hide():(c=this.getLabel(),this.isHidden&&c.attr({opacity:1}).show(),this.split?this.renderSplit(m,w(a)):(f.style.width||c.css({width:this.chart.spacingBox.width}),c.attr({text:m&&m.join?m.join(""):m}),c.removeClass(/highcharts-color-[\d]+/g).addClass("highcharts-color-"+n(d.colorIndex,t.colorIndex)),c.attr({stroke:f.borderColor||d.color||t.color||"#666666"}),this.updatePosition({plotX:e,plotY:b,negative:d.negative,ttBelow:d.ttBelow,h:h[2]||0})),this.isHidden=!1))},renderSplit:function(e,m){var c=this,f=[],b=this.chart,d=b.renderer,h=!0,g=this.options,l=0,t=this.getLabel();a.isString(e)&&(e=[!1,e]);B(e.slice(0,m.length+1),function(a,e){if(!1!==a){e=m[e-1]||{isHeader:!0,plotX:m[0].plotX};var y=e.series||c,x=y.tt,q=e.series||{},A="highcharts-color-"+n(e.colorIndex,q.colorIndex,"none");x||(y.tt=x=d.label(null,null,null,"callout",null,null,g.useHTML).addClass("highcharts-tooltip-box "+A).attr({padding:g.padding,r:g.borderRadius,fill:g.backgroundColor,stroke:g.borderColor||e.color||q.color||"#333333","stroke-width":g.borderWidth}).add(t));x.isActive=!0;x.attr({text:a});x.css(g.style).shadow(g.shadow);a=x.getBBox();q=a.width+x.strokeWidth();e.isHeader?(l=a.height,q=Math.max(0,Math.min(e.plotX+b.plotLeft-q/2,b.chartWidth-q))):q=e.plotX+b.plotLeft-n(g.distance,16)-q;0>q&&(h=!1);a=(e.series&&e.series.yAxis&&e.series.yAxis.pos)+(e.plotY||0);a-=b.plotTop;f.push({target:e.isHeader?b.plotHeight+l:a,rank:e.isHeader?1:0,size:y.tt.getBBox().height+1,point:e,x:q,tt:x})}});this.cleanSplit();a.distribute(f,b.plotHeight+l);B(f,function(a){var d=a.point,c=d.series;a.tt.attr({visibility:void 0===a.pos?"hidden":"inherit",x:h||d.isHeader?a.x:d.plotX+b.plotLeft+n(g.distance,16),y:a.pos+b.plotTop,anchorX:d.isHeader?d.plotX+b.plotLeft:d.plotX+c.xAxis.pos,anchorY:d.isHeader?a.pos+b.plotTop-15:d.plotY+c.yAxis.pos})})},updatePosition:function(a){var e=this.chart,c=this.getLabel(),c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(Math.round(c.x),Math.round(c.y||0),a.plotX+e.plotLeft,a.plotY+e.plotTop)},getDateFormat:function(a,m,c,f){var b=D("%m-%d %H:%M:%S.%L",m),d,h,g={millisecond:15,second:12,minute:9,hour:6,day:3},l="millisecond";for(h in e){if(a===e.week&&+D("%w",m)===c&&"00:00:00.000"===b.substr(6)){h="week";break}if(e[h]>a){h=l;break}if(g[h]&&b.substr(g[h])!=="01-01 00:00:00.000".substr(g[h])){break}"week"!==h&&(l=h)}h&&(d=f[h]);return d},getXDateFormat:function(a,e,c){e=e.dateTimeLabelFormats;var f=c&&c.closestPointRange;return(f?this.getDateFormat(f,a.x,c.options.startOfWeek,e):e.day)||e.year},tooltipFooterHeaderFormatter:function(a,e){e=e?"footer":"header";var c=a.series,f=c.tooltipOptions,b=f.xDateFormat,d=c.xAxis,h=d&&"datetime"===d.options.type&&g(a.key),m=f[e+"Format"];h&&!b&&(b=this.getXDateFormat(a,f,d));h&&b&&B(a.point&&a.point.tooltipDateKeys||["key"],function(a){m=m.replace("{point."+a+"}","{point."+a+":"+b+"}")});return p(m,{point:a,series:c})},bodyFormatter:function(a){return l(a,function(a){var c=a.series.tooltipOptions;return(c[(a.point.formatPrefix||"point")+"Formatter"]||a.point.tooltipFormatter).call(a.point,c[(a.point.formatPrefix||"point")+"Format"])})}}})(N);(function(a){var D=a.addEvent,B=a.attr,G=a.charts,p=a.color,g=a.css,l=a.defined,r=a.each,n=a.extend,w=a.find,v=a.fireEvent,e=a.isObject,h=a.offset,m=a.pick,c=a.splat,f=a.Tooltip;a.Pointer=function(a,d){this.init(a,d)};a.Pointer.prototype={init:function(a,d){this.options=d;this.chart=a;this.runChartClick=d.chart.events&&!!d.chart.events.click;this.pinchDown=[];this.lastValidTouch={};f&&(a.tooltip=new f(a,d.tooltip),this.followTouchMove=m(d.tooltip.followTouchMove,!0));this.setDOMEvents()},zoomOption:function(a){var b=this.chart,c=b.options.chart,f=c.zoomType||"",b=b.inverted;/touch/.test(a.type)&&(f=m(c.pinchType,f));this.zoomX=a=/x/.test(f);this.zoomY=f=/y/.test(f);this.zoomHor=a&&!b||f&&b;this.zoomVert=f&&!b||a&&b;this.hasZoom=a||f},normalize:function(a,d){var b;b=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;d||(this.chartPosition=d=h(this.chart.container));return n(a,{chartX:Math.round(b.pageX-d.left),chartY:Math.round(b.pageY-d.top)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};r(this.chart.axes,function(d){b[d.isXAxis?"xAxis":"yAxis"].push({axis:d,value:d.toValue(a[d.horiz?"chartX":"chartY"])})});return b},findNearestKDPoint:function(a,d,c){var b;r(a,function(a){var f=!(a.noSharedTooltip&&d)&&0>a.options.findNearestPointBy.indexOf("y");a=a.searchPoint(c,f);if((f=e(a,!0))&&!(f=!e(b,!0))){var f=b.distX-a.distX,h=b.dist-a.dist,m=(a.series.group&&a.series.group.zIndex)-(b.series.group&&b.series.group.zIndex),f=0<(0!==f&&d?f:0!==h?h:0!==m?m:b.series.index>a.series.index?-1:1)}f&&(b=a)});return b},getPointFromEvent:function(a){a=a.target;for(var b;a&&!b;){b=a.point,a=a.parentNode}return b},getChartCoordinatesFromPoint:function(a,d){var b=a.series,c=b.xAxis,b=b.yAxis,f=m(a.clientX,a.plotX);if(c&&b){return d?{chartX:c.len+c.pos-f,chartY:b.len+b.pos-a.plotY}:{chartX:f+c.pos,chartY:a.plotY+b.pos}}},getHoverData:function(b,c,f,h,g,t,l){var d,y=[],n=l&&l.isBoosting;h=!(!h||!b);l=c&&!c.stickyTracking?[c]:a.grep(f,function(a){return a.visible&&!(!g&&a.directTouch)&&m(a.options.enableMouseTracking,!0)&&a.stickyTracking});c=(d=h?b:this.findNearestKDPoint(l,g,t))&&d.series;d&&(g&&!c.noSharedTooltip?(l=a.grep(f,function(a){return a.visible&&!(!g&&a.directTouch)&&m(a.options.enableMouseTracking,!0)&&!a.noSharedTooltip}),r(l,function(a){var b=w(a.points,function(a){return a.x===d.x&&!a.isNull});e(b)&&(n&&(b=a.getPoint(b)),y.push(b))})):y.push(d));return{hoverPoint:d,hoverSeries:c,hoverPoints:y}},runPointActions:function(b,c){var d=this.chart,f=d.tooltip&&d.tooltip.options.enabled?d.tooltip:void 0,e=f?f.shared:!1,h=c||d.hoverPoint,g=h&&h.series||d.hoverSeries,g=this.getHoverData(h,g,d.series,!!c||g&&g.directTouch&&this.isDirectTouch,e,b,{isBoosting:d.isBoosting}),l,h=g.hoverPoint;l=g.hoverPoints;c=(g=g.hoverSeries)&&g.tooltipOptions.followPointer;e=e&&g&&!g.noSharedTooltip;if(h&&(h!==d.hoverPoint||f&&f.isHidden)){r(d.hoverPoints||[],function(b){-1===a.inArray(b,l)&&b.setState()});r(l||[],function(a){a.setState("hover")});if(d.hoverSeries!==g){g.onMouseOver()}d.hoverPoint&&d.hoverPoint.firePointEvent("mouseOut");if(!h.series){return}h.firePointEvent("mouseOver");d.hoverPoints=l;d.hoverPoint=h;f&&f.refresh(e?l:h,b)}else{c&&f&&!f.isHidden&&(h=f.getAnchor([{}],b),f.updatePosition({plotX:h[0],plotY:h[1]}))}this.unDocMouseMove||(this.unDocMouseMove=D(d.container.ownerDocument,"mousemove",function(b){var c=G[a.hoverChartIndex];if(c){c.pointer.onDocumentMouseMove(b)}}));r(d.axes,function(c){var d=m(c.crosshair.snap,!0),f=d?a.find(l,function(a){return a.series[c.coll]===c}):void 0;f||!d?c.drawCrosshair(b,f):c.hideCrosshair()})},reset:function(a,d){var b=this.chart,f=b.hoverSeries,e=b.hoverPoint,h=b.hoverPoints,g=b.tooltip,m=g&&g.shared?h:e;a&&m&&r(c(m),function(b){b.series.isCartesian&&void 0===b.plotX&&(a=!1)});if(a){g&&m&&(g.refresh(m),e&&(e.setState(e.state,!0),r(b.axes,function(a){a.crosshair&&a.drawCrosshair(null,e)})))}else{if(e){e.onMouseOut()}h&&r(h,function(a){a.setState()});if(f){f.onMouseOut()}g&&g.hide(d);this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove());r(b.axes,function(a){a.hideCrosshair()});this.hoverX=b.hoverPoints=b.hoverPoint=null}},scaleGroups:function(a,c){var b=this.chart,d;r(b.series,function(f){d=a||f.getPlotBox();f.xAxis&&f.xAxis.zoomEnabled&&f.group&&(f.group.attr(d),f.markerGroup&&(f.markerGroup.attr(d),f.markerGroup.clip(c?b.clipRect:null)),f.dataLabelsGroup&&f.dataLabelsGroup.attr(d))});b.clipRect.attr(c||b.clipBox)},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,f=a.chartX,e=a.chartY,h=this.zoomHor,g=this.zoomVert,m=b.plotLeft,l=b.plotTop,n=b.plotWidth,q=b.plotHeight,A,E=this.selectionMarker,F=this.mouseDownX,k=this.mouseDownY,u=c.panKey&&a[c.panKey+"Key"];E&&E.touch||(f<m?f=m:f>m+n&&(f=m+n),e<l?e=l:e>l+q&&(e=l+q),this.hasDragged=Math.sqrt(Math.pow(F-f,2)+Math.pow(k-e,2)),10<this.hasDragged&&(A=b.isInsidePlot(F-m,k-l),b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&A&&!u&&!E&&(this.selectionMarker=E=b.renderer.rect(m,l,h?1:n,g?1:q,0).attr({fill:c.selectionMarkerFill||p("#335cad").setOpacity(.25).get(),class:"highcharts-selection-marker",zIndex:7}).add()),E&&h&&(f-=F,E.attr({width:Math.abs(f),x:(0<f?0:f)+F})),E&&g&&(f=e-k,E.attr({height:Math.abs(f),y:(0<f?0:f)+k})),A&&!E&&c.panning&&b.pan(a,c.panning)))},drop:function(a){var b=this,c=this.chart,f=this.hasPinched;if(this.selectionMarker){var e={originalEvent:a,xAxis:[],yAxis:[]},h=this.selectionMarker,m=h.attr?h.attr("x"):h.x,x=h.attr?h.attr("y"):h.y,C=h.attr?h.attr("width"):h.width,p=h.attr?h.attr("height"):h.height,q;if(this.hasDragged||f){r(c.axes,function(c){if(c.zoomEnabled&&l(c.min)&&(f||b[{xAxis:"zoomX",yAxis:"zoomY"}[c.coll]])){var d=c.horiz,h="touchend"===a.type?c.minPixelPadding:0,k=c.toValue((d?m:x)+h),d=c.toValue((d?m+C:x+p)-h);e[c.coll].push({axis:c,min:Math.min(k,d),max:Math.max(k,d)});q=!0}}),q&&v(c,"selection",e,function(a){c.zoom(n(a,f?{animation:!1}:null))})}this.selectionMarker=this.selectionMarker.destroy();f&&this.scaleGroups()}c&&(g(c.container,{cursor:c._cursor}),c.cancelClick=10<this.hasDragged,c.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(a){a=this.normalize(a);this.zoomOption(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(b){G[a.hoverChartIndex]&&G[a.hoverChartIndex].pointer.drop(b)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition;a=this.normalize(a,c);!c||this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)||this.reset()},onContainerMouseLeave:function(b){var c=G[a.hoverChartIndex];c&&(b.relatedTarget||b.toElement)&&(c.pointer.reset(),c.pointer.chartPosition=null)},onContainerMouseMove:function(b){var c=this.chart;l(a.hoverChartIndex)&&G[a.hoverChartIndex]&&G[a.hoverChartIndex].mouseIsDown||(a.hoverChartIndex=c.index);b=this.normalize(b);b.returnValue=!1;"mousedown"===c.mouseIsDown&&this.drag(b);!this.inClass(b.target,"highcharts-tracker")&&!c.isInsidePlot(b.chartX-c.plotLeft,b.chartY-c.plotTop)||c.openMenu||this.runPointActions(b)},inClass:function(a,c){for(var b;a;){if(b=B(a,"class")){if(-1!==b.indexOf(c)){return!0}if(-1!==b.indexOf("highcharts-container")){return!1}}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries;a=a.relatedTarget||a.toElement;this.isDirectTouch=!1;if(!(!b||!a||b.stickyTracking||this.inClass(a,"highcharts-tooltip")||this.inClass(a,"highcharts-series-"+b.index)&&this.inClass(a,"highcharts-tracker"))){b.onMouseOut()}},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,f=b.plotLeft,e=b.plotTop;a=this.normalize(a);b.cancelClick||(c&&this.inClass(a.target,"highcharts-tracker")?(v(c.series,"click",n(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(n(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-f,a.chartY-e)&&v(b,"click",a)))},setDOMEvents:function(){var b=this,c=b.chart.container,f=c.ownerDocument;c.onmousedown=function(a){b.onContainerMouseDown(a)};c.onmousemove=function(a){b.onContainerMouseMove(a)};c.onclick=function(a){b.onContainerClick(a)};this.unbindContainerMouseLeave=D(c,"mouseleave",b.onContainerMouseLeave);a.unbindDocumentMouseUp||(a.unbindDocumentMouseUp=D(f,"mouseup",b.onDocumentMouseUp));a.hasTouch&&(c.ontouchstart=function(a){b.onContainerTouchStart(a)},c.ontouchmove=function(a){b.onContainerTouchMove(a)},a.unbindDocumentTouchEnd||(a.unbindDocumentTouchEnd=D(f,"touchend",b.onDocumentTouchEnd)))},destroy:function(){var b=this;b.unDocMouseMove&&b.unDocMouseMove();this.unbindContainerMouseLeave();a.chartCount||(a.unbindDocumentMouseUp&&(a.unbindDocumentMouseUp=a.unbindDocumentMouseUp()),a.unbindDocumentTouchEnd&&(a.unbindDocumentTouchEnd=a.unbindDocumentTouchEnd()));clearInterval(b.tooltipTimeout);a.objectEach(b,function(a,c){b[c]=null})}}})(N);(function(a){var D=a.charts,B=a.each,G=a.extend,p=a.map,g=a.noop,l=a.pick;G(a.Pointer.prototype,{pinchTranslate:function(a,g,l,p,e,h){this.zoomHor&&this.pinchTranslateDirection(!0,a,g,l,p,e,h);this.zoomVert&&this.pinchTranslateDirection(!1,a,g,l,p,e,h)},pinchTranslateDirection:function(a,g,l,p,e,h,m,c){var f=this.chart,b=a?"x":"y",d=a?"X":"Y",y="chart"+d,n=a?"width":"height",r=f["plot"+(a?"Left":"Top")],t,v,x=c||1,C=f.inverted,w=f.bounds[a?"h":"v"],q=1===g.length,A=g[0][y],E=l[0][y],F=!q&&g[1][y],k=!q&&l[1][y],u;l=function(){!q&&20<Math.abs(A-F)&&(x=c||Math.abs(E-k)/Math.abs(A-F));v=(r-E)/x+A;t=f["plot"+(a?"Width":"Height")]/x};l();g=v;g<w.min?(g=w.min,u=!0):g+t>w.max&&(g=w.max-t,u=!0);u?(E-=.8*(E-m[b][0]),q||(k-=.8*(k-m[b][1])),l()):m[b]=[E,k];C||(h[b]=v-r,h[n]=t);h=C?1/x:x;e[n]=t;e[b]=g;p[C?a?"scaleY":"scaleX":"scale"+d]=x;p["translate"+d]=h*r+(E-h*A)},pinch:function(a){var n=this,r=n.chart,v=n.pinchDown,e=a.touches,h=e.length,m=n.lastValidTouch,c=n.hasZoom,f=n.selectionMarker,b={},d=1===h&&(n.inClass(a.target,"highcharts-tracker")&&r.runTrackerClick||n.runChartClick),y={};1<h&&(n.initiated=!0);c&&n.initiated&&!d&&a.preventDefault();p(e,function(a){return n.normalize(a)});"touchstart"===a.type?(B(e,function(a,b){v[b]={chartX:a.chartX,chartY:a.chartY}}),m.x=[v[0].chartX,v[1]&&v[1].chartX],m.y=[v[0].chartY,v[1]&&v[1].chartY],B(r.axes,function(a){if(a.zoomEnabled){var b=r.bounds[a.horiz?"h":"v"],c=a.minPixelPadding,f=a.toPixels(l(a.options.min,a.dataMin)),d=a.toPixels(l(a.options.max,a.dataMax)),e=Math.max(f,d);b.min=Math.min(a.pos,Math.min(f,d)-c);b.max=Math.max(a.pos+a.len,e+c)}}),n.res=!0):n.followTouchMove&&1===h?this.runPointActions(n.normalize(a)):v.length&&(f||(n.selectionMarker=f=G({destroy:g,touch:!0},r.plotBox)),n.pinchTranslate(v,e,b,f,y,m),n.hasPinched=c,n.scaleGroups(b,y),n.res&&(n.res=!1,this.reset(!1,0)))},touch:function(g,n){var r=this.chart,p,e;if(r.index!==a.hoverChartIndex){this.onContainerMouseLeave({relatedTarget:!0})}a.hoverChartIndex=r.index;1===g.touches.length?(g=this.normalize(g),(e=r.isInsidePlot(g.chartX-r.plotLeft,g.chartY-r.plotTop))&&!r.openMenu?(n&&this.runPointActions(g),"touchmove"===g.type&&(n=this.pinchDown,p=n[0]?4<=Math.sqrt(Math.pow(n[0].chartX-g.chartX,2)+Math.pow(n[0].chartY-g.chartY,2)):!1),l(p,!0)&&this.pinch(g)):n&&this.reset()):2===g.touches.length&&this.pinch(g)},onContainerTouchStart:function(a){this.zoomOption(a);this.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},onDocumentTouchEnd:function(g){D[a.hoverChartIndex]&&D[a.hoverChartIndex].pointer.drop(g)}})})(N);(function(a){var D=a.addEvent,B=a.charts,G=a.css,p=a.doc,g=a.extend,l=a.noop,r=a.Pointer,n=a.removeEvent,w=a.win,v=a.wrap;if(!a.hasTouch&&(w.PointerEvent||w.MSPointerEvent)){var e={},h=!!w.PointerEvent,m=function(){var c=[];c.item=function(a){return this[a]};a.objectEach(e,function(a){c.push({pageX:a.pageX,pageY:a.pageY,target:a.target})});return c},c=function(c,b,d,e){"touch"!==c.pointerType&&c.pointerType!==c.MSPOINTER_TYPE_TOUCH||!B[a.hoverChartIndex]||(e(c),e=B[a.hoverChartIndex].pointer,e[b]({type:d,target:c.currentTarget,preventDefault:l,touches:m()}))};g(r.prototype,{onContainerPointerDown:function(a){c(a,"onContainerTouchStart","touchstart",function(a){e[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){c(a,"onContainerTouchMove","touchmove",function(a){e[a.pointerId]={pageX:a.pageX,pageY:a.pageY};e[a.pointerId].target||(e[a.pointerId].target=a.currentTarget)})},onDocumentPointerUp:function(a){c(a,"onDocumentTouchEnd","touchend",function(a){delete e[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,h?"pointerdown":"MSPointerDown",this.onContainerPointerDown);a(this.chart.container,h?"pointermove":"MSPointerMove",this.onContainerPointerMove);a(p,h?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}});v(r.prototype,"init",function(a,b,c){a.call(this,b,c);this.hasZoom&&G(b.container,{"-ms-touch-action":"none","touch-action":"none"})});v(r.prototype,"setDOMEvents",function(a){a.apply(this);(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(D)});v(r.prototype,"destroy",function(a){this.batchMSEvents(n);a.call(this)})}})(N);(function(a){var D=a.addEvent,B=a.css,G=a.discardElement,p=a.defined,g=a.each,l=a.isFirefox,r=a.marginNames,n=a.merge,w=a.pick,v=a.setAnimation,e=a.stableSort,h=a.win,m=a.wrap;a.Legend=function(a,f){this.init(a,f)};a.Legend.prototype={init:function(a,f){this.chart=a;this.setOptions(f);f.enabled&&(this.render(),D(this.chart,"endResize",function(){this.legend.positionCheckboxes()}))},setOptions:function(a){var c=w(a.padding,8);this.options=a;this.itemStyle=a.itemStyle;this.itemHiddenStyle=n(this.itemStyle,a.itemHiddenStyle);this.itemMarginTop=a.itemMarginTop||0;this.padding=c;this.initialItemY=c-5;this.itemHeight=this.maxItemWidth=0;this.symbolWidth=w(a.symbolWidth,16);this.pages=[]},update:function(a,f){var b=this.chart;this.setOptions(n(!0,this.options,a));this.destroy();b.isDirtyLegend=b.isDirtyBox=!0;w(f,!0)&&b.redraw()},colorizeItem:function(a,f){a.legendGroup[f?"removeClass":"addClass"]("highcharts-legend-item-hidden");var b=this.options,c=a.legendItem,e=a.legendLine,h=a.legendSymbol,g=this.itemHiddenStyle.color,b=f?b.itemStyle.color:g,m=f?a.color||g:g,l=a.options&&a.options.marker,x={fill:m};c&&c.css({fill:b,color:b});e&&e.attr({stroke:m});h&&(l&&h.isMarker&&(x=a.pointAttribs(),f||(x.stroke=x.fill=g)),h.attr(x))},positionItem:function(a){var c=this.options,b=c.symbolPadding,c=!c.rtl,d=a._legendItemPos,e=d[0],d=d[1],h=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(c?e:this.legendWidth-e-2*b-4,d);h&&(h.x=e,h.y=d)},destroyItem:function(a){var c=a.checkbox;g(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});c&&G(a.checkbox)},destroy:function(){function a(a){this[a]&&(this[a]=this[a].destroy())}g(this.getAllItems(),function(c){g(["legendItem","legendGroup"],a,c)});g("clipRect up down pager nav box title group".split(" "),a,this);this.display=null},positionCheckboxes:function(){var a=this.group&&this.group.alignAttr,f,b=this.clipHeight||this.legendHeight,d=this.titleHeight;a&&(f=a.translateY,g(this.allItems,function(c){var e=c.checkbox,h;e&&(h=f+d+e.y+(this.scrollOffset||0)+3,B(e,{left:a.translateX+c.checkboxOffset+e.x-20+"px",top:h+"px",display:h>f-6&&h<f+b-6?"":"none"}))},this))},renderTitle:function(){var a=this.options,f=this.padding,b=a.title,d=0;b.text&&(this.title||(this.title=this.chart.renderer.label(b.text,f-3,f-4,null,null,null,a.useHTML,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group)),a=this.title.getBBox(),d=a.height,this.offsetWidth=a.width,this.contentGroup.attr({translateY:d}));this.titleHeight=d},setText:function(c){var f=this.options;c.legendItem.attr({text:f.labelFormat?a.format(f.labelFormat,c):f.labelFormatter.call(c)})},renderItem:function(a){var c=this.chart,b=c.renderer,d=this.options,e="horizontal"===d.layout,h=this.symbolWidth,g=d.symbolPadding,m=this.itemStyle,l=this.itemHiddenStyle,x=this.padding,C=e?w(d.itemDistance,20):0,r=!d.rtl,q=d.width,A=d.itemMarginBottom||0,E=this.itemMarginTop,F=a.legendItem,k=!a.series,u=!k&&a.series.drawLegendSymbol?a.series:a,p=u.options,v=this.createCheckboxForItem&&p&&p.showCheckbox,p=h+g+C+(v?20:0),P=d.useHTML,I=a.options.className;F||(a.legendGroup=b.g("legend-item").addClass("highcharts-"+u.type+"-series highcharts-color-"+a.colorIndex+(I?" "+I:"")+(k?" highcharts-series-"+a.index:"")).attr({zIndex:1}).add(this.scrollGroup),a.legendItem=F=b.text("",r?h+g:-g,this.baseline||0,P).css(n(a.visible?m:l)).attr({align:r?"left":"right",zIndex:2}).add(a.legendGroup),this.baseline||(h=m.fontSize,this.fontMetrics=b.fontMetrics(h,F),this.baseline=this.fontMetrics.f+3+E,F.attr("y",this.baseline)),this.symbolHeight=d.symbolHeight||this.fontMetrics.f,u.drawLegendSymbol(this,a),this.setItemEvents&&this.setItemEvents(a,F,P),v&&this.createCheckboxForItem(a));this.colorizeItem(a,a.visible);m.width||F.css({width:(d.itemWidth||d.width||c.spacingBox.width)-p});this.setText(a);b=F.getBBox();m=a.checkboxOffset=d.itemWidth||a.legendItemWidth||b.width+p;this.itemHeight=b=Math.round(a.legendItemHeight||b.height||this.symbolHeight);e&&this.itemX-x+m>(q||c.spacingBox.width-2*x-d.x)&&(this.itemX=x,this.itemY+=E+this.lastLineHeight+A,this.lastLineHeight=0);this.maxItemWidth=Math.max(this.maxItemWidth,m);this.lastItemY=E+this.itemY+A;this.lastLineHeight=Math.max(b,this.lastLineHeight);a._legendItemPos=[this.itemX,this.itemY];e?this.itemX+=m:(this.itemY+=E+b+A,this.lastLineHeight=b);this.offsetWidth=q||Math.max((e?this.itemX-x-(a.checkbox?0:C):m)+x,this.offsetWidth)},getAllItems:function(){var a=[];g(this.chart.series,function(c){var b=c&&c.options;c&&w(b.showInLegend,p(b.linkedTo)?!1:void 0,!0)&&(a=a.concat(c.legendItems||("point"===b.legendType?c.data:c)))});return a},adjustMargins:function(a,f){var b=this.chart,c=this.options,e=c.align.charAt(0)+c.verticalAlign.charAt(0)+c.layout.charAt(0);c.floating||g([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(d,h){d.test(e)&&!p(a[h])&&(b[r[h]]=Math.max(b[r[h]],b.legend[(h+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][h]*c[h%2?"x":"y"]+w(c.margin,12)+f[h]))})},render:function(){var a=this,f=a.chart,b=f.renderer,d=a.group,h,m,l,t,p=a.box,x=a.options,r=a.padding;a.itemX=r;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;d||(a.group=d=b.g("legend").attr({zIndex:7}).add(),a.contentGroup=b.g().attr({zIndex:1}).add(d),a.scrollGroup=b.g().add(a.contentGroup));a.renderTitle();h=a.getAllItems();e(h,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});x.reversed&&h.reverse();a.allItems=h;a.display=m=!!h.length;a.lastLineHeight=0;g(h,function(b){a.renderItem(b)});l=(x.width||a.offsetWidth)+r;t=a.lastItemY+a.lastLineHeight+a.titleHeight;t=a.handleOverflow(t);t+=r;p||(a.box=p=b.rect().addClass("highcharts-legend-box").attr({r:x.borderRadius}).add(d),p.isNew=!0);p.attr({stroke:x.borderColor,"stroke-width":x.borderWidth||0,fill:x.backgroundColor||"none"}).shadow(x.shadow);0<l&&0<t&&(p[p.isNew?"attr":"animate"](p.crisp.call({},{x:0,y:0,width:l,height:t},p.strokeWidth())),p.isNew=!1);p[m?"show":"hide"]();a.legendWidth=l;a.legendHeight=t;g(h,function(b){a.positionItem(b)});m&&d.align(n(x,{width:l,height:t}),!0,"spacingBox");f.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var c=this,b=this.chart,d=b.renderer,e=this.options,h=e.y,m=this.padding,b=b.spacingBox.height+("top"===e.verticalAlign?-h:h)-m,h=e.maxHeight,l,n=this.clipRect,x=e.navigation,p=w(x.animation,!0),r=x.arrowSize||12,q=this.nav,A=this.pages,E,F=this.allItems,k=function(a){"number"===typeof a?n.attr({height:a}):n&&(c.clipRect=n.destroy(),c.contentGroup.clip());c.contentGroup.div&&(c.contentGroup.div.style.clip=a?"rect("+m+"px,9999px,"+(m+a)+"px,0)":"auto")};"horizontal"!==e.layout||"middle"===e.verticalAlign||e.floating||(b/=2);h&&(b=Math.min(b,h));A.length=0;a>b&&!1!==x.enabled?(this.clipHeight=l=Math.max(b-20-this.titleHeight-m,0),this.currentPage=w(this.currentPage,1),this.fullHeight=a,g(F,function(a,b){var c=a._legendItemPos[1];a=Math.round(a.legendItem.getBBox().height);var d=A.length;if(!d||c-A[d-1]>l&&(E||c)!==A[d-1]){A.push(E||c),d++}b===F.length-1&&c+a-A[d-1]>l&&A.push(c);c!==E&&(E=c)}),n||(n=c.clipRect=d.clipRect(0,m,9999,0),c.contentGroup.clip(n)),k(l),q||(this.nav=q=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,r,r).on("click",function(){c.scroll(-1,p)}).add(q),this.pager=d.text("",15,10).addClass("highcharts-legend-navigation").css(x.style).add(q),this.down=d.symbol("triangle-down",0,0,r,r).on("click",function(){c.scroll(1,p)}).add(q)),c.scroll(0),a=b):q&&(k(),this.nav=q.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0);return a},scroll:function(a,f){var b=this.pages,c=b.length;a=this.currentPage+a;var e=this.clipHeight,h=this.options.navigation,g=this.pager,m=this.padding;a>c&&(a=c);0<a&&(void 0!==f&&v(f,this.chart),this.nav.attr({translateX:m,translateY:e+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({class:1===a?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),g.attr({text:a+"/"+c}),this.down.attr({x:18+this.pager.getBBox().width,class:a===c?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),this.up.attr({fill:1===a?h.inactiveColor:h.activeColor}).css({cursor:1===a?"default":"pointer"}),this.down.attr({fill:a===c?h.inactiveColor:h.activeColor}).css({cursor:a===c?"default":"pointer"}),this.scrollOffset=-b[a-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=a,this.positionCheckboxes())}};a.LegendSymbolMixin={drawRectangle:function(a,f){var b=a.symbolHeight,c=a.options.squareSymbol;f.legendSymbol=this.chart.renderer.rect(c?(a.symbolWidth-b)/2:0,a.baseline-b+1,c?b:a.symbolWidth,b,w(a.options.symbolRadius,b/2)).addClass("highcharts-point").attr({zIndex:3}).add(f.legendGroup)},drawLineMarker:function(a){var c=this.options,b=c.marker,d=a.symbolWidth,e=a.symbolHeight,h=e/2,g=this.chart.renderer,m=this.legendGroup;a=a.baseline-Math.round(.3*a.fontMetrics.b);var l;l={"stroke-width":c.lineWidth||0};c.dashStyle&&(l.dashstyle=c.dashStyle);this.legendLine=g.path(["M",0,a,"L",d,a]).addClass("highcharts-graph").attr(l).add(m);b&&!1!==b.enabled&&(c=Math.min(w(b.radius,h),h),0===this.symbol.indexOf("url")&&(b=n(b,{width:e,height:e}),c=0),this.legendSymbol=b=g.symbol(this.symbol,d/2-c,a-c,2*c,2*c,b).addClass("highcharts-point").add(m),b.isMarker=!0)}};(/Trident\/7\.0/.test(h.navigator.userAgent)||l)&&m(a.Legend.prototype,"positionItem",function(a,f){var b=this,c=function(){f._legendItemPos&&a.call(b,f)};c();setTimeout(c)})})(N);(function(a){var D=a.addEvent,B=a.animate,G=a.animObject,p=a.attr,g=a.doc,l=a.Axis,r=a.createElement,n=a.defaultOptions,w=a.discardElement,v=a.charts,e=a.css,h=a.defined,m=a.each,c=a.extend,f=a.find,b=a.fireEvent,d=a.grep,y=a.isNumber,H=a.isObject,J=a.isString,t=a.Legend,K=a.marginNames,x=a.merge,C=a.objectEach,L=a.Pointer,q=a.pick,A=a.pInt,E=a.removeEvent,F=a.seriesTypes,k=a.splat,u=a.svg,R=a.syncTimeout,M=a.win,P=a.Chart=function(){this.getArgs.apply(this,arguments)};a.chart=function(a,b,c){return new P(a,b,c)};c(P.prototype,{callbacks:[],getArgs:function(){var a=[].slice.call(arguments);if(J(a[0])||a[0].nodeName){this.renderTo=a.shift()}this.init(a[0],a[1])},init:function(b,c){var d,f,k=b.series,e=b.plotOptions||{};b.series=null;d=x(n,b);for(f in d.plotOptions){d.plotOptions[f].tooltip=e[f]&&x(e[f].tooltip)||void 0}d.tooltip.userOptions=b.chart&&b.chart.forExport&&b.tooltip.userOptions||b.tooltip;d.series=b.series=k;this.userOptions=b;b=d.chart;f=b.events;this.margin=[];this.spacing=[];this.bounds={h:{},v:{}};this.labelCollectors=[];this.callback=c;this.isResizing=0;this.options=d;this.axes=[];this.series=[];this.hasCartesianSeries=b.showAxes;var q=this;q.index=v.length;v.push(q);a.chartCount++;f&&C(f,function(a,b){D(q,b,a)});q.xAxis=[];q.yAxis=[];q.pointCount=q.colorCounter=q.symbolCounter=0;q.firstRender()},initSeries:function(b){var c=this.options.chart;(c=F[b.type||c.type||c.defaultSeriesType])||a.error(17,!0);c=new c;c.init(this,b);return c},orderSeries:function(a){var b=this.series;for(a=a||0;a<b.length;a++){b[a]&&(b[a].index=a,b[a].name=b[a].name||"Series "+(b[a].index+1))}},isInsidePlot:function(a,b,c){var d=c?b:a;a=c?a:b;return 0<=d&&d<=this.plotWidth&&0<=a&&a<=this.plotHeight},redraw:function(d){var f=this.axes,k=this.series,e=this.pointer,q=this.legend,h=this.isDirtyLegend,g,l,u=this.hasCartesianSeries,A=this.isDirtyBox,E,t=this.renderer,n=t.isHidden(),x=[];this.setResponsive&&this.setResponsive(!1);a.setAnimation(d,this);n&&this.temporaryDisplay();this.layOutTitles();for(d=k.length;d--;){if(E=k[d],E.options.stacking&&(g=!0,E.isDirty)){l=!0;break}}if(l){for(d=k.length;d--;){E=k[d],E.options.stacking&&(E.isDirty=!0)}}m(k,function(a){a.isDirty&&"point"===a.options.legendType&&(a.updateTotals&&a.updateTotals(),h=!0);a.isDirtyData&&b(a,"updatedData")});h&&q.options.enabled&&(q.render(),this.isDirtyLegend=!1);g&&this.getStacks();u&&m(f,function(a){a.updateNames();a.setScale()});this.getMargins();u&&(m(f,function(a){a.isDirty&&(A=!0)}),m(f,function(a){var d=a.min+","+a.max;a.extKey!==d&&(a.extKey=d,x.push(function(){b(a,"afterSetExtremes",c(a.eventArgs,a.getExtremes()));delete a.eventArgs}));(A||g)&&a.redraw()}));A&&this.drawChartBox();b(this,"predraw");m(k,function(a){(A||a.isDirty)&&a.visible&&a.redraw();a.isDirtyData=!1});e&&e.reset(!0);t.draw();b(this,"redraw");b(this,"render");n&&this.temporaryDisplay(!0);m(x,function(a){a.call()})},get:function(a){function b(b){return b.id===a||b.options&&b.options.id===a}var c,d=this.series,k;c=f(this.axes,b)||f(this.series,b);for(k=0;!c&&k<d.length;k++){c=f(d[k].points||[],b)}return c},getAxes:function(){var a=this,b=this.options,c=b.xAxis=k(b.xAxis||{}),b=b.yAxis=k(b.yAxis||{});m(c,function(a,b){a.index=b;a.isX=!0});m(b,function(a,b){a.index=b});c=c.concat(b);m(c,function(b){new l(a,b)})},getSelectedPoints:function(){var a=[];m(this.series,function(b){a=a.concat(d(b.data||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return d(this.series,function(a){return a.selected})},setTitle:function(a,b,c){var d=this,f=d.options,k;k=f.title=x({style:{color:"#333333",fontSize:f.isStock?"16px":"18px"}},f.title,a);f=f.subtitle=x({style:{color:"#666666"}},f.subtitle,b);m([["title",a,k],["subtitle",b,f]],function(a,b){var c=a[0],f=d[c],k=a[1];a=a[2];f&&k&&(d[c]=f=f.destroy());a&&!f&&(d[c]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,class:"highcharts-"+c,zIndex:a.zIndex||4}).add(),d[c].update=function(a){d.setTitle(!b&&a,b&&a)},d[c].css(a.style))});d.layOutTitles(c)},layOutTitles:function(a){var b=0,d,f=this.renderer,k=this.spacingBox;m(["title","subtitle"],function(a){var d=this[a],e=this.options[a];a="title"===a?-3:e.verticalAlign?0:b+2;var q;d&&(q=e.style.fontSize,q=f.fontMetrics(q,d).b,d.css({width:(e.width||k.width+e.widthAdjust)+"px"}).align(c({y:a+q},e),!1,"spacingBox"),e.floating||e.verticalAlign||(b=Math.ceil(b+d.getBBox(e.useHTML).height)))},this);d=this.titleOffset!==b;this.titleOffset=b;!this.isDirtyBox&&d&&(this.isDirtyBox=d,this.hasRendered&&q(a,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var b=this.options.chart,c=b.width,b=b.height,d=this.renderTo;h(c)||(this.containerWidth=a.getStyle(d,"width"));h(b)||(this.containerHeight=a.getStyle(d,"height"));this.chartWidth=Math.max(0,c||this.containerWidth||600);this.chartHeight=Math.max(0,a.relativeLength(b,this.chartWidth)||(1<this.containerHeight?this.containerHeight:400))},temporaryDisplay:function(b){var c=this.renderTo;if(b){for(;c&&c.style;){c.hcOrigStyle&&(a.css(c,c.hcOrigStyle),delete c.hcOrigStyle),c.hcOrigDetached&&(g.body.removeChild(c),c.hcOrigDetached=!1),c=c.parentNode}}else{for(;c&&c.style;){g.body.contains(c)||c.parentNode||(c.hcOrigDetached=!0,g.body.appendChild(c));if("none"===a.getStyle(c,"display",!1)||c.hcOricDetached){c.hcOrigStyle={display:c.style.display,height:c.style.height,overflow:c.style.overflow},b={display:"block",overflow:"hidden"},c!==this.renderTo&&(b.height=0),a.css(c,b),c.offsetWidth||c.style.setProperty("display","block","important")}c=c.parentNode;if(c===g.body){break}}}},setClassName:function(a){this.container.className="highcharts-container "+(a||"")},getContainer:function(){var b,d=this.options,f=d.chart,k,e;b=this.renderTo;var q=a.uniqueKey(),h;b||(this.renderTo=b=f.renderTo);J(b)&&(this.renderTo=b=g.getElementById(b));b||a.error(13,!0);k=A(p(b,"data-highcharts-chart"));y(k)&&v[k]&&v[k].hasRendered&&v[k].destroy();p(b,"data-highcharts-chart",this.index);b.innerHTML="";f.skipClone||b.offsetWidth||this.temporaryDisplay();this.getChartSize();k=this.chartWidth;e=this.chartHeight;h=c({position:"relative",overflow:"hidden",width:k+"px",height:e+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},f.style);this.container=b=r("div",{id:q},h,b);this._cursor=b.style.cursor;this.renderer=new(a[f.renderer]||a.Renderer)(b,k,e,null,f.forExport,d.exporting&&d.exporting.allowHTML);this.setClassName(f.className);this.renderer.setStyle(f.style);this.renderer.chartIndex=this.index},getMargins:function(a){var b=this.spacing,c=this.margin,d=this.titleOffset;this.resetMargins();d&&!h(c[0])&&(this.plotTop=Math.max(this.plotTop,d+this.options.title.margin+b[0]));this.legend&&this.legend.display&&this.legend.adjustMargins(c,b);this.extraMargin&&(this[this.extraMargin.type]=(this[this.extraMargin.type]||0)+this.extraMargin.value);this.adjustPlotArea&&this.adjustPlotArea();a||this.getAxisMargins()},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&m(a.axes,function(a){a.visible&&a.getOffset()});m(K,function(d,f){h(c[f])||(a[d]+=b[f])});a.setChartSize()},reflow:function(b){var c=this,d=c.options.chart,f=c.renderTo,k=h(d.width)&&h(d.height),e=d.width||a.getStyle(f,"width"),d=d.height||a.getStyle(f,"height"),f=b?b.target:M;if(!k&&!c.isPrinting&&e&&d&&(f===M||f===g)){if(e!==c.containerWidth||d!==c.containerHeight){clearTimeout(c.reflowTimeout),c.reflowTimeout=R(function(){c.container&&c.setSize(void 0,void 0,!1)},b?100:0)}c.containerWidth=e;c.containerHeight=d}},initReflow:function(){var a=this,b;b=D(M,"resize",function(b){a.reflow(b)});D(a,"destroy",b)},setSize:function(c,d,f){var k=this,q=k.renderer;k.isResizing+=1;a.setAnimation(f,k);k.oldChartHeight=k.chartHeight;k.oldChartWidth=k.chartWidth;void 0!==c&&(k.options.chart.width=c);void 0!==d&&(k.options.chart.height=d);k.getChartSize();c=q.globalAnimation;(c?B:e)(k.container,{width:k.chartWidth+"px",height:k.chartHeight+"px"},c);k.setChartSize(!0);q.setSize(k.chartWidth,k.chartHeight,f);m(k.axes,function(a){a.isDirty=!0;a.setScale()});k.isDirtyLegend=!0;k.isDirtyBox=!0;k.layOutTitles();k.getMargins();k.redraw(f);k.oldChartHeight=null;b(k,"resize");R(function(){k&&b(k,"endResize",null,function(){--k.isResizing})},G(c).duration)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,k=this.chartHeight,f=this.options.chart,e=this.spacing,q=this.clipOffset,h,g,l,u;this.plotLeft=h=Math.round(this.plotLeft);this.plotTop=g=Math.round(this.plotTop);this.plotWidth=l=Math.max(0,Math.round(d-h-this.marginRight));this.plotHeight=u=Math.max(0,Math.round(k-g-this.marginBottom));this.plotSizeX=b?u:l;this.plotSizeY=b?l:u;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:e[3],y:e[0],width:d-e[3]-e[1],height:k-e[0]-e[2]};this.plotBox=c.plotBox={x:h,y:g,width:l,height:u};d=2*Math.floor(this.plotBorderWidth/2);b=Math.ceil(Math.max(d,q[3])/2);c=Math.ceil(Math.max(d,q[0])/2);this.clipBox={x:b,y:c,width:Math.floor(this.plotSizeX-Math.max(d,q[1])/2-b),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(d,q[2])/2-c))};a||m(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this,b=a.options.chart;m(["margin","spacing"],function(c){var d=b[c],k=H(d)?d:[d,d,d,d];m(["Top","Right","Bottom","Left"],function(d,f){a[c][f]=q(b[c+d],k[f])})});m(K,function(b,c){a[b]=q(a.margin[c],a.spacing[c])});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,k=this.chartBackground,f=this.plotBackground,e=this.plotBorder,q,h=this.plotBGImage,g=a.backgroundColor,m=a.plotBackgroundColor,l=a.plotBackgroundImage,u,A=this.plotLeft,E=this.plotTop,t=this.plotWidth,n=this.plotHeight,x=this.plotBox,y=this.clipRect,F=this.clipBox,p="animate";k||(this.chartBackground=k=b.rect().addClass("highcharts-background").add(),p="attr");q=a.borderWidth||0;u=q+(a.shadow?8:0);g={fill:g||"none"};if(q||k["stroke-width"]){g.stroke=a.borderColor,g["stroke-width"]=q}k.attr(g).shadow(a.shadow);k[p]({x:u/2,y:u/2,width:c-u-q%2,height:d-u-q%2,r:a.borderRadius});p="animate";f||(p="attr",this.plotBackground=f=b.rect().addClass("highcharts-plot-background").add());f[p](x);f.attr({fill:m||"none"}).shadow(a.plotShadow);l&&(h?h.animate(x):this.plotBGImage=b.image(l,A,E,t,n).add());y?y.animate({width:F.width,height:F.height}):this.clipRect=b.clipRect(F);p="animate";e||(p="attr",this.plotBorder=e=b.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add());e.attr({stroke:a.plotBorderColor,"stroke-width":a.plotBorderWidth||0,fill:"none"});e[p](e.crisp({x:A,y:E,width:t,height:n},-e.strokeWidth()));this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,k,f;m(["inverted","angular","polar"],function(e){c=F[b.type||b.defaultSeriesType];f=b[e]||c&&c.prototype[e];for(k=d&&d.length;!f&&k--;){(c=F[d[k].type])&&c.prototype[e]&&(f=!0)}a[e]=f})},linkSeries:function(){var a=this,b=a.series;m(b,function(a){a.linkedSeries.length=0});m(b,function(b){var c=b.options.linkedTo;J(c)&&(c=":previous"===c?a.series[b.index-1]:a.get(c))&&c.linkedParent!==b&&(c.linkedSeries.push(b),b.linkedParent=c,b.visible=q(b.options.visible,c.options.visible,b.visible))})},renderSeries:function(){m(this.series,function(a){a.translate();a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&m(b.items,function(d){var k=c(b.style,d.style),f=A(k.left)+a.plotLeft,e=A(k.top)+a.plotTop+12;delete k.left;delete k.top;a.renderer.text(d.html,f,e).attr({zIndex:2}).css(k).add()})},render:function(){var a=this.axes,b=this.renderer,c=this.options,d,k,f;this.setTitle();this.legend=new t(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();c=this.plotWidth;d=this.plotHeight=Math.max(this.plotHeight-21,0);m(a,function(a){a.setScale()});this.getAxisMargins();k=1.1<c/this.plotWidth;f=1.05<d/this.plotHeight;if(k||f){m(a,function(a){(a.horiz&&k||!a.horiz&&f)&&a.setTickInterval(!0)}),this.getMargins()}this.drawChartBox();this.hasCartesianSeries&&m(a,function(a){a.visible&&a.render()});this.seriesGroup||(this.seriesGroup=b.g("series-group").attr({zIndex:3}).add());this.renderSeries();this.renderLabels();this.addCredits();this.setResponsive&&this.setResponsive();this.hasRendered=!0},addCredits:function(a){var b=this;a=x(!0,this.options.credits,a);a.enabled&&!this.credits&&(this.credits=this.renderer.text(a.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){a.href&&(M.location.href=a.href)}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position),this.credits.update=function(a){b.credits=b.credits.destroy();b.addCredits(a)})},destroy:function(){var c=this,d=c.axes,k=c.series,f=c.container,e,q=f&&f.parentNode;b(c,"destroy");c.renderer.forExport?a.erase(v,c):v[c.index]=void 0;a.chartCount--;c.renderTo.removeAttribute("data-highcharts-chart");E(c);for(e=d.length;e--;){d[e]=d[e].destroy()}this.scroller&&this.scroller.destroy&&this.scroller.destroy();for(e=k.length;e--;){k[e]=k[e].destroy()}m("title subtitle chartBackground plotBackground plotBGImage plotBorder seriesGroup clipRect credits pointer rangeSelector legend resetZoomButton tooltip renderer".split(" "),function(a){var b=c[a];b&&b.destroy&&(c[a]=b.destroy())});f&&(f.innerHTML="",E(f),q&&w(f));C(c,function(a,b){delete c[b]})},isReadyToRender:function(){var a=this;return u||M!=M.top||"complete"===g.readyState?!0:(g.attachEvent("onreadystatechange",function(){g.detachEvent("onreadystatechange",a.firstRender);"complete"===g.readyState&&a.firstRender()}),!1)},firstRender:function(){var a=this,c=a.options;if(a.isReadyToRender()){a.getContainer();b(a,"init");a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();m(c.series||[],function(b){a.initSeries(b)});a.linkSeries();b(a,"beforeRender");L&&(a.pointer=new L(a,c));a.render();if(!a.renderer.imgCount&&a.onload){a.onload()}a.temporaryDisplay(!0)}},onload:function(){m([this.callback].concat(this.callbacks),function(a){a&&void 0!==this.index&&a.apply(this,[this])},this);b(this,"load");b(this,"render");h(this.index)&&!1!==this.options.chart.reflow&&this.initReflow();this.onload=null}})})(N);(function(a){var D,B=a.each,G=a.extend,p=a.erase,g=a.fireEvent,l=a.format,r=a.isArray,n=a.isNumber,w=a.pick,v=a.removeEvent;a.Point=D=function(){};a.Point.prototype={init:function(a,h,g){this.series=a;this.color=a.color;this.applyOptions(h,g);a.options.colorByPoint?(h=a.options.colors||a.chart.options.colors,this.color=this.color||h[a.colorCounter],h=h.length,g=a.colorCounter,a.colorCounter++,a.colorCounter===h&&(a.colorCounter=0)):g=a.colorIndex;this.colorIndex=w(this.colorIndex,g);a.chart.pointCount++;return this},applyOptions:function(a,h){var e=this.series,c=e.options.pointValKey||e.pointValKey;a=D.prototype.optionsToObject.call(this,a);G(this,a);this.options=this.options?G(this.options,a):a;a.group&&delete this.group;c&&(this.y=this[c]);this.isNull=w(this.isValid&&!this.isValid(),null===this.x||!n(this.y,!0));this.selected&&(this.state="select");"name"in this&&void 0===h&&e.xAxis&&e.xAxis.hasNames&&(this.x=e.xAxis.nameToX(this));void 0===this.x&&e&&(this.x=void 0===h?e.autoIncrement(this):h);return this},optionsToObject:function(a){var e={},g=this.series,c=g.options.keys,f=c||g.pointArrayMap||["y"],b=f.length,d=0,l=0;if(n(a)||null===a){e[f[0]]=a}else if(r(a)){for(!c&&a.length>b&&(g=typeof a[0],"string"===g?e.name=a[0]:"number"===g&&(e.x=a[0]),d++);l<b;){c&&void 0===a[d]||(e[f[l]]=a[d]),d++,l++}}else{"object"===typeof a&&(e=a,a.dataLabels&&(g._hasPointLabels=!0),a.marker&&(g._hasPointMarkers=!0))}return e},getClassName:function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},getZone:function(){var a=this.series,h=a.zones,a=a.zoneAxis||"y",g=0,c;for(c=h[g];this[a]>=c.value;){c=h[++g]}c&&c.color&&!this.options.color&&(this.color=c.color);return c},destroy:function(){var a=this.series.chart,h=a.hoverPoints,g;a.pointCount--;h&&(this.setState(),p(h,this),h.length||(a.hoverPoints=null));if(this===a.hoverPoint){this.onMouseOut()}if(this.graphic||this.dataLabel){v(this),this.destroyElements()}this.legendItem&&a.legend.destroyItem(this);for(g in this){this[g]=null}},destroyElements:function(){for(var a=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],h,g=6;g--;){h=a[g],this[h]&&(this[h]=this[h].destroy())}},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var e=this.series,g=e.tooltipOptions,c=w(g.valueDecimals,""),f=g.valuePrefix||"",b=g.valueSuffix||"";B(e.pointArrayMap||["y"],function(d){d="{point."+d;if(f||b){a=a.replace(d+"}",f+d+"}"+b)}a=a.replace(d+"}",d+":,."+c+"f}")});return l(a,{point:this,series:this.series})},firePointEvent:function(a,h,m){var c=this,f=this.series.options;(f.point.events[a]||c.options&&c.options.events&&c.options.events[a])&&this.importEvents();"click"===a&&f.allowPointSelect&&(m=function(a){c.select&&c.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});g(this,a,h,m)},visible:!0}})(N);(function(a){var D=a.addEvent,B=a.animObject,G=a.arrayMax,p=a.arrayMin,g=a.correctFloat,l=a.Date,r=a.defaultOptions,n=a.defaultPlotOptions,w=a.defined,v=a.each,e=a.erase,h=a.extend,m=a.fireEvent,c=a.grep,f=a.isArray,b=a.isNumber,d=a.isString,y=a.merge,H=a.objectEach,J=a.pick,t=a.removeEvent,K=a.splat,x=a.SVGElement,C=a.syncTimeout,L=a.win;a.Series=a.seriesType("line",null,{lineWidth:2,allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{lineWidth:0,lineColor:"#ffffff",radius:4,states:{hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return null===this.y?"":a.numberFormat(this.y,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},{isCartesian:!0,pointClass:a.Point,sorted:!0,requireSorting:!0,directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],coll:"series",init:function(a,b){var c=this,d,k=a.series,f;c.chart=a;c.options=b=c.setOptions(b);c.linkedSeries=[];c.bindAxes();h(c,{name:b.name,state:"",visible:!1!==b.visible,selected:!0===b.selected});d=b.events;H(d,function(a,b){D(c,b,a)});if(d&&d.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect){a.runTrackerClick=!0}c.getColor();c.getSymbol();v(c.parallelArrays,function(a){c[a+"Data"]=[]});c.setData(b.data,!1);c.isCartesian&&(a.hasCartesianSeries=!0);k.length&&(f=k[k.length-1]);c._i=J(f&&f._i,-1)+1;a.orderSeries(this.insert(k))},insert:function(a){var c=this.options.index,d;if(b(c)){for(d=a.length;d--;){if(c>=J(a[d].options.index,a[d]._i)){a.splice(d+1,0,this);break}}-1===d&&a.unshift(this);d+=1}else{a.push(this)}return J(d,a.length-1)},bindAxes:function(){var b=this,c=b.options,d=b.chart,f;v(b.axisTypes||[],function(k){v(d[k],function(a){f=a.options;if(c[k]===f.index||void 0!==c[k]&&c[k]===f.id||void 0===c[k]&&0===f.index){b.insert(a.series),b[k]=a,a.isDirty=!0}});b[k]||b.optionalAxis===k||a.error(18,!0)})},updateParallelArrays:function(a,c){var d=a.series,f=arguments,k=b(c)?function(b){var f="y"===b&&d.toYData?d.toYData(a):a[b];d[b+"Data"][c]=f}:function(a){Array.prototype[c].apply(d[a+"Data"],Array.prototype.slice.call(f,2))};v(d.parallelArrays,k)},autoIncrement:function(){var a=this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,b=J(b,a.pointStart,0);this.pointInterval=c=J(this.pointInterval,a.pointInterval,1);d&&(a=new l(b),"day"===d?a=+a[l.hcSetDate](a[l.hcGetDate]()+c):"month"===d?a=+a[l.hcSetMonth](a[l.hcGetMonth]()+c):"year"===d&&(a=+a[l.hcSetFullYear](a[l.hcGetFullYear]()+c)),c=a-b);this.xIncrement=b+c;return b},setOptions:function(a){var b=this.chart,c=b.options,d=c.plotOptions,f=(b.userOptions||{}).plotOptions||{},e=d[this.type];this.userOptions=a;b=y(e,d.series,a);this.tooltipOptions=y(r.tooltip,r.plotOptions.series&&r.plotOptions.series.tooltip,r.plotOptions[this.type].tooltip,c.tooltip.userOptions,d.series&&d.series.tooltip,d[this.type].tooltip,a.tooltip);this.stickyTracking=J(a.stickyTracking,f[this.type]&&f[this.type].stickyTracking,f.series&&f.series.stickyTracking,this.tooltipOptions.shared&&!this.noSharedTooltip?!0:b.stickyTracking);null===e.marker&&delete b.marker;this.zoneAxis=b.zoneAxis;a=this.zones=(b.zones||[]).slice();!b.negativeColor&&!b.negativeFillColor||b.zones||a.push({value:b[this.zoneAxis+"Threshold"]||b.threshold||0,className:"highcharts-negative",color:b.negativeColor,fillColor:b.negativeFillColor});a.length&&w(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});return b},getCyclic:function(a,b,c){var d,f=this.chart,e=this.userOptions,h=a+"Index",q=a+"Counter",g=c?c.length:J(f.options.chart[a+"Count"],f[a+"Count"]);b||(d=J(e[h],e["_"+h]),w(d)||(f.series.length||(f[q]=0),e["_"+h]=d=f[q]%g,f[q]+=1),c&&(b=c[d]));void 0!==d&&(this[h]=d);this[a]=b},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||n[this.type].color,this.chart.options.colors)},getSymbol:function(){this.getCyclic("symbol",this.options.marker.symbol,this.chart.options.symbols)},drawLegendSymbol:a.LegendSymbolMixin.drawLineMarker,setData:function(c,e,h,g){var k=this,q=k.points,m=q&&q.length||0,l,t=k.options,A=k.chart,n=null,x=k.xAxis,E=t.turboThreshold,y=this.xData,p=this.yData,r=(l=k.pointArrayMap)&&l.length;c=c||[];l=c.length;e=J(e,!0);if(!1!==g&&l&&m===l&&!k.cropped&&!k.hasGroupedData&&k.visible){v(c,function(a,b){q[b].update&&a!==t.data[b]&&q[b].update(a,!1,null,!1)})}else{k.xIncrement=null;k.colorCounter=0;v(this.parallelArrays,function(a){k[a+"Data"].length=0});if(E&&l>E){for(h=0;null===n&&h<l;){n=c[h],h++}if(b(n)){for(h=0;h<l;h++){y[h]=this.autoIncrement(),p[h]=c[h]}}else if(f(n)){if(r){for(h=0;h<l;h++){n=c[h],y[h]=n[0],p[h]=n.slice(1,r+1)}}else{for(h=0;h<l;h++){n=c[h],y[h]=n[0],p[h]=n[1]}}}else{a.error(12)}}else{for(h=0;h<l;h++){void 0!==c[h]&&(n={series:k},k.pointClass.prototype.applyOptions.apply(n,[c[h]]),k.updateParallelArrays(n,h))}}p&&d(p[0])&&a.error(14,!0);k.data=[];k.options.data=k.userOptions.data=c;for(h=m;h--;){q[h]&&q[h].destroy&&q[h].destroy()}x&&(x.minRange=x.userMinRange);k.isDirty=A.isDirtyBox=!0;k.isDirtyData=!!q;h=!1}"point"===t.legendType&&(this.processData(),this.generatePoints());e&&A.redraw(h)},processData:function(b){var c=this.xData,d=this.yData,f=c.length,k;k=0;var e,h,q=this.xAxis,g,l=this.options;g=l.cropThreshold;var m=this.getExtremesFromAll||l.getExtremesFromAll,n=this.isCartesian,l=q&&q.val2lin,t=q&&q.isLog,x=this.requireSorting,y,p;if(n&&!this.isDirty&&!q.isDirty&&!this.yAxis.isDirty&&!b){return!1}q&&(b=q.getExtremes(),y=b.min,p=b.max);if(n&&this.sorted&&!m&&(!g||f>g||this.forceCrop)){if(c[f-1]<y||c[0]>p){c=[],d=[]}else if(c[0]<y||c[f-1]>p){k=this.cropData(this.xData,this.yData,y,p),c=k.xData,d=k.yData,k=k.start,e=!0}}for(g=c.length||1;--g;){f=t?l(c[g])-l(c[g-1]):c[g]-c[g-1],0<f&&(void 0===h||f<h)?h=f:0>f&&x&&(a.error(15),x=!1)}this.cropped=e;this.cropStart=k;this.processedXData=c;this.processedYData=d;this.closestPointRange=h},cropData:function(a,b,c,d){var f=a.length,e=0,h=f,g=J(this.cropShoulder,1),q;for(q=0;q<f;q++){if(a[q]>=c){e=Math.max(0,q-g);break}}for(c=q;c<f;c++){if(a[c]>d){h=c+g;break}}return{xData:a.slice(e,h),yData:b.slice(e,h),start:e,end:h}},generatePoints:function(){var a=this.options,b=a.data,c=this.data,d,f=this.processedXData,e=this.processedYData,h=this.pointClass,g=f.length,l=this.cropStart||0,m,n=this.hasGroupedData,a=a.keys,t,x=[],y;c||n||(c=[],c.length=b.length,c=this.data=c);a&&n&&(this.options.keys=!1);for(y=0;y<g;y++){m=l+y,n?(t=(new h).init(this,[f[y]].concat(K(e[y]))),t.dataGroup=this.groupMap[y]):(t=c[m])||void 0===b[m]||(c[m]=t=(new h).init(this,b[m],f[y])),t&&(t.index=m,x[y]=t)}this.options.keys=a;if(c&&(g!==(d=c.length)||n)){for(y=0;y<d;y++){y!==l||n||(y+=g),c[y]&&(c[y].destroyElements(),c[y].plotX=void 0)}}this.data=c;this.points=x},getExtremes:function(a){var c=this.yAxis,d=this.processedXData,e,k=[],h=0;e=this.xAxis.getExtremes();var g=e.min,q=e.max,l,m,n,t;a=a||this.stackedYData||this.processedYData||[];e=a.length;for(t=0;t<e;t++){if(m=d[t],n=a[t],l=(b(n,!0)||f(n))&&(!c.positiveValuesOnly||n.length||0<n),m=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(d[t+1]||m)>=g&&(d[t-1]||m)<=q,l&&m){if(l=n.length){for(;l--;){null!==n[l]&&(k[h++]=n[l])}}else{k[h++]=n}}}this.dataMin=p(k);this.dataMax=G(k)},translate:function(){this.processedXData||this.processData();this.generatePoints();var a=this.options,c=a.stacking,d=this.xAxis,f=d.categories,k=this.yAxis,e=this.points,h=e.length,l=!!this.modifyValue,m=a.pointPlacement,n="between"===m||b(m),t=a.threshold,x=a.startFromThreshold?t:0,y,p,r,C,v=Number.MAX_VALUE;"between"===m&&(m=.5);b(m)&&(m*=J(a.pointRange||d.pointRange));for(a=0;a<h;a++){var K=e[a],H=K.x,L=K.y;p=K.low;var B=c&&k.stacks[(this.negStacks&&L<(x?0:t)?"-":"")+this.stackKey],D;k.positiveValuesOnly&&null!==L&&0>=L&&(K.isNull=!0);K.plotX=y=g(Math.min(Math.max(-1e5,d.translate(H,0,0,0,1,m,"flags"===this.type)),1e5));c&&this.visible&&!K.isNull&&B&&B[H]&&(C=this.getStackIndicator(C,H,this.index),D=B[H],L=D.points[C.key],p=L[0],L=L[1],p===x&&C.key===B[H].base&&(p=J(t,k.min)),k.positiveValuesOnly&&0>=p&&(p=null),K.total=K.stackTotal=D.total,K.percentage=D.total&&K.y/D.total*100,K.stackY=L,D.setOffset(this.pointXOffset||0,this.barW||0));K.yBottom=w(p)?k.translate(p,0,1,0,1):null;l&&(L=this.modifyValue(L,K));K.plotY=p="number"===typeof L&&Infinity!==L?Math.min(Math.max(-1e5,k.translate(L,0,1,0,1)),1e5):void 0;K.isInside=void 0!==p&&0<=p&&p<=k.len&&0<=y&&y<=d.len;K.clientX=n?g(d.translate(H,0,0,0,1,m)):y;K.negative=K.y<(t||0);K.category=f&&void 0!==f[K.x]?f[K.x]:K.x;K.isNull||(void 0!==r&&(v=Math.min(v,Math.abs(y-r))),r=y);K.zone=this.zones.length&&K.getZone()}this.closestPointRangePx=v},getValidPoints:function(a,b){var d=this.chart;return c(a||this.points||[],function(a){return b&&!d.isInsidePlot(a.plotX,a.plotY,d.inverted)?!1:!a.isNull})},setClip:function(a){var b=this.chart,c=this.options,d=b.renderer,f=b.inverted,e=this.clipBox,h=e||b.clipBox,g=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,h.height,c.xAxis,c.yAxis].join(),q=b[g],m=b[g+"m"];q||(a&&(h.width=0,f&&(h.x=b.plotSizeX),b[g+"m"]=m=d.clipRect(f?b.plotSizeX+99:-99,f?-b.plotLeft:-b.plotTop,99,f?b.chartWidth:b.chartHeight)),b[g]=q=d.clipRect(h),q.count={length:0});a&&!q.count[this.index]&&(q.count[this.index]=!0,q.count.length+=1);!1!==c.clip&&(this.group.clip(a||e?q:b.clipRect),this.markerGroup.clip(m),this.sharedClipKey=g);a||(q.count[this.index]&&(delete q.count[this.index],--q.count.length),0===q.count.length&&g&&b[g]&&(e||(b[g]=b[g].destroy()),b[g+"m"]&&(b[g+"m"]=b[g+"m"].destroy())))},animate:function(a){var b=this.chart,c=B(this.options.animation),d;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX,x:0},c),b[d+"m"]&&b[d+"m"].animate({width:b.plotSizeX+99,x:0},c),this.animate=null)},afterAnimate:function(){this.setClip();m(this,"afterAnimate");this.finishedAnimating=!0},drawPoints:function(){var a=this.points,b=this.chart,c,d,f,e,h=this.options.marker,g,m,l,n=this[this.specialGroup]||this.markerGroup,t,x=J(h.enabled,this.xAxis.isRadial?!0:null,this.closestPointRangePx>=2*h.radius);if(!1!==h.enabled||this._hasPointMarkers){for(c=0;c<a.length;c++){d=a[c],e=d.graphic,g=d.marker||{},m=!!d.marker,f=x&&void 0===g.enabled||g.enabled,l=d.isInside,f&&!d.isNull?(f=J(g.symbol,this.symbol),d.hasImage=0===f.indexOf("url"),t=this.markerAttribs(d,d.selected&&"select"),e?e[l?"show":"hide"](!0).animate(t):l&&(0<t.width||d.hasImage)&&(d.graphic=e=b.renderer.symbol(f,t.x,t.y,t.width,t.height,m?g:h).add(n)),e&&e.attr(this.pointAttribs(d,d.selected&&"select")),e&&e.addClass(d.getClassName(),!0)):e&&(d.graphic=e.destroy())}}},markerAttribs:function(a,b){var c=this.options.marker,d=a.marker||{},f=J(d.radius,c.radius);b&&(c=c.states[b],b=d.states&&d.states[b],f=J(b&&b.radius,c&&c.radius,f+(c&&c.radiusPlus||0)));a.hasImage&&(f=0);a={x:Math.floor(a.plotX)-f,y:a.plotY-f};f&&(a.width=a.height=2*f);return a},pointAttribs:function(a,b){var c=this.options.marker,d=a&&a.options,f=d&&d.marker||{},e=this.color,h=d&&d.color,g=a&&a.color,d=J(f.lineWidth,c.lineWidth);a=a&&a.zone&&a.zone.color;e=h||a||g||e;a=f.fillColor||c.fillColor||e;e=f.lineColor||c.lineColor||e;b&&(c=c.states[b],b=f.states&&f.states[b]||{},d=J(b.lineWidth,c.lineWidth,d+J(b.lineWidthPlus,c.lineWidthPlus,0)),a=b.fillColor||c.fillColor||a,e=b.lineColor||c.lineColor||e);return{stroke:e,"stroke-width":d,fill:a}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(L.navigator.userAgent),d,f,h=a.data||[],g,l;m(a,"destroy");t(a);v(a.axisTypes||[],function(b){(l=a[b])&&l.series&&(e(l.series,a),l.isDirty=l.forceRedraw=!0)});a.legendItem&&a.chart.legend.destroyItem(a);for(f=h.length;f--;){(g=h[f])&&g.destroy&&g.destroy()}a.points=null;clearTimeout(a.animationTimeout);H(a,function(a,b){a instanceof x&&!a.survive&&(d=c&&"group"===b?"hide":"destroy",a[d]())});b.hoverSeries===a&&(b.hoverSeries=null);e(b.series,a);b.orderSeries();H(a,function(b,c){delete a[c]})},getGraphPath:function(a,b,c){var d=this,f=d.options,e=f.step,h,g=[],m=[],l;a=a||d.points;(h=a.reversed)&&a.reverse();(e={right:1,center:2}[e]||e&&3)&&h&&(e=4-e);!f.connectNulls||b||c||(a=this.getValidPoints(a));v(a,function(k,h){var q=k.plotX,t=k.plotY,n=a[h-1];(k.leftCliff||n&&n.rightCliff)&&!c&&(l=!0);k.isNull&&!w(b)&&0<h?l=!f.connectNulls:k.isNull&&!b?l=!0:(0===h||l?h=["M",k.plotX,k.plotY]:d.getPointSpline?h=d.getPointSpline(a,k,h):e?(h=1===e?["L",n.plotX,t]:2===e?["L",(n.plotX+q)/2,n.plotY,"L",(n.plotX+q)/2,t]:["L",q,n.plotY],h.push("L",q,t)):h=["L",q,t],m.push(k.x),e&&m.push(k.x),g.push.apply(g,h),l=!1)});g.xMap=m;return d.graphPath=g},drawGraph:function(){var a=this,b=this.options,c=(this.gappedPath||this.getGraphPath).call(this),d=[["graph","highcharts-graph",b.lineColor||this.color,b.dashStyle]];v(this.zones,function(c,f){d.push(["zone-graph-"+f,"highcharts-graph highcharts-zone-graph-"+f+" "+(c.className||""),c.color||a.color,c.dashStyle||b.dashStyle])});v(d,function(d,f){var e=d[0],k=a[e];k?(k.endX=a.preventGraphAnimation?null:c.xMap,k.animate({d:c})):c.length&&(a[e]=a.chart.renderer.path(c).addClass(d[1]).attr({zIndex:1}).add(a.group),k={stroke:d[2],"stroke-width":b.lineWidth,fill:a.fillGraph&&a.color||"none"},d[3]?k.dashstyle=d[3]:"square"!==b.linecap&&(k["stroke-linecap"]=k["stroke-linejoin"]="round"),k=a[e].attr(k).shadow(2>f&&b.shadow));k&&(k.startX=c.xMap,k.isArea=c.isArea)})},applyZones:function(){var a=this,b=this.chart,c=b.renderer,d=this.zones,f,e,h=this.clips||[],g,l=this.graph,m=this.area,t=Math.max(b.chartWidth,b.chartHeight),n=this[(this.zoneAxis||"y")+"Axis"],x,y,p=b.inverted,r,C,w,K,L=!1;d.length&&(l||m)&&n&&void 0!==n.min&&(y=n.reversed,r=n.horiz,l&&l.hide(),m&&m.hide(),x=n.getExtremes(),v(d,function(d,k){f=y?r?b.plotWidth:0:r?0:n.toPixels(x.min);f=Math.min(Math.max(J(e,f),0),t);e=Math.min(Math.max(Math.round(n.toPixels(J(d.value,x.max),!0)),0),t);L&&(f=e=n.toPixels(x.max));C=Math.abs(f-e);w=Math.min(f,e);K=Math.max(f,e);n.isXAxis?(g={x:p?K:w,y:0,width:C,height:t},r||(g.x=b.plotHeight-g.x)):(g={x:0,y:p?K:w,width:t,height:C},r&&(g.y=b.plotWidth-g.y));p&&c.isVML&&(g=n.isXAxis?{x:0,y:y?w:K,height:g.width,width:b.chartWidth}:{x:g.y-b.plotLeft-b.spacingBox.x,y:0,width:g.height,height:b.chartHeight});h[k]?h[k].animate(g):(h[k]=c.clipRect(g),l&&a["zone-graph-"+k].clip(h[k]),m&&a["zone-area-"+k].clip(h[k]));L=d.value>x.max}),this.clips=h)},invertGroups:function(a){function b(){v(["group","markerGroup"],function(b){c[b]&&(d.renderer.isVML&&c[b].attr({width:c.yAxis.len,height:c.xAxis.len}),c[b].width=c.yAxis.len,c[b].height=c.xAxis.len,c[b].invert(a))})}var c=this,d=c.chart,f;c.xAxis&&(f=D(d,"resize",b),D(c,"destroy",f),b(a),c.invertGroups=b)},plotGroup:function(a,b,c,d,f){var e=this[a],k=!e;k&&(this[a]=e=this.chart.renderer.g().attr({zIndex:d||.1}).add(f));e.addClass("highcharts-"+b+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(w(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(e.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0);e.attr({visibility:c})[k?"attr":"animate"](this.getPlotBox());return e},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;a.inverted&&(b=c,c=this.xAxis);return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,d=a.options,f=!!a.animate&&b.renderer.isSVG&&B(d.animation).duration,e=a.visible?"inherit":"hidden",h=d.zIndex,g=a.hasRendered,l=b.seriesGroup,m=b.inverted;c=a.plotGroup("group","series",e,h,l);a.markerGroup=a.plotGroup("markerGroup","markers",e,h,l);f&&a.animate(!0);c.inverted=a.isCartesian?m:!1;a.drawGraph&&(a.drawGraph(),a.applyZones());a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&!1!==a.options.enableMouseTracking&&a.drawTracker();a.invertGroups(m);!1===d.clip||a.sharedClipKey||g||c.clip(b.clipRect);f&&a.animate();g||(a.animationTimeout=C(function(){a.afterAnimate()},f));a.isDirty=!1;a.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirty||this.isDirtyData,c=this.group,d=this.xAxis,f=this.yAxis;c&&(a.inverted&&c.attr({width:a.plotWidth,height:a.plotHeight}),c.animate({translateX:J(d&&d.left,a.plotLeft),translateY:J(f&&f.top,a.plotTop)}));this.translate();this.render();b&&delete this.kdTree},kdAxisArray:["clientX","plotY"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,f=this.chart.inverted;return this.searchKDTree({clientX:f?c.len-a.chartY+c.pos:a.chartX-c.pos,plotY:f?d.len-a.chartX+d.pos:a.chartY-d.pos},b)},buildKDTree:function(){function a(c,d,f){var e,k;if(k=c&&c.length){return e=b.kdAxisArray[d%f],c.sort(function(a,b){return a[e]-b[e]}),k=Math.floor(k/2),{point:c[k],left:a(c.slice(0,k),d+1,f),right:a(c.slice(k+1),d+1,f)}}}this.buildingKdTree=!0;var b=this,c=-1<b.options.findNearestPointBy.indexOf("y")?2:1;delete b.kdTree;C(function(){b.kdTree=a(b.getValidPoints(null,!b.directTouch),c,c);b.buildingKdTree=!1},b.options.kdNow?0:1)},searchKDTree:function(a,b){function c(a,b,k,g){var l=b.point,m=d.kdAxisArray[k%g],q,n,t=l;n=w(a[f])&&w(l[f])?Math.pow(a[f]-l[f],2):null;q=w(a[e])&&w(l[e])?Math.pow(a[e]-l[e],2):null;q=(n||0)+(q||0);l.dist=w(q)?Math.sqrt(q):Number.MAX_VALUE;l.distX=w(n)?Math.sqrt(n):Number.MAX_VALUE;m=a[m]-l[m];q=0>m?"left":"right";n=0>m?"right":"left";b[q]&&(q=c(a,b[q],k+1,g),t=q[h]<t[h]?q:l);b[n]&&Math.sqrt(m*m)<t[h]&&(a=c(a,b[n],k+1,g),t=a[h]<t[h]?a:t);return t}var d=this,f=this.kdAxisArray[0],e=this.kdAxisArray[1],h=b?"distX":"dist";b=-1<d.options.findNearestPointBy.indexOf("y")?2:1;this.kdTree||this.buildingKdTree||this.buildKDTree();if(this.kdTree){return c(a,this.kdTree,b,b)}}})})(N);(function(a){var D=a.Axis,B=a.Chart,G=a.correctFloat,p=a.defined,g=a.destroyObjectProperties,l=a.each,r=a.format,n=a.objectEach,w=a.pick,v=a.Series;a.StackItem=function(a,h,g,c,f){var b=a.chart.inverted;this.axis=a;this.isNegative=g;this.options=h;this.x=c;this.total=null;this.points={};this.stack=f;this.rightCliff=this.leftCliff=0;this.alignOptions={align:h.align||(b?g?"left":"right":"center"),verticalAlign:h.verticalAlign||(b?"middle":g?"bottom":"top"),y:w(h.y,b?4:g?14:-6),x:w(h.x,b?g?-6:6:0)};this.textAlign=h.textAlign||(b?g?"right":"left":"center")};a.StackItem.prototype={destroy:function(){g(this,this.axis)},render:function(a){var e=this.options,g=e.format,g=g?r(g,this):e.formatter.call(this);this.label?this.label.attr({text:g,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(g,null,null,e.useHTML).css(e.style).attr({align:this.textAlign,rotation:e.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,h){var e=this.axis,c=e.chart,f=e.translate(e.usePercentage?100:this.total,0,0,0,1),e=e.translate(0),e=Math.abs(f-e);a=c.xAxis[0].translate(this.x)+a;f=this.getStackBox(c,this,a,f,h,e);if(h=this.label){h.align(this.alignOptions,null,f),f=h.alignAttr,h[!1===this.options.crop||c.isInsidePlot(f.x,f.y)?"show":"hide"](!0)}},getStackBox:function(a,h,g,c,f,b){var d=h.axis.reversed,e=a.inverted;a=a.plotHeight;h=h.isNegative&&!d||!h.isNegative&&d;return{x:e?h?c:c-b:g,y:e?a-g-f:h?a-c-b:a-c,width:e?b:f,height:e?f:b}}};B.prototype.getStacks=function(){var a=this;l(a.yAxis,function(a){a.stacks&&a.hasVisibleSeries&&(a.oldStacks=a.stacks)});l(a.series,function(e){!e.options.stacking||!0!==e.visible&&!1!==a.options.chart.ignoreHiddenSeries||(e.stackKey=e.type+w(e.options.stack,""))})};D.prototype.buildStacks=function(){var a=this.series,h=w(this.options.reversedStacks,!0),g=a.length,c;if(!this.isXAxis){this.usePercentage=!1;for(c=g;c--;){a[h?c:g-c-1].setStackedPoints()}for(c=0;c<g;c++){a[c].modifyStacks()}}};D.prototype.renderStackTotals=function(){var a=this.chart,h=a.renderer,g=this.stacks,c=this.stackTotalGroup;c||(this.stackTotalGroup=c=h.g("stack-labels").attr({visibility:"visible",zIndex:6}).add());c.translate(a.plotLeft,a.plotTop);n(g,function(a){n(a,function(a){a.render(c)})})};D.prototype.resetStacks=function(){var a=this,h=a.stacks;a.isXAxis||n(h,function(e){n(e,function(c,f){c.touched<a.stacksTouched?(c.destroy(),delete e[f]):(c.total=null,c.cum=null)})})};D.prototype.cleanStacks=function(){var a;this.isXAxis||(this.oldStacks&&(a=this.stacks=this.oldStacks),n(a,function(a){n(a,function(a){a.cum=a.total})}))};v.prototype.setStackedPoints=function(){if(this.options.stacking&&(!0===this.visible||!1===this.chart.options.chart.ignoreHiddenSeries)){var e=this.processedXData,h=this.processedYData,g=[],c=h.length,f=this.options,b=f.threshold,d=f.startFromThreshold?b:0,l=f.stack,f=f.stacking,n=this.stackKey,r="-"+n,t=this.negStacks,v=this.yAxis,x=v.stacks,C=v.oldStacks,L,q,A,E,F,k,u;v.stacksTouched+=1;for(F=0;F<c;F++){k=e[F],u=h[F],L=this.getStackIndicator(L,k,this.index),E=L.key,A=(q=t&&u<(d?0:b))?r:n,x[A]||(x[A]={}),x[A][k]||(C[A]&&C[A][k]?(x[A][k]=C[A][k],x[A][k].total=null):x[A][k]=new a.StackItem(v,v.options.stackLabels,q,k,l)),A=x[A][k],null!==u&&(A.points[E]=A.points[this.index]=[w(A.cum,d)],p(A.cum)||(A.base=E),A.touched=v.stacksTouched,0<L.index&&!1===this.singleStacks&&(A.points[E][0]=A.points[this.index+","+k+",0"][0])),"percent"===f?(q=q?n:r,t&&x[q]&&x[q][k]?(q=x[q][k],A.total=q.total=Math.max(q.total,A.total)+Math.abs(u)||0):A.total=G(A.total+(Math.abs(u)||0))):A.total=G(A.total+(u||0)),A.cum=w(A.cum,d)+(u||0),null!==u&&(A.points[E].push(A.cum),g[F]=A.cum)}"percent"===f&&(v.usePercentage=!0);this.stackedYData=g;v.oldStacks={}}};v.prototype.modifyStacks=function(){var a=this,h=a.stackKey,g=a.yAxis.stacks,c=a.processedXData,f,b=a.options.stacking;a[b+"Stacker"]&&l([h,"-"+h],function(d){for(var e=c.length,h,l;e--;){if(h=c[e],f=a.getStackIndicator(f,h,a.index,d),l=(h=g[d]&&g[d][h])&&h.points[f.key]){a[b+"Stacker"](l,h,e)}}})};v.prototype.percentStacker=function(a,h,g){h=h.total?100/h.total:0;a[0]=G(a[0]*h);a[1]=G(a[1]*h);this.stackedYData[g]=a[1]};v.prototype.getStackIndicator=function(a,h,g,c){!p(a)||a.x!==h||c&&a.key!==c?a={x:h,index:0,key:c}:a.index++;a.key=[g,h,a.index].join();return a}})(N);(function(a){var D=a.addEvent,B=a.animate,G=a.Axis,p=a.createElement,g=a.css,l=a.defined,r=a.each,n=a.erase,w=a.extend,v=a.fireEvent,e=a.inArray,h=a.isNumber,m=a.isObject,c=a.isArray,f=a.merge,b=a.objectEach,d=a.pick,y=a.Point,H=a.Series,J=a.seriesTypes,t=a.setAnimation,K=a.splat;w(a.Chart.prototype,{addSeries:function(a,b,c){var f,e=this;a&&(b=d(b,!0),v(e,"addSeries",{options:a},function(){f=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c)}));return f},addAxis:function(a,b,c,e){var h=b?"xAxis":"yAxis",g=this.options;a=f(a,{index:this[h].length,isX:b});b=new G(this,a);g[h]=K(g[h]||{});g[h].push(a);d(c,!0)&&this.redraw(e);return b},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,f=c.loading,e=function(){d&&g(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};d||(b.loadingDiv=d=p("div",{className:"highcharts-loading highcharts-loading-hidden"},null,b.container),b.loadingSpan=p("span",{className:"highcharts-loading-inner"},null,d),D(b,"redraw",e));d.className="highcharts-loading";b.loadingSpan.innerHTML=a||c.lang.loading;g(d,w(f.style,{zIndex:10}));g(b.loadingSpan,f.labelStyle);b.loadingShown||(g(d,{opacity:0,display:""}),B(d,{opacity:f.style.opacity||.5},{duration:f.showDuration||0}));b.loadingShown=!0;e()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&(b.className="highcharts-loading highcharts-loading-hidden",B(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){g(b,{display:"none"})}}));this.loadingShown=!1},propsRequireDirtyBox:"backgroundColor borderColor borderWidth margin marginTop marginRight marginBottom marginLeft spacing spacingTop spacingRight spacingBottom spacingLeft borderRadius plotBackgroundColor plotBackgroundImage plotBorderColor plotBorderWidth plotShadow shadow".split(" "),propsRequireUpdateSeries:"chart.inverted chart.polar chart.ignoreHiddenSeries chart.type colors plotOptions tooltip".split(" "),update:function(a,c,g){var m=this,n={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle"},t=a.chart,x,k,y=[];if(t){f(!0,m.options.chart,t);"className"in t&&m.setClassName(t.className);if("inverted"in t||"polar"in t){m.propFromSeries(),x=!0}"alignTicks"in t&&(x=!0);b(t,function(a,b){-1!==e("chart."+b,m.propsRequireUpdateSeries)&&(k=!0);-1!==e(b,m.propsRequireDirtyBox)&&(m.isDirtyBox=!0)});"style"in t&&m.renderer.setStyle(t.style)}a.colors&&(this.options.colors=a.colors);a.plotOptions&&f(!0,this.options.plotOptions,a.plotOptions);b(a,function(a,b){if(m[b]&&"function"===typeof m[b].update){m[b].update(a,!1)}else if("function"===typeof m[n[b]]){m[n[b]](a)}"chart"!==b&&-1!==e(b,m.propsRequireUpdateSeries)&&(k=!0)});r("xAxis yAxis zAxis series colorAxis pane".split(" "),function(b){a[b]&&(r(K(a[b]),function(a,c){(c=l(a.id)&&m.get(a.id)||m[b][c])&&c.coll===b&&(c.update(a,!1),g&&(c.touched=!0));if(!c&&g){if("series"===b){m.addSeries(a,!1).touched=!0}else if("xAxis"===b||"yAxis"===b){m.addAxis(a,"xAxis"===b,!1).touched=!0}}}),g&&r(m[b],function(a){a.touched?delete a.touched:y.push(a)}))});r(y,function(a){a.remove(!1)});x&&r(m.axes,function(a){a.update({},!1)});k&&r(m.series,function(a){a.update({},!1)});a.loading&&f(!0,m.options.loading,a.loading);x=t&&t.width;t=t&&t.height;h(x)&&x!==m.chartWidth||h(t)&&t!==m.chartHeight?m.setSize(x,t):d(c,!0)&&m.redraw()},setSubtitle:function(a){this.setTitle(void 0,a)}});w(y.prototype,{update:function(a,b,c,f){function e(){h.applyOptions(a);null===h.y&&k&&(h.graphic=k.destroy());m(a,!0)&&(k&&k.element&&a&&a.marker&&void 0!==a.marker.symbol&&(h.graphic=k.destroy()),a&&a.dataLabels&&h.dataLabel&&(h.dataLabel=h.dataLabel.destroy()),h.connector&&(h.connector=h.connector.destroy()));l=h.index;g.updateParallelArrays(h,l);n.data[l]=m(n.data[l],!0)||m(a,!0)?h.options:a;g.isDirty=g.isDirtyData=!0;!g.fixedBox&&g.hasCartesianSeries&&(t.isDirtyBox=!0);"point"===n.legendType&&(t.isDirtyLegend=!0);b&&t.redraw(c)}var h=this,g=h.series,k=h.graphic,l,t=g.chart,n=g.options;b=d(b,!0);!1===f?e():h.firePointEvent("update",{options:a},e)},remove:function(a,b){this.series.removePoint(e(this,this.series.data),a,b)}});w(H.prototype,{addPoint:function(a,b,c,f){var e=this.options,h=this.data,g=this.chart,k=this.xAxis,k=k&&k.hasNames&&k.names,l=e.data,m,t,n=this.xData,q,x;b=d(b,!0);m={series:this};this.pointClass.prototype.applyOptions.apply(m,[a]);x=m.x;q=n.length;if(this.requireSorting&&x<n[q-1]){for(t=!0;q&&n[q-1]>x;){q--}}this.updateParallelArrays(m,"splice",q,0,0);this.updateParallelArrays(m,q);k&&m.name&&(k[x]=m.name);l.splice(q,0,a);t&&(this.data.splice(q,0,null),this.processData());"point"===e.legendType&&this.generatePoints();c&&(h[0]&&h[0].remove?h[0].remove(!1):(h.shift(),this.updateParallelArrays(m,"shift"),l.shift()));this.isDirtyData=this.isDirty=!0;b&&g.redraw(f)},removePoint:function(a,b,c){var f=this,e=f.data,h=e[a],g=f.points,k=f.chart,l=function(){g&&g.length===e.length&&g.splice(a,1);e.splice(a,1);f.options.data.splice(a,1);f.updateParallelArrays(h||{series:f},"splice",a,1);h&&h.destroy();f.isDirty=!0;f.isDirtyData=!0;b&&k.redraw()};t(c,k);b=d(b,!0);h?h.firePointEvent("remove",null,l):l()},remove:function(a,b,c){function f(){e.destroy();h.isDirtyLegend=h.isDirtyBox=!0;h.linkSeries();d(a,!0)&&h.redraw(b)}var e=this,h=e.chart;!1!==c?v(e,"remove",null,f):f()},update:function(a,b){var c=this,e=c.chart,h=c.userOptions,g=c.oldType||c.type,l=a.type||h.type||e.options.chart.type,k=J[g].prototype,m,t=["group","markerGroup","dataLabelsGroup"],n=["navigatorSeries","baseSeries"],y=c.finishedAnimating&&{animation:!1};if(Object.keys&&"data"===Object.keys(a).toString()){return this.setData(a.data,b)}if(l&&l!==g||void 0!==a.zIndex){t.length=0}n=t.concat(n);r(n,function(a){n[a]=c[a];delete c[a]});a=f(h,y,{index:c.index,pointStart:c.xData[0]},{data:c.options.data},a);c.remove(!1,null,!1);for(m in k){c[m]=void 0}w(c,J[l||g].prototype);r(n,function(a){c[a]=n[a]});c.init(e,a);c.oldType=g;e.linkSeries();d(b,!0)&&e.redraw(!1)}});w(G.prototype,{update:function(a,b){var c=this.chart;a=c.options[this.coll][this.options.index]=f(this.userOptions,a);this.destroy(!0);this.init(c,w(a,{events:void 0}));c.isDirtyBox=!0;d(b,!0)&&c.redraw()},remove:function(a){for(var b=this.chart,f=this.coll,e=this.series,h=e.length;h--;){e[h]&&e[h].remove(!1)}n(b.axes,this);n(b[f],this);c(b.options[f])?b.options[f].splice(this.options.index,1):delete b.options[f];r(b[f],function(a,b){a.options.index=b});this.destroy();b.isDirtyBox=!0;d(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}})})(N);(function(a){var D=a.color,B=a.each,G=a.map,p=a.pick,g=a.Series,l=a.seriesType;l("area","line",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(g){var l=[],r=[],v=this.xAxis,e=this.yAxis,h=e.stacks[this.stackKey],m={},c=this.index,f=e.series,b=f.length,d,y=p(e.options.reversedStacks,!0)?1:-1,H;g=g||this.points;if(this.options.stacking){for(H=0;H<g.length;H++){g[H].leftNull=g[H].rightNull=null,m[g[H].x]=g[H]}a.objectEach(h,function(a,b){null!==a.total&&r.push(b)});r.sort(function(a,b){return a-b});d=G(f,function(){return this.visible});B(r,function(a,f){var g=0,n,t;if(m[a]&&!m[a].isNull){l.push(m[a]),B([-1,1],function(e){var g=1===e?"rightNull":"leftNull",l=0,p=h[r[f+e]];if(p){for(H=c;0<=H&&H<b;){n=p.points[H],n||(H===c?m[a][g]=!0:d[H]&&(t=h[a].points[H])&&(l-=t[1]-t[0])),H+=y}}m[a][1===e?"rightCliff":"leftCliff"]=l})}else{for(H=c;0<=H&&H<b;){if(n=h[a].points[H]){g=n[1];break}H+=y}g=e.translate(g,0,1,0,1);l.push({isNull:!0,plotX:v.translate(a,0,0,0,1),x:a,plotY:g,yBottom:g})}})}return l},getGraphPath:function(a){var l=g.prototype.getGraphPath,r=this.options,v=r.stacking,e=this.yAxis,h,m,c=[],f=[],b=this.index,d,y=e.stacks[this.stackKey],H=r.threshold,J=e.getThreshold(r.threshold),t,r=r.connectNulls||"percent"===v,K=function(h,g,l){var m=a[h];h=v&&y[m.x].points[b];var t=m[l+"Null"]||0;l=m[l+"Cliff"]||0;var n,p,m=!0;l||t?(n=(t?h[0]:h[1])+l,p=h[0]+l,m=!!t):!v&&a[g]&&a[g].isNull&&(n=p=H);void 0!==n&&(f.push({plotX:d,plotY:null===n?J:e.getThreshold(n),isNull:m,isCliff:!0}),c.push({plotX:d,plotY:null===p?J:e.getThreshold(p),doCurve:!1}))};a=a||this.points;v&&(a=this.getStackPoints(a));for(h=0;h<a.length;h++){if(m=a[h].isNull,d=p(a[h].rectPlotX,a[h].plotX),t=p(a[h].yBottom,J),!m||r){r||K(h,h-1,"left"),m&&!v&&r||(f.push(a[h]),c.push({x:h,plotX:d,plotY:t})),r||K(h,h+1,"right")}}h=l.call(this,f,!0,!0);c.reversed=!0;m=l.call(this,c,!0,!0);m.length&&(m[0]="L");m=h.concat(m);l=l.call(this,f,!1,r);m.xMap=h.xMap;this.areaPath=m;return l},drawGraph:function(){this.areaPath=[];g.prototype.drawGraph.apply(this);var a=this,l=this.areaPath,w=this.options,v=[["area","highcharts-area",this.color,w.fillColor]];B(this.zones,function(e,h){v.push(["zone-area-"+h,"highcharts-area highcharts-zone-area-"+h+" "+e.className,e.color||a.color,e.fillColor||w.fillColor])});B(v,function(e){var h=e[0],g=a[h];g?(g.endX=a.preventGraphAnimation?null:l.xMap,g.animate({d:l})):(g=a[h]=a.chart.renderer.path(l).addClass(e[1]).attr({fill:p(e[3],D(e[2]).setOpacity(p(w.fillOpacity,.75)).get()),zIndex:0}).add(a.group),g.isArea=!0);g.startX=l.xMap;g.shiftUnit=w.step?2:1})},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle})})(N);(function(a){var D=a.pick;a=a.seriesType;a("spline","line",{},{getPointSpline:function(a,G,p){var g=G.plotX,l=G.plotY,r=a[p-1];p=a[p+1];var n,w,v,e;if(r&&!r.isNull&&!1!==r.doCurve&&!G.isCliff&&p&&!p.isNull&&!1!==p.doCurve&&!G.isCliff){a=r.plotY;v=p.plotX;p=p.plotY;var h=0;n=(1.5*g+r.plotX)/2.5;w=(1.5*l+a)/2.5;v=(1.5*g+v)/2.5;e=(1.5*l+p)/2.5;v!==n&&(h=(e-w)*(v-g)/(v-n)+l-e);w+=h;e+=h;w>a&&w>l?(w=Math.max(a,l),e=2*l-w):w<a&&w<l&&(w=Math.min(a,l),e=2*l-w);e>p&&e>l?(e=Math.max(p,l),w=2*l-e):e<p&&e<l&&(e=Math.min(p,l),w=2*l-e);G.rightContX=v;G.rightContY=e}G=["C",D(r.rightContX,r.plotX),D(r.rightContY,r.plotY),D(n,g),D(w,l),g,l];r.rightContX=r.rightContY=null;return G}})})(N);(function(a){var D=a.seriesTypes.area.prototype,B=a.seriesType;B("areaspline","spline",a.defaultPlotOptions.area,{getStackPoints:D.getStackPoints,getGraphPath:D.getGraphPath,drawGraph:D.drawGraph,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle})})(N);(function(a){var D=a.animObject,B=a.color,G=a.each,p=a.extend,g=a.isNumber,l=a.merge,r=a.pick,n=a.Series,w=a.seriesType,v=a.svg;w("column","line",{borderRadius:0,crisp:!0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"},{cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){n.prototype.init.apply(this,arguments);var a=this,h=a.chart;h.hasRendered&&G(h.series,function(e){e.type===a.type&&(e.isDirty=!0)})},getColumnMetrics:function(){var a=this,h=a.options,g=a.xAxis,c=a.yAxis,f=g.reversed,b,d={},l=0;!1===h.grouping?l=1:G(a.chart.series,function(f){var e=f.options,g=f.yAxis,h;f.type!==a.type||!f.visible&&a.chart.options.chart.ignoreHiddenSeries||c.len!==g.len||c.pos!==g.pos||(e.stacking?(b=f.stackKey,void 0===d[b]&&(d[b]=l++),h=d[b]):!1!==e.grouping&&(h=l++),f.columnIndex=h)});var n=Math.min(Math.abs(g.transA)*(g.ordinalSlope||h.pointRange||g.closestPointRange||g.tickInterval||1),g.len),p=n*h.groupPadding,t=(n-2*p)/(l||1),h=Math.min(h.maxPointWidth||g.len,r(h.pointWidth,t*(1-2*h.pointPadding)));a.columnMetrics={width:h,offset:(t-h)/2+(p+((a.columnIndex||0)+(f?1:0))*t-n/2)*(f?-1:1)};return a.columnMetrics},crispCol:function(a,g,l,c){var f=this.chart,b=this.borderWidth,d=-(b%2?.5:0),b=b%2?.5:1;f.inverted&&f.renderer.isVML&&(b+=1);this.options.crisp&&(l=Math.round(a+l)+d,a=Math.round(a)+d,l-=a);c=Math.round(g+c)+b;d=.5>=Math.abs(g)&&.5<c;g=Math.round(g)+b;c-=g;d&&c&&(--g,c+=1);return{x:a,y:g,width:l,height:c}},translate:function(){var a=this,g=a.chart,l=a.options,c=a.dense=2>a.closestPointRange*a.xAxis.transA,c=a.borderWidth=r(l.borderWidth,c?0:1),f=a.yAxis,b=l.threshold,d=a.translatedThreshold=f.getThreshold(b),p=r(l.minPointLength,5),v=a.getColumnMetrics(),w=v.width,t=a.barW=Math.max(w,1+2*c),K=a.pointXOffset=v.offset;g.inverted&&(d-=.5);l.pointPadding&&(t=Math.ceil(t));n.prototype.translate.apply(a);G(a.points,function(c){var e=r(c.yBottom,d),h=999+Math.abs(e),h=Math.min(Math.max(-h,c.plotY),f.len+h),l=c.plotX+K,m=t,n=Math.min(h,e),y,k=Math.max(h,e)-n;p&&Math.abs(k)<p&&(k=p,y=!f.reversed&&!c.negative||f.reversed&&c.negative,c.y===b&&a.dataMax<=b&&f.min<b&&(y=!y),n=Math.abs(n-d)>p?e-p:d-(y?p:0));c.barX=l;c.pointWidth=w;c.tooltipPos=g.inverted?[f.len+f.pos-g.plotLeft-h,a.xAxis.len-l-m/2,k]:[l+m/2,h+f.pos-g.plotTop,k];c.shapeType="rect";c.shapeArgs=a.crispCol.apply(a,c.isNull?[l,d,m,0]:[l,n,m,k])})},getSymbol:a.noop,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,drawGraph:function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},pointAttribs:function(a,g){var e=this.options,c,f=this.pointAttrToOptions||{};c=f.stroke||"borderColor";var b=f["stroke-width"]||"borderWidth",d=a&&a.color||this.color,h=a&&a[c]||e[c]||this.color||d,n=a&&a[b]||e[b]||this[b]||0,f=e.dashStyle;a&&this.zones.length&&(d=a.getZone(),d=a.options.color||d&&d.color||this.color);g&&(a=l(e.states[g],a.options.states&&a.options.states[g]||{}),g=a.brightness,d=a.color||void 0!==g&&B(d).brighten(a.brightness).get()||d,h=a[c]||h,n=a[b]||n,f=a.dashStyle||f);c={fill:d,stroke:h,"stroke-width":n};f&&(c.dashstyle=f);return c},drawPoints:function(){var a=this,h=this.chart,m=a.options,c=h.renderer,f=m.animationLimit||250,b;G(a.points,function(d){var e=d.graphic;if(g(d.plotY)&&null!==d.y){b=d.shapeArgs;if(e){e[h.pointCount<f?"animate":"attr"](l(b))}else{d.graphic=e=c[d.shapeType](b).add(d.group||a.group)}m.borderRadius&&e.attr({r:m.borderRadius});e.attr(a.pointAttribs(d,d.selected&&"select")).shadow(m.shadow,null,m.stacking&&!m.borderRadius);e.addClass(d.getClassName(),!0)}else{e&&(d.graphic=e.destroy())}})},animate:function(a){var e=this,g=this.yAxis,c=e.options,f=this.chart.inverted,b={},d=f?"translateX":"translateY",l;v&&(a?(b.scaleY=.001,a=Math.min(g.pos+g.len,Math.max(g.pos,g.toPixels(c.threshold))),f?b.translateX=a-g.len:b.translateY=a,e.group.attr(b)):(l=e.group.attr(d),e.group.animate({scaleY:1},p(D(e.options.animation),{step:function(a,c){b[d]=l+c.pos*(g.pos-l);e.group.attr(b)}})),e.animate=null))},remove:function(){var a=this,g=a.chart;g.hasRendered&&G(g.series,function(e){e.type===a.type&&(e.isDirty=!0)});n.prototype.remove.apply(a,arguments)}})})(N);(function(a){a=a.seriesType;a("bar","column",null,{inverted:!0})})(N);(function(a){var D=a.Series;a=a.seriesType;a("scatter","line",{lineWidth:0,findNearestPointBy:"xy",marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">‚óè</span> <span style="font-size: 0.85em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}},{sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,drawGraph:function(){this.options.lineWidth&&D.prototype.drawGraph.call(this)}})})(N);(function(a){var D=a.deg2rad,B=a.isNumber,G=a.pick,p=a.relativeLength;a.CenteredSeriesMixin={getCenter:function(){var a=this.options,l=this.chart,r=2*(a.slicedOffset||0),n=l.plotWidth-2*r,l=l.plotHeight-2*r,w=a.center,w=[G(w[0],"50%"),G(w[1],"50%"),a.size||"100%",a.innerSize||0],v=Math.min(n,l),e,h;for(e=0;4>e;++e){h=w[e],a=2>e||2===e&&/%$/.test(h),w[e]=p(h,[n,l,v,w[2]][e])+(a?r:0)}w[3]>w[2]&&(w[3]=w[2]);return w},getStartAndEndRadians:function(a,l){a=B(a)?a:0;l=B(l)&&l>a&&360>l-a?l:a+360;return{start:D*(a+-90),end:D*(l+-90)}}}})(N);(function(a){var D=a.addEvent,B=a.CenteredSeriesMixin,G=a.defined,p=a.each,g=a.extend,l=B.getStartAndEndRadians,r=a.inArray,n=a.noop,w=a.pick,v=a.Point,e=a.Series,h=a.seriesType,m=a.setAnimation;h("pie","line",{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,states:{hover:{brightness:.1,shadow:!1}}},{isCartesian:!1,requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttribs:a.seriesTypes.column.prototype.pointAttribs,animate:function(a){var c=this,b=c.points,d=c.startAngleRad;a||(p(b,function(a){var b=a.graphic,f=a.shapeArgs;b&&(b.attr({r:a.startR||c.center[3]/2,start:d,end:d}),b.animate({r:f.r,start:f.start,end:f.end},c.options.animation))}),c.animate=null)},updateTotals:function(){var a,f=0,b=this.points,d=b.length,e,g=this.options.ignoreHiddenPoint;for(a=0;a<d;a++){e=b[a],f+=g&&!e.visible?0:e.isNull?0:e.y}this.total=f;for(a=0;a<d;a++){e=b[a],e.percentage=0<f&&(e.visible||!g)?e.y/f*100:0,e.total=f}},generatePoints:function(){e.prototype.generatePoints.call(this);this.updateTotals()},translate:function(a){this.generatePoints();var c=0,b=this.options,d=b.slicedOffset,e=d+(b.borderWidth||0),g,h,m,n=l(b.startAngle,b.endAngle),p=this.startAngleRad=n.start,n=(this.endAngleRad=n.end)-p,r=this.points,v,q=b.dataLabels.distance,b=b.ignoreHiddenPoint,A,E=r.length,F;a||(this.center=a=this.getCenter());this.getX=function(b,c,d){m=Math.asin(Math.min((b-a[1])/(a[2]/2+d.labelDistance),1));return a[0]+(c?-1:1)*Math.cos(m)*(a[2]/2+d.labelDistance)};for(A=0;A<E;A++){F=r[A];F.labelDistance=w(F.options.dataLabels&&F.options.dataLabels.distance,q);this.maxLabelDistance=Math.max(this.maxLabelDistance||0,F.labelDistance);g=p+c*n;if(!b||F.visible){c+=F.percentage/100}h=p+c*n;F.shapeType="arc";F.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:Math.round(1e3*g)/1e3,end:Math.round(1e3*h)/1e3};m=(h+g)/2;m>1.5*Math.PI?m-=2*Math.PI:m<-Math.PI/2&&(m+=2*Math.PI);F.slicedTranslation={translateX:Math.round(Math.cos(m)*d),translateY:Math.round(Math.sin(m)*d)};h=Math.cos(m)*a[2]/2;v=Math.sin(m)*a[2]/2;F.tooltipPos=[a[0]+.7*h,a[1]+.7*v];F.half=m<-Math.PI/2||m>Math.PI/2?1:0;F.angle=m;g=Math.min(e,F.labelDistance/5);F.labelPos=[a[0]+h+Math.cos(m)*F.labelDistance,a[1]+v+Math.sin(m)*F.labelDistance,a[0]+h+Math.cos(m)*g,a[1]+v+Math.sin(m)*g,a[0]+h,a[1]+v,0>F.labelDistance?"center":F.half?"right":"left",m]}},drawGraph:null,drawPoints:function(){var a=this,f=a.chart.renderer,b,d,e,h,l=a.options.shadow;l&&!a.shadowGroup&&(a.shadowGroup=f.g("shadow").add(a.group));p(a.points,function(c){d=c.graphic;if(c.isNull){d&&(c.graphic=d.destroy())}else{h=c.shapeArgs;b=c.getTranslate();var m=c.shadowGroup;l&&!m&&(m=c.shadowGroup=f.g("shadow").add(a.shadowGroup));m&&m.attr(b);e=a.pointAttribs(c,c.selected&&"select");d?d.setRadialReference(a.center).attr(e).animate(g(h,b)):(c.graphic=d=f[c.shapeType](h).setRadialReference(a.center).attr(b).add(a.group),c.visible||d.attr({visibility:"hidden"}),d.attr(e).attr({"stroke-linejoin":"round"}).shadow(l,m));d.addClass(c.getClassName())}})},searchPoint:n,sortByAngle:function(a,f){a.sort(function(a,c){return void 0!==a.angle&&(c.angle-a.angle)*f})},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,getCenter:B.getCenter,getSymbol:n},{init:function(){v.prototype.init.apply(this,arguments);var a=this,f;a.name=w(a.name,"Slice");f=function(b){a.slice("select"===b.type)};D(a,"select",f);D(a,"unselect",f);return a},isValid:function(){return a.isNumber(this.y,!0)&&0<=this.y},setVisible:function(a,f){var b=this,c=b.series,e=c.chart,g=c.options.ignoreHiddenPoint;f=w(f,g);a!==b.visible&&(b.visible=b.options.visible=a=void 0===a?!b.visible:a,c.options.data[r(b,c.data)]=b.options,p(["graphic","dataLabel","connector","shadowGroup"],function(c){if(b[c]){b[c][a?"show":"hide"](!0)}}),b.legendItem&&e.legend.colorizeItem(b,a),a||"hover"!==b.state||b.setState(""),g&&(c.isDirty=!0),f&&e.redraw())},slice:function(a,f,b){var c=this.series;m(b,c.chart);w(f,!0);this.sliced=this.options.sliced=G(a)?a:!this.sliced;c.options.data[r(this,c.data)]=this.options;this.graphic.animate(this.getTranslate());this.shadowGroup&&this.shadowGroup.animate(this.getTranslate())},getTranslate:function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},haloPath:function(a){var c=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.x,c.y,c.r+a,c.r+a,{innerR:this.shapeArgs.r,start:c.start,end:c.end})}})})(N);(function(a){var D=a.addEvent,B=a.arrayMax,G=a.defined,p=a.each,g=a.extend,l=a.format,r=a.map,n=a.merge,w=a.noop,v=a.pick,e=a.relativeLength,h=a.Series,m=a.seriesTypes,c=a.stableSort;a.distribute=function(a,b){function d(a,b){return a.target-b.target}var f,e=!0,g=a,h=[],l;l=0;for(f=a.length;f--;){l+=a[f].size}if(l>b){c(a,function(a,b){return(b.rank||0)-(a.rank||0)});for(l=f=0;l<=b;){l+=a[f].size,f++}h=a.splice(f-1,a.length)}c(a,d);for(a=r(a,function(a){return{size:a.size,targets:[a.target],align:v(a.align,.5)}});e;){for(f=a.length;f--;){e=a[f],l=(Math.min.apply(0,e.targets)+Math.max.apply(0,e.targets))/2,e.pos=Math.min(Math.max(0,l-e.size*e.align),b-e.size)}f=a.length;for(e=!1;f--;){0<f&&a[f-1].pos+a[f-1].size>a[f].pos&&(a[f-1].size+=a[f].size,a[f-1].targets=a[f-1].targets.concat(a[f].targets),a[f-1].align=.5,a[f-1].pos+a[f-1].size>b&&(a[f-1].pos=b-a[f-1].size),a.splice(f,1),e=!0)}}f=0;p(a,function(a){var b=0;p(a.targets,function(){g[f].pos=a.pos+b;b+=g[f].size;f++})});g.push.apply(g,h);c(g,d)};h.prototype.drawDataLabels=function(){function c(a,b){var c=b.filter;return c?(b=c.operator,a=a[c.property],c=c.value,">"===b&&a>c||"<"===b&&a<c||">="===b&&a>=c||"<="===b&&a<=c||"=="===b&&a==c||"==="===b&&a===c?!0:!1):!0}var b=this,d=b.options,e=d.dataLabels,g=b.points,h,m,r=b.hasRendered||0,x,w,B=v(e.defer,!!d.animation),q=b.chart.renderer;if(e.enabled||b._hasPointLabels){b.dlProcessOptions&&b.dlProcessOptions(e),w=b.plotGroup("dataLabelsGroup","data-labels",B&&!r?"hidden":"visible",e.zIndex||6),B&&(w.attr({opacity:+r}),r||D(b,"afterAnimate",function(){b.visible&&w.show(!0);w[d.animation?"animate":"attr"]({opacity:1},{duration:200})})),m=e,p(g,function(f){var g,t=f.dataLabel,k,p,r=f.connector,y=!t,C;h=f.dlOptions||f.options&&f.options.dataLabels;(g=v(h&&h.enabled,m.enabled)&&!f.isNull)&&(g=!0===c(f,h||e));g&&(e=n(m,h),k=f.getLabelConfig(),C=e[f.formatPrefix+"Format"]||e.format,x=G(C)?l(C,k):(e[f.formatPrefix+"Formatter"]||e.formatter).call(k,e),C=e.style,k=e.rotation,C.color=v(e.color,C.color,b.color,"#000000"),"contrast"===C.color&&(f.contrastColor=q.getContrast(f.color||b.color),C.color=e.inside||0>v(f.labelDistance,e.distance)||d.stacking?f.contrastColor:"#000000"),d.cursor&&(C.cursor=d.cursor),p={fill:e.backgroundColor,stroke:e.borderColor,"stroke-width":e.borderWidth,r:e.borderRadius||0,rotation:k,padding:e.padding,zIndex:1},a.objectEach(p,function(a,b){void 0===a&&delete p[b]}));!t||g&&G(x)?g&&G(x)&&(t?p.text=x:(t=f.dataLabel=q[k?"text":"label"](x,0,-9999,e.shape,null,null,e.useHTML,null,"data-label"),t.addClass("highcharts-data-label-color-"+f.colorIndex+" "+(e.className||"")+(e.useHTML?"highcharts-tracker":""))),t.attr(p),t.css(C).shadow(e.shadow),t.added||t.add(w),b.alignDataLabel(f,t,e,null,y)):(f.dataLabel=t=t.destroy(),r&&(f.connector=r.destroy()))})}};h.prototype.alignDataLabel=function(a,b,c,e,h){var d=this.chart,f=d.inverted,l=v(a.dlBox&&a.dlBox.centerX,a.plotX,-9999),m=v(a.plotY,-9999),n=b.getBBox(),p,q=c.rotation,r=c.align,w=this.visible&&(a.series.forceDL||d.isInsidePlot(l,Math.round(m),f)||e&&d.isInsidePlot(l,f?e.x+1:e.y+e.height-1,f)),y="justify"===v(c.overflow,"justify");if(w&&(p=c.style.fontSize,p=d.renderer.fontMetrics(p,b).b,e=g({x:f?this.yAxis.len-m:l,y:Math.round(f?this.xAxis.len-l:m),width:0,height:0},e),g(c,{width:n.width,height:n.height}),q?(y=!1,l=d.renderer.rotCorr(p,q),l={x:e.x+c.x+e.width/2+l.x,y:e.y+c.y+{top:0,middle:.5,bottom:1}[c.verticalAlign]*e.height},b[h?"attr":"animate"](l).attr({align:r}),m=(q+720)%360,m=180<m&&360>m,"left"===r?l.y-=m?n.height:0:"center"===r?(l.x-=n.width/2,l.y-=n.height/2):"right"===r&&(l.x-=n.width,l.y-=m?0:n.height)):(b.align(c,null,e),l=b.alignAttr),y?a.isLabelJustified=this.justifyDataLabel(b,c,l,n,e,h):v(c.crop,!0)&&(w=d.isInsidePlot(l.x,l.y)&&d.isInsidePlot(l.x+n.width,l.y+n.height)),c.shape&&!q)){b[h?"attr":"animate"]({anchorX:f?d.plotWidth-a.plotY:a.plotX,anchorY:f?d.plotHeight-a.plotX:a.plotY})}w||(b.attr({y:-9999}),b.placed=!1)};h.prototype.justifyDataLabel=function(a,b,c,e,g,h){var d=this.chart,f=b.align,l=b.verticalAlign,m,n,q=a.box?0:a.padding||0;m=c.x+q;0>m&&("right"===f?b.align="left":b.x=-m,n=!0);m=c.x+e.width-q;m>d.plotWidth&&("left"===f?b.align="right":b.x=d.plotWidth-m,n=!0);m=c.y+q;0>m&&("bottom"===l?b.verticalAlign="top":b.y=-m,n=!0);m=c.y+e.height-q;m>d.plotHeight&&("top"===l?b.verticalAlign="bottom":b.y=d.plotHeight-m,n=!0);n&&(a.placed=!h,a.align(b,null,g));return n};m.pie&&(m.pie.prototype.drawDataLabels=function(){var c=this,b=c.data,d,e=c.chart,g=c.options.dataLabels,l=v(g.connectorPadding,10),m=v(g.connectorWidth,1),n=e.plotWidth,r=e.plotHeight,w,D=c.center,q=D[2]/2,A=D[1],E,F,k,u,N=[[],[]],M,P,I,Q,z=[0,0,0,0];c.visible&&(g.enabled||c._hasPointLabels)&&(p(b,function(a){a.dataLabel&&a.visible&&a.dataLabel.shortened&&(a.dataLabel.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),a.dataLabel.shortened=!1)}),h.prototype.drawDataLabels.apply(c),p(b,function(a){a.dataLabel&&a.visible&&(N[a.half].push(a),a.dataLabel._pos=null)}),p(N,function(b,f){var h,m,t=b.length,x=[],w;if(t){for(c.sortByAngle(b,f-.5),0<c.maxLabelDistance&&(h=Math.max(0,A-q-c.maxLabelDistance),m=Math.min(A+q+c.maxLabelDistance,e.plotHeight),p(b,function(a){0<a.labelDistance&&a.dataLabel&&(a.top=Math.max(0,A-q-a.labelDistance),a.bottom=Math.min(A+q+a.labelDistance,e.plotHeight),w=a.dataLabel.getBBox().height||21,a.positionsIndex=x.push({target:a.labelPos[1]-a.top+w/2,size:w,rank:a.y})-1)}),a.distribute(x,m+w-h)),Q=0;Q<t;Q++){d=b[Q],m=d.positionsIndex,k=d.labelPos,E=d.dataLabel,I=!1===d.visible?"hidden":"inherit",P=h=k[1],x&&G(x[m])&&(void 0===x[m].pos?I="hidden":(u=x[m].size,P=d.top+x[m].pos)),delete d.positionIndex,M=g.justify?D[0]+(f?-1:1)*(q+d.labelDistance):c.getX(P<d.top+2||P>d.bottom-2?h:P,f,d),E._attr={visibility:I,align:k[6]},E._pos={x:M+g.x+({left:l,right:-l}[k[6]]||0),y:P+g.y-10},k.x=M,k.y=P,v(g.crop,!0)&&(F=E.getBBox().width,h=null,M-F<l?(h=Math.round(F-M+l),z[3]=Math.max(h,z[3])):M+F>n-l&&(h=Math.round(M+F-n+l),z[1]=Math.max(h,z[1])),0>P-u/2?z[0]=Math.max(Math.round(-P+u/2),z[0]):P+u/2>r&&(z[2]=Math.max(Math.round(P+u/2-r),z[2])),E.sideOverflow=h)}}}),0===B(z)||this.verifyDataLabelOverflow(z))&&(this.placeDataLabels(),m&&p(this.points,function(a){var b;w=a.connector;if((E=a.dataLabel)&&E._pos&&a.visible&&0<a.labelDistance){I=E._attr.visibility;if(b=!w){a.connector=w=e.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+a.colorIndex).add(c.dataLabelsGroup),w.attr({"stroke-width":m,stroke:g.connectorColor||a.color||"#666666"})}w[b?"attr":"animate"]({d:c.connectorPath(a.labelPos)});w.attr("visibility",I)}else{w&&(a.connector=w.destroy())}}))},m.pie.prototype.connectorPath=function(a){var b=a.x,c=a.y;return v(this.options.dataLabels.softConnector,!0)?["M",b+("left"===a[6]?5:-5),c,"C",b,c,2*a[2]-a[4],2*a[3]-a[5],a[2],a[3],"L",a[4],a[5]]:["M",b+("left"===a[6]?5:-5),c,"L",a[2],a[3],"L",a[4],a[5]]},m.pie.prototype.placeDataLabels=function(){p(this.points,function(a){var b=a.dataLabel;b&&a.visible&&((a=b._pos)?(b.sideOverflow&&(b._attr.width=b.getBBox().width-b.sideOverflow,b.css({width:b._attr.width+"px",textOverflow:"ellipsis"}),b.shortened=!0),b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-9999}))},this)},m.pie.prototype.alignDataLabel=w,m.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,f=c.center,g=c.minSize||80,h,l=null!==c.size;l||(null!==f[0]?h=Math.max(b[2]-Math.max(a[1],a[3]),g):(h=Math.max(b[2]-a[1]-a[3],g),b[0]+=(a[3]-a[1])/2),null!==f[1]?h=Math.max(Math.min(h,b[2]-Math.max(a[0],a[2])),g):(h=Math.max(Math.min(h,b[2]-a[0]-a[2]),g),b[1]+=(a[0]-a[2])/2),h<b[2]?(b[2]=h,b[3]=Math.min(e(c.innerSize||0,h),h),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):l=!0);return l});m.column&&(m.column.prototype.alignDataLabel=function(a,b,c,e,g){var d=this.chart.inverted,f=a.series,l=a.dlBox||a.shapeArgs,m=v(a.below,a.plotY>v(this.translatedThreshold,f.yAxis.len)),p=v(c.inside,!!this.options.stacking);l&&(e=n(l),0>e.y&&(e.height+=e.y,e.y=0),l=e.y+e.height-f.yAxis.len,0<l&&(e.height-=l),d&&(e={x:f.yAxis.len-e.y-e.height,y:f.xAxis.len-e.x-e.width,width:e.height,height:e.width}),p||(d?(e.x+=m?0:e.width,e.width=0):(e.y+=m?e.height:0,e.height=0)));c.align=v(c.align,!d||p?"center":m?"right":"left");c.verticalAlign=v(c.verticalAlign,d||p?"middle":m?"top":"bottom");h.prototype.alignDataLabel.call(this,a,b,c,e,g);a.isLabelJustified&&a.contrastColor&&a.dataLabel.css({color:a.contrastColor})})})(N);(function(a){var D=a.Chart,B=a.each,G=a.objectEach,p=a.pick;a=a.addEvent;a(D.prototype,"render",function(){var a=[];B(this.labelCollectors||[],function(g){a=a.concat(g())});B(this.yAxis||[],function(g){g.options.stackLabels&&!g.options.stackLabels.allowOverlap&&G(g.stacks,function(g){G(g,function(g){a.push(g.label)})})});B(this.series||[],function(g){var l=g.options.dataLabels,n=g.dataLabelCollections||["dataLabel"];(l.enabled||g._hasPointLabels)&&!l.allowOverlap&&g.visible&&B(n,function(l){B(g.points,function(g){g[l]&&(g[l].labelrank=p(g.labelrank,g.shapeArgs&&g.shapeArgs.height),a.push(g[l]))})})});this.hideOverlappingLabels(a)});D.prototype.hideOverlappingLabels=function(a){var g=a.length,p,n,w,v,e,h,m,c,f,b=function(a,b,c,f,e,g,h,l){return!(e>a+c||e+h<a||g>b+f||g+l<b)};for(n=0;n<g;n++){if(p=a[n]){p.oldOpacity=p.opacity,p.newOpacity=1,p.width||(w=p.getBBox(),p.width=w.width,p.height=w.height)}}a.sort(function(a,b){return(b.labelrank||0)-(a.labelrank||0)});for(n=0;n<g;n++){for(w=a[n],p=n+1;p<g;++p){if(v=a[p],w&&v&&w!==v&&w.placed&&v.placed&&0!==w.newOpacity&&0!==v.newOpacity&&(e=w.alignAttr,h=v.alignAttr,m=w.parentGroup,c=v.parentGroup,f=2*(w.box?0:w.padding||0),e=b(e.x+m.translateX,e.y+m.translateY,w.width-f,w.height-f,h.x+c.translateX,h.y+c.translateY,v.width-f,v.height-f))){(w.labelrank<v.labelrank?w:v).newOpacity=0}}}B(a,function(a){var b,c;a&&(c=a.newOpacity,a.oldOpacity!==c&&a.placed&&(c?a.show(!0):b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,b)),a.isOld=!0)})}})(N);(function(a){var D=a.addEvent,B=a.Chart,G=a.createElement,p=a.css,g=a.defaultOptions,l=a.defaultPlotOptions,r=a.each,n=a.extend,w=a.fireEvent,v=a.hasTouch,e=a.inArray,h=a.isObject,m=a.Legend,c=a.merge,f=a.pick,b=a.Point,d=a.Series,y=a.seriesTypes,H=a.svg,J;J=a.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart.pointer,c=function(a){var c=b.getPointFromEvent(a);void 0!==c&&(b.isDirectTouch=!0,c.onMouseOver(a))};r(a.points,function(a){a.graphic&&(a.graphic.element.point=a);a.dataLabel&&(a.dataLabel.div?a.dataLabel.div.point=a:a.dataLabel.element.point=a)});a._hasTracking||(r(a.trackerGroups,function(d){if(a[d]){a[d].addClass("highcharts-tracker").on("mouseover",c).on("mouseout",function(a){b.onTrackerMouseOut(a)});if(v){a[d].on("touchstart",c)}a.options.cursor&&a[d].css(p).css({cursor:a.options.cursor})}}),a._hasTracking=!0)},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),f=d.length,e=a.chart,g=e.pointer,h=e.renderer,l=e.options.tooltip.snap,k=a.tracker,m,n=function(){if(e.hoverSeries!==a){a.onMouseOver()}},p="rgba(192,192,192,"+(H?1e-4:.002)+")";if(f&&!c){for(m=f+1;m--;){"M"===d[m]&&d.splice(m+1,0,d[m+1]-l,d[m+2],"L"),(m&&"M"===d[m]||m===f)&&d.splice(m,0,"L",d[m-2]+l,d[m-1])}}k?k.attr({d:d}):a.graph&&(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:p,fill:c?p:"none","stroke-width":a.graph.strokeWidth()+(c?0:2*l),zIndex:2}).add(a.group),r([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",n).on("mouseout",function(a){g.onTrackerMouseOut(a)});b.cursor&&a.css({cursor:b.cursor});if(v){a.on("touchstart",n)}}))}};y.column&&(y.column.prototype.drawTracker=J.drawTrackerPoint);y.pie&&(y.pie.prototype.drawTracker=J.drawTrackerPoint);y.scatter&&(y.scatter.prototype.drawTracker=J.drawTrackerPoint);n(m.prototype,{setItemEvents:function(a,b,d){var f=this,e=f.chart.renderer.boxWrapper,g="highcharts-legend-"+(a.series?"point":"series")+"-active";(d?b:a.legendGroup).on("mouseover",function(){a.setState("hover");e.addClass(g);b.css(f.options.itemHoverStyle)}).on("mouseout",function(){b.css(c(a.visible?f.itemStyle:f.itemHiddenStyle));e.removeClass(g);a.setState()}).on("click",function(b){var c=function(){a.setVisible&&a.setVisible()};b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):w(a,"legendItemClick",b,c)})},createCheckboxForItem:function(a){a.checkbox=G("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);D(a.checkbox,"click",function(b){w(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select()})})}});g.legend.itemStyle.cursor="pointer";n(B.prototype,{showResetZoom:function(){var a=this,b=g.lang,c=a.options.chart.resetZoomButton,d=c.theme,f=d.states,e="chart"===c.relativeTo?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,f&&f.hover).attr({align:c.position.align,title:b.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(c.position,!1,e)},zoomOut:function(){var a=this;w(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?(r(this.axes,function(a){b=a.zoom()}),c.initiated=!1):r(a.xAxis.concat(a.yAxis),function(a){var f=a.axis;c[f.isXAxis?"zoomX":"zoomY"]&&(b=f.zoom(a.min,a.max),f.displayBtn&&(d=!0))});e=this.resetZoomButton;d&&!e?this.showResetZoom():!d&&h(e)&&(this.resetZoomButton=e.destroy());b&&this.redraw(f(this.options.chart.animation,a&&a.animation,100>this.pointCount))},pan:function(a,b){var c=this,d=c.hoverPoints,f;d&&r(d,function(a){a.setState()});r("xy"===b?[1,0]:[1],function(b){b=c[b?"xAxis":"yAxis"][0];var d=b.horiz,e=a[d?"chartX":"chartY"],d=d?"mouseDownX":"mouseDownY",g=c[d],k=(b.pointRange||0)/2,h=b.getExtremes(),l=b.toValue(g-e,!0)+k,k=b.toValue(g+b.len-e,!0)-k,m=k<l,g=m?k:l,l=m?l:k,k=Math.min(h.dataMin,b.toValue(b.toPixels(h.min)-b.minPixelPadding)),m=Math.max(h.dataMax,b.toValue(b.toPixels(h.max)+b.minPixelPadding)),n;n=k-g;0<n&&(l+=n,g=k);n=l-m;0<n&&(l=m,g-=n);b.series.length&&g!==h.min&&l!==h.max&&(b.setExtremes(g,l,!1,!1,{trigger:"pan"}),f=!0);c[d]=e});f&&c.redraw(!1);p(c.container,{cursor:"move"})}});n(b.prototype,{select:function(a,b){var c=this,d=c.series,g=d.chart;a=f(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[e(c,d.data)]=c.options;c.setState(a&&"select");b||r(g.getSelectedPoints(),function(a){a.selected&&a!==c&&(a.selected=a.options.selected=!1,d.options.data[e(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect"))})})},onMouseOver:function(a){var b=this.series.chart,c=b.pointer;a=a?c.normalize(a):c.getChartCoordinatesFromPoint(this,b.inverted);c.runPointActions(a,this)},onMouseOut:function(){var a=this.series.chart;this.firePointEvent("mouseOut");r(a.hoverPoints||[],function(a){a.setState()});a.hoverPoints=a.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var b=this,d=c(b.series.options.point,b.options).events;b.events=d;a.objectEach(d,function(a,c){D(b,c,a)});this.hasImportedEvents=!0}},setState:function(a,b){var c=Math.floor(this.plotX),d=this.plotY,e=this.series,g=e.options.states[a]||{},h=l[e.type].marker&&e.options.marker,m=h&&!1===h.enabled,p=h&&h.states&&h.states[a]||{},k=!1===p.enabled,t=e.stateMarkerGraphic,r=this.marker||{},v=e.chart,w=e.halo,y,B=h&&e.markerAttribs;a=a||"";if(!(a===this.state&&!b||this.selected&&"select"!==a||!1===g.enabled||a&&(k||m&&!1===p.enabled)||a&&r.states&&r.states[a]&&!1===r.states[a].enabled)){B&&(y=e.markerAttribs(this,a));if(this.graphic){this.state&&this.graphic.removeClass("highcharts-point-"+this.state),a&&this.graphic.addClass("highcharts-point-"+a),this.graphic.animate(e.pointAttribs(this,a),f(v.options.chart.animation,g.animation)),y&&this.graphic.animate(y,f(v.options.chart.animation,p.animation,h.animation)),t&&t.hide()}else{if(a&&p){h=r.symbol||e.symbol;t&&t.currentSymbol!==h&&(t=t.destroy());if(t){t[b?"animate":"attr"]({x:y.x,y:y.y})}else{h&&(e.stateMarkerGraphic=t=v.renderer.symbol(h,y.x,y.y,y.width,y.height).add(e.markerGroup),t.currentSymbol=h)}t&&t.attr(e.pointAttribs(this,a))}t&&(t[a&&v.isInsidePlot(c,d,v.inverted)?"show":"hide"](),t.element.point=this)}(c=g.halo)&&c.size?(w||(e.halo=w=v.renderer.path().add((this.graphic||t).parentGroup)),w[b?"animate":"attr"]({d:this.haloPath(c.size)}),w.attr({class:"highcharts-halo highcharts-color-"+f(this.colorIndex,e.colorIndex)}),w.point=this,w.attr(n({fill:this.color||e.color,"fill-opacity":c.opacity,zIndex:-1},c.attributes))):w&&w.point&&w.point.haloPath&&w.animate({d:w.point.haloPath(0)});this.state=a}},haloPath:function(a){return this.series.chart.renderer.symbols.circle(Math.floor(this.plotX)-a,this.plotY-a,2*a,2*a)}});n(d.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this){b.onMouseOut()}this.options.events.mouseOver&&w(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d){d.onMouseOut()}this&&a.events.mouseOut&&w(this,"mouseOut");!c||this.stickyTracking||c.shared&&!this.noSharedTooltip||c.hide();this.setState()},setState:function(a){var b=this,c=b.options,d=b.graph,e=c.states,g=c.lineWidth,c=0;a=a||"";if(b.state!==a&&(r([b.group,b.markerGroup,b.dataLabelsGroup],function(c){c&&(b.state&&c.removeClass("highcharts-series-"+b.state),a&&c.addClass("highcharts-series-"+a))}),b.state=a,!e[a]||!1!==e[a].enabled)&&(a&&(g=e[a].lineWidth||g+(e[a].lineWidthPlus||0)),d&&!d.dashstyle)){for(g={"stroke-width":g},d.animate(g,f(b.chart.options.chart.animation,e[a]&&e[a].animation));b["zone-graph-"+c];){b["zone-graph-"+c].attr(g),c+=1}}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.options.visible=c.userOptions.visible=void 0===a?!h:a)?"show":"hide";r(["group","dataLabelsGroup","markerGroup","tracker","tt"],function(a){if(c[a]){c[a][f]()}});if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c){c.onMouseOut()}e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&r(d.series,function(a){a.options.stacking&&a.visible&&(a.isDirty=!0)});r(c.linkedSeries,function(b){b.setVisible(a,!1)});g&&(d.isDirtyBox=!0);!1!==b&&d.redraw();w(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=a=void 0===a?!this.selected:a;this.checkbox&&(this.checkbox.checked=a);w(this,a?"select":"unselect")},drawTracker:J.drawTrackerGraph})})(N);(function(a){var D=a.Chart,B=a.each,G=a.inArray,p=a.isArray,g=a.isObject,l=a.pick,r=a.splat;D.prototype.setResponsive=function(g){var l=this.options.responsive,n=[],e=this.currentResponsive;l&&l.rules&&B(l.rules,function(e){void 0===e._id&&(e._id=a.uniqueKey());this.matchResponsiveRule(e,n,g)},this);var h=a.merge.apply(0,a.map(n,function(e){return a.find(l.rules,function(a){return a._id===e}).chartOptions})),n=n.toString()||void 0;n!==(e&&e.ruleIds)&&(e&&this.update(e.undoOptions,g),n?(this.currentResponsive={ruleIds:n,mergedOptions:h,undoOptions:this.currentOptions(h)},this.update(h,g)):this.currentResponsive=void 0)};D.prototype.matchResponsiveRule=function(a,g){var n=a.condition;(n.callback||function(){return this.chartWidth<=l(n.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=l(n.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=l(n.minWidth,0)&&this.chartHeight>=l(n.minHeight,0)}).call(this)&&g.push(a._id)};D.prototype.currentOptions=function(l){function n(e,h,l,c){var f;a.objectEach(e,function(a,d){if(!c&&-1<G(d,["series","xAxis","yAxis"])){for(a=r(a),l[d]=[],f=0;f<a.length;f++){h[d][f]&&(l[d][f]={},n(a[f],h[d][f],l[d][f],c+1))}}else{g(a)?(l[d]=p(a)?[]:{},n(a,h[d]||{},l[d],c+1)):l[d]=h[d]||null}})}var v={};n(l,this.options,v,0);return v}})(N);return N})});var highchartsMore=createCommonjsModule(function(module){(function(x){"object"==="object"&&module.exports?module.exports=x:x(Highcharts)})(function(x){(function(a){var t=a.deg2rad,v=a.isNumber,w=a.pick,n=a.relativeLength;a.CenteredSeriesMixin={getCenter:function(){var a=this.options,e=this.chart,k=2*(a.slicedOffset||0),b=e.plotWidth-2*k,e=e.plotHeight-2*k,c=a.center,c=[w(c[0],"50%"),w(c[1],"50%"),a.size||"100%",a.innerSize||0],l=Math.min(b,e),g,d;for(g=0;4>g;++g){d=c[g],a=2>g||2===g&&/%$/.test(d),c[g]=n(d,[b,e,l,c[2]][g])+(a?k:0)}c[3]>c[2]&&(c[3]=c[2]);return c},getStartAndEndRadians:function(a,e){a=v(a)?a:0;e=v(e)&&e>a&&360>e-a?e:a+360;return{start:t*(a+-90),end:t*(e+-90)}}}})(x);(function(a){function t(a,b){this.init(a,b)}var v=a.CenteredSeriesMixin,w=a.each,n=a.extend,m=a.merge,e=a.splat;n(t.prototype,{coll:"pane",init:function(a,b){this.chart=b;this.background=[];b.pane.push(this);this.setOptions(a)},setOptions:function(a){this.options=m(this.defaultOptions,this.chart.angular?{background:{}}:void 0,a)},render:function(){var a=this.options,b=this.options.background,c=this.chart.renderer;this.group||(this.group=c.g("pane-group").attr({zIndex:a.zIndex||0}).add());this.updateCenter();if(b){for(b=e(b),a=Math.max(b.length,this.background.length||0),c=0;c<a;c++){b[c]&&this.axis?this.renderBackground(m(this.defaultBackgroundOptions,b[c]),c):this.background[c]&&(this.background[c]=this.background[c].destroy(),this.background.splice(c,1))}}},renderBackground:function(a,b){var c="animate";this.background[b]||(this.background[b]=this.chart.renderer.path().add(this.group),c="attr");this.background[b][c]({d:this.axis.getPlotBandPath(a.from,a.to,a)}).attr({fill:a.backgroundColor,stroke:a.borderColor,"stroke-width":a.borderWidth,class:"highcharts-pane "+(a.className||"")})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},updateCenter:function(a){this.center=(a||this.axis||{}).center=v.getCenter.call(this)},update:function(a,b){m(!0,this.options,a);this.setOptions(this.options);this.render();w(this.chart.axes,function(c){c.pane===this&&(c.pane=null,c.update({},b))},this)}});a.Pane=t})(x);(function(a){var t=a.each,v=a.extend,w=a.map,n=a.merge,m=a.noop,e=a.pick,k=a.pInt,b=a.wrap,c,l,g=a.Axis.prototype;a=a.Tick.prototype;c={getOffset:m,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:m,setCategories:m,setTitle:m};l={defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(b){b=this.options=n(this.defaultOptions,this.defaultRadialOptions,b);b.plotBands||(b.plotBands=[])},getOffset:function(){g.getOffset.call(this);this.chart.axisOffset[this.side]=0},getLinePath:function(b,c){b=this.center;var d=this.chart,f=e(c,b[2]/2-this.offset);this.isCircular||void 0!==c?(c=this.chart.renderer.symbols.arc(this.left+b[0],this.top+b[1],f,f,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0}),c.xBounds=[this.left+b[0]],c.yBounds=[this.top+b[1]-f]):(c=this.postTranslate(this.angleRad,f),c=["M",b[0]+d.plotLeft,b[1]+d.plotTop,"L",c.x,c.y]);return c},setAxisTranslation:function(){g.setAxisTranslation.call(this);this.center&&(this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0)},beforeSetTickPositions:function(){if(this.autoConnect=this.isCircular&&void 0===e(this.userMax,this.options.max)&&this.endAngleRad-this.startAngleRad===2*Math.PI){this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0}},setAxisSize:function(){g.setAxisSize.call(this);this.isRadial&&(this.pane.updateCenter(this),this.isCircular&&(this.sector=this.endAngleRad-this.startAngleRad),this.len=this.width=this.height=this.center[2]*e(this.sector,1)/2)},getPosition:function(b,c){return this.postTranslate(this.isCircular?this.translate(b):this.angleRad,e(this.isCircular?c:this.translate(b),this.center[2]/2)-this.offset)},postTranslate:function(b,c){var d=this.chart,f=this.center;b=this.startAngleRad+b;return{x:d.plotLeft+f[0]+Math.cos(b)*c,y:d.plotTop+f[1]+Math.sin(b)*c}},getPlotBandPath:function(b,c,a){var d=this.center,f=this.startAngleRad,l=d[2]/2,h=[e(a.outerRadius,"100%"),a.innerRadius,e(a.thickness,10)],g=Math.min(this.offset,0),u=/%$/,m,n=this.isCircular;"polygon"===this.options.gridLineInterpolation?d=this.getPlotLinePath(b).concat(this.getPlotLinePath(c,!0)):(b=Math.max(b,this.min),c=Math.min(c,this.max),n||(h[0]=this.translate(b),h[1]=this.translate(c)),h=w(h,function(b){u.test(b)&&(b=k(b,10)*l/100);return b}),"circle"!==a.shape&&n?(b=f+this.translate(b),c=f+this.translate(c)):(b=-Math.PI/2,c=1.5*Math.PI,m=!0),h[0]-=g,h[2]-=g,d=this.chart.renderer.symbols.arc(this.left+d[0],this.top+d[1],h[0],h[0],{start:Math.min(b,c),end:Math.max(b,c),innerR:e(h[1],h[0]-h[2]),open:m}));return d},getPlotLinePath:function(b,c){var d=this,f=d.center,a=d.chart,l=d.getPosition(b),g,e,u;d.isCircular?u=["M",f[0]+a.plotLeft,f[1]+a.plotTop,"L",l.x,l.y]:"circle"===d.options.gridLineInterpolation?(b=d.translate(b))&&(u=d.getLinePath(0,b)):(t(a.xAxis,function(b){b.pane===d.pane&&(g=b)}),u=[],b=d.translate(b),f=g.tickPositions,g.autoConnect&&(f=f.concat([f[0]])),c&&(f=[].concat(f).reverse()),t(f,function(c,d){e=g.getPosition(c,b);u.push(d?"L":"M",e.x,e.y)}));return u},getTitlePosition:function(){var b=this.center,c=this.chart,a=this.options.title;return{x:c.plotLeft+b[0]+(a.x||0),y:c.plotTop+b[1]-{high:.5,middle:.25,low:0}[a.align]*b[2]+(a.y||0)}}};b(g,"init",function(b,f,a){var d=f.angular,h=f.polar,g=a.isX,y=d&&g,m,u=f.options,k=a.pane||0,t=this.pane=f.pane&&f.pane[k],k=t&&t.options;if(d){if(v(this,y?c:l),m=!g){this.defaultRadialOptions=this.defaultRadialGaugeOptions}}else{h&&(v(this,l),this.defaultRadialOptions=(m=g)?this.defaultRadialXOptions:n(this.defaultYAxisOptions,this.defaultRadialYOptions))}d||h?(this.isRadial=!0,f.inverted=!1,u.chart.zoomType=null):this.isRadial=!1;t&&m&&(t.axis=this);b.call(this,f,a);!y&&t&&(d||h)&&(b=this.options,this.angleRad=(b.angle||0)*Math.PI/180,this.startAngleRad=(k.startAngle-90)*Math.PI/180,this.endAngleRad=(e(k.endAngle,k.startAngle+360)-90)*Math.PI/180,this.offset=b.offset||0,this.isCircular=m)});b(g,"autoLabelAlign",function(b){if(!this.isRadial){return b.apply(this,[].slice.call(arguments,1))}});b(a,"getPosition",function(b,c,a,l,g){var d=this.axis;return d.getPosition?d.getPosition(a):b.call(this,c,a,l,g)});b(a,"getLabelPosition",function(b,c,a,l,g,r,y,m,u){var d=this.axis,f=r.y,h=20,p=r.align,q=(d.translate(this.pos)+d.startAngleRad+Math.PI/2)/Math.PI*180%360;d.isRadial?(b=d.getPosition(this.pos,d.center[2]/2+e(r.distance,-25)),"auto"===r.rotation?l.attr({rotation:q}):null===f&&(f=d.chart.renderer.fontMetrics(l.styles.fontSize).b-l.getBBox().height/2),null===p&&(d.isCircular?(this.label.getBBox().width>d.len*d.tickInterval/(d.max-d.min)&&(h=0),p=q>h&&q<180-h?"left":q>180+h&&q<360-h?"right":"center"):p="center",l.attr({align:p})),b.x+=r.x,b.y+=f):b=b.call(this,c,a,l,g,r,y,m,u);return b});b(a,"getMarkPath",function(b,c,a,l,g,r,e){var d=this.axis;d.isRadial?(b=d.getPosition(this.pos,d.center[2]/2+l),c=["M",c,a,"L",b.x,b.y]):c=b.call(this,c,a,l,g,r,e);return c})})(x);(function(a){var t=a.each,v=a.pick,w=a.defined,n=a.seriesType,m=a.seriesTypes,e=a.Series.prototype,k=a.Point.prototype;n("arearange","area",{lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">‚óè</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0}},{pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(b){return[b.low,b.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(b){var c=this.chart,a=this.xAxis.postTranslate(b.rectPlotX,this.yAxis.len-b.plotHigh);b.plotHighX=a.x-c.plotLeft;b.plotHigh=a.y-c.plotTop;b.plotLowX=b.plotX},translate:function(){var b=this,c=b.yAxis,a=!!b.modifyValue;m.area.prototype.translate.apply(b);t(b.points,function(l){var d=l.low,f=l.high,h=l.plotY;null===f||null===d?(l.isNull=!0,l.plotY=null):(l.plotLow=h,l.plotHigh=c.translate(a?b.modifyValue(f,l):f,0,1,0,1),a&&(l.yBottom=l.plotHigh))});this.chart.polar&&t(this.points,function(c){b.highToXY(c);c.tooltipPos=[(c.plotHighX+c.plotLowX)/2,(c.plotHigh+c.plotLow)/2]})},getGraphPath:function(b){var c=[],a=[],g,d=m.area.prototype.getGraphPath,f,h,q;q=this.options;var p=this.chart.polar&&!1!==q.connectEnds,r=q.connectNulls,e=q.step;b=b||this.points;for(g=b.length;g--;){f=b[g],f.isNull||p||r||b[g+1]&&!b[g+1].isNull||a.push({plotX:f.plotX,plotY:f.plotY,doCurve:!1}),h={polarPlotY:f.polarPlotY,rectPlotX:f.rectPlotX,yBottom:f.yBottom,plotX:v(f.plotHighX,f.plotX),plotY:f.plotHigh,isNull:f.isNull},a.push(h),c.push(h),f.isNull||p||r||b[g-1]&&!b[g-1].isNull||a.push({plotX:f.plotX,plotY:f.plotY,doCurve:!1})}b=d.call(this,b);e&&(!0===e&&(e="left"),q.step={left:"right",center:"center",right:"left"}[e]);c=d.call(this,c);a=d.call(this,a);q.step=e;q=[].concat(b,c);this.chart.polar||"M"!==a[0]||(a[0]="L");this.graphPath=q;this.areaPath=b.concat(a);q.isArea=!0;q.xMap=b.xMap;this.areaPath.xMap=b.xMap;return q},drawDataLabels:function(){var b=this.data,c=b.length,a,g=[],d=this.options.dataLabels,f=d.align,h=d.verticalAlign,q=d.inside,p,r,y=this.chart.inverted;if(d.enabled||this._hasPointLabels){for(a=c;a--;){if(p=b[a]){r=q?p.plotHigh<p.plotLow:p.plotHigh>p.plotLow,p.y=p.high,p._plotY=p.plotY,p.plotY=p.plotHigh,g[a]=p.dataLabel,p.dataLabel=p.dataLabelUpper,p.below=r,y?f||(d.align=r?"right":"left"):h||(d.verticalAlign=r?"top":"bottom"),d.x=d.xHigh,d.y=d.yHigh}}e.drawDataLabels&&e.drawDataLabels.apply(this,arguments);for(a=c;a--;){if(p=b[a]){r=q?p.plotHigh<p.plotLow:p.plotHigh>p.plotLow,p.dataLabelUpper=p.dataLabel,p.dataLabel=g[a],p.y=p.low,p.plotY=p._plotY,p.below=!r,y?f||(d.align=r?"left":"right"):h||(d.verticalAlign=r?"bottom":"top"),d.x=d.xLow,d.y=d.yLow}}e.drawDataLabels&&e.drawDataLabels.apply(this,arguments)}d.align=f;d.verticalAlign=h},alignDataLabel:function(){m.column.prototype.alignDataLabel.apply(this,arguments)},drawPoints:function(){var b=this.points.length,c,a;e.drawPoints.apply(this,arguments);for(a=0;a<b;){c=this.points[a],c.lowerGraphic=c.graphic,c.graphic=c.upperGraphic,c._plotY=c.plotY,c._plotX=c.plotX,c.plotY=c.plotHigh,w(c.plotHighX)&&(c.plotX=c.plotHighX),a++}e.drawPoints.apply(this,arguments);for(a=0;a<b;){c=this.points[a],c.upperGraphic=c.graphic,c.graphic=c.lowerGraphic,c.plotY=c._plotY,c.plotX=c._plotX,a++}},setStackedPoints:a.noop},{setState:function(){var b=this.state,c=this.series,a=c.chart.polar;w(this.plotHigh)||(this.plotHigh=c.yAxis.toPixels(this.high,!0));w(this.plotLow)||(this.plotLow=this.plotY=c.yAxis.toPixels(this.low,!0));k.setState.apply(this,arguments);this.graphic=this.upperGraphic;this.plotY=this.plotHigh;a&&(this.plotX=this.plotHighX);this.state=b;c.stateMarkerGraphic&&(c.lowerStateMarkerGraphic=c.stateMarkerGraphic,c.stateMarkerGraphic=c.upperStateMarkerGraphic);k.setState.apply(this,arguments);this.plotY=this.plotLow;this.graphic=this.lowerGraphic;a&&(this.plotX=this.plotLowX);c.stateMarkerGraphic&&(c.upperStateMarkerGraphic=c.stateMarkerGraphic,c.stateMarkerGraphic=c.lowerStateMarkerGraphic,c.lowerStateMarkerGraphic=void 0)},haloPath:function(){var b=this.series.chart.polar,c;this.plotY=this.plotLow;b&&(this.plotX=this.plotLowX);c=k.haloPath.apply(this,arguments);this.plotY=this.plotHigh;b&&(this.plotX=this.plotHighX);return c=c.concat(k.haloPath.apply(this,arguments))},destroy:function(){this.upperGraphic&&(this.upperGraphic=this.upperGraphic.destroy());return k.destroy.apply(this,arguments)}})})(x);(function(a){var t=a.seriesType;t("areasplinerange","arearange",null,{getPointSpline:a.seriesTypes.spline.prototype.getPointSpline})})(x);(function(a){var t=a.defaultPlotOptions,v=a.each,w=a.merge,n=a.noop,m=a.pick,e=a.seriesType,k=a.seriesTypes.column.prototype;e("columnrange","arearange",w(t.column,t.arearange,{pointRange:null,marker:null,states:{hover:{halo:!1}}}),{translate:function(){var b=this,c=b.yAxis,a=b.xAxis,g=a.startAngleRad,d,f=b.chart,h=b.xAxis.isRadial,q=Math.max(f.chartWidth,f.chartHeight)+999,p;k.translate.apply(b);v(b.points,function(l){var r=l.shapeArgs,e=b.options.minPointLength,u,k;l.plotHigh=p=Math.min(Math.max(-q,c.translate(l.high,0,1,0,1)),q);l.plotLow=Math.min(Math.max(-q,l.plotY),q);k=p;u=m(l.rectPlotY,l.plotY)-p;Math.abs(u)<e?(e-=u,u+=e,k-=e/2):0>u&&(u*=-1,k-=u);h?(d=l.barX+g,l.shapeType="path",l.shapeArgs={d:b.polarArc(k+u,k,d,d+l.pointWidth)}):(r.height=u,r.y=k,l.tooltipPos=f.inverted?[c.len+c.pos-f.plotLeft-k-u/2,a.len+a.pos-f.plotTop-r.x-r.width/2,u]:[a.left-f.plotLeft+r.x+r.width/2,c.pos-f.plotTop+k+u/2,u])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:n,getSymbol:n,crispCol:k.crispCol,drawPoints:k.drawPoints,drawTracker:k.drawTracker,getColumnMetrics:k.getColumnMetrics,pointAttribs:k.pointAttribs,animate:function(){return k.animate.apply(this,arguments)},polarArc:function(){return k.polarArc.apply(this,arguments)},translate3dPoints:function(){return k.translate3dPoints.apply(this,arguments)},translate3dShapes:function(){return k.translate3dShapes.apply(this,arguments)}},{setState:k.pointClass.prototype.setState})})(x);(function(a){var t=a.each,v=a.isNumber,w=a.merge,n=a.pick,m=a.pInt,e=a.Series,k=a.seriesType,b=a.TrackerMixin;k("gauge","line",{dataLabels:{enabled:!0,defer:!1,y:15,borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2,borderWidth:1,borderColor:"#cccccc"},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1},{angular:!0,directTouch:!0,drawGraph:a.noop,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var b=this.yAxis,a=this.options,g=b.center;this.generatePoints();t(this.points,function(c){var d=w(a.dial,c.dial),l=m(n(d.radius,80))*g[2]/200,q=m(n(d.baseLength,70))*l/100,p=m(n(d.rearLength,10))*l/100,r=d.baseWidth||3,e=d.topWidth||1,k=a.overshoot,u=b.startAngleRad+b.translate(c.y,null,null,null,!0);v(k)?(k=k/180*Math.PI,u=Math.max(b.startAngleRad-k,Math.min(b.endAngleRad+k,u))):!1===a.wrap&&(u=Math.max(b.startAngleRad,Math.min(b.endAngleRad,u)));u=180*u/Math.PI;c.shapeType="path";c.shapeArgs={d:d.path||["M",-p,-r/2,"L",q,-r/2,l,-e/2,l,e/2,q,r/2,-p,r/2,"z"],translateX:g[0],translateY:g[1],rotation:u};c.plotX=g[0];c.plotY=g[1]})},drawPoints:function(){var b=this,a=b.yAxis.center,g=b.pivot,d=b.options,f=d.pivot,h=b.chart.renderer;t(b.points,function(c){var a=c.graphic,f=c.shapeArgs,l=f.d,g=w(d.dial,c.dial);a?(a.animate(f),f.d=l):(c.graphic=h[c.shapeType](f).attr({rotation:f.rotation,zIndex:1}).addClass("highcharts-dial").add(b.group),c.graphic.attr({stroke:g.borderColor||"none","stroke-width":g.borderWidth||0,fill:g.backgroundColor||"#000000"}))});g?g.animate({translateX:a[0],translateY:a[1]}):(b.pivot=h.circle(0,0,n(f.radius,5)).attr({zIndex:2}).addClass("highcharts-pivot").translate(a[0],a[1]).add(b.group),b.pivot.attr({"stroke-width":f.borderWidth||0,stroke:f.borderColor||"#cccccc",fill:f.backgroundColor||"#000000"}))},animate:function(b){var c=this;b||(t(c.points,function(b){var a=b.graphic;a&&(a.attr({rotation:180*c.yAxis.startAngleRad/Math.PI}),a.animate({rotation:b.shapeArgs.rotation},c.options.animation))}),c.animate=null)},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",this.options.zIndex,this.chart.seriesGroup);e.prototype.render.call(this);this.group.clip(this.chart.clipRect)},setData:function(b,a){e.prototype.setData.call(this,b,!1);this.processData();this.generatePoints();n(a,!0)&&this.chart.redraw()},drawTracker:b&&b.drawTrackerPoint},{setState:function(b){this.state=b}})})(x);(function(a){var t=a.each,v=a.noop,w=a.pick,n=a.seriesType,m=a.seriesTypes;n("boxplot","column",{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,states:{hover:{brightness:-.3}},whiskerWidth:2},{pointArrayMap:["low","q1","median","q3","high"],toYData:function(a){return[a.low,a.q1,a.median,a.q3,a.high]},pointValKey:"high",pointAttribs:function(a){var e=this.options,b=a&&a.color||this.color;return{fill:a.fillColor||e.fillColor||b,stroke:e.lineColor||b,"stroke-width":e.lineWidth||0}},drawDataLabels:v,translate:function(){var a=this.yAxis,k=this.pointArrayMap;m.column.prototype.translate.apply(this);t(this.points,function(b){t(k,function(c){null!==b[c]&&(b[c+"Plot"]=a.translate(b[c],0,1,0,1))})})},drawPoints:function(){var a=this,k=a.options,b=a.chart.renderer,c,l,g,d,f,h,q=0,p,r,m,n,u=!1!==a.doQuartiles,v,A=a.options.whiskerLength;t(a.points,function(e){var y=e.graphic,t=y?"animate":"attr",J=e.shapeArgs,x={},C={},H={},I=e.color||a.color;void 0!==e.plotY&&(p=J.width,r=Math.floor(J.x),m=r+p,n=Math.round(p/2),c=Math.floor(u?e.q1Plot:e.lowPlot),l=Math.floor(u?e.q3Plot:e.lowPlot),g=Math.floor(e.highPlot),d=Math.floor(e.lowPlot),y||(e.graphic=y=b.g("point").add(a.group),e.stem=b.path().addClass("highcharts-boxplot-stem").add(y),A&&(e.whiskers=b.path().addClass("highcharts-boxplot-whisker").add(y)),u&&(e.box=b.path(void 0).addClass("highcharts-boxplot-box").add(y)),e.medianShape=b.path(void 0).addClass("highcharts-boxplot-median").add(y)),x.stroke=e.stemColor||k.stemColor||I,x["stroke-width"]=w(e.stemWidth,k.stemWidth,k.lineWidth),x.dashstyle=e.stemDashStyle||k.stemDashStyle,e.stem.attr(x),A&&(C.stroke=e.whiskerColor||k.whiskerColor||I,C["stroke-width"]=w(e.whiskerWidth,k.whiskerWidth,k.lineWidth),e.whiskers.attr(C)),u&&(y=a.pointAttribs(e),e.box.attr(y)),H.stroke=e.medianColor||k.medianColor||I,H["stroke-width"]=w(e.medianWidth,k.medianWidth,k.lineWidth),e.medianShape.attr(H),h=e.stem.strokeWidth()%2/2,q=r+n+h,e.stem[t]({d:["M",q,l,"L",q,g,"M",q,c,"L",q,d]}),u&&(h=e.box.strokeWidth()%2/2,c=Math.floor(c)+h,l=Math.floor(l)+h,r+=h,m+=h,e.box[t]({d:["M",r,l,"L",r,c,"L",m,c,"L",m,l,"L",r,l,"z"]})),A&&(h=e.whiskers.strokeWidth()%2/2,g+=h,d+=h,v=/%$/.test(A)?n*parseFloat(A)/100:A/2,e.whiskers[t]({d:["M",q-v,g,"L",q+v,g,"M",q-v,d,"L",q+v,d]})),f=Math.round(e.medianPlot),h=e.medianShape.strokeWidth()%2/2,f+=h,e.medianShape[t]({d:["M",r,f,"L",m,f]}))})},setStackedPoints:v})})(x);(function(a){var t=a.each,v=a.noop,w=a.seriesType,n=a.seriesTypes;w("errorbar","boxplot",{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null},{type:"errorbar",pointArrayMap:["low","high"],toYData:function(a){return[a.low,a.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:n.arearange?function(){var a=this.pointValKey;n.arearange.prototype.drawDataLabels.call(this);t(this.data,function(e){e.y=e[a]})}:v,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||n.column.prototype.getColumnMetrics.call(this)}})})(x);(function(a){var t=a.correctFloat,v=a.isNumber,w=a.pick,n=a.Point,m=a.Series,e=a.seriesType,k=a.seriesTypes;e("waterfall","column",{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}},{pointValKey:"y",translate:function(){var b=this.options,c=this.yAxis,a,g,d,f,h,e,p,r,m,n,u=w(b.minPointLength,5),v=u/2,x=b.threshold,D=b.stacking,z;k.column.prototype.translate.apply(this);r=m=x;g=this.points;a=0;for(b=g.length;a<b;a++){d=g[a],p=this.processedYData[a],f=d.shapeArgs,h=D&&c.stacks[(this.negStacks&&p<x?"-":"")+this.stackKey],z=this.getStackIndicator(z,d.x,this.index),n=h?h[d.x].points[z.key]:[0,p],d.isSum?d.y=t(p):d.isIntermediateSum&&(d.y=t(p-m)),e=Math.max(r,r+d.y)+n[0],f.y=c.translate(e,0,1,0,1),d.isSum?(f.y=c.translate(n[1],0,1,0,1),f.height=Math.min(c.translate(n[0],0,1,0,1),c.len)-f.y):d.isIntermediateSum?(f.y=c.translate(n[1],0,1,0,1),f.height=Math.min(c.translate(m,0,1,0,1),c.len)-f.y,m=n[1]):(f.height=0<p?c.translate(r,0,1,0,1)-f.y:c.translate(r,0,1,0,1)-c.translate(r-p,0,1,0,1),r+=h&&h[d.x]?h[d.x].total:p),0>f.height&&(f.y+=f.height,f.height*=-1),d.plotY=f.y=Math.round(f.y)-this.borderWidth%2/2,f.height=Math.max(Math.round(f.height),.001),d.yBottom=f.y+f.height,f.height<=u&&!d.isNull?(f.height=u,f.y-=v,d.plotY=f.y,d.minPointLengthOffset=0>d.y?-v:v):d.minPointLengthOffset=0,f=d.plotY+(d.negative?f.height:0),this.chart.inverted?d.tooltipPos[0]=c.len-f:d.tooltipPos[1]=f}},processData:function(b){var c=this.yData,a=this.options.data,e,d=c.length,f,h,q,p,r,k;h=f=q=p=this.options.threshold||0;for(k=0;k<d;k++){r=c[k],e=a&&a[k]?a[k]:{},"sum"===r||e.isSum?c[k]=t(h):"intermediateSum"===r||e.isIntermediateSum?c[k]=t(f):(h+=r,f+=r),q=Math.min(h,q),p=Math.max(h,p)}m.prototype.processData.call(this,b);this.options.stacking||(this.dataMin=q,this.dataMax=p)},toYData:function(b){return b.isSum?0===b.x?null:"sum":b.isIntermediateSum?0===b.x?null:"intermediateSum":b.y},pointAttribs:function(b,a){var c=this.options.upColor;c&&!b.options.color&&(b.color=0<b.y?c:null);b=k.column.prototype.pointAttribs.call(this,b,a);delete b.dashstyle;return b},getGraphPath:function(){return["M",0,0]},getCrispPath:function(){var b=this.data,a=b.length,e=this.graph.strokeWidth()+this.borderWidth,e=Math.round(e)%2/2,g=this.yAxis.reversed,d=[],f,h,q;for(q=1;q<a;q++){h=b[q].shapeArgs;f=b[q-1].shapeArgs;h=["M",f.x+f.width,f.y+b[q-1].minPointLengthOffset+e,"L",h.x,f.y+b[q-1].minPointLengthOffset+e];if(0>b[q-1].y&&!g||0<b[q-1].y&&g){h[2]+=f.height,h[5]+=f.height}d=d.concat(h)}return d},drawGraph:function(){m.prototype.drawGraph.call(this);this.graph.attr({d:this.getCrispPath()})},setStackedPoints:function(){var b=this.options,a,e;m.prototype.setStackedPoints.apply(this,arguments);a=this.stackedYData?this.stackedYData.length:0;for(e=1;e<a;e++){b.data[e].isSum||b.data[e].isIntermediateSum||(this.stackedYData[e]+=this.stackedYData[e-1])}},getExtremes:function(){if(this.options.stacking){return m.prototype.getExtremes.apply(this,arguments)}}},{getClassName:function(){var b=n.prototype.getClassName.call(this);this.isSum?b+=" highcharts-sum":this.isIntermediateSum&&(b+=" highcharts-intermediate-sum");return b},isValid:function(){return v(this.y,!0)||this.isSum||this.isIntermediateSum}})})(x);(function(a){var t=a.Series,v=a.seriesType,w=a.seriesTypes;v("polygon","scatter",{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0},{type:"polygon",getGraphPath:function(){for(var a=t.prototype.getGraphPath.call(this),m=a.length+1;m--;){(m===a.length||"M"===a[m])&&0<m&&a.splice(m,0,"z")}return this.areaPath=a},drawGraph:function(){this.options.fillColor=this.color;w.area.prototype.drawGraph.call(this)},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,drawTracker:t.prototype.drawTracker,setStackedPoints:a.noop})})(x);(function(a){var t=a.arrayMax,v=a.arrayMin,w=a.Axis,n=a.color,m=a.each,e=a.isNumber,k=a.noop,b=a.pick,c=a.pInt,l=a.Point,g=a.Series,d=a.seriesType,f=a.seriesTypes;d("bubble","scatter",{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1,radius:null,states:{hover:{radiusPlus:0}},symbol:"circle"},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"},{pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],specialGroup:"group",bubblePadding:!0,zoneAxis:"z",directTouch:!0,pointAttribs:function(a,c){var d=b(this.options.marker.fillOpacity,.5);a=g.prototype.pointAttribs.call(this,a,c);1!==d&&(a.fill=n(a.fill).setOpacity(d).get("rgba"));return a},getRadii:function(b,a,c,d){var f,e,h,g=this.zData,l=[],p=this.options,r="width"!==p.sizeBy,q=p.zThreshold,k=a-b;e=0;for(f=g.length;e<f;e++){h=g[e],p.sizeByAbsoluteValue&&null!==h&&(h=Math.abs(h-q),a=Math.max(a-q,Math.abs(b-q)),b=0),null===h?h=null:h<b?h=c/2-1:(h=0<k?(h-b)/k:.5,r&&0<=h&&(h=Math.sqrt(h)),h=Math.ceil(c+h*(d-c))/2),l.push(h)}this.radii=l},animate:function(b){var a=this.options.animation;b||(m(this.points,function(b){var c=b.graphic,d;c&&c.width&&(d={x:c.x,y:c.y,width:c.width,height:c.height},c.attr({x:b.plotX,y:b.plotY,width:1,height:1}),c.animate(d,a))}),this.animate=null)},translate:function(){var b,c=this.data,d,g,l=this.radii;f.scatter.prototype.translate.call(this);for(b=c.length;b--;){d=c[b],g=l?l[b]:0,e(g)&&g>=this.minPxSize/2?(d.marker=a.extend(d.marker,{radius:g,width:2*g,height:2*g}),d.dlBox={x:d.plotX-g,y:d.plotY-g,width:2*g,height:2*g}):d.shapeArgs=d.plotY=d.dlBox=void 0}},alignDataLabel:f.column.prototype.alignDataLabel,buildKDTree:k,applyZones:k},{haloPath:function(b){return l.prototype.haloPath.call(this,0===b?0:(this.marker?this.marker.radius||0:0)+b)},ttBelow:!1});w.prototype.beforePadding=function(){var a=this,d=this.len,f=this.chart,g=0,l=d,k=this.isXAxis,n=k?"xData":"yData",w=this.min,x={},D=Math.min(f.plotWidth,f.plotHeight),z=Number.MAX_VALUE,E=-Number.MAX_VALUE,F=this.max-w,B=d/F,G=[];m(this.series,function(d){var e=d.options;!d.bubblePadding||!d.visible&&f.options.chart.ignoreHiddenSeries||(a.allowZoomOutside=!0,G.push(d),k&&(m(["minSize","maxSize"],function(b){var a=e[b],d=/%$/.test(a),a=c(a);x[b]=d?D*a/100:a}),d.minPxSize=x.minSize,d.maxPxSize=Math.max(x.maxSize,x.minSize),d=d.zData,d.length&&(z=b(e.zMin,Math.min(z,Math.max(v(d),!1===e.displayNegative?e.zThreshold:-Number.MAX_VALUE))),E=b(e.zMax,Math.max(E,t(d))))))});m(G,function(b){var c=b[n],d=c.length,f;k&&b.getRadii(z,E,b.minPxSize,b.maxPxSize);if(0<F){for(;d--;){e(c[d])&&a.dataMin<=c[d]&&c[d]<=a.dataMax&&(f=b.radii[d],g=Math.min((c[d]-w)*B-f,g),l=Math.max((c[d]-w)*B+f,l))}}});G.length&&0<F&&!this.isLog&&(l-=d,B*=(d+g-l)/d,m([["min","userMin",g],["max","userMax",l]],function(c){void 0===b(a.options[c[0]],a[c[1]])&&(a[c[0]]+=c[2]/B)}))}})(x);(function(a){function t(b,a){var c=this.chart,e=this.options.animation,d=this.group,f=this.markerGroup,h=this.xAxis.center,k=c.plotLeft,p=c.plotTop;c.polar?c.renderer.isSVG&&(!0===e&&(e={}),a?(b={translateX:h[0]+k,translateY:h[1]+p,scaleX:.001,scaleY:.001},d.attr(b),f&&f.attr(b)):(b={translateX:k,translateY:p,scaleX:1,scaleY:1},d.animate(b,e),f&&f.animate(b,e),this.animate=null)):b.call(this,a)}var v=a.each,w=a.pick,n=a.seriesTypes,m=a.wrap,e=a.Series.prototype,k=a.Pointer.prototype;e.searchPointByAngle=function(b){var a=this.chart,e=this.xAxis.pane.center;return this.searchKDTree({clientX:180+-180/Math.PI*Math.atan2(b.chartX-e[0]-a.plotLeft,b.chartY-e[1]-a.plotTop)})};e.getConnectors=function(b,a,e,g){var c,f,h,l,k,m,n,t;f=g?1:0;c=0<=a&&a<=b.length-1?a:0>a?b.length-1+a:0;a=0>c-1?b.length-(1+f):c-1;f=c+1>b.length-1?f:c+1;h=b[a];f=b[f];l=h.plotX;h=h.plotY;k=f.plotX;m=f.plotY;f=b[c].plotX;c=b[c].plotY;l=(1.5*f+l)/2.5;h=(1.5*c+h)/2.5;k=(1.5*f+k)/2.5;n=(1.5*c+m)/2.5;m=Math.sqrt(Math.pow(l-f,2)+Math.pow(h-c,2));t=Math.sqrt(Math.pow(k-f,2)+Math.pow(n-c,2));l=Math.atan2(h-c,l-f);n=Math.PI/2+(l+Math.atan2(n-c,k-f))/2;Math.abs(l-n)>Math.PI/2&&(n-=Math.PI);l=f+Math.cos(n)*m;h=c+Math.sin(n)*m;k=f+Math.cos(Math.PI+n)*t;n=c+Math.sin(Math.PI+n)*t;f={rightContX:k,rightContY:n,leftContX:l,leftContY:h,plotX:f,plotY:c};e&&(f.prevPointCont=this.getConnectors(b,a,!1,g));return f};m(e,"buildKDTree",function(b){this.chart.polar&&(this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.options.findNearestPointBy="xy");b.apply(this)});e.toXY=function(b){var a,e=this.chart,g=b.plotX;a=b.plotY;b.rectPlotX=g;b.rectPlotY=a;a=this.xAxis.postTranslate(b.plotX,this.yAxis.len-a);b.plotX=b.polarPlotX=a.x-e.plotLeft;b.plotY=b.polarPlotY=a.y-e.plotTop;this.kdByAngle?(e=(g/Math.PI*180+this.xAxis.pane.options.startAngle)%360,0>e&&(e+=360),b.clientX=e):b.clientX=b.plotX};n.spline&&(m(n.spline.prototype,"getPointSpline",function(b,a,e,g){this.chart.polar?g?(b=this.getConnectors(a,g,!0,this.connectEnds),b=["C",b.prevPointCont.rightContX,b.prevPointCont.rightContY,b.leftContX,b.leftContY,b.plotX,b.plotY]):b=["M",e.plotX,e.plotY]:b=b.call(this,a,e,g);return b}),n.areasplinerange&&(n.areasplinerange.prototype.getPointSpline=n.spline.prototype.getPointSpline));m(e,"translate",function(b){var a=this.chart;b.call(this);if(a.polar&&(this.kdByAngle=a.tooltip&&a.tooltip.shared,!this.preventPostTranslate)){for(b=this.points,a=b.length;a--;){this.toXY(b[a])}}});m(e,"getGraphPath",function(b,a){var c=this,e,d,f;if(this.chart.polar){a=a||this.points;for(e=0;e<a.length;e++){if(!a[e].isNull){d=e;break}}!1!==this.options.connectEnds&&void 0!==d&&(this.connectEnds=!0,a.splice(a.length,0,a[d]),f=!0);v(a,function(b){void 0===b.polarPlotY&&c.toXY(b)})}e=b.apply(this,[].slice.call(arguments,1));f&&a.pop();return e});m(e,"animate",t);n.column&&(n=n.column.prototype,n.polarArc=function(b,a,e,g){var c=this.xAxis.center,f=this.yAxis.len;return this.chart.renderer.symbols.arc(c[0],c[1],f-a,null,{start:e,end:g,innerR:f-w(b,f)})},m(n,"animate",t),m(n,"translate",function(b){var a=this.xAxis,e=a.startAngleRad,g,d,f;this.preventPostTranslate=!0;b.call(this);if(a.isRadial){for(g=this.points,f=g.length;f--;){d=g[f],b=d.barX+e,d.shapeType="path",d.shapeArgs={d:this.polarArc(d.yBottom,d.plotY,b,b+d.pointWidth)},this.toXY(d),d.tooltipPos=[d.plotX,d.plotY],d.ttBelow=d.plotY>a.center[1]}}}),m(n,"alignDataLabel",function(a,c,l,g,d,f){this.chart.polar?(a=c.rectPlotX/Math.PI*180,null===g.align&&(g.align=20<a&&160>a?"left":200<a&&340>a?"right":"center"),null===g.verticalAlign&&(g.verticalAlign=45>a||315<a?"bottom":135<a&&225>a?"top":"middle"),e.alignDataLabel.call(this,c,l,g,d,f)):a.call(this,c,l,g,d,f)}));m(k,"getCoordinates",function(a,c){var b=this.chart,e={xAxis:[],yAxis:[]};b.polar?v(b.axes,function(a){var d=a.isXAxis,g=a.center,k=c.chartX-g[0]-b.plotLeft,g=c.chartY-g[1]-b.plotTop;e[d?"xAxis":"yAxis"].push({axis:a,value:a.translate(d?Math.PI-Math.atan2(k,g):Math.sqrt(Math.pow(k,2)+Math.pow(g,2)),!0)})}):e=a.call(this,c);return e});m(a.Chart.prototype,"getAxes",function(b){this.pane||(this.pane=[]);v(a.splat(this.options.pane),function(b){new a.Pane(b,this)},this);b.call(this)});m(a.Chart.prototype,"drawChartBox",function(a){a.call(this);v(this.pane,function(a){a.render()})});m(a.Chart.prototype,"get",function(b,c){return a.find(this.pane,function(a){return a.options.id===c})||b.call(this,c)})})(x)})});var annotations=createCommonjsModule(function(module){(function(m){"object"==="object"&&module.exports?module.exports=m:m(Highcharts)})(function(m){(function(f){var n=f.merge,m=f.addEvent,v=f.extend,l=f.each,C=f.isString,x=f.isNumber,u=f.defined,D=f.isObject,E=f.inArray,y=f.erase,F=f.find,G=f.format,p=f.pick,H=f.destroyObjectProperties,z=f.Tooltip.prototype,I=f.Series.prototype,w=f.Chart.prototype,J={arrow:{render:!1,id:"arrow",refY:5,refX:5,markerWidth:10,markerHeight:10,children:[{tagName:"path",attrs:{d:"M 0 0 L 10 5 L 0 10 Z",strokeWidth:0}}]}},q={markerSetter:function(a){return function(b){this.attr(a,"url(#"+b+")")}}};v(q,{markerEndSetter:q.markerSetter("marker-end"),markerStartSetter:q.markerSetter("marker-start")});f.SVGRenderer.prototype.addMarker=function(a,b){a=p(a,f.uniqueKey());var c=this.createElement("marker").attr({id:a,markerWidth:p(b.markerWidth,20),markerHeight:p(b.markerHeight,20),refX:b.refX||0,refY:b.refY||0,orient:b.orient||"auto"}).add(this.defs),d={stroke:b.color||"none",fill:b.color||"rgba(0, 0, 0, 0.75)"};b=b.children;c.id=a;l(b,function(a){this.createElement(a.tagName).attr(n(d,a.attrs)).add(c)},this);return c};var A=f.MockPoint=function(a,b){this.mock=!0;this.series={visible:!0,chart:a,getPlotBox:I.getPlotBox};this.init(a,b)},K=f.mockPoint=function(a,b){return new A(a,b)};A.prototype={init:function(a,b){var c=b.xAxis,c=u(c)?a.xAxis[c]||a.get(c):null,d=b.yAxis;a=u(d)?a.yAxis[d]||a.get(d):null;c?(this.x=b.x,this.series.xAxis=c):this.plotX=b.x;a?(this.y=b.y,this.series.yAxis=a):this.plotY=b.y},translate:function(){var a=this.series,b=a.xAxis,a=a.yAxis,c;c=!0;b&&(this.plotX=c=b.toPixels(this.x,!0),c=0<=c&&c<=b.len);a&&(this.plotY=b=a.toPixels(this.y,!0),c=c&&0<=b&&b<=a.len);this.isInside=c},alignToBox:function(a){a&&this.translate();a=this.plotX;var b=this.plotY,c;this.series.chart.inverted&&(c=a,a=b,b=c);return[a,b,0,0]},getLabelConfig:function(){return{x:this.x,y:this.y,point:this}}};f.defaultOptions.annotations=[];var B=f.Annotation=function(a,b){this.chart=a;this.labels=[];this.shapes=[];this.options=n(this.defaultOptions,b);this.init(a,b)};B.prototype={shapesWithoutBackground:["connector"],attrsMap:{backgroundColor:"fill",borderColor:"stroke",borderWidth:"stroke-width",strokeWidth:"stroke-width",stroke:"stroke",fill:"fill",zIndex:"zIndex",width:"width",height:"height",borderRadius:"r",r:"r",padding:"padding",dashStyle:"dashstyle"},defaultOptions:{visible:!0,labelOptions:{align:"center",allowOverlap:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",borderColor:"black",borderRadius:1,borderWidth:1,crop:!1,formatter:function(){return u(this.y)?this.y:"Annotation label"},overflow:"justify",padding:5,shadow:!1,shape:"callout",style:{fontSize:"11px",fontWeight:"normal",color:"contrast"},useHTML:!1,verticalAlign:"bottom",x:0,y:-16},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1,fill:"rgba(0, 0, 0, 0.75)",r:0},zIndex:6},init:function(){var a=this;l(this.options.labels||[],this.initLabel,this);l(this.options.shapes||[],this.initShape,this);this.chart.labelCollectors.push(function(){var b=[];l(a.labels,function(a){a.options.allowOverlap||b.push(a)});return b})},redraw:function(){this.group||this.render();this.redrawItems(this.shapes);this.redrawItems(this.labels)},redrawItems:function(a){for(var b=a.length;b--;){this.redrawItem(a[b])}},render:function(){var a=this.chart.renderer,b=this.group=a.g("annotation").attr({zIndex:this.options.zIndex,visibility:this.options.visible?"visible":"hidden"}).add();this.shapesGroup=a.g("annotation-shapes").add(b);this.labelsGroup=a.g("annotation-labels").attr({translateX:0,translateY:0}).add(b);this.shapesGroup.clip(this.chart.plotBoxClip)},setVisible:function(a){var b=this.options;a=p(a,!b.visible);this.group.attr({visibility:a?"visible":"hidden"});b.visible=a},destroy:function(){var a=this.chart;l(this.labels,function(a){a.destroy()});l(this.shapes,function(a){a.destroy()});H(this,a)},initShape:function(a){var b=this.chart.renderer;a=n(this.options.shapeOptions,a);var c=this.attrsFromOptions(a),d=b[a.type]?a.type:"rect",b=b[d](0,-9e9,0,0);b.points=[];b.type=d;b.options=a;b.itemType="shape";"path"===d&&v(b,{markerStartSetter:q.markerStartSetter,markerEndSetter:q.markerEndSetter,markerStart:q.markerStart,markerEnd:q.markerEnd});b.attr(c);this.shapes.push(b)},initLabel:function(a){a=n(this.options.labelOptions,a);var b=a.style,c=this.attrsFromOptions(a),d=this.chart.renderer.label("",0,-9e9,a.shape,null,null,a.useHTML,null,"annotation-label");"contrast"===b.color&&(b.color=this.chart.renderer.getContrast(-1<E(a.shape,this.shapesWithoutBackground)?"#FFFFFF":a.backgroundColor));d.points=[];d.options=a;d.itemType="label";d.labelrank=a.labelrank;d.annotation=this;d.attr(c).css(b).shadow(a.shadow);this.labels.push(d)},redrawItem:function(a){var b=this.linkPoints(a),c=a.options,d;b.length?(a.parentGroup||this.renderItem(a),"label"===a.itemType&&(d=c.format||c.text,a.attr({text:d?G(d,b[0].getLabelConfig()):c.formatter.call(b[0])})),"path"===a.type?this.redrawPath(a):this.alignItem(a,!a.placed)):this.destroyItem(a)},destroyItem:function(a){y(this[a.itemType+"s"],a);a.destroy()},pointItem:function(a,b){b&&null!==b.series||(D(a)?b=K(this.chart,a):C(a)&&(b=this.chart.get(a)||null));return b},linkPoints:function(a){var b=a.options.points||a.options.point&&f.splat(a.options.point),c=a.points,d=b&&b.length,e,t;for(e=0;e<d;e++){t=this.pointItem(b[e],c[e]);if(!t){return a.points=[]}c[e]=t}return c},alignItem:function(a,b){var c=this.itemAnchor(a,a.points[0]),d=this.itemPosition(a,c);d?(a.alignAttr=d,a.placed=!0,d.anchorX=c.absolutePosition.x,d.anchorY=c.absolutePosition.y,a[b?"attr":"animate"](d)):(a.placed=!1,a.attr({x:0,y:-9e9}))},redrawPath:function(a,b){var c=a.points,d=a["stroke-width"],e=["M"],f=0,g=0,h=c&&c.length,k,r;if(h){do{r=c[f],k=this.itemAnchor(a,r).absolutePosition,e[++g]=k.x,e[++g]=k.y,k=g%5,0===k&&(e[k+1]===e[k+4]&&(e[k+1]=e[k+4]=Math.round(e[k+1])-d%2/2),e[k+2]===e[k+5]&&(e[k+2]=e[k+5]=Math.round(e[k+2])+d%2/2)),f<h-1&&(e[++g]="L"),r=r.series.visible}while(++f<h&&r)}if(r){a[b?"attr":"animate"]({d:e})}else{a.attr({d:"M 0 -9000000000"})}a.placed=r},renderItem:function(a){a.add("label"===a.itemType?this.labelsGroup:this.shapesGroup);this.setItemMarkers(a)},setItemMarkers:function(a){var b=a.options,c=this.chart,d=c.options.defs.markers,e=b.fill,f=u(e)&&"none"!==e?e:b.stroke;l(["markerStart","markerEnd"],function(e){var h=b[e],k,g,t;if(h){for(t in d){if(k=d[t],h===k.id){g=k;break}}g&&(k=a[e]=c.renderer.addMarker(null,n(g,{color:f})),a.attr(e,k.id))}})},itemAnchor:function(a,b){a=b.series.getPlotBox();b=b.mock?b.alignToBox(!0):z.getAnchor.call({chart:this.chart},b);b={x:b[0],y:b[1],height:b[2]||0,width:b[3]||0};return{relativePosition:b,absolutePosition:n(b,{x:b.x+a.translateX,y:b.y+a.translateY})}},itemPosition:function(a,b){var c=this.chart,d=a.points[0],e=a.options,f=b.absolutePosition,g=b.relativePosition,h;if(b=d.series.visible&&!1!==d.isInside){u(e.distance)||e.positioner?h=(e.positioner||z.getPosition).call({chart:c,distance:p(e.distance,16)},a.width,a.height,{plotX:g.x,plotY:g.y,negative:d.negative,ttBelow:d.ttBelow,h:g.height||g.width}):(d={x:f.x,y:f.y,width:0,height:0},h=this.alignedPosition(v(e,{width:a.width,height:a.height}),d),"justify"===a.options.overflow&&(h=this.alignedPosition(this.justifiedOptions(a,e,h),d))),e.crop&&(e=h.x-c.plotLeft,d=h.y-c.plotTop,b=c.isInsidePlot(e,d)&&c.isInsidePlot(e+a.width,d+a.height))}return b?h:null},alignedPosition:function(a,b){var c=a.align,d=a.verticalAlign,e=(b.x||0)+(a.x||0),f=(b.y||0)+(a.y||0),g,h;"right"===c?g=1:"center"===c&&(g=2);g&&(e+=(b.width-(a.width||0))/g);"bottom"===d?h=1:"middle"===d&&(h=2);h&&(f+=(b.height-(a.height||0))/h);return{x:Math.round(e),y:Math.round(f)}},justifiedOptions:function(a,b,c){var d=this.chart,e=b.align,f=b.verticalAlign,g=a.box?0:a.padding||0,h=a.getBBox();a={align:e,verticalAlign:f,x:b.x,y:b.y,width:a.width,height:a.height};b=c.x-d.plotLeft;var k=c.y-d.plotTop;c=b+g;0>c&&("right"===e?a.align="left":a.x=-c);c=b+h.width-g;c>d.plotWidth&&("left"===e?a.align="right":a.x=d.plotWidth-c);c=k+g;0>c&&("bottom"===f?a.verticalAlign="top":a.y=-c);c=k+h.height-g;c>d.plotHeight&&("top"===f?a.verticalAlign="bottom":a.y=d.plotHeight-c);return a},attrsFromOptions:function(a){var b=this.attrsMap,c={},d,e;for(d in a){(e=b[d])&&(c[e]=a[d])}return c}};f.extend(w,{addAnnotation:function(a,b){a=new B(this,a);this.annotations.push(a);p(b,!0)&&a.redraw();return a},removeAnnotation:function(a){var b=this.annotations,c=F(b,function(b){return b.options.id===a});c&&(y(b,c),c.destroy())},drawAnnotations:function(){var a=this.plotBoxClip,b=this.plotBox;a?a.attr(b):this.plotBoxClip=this.renderer.clipRect(b);l(this.annotations,function(a){a.redraw()})}});w.callbacks.push(function(a){a.annotations=[];l(a.options.annotations,function(b){a.addAnnotation(b,!1)});a.drawAnnotations();m(a,"redraw",a.drawAnnotations);m(a,"destroy",function(){var b=a.plotBoxClip;b&&b.destroy&&b.destroy()})});f.wrap(w,"getContainer",function(a){a.call(this);a=this.renderer;var b=this.options,c,d;b.defs=n(b.defs||{},{markers:J});b=b.defs.markers;for(c in b){d=b[c],p(d.render,!0)&&a.addMarker(d.id,d)}});f.SVGRenderer.prototype.symbols.connector=function(a,b,c,d,e){var f=e&&e.anchorX;e=e&&e.anchorY;var g,h,k=c/2;x(f)&&x(e)&&(g=["M",f,e],h=b-e,0>h&&(h=-d-h),h<c&&(k=f<a+c/2?h:c-h),e>b+d?g.push("L",a+k,b+d):e<b?g.push("L",a+k,b):f<a?g.push("L",a,b+d/2):f>a+c&&g.push("L",a+c,b+d/2));return g||[]}})(m)})});var boost=createCommonjsModule(function(module){(function(v){"object"==="object"&&module.exports?module.exports=v:v(Highcharts)})(function(v){(function(l){function v(){var a=Array.prototype.slice.call(arguments),c=-Number.MAX_VALUE;y(a,function(a){if("undefined"!==typeof a&&null!==a&&"undefined"!==typeof a.length&&0<a.length){return c=a.length,!0}});return c}function N(a){var c=0,d=0,f=!0,b;if("undefined"!==typeof a.boostForceChartBoost){return a.boostForceChartBoost}f=a.options.boost?"undefined"!==typeof a.options.boost.allowForce?a.options.boost.allowForce:f:f;if(1<a.series.length){for(var m=0;m<a.series.length;m++){b=a.series[m],P[b.type]&&++d,v(b.processedXData,b.options.data,b.points)>=(b.options.boostThreshold||Number.MAX_VALUE)&&++c}}a.boostForceChartBoost=f&&d===a.series.length&&0<c||5<c;return a.boostForceChartBoost}function ia(a){function c(b,c){c=a.createShader("vertex"===c?a.VERTEX_SHADER:a.FRAGMENT_SHADER);a.shaderSource(c,b);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:!1}function d(){function b(b){return a.getUniformLocation(m,b)}var d=c("#version 100\nprecision highp float;\nattribute vec4 aVertexPosition;\nattribute vec4 aColor;\nvarying highp vec2 position;\nvarying highp vec4 vColor;\nuniform mat4 uPMatrix;\nuniform float pSize;\nuniform float translatedThreshold;\nuniform bool hasThreshold;\nuniform bool skipTranslation;\nuniform float plotHeight;\nuniform float xAxisTrans;\nuniform float xAxisMin;\nuniform float xAxisMinPad;\nuniform float xAxisPointRange;\nuniform float xAxisLen;\nuniform bool  xAxisPostTranslate;\nuniform float xAxisOrdinalSlope;\nuniform float xAxisOrdinalOffset;\nuniform float xAxisPos;\nuniform bool  xAxisCVSCoord;\nuniform float yAxisTrans;\nuniform float yAxisMin;\nuniform float yAxisMinPad;\nuniform float yAxisPointRange;\nuniform float yAxisLen;\nuniform bool  yAxisPostTranslate;\nuniform float yAxisOrdinalSlope;\nuniform float yAxisOrdinalOffset;\nuniform float yAxisPos;\nuniform bool  yAxisCVSCoord;\nuniform bool  isBubble;\nuniform bool  bubbleSizeByArea;\nuniform float bubbleZMin;\nuniform float bubbleZMax;\nuniform float bubbleZThreshold;\nuniform float bubbleMinSize;\nuniform float bubbleMaxSize;\nuniform bool  bubbleSizeAbs;\nuniform bool  isInverted;\nfloat bubbleRadius(){\nfloat value = aVertexPosition.w;\nfloat zMax = bubbleZMax;\nfloat zMin = bubbleZMin;\nfloat radius = 0.0;\nfloat pos = 0.0;\nfloat zRange = zMax - zMin;\nif (bubbleSizeAbs){\nvalue = value - bubbleZThreshold;\nzMax = max(zMax - bubbleZThreshold, zMin - bubbleZThreshold);\nzMin = 0.0;\n}\nif (value < zMin){\nradius = bubbleZMin / 2.0 - 1.0;\n} else {\npos = zRange > 0.0 ? (value - zMin) / zRange : 0.5;\nif (bubbleSizeByArea && pos > 0.0){\npos = sqrt(pos);\n}\nradius = ceil(bubbleMinSize + pos * (bubbleMaxSize - bubbleMinSize)) / 2.0;\n}\nreturn radius * 2.0;\n}\nfloat translate(float val,\nfloat pointPlacement,\nfloat localA,\nfloat localMin,\nfloat minPixelPadding,\nfloat pointRange,\nfloat len,\nbool  cvsCoord\n){\nfloat sign = 1.0;\nfloat cvsOffset = 0.0;\nif (cvsCoord) {\nsign *= -1.0;\ncvsOffset = len;\n}\nreturn sign * (val - localMin) * localA + cvsOffset + \n(sign * minPixelPadding);\n}\nfloat xToPixels(float value){\nif (skipTranslation){\nreturn value;// + xAxisPos;\n}\nreturn translate(value, 0.0, xAxisTrans, xAxisMin, xAxisMinPad, xAxisPointRange, xAxisLen, xAxisCVSCoord);// + xAxisPos;\n}\nfloat yToPixels(float value, float checkTreshold){\nfloat v;\nif (skipTranslation){\nv = value;// + yAxisPos;\n} else {\nv = translate(value, 0.0, yAxisTrans, yAxisMin, yAxisMinPad, yAxisPointRange, yAxisLen, yAxisCVSCoord);// + yAxisPos;\nif (v > plotHeight) {\nv = plotHeight;\n}\n}\nif (checkTreshold > 0.0 && hasThreshold) {\nv = min(v, translatedThreshold);\n}\nreturn v;\n}\nvoid main(void) {\nif (isBubble){\ngl_PointSize = bubbleRadius();\n} else {\ngl_PointSize = pSize;\n}\nvColor = aColor;\nif (isInverted) {\ngl_Position = uPMatrix * vec4(xToPixels(aVertexPosition.y) + yAxisPos, yToPixels(aVertexPosition.x, aVertexPosition.z) + xAxisPos, 0.0, 1.0);\n} else {\ngl_Position = uPMatrix * vec4(xToPixels(aVertexPosition.x) + xAxisPos, yToPixels(aVertexPosition.y, aVertexPosition.z) + yAxisPos, 0.0, 1.0);\n}\n}","vertex"),f=c("precision highp float;\nuniform vec4 fillColor;\nvarying highp vec2 position;\nvarying highp vec4 vColor;\nuniform sampler2D uSampler;\nuniform bool isCircle;\nuniform bool hasColor;\nvoid main(void) {\nvec4 col = fillColor;\nvec4 tcol;\nif (hasColor) {\ncol = vColor;\n}\nif (isCircle) {\ntcol = texture2D(uSampler, gl_PointCoord.st);\ncol *= tcol;\nif (tcol.r < 0.0) {\ndiscard;\n} else {\ngl_FragColor = col;\n}\n} else {\ngl_FragColor = col;\n}\n}","fragment");if(!d||!f){return m=!1}m=a.createProgram();a.attachShader(m,d);a.attachShader(m,f);a.linkProgram(m);a.useProgram(m);a.bindAttribLocation(m,0,"aVertexPosition");l=b("uPMatrix");n=b("pSize");g=b("fillColor");T=b("isBubble");h=b("bubbleSizeAbs");A=b("bubbleSizeByArea");y=b("uSampler");e=b("skipTranslation");z=b("isCircle");k=b("isInverted");E=b("plotHeight");return!0}function f(c,e){c=b[c]=b[c]||a.getUniformLocation(m,c);a.uniform1f(c,e)}var b={},m,l,n,g,T,h,A,e,z,k,E,y;a&&d();return{psUniform:function(){return n},pUniform:function(){return l},fillColorUniform:function(){return g},setPlotHeight:function(b){a.uniform1f(E,b)},setBubbleUniforms:function(b,c,e){var d=b.options,m=Number.MAX_VALUE,l=-Number.MAX_VALUE;"bubble"===b.type&&(m=M(d.zMin,Math.min(m,Math.max(c,!1===d.displayNegative?d.zThreshold:-Number.MAX_VALUE))),l=M(d.zMax,Math.max(l,e)),a.uniform1i(T,1),a.uniform1i(z,1),a.uniform1i(A,"width"!==b.options.sizeBy),a.uniform1i(h,b.options.sizeByAbsoluteValue),f("bubbleZMin",m),f("bubbleZMax",l),f("bubbleZThreshold",b.options.zThreshold),f("bubbleMinSize",b.minPxSize),f("bubbleMaxSize",b.maxPxSize))},bind:function(){a.useProgram(m)},program:function(){return m},create:d,setUniform:f,setPMatrix:function(b){a.uniformMatrix4fv(l,!1,b)},setColor:function(b){a.uniform4f(g,b[0]/255,b[1]/255,b[2]/255,b[3])},setPointSize:function(b){a.uniform1f(n,b)},setSkipTranslation:function(b){a.uniform1i(e,!0===b?1:0)},setTexture:function(){a.uniform1i(y,0)},setDrawAsCircle:function(b){a.uniform1i(z,b?1:0)},reset:function(){a.uniform1i(T,0);a.uniform1i(z,0)},setInverted:function(b){a.uniform1i(k,b)},destroy:function(){a&&m&&(a.deleteProgram(m),m=!1)}}}function Z(a,c,d){function f(){b&&(a.deleteBuffer(b),m=b=!1);g=0;l=d||2;k=[]}var b=!1,m=!1,l=d||2,n=!1,g=0,k;return{destroy:f,bind:function(){if(!b){return!1}a.vertexAttribPointer(m,l,a.FLOAT,!1,0,0)},data:k,build:function(d,g,e){var h;k=d||[];if(!(k&&0!==k.length||n)){return f(),!1}l=e||l;b&&a.deleteBuffer(b);n||(h=new Float32Array(k));b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);a.bufferData(a.ARRAY_BUFFER,n||h,a.STATIC_DRAW);m=a.getAttribLocation(c.program(),g);a.enableVertexAttribArray(m);return!0},render:function(c,d,e){var f=n?n.length:k.length;if(!b||!f){return!1}if(!c||c>f||0>c){c=0}if(!d||d>f){d=f}a.drawArrays(a[(e||"points").toUpperCase()],c/l,(d-c)/l);return!0},allocate:function(a){g=-1;n=new Float32Array(4*a)},push:function(a,b,c,d){n&&(n[++g]=a,n[++g]=b,n[++g]=c,n[++g]=d)}}}function ja(a){function c(a){var b,c;return a.isSeriesBoosting?(b=!!a.options.stacking,c=a.xData||a.options.xData||a.processedXData,b=(b?a.data:c||a.options.data).length,"treemap"===a.type?b*=12:"heatmap"===a.type?b*=6:O[a.type]&&(b*=2),b):0}function d(){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function f(a,b){function c(a){a&&(b.colorData.push(a[0]),b.colorData.push(a[1]),b.colorData.push(a[2]),b.colorData.push(a[3]))}function d(a,b,d,e,f){c(f);q.usePreallocated?A.push(a,b,d?1:0,e||1):(E.push(a),E.push(b),E.push(d?1:0),E.push(e||1))}function e(a,b,e,f,r){c(r);d(a+e,b);c(r);d(a,b);c(r);d(a,b+f);c(r);d(a,b+f);c(r);d(a+e,b+f);c(r);d(a+e,b)}function f(a){q.useGPUTranslations||(b.skipTranslation=!0,a.x=G.toPixels(a.x,!0),a.y=H.toPixels(a.y,!0));d(a.x,a.y,0,2)}var ka=a.pointArrayMap&&"low,high"===a.pointArrayMap.join(","),h=a.chart,r=a.options,m=!!r.stacking,g=r.data,n=a.xAxis.getExtremes(),k=n.min,n=n.max,w=a.yAxis.getExtremes(),z=w.min,w=w.max,p=a.xData||r.xData||a.processedXData,C=a.yData||r.yData||a.processedYData,v=a.zData||r.zData||a.processedZData,H=a.yAxis,G=a.xAxis,Y=a.chart.plotHeight,U=!p||0===p.length,t=a.points||!1,F=!1,I=!1,x,Q,R,g=m?a.data:p||g,p={x:Number.MIN_VALUE,y:0},J={x:Number.MIN_VALUE,y:0},T=0,u,K,B=-1,D=!1,V=!1,M="undefined"===typeof h.index,S=!1,L=!1,W=O[a.type],N=!1,P=!0;if(!(r.boostData&&0<r.boostData.length)){if(a.closestPointRangePx=Number.MAX_VALUE,t&&0<t.length){b.skipTranslation=!0,b.drawMode="triangles",t[0].node&&t[0].node.levelDynamic&&t.sort(function(a,b){if(a.node){if(a.node.levelDynamic>b.node.levelDynamic){return 1}if(a.node.levelDynamic<b.node.levelDynamic){return-1}}return 0}),y(t,function(b){var c=b.plotY,d;"undefined"===typeof c||isNaN(c)||null===b.y||(c=b.shapeArgs,d=b.series.pointAttribs(b),b=d["stroke-width"]||0,Q=l.color(d.fill).rgba,Q[0]/=255,Q[1]/=255,Q[2]/=255,"treemap"===a.type&&(b=b||1,R=l.color(d.stroke).rgba,R[0]/=255,R[1]/=255,R[2]/=255,e(c.x,c.y,c.width,c.height,R),b/=2),"heatmap"===a.type&&h.inverted&&(c.x=G.len-c.x,c.y=H.len-c.y,c.width=-c.width,c.height=-c.height),e(c.x+b,c.y+b,c.width-2*b,c.height-2*b,Q))})}else{for(;B<g.length-1;){x=g[++B];if(M){break}U?(t=x[0],u=x[1],g[B+1]&&(V=g[B+1][0]),g[B-1]&&(D=g[B-1][0]),3<=x.length&&(K=x[2],x[2]>b.zMax&&(b.zMax=x[2]),x[2]<b.zMin&&(b.zMin=x[2]))):(t=x,u=C[B],g[B+1]&&(V=g[B+1]),g[B-1]&&(D=g[B-1]),v&&v.length&&(K=v[B],v[B]>b.zMax&&(b.zMax=v[B]),v[B]<b.zMin&&(b.zMin=v[B])));V&&V>=k&&V<=n&&(S=!0);D&&D>=k&&D<=n&&(L=!0);ka?(U&&(u=x.slice(1,3)),u=u[1]):m&&(t=x.x,u=x.stackY);a.requireSorting||(P=u>=z&&u<=w);t>n&&J.x<n&&(J.x=t,J.y=u);t<k&&p.x<k&&(p.x=t,p.y=u);if(0===u||u&&P){if(t>=k&&t<=n&&(N=!0),N||S||L){q.useGPUTranslations||(b.skipTranslation=!0,t=G.toPixels(t,!0),u=H.toPixels(u,!0),u>Y&&(u=Y)),W&&(x=0,0>u&&(x=u,u=0),q.useGPUTranslations||(x=H.toPixels(x,!0)),d(t,x,0,0,!1)),b.hasMarkers&&!1!==F&&(a.closestPointRangePx=Math.min(a.closestPointRangePx,Math.abs(t-F))),!q.useGPUTranslations&&!q.usePreallocated&&F&&1>t-F&&I&&1>Math.abs(u-I)?q.debug.showSkipSummary&&++T:(r.step&&d(t,I,0,2,!1),d(t,u,0,"bubble"===a.type?K||1:2,!1),F=t,I=u)}}}q.debug.showSkipSummary&&console.log("skipped points:",T);F||(f(p),f(J))}}}function b(){w=[];I.data=E=[];U=[];A&&A.destroy()}function m(a){h&&(h.setUniform("xAxisTrans",a.transA),h.setUniform("xAxisMin",a.min),h.setUniform("xAxisMinPad",a.minPixelPadding),h.setUniform("xAxisPointRange",a.pointRange),h.setUniform("xAxisLen",a.len),h.setUniform("xAxisPos",a.pos),h.setUniform("xAxisCVSCoord",!a.horiz))}function g(a){h&&(h.setUniform("yAxisTrans",a.transA),h.setUniform("yAxisMin",a.min),h.setUniform("yAxisMinPad",a.minPixelPadding),h.setUniform("yAxisPointRange",a.pointRange),h.setUniform("yAxisLen",a.len),h.setUniform("yAxisPos",a.pos),h.setUniform("yAxisCVSCoord",!a.horiz))}function n(a,b){h.setUniform("hasThreshold",a);h.setUniform("translatedThreshold",b)}function k(c){if(c){z=c.chartWidth||800,H=c.chartHeight||400}else{return!1}if(!e||!z||!H){return!1}q.debug.timeRendering&&console.time("gl rendering");e.canvas.width=z;e.canvas.height=H;h.bind();e.viewport(0,0,z,H);h.setPMatrix([2/z,0,0,0,0,-(2/H),0,0,0,0,-2,0,-1,1,-1,1]);h.setPlotHeight(c.plotHeight);1<q.lineWidth&&!l.isMS&&e.lineWidth(q.lineWidth);A.build(I.data,"aVertexPosition",4);A.bind();v&&(e.bindTexture(e.TEXTURE_2D,G),h.setTexture(G));h.setInverted(c.inverted);y(w,function(a,b){var c=a.series.options,d=c.threshold,f=K(d),d=a.series.yAxis.getThreshold(d),r=M(c.marker?c.marker.enabled:null,a.series.xAxis.isRadial?!0:null,a.series.closestPointRangePx>2*((c.marker?c.marker.radius:10)||10)),k=a.series.pointAttribs&&a.series.pointAttribs().fill||a.series.color;a.series.fillOpacity&&c.fillOpacity&&(k=new aa(k).setOpacity(M(c.fillOpacity,1)).get());c.colorByPoint&&(k=a.series.chart.options.colors[b]);k=l.color(k).rgba;q.useAlpha||(k[3]=1);"lines"===a.drawMode&&q.useAlpha&&1>k[3]&&(k[3]/=10);"add"===c.boostBlending?(e.blendFunc(e.SRC_ALPHA,e.ONE),e.blendEquation(e.FUNC_ADD)):"mult"===c.boostBlending?e.blendFunc(e.DST_COLOR,e.ZERO):"darken"===c.boostBlending?(e.blendFunc(e.ONE,e.ONE),e.blendEquation(e.FUNC_MIN)):e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);h.reset();0<a.colorData.length&&(h.setUniform("hasColor",1),b=Z(e,h),b.build(a.colorData,"aColor",4),b.bind());h.setColor(k);m(a.series.xAxis);g(a.series.yAxis);n(f,d);"points"===a.drawMode&&(c.marker&&c.marker.radius?h.setPointSize(2*c.marker.radius):h.setPointSize(1));h.setSkipTranslation(a.skipTranslation);"bubble"===a.series.type&&h.setBubbleUniforms(a.series,a.zMin,a.zMax);h.setDrawAsCircle(S[a.series.type]&&v||!1);A.render(a.from,a.to,a.drawMode);a.hasMarkers&&r&&(c.marker&&c.marker.radius?h.setPointSize(2*c.marker.radius):h.setPointSize(10),h.setDrawAsCircle(!0),A.render(a.from,a.to,"POINTS"))});q.debug.timeRendering&&console.timeEnd("gl rendering");a&&a();b()}function p(a){d();if(a.renderer.forExport){return k(a)}J?k(a):setTimeout(function(){p(a)},1)}var h=!1,A=!1,e=!1,z=0,H=0,E=!1,U=!1,v=!1,I={},J=!1,w=[],F=D.createElement("canvas"),C=F.getContext("2d"),G,O={column:!0,bar:!0,area:!0},S={scatter:!0,bubble:!0},q={pointSize:1,lineWidth:1,fillColor:"#AA00AA",useAlpha:!0,usePreallocated:!1,useGPUTranslations:!1,debug:{timeRendering:!1,timeSeriesProcessing:!1,timeSetup:!1,timeBufferCopy:!1,timeKDTree:!1,showSkipSummary:!1}};return I={allocateBufferForSingleSeries:function(a){var b=0;q.usePreallocated&&(a.isSeriesBoosting&&(b=c(a)),A.allocate(b))},pushSeries:function(a){0<w.length&&(w[w.length-1].to=E.length,w[w.length-1].hasMarkers&&(w[w.length-1].markerTo=U.length));q.debug.timeSeriesProcessing&&console.time("building "+a.type+" series");w.push({from:E.length,markerFrom:U.length,colorData:[],series:a,zMin:Number.MAX_VALUE,zMax:-Number.MAX_VALUE,hasMarkers:a.options.marker?!1!==a.options.marker.enabled:!1,showMarksers:!0,drawMode:{area:"lines",arearange:"lines",areaspline:"line_strip",column:"lines",bar:"lines",line:"line_strip",scatter:"points",heatmap:"triangles",treemap:"triangles",bubble:"points"}[a.type]||"line_strip"});f(a,w[w.length-1]);q.debug.timeSeriesProcessing&&console.timeEnd("building "+a.type+" series")},setSize:function(a,b){if(z!==a||b!==b){z=a,H=b,h.bind(),h.setPMatrix([2/z,0,0,0,0,-(2/H),0,0,0,0,-2,0,-1,1,-1,1])}},inited:function(){return J},setThreshold:n,init:function(a,c){var d=0,f=["webgl","experimental-webgl","moz-webgl","webkit-3d"];J=!1;if(!a){return!1}for(q.debug.timeSetup&&console.time("gl setup");d<f.length&&!(e=a.getContext(f[d],{}));d++){}if(e){c||b()}else{return!1}e.enable(e.BLEND);e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);e.disable(e.DEPTH_TEST);e.depthFunc(e.LESS);h=ia(e);A=Z(e,h);v=!1;G=e.createTexture();F.width=512;F.height=512;C.mozImageSmoothingEnabled=!1;C.webkitImageSmoothingEnabled=!1;C.msImageSmoothingEnabled=!1;C.imageSmoothingEnabled=!1;C.strokeStyle="rgba(255, 255, 255, 0)";C.fillStyle="#FFF";C.beginPath();C.arc(256,256,256,0,2*Math.PI);C.stroke();C.fill();try{e.bindTexture(e.TEXTURE_2D,G),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,F),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),v=!0}catch(ra){}J=!0;q.debug.timeSetup&&console.timeEnd("gl setup");return!0},render:p,settings:q,valid:function(){return!1!==e},clear:d,flush:b,setXAxis:m,setYAxis:g,data:E,gl:function(){return e},allocateBuffer:function(a){var b=0;q.usePreallocated&&(y(a.series,function(a){a.isSeriesBoosting&&(b+=c(a))}),A.allocate(b))},destroy:function(){b();A.destroy();h.destroy();e&&(G&&e.deleteTexture(G),e.canvas.width=1,e.canvas.height=1)},setOptions:function(a){la(!0,q,a)}}}function ba(a,c){var d=a.chartWidth,f=a.chartHeight,b=a,m=a.seriesGroup||c.group,g=D.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1"),b=a.isChartSeriesBoosting()?a:c,g=!1;b.renderTarget||(b.canvas=ma,a.renderer.forExport||!g?(b.renderTarget=a.renderer.image("",0,0,d,f).add(m),b.boostClear=function(){b.renderTarget.attr({href:""})},b.boostCopy=function(){b.boostResizeTarget();b.renderTarget.attr({href:b.canvas.toDataURL("image/png")})}):(b.renderTargetFo=a.renderer.createElement("foreignObject").add(m),b.renderTarget=D.createElement("canvas"),b.renderTargetCtx=b.renderTarget.getContext("2d"),b.renderTargetFo.element.appendChild(b.renderTarget),b.boostClear=function(){b.renderTarget.width=b.canvas.width;b.renderTarget.height=b.canvas.height},b.boostCopy=function(){b.renderTarget.width=b.canvas.width;b.renderTarget.height=b.canvas.height;b.renderTargetCtx.drawImage(b.canvas,0,0)}),b.boostResizeTarget=function(){d=a.chartWidth;f=a.chartHeight;(b.renderTargetFo||b.renderTarget).attr({x:0,y:0,width:d,height:f,style:"pointer-events: none; mix-blend-mode: normal; opacity:1"});b instanceof l.Chart&&b.markerGroup.translate(c.xAxis.pos,c.yAxis.pos)},b.boostClipRect=a.renderer.clipRect(),(b.renderTargetFo||b.renderTarget).clip(b.boostClipRect),b instanceof l.Chart&&(b.markerGroup=b.renderer.g().add(m),b.markerGroup.translate(c.xAxis.pos,c.yAxis.pos)));b.canvas.width=d;b.canvas.height=f;b.boostClipRect.attr(a.getBoostClipRect(b));b.boostResizeTarget();b.boostClear();b.ogl||(b.ogl=ja(function(){b.ogl.settings.debug.timeBufferCopy&&console.time("buffer copy");b.boostCopy();b.ogl.settings.debug.timeBufferCopy&&console.timeEnd("buffer copy")}),b.ogl.init(b.canvas),b.ogl.setOptions(a.options.boost||{}),b instanceof l.Chart&&b.ogl.allocateBuffer(a));b.ogl.setSize(d,f);return b.ogl}function ca(a,c,d){a&&c.renderTarget&&c.canvas&&!(d||c.chart).isChartSeriesBoosting()&&a.render(d||c.chart)}function da(a,c){a&&c.renderTarget&&c.canvas&&!c.chart.isChartSeriesBoosting()&&a.allocateBufferForSingleSeries(c)}function na(a){var c=!0;this.chart.options&&this.chart.options.boost&&(c="undefined"===typeof this.chart.options.boost.enabled?!0:this.chart.options.boost.enabled);if(!c||!this.isSeriesBoosting){return a.call(this)}this.chart.isBoosting=!0;if(a=ba(this.chart,this)){da(a,this),a.pushSeries(this)}ca(a,this)}var O=l.win,D=O.document,oa=function(){},ea=l.Chart,aa=l.Color,p=l.Series,g=l.seriesTypes,y=l.each,fa=l.extend,ga=l.addEvent,pa=l.fireEvent,qa=l.grep,K=l.isNumber,la=l.merge,M=l.pick,k=l.wrap,L=l.getOptions().plotOptions,ma=D.createElement("canvas"),W,ha="area arearange column bar line scatter heatmap bubble treemap".split(" "),P={};y(ha,function(a){P[a]=1});aa.prototype.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};ea.prototype.isChartSeriesBoosting=function(){return(this.options.boost&&"undefined"!==typeof this.options.boost.seriesThreshold?this.options.boost.seriesThreshold:50)<=this.series.length||N(this)};ea.prototype.getBoostClipRect=function(a){var c={x:this.plotLeft,y:this.plotTop,width:this.plotWidth,height:this.plotHeight};a===this&&y(this.yAxis,function(a){c.y=Math.min(a.pos,c.y);c.height=Math.max(a.pos-this.plotTop+a.len,c.height)},this);return c};l.eachAsync=function(a,c,d,f,b,g){b=b||0;f=f||3e4;for(var m=b+f,k=!0;k&&b<m&&b<a.length;){k=c(a[b],b),++b}k&&(b<a.length?g?l.eachAsync(a,c,d,f,b,g):O.requestAnimationFrame?O.requestAnimationFrame(function(){l.eachAsync(a,c,d,f,b)}):setTimeout(function(){l.eachAsync(a,c,d,f,b)}):d&&d())};p.prototype.getPoint=function(a){var c=a,d=this.xData||this.options.xData||this.processedXData||!1;!a||a instanceof this.pointClass||(c=(new this.pointClass).init(this,this.options.data[a.i],d?d[a.i]:void 0),c.category=c.x,c.dist=a.dist,c.distX=a.distX,c.plotX=a.plotX,c.plotY=a.plotY,c.index=a.i);return c};k(p.prototype,"searchPoint",function(a){return this.getPoint(a.apply(this,[].slice.call(arguments,1)))});k(p.prototype,"destroy",function(a){var c=this,d=c.chart;d.markerGroup===c.markerGroup&&(c.markerGroup=null);d.hoverPoints&&(d.hoverPoints=qa(d.hoverPoints,function(a){return a.series===c}));d.hoverPoint&&d.hoverPoint.series===c&&(d.hoverPoint=null);a.call(this)});k(p.prototype,"getExtremes",function(a){if(!this.isSeriesBoosting||!this.hasExtremes||!this.hasExtremes()){return a.apply(this,Array.prototype.slice.call(arguments,1))}});y(ha,function(a){L[a]&&(L[a].boostThreshold=5e3,L[a].boostData=[],g[a].prototype.fillOpacity=!0)});y(["translate","generatePoints","drawTracker","drawPoints","render"],function(a){function c(c){var d=this.options.stacking&&("translate"===a||"generatePoints"===a),b=!0;this.chart&&this.chart.options&&this.chart.options.boost&&(b="undefined"===typeof this.chart.options.boost.enabled?!0:this.chart.options.boost.enabled);if(!this.isSeriesBoosting||d||!b||"heatmap"===this.type||"treemap"===this.type){c.call(this)}else if(this[a+"Canvas"]){this[a+"Canvas"]()}}k(p.prototype,a,c);"translate"===a&&(g.column&&k(g.column.prototype,a,c),g.bar&&k(g.bar.prototype,a,c),g.arearange&&k(g.arearange.prototype,a,c),g.treemap&&k(g.treemap.prototype,a,c),g.heatmap&&k(g.heatmap.prototype,a,c))});k(p.prototype,"processData",function(a){function c(a){return d.chart.isChartSeriesBoosting()||(a?a.length:0)>=(d.options.boostThreshold||Number.MAX_VALUE)}var d=this,f=this.options.data;c(f)&&"heatmap"!==this.type&&"treemap"!==this.type&&this.hasExtremes&&this.hasExtremes(!0)||(a.apply(this,Array.prototype.slice.call(arguments,1)),f=this.processedXData);(this.isSeriesBoosting=c(f))?this.enterBoost():this.exitBoost&&this.exitBoost()});k(p.prototype,"setVisible",function(a,c,d){a.call(this,c,d);!1===this.visible&&this.canvas&&this.renderTarget&&(this.ogl&&this.ogl.clear(),this.boostClear())});p.prototype.enterBoost=function(){this.alteredByBoost=[];y(["allowDG","directTouch","stickyTracking"],function(a){this.alteredByBoost.push({prop:a,val:this[a],own:this.hasOwnProperty(a)})},this);this.directTouch=this.allowDG=!1;this.stickyTracking=!0;this.animate=null;this.labelBySeries&&(this.labelBySeries=this.labelBySeries.destroy())};p.prototype.exitBoost=function(){y(this.alteredByBoost||[],function(a){a.own?this[a.prop]=a.val:delete this[a.prop]},this);this.boostClear&&this.boostClear()};p.prototype.hasExtremes=function(a){var c=this.options,d=this.xAxis&&this.xAxis.options,f=this.yAxis&&this.yAxis.options;return c.data.length>(c.boostThreshold||Number.MAX_VALUE)&&K(f.min)&&K(f.max)&&(!a||K(d.min)&&K(d.max))};p.prototype.destroyGraphics=function(){var a=this,c=this.points,d,f;if(c){for(f=0;f<c.length;f+=1){(d=c[f])&&d.graphic&&(d.graphic=d.graphic.destroy())}}y(["graph","area","tracker"],function(b){a[b]&&(a[b]=a[b].destroy())})};(function(){var a=0,c,d=["webgl","experimental-webgl","moz-webgl","webkit-3d"],f=!1;if("undefined"!==typeof O.WebGLRenderingContext){for(c=D.createElement("canvas");a<d.length;a++){try{if(f=c.getContext(d[a]),"undefined"!==typeof f&&null!==f){return!0}}catch(b){}}}return!1})()?(l.extend(p.prototype,{renderCanvas:function(){function a(a,b){var c,d,f,h="undefined"===typeof g.index,l=!0;if(!h&&(S?(c=a[0],d=a[1]):(c=a,d=v[b]),F?(S&&(d=a.slice(1,3)),f=d[0],d=d[1]):C&&(c=a.x,d=a.stackY,f=d-a.y),O||(l=d>=z&&d<=y),null!==d&&c>=A&&c<=e&&l)){if(a=Math.ceil(k.toPixels(c,!0)),K){if(void 0===r||a===D){F||(f=d);if(void 0===L||d>M){M=d,L=b}if(void 0===r||f<q){q=f,r=b}}a!==D&&(void 0!==r&&(d=n.toPixels(M,!0),w=n.toPixels(q,!0),X(a,d,L),w!==d&&X(a,w,r)),r=L=void 0,D=a)}else{d=Math.ceil(n.toPixels(d,!0)),X(a,d,b)}}return!h}function c(){pa(d,"renderedCanvas");delete d.buildKDTree;d.buildKDTree();N.debug.timeKDTree&&console.timeEnd("kd tree building")}var d=this,f=d.options||{},b=!1,g=d.chart,k=this.xAxis,n=this.yAxis,p=f.xData||d.processedXData,v=f.yData||d.processedYData,h=f.data,b=k.getExtremes(),A=b.min,e=b.max,b=n.getExtremes(),z=b.min,y=b.max,E={},D,K=!!d.sampling,I,J=!1!==f.enableMouseTracking,w=n.getThreshold(f.threshold),F=d.pointArrayMap&&"low,high"===d.pointArrayMap.join(","),C=!!f.stacking,G=d.cropStart||0,O=d.requireSorting,S=!p,q,M,r,L,N,P=this.xData||this.options.xData||this.processedXData||!1,X=function(a,b,c){W=a+","+b;J&&!E[W]&&(E[W]=!0,g.inverted&&(a=k.len-a,b=n.len-b),I.push({x:P?P[G+c]:!1,clientX:a,plotX:a,plotY:b,i:G+c}))},b=ba(g,d);g.isBoosting=!0;N=b.settings;if(this.visible){if(this.points||this.graph){this.animate=null,this.destroyGraphics()}g.isChartSeriesBoosting()?this.markerGroup=g.markerGroup:this.markerGroup=d.plotGroup("markerGroup","markers",!0,1,g.seriesGroup);I=this.points=[];d.buildKDTree=oa;b&&(da(b,this),b.pushSeries(d),ca(b,this,g));g.renderer.forExport||(N.debug.timeKDTree&&console.time("kd tree building"),l.eachAsync(C?d.data:p||h,a,c))}}}),y(["heatmap","treemap"],function(a){g[a]&&k(g[a].prototype,"drawPoints",na)}),g.bubble&&(delete g.bubble.prototype.buildKDTree,k(g.bubble.prototype,"markerAttribs",function(a){return this.isSeriesBoosting?!1:a.apply(this,[].slice.call(arguments,1))})),g.scatter.prototype.fill=!0,fa(g.area.prototype,{fill:!0,fillOpacity:!0,sampling:!0}),fa(g.column.prototype,{fill:!0,sampling:!0}),l.Chart.prototype.callbacks.push(function(a){ga(a,"predraw",function(){a.boostForceChartBoost=void 0;a.boostForceChartBoost=N(a);a.isBoosting=!1;!a.isChartSeriesBoosting()&&a.didBoost&&(a.didBoost=!1);a.boostClear&&a.boostClear();a.canvas&&a.ogl&&a.isChartSeriesBoosting()&&(a.didBoost=!0,a.ogl.allocateBuffer(a));a.markerGroup&&a.xAxis&&0<a.xAxis.length&&a.yAxis&&0<a.yAxis.length&&a.markerGroup.translate(a.xAxis[0].pos,a.yAxis[0].pos)});ga(a,"render",function(){a.ogl&&a.isChartSeriesBoosting()&&a.ogl.render(a)})})):"undefined"!==typeof l.initCanvasBoost?l.initCanvasBoost():l.error(26)})(v)})});var bullet=createCommonjsModule(function(module){(function(c){"object"==="object"&&module.exports?module.exports=c:c(Highcharts)})(function(c){(function(d){var c=d.each,r=d.pick,l=d.isNumber,v=d.relativeLength,m=d.seriesType,f=d.seriesTypes.column.prototype;m("bullet","column",{targetOptions:{width:"140%",height:3,borderWidth:0},tooltip:{pointFormat:'<span style="color:{series.color}">‚óè</span> {series.name}: <b>{point.y}</b>. Target: <b>{point.target}</b><br/>'}},{pointArrayMap:["y","target"],parallelArrays:["x","y","target"],drawPoints:function(){var a=this,n=a.chart,p=a.options,m=p.animationLimit||250;f.drawPoints.apply(this);c(a.points,function(b){var c=b.options,h,e=b.targetGraphic,f=b.target,k=b.y,q,t,g,u;l(f)&&null!==f?(g=d.merge(p.targetOptions,c.targetOptions),t=g.height,h=b.shapeArgs,q=v(g.width,h.width),u=a.yAxis.translate(f,!1,!0,!1,!0)-g.height/2-.5,h=a.crispCol.apply({chart:n,borderWidth:g.borderWidth,options:{crisp:p.crisp}},[h.x+h.width/2-q/2,u,q,t]),e?(e[n.pointCount<m?"animate":"attr"](h),l(k)&&null!==k?e.element.point=b:e.element.point=void 0):b.targetGraphic=e=n.renderer.rect().attr(h).add(a.group),e.attr({fill:r(g.color,c.color,a.zones.length&&(b.getZone.call({series:a,x:b.x,y:f,options:{}}).color||a.color)||void 0,b.color,a.color),stroke:r(g.borderColor,b.borderColor,a.options.borderColor),"stroke-width":g.borderWidth}),l(k)&&null!==k&&(e.element.point=b),e.addClass(b.getClassName()+" highcharts-bullet-target",!0)):e&&(b.targetGraphic=e.destroy())})},getExtremes:function(a){var c=this.targetData,d;f.getExtremes.call(this,a);c&&c.length&&(a=this.dataMax,d=this.dataMin,f.getExtremes.call(this,c),this.dataMax=Math.max(this.dataMax,a),this.dataMin=Math.min(this.dataMin,d))}},{destroy:function(){this.targetGraphic&&(this.targetGraphic=this.targetGraphic.destroy());f.pointClass.prototype.destroy.apply(this,arguments)}})})(c)})});var drilldown=createCommonjsModule(function(module){(function(p){"object"==="object"&&module.exports?module.exports=p:p(Highcharts)})(function(p){(function(f){var p=f.noop,z=f.color,A=f.defaultOptions,l=f.each,q=f.extend,G=f.format,B=f.objectEach,v=f.pick,r=f.wrap,m=f.Chart,w=f.seriesTypes,C=w.pie,t=w.column,D=f.Tick,x=f.fireEvent,E=f.inArray,F=1;q(A.lang,{drillUpText:"‚óÅ Back to {series.name}"});A.drilldown={activeAxisLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},activeDataLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},animation:{duration:500},drillUpButton:{position:{align:"right",x:-10,y:10}}};f.SVGRenderer.prototype.Element.prototype.fadeIn=function(a){this.attr({opacity:.1,visibility:"inherit"}).animate({opacity:v(this.newOpacity,1)},a||{duration:250})};m.prototype.addSeriesAsDrilldown=function(a,b){this.addSingleSeriesAsDrilldown(a,b);this.applyDrilldown()};m.prototype.addSingleSeriesAsDrilldown=function(a,b){var d=a.series,c=d.xAxis,e=d.yAxis,g,k=[],h=[],u,n,m;m={color:a.color||d.color};this.drilldownLevels||(this.drilldownLevels=[]);u=d.options._levelNumber||0;(n=this.drilldownLevels[this.drilldownLevels.length-1])&&n.levelNumber!==u&&(n=void 0);b=q(q({_ddSeriesId:F++},m),b);g=E(a,d.points);l(d.chart.series,function(a){a.xAxis!==c||a.isDrilling||(a.options._ddSeriesId=a.options._ddSeriesId||F++,a.options._colorIndex=a.userOptions._colorIndex,a.options._levelNumber=a.options._levelNumber||u,n?(k=n.levelSeries,h=n.levelSeriesOptions):(k.push(a),h.push(a.options)))});a=q({levelNumber:u,seriesOptions:d.options,levelSeriesOptions:h,levelSeries:k,shapeArgs:a.shapeArgs,bBox:a.graphic?a.graphic.getBBox():{},color:a.isNull?new f.Color(z).setOpacity(0).get():z,lowerSeriesOptions:b,pointOptions:d.options.data[g],pointIndex:g,oldExtremes:{xMin:c&&c.userMin,xMax:c&&c.userMax,yMin:e&&e.userMin,yMax:e&&e.userMax},resetZoomButton:this.resetZoomButton},m);this.drilldownLevels.push(a);c&&c.names&&(c.names.length=0);b=a.lowerSeries=this.addSeries(b,!1);b.options._levelNumber=u+1;c&&(c.oldPos=c.pos,c.userMin=c.userMax=null,e.userMin=e.userMax=null);d.type===b.type&&(b.animate=b.animateDrilldown||p,b.options.animation=!0)};m.prototype.applyDrilldown=function(){var a=this.drilldownLevels,b;a&&0<a.length&&(b=a[a.length-1].levelNumber,l(this.drilldownLevels,function(a){a.levelNumber===b&&l(a.levelSeries,function(a){a.options&&a.options._levelNumber===b&&a.remove(!1)})}));this.resetZoomButton&&(this.resetZoomButton.hide(),delete this.resetZoomButton);this.pointer.reset();this.redraw();this.showDrillUpButton()};m.prototype.getDrilldownBackText=function(){var a=this.drilldownLevels;if(a&&0<a.length){return a=a[a.length-1],a.series=a.seriesOptions,G(this.options.lang.drillUpText,a)}};m.prototype.showDrillUpButton=function(){var a=this,b=this.getDrilldownBackText(),d=a.options.drilldown.drillUpButton,c,e;this.drillUpButton?this.drillUpButton.attr({text:b}).align():(e=(c=d.theme)&&c.states,this.drillUpButton=this.renderer.button(b,null,null,function(){a.drillUp()},c,e&&e.hover,e&&e.select).addClass("highcharts-drillup-button").attr({align:d.position.align,zIndex:7}).add().align(d.position,!1,d.relativeTo||"plotBox"))};m.prototype.drillUp=function(){for(var a=this,b=a.drilldownLevels,d=b[b.length-1].levelNumber,c=b.length,e=a.series,g,k,h,f,n=function(b){var c;l(e,function(a){a.options._ddSeriesId===b._ddSeriesId&&(c=a)});c=c||a.addSeries(b,!1);c.type===h.type&&c.animateDrillupTo&&(c.animate=c.animateDrillupTo);b===k.seriesOptions&&(f=c)};c--;){if(k=b[c],k.levelNumber===d){b.pop();h=k.lowerSeries;if(!h.chart){for(g=e.length;g--;){if(e[g].options.id===k.lowerSeriesOptions.id&&e[g].options._levelNumber===d+1){h=e[g];break}}}h.xData=[];l(k.levelSeriesOptions,n);x(a,"drillup",{seriesOptions:k.seriesOptions});f.type===h.type&&(f.drilldownLevel=k,f.options.animation=a.options.drilldown.animation,h.animateDrillupFrom&&h.chart&&h.animateDrillupFrom(k));f.options._levelNumber=d;h.remove(!1);f.xAxis&&(g=k.oldExtremes,f.xAxis.setExtremes(g.xMin,g.xMax,!1),f.yAxis.setExtremes(g.yMin,g.yMax,!1));k.resetZoomButton&&(a.resetZoomButton=k.resetZoomButton,a.resetZoomButton.show())}}x(a,"drillupall");this.redraw();0===this.drilldownLevels.length?this.drillUpButton=this.drillUpButton.destroy():this.drillUpButton.attr({text:this.getDrilldownBackText()}).align();this.ddDupes.length=[]};r(m.prototype,"showResetZoom",function(a){this.drillUpButton||a.apply(this,Array.prototype.slice.call(arguments,1))});t.prototype.animateDrillupTo=function(a){if(!a){var b=this,d=b.drilldownLevel;l(this.points,function(a){var b=a.dataLabel;a.graphic&&a.graphic.hide();b&&(b.hidden="hidden"===b.attr("visibility"),b.hidden||(b.hide(),a.connector&&a.connector.hide()))});setTimeout(function(){b.points&&l(b.points,function(a,b){b=b===(d&&d.pointIndex)?"show":"fadeIn";var c="show"===b?!0:void 0,e=a.dataLabel;if(a.graphic){a.graphic[b](c)}if(e&&!e.hidden&&(e[b](c),a.connector)){a.connector[b](c)}})},Math.max(this.chart.options.drilldown.animation.duration-50,0));this.animate=p}};t.prototype.animateDrilldown=function(a){var b=this,d=this.chart.drilldownLevels,c,e=this.chart.options.drilldown.animation,g=this.xAxis;a||(l(d,function(a){b.options._ddSeriesId===a.lowerSeriesOptions._ddSeriesId&&(c=a.shapeArgs,c.fill=a.color)}),c.x+=v(g.oldPos,g.pos)-g.pos,l(this.points,function(a){a.shapeArgs.fill=a.color;a.graphic&&a.graphic.attr(c).animate(q(a.shapeArgs,{fill:a.color||b.color}),e);a.dataLabel&&a.dataLabel.fadeIn(e)}),this.animate=null)};t.prototype.animateDrillupFrom=function(a){var b=this.chart.options.drilldown.animation,d=this.group,c=d!==this.chart.columnGroup,e=this;l(e.trackerGroups,function(a){if(e[a]){e[a].on("mouseover")}});c&&delete this.group;l(this.points,function(e){var g=e.graphic,h=a.shapeArgs,l=function(){g.destroy();d&&c&&(d=d.destroy())};g&&(delete e.graphic,h.fill=a.color,b?g.animate(h,f.merge(b,{complete:l})):(g.attr(h),l()))})};C&&q(C.prototype,{animateDrillupTo:t.prototype.animateDrillupTo,animateDrillupFrom:t.prototype.animateDrillupFrom,animateDrilldown:function(a){var b=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],d=this.chart.options.drilldown.animation,c=b.shapeArgs,e=c.start,g=(c.end-e)/this.points.length;a||(l(this.points,function(a,h){var k=a.shapeArgs;c.fill=b.color;k.fill=a.color;if(a.graphic){a.graphic.attr(f.merge(c,{start:e+h*g,end:e+(h+1)*g}))[d?"animate":"attr"](k,d)}}),this.animate=null)}});f.Point.prototype.doDrilldown=function(a,b,d){var c=this.series.chart,e=c.options.drilldown,g=(e.series||[]).length,f;c.ddDupes||(c.ddDupes=[]);for(;g--&&!f;){e.series[g].id===this.drilldown&&-1===E(this.drilldown,c.ddDupes)&&(f=e.series[g],c.ddDupes.push(this.drilldown))}x(c,"drilldown",{point:this,seriesOptions:f,category:b,originalEvent:d,points:void 0!==b&&this.series.xAxis.getDDPoints(b).slice(0)},function(b){var c=b.point.series&&b.point.series.chart,d=b.seriesOptions;c&&d&&(a?c.addSingleSeriesAsDrilldown(b.point,d):c.addSeriesAsDrilldown(b.point,d))})};f.Axis.prototype.drilldownCategory=function(a,b){B(this.getDDPoints(a),function(d){d&&d.series&&d.series.visible&&d.doDrilldown&&d.doDrilldown(!0,a,b)});this.chart.applyDrilldown()};f.Axis.prototype.getDDPoints=function(a){var b=[];l(this.series,function(d){var c,e=d.xData,g=d.points;for(c=0;c<e.length;c++){if(e[c]===a&&d.options.data[c]&&d.options.data[c].drilldown){b.push(g?g[c]:!0);break}}});return b};D.prototype.drillable=function(){var a=this.pos,b=this.label,d=this.axis,c="xAxis"===d.coll&&d.getDDPoints,e=c&&d.getDDPoints(a);c&&(b&&e.length?(b.drillable=!0,b.basicStyles||(b.basicStyles=f.merge(b.styles)),b.addClass("highcharts-drilldown-axis-label").css(d.chart.options.drilldown.activeAxisLabelStyle).on("click",function(b){d.drilldownCategory(a,b)})):b&&b.drillable&&(b.styles={},b.css(b.basicStyles),b.on("click",null),b.removeClass("highcharts-drilldown-axis-label")))};r(D.prototype,"addLabel",function(a){a.call(this);this.drillable()});r(f.Point.prototype,"init",function(a,b,d,c){var e=a.call(this,b,d,c);c=(a=b.xAxis)&&a.ticks[c];e.drilldown&&f.addEvent(e,"click",function(a){b.xAxis&&!1===b.chart.options.drilldown.allowPointDrilldown?b.xAxis.drilldownCategory(e.x,a):e.doDrilldown(void 0,void 0,a)});c&&c.drillable();return e});r(f.Series.prototype,"drawDataLabels",function(a){var b=this.chart.options.drilldown.activeDataLabelStyle,d=this.chart.renderer;a.call(this);l(this.points,function(a){var c=a.options.dataLabels,f=v(a.dlOptions,c&&c.style,{});a.drilldown&&a.dataLabel&&("contrast"===b.color&&(f.color=d.getContrast(a.color||this.color)),c&&c.color&&(f.color=c.color),a.dataLabel.addClass("highcharts-drilldown-data-label"),a.dataLabel.css(b).css(f))},this)});var y=function(a,b,d){a[d?"addClass":"removeClass"]("highcharts-drilldown-point");a.css({cursor:b})},H=function(a){a.call(this);l(this.points,function(a){a.drilldown&&a.graphic&&y(a.graphic,"pointer",!0)})},I=function(a,b){var d=a.apply(this,Array.prototype.slice.call(arguments,1));this.drilldown&&this.series.halo&&"hover"===b?y(this.series.halo,"pointer",!0):this.series.halo&&y(this.series.halo,"auto",!1);return d};B(w,function(a){r(a.prototype,"drawTracker",H);r(a.prototype.pointClass.prototype,"setState",I)})})(p)})});var exporting=createCommonjsModule(function(module){(function(k){"object"==="object"&&module.exports?module.exports=k:k(Highcharts)})(function(k){(function(f){var k=f.defaultOptions,z=f.doc,B=f.Chart,w=f.addEvent,I=f.removeEvent,F=f.fireEvent,p=f.createElement,C=f.discardElement,u=f.css,n=f.merge,D=f.pick,h=f.each,G=f.objectEach,r=f.extend,J=f.isTouchDevice,E=f.win,H=E.navigator.userAgent,K=f.Renderer.prototype.symbols;/Edge\/|Trident\/|MSIE /.test(H);/firefox/i.test(H);r(k.lang,{printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"});k.navigation={buttonOptions:{theme:{},symbolSize:14,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,verticalAlign:"top",width:24}};n(!0,k.navigation,{menuStyle:{border:"1px solid #999999",background:"#ffffff",padding:"5px 0"},menuItemStyle:{padding:"0.5em 1em",background:"none",color:"#333333",fontSize:J?"14px":"11px",transition:"background 250ms, color 250ms"},menuItemHoverStyle:{background:"#335cad",color:"#ffffff"},buttonOptions:{symbolFill:"#666666",symbolStroke:"#666666",symbolStrokeWidth:3,theme:{fill:"#ffffff",stroke:"none",padding:5}}});k.exporting={type:"image/png",url:"https://export.highcharts.com/",printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:"printChart separator downloadPNG downloadJPEG downloadPDF downloadSVG".split(" ")}},menuItemDefinitions:{printChart:{textKey:"printChart",onclick:function(){this.print()}},separator:{separator:!0},downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChart()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}}};f.post=function(a,b,e){var c=p("form",n({method:"post",action:a,enctype:"multipart/form-data"},e),{display:"none"},z.body);G(b,function(a,b){p("input",{type:"hidden",name:b,value:a},null,c)});c.submit();C(c)};r(B.prototype,{sanitizeSVG:function(a,b){if(b&&b.exporting&&b.exporting.allowHTML){var e=a.match(/<\/svg>(.*?$)/);e&&e[1]&&(e='<foreignObject x="0" y="0" width="'+b.chart.width+'" height="'+b.chart.height+'"><body xmlns="http://www.w3.org/1999/xhtml">'+e[1]+"</body></foreignObject>",a=a.replace("</svg>",e+"</svg>"))}a=a.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS[0-9]+\:)?href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g,"¬†").replace(/&shy;/g,"¬≠");this.ieSanitizeSVG&&(a=this.ieSanitizeSVG(a));return a},getChartHTML:function(){return this.container.innerHTML},getSVG:function(a){var b,e,c,v,m,g=n(this.options,a);e=p("div",null,{position:"absolute",top:"-9999em",width:this.chartWidth+"px",height:this.chartHeight+"px"},z.body);c=this.renderTo.style.width;m=this.renderTo.style.height;c=g.exporting.sourceWidth||g.chart.width||/px$/.test(c)&&parseInt(c,10)||600;m=g.exporting.sourceHeight||g.chart.height||/px$/.test(m)&&parseInt(m,10)||400;r(g.chart,{animation:!1,renderTo:e,forExport:!0,renderer:"SVGRenderer",width:c,height:m});g.exporting.enabled=!1;delete g.data;g.series=[];h(this.series,function(a){v=n(a.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:a.visible});v.isInternal||g.series.push(v)});h(this.axes,function(a){a.userOptions.internalKey||(a.userOptions.internalKey=f.uniqueKey())});b=new f.Chart(g,this.callback);a&&h(["xAxis","yAxis","series"],function(c){var d={};a[c]&&(d[c]=a[c],b.update(d))});h(this.axes,function(a){var c=f.find(b.axes,function(b){return b.options.internalKey===a.userOptions.internalKey}),d=a.getExtremes(),e=d.userMin,d=d.userMax;!c||void 0===e&&void 0===d||c.setExtremes(e,d,!0,!1)});c=b.getChartHTML();c=this.sanitizeSVG(c,g);g=null;b.destroy();C(e);return c},getSVGForExport:function(a,b){var e=this.options.exporting;return this.getSVG(n({chart:{borderRadius:0}},e.chartOptions,b,{exporting:{sourceWidth:a&&a.sourceWidth||e.sourceWidth,sourceHeight:a&&a.sourceHeight||e.sourceHeight}}))},exportChart:function(a,b){b=this.getSVGForExport(a,b);a=n(this.options.exporting,a);f.post(a.url,{filename:a.filename||"chart",type:a.type,width:a.width||0,scale:a.scale,svg:b},a.formAttributes)},print:function(){var a=this,b=a.container,e=[],c=b.parentNode,f=z.body,m=f.childNodes,g=a.options.exporting.printMaxWidth,d,t;if(!a.isPrinting){a.isPrinting=!0;a.pointer.reset(null,0);F(a,"beforePrint");if(t=g&&a.chartWidth>g){d=[a.options.chart.width,void 0,!1],a.setSize(g,void 0,!1)}h(m,function(a,b){1===a.nodeType&&(e[b]=a.style.display,a.style.display="none")});f.appendChild(b);E.focus();E.print();setTimeout(function(){c.appendChild(b);h(m,function(a,b){1===a.nodeType&&(a.style.display=e[b])});a.isPrinting=!1;t&&a.setSize.apply(a,d);F(a,"afterPrint")},1e3)}},contextMenu:function(a,b,e,c,v,m,g){var d=this,t=d.options.navigation,k=d.chartWidth,q=d.chartHeight,n="cache-"+a,l=d[n],x=Math.max(v,m),y,A;l||(d[n]=l=p("div",{className:a},{position:"absolute",zIndex:1e3,padding:x+"px"},d.container),y=p("div",{className:"highcharts-menu"},null,l),u(y,r({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},t.menuStyle)),A=function(){u(l,{display:"none"});g&&g.setState(0);d.openMenu=!1},d.exportEvents.push(w(l,"mouseleave",function(){l.hideTimer=setTimeout(A,500)}),w(l,"mouseenter",function(){clearTimeout(l.hideTimer)}),w(z,"mouseup",function(b){d.pointer.inClass(b.target,a)||A()})),h(b,function(a){"string"===typeof a&&(a=d.options.exporting.menuItemDefinitions[a]);if(f.isObject(a,!0)){var b;a.separator?b=p("hr",null,null,y):(b=p("div",{className:"highcharts-menu-item",onclick:function(b){b&&b.stopPropagation();A();a.onclick&&a.onclick.apply(d,arguments)},innerHTML:a.text||d.options.lang[a.textKey]},null,y),b.onmouseover=function(){u(this,t.menuItemHoverStyle)},b.onmouseout=function(){u(this,t.menuItemStyle)},u(b,r({cursor:"pointer"},t.menuItemStyle)));d.exportDivElements.push(b)}}),d.exportDivElements.push(y,l),d.exportMenuWidth=l.offsetWidth,d.exportMenuHeight=l.offsetHeight);b={display:"block"};e+d.exportMenuWidth>k?b.right=k-e-v-x+"px":b.left=e-x+"px";c+m+d.exportMenuHeight>q&&"top"!==g.alignOptions.verticalAlign?b.bottom=q-c-x+"px":b.top=c+m-x+"px";u(l,b);d.openMenu=!0},addButton:function(a){var b=this,e=b.renderer,c=n(b.options.navigation.buttonOptions,a),f=c.onclick,m=c.menuItems,g,d,k=c.symbolSize||12;b.btnCount||(b.btnCount=0);b.exportDivElements||(b.exportDivElements=[],b.exportSVGElements=[]);if(!1!==c.enabled){var h=c.theme,q=h.states,p=q&&q.hover,q=q&&q.select,l;delete h.states;f?l=function(a){a.stopPropagation();f.call(b,a)}:m&&(l=function(){b.contextMenu(d.menuClassName,m,d.translateX,d.translateY,d.width,d.height,d);d.setState(2)});c.text&&c.symbol?h.paddingLeft=D(h.paddingLeft,25):c.text||r(h,{width:c.width,height:c.height,padding:0});d=e.button(c.text,0,0,l,h,p,q).addClass(a.className).attr({"stroke-linecap":"round",title:b.options.lang[c._titleKey],zIndex:3});d.menuClassName=a.menuClassName||"highcharts-menu-"+b.btnCount++;c.symbol&&(g=e.symbol(c.symbol,c.symbolX-k/2,c.symbolY-k/2,k,k).addClass("highcharts-button-symbol").attr({zIndex:1}).add(d),g.attr({stroke:c.symbolStroke,fill:c.symbolFill,"stroke-width":c.symbolStrokeWidth||1}));d.add().align(r(c,{width:d.width,x:D(c.x,b.buttonOffset)}),!0,"spacingBox");b.buttonOffset+=(d.width+c.buttonSpacing)*("right"===c.align?-1:1);b.exportSVGElements.push(d,g)}},destroyExport:function(a){var b=a?a.target:this;a=b.exportSVGElements;var e=b.exportDivElements,c=b.exportEvents,f;a&&(h(a,function(a,c){a&&(a.onclick=a.ontouchstart=null,f="cache-"+a.menuClassName,b[f]&&delete b[f],b.exportSVGElements[c]=a.destroy())}),a.length=0);e&&(h(e,function(a,c){clearTimeout(a.hideTimer);I(a,"mouseleave");b.exportDivElements[c]=a.onmouseout=a.onmouseover=a.ontouchstart=a.onclick=null;C(a)}),e.length=0);c&&(h(c,function(a){a()}),c.length=0)}});K.menu=function(a,b,e,c){return["M",a,b+2.5,"L",a+e,b+2.5,"M",a,b+c/2+.5,"L",a+e,b+c/2+.5,"M",a,b+c-1.5,"L",a+e,b+c-1.5]};B.prototype.renderExporting=function(){var a=this,b=a.options.exporting,e=b.buttons,c=a.isDirtyExporting||!a.exportSVGElements;a.buttonOffset=0;a.isDirtyExporting&&a.destroyExport();c&&!1!==b.enabled&&(a.exportEvents=[],G(e,function(b){a.addButton(b)}),a.isDirtyExporting=!1);w(a,"destroy",a.destroyExport)};B.prototype.callbacks.push(function(a){a.renderExporting();w(a,"redraw",a.renderExporting);h(["exporting","navigation"],function(b){a[b]={update:function(e,c){a.isDirtyExporting=!0;n(!0,a.options[b],e);D(c,!0)&&a.redraw()}}})})})(k)})});var funnel=createCommonjsModule(function(module){(function(e){"object"==="object"&&module.exports?module.exports=e:e(Highcharts)})(function(e){(function(g){var e=g.seriesType,C=g.seriesTypes,H=g.noop,D=g.pick,I=g.each;e("funnel","pie",{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,size:!0,dataLabels:{connectorWidth:1},states:{select:{color:"#cccccc",borderColor:"#000000",shadow:!1}}},{animate:H,translate:function(){var b=function(a,b){return/%$/.test(a)?b*parseInt(a,10)/100:parseInt(a,10)},E=0,c=this.chart,f=this.options,d=f.reversed,e=f.ignoreHiddenPoint,t=c.plotWidth,c=c.plotHeight,q=0,g=f.center,h=b(g[0],t),r=b(g[1],c),C=b(f.width,t),l,v,m=b(f.height,c),w=b(f.neckWidth,t),F=b(f.neckHeight,c),x=r-m/2+m-F,b=this.data,z,A,D="left"===f.dataLabels.position?1:0,B,n,G,u,k,y,p;this.getWidthAt=v=function(a){var b=r-m/2;return a>x||m===F?w:w+(C-w)*(1-(a-b)/(m-F))};this.getX=function(a,b,c){return h+(b?-1:1)*(v(d?2*r-a:a)/2+c.labelDistance)};this.center=[h,r,m];this.centerX=h;I(b,function(a){e&&!1===a.visible||(E+=a.y)});I(b,function(a){p=null;A=E?a.y/E:0;n=r-m/2+q*m;k=n+A*m;l=v(n);B=h-l/2;G=B+l;l=v(k);u=h-l/2;y=u+l;n>x?(B=u=h-w/2,G=y=h+w/2):k>x&&(p=k,l=v(x),u=h-l/2,y=u+l,k=x);d&&(n=2*r-n,k=2*r-k,p=p?2*r-p:null);z=["M",B,n,"L",G,n,y,k];p&&z.push(y,p,u,p);z.push(u,k,"Z");a.shapeType="path";a.shapeArgs={d:z};a.percentage=100*A;a.plotX=h;a.plotY=(n+(p||k))/2;a.tooltipPos=[h,a.plotY];a.slice=H;a.half=D;e&&!1===a.visible||(q+=A)})},sortByAngle:function(b){b.sort(function(b,c){return b.plotY-c.plotY})},drawDataLabels:function(){var b=this.data,e=this.options.dataLabels.distance,c,f,d,g=b.length,t,q;for(this.center[2]-=2*e;g--;){d=b[g],f=(c=d.half)?1:-1,q=d.plotY,d.labelDistance=D(d.options.dataLabels&&d.options.dataLabels.distance,e),this.maxLabelDistance=Math.max(d.labelDistance,this.maxLabelDistance||0),t=this.getX(q,c,d),d.labelPos=[0,q,t+(d.labelDistance-5)*f,q,t+d.labelDistance*f,q,c?"right":"left",0]}C.pie.prototype.drawDataLabels.call(this)}});e("pyramid","funnel",{neckWidth:"0%",neckHeight:"0%",reversed:!0})})(e)})});var heatmap=createCommonjsModule(function(module){(function(k){"object"==="object"&&module.exports?module.exports=k:k(Highcharts)})(function(k){(function(a){var g=a.Axis,w=a.Chart,n=a.color,m,l=a.each,t=a.extend,v=a.isNumber,p=a.Legend,c=a.LegendSymbolMixin,f=a.noop,r=a.merge,k=a.pick,u=a.wrap;a.ColorAxis||(m=a.ColorAxis=function(){this.init.apply(this,arguments)},t(m.prototype,g.prototype),t(m.prototype,{defaultColorAxisOptions:{lineWidth:0,minPadding:0,maxPadding:0,gridLineWidth:1,tickPixelInterval:72,startOnTick:!0,endOnTick:!0,offset:0,marker:{animation:{duration:50},width:.01,color:"#999999"},labels:{overflow:"justify",rotation:0},minColor:"#e6ebf5",maxColor:"#003399",tickLength:5,showInLegend:!0},keepProps:["legendGroup","legendItemHeight","legendItemWidth","legendItem","legendSymbol"].concat(g.prototype.keepProps),init:function(b,d){var e="vertical"!==b.options.legend.layout,h;this.coll="colorAxis";h=r(this.defaultColorAxisOptions,{side:e?2:1,reversed:!e},d,{opposite:!e,showEmpty:!1,title:null});g.prototype.init.call(this,b,h);d.dataClasses&&this.initDataClasses(d);this.initStops();this.horiz=e;this.zoomEnabled=!1;this.defaultLegendLength=200},initDataClasses:function(b){var d=this.chart,e,h=0,q=d.options.chart.colorCount,a=this.options,c=b.dataClasses.length;this.dataClasses=e=[];this.legendItems=[];l(b.dataClasses,function(b,f){b=r(b);e.push(b);b.color||("category"===a.dataClassColor?(f=d.options.colors,q=f.length,b.color=f[h],b.colorIndex=h,h++,h===q&&(h=0)):b.color=n(a.minColor).tweenTo(n(a.maxColor),2>c?.5:f/(c-1)))})},setTickPositions:function(){if(!this.dataClasses){return g.prototype.setTickPositions.call(this)}},initStops:function(){this.stops=this.options.stops||[[0,this.options.minColor],[1,this.options.maxColor]];l(this.stops,function(b){b.color=n(b[1])})},setOptions:function(b){g.prototype.setOptions.call(this,b);this.options.crosshair=this.options.marker},setAxisSize:function(){var b=this.legendSymbol,d=this.chart,e=d.options.legend||{},h,q;b?(this.left=e=b.attr("x"),this.top=h=b.attr("y"),this.width=q=b.attr("width"),this.height=b=b.attr("height"),this.right=d.chartWidth-e-q,this.bottom=d.chartHeight-h-b,this.len=this.horiz?q:b,this.pos=this.horiz?e:h):this.len=(this.horiz?e.symbolWidth:e.symbolHeight)||this.defaultLegendLength},normalizedValue:function(b){this.isLog&&(b=this.val2lin(b));return 1-(this.max-b)/(this.max-this.min||1)},toColor:function(b,d){var e=this.stops,h,q,a=this.dataClasses,f,c;if(a){for(c=a.length;c--;){if(f=a[c],h=f.from,e=f.to,(void 0===h||b>=h)&&(void 0===e||b<=e)){q=f.color;d&&(d.dataClass=c,d.colorIndex=f.colorIndex);break}}}else{b=this.normalizedValue(b);for(c=e.length;c--&&!(b>e[c][0]);){}h=e[c]||e[c+1];e=e[c+1]||h;b=1-(e[0]-b)/(e[0]-h[0]||1);q=h.color.tweenTo(e.color,b)}return q},getOffset:function(){var b=this.legendGroup,d=this.chart.axisOffset[this.side];b&&(this.axisParent=b,g.prototype.getOffset.call(this),this.added||(this.added=!0,this.labelLeft=0,this.labelRight=this.width),this.chart.axisOffset[this.side]=d)},setLegendColor:function(){var b,d=this.reversed;b=d?1:0;d=d?0:1;b=this.horiz?[b,0,d,0]:[0,d,0,b];this.legendColor={linearGradient:{x1:b[0],y1:b[1],x2:b[2],y2:b[3]},stops:this.stops}},drawLegendSymbol:function(b,d){var e=b.padding,a=b.options,c=this.horiz,f=k(a.symbolWidth,c?this.defaultLegendLength:12),l=k(a.symbolHeight,c?12:this.defaultLegendLength),g=k(a.labelPadding,c?16:30),a=k(a.itemDistance,10);this.setLegendColor();d.legendSymbol=this.chart.renderer.rect(0,b.baseline-11,f,l).attr({zIndex:1}).add(d.legendGroup);this.legendItemWidth=f+e+(c?a:g);this.legendItemHeight=l+e+(c?g:0)},setState:f,visible:!0,setVisible:f,getSeriesExtremes:function(){var b=this.series,d=b.length;this.dataMin=Infinity;for(this.dataMax=-Infinity;d--;){void 0!==b[d].valueMin&&(this.dataMin=Math.min(this.dataMin,b[d].valueMin),this.dataMax=Math.max(this.dataMax,b[d].valueMax))}},drawCrosshair:function(b,d){var e=d&&d.plotX,a=d&&d.plotY,c,f=this.pos,l=this.len;d&&(c=this.toPixels(d[d.series.colorKey]),c<f?c=f-2:c>f+l&&(c=f+l+2),d.plotX=c,d.plotY=this.len-c,g.prototype.drawCrosshair.call(this,b,d),d.plotX=e,d.plotY=a,this.cross&&(this.cross.addClass("highcharts-coloraxis-marker").add(this.legendGroup),this.cross.attr({fill:this.crosshair.color})))},getPlotLinePath:function(b,d,e,c,a){return v(a)?this.horiz?["M",a-4,this.top-6,"L",a+4,this.top-6,a,this.top,"Z"]:["M",this.left,a,"L",this.left-6,a+6,this.left-6,a-6,"Z"]:g.prototype.getPlotLinePath.call(this,b,d,e,c)},update:function(b,d){var a=this.chart,c=a.legend;l(this.series,function(b){b.isDirtyData=!0});b.dataClasses&&c.allItems&&(l(c.allItems,function(b){b.isDataClass&&b.legendGroup&&b.legendGroup.destroy()}),a.isDirtyLegend=!0);a.options[this.coll]=r(this.userOptions,b);g.prototype.update.call(this,b,d);this.legendItem&&(this.setLegendColor(),c.colorizeItem(this,!0))},remove:function(){this.legendItem&&this.chart.legend.destroyItem(this);g.prototype.remove.call(this)},getDataClassLegendSymbols:function(){var b=this,d=this.chart,e=this.legendItems,h=d.options.legend,g=h.valueDecimals,p=h.valueSuffix||"",k;e.length||l(this.dataClasses,function(h,q){var r=!0,n=h.from,m=h.to;k="";void 0===n?k="< ":void 0===m&&(k="> ");void 0!==n&&(k+=a.numberFormat(n,g)+p);void 0!==n&&void 0!==m&&(k+=" - ");void 0!==m&&(k+=a.numberFormat(m,g)+p);e.push(t({chart:d,name:k,options:{},drawLegendSymbol:c.drawRectangle,visible:!0,setState:f,isDataClass:!0,setVisible:function(){r=this.visible=!r;l(b.series,function(b){l(b.points,function(b){b.dataClass===q&&b.setVisible(r)})});d.legend.colorizeItem(this,r)}},h))});return e},name:""}),l(["fill","stroke"],function(b){a.Fx.prototype[b+"Setter"]=function(){this.elem.attr(b,n(this.start).tweenTo(n(this.end),this.pos),null,!0)}}),u(w.prototype,"getAxes",function(b){var d=this.options.colorAxis;b.call(this);this.colorAxis=[];d&&new m(this,d)}),u(p.prototype,"getAllItems",function(b){var d=[],a=this.chart.colorAxis[0];a&&a.options&&(a.options.showInLegend&&(a.options.dataClasses?d=d.concat(a.getDataClassLegendSymbols()):d.push(a)),l(a.series,function(b){b.options.showInLegend=!1}));return d.concat(b.call(this))}),u(p.prototype,"colorizeItem",function(b,a,c){b.call(this,a,c);c&&a.legendColor&&a.legendSymbol.attr({fill:a.legendColor})}),u(p.prototype,"update",function(b){b.apply(this,[].slice.call(arguments,1));this.chart.colorAxis[0]&&this.chart.colorAxis[0].update({},arguments[2])}))})(k);(function(a){var g=a.defined,k=a.each,n=a.noop,m=a.seriesTypes;a.colorPointMixin={isValid:function(){return null!==this.value},setVisible:function(a){var l=this,g=a?"show":"hide";k(["graphic","dataLabel"],function(a){if(l[a]){l[a][g]()}})},setState:function(l){a.Point.prototype.setState.call(this,l);this.graphic&&this.graphic.attr({zIndex:"hover"===l?1:0})}};a.colorSeriesMixin={pointArrayMap:["value"],axisTypes:["xAxis","yAxis","colorAxis"],optionalAxis:"colorAxis",trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:n,parallelArrays:["x","y","value"],colorKey:"value",pointAttribs:m.column.prototype.pointAttribs,translateColors:function(){var a=this,g=this.options.nullColor,n=this.colorAxis,m=this.colorKey;k(this.data,function(c){var f=c[m];if(f=c.options.color||(c.isNull?g:n&&void 0!==f?n.toColor(f,c):c.color||a.color)){c.color=f}})},colorAttribs:function(a){var l={};g(a.color)&&(l[this.colorProp||"fill"]=a.color);return l}}})(k);(function(a){var g=a.colorPointMixin,k=a.each,n=a.merge,m=a.noop,l=a.pick,t=a.Series,v=a.seriesType,p=a.seriesTypes;v("heatmap","scatter",{animation:!1,borderWidth:0,nullColor:"#f7f7f7",dataLabels:{formatter:function(){return this.point.value},inside:!0,verticalAlign:"middle",crop:!1,overflow:!1,padding:0},marker:null,pointRange:null,tooltip:{pointFormat:"{point.x}, {point.y}: {point.value}<br/>"},states:{normal:{animation:!0},hover:{halo:!1,brightness:.2}}},n(a.colorSeriesMixin,{pointArrayMap:["y","value"],hasPointSpecificOptions:!0,getExtremesFromAll:!0,directTouch:!0,init:function(){var a;p.scatter.prototype.init.apply(this,arguments);a=this.options;a.pointRange=l(a.pointRange,a.colsize||1);this.yAxis.axisPointRange=a.rowsize||1},translate:function(){var a=this.options,f=this.xAxis,g=this.yAxis,n=a.pointPadding||0,m=function(b,a,c){return Math.min(Math.max(a,b),c)};this.generatePoints();k(this.points,function(b){var d=(a.colsize||1)/2,c=(a.rowsize||1)/2,h=m(Math.round(f.len-f.translate(b.x-d,0,1,0,1)),-f.len,2*f.len),d=m(Math.round(f.len-f.translate(b.x+d,0,1,0,1)),-f.len,2*f.len),k=m(Math.round(g.translate(b.y-c,0,1,0,1)),-g.len,2*g.len),c=m(Math.round(g.translate(b.y+c,0,1,0,1)),-g.len,2*g.len),p=l(b.pointPadding,n);b.plotX=b.clientX=(h+d)/2;b.plotY=(k+c)/2;b.shapeType="rect";b.shapeArgs={x:Math.min(h,d)+p,y:Math.min(k,c)+p,width:Math.abs(d-h)-2*p,height:Math.abs(c-k)-2*p}});this.translateColors()},drawPoints:function(){p.column.prototype.drawPoints.call(this);k(this.points,function(a){a.graphic.attr(this.colorAttribs(a))},this)},animate:m,getBox:m,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,alignDataLabel:p.column.prototype.alignDataLabel,getExtremes:function(){t.prototype.getExtremes.call(this,this.valueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;t.prototype.getExtremes.call(this)}}),a.extend({haloPath:function(a){if(!a){return[]}var c=this.shapeArgs;return["M",c.x-a,c.y-a,"L",c.x-a,c.y+c.height+a,c.x+c.width+a,c.y+c.height+a,c.x+c.width+a,c.y-a,"Z"]}},g))})(k)})});var histogramBellcurve=createCommonjsModule(function(module){(function(b){"object"==="object"&&module.exports?module.exports=b:b(Highcharts)})(function(b){var t=function(a){var b=a.each,g=a.Series,k=a.addEvent,n=a.fireEvent,d=a.wrap,h={init:function(){g.prototype.init.apply(this,arguments);this.initialised=!1;this.baseSeries=null;this.eventRemovers=[];this.addEvents()},setDerivedData:a.noop,setBaseSeries:function(){var l=this.chart,a=this.options.baseSeries;this.baseSeries=a&&(l.series[a]||l.get(a))||null},addEvents:function(){var a=this,e;e=k(this.chart,"seriesLinked",function(){a.setBaseSeries();a.baseSeries&&!a.initialised&&(a.setDerivedData(),a.addBaseSeriesEvents(),a.initialised=!0)});this.eventRemovers.push(e)},addBaseSeriesEvents:function(){var a=this,e,b;e=k(a.baseSeries,"updatedData",function(){a.setDerivedData()});b=k(a.baseSeries,"destroy",function(){a.baseSeries=null;a.initialised=!1});a.eventRemovers.push(e,b)},destroy:function(){b(this.eventRemovers,function(a){a()});g.prototype.destroy.apply(this,arguments)}};d(a.Chart.prototype,"linkSeries",function(a){a.call(this);n(this,"seriesLinked")});return h}(b);(function(a,b){function g(a){return function(m){return Math.floor(m/a)*a}}var k=a.each,n=a.objectEach,d=a.seriesType,h=a.correctFloat,l=a.isNumber,e=a.arrayMax,p=a.arrayMin;a=a.merge;var c={"square-root":function(a){return Math.round(Math.sqrt(a.options.data.length))},sturges:function(a){return Math.ceil(Math.log(a.options.data.length)*Math.LOG2E)},rice:function(a){return Math.ceil(2*Math.pow(a.options.data.length,1/3))}};d("histogram","column",{binsNumber:"square-root",binWidth:void 0,pointPadding:0,groupPadding:0,grouping:!1,pointPlacement:"between",tooltip:{headerFormat:"",pointFormat:'<span style="font-size:10px">{point.x} - {point.x2}</span><br/><span style="color:{point.color}">‚óè</span> {series.name} <b>{point.y}</b><br/>'}},a(b,{setDerivedData:function(){var a=this.derivedData(this.baseSeries.yData,this.binsNumber(),this.options.binWidth);this.setData(a,!1)},derivedData:function(a,f,c){var m=e(a),b=p(a),q={},d=[],r;c=this.binWidth=l(c)?c:(m-b)/f;r=g(c);for(f=r(b);f<=m;f+=c){q[h(f)]=0}k(a,function(a){a=h(r(a));q[a]++});n(q,function(a,m){d.push({x:Number(m),y:a,x2:h(Number(m)+c)})});d.sort(function(a,c){return a.x-c.x});return d},binsNumber:function(){var a=this.options.binsNumber,f=c[a]||"function"===typeof a;return Math.ceil(f&&f(this.baseSeries)||(l(a)?a:c["square-root"](this.baseSeries)))}}))})(b,t);(function(a,b){function g(a){var c=a.length;a=p(a,function(a,c){return a+c},0);return 0<c&&a/c}function k(a,b){var c=a.length;b=l(b)?b:g(a);a=p(a,function(a,c){c-=b;return a+c*c},0);return 1<c&&Math.sqrt(a/(c-1))}function n(a,b,f){a-=b;return Math.exp(-(a*a)/(2*f*f))/(f*Math.sqrt(2*Math.PI))}var d=a.seriesType,h=a.correctFloat,l=a.isNumber,e=a.merge,p=a.reduce;d("bellcurve","areaspline",{intervals:3,pointsInInterval:3,marker:{enabled:!1}},e(b,{setMean:function(){this.mean=h(g(this.baseSeries.yData))},setStandardDeviation:function(){this.standardDeviation=h(k(this.baseSeries.yData,this.mean))},setDerivedData:function(){1<this.baseSeries.yData.length&&(this.setMean(),this.setStandardDeviation(),this.setData(this.derivedData(this.mean,this.standardDeviation),!1))},derivedData:function(a,b){var c=this.options.intervals,d=this.options.pointsInInterval,e=a-c*b,c=c*d*2+1,d=b/d,h=[],g;for(g=0;g<c;g++){h.push([e,n(e,a,b)]),e+=d}return h}}))})(b,t)})});var offlineExporting=createCommonjsModule(function(module){(function(n){"object"==="object"&&module.exports?module.exports=n:n(Highcharts)})(function(n){(function(d){function n(a,f){var c=t.getElementsByTagName("head")[0],b=t.createElement("script");b.type="text/javascript";b.src=a;b.onload=f;b.onerror=function(){d.error("Error loading script "+a)};c.appendChild(b)}var C=d.merge,e=d.win,r=e.navigator,t=e.document,w=d.each,x=e.URL||e.webkitURL||e,B=/Edge\/|Trident\/|MSIE /.test(r.userAgent),D=/Edge\/\d+/.test(r.userAgent),E=B?150:0;d.CanVGRenderer={};d.dataURLtoBlob=function(a){if(e.atob&&e.ArrayBuffer&&e.Uint8Array&&e.Blob&&x.createObjectURL){a=a.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);for(var d=e.atob(a[3]),c=new e.ArrayBuffer(d.length),c=new e.Uint8Array(c),b=0;b<c.length;++b){c[b]=d.charCodeAt(b)}a=new e.Blob([c],{type:a[1]});return x.createObjectURL(a)}};d.downloadURL=function(a,f){var c=t.createElement("a"),b;if("string"===typeof a||a instanceof String||!r.msSaveOrOpenBlob){if(D||2e6<a.length){if(a=d.dataURLtoBlob(a),!a){throw"Data URL length limit reached"}}if(void 0!==c.download){c.href=a,c.download=f,t.body.appendChild(c),c.click(),t.body.removeChild(c)}else{try{if(b=e.open(a,"chart"),void 0===b||null===b){throw"Failed to open window"}}catch(u){e.location.href=a}}}else{r.msSaveOrOpenBlob(a,f)}};d.svgToDataUrl=function(a){var d=-1<r.userAgent.indexOf("WebKit")&&0>r.userAgent.indexOf("Chrome");try{if(!d&&0>r.userAgent.toLowerCase().indexOf("firefox")){return x.createObjectURL(new e.Blob([a],{type:"image/svg+xml;charset-utf-16"}))}}catch(c){}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(a)};d.imageToDataUrl=function(a,d,c,b,u,l,k,m,p){var g=new e.Image,h,f=function(){setTimeout(function(){var e=t.createElement("canvas"),f=e.getContext&&e.getContext("2d"),y;try{if(f){e.height=g.height*b;e.width=g.width*b;f.drawImage(g,0,0,e.width,e.height);try{y=e.toDataURL(d),u(y,d,c,b)}catch(F){h(a,d,c,b)}}else{k(a,d,c,b)}}finally{p&&p(a,d,c,b)}},E)},q=function(){m(a,d,c,b);p&&p(a,d,c,b)};h=function(){g=new e.Image;h=l;g.crossOrigin="Anonymous";g.onload=f;g.onerror=q;g.src=a};g.onload=f;g.onerror=q;g.src=a};d.downloadSVGLocal=function(a,f,c,b){function u(b,a){a=new e.jsPDF("l","pt",[b.width.baseVal.value+2*a,b.height.baseVal.value+2*a]);w(b.querySelectorAll('*[visibility="hidden"]'),function(b){b.parentNode.removeChild(b)});e.svg2pdf(b,a,{removeInvalid:!0});return a.output("datauristring")}function l(){z.innerHTML=a;var e=z.getElementsByTagName("text"),f,g=z.getElementsByTagName("svg")[0].style;w(e,function(b){w(["font-family","font-size"],function(a){!b.style[a]&&g[a]&&(b.style[a]=g[a])});b.style["font-family"]=b.style["font-family"]&&b.style["font-family"].split(" ").splice(-1);f=b.getElementsByTagName("title");w(f,function(a){b.removeChild(a)})});e=u(z.firstChild,0);try{d.downloadURL(e,v),b&&b()}catch(G){c()}}var k,m,p=!0,g,h=f.libURL||d.getOptions().exporting.libURL,z=t.createElement("div"),q=f.type||"image/png",v=(f.filename||"chart")+"."+("image/svg+xml"===q?"svg":q.split("/")[1]),A=f.scale||1,h="/"!==h.slice(-1)?h+"/":h;if("image/svg+xml"===q){try{r.msSaveOrOpenBlob?(m=new MSBlobBuilder,m.append(a),k=m.getBlob("image/svg+xml")):k=d.svgToDataUrl(a),d.downloadURL(k,v),b&&b()}catch(y){c()}}else{"application/pdf"===q?e.jsPDF&&e.svg2pdf?l():(p=!0,n(h+"jspdf.js",function(){n(h+"svg2pdf.js",function(){l()})})):(k=d.svgToDataUrl(a),g=function(){try{x.revokeObjectURL(k)}catch(y){}},d.imageToDataUrl(k,q,{},A,function(a){try{d.downloadURL(a,v),b&&b()}catch(F){c()}},function(){var f=t.createElement("canvas"),u=f.getContext("2d"),l=a.match(/^<svg[^>]*width\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*A,k=a.match(/^<svg[^>]*height\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*A,m=function(){u.drawSvg(a,0,0,l,k);try{d.downloadURL(r.msSaveOrOpenBlob?f.msToBlob():f.toDataURL(q),v),b&&b()}catch(H){c()}finally{g()}};f.width=l;f.height=k;e.canvg?m():(p=!0,n(h+"rgbcolor.js",function(){n(h+"canvg.js",function(){m()})}))},c,c,function(){p&&g()}))}};d.Chart.prototype.getSVGForLocalExport=function(a,e,c,b){var f=this,l,k=0,m,p,g,h,n,q=function(a,d,c){++k;c.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",a);k===l.length&&b(f.sanitizeSVG(m.innerHTML,p))};d.wrap(d.Chart.prototype,"getChartHTML",function(b){var a=b.apply(this,Array.prototype.slice.call(arguments,1));p=this.options;m=this.container.cloneNode(!0);return a});f.getSVGForExport(a,e);l=m.getElementsByTagName("image");try{if(l.length){for(h=0,n=l.length;h<n;++h){g=l[h],d.imageToDataUrl(g.getAttributeNS("http://www.w3.org/1999/xlink","href"),"image/png",{imageElement:g},a.scale,q,c,c,c)}}else{b(f.sanitizeSVG(m.innerHTML,p))}}catch(v){c()}};d.Chart.prototype.exportChartLocal=function(a,e){var c=this,b=d.merge(c.options.exporting,a),f=function(){if(!1===b.fallbackToExportServer){if(b.error){b.error(b)}else{throw"Fallback to export server disabled"}}else{c.exportChart(b)}};B&&("application/pdf"===b.type||c.container.getElementsByTagName("image").length&&"image/svg+xml"!==b.type)||"application/pdf"===b.type&&c.container.getElementsByTagName("image").length?f():c.getSVGForLocalExport(b,e,f,function(a){-1<a.indexOf("<foreignObject")&&"image/svg+xml"!==b.type?f():d.downloadSVGLocal(a,b,f)})};C(!0,d.getOptions().exporting,{libURL:"https://code.highcharts.com/6.0.3/lib/",menuItemDefinitions:{downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChartLocal({type:"image/jpeg"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChartLocal({type:"application/pdf"})}}}})})(n)})});var pareto=createCommonjsModule(function(module){(function(c){"object"==="object"&&module.exports?module.exports=c:c(Highcharts)})(function(c){var p=function(a){var c=a.each,d=a.Series,f=a.addEvent,e=a.fireEvent,m=a.wrap,n={init:function(){d.prototype.init.apply(this,arguments);this.initialised=!1;this.baseSeries=null;this.eventRemovers=[];this.addEvents()},setDerivedData:a.noop,setBaseSeries:function(){var b=this.chart,a=this.options.baseSeries;this.baseSeries=a&&(b.series[a]||b.get(a))||null},addEvents:function(){var b=this,a;a=f(this.chart,"seriesLinked",function(){b.setBaseSeries();b.baseSeries&&!b.initialised&&(b.setDerivedData(),b.addBaseSeriesEvents(),b.initialised=!0)});this.eventRemovers.push(a)},addBaseSeriesEvents:function(){var b=this,a,c;a=f(b.baseSeries,"updatedData",function(){b.setDerivedData()});c=f(b.baseSeries,"destroy",function(){b.baseSeries=null;b.initialised=!1});b.eventRemovers.push(a,c)},destroy:function(){c(this.eventRemovers,function(a){a()});d.prototype.destroy.apply(this,arguments)}};m(a.Chart.prototype,"linkSeries",function(a){a.call(this);e(this,"seriesLinked")});return n}(c);(function(a,c){var d=a.each,f=a.correctFloat,e=a.seriesType;a=a.merge;e("pareto","line",{zIndex:3},a(c,{setDerivedData:function(){if(1<this.baseSeries.yData.length){var a=this.baseSeries.xData,c=this.baseSeries.yData,b=this.sumPointsPercents(c,a,null,!0);this.setData(this.sumPointsPercents(c,a,b,!1),!1)}},sumPointsPercents:function(a,c,b,e){var h=0,k=0,l=[],g;d(a,function(a,d){null!==a&&(e?h+=a:(g=a/b*100,l.push([c[d],f(k+g)]),k+=g))});return e?h:l}}))})(c,p)})});var sankey=createCommonjsModule(function(module){(function(k){"object"==="object"&&module.exports?module.exports=k:k(Highcharts)})(function(k){(function(g){var k=g.defined,d=g.each,w=g.extend,x=g.seriesType,r=g.Point;x("sankey","column",{colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){return""},inside:!0},linkOpacity:.5,nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.85em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} ‚Üí {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}},{isCartesian:!1,forceDL:!0,createNode:function(c){function a(a,b){return g.find(a,function(a){return a.id===b})}var b=a(this.nodes,c),e;b||(e=this.options.nodes&&a(this.options.nodes,c),b=(new r).init(this,w({className:"highcharts-node",isNode:!0,id:c,y:1},e)),b.linksTo=[],b.linksFrom=[],b.formatPrefix="node",b.name=b.name||b.id,b.getSum=function(){var a=0,c=0;d(b.linksTo,function(c){a+=c.weight});d(b.linksFrom,function(a){c+=a.weight});return Math.max(a,c)},b.offset=function(a,c){for(var f=0,e=0;e<b[c].length;e++){if(b[c][e]===a){return f}f+=b[c][e].weight}},b.hasShape=function(){var a=0;d(b.linksTo,function(c){c.outgoing&&a++});return!b.linksTo.length||a!==b.linksTo.length},this.nodes.push(b));return b},createNodeColumn:function(){var c=this.chart,a=[],b=this.options.nodePadding;a.sum=function(){var a=0;d(this,function(c){a+=c.getSum()});return a};a.offset=function(c,f){for(var e=0,d=0;d<a.length;d++){if(a[d]===c){return e}e+=a[d].getSum()*f+b}};a.top=function(e){for(var f=0,d=0;d<a.length;d++){0<d&&(f+=b),f+=a[d].getSum()*e}return(c.plotSizeY-f)/2};return a},createNodeColumns:function(){var c=[];d(this.nodes,function(a){var b=0,d,f;if(0===a.linksTo.length){a.column=0}else{for(d=0;d<a.linksTo.length;d++){f=a.linksTo[0],f.fromNode.column>b&&(b=f.fromNode.column)}a.column=b+1}c[a.column]||(c[a.column]=this.createNodeColumn());c[a.column].push(a)},this);return c},pointAttribs:function(c,a){var b=this.options.linkOpacity;a&&(b=this.options.states[a].linkOpacity||b);return{fill:c.isNode?c.color:g.color(c.color).setOpacity(b).get()}},generatePoints:function(){var c={};g.Series.prototype.generatePoints.call(this);this.nodes||(this.nodes=[]);this.colorCounter=0;d(this.nodes,function(a){a.linksFrom.length=0;a.linksTo.length=0});d(this.points,function(a){k(a.from)&&(c[a.from]||(c[a.from]=this.createNode(a.from)),c[a.from].linksFrom.push(a),a.fromNode=c[a.from],a.color=a.options.color||c[a.from].color);k(a.to)&&(c[a.to]||(c[a.to]=this.createNode(a.to)),c[a.to].linksTo.push(a),a.toNode=c[a.to]);a.name=a.name||a.id},this)},translate:function(){this.processedXData||this.processData();this.generatePoints();this.nodeColumns=this.createNodeColumns();var c=this.chart,a=c.inverted,b=this.options,e=0,f=b.nodeWidth,g=this.nodeColumns,k=(c.plotSizeX-f)/(g.length-1),t=(a?-k:k)*b.curveFactor,m=Infinity;d(this.nodeColumns,function(a){m=Math.min(m,(c.plotSizeY-(a.length-1)*b.nodePadding)/a.sum())});d(this.nodeColumns,function(b){d(b,function(l){var r=l.getSum(),u=r*m,v=b.top(m)+b.offset(l,m),n=a?c.plotSizeX-e:e;l.sum=r;l.shapeType="rect";l.shapeArgs=a?{x:n-f,y:c.plotSizeY-v-u,width:f,height:u}:{x:n,y:v,width:f,height:u};l.shapeArgs.display=l.hasShape()?"":"none";l.plotY=1;d(l.linksFrom,function(b){var d=b.weight*m,e=l.offset(b,"linksFrom")*m,e=v+e,h=b.toNode,p=g[h.column].top(m)+h.offset(b,"linksTo")*m+g[h.column].offset(h,m),q=f,h=h.column*k,r=b.outgoing;a&&(e=c.plotSizeY-e,p=c.plotSizeY-p,h=c.plotSizeX-h,q=-q,d=-d);b.shapeType="path";b.shapeArgs={d:["M",n+q,e,"C",n+q+t,e,h-t,p,h,p,"L",h+(r?q:0),p+d/2,"L",h,p+d,"C",h-t,p+d,n+q+t,e+d,n+q,e+d,"z"]};b.dlBox={x:n+(h-n+q)/2,y:e+(p-e)/2,height:d,width:0};b.y=b.plotY=1;b.color||(b.color=l.color)})});e+=k},this)},render:function(){var c=this.points;this.points=this.points.concat(this.nodes);g.seriesTypes.column.prototype.render.call(this);this.points=c},animate:g.Series.prototype.animate},{getClassName:function(){return"highcharts-link "+r.prototype.getClassName.call(this)},isValid:function(){return this.isNode||"number"===typeof this.weight}})})(k)})});var seriesLabel=createCommonjsModule(function(module){(function(t){"object"==="object"&&module.exports?module.exports=t:t(Highcharts)})(function(t){(function(n){function t(d,b,a,m,c,e){d=(e-b)*(a-d)-(m-b)*(c-d);return 0<d?!0:0>d?!1:!0}function v(d,b,a,m,c,e,f,h){return t(d,b,c,e,f,h)!==t(a,m,c,e,f,h)&&t(d,b,a,m,c,e)!==t(d,b,a,m,f,h)}function B(d,b,a,m,c,e,f,h){return v(d,b,d+a,b,c,e,f,h)||v(d+a,b,d+a,b+m,c,e,f,h)||v(d,b+m,d+a,b+m,c,e,f,h)||v(d,b,d,b+m,c,e,f,h)}function C(d){var b=this,a=Math.max(n.animObject(b.renderer.globalAnimation).duration,250),m=!b.hasRendered;d.apply(b,[].slice.call(arguments,1));b.labelSeries=[];b.labelSeriesMaxSum=0;clearTimeout(b.seriesLabelTimer);w(b.series,function(c){var e=c.options.label,d=c.labelBySeries,h=d&&d.closest;e.enabled&&c.visible&&(c.graph||c.area)&&!c.isSeriesBoosting&&(b.labelSeries.push(c),e.minFontSize&&e.maxFontSize&&(c.sum=n.reduce(c.yData,function(a,b){return(a||0)+(b||0)},0),b.labelSeriesMaxSum=Math.max(b.labelSeriesMaxSum,c.sum)),m&&(a=Math.max(a,n.animObject(c.options.animation).duration)),h&&(void 0!==h[0].plotX?d.animate({x:h[0].plotX+h[1],y:h[0].plotY+h[2]}):d.attr({opacity:0})))});b.seriesLabelTimer=n.syncTimeout(function(){b.drawSeriesLabels()},b.renderer.forExport?0:a)}var D=n.wrap,w=n.each,E=n.extend,y=n.isNumber,x=n.pick,z=n.Series,F=n.SVGRenderer,A=n.Chart;n.setOptions({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!0,connectorNeighbourDistance:24,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}});F.prototype.symbols.connector=function(d,b,a,m,c){var e=c&&c.anchorX;c=c&&c.anchorY;var f,h,g=a/2;y(e)&&y(c)&&(f=["M",e,c],h=b-c,0>h&&(h=-m-h),h<a&&(g=e<d+a/2?h:a-h),c>b+m?f.push("L",d+g,b+m):c<b?f.push("L",d+g,b):e<d?f.push("L",d,b+m/2):e>d+a&&f.push("L",d+a,b+m/2));return f||[]};z.prototype.getPointsOnGraph=function(){if(this.xAxis||this.yAxis){var d=this.points,b,a,m=[],c,e,f,h;e=this.graph||this.area;f=e.element;var g=this.chart.inverted,q=this.xAxis;b=this.yAxis;var r=g?b.pos:q.pos,g=g?q.pos:b.pos,q=x(this.options.label.onArea,!!this.area),u=b.getThreshold(this.options.threshold);if(this.getPointSpline&&f.getPointAtLength&&!q){e.toD&&(a=e.attr("d"),e.attr({d:e.toD}));h=f.getTotalLength();for(c=0;c<h;c+=16){b=f.getPointAtLength(c),m.push({chartX:r+b.x,chartY:g+b.y,plotX:b.x,plotY:b.y})}a&&e.attr({d:a});b=d[d.length-1];b.chartX=r+b.plotX;b.chartY=g+b.plotY;m.push(b)}else{for(h=d.length,c=0;c<h;c+=1){b=d[c];a=d[c-1];b.chartX=r+b.plotX;b.chartY=g+b.plotY;q&&(b.chartCenterY=g+(b.plotY+x(b.yBottom,u))/2);if(0<c&&(e=Math.abs(b.chartX-a.chartX),f=Math.abs(b.chartY-a.chartY),e=Math.max(e,f),16<e)){for(e=Math.ceil(e/16),f=1;f<e;f+=1){m.push({chartX:a.chartX+f/e*(b.chartX-a.chartX),chartY:a.chartY+f/e*(b.chartY-a.chartY),chartCenterY:a.chartCenterY+f/e*(b.chartCenterY-a.chartCenterY),plotX:a.plotX+f/e*(b.plotX-a.plotX),plotY:a.plotY+f/e*(b.plotY-a.plotY)})}}y(b.plotY)&&m.push(b)}}return m}};z.prototype.labelFontSize=function(d,b){return d+this.sum/this.chart.labelSeriesMaxSum*(b-d)+"px"};z.prototype.checkClearPoint=function(d,b,a,m){var c=Number.MAX_VALUE,e=Number.MAX_VALUE,f,h,g=this.options.label.connectorAllowed,q=x(this.options.label.onArea,!!this.area),r=this.chart,u,k,n,t,p,l;for(p=0;p<r.boxesToAvoid.length;p+=1){if(k=r.boxesToAvoid[p],l=d+a.width,u=b,n=b+a.height,!(d>k.right||l<k.left||u>k.bottom||n<k.top)){return!1}}for(p=0;p<r.series.length;p+=1){if(u=r.series[p],k=u.interpolatedPoints,u.visible&&k){for(l=1;l<k.length;l+=1){if(k[l].chartX>=d-16&&k[l-1].chartX<=d+a.width+16){if(B(d,b,a.width,a.height,k[l-1].chartX,k[l-1].chartY,k[l].chartX,k[l].chartY)){return!1}this===u&&!f&&m&&(f=B(d-16,b-16,a.width+32,a.height+32,k[l-1].chartX,k[l-1].chartY,k[l].chartX,k[l].chartY))}!g&&!f||this===u&&!q||(n=d+a.width/2-k[l].chartX,t=b+a.height/2-k[l].chartY,c=Math.min(c,n*n+t*t))}if(!q&&g&&this===u&&(m&&!f||c<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(l=1;l<k.length;l+=1){f=Math.min(Math.pow(d+a.width/2-k[l].chartX,2)+Math.pow(b+a.height/2-k[l].chartY,2),Math.pow(d-k[l].chartX,2)+Math.pow(b-k[l].chartY,2),Math.pow(d+a.width-k[l].chartX,2)+Math.pow(b-k[l].chartY,2),Math.pow(d+a.width-k[l].chartX,2)+Math.pow(b+a.height-k[l].chartY,2),Math.pow(d-k[l].chartX,2)+Math.pow(b+a.height-k[l].chartY,2)),f<e&&(e=f,h=k[l])}f=!0}}}return!m||f?{x:d,y:b,weight:c-(h?e:0),connectorPoint:h}:!1};A.prototype.drawSeriesLabels=function(){var d=this,b=this.labelSeries;d.boxesToAvoid=[];w(b,function(a){a.interpolatedPoints=a.getPointsOnGraph();w(a.options.label.boxesToAvoid||[],function(a){d.boxesToAvoid.push(a)})});w(d.series,function(a){function b(a,b,c){return a>n&&a<=n+t-c.width&&b>=k&&b<=k+v-c.height}if(a.xAxis||a.yAxis){var c,e,f,h=[],g,q;c=a.options.label;var r=d.inverted,n=r?a.yAxis.pos:a.xAxis.pos,k=r?a.xAxis.pos:a.yAxis.pos,t=d.inverted?a.yAxis.len:a.xAxis.len,v=d.inverted?a.xAxis.len:a.yAxis.len,p=a.interpolatedPoints,l=x(c.onArea,!!a.area),r=a.labelBySeries;e=c.minFontSize;c=c.maxFontSize;if(a.visible&&!a.isSeriesBoosting&&p){r||(a.labelBySeries=r=d.renderer.label(a.name,0,-9999,"connector").css(E({color:l?d.renderer.getContrast(a.color):a.color},a.options.label.style)),e&&c&&r.css({fontSize:a.labelFontSize(e,c)}),r.attr({padding:0,opacity:d.renderer.forExport?1:0,stroke:a.color,"stroke-width":1,zIndex:3}).add(a.group).animate({opacity:1},{duration:200}));c=r.getBBox();c.width=Math.round(c.width);for(q=p.length-1;0<q;--q){l?(e=p[q].chartX-c.width/2,f=p[q].chartCenterY-c.height/2):(e=p[q].chartX+3,f=p[q].chartY-c.height-3,b(e,f,c)&&(g=a.checkClearPoint(e,f,c)),g&&h.push(g),e=p[q].chartX+3,f=p[q].chartY+3,b(e,f,c)&&(g=a.checkClearPoint(e,f,c)),g&&h.push(g),e=p[q].chartX-c.width-3,f=p[q].chartY+3,b(e,f,c)&&(g=a.checkClearPoint(e,f,c)),g&&h.push(g),e=p[q].chartX-c.width-3,f=p[q].chartY-c.height-3),b(e,f,c)&&(g=a.checkClearPoint(e,f,c)),g&&h.push(g)}if(!h.length&&!l){for(e=n+t-c.width;e>=n;e-=16){for(f=k;f<k+v-c.height;f+=16){(g=a.checkClearPoint(e,f,c,!0))&&h.push(g)}}}if(h.length){if(h.sort(function(a,b){return b.weight-a.weight}),g=h[0],d.boxesToAvoid.push({left:g.x,right:g.x+c.width,top:g.y,bottom:g.y+c.height}),h=Math.sqrt(Math.pow(Math.abs(g.x-r.x),2),Math.pow(Math.abs(g.y-r.y),2))){p={opacity:d.renderer.forExport?1:0,x:g.x-n,y:g.y-k},l={opacity:1},10>=h&&(l={x:p.x,y:p.y},p={}),a.labelBySeries.attr(E(p,{anchorX:g.connectorPoint&&g.connectorPoint.plotX,anchorY:g.connectorPoint&&g.connectorPoint.plotY})).animate(l),a.options.kdNow=!0,a.buildKDTree(),a=a.searchPoint({chartX:g.x,chartY:g.y},!0),r.closest=[a,g.x-n-a.plotX,g.y-k-a.plotY]}}else{r&&(a.labelBySeries=r.destroy())}}}})};D(A.prototype,"render",C);D(A.prototype,"redraw",C)})(t)})});var solidGauge=createCommonjsModule(function(module){(function(l){"object"==="object"&&module.exports?module.exports=l:l(Highcharts)})(function(l){(function(e){var l=e.pInt,u=e.pick,m=e.each,r=e.isNumber,w=e.wrap,v;w(e.Renderer.prototype.symbols,"arc",function(a,f,d,c,e,b){a=a(f,d,c,e,b);b.rounded&&(c=((b.r||c)-b.innerR)/2,b=["A",c,c,0,1,1,a[12],a[13]],a.splice.apply(a,[a.length-1,0].concat(["A",c,c,0,1,1,a[1],a[2]])),a.splice.apply(a,[11,3].concat(b)));return a});v={initDataClasses:function(a){var f=this.chart,d,c=0,t=this.options;this.dataClasses=d=[];m(a.dataClasses,function(b,h){b=e.merge(b);d.push(b);b.color||("category"===t.dataClassColor?(h=f.options.colors,b.color=h[c++],c===h.length&&(c=0)):b.color=e.color(t.minColor).tweenTo(e.color(t.maxColor),h/(a.dataClasses.length-1)))})},initStops:function(a){this.stops=a.stops||[[0,this.options.minColor],[1,this.options.maxColor]];m(this.stops,function(a){a.color=e.color(a[1])})},toColor:function(a,f){var d=this.stops,c,e,b=this.dataClasses,h,g;if(b){for(g=b.length;g--;){if(h=b[g],c=h.from,d=h.to,(void 0===c||a>=c)&&(void 0===d||a<=d)){e=h.color;f&&(f.dataClass=g);break}}}else{this.isLog&&(a=this.val2lin(a));a=1-(this.max-a)/(this.max-this.min);for(g=d.length;g--&&!(a>d[g][0]);){}c=d[g]||d[g+1];d=d[g+1]||c;a=1-(d[0]-a)/(d[0]-c[0]||1);e=c.color.tweenTo(d.color,a)}return e}};e.seriesType("solidgauge","gauge",{colorByPoint:!0},{translate:function(){var a=this.yAxis;e.extend(a,v);!a.dataClasses&&a.options.dataClasses&&a.initDataClasses(a.options);a.initStops(a.options);e.seriesTypes.gauge.prototype.translate.call(this)},drawPoints:function(){var a=this,f=a.yAxis,d=f.center,c=a.options,t=a.chart.renderer,b=c.overshoot,h=r(b)?b/180*Math.PI:0,g;r(c.threshold)&&(g=f.startAngleRad+f.translate(c.threshold,null,null,null,!0));this.thresholdAngleRad=u(g,f.startAngleRad);m(a.points,function(b){var g=b.graphic,k=f.startAngleRad+f.translate(b.y,null,null,null,!0),m=l(u(b.options.radius,c.radius,100))*d[2]/200,n=l(u(b.options.innerRadius,c.innerRadius,60))*d[2]/200,p=f.toColor(b.y,b),q=Math.min(f.startAngleRad,f.endAngleRad),r=Math.max(f.startAngleRad,f.endAngleRad);"none"===p&&(p=b.color||a.color||"none");"none"!==p&&(b.color=p);k=Math.max(q-h,Math.min(r+h,k));!1===c.wrap&&(k=Math.max(q,Math.min(r,k)));q=Math.min(k,a.thresholdAngleRad);k=Math.max(k,a.thresholdAngleRad);k-q>2*Math.PI&&(k=q+2*Math.PI);b.shapeArgs=n={x:d[0],y:d[1],r:m,innerR:n,start:q,end:k,rounded:c.rounded};b.startR=m;g?(b=n.d,g.animate(e.extend({fill:p},n)),b&&(n.d=b)):(b.graphic=t.arc(n).addClass(b.getClassName(),!0).attr({fill:p,"sweep-flag":0}).add(a.group),"square"!==c.linecap&&b.graphic.attr({"stroke-linecap":"round","stroke-linejoin":"round"}),b.graphic.attr({stroke:c.borderColor||"none","stroke-width":c.borderWidth||0}))})},animate:function(a){a||(this.startAngleRad=this.thresholdAngleRad,e.seriesTypes.pie.prototype.animate.call(this,a))}})})(l)})});var streamgraph=createCommonjsModule(function(module){(function(a){"object"==="object"&&module.exports?module.exports=a:a(Highcharts)})(function(a){(function(a){a=a.seriesType;a("streamgraph","areaspline",{fillOpacity:1,lineWidth:0,marker:{enabled:!1},stacking:"stream"},{negStacks:!1,streamStacker:function(a,b,c){a[0]-=b.total/2;a[1]-=b.total/2;this.stackedYData[c]=0===this.index?a[1]:a[0]}})})(a)})});var sunburst=createCommonjsModule(function(module){(function(D){"object"==="object"&&module.exports?module.exports=D:D(Highcharts)})(function(D){(function(b){var t=b.deg2rad,e=b.isNumber,p=b.pick,v=b.relativeLength;b.CenteredSeriesMixin={getCenter:function(){var b=this.options,q=this.chart,m=2*(b.slicedOffset||0),g=q.plotWidth-2*m,q=q.plotHeight-2*m,e=b.center,e=[p(e[0],"50%"),p(e[1],"50%"),b.size||"100%",b.innerSize||0],t=Math.min(g,q),r,B;for(r=0;4>r;++r){B=e[r],b=2>r||2===r&&/%$/.test(B),e[r]=v(B,[g,q,t,e[2]][r])+(b?m:0)}e[3]>e[2]&&(e[3]=e[2]);return e},getStartAndEndRadians:function(b,q){b=e(b)?b:0;q=e(q)&&q>b&&360>q-b?q:b+360;return{start:t*(b+-90),end:t*(q+-90)}}}})(D);var O=function(){return function(b){var t=this,e=t.graphic,p=b.animate,v=b.attr,k=b.onComplete,q=b.css,m=b.group,g=b.renderer,N=b.shapeArgs;b=b.shapeType;t.shouldDraw()?(e||(t.graphic=e=g[b](N).add(m)),e.css(q).attr(v).animate(p,void 0,k)):e&&e.animate(p,void 0,function(){t.graphic=e=e.destroy();"function"===typeof k&&k()});e&&e.addClass(t.getClassName(),!0)}}(),M=function(b){var t=b.each,e=b.extend,p=b.pick;return{getColor:function(e,k){var q=k.index,m=k.levelMap,g=k.parentColor,t=k.parentColorIndex,A=k.series,r=k.colors,B=k.siblings,h=A.points,x,F,G,v;if(e){h=h[e.i];e=m[e.levelDynamic]||{};if(x=h&&("boolean"===typeof e.colorByPoint?e.colorByPoint:!!A.options.colorByPoint)){G=h.index%(r?r.length:A.chart.options.chart.colorCount),F=r&&r[G]}r=h&&h.options.color;x=e&&e.color;if(m=g){m=(m=e&&e.colorVariation)&&"brightness"===m.key?b.color(g).brighten(q/B*m.to).get():g}x=p(r,x,F,m,A.color);v=p(h&&h.options.colorIndex,e&&e.colorIndex,G,t,k.colorIndex)}return{color:x,colorIndex:v}},setTreeValues:function k(b,m){var g=m.before,q=m.idRoot,A=m.mapIdToNode[q],r=m.points[b.i],B=r&&r.options||{},h=0,x=[];e(b,{levelDynamic:b.level-(("boolean"===typeof m.levelIsConstant?m.levelIsConstant:1)?0:A.level),name:p(r&&r.name,""),visible:q===b.id||("boolean"===typeof m.visible?m.visible:!1)});"function"===typeof g&&(b=g(b,m));t(b.children,function(g,p){var q=e({},m);e(q,{index:p,siblings:b.children.length,visible:b.visible});g=k(g,q);x.push(g);g.visible&&(h+=g.val)});b.visible=0<h||b.visible;g=p(B.value,h);e(b,{children:x,childrenTotal:h,isLeaf:b.visible&&!h,val:g});return b}}}(D);(function(b,t){var e=b.seriesType,p=b.seriesTypes,v=b.map,k=b.merge,q=b.extend,m=b.noop,g=b.each,D=t.getColor,A=b.grep,r=b.isNumber,B=b.isString,h=b.pick,x=b.Series,F=b.stableSort,G=b.Color,J=function(a,c,d){d=d||this;b.objectEach(a,function(n,f){c.call(d,n,f,a)})},H=b.reduce,E=function(a,c,d){d=d||this;a=c.call(d,a);!1!==a&&E(a,c,d)};e("treemap","scatter",{showInLegend:!1,marker:!1,dataLabels:{enabled:!0,defer:!1,verticalAlign:"middle",formatter:function(){return this.point.name||this.point.id},inside:!0},tooltip:{headerFormat:"",pointFormat:"<b>{point.name}</b>: {point.value}<br/>"},ignoreHiddenPoint:!0,layoutAlgorithm:"sliceAndDice",layoutStartingDirection:"vertical",alternateStartingDirection:!1,levelIsConstant:!0,drillUpButton:{position:{align:"right",x:-10,y:10}},borderColor:"#e6e6e6",borderWidth:1,opacity:.15,states:{hover:{borderColor:"#999999",brightness:p.heatmap?0:.1,halo:!1,opacity:.75,shadow:!1}}},{pointArrayMap:["value"],axisTypes:p.heatmap?["xAxis","yAxis","colorAxis"]:["xAxis","yAxis"],directTouch:!0,optionalAxis:"colorAxis",getSymbol:m,parallelArrays:["x","y","value","colorValue"],colorKey:"colorValue",translateColors:p.heatmap&&p.heatmap.prototype.translateColors,colorAttribs:p.heatmap&&p.heatmap.prototype.colorAttribs,trackerGroups:["group","dataLabelsGroup"],getListOfParents:function(a,c){a=H(a||[],function(a,c,f){c=h(c.parent,"");void 0===a[c]&&(a[c]=[]);a[c].push(f);return a},{});J(a,function(a,n,f){""!==n&&-1===b.inArray(n,c)&&(g(a,function(a){f[""].push(a)}),delete f[n])});return a},getTree:function(){var a=v(this.data,function(a){return a.id}),a=this.getListOfParents(this.data,a);this.nodeMap=[];return this.buildNode("",-1,0,a,null)},init:function(a,c){x.prototype.init.call(this,a,c);this.options.allowDrillToNode&&b.addEvent(this,"click",this.onClickDrillToNode)},buildNode:function(a,c,d,b,f){var l=this,n=[],u=l.points[c],K=0,e;g(b[a]||[],function(c){e=l.buildNode(l.points[c].id,c,d+1,b,a);K=Math.max(e.height+1,K);n.push(e)});c={id:a,i:c,children:n,height:K,level:d,parent:f,visible:!1};l.nodeMap[c.id]=c;u&&(u.node=c);return c},setTreeValues:function(a){var c=this,d=c.options,b=c.nodeMap[c.rootNode],d="boolean"===typeof d.levelIsConstant?d.levelIsConstant:!0,f=0,l=[],w,u=c.points[a.i];g(a.children,function(a){a=c.setTreeValues(a);l.push(a);a.ignore||(f+=a.val)});F(l,function(a,c){return a.sortIndex-c.sortIndex});w=h(u&&u.options.value,f);u&&(u.value=w);q(a,{children:l,childrenTotal:f,ignore:!(h(u&&u.visible,!0)&&0<w),isLeaf:a.visible&&!f,levelDynamic:a.level-(d?0:b.level),name:h(u&&u.name,""),sortIndex:h(u&&u.sortIndex,-w),val:w});return a},calculateChildrenAreas:function(a,c){var d=this,b=d.options,f=this.levelMap[a.levelDynamic+1],l=h(d[f&&f.layoutAlgorithm]&&f.layoutAlgorithm,b.layoutAlgorithm),w=b.alternateStartingDirection,u=[];a=A(a.children,function(a){return!a.ignore});f&&f.layoutStartingDirection&&(c.direction="vertical"===f.layoutStartingDirection?0:1);u=d[l](c,a);g(a,function(a,f){f=u[f];a.values=k(f,{val:a.childrenTotal,direction:w?1-c.direction:c.direction});a.pointValues=k(f,{x:f.x/d.axisRatio,width:f.width/d.axisRatio});a.children.length&&d.calculateChildrenAreas(a,a.values)})},setPointValues:function(){var a=this,c=a.xAxis,d=a.yAxis;g(a.points,function(b){var f=b.node,l=f.pointValues,n,u,e;e=(a.pointAttribs(b)["stroke-width"]||0)%2/2;l&&f.visible?(f=Math.round(c.translate(l.x,0,0,0,1))-e,n=Math.round(c.translate(l.x+l.width,0,0,0,1))-e,u=Math.round(d.translate(l.y,0,0,0,1))-e,l=Math.round(d.translate(l.y+l.height,0,0,0,1))-e,b.shapeType="rect",b.shapeArgs={x:Math.min(f,n),y:Math.min(u,l),width:Math.abs(n-f),height:Math.abs(l-u)},b.plotX=b.shapeArgs.x+b.shapeArgs.width/2,b.plotY=b.shapeArgs.y+b.shapeArgs.height/2):(delete b.plotX,delete b.plotY)})},setColorRecursive:function(a,c,d,b,f){var l=this,n=l&&l.chart,n=n&&n.options&&n.options.colors,e;if(a){e=D(a,{colors:n,index:b,levelMap:l.levelMap,parentColor:c,parentColorIndex:d,series:l,siblings:f});if(c=l.points[a.i]){c.color=e.color,c.colorIndex=e.colorIndex}g(a.children||[],function(c,d){l.setColorRecursive(c,e.color,e.colorIndex,d,a.children.length)})}},algorithmGroup:function(a,c,d,b){this.height=a;this.width=c;this.plot=b;this.startDirection=this.direction=d;this.lH=this.nH=this.lW=this.nW=this.total=0;this.elArr=[];this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(a,c){return Math.max(a/c,c/a)}};this.addElement=function(a){this.lP.total=this.elArr[this.elArr.length-1];this.total+=a;0===this.direction?(this.lW=this.nW,this.lP.lH=this.lP.total/this.lW,this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH),this.nW=this.total/this.height,this.lP.nH=this.lP.total/this.nW,this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)):(this.lH=this.nH,this.lP.lW=this.lP.total/this.lH,this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH),this.nH=this.total/this.width,this.lP.nW=this.lP.total/this.nH,this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH));this.elArr.push(a)};this.reset=function(){this.lW=this.nW=0;this.elArr=[];this.total=0}},algorithmCalcPoints:function(a,c,d,b){var f,l,n,e,m=d.lW,C=d.lH,y=d.plot,h,p=0,q=d.elArr.length-1;c?(m=d.nW,C=d.nH):h=d.elArr[d.elArr.length-1];g(d.elArr,function(a){if(c||p<q){0===d.direction?(f=y.x,l=y.y,n=m,e=a/n):(f=y.x,l=y.y,e=C,n=a/e),b.push({x:f,y:l,width:n,height:e}),0===d.direction?y.y+=e:y.x+=n}p+=1});d.reset();0===d.direction?d.width-=m:d.height-=C;y.y=y.parent.y+(y.parent.height-d.height);y.x=y.parent.x+(y.parent.width-d.width);a&&(d.direction=1-d.direction);c||d.addElement(h)},algorithmLowAspectRatio:function(a,c,d){var b=[],f=this,l,e={x:c.x,y:c.y,parent:c},u=0,m=d.length-1,h=new this.algorithmGroup(c.height,c.width,c.direction,e);g(d,function(d){l=d.val/c.val*c.height*c.width;h.addElement(l);h.lP.nR>h.lP.lR&&f.algorithmCalcPoints(a,!1,h,b,e);u===m&&f.algorithmCalcPoints(a,!0,h,b,e);u+=1});return b},algorithmFill:function(a,c,d){var b=[],f,l=c.direction,e=c.x,u=c.y,h=c.width,m=c.height,p,q,r,k;g(d,function(d){f=d.val/c.val*c.height*c.width;p=e;q=u;0===l?(k=m,r=f/k,h-=r,e+=r):(r=h,k=f/r,m-=k,u+=k);b.push({x:p,y:q,width:r,height:k});a&&(l=1-l)});return b},strip:function(a,c){return this.algorithmLowAspectRatio(!1,a,c)},squarified:function(a,c){return this.algorithmLowAspectRatio(!0,a,c)},sliceAndDice:function(a,c){return this.algorithmFill(!0,a,c)},stripes:function(a,c){return this.algorithmFill(!1,a,c)},translate:function(){var a=this,c=a.rootNode=h(a.rootNode,a.options.rootId,""),d,b;x.prototype.translate.call(a);a.levelMap=H(a.options.levels||[],function(a,c){a[c.level]=c;return a},{});b=a.tree=a.getTree();d=a.nodeMap[c];""===c||d&&d.children.length||(a.drillToNode("",!1),c=a.rootNode,d=a.nodeMap[c]);E(a.nodeMap[a.rootNode],function(c){var d=!1,b=c.parent;c.visible=!0;if(b||""===b){d=a.nodeMap[b]}return d});E(a.nodeMap[a.rootNode].children,function(a){var c=!1;g(a,function(a){a.visible=!0;a.children.length&&(c=(c||[]).concat(a.children))});return c});a.setTreeValues(b);a.axisRatio=a.xAxis.len/a.yAxis.len;a.nodeMap[""].pointValues=c={x:0,y:0,width:100,height:100};a.nodeMap[""].values=c=k(c,{width:c.width*a.axisRatio,direction:"vertical"===a.options.layoutStartingDirection?0:1,val:b.val});a.calculateChildrenAreas(b,c);a.colorAxis?a.translateColors():a.options.colorByPoint||a.setColorRecursive(a.tree);a.options.allowDrillToNode&&(d=d.pointValues,a.xAxis.setExtremes(d.x,d.x+d.width,!1),a.yAxis.setExtremes(d.y,d.y+d.height,!1),a.xAxis.setScale(),a.yAxis.setScale());a.setPointValues()},drawDataLabels:function(){var a=this,c=A(a.points,function(a){return a.node.visible}),d,b;g(c,function(c){b=a.levelMap[c.node.levelDynamic];d={style:{}};c.node.isLeaf||(d.enabled=!1);b&&b.dataLabels&&(d=k(d,b.dataLabels),a._hasPointLabels=!0);c.shapeArgs&&(d.style.width=c.shapeArgs.width,c.dataLabel&&c.dataLabel.css({width:c.shapeArgs.width+"px"}));c.dlOptions=k(d,c.options.dataLabels)});x.prototype.drawDataLabels.call(this)},alignDataLabel:function(a){p.column.prototype.alignDataLabel.apply(this,arguments);a.dataLabel&&a.dataLabel.attr({zIndex:(a.node.zIndex||0)+1})},pointAttribs:function(a,c){var d=a&&this.levelMap[a.node.levelDynamic]||{},b=this.options,f=c&&b.states[c]||{},l=a&&a.getClassName()||"";a={stroke:a&&a.borderColor||d.borderColor||f.borderColor||b.borderColor,"stroke-width":h(a&&a.borderWidth,d.borderWidth,f.borderWidth,b.borderWidth),dashstyle:a&&a.borderDashStyle||d.borderDashStyle||f.borderDashStyle||b.borderDashStyle,fill:a&&a.color||this.color};-1!==l.indexOf("highcharts-above-level")?(a.fill="none",a["stroke-width"]=0):-1!==l.indexOf("highcharts-internal-node-interactive")?(c=h(f.opacity,b.opacity),a.fill=G(a.fill).setOpacity(c).get(),a.cursor="pointer"):-1!==l.indexOf("highcharts-internal-node")?a.fill="none":c&&(a.fill=G(a.fill).brighten(f.brightness).get());return a},drawPoints:function(){var a=this,c=A(a.points,function(a){return a.node.visible});g(c,function(c){var b="level-group-"+c.node.levelDynamic;a[b]||(a[b]=a.chart.renderer.g(b).attr({zIndex:1e3-c.node.levelDynamic}).add(a.group));c.group=a[b]});p.column.prototype.drawPoints.call(this);a.options.allowDrillToNode&&g(c,function(c){c.graphic&&(c.drillId=a.options.interactByLeaf?a.drillToByLeaf(c):a.drillToByGroup(c))})},onClickDrillToNode:function(a){var c=(a=a.point)&&a.drillId;B(c)&&(a.setState(""),this.drillToNode(c))},drillToByGroup:function(a){var c=!1;1!==a.node.level-this.nodeMap[this.rootNode].level||a.node.isLeaf||(c=a.id);return c},drillToByLeaf:function(a){var c=!1;if(a.node.parent!==this.rootNode&&a.node.isLeaf){for(a=a.node;!c;){a=this.nodeMap[a.parent],a.parent===this.rootNode&&(c=a.id)}}return c},drillUp:function(){var a=this.nodeMap[this.rootNode];a&&B(a.parent)&&this.drillToNode(a.parent)},drillToNode:function(a,c){var b=this.nodeMap[a];this.idPreviousRoot=this.rootNode;this.rootNode=a;""===a?this.drillUpButton=this.drillUpButton.destroy():this.showDrillUpButton(b&&b.name||a);this.isDirty=!0;h(c,!0)&&this.chart.redraw()},showDrillUpButton:function(a){var c=this;a=a||"< Back";var b=c.options.drillUpButton,e,f;b.text&&(a=b.text);this.drillUpButton?this.drillUpButton.attr({text:a}).align():(f=(e=b.theme)&&e.states,this.drillUpButton=this.chart.renderer.button(a,null,null,function(){c.drillUp()},e,f&&f.hover,f&&f.select).attr({align:b.position.align,zIndex:7}).add().align(b.position,!1,b.relativeTo||"plotBox"))},buildKDTree:m,drawLegendSymbol:b.LegendSymbolMixin.drawRectangle,getExtremes:function(){x.prototype.getExtremes.call(this,this.colorValueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;x.prototype.getExtremes.call(this)},getExtremesFromAll:!0,bindAxes:function(){var a={endOnTick:!1,gridLineWidth:0,lineWidth:0,min:0,dataMin:0,minPadding:0,max:100,dataMax:100,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};x.prototype.bindAxes.call(this);b.extend(this.yAxis.options,a);b.extend(this.xAxis.options,a)},utils:{recursive:E,reduce:H}},{getClassName:function(){var a=b.Point.prototype.getClassName.call(this),c=this.series,d=c.options;this.node.level<=c.nodeMap[c.rootNode].level?a+=" highcharts-above-level":this.node.isLeaf||h(d.interactByLeaf,!d.allowDrillToNode)?this.node.isLeaf||(a+=" highcharts-internal-node"):a+=" highcharts-internal-node-interactive";return a},isValid:function(){return this.id||r(this.value)},setState:function(a){b.Point.prototype.setState.call(this,a);this.graphic&&this.graphic.attr({zIndex:"hover"===a?1:0})},setVisible:p.pie.prototype.pointClass.prototype.setVisible})})(D,M);(function(b,t,e){var p=b.CenteredSeriesMixin,v=b.Series,k=b.each,q=b.extend,m=p.getCenter,g=e.getColor,D=p.getStartAndEndRadians,A=b.grep,r=b.isNumber,B=b.isObject,h=b.isString,x=b.merge,F=b.pick,G=180/Math.PI,p=b.seriesType,J=e.setTreeValues,H=b.reduce,E=function(a,b){var c=a.start,d=a.end-c,e=a.val,h=a.x,u=a.y,m=a.r,g=m+a.radius;return H(b||[],function(b,f){f={x:h,y:u,innerR:m,r:g,radius:a.radius,start:c,end:c+1/e*f.val*d};b.push(f);c=f.end;return b},[])},a=function(a,b){var c=b.mapIdToNode[a.parent],d=b.series,e=d.chart,h=d.points[a.i];b=g(a,{colors:e&&e.options&&e.options.colors,colorIndex:d.colorIndex,colorByPoint:d.colorByPoint,index:b.index,levelMap:b.levelMap,parentColor:c&&c.color,parentColorIndex:c&&c.colorIndex,series:b.series,siblings:b.siblings});a.color=b.color;a.colorIndex=b.colorIndex;h&&(h.color=a.color,h.colorIndex=a.colorIndex);return a};p("sunburst","treemap",{center:["50%","50%"],dataLabels:{defer:!0,style:{textOverflow:"ellipsis"},rotationMode:"perpendicular"},rootId:void 0,levelIsConstant:!0},{drawDataLabels:b.noop,drawPoints:function(){var a=this,b=a.levelMap,e=a.shapeRoot,f=a.group,l=a.hasRendered,h=a.rootNode,u=a.idPreviousRoot,m=a.nodeMap,g=m[u],p=g&&g.shapeArgs,g=a.points,t=a.startAndEndRadians,z=a.chart,z=z&&z.options&&z.options.chart||{},A="boolean"===typeof z.animation?z.animation:!0,z=a.center,D=z[0],F=z[1],I=z[3]/2,H=a.chart.renderer,E,J=!1,L=!1;if(z=!!(A&&l&&h!==u&&a.dataLabelsGroup)){a.dataLabelsGroup.attr({opacity:0}),E=function(){J=!0;a.dataLabelsGroup&&a.dataLabelsGroup.animate({opacity:1,visibility:"visible"})}}k(g,function(c){var d,g,n=c.node,k=b[n.levelDynamic];d=c.shapeExisting||{};var w=n.shapeArgs||{},y,z=!(!n.visible||!n.shapeArgs);if(l&&A){var C={};g={end:w.end,start:w.start,innerR:w.innerR,r:w.r,x:D,y:F};z?!c.graphic&&p&&(C=h===c.id?{start:t.start,end:t.end}:p.end<=w.start?{start:t.end,end:t.end}:{start:t.start,end:t.start},C.innerR=C.r=I):c.graphic&&(u===c.id?g={innerR:I,r:I}:e&&(g=e.end<=d.start?{innerR:I,r:I,start:t.end,end:t.end}:{innerR:I,r:I,start:t.start,end:t.start}));d=C}else{g=w,d={}}var C=[w.plotX,w.plotY],v;c.node.isLeaf||(h===c.id?(v=m[h],v=v.parent):v=c.id);q(c,{shapeExisting:w,tooltipPos:C,drillId:v,name:""+(c.name||c.id||c.index),plotX:w.plotX,plotY:w.plotY,value:n.val,isNull:!z});C=c.options;v=a.options;n=B(w)?w:{};v=B(v)?v.dataLabels:{};C=B(C)?C.dataLabels:{};k=B(k)?k.dataLabels:{};k=x({rotationMode:"perpendicular",style:{width:n.radius}},v,k,C);r(k.rotation)||(n=n.end-(n.end-n.start)/2,n=n*G%180,"parallel"===k.rotationMode&&(n-=90),90<n&&(n-=180),k.rotation=n);0===k.rotation&&(k.rotation=.001);c.dlOptions=k;!L&&z&&(L=!0,y=E);c.draw({animate:g,attr:q(d,a.pointAttribs&&a.pointAttribs(c,c.selected&&"select")),onComplete:y,group:f,renderer:H,shapeType:"arc",shapeArgs:w})});z&&L?(a.hasRendered=!1,a.options.dataLabels.defer=!0,v.prototype.drawDataLabels.call(a),a.hasRendered=!0,J&&E()):v.prototype.drawDataLabels.call(a)},pointAttribs:b.seriesTypes.column.prototype.pointAttribs,setShapeArgs:function(a,b){var c=[];a=A(a.children,function(a){return a.visible});c=E(b,a);k(a,function(a,b){b=c[b];var d=b.start+(b.end-b.start)/2,e=b.innerR+(b.r-b.innerR)/2,d=0===b.innerR&&6.28<b.end-b.start?{x:b.x,y:b.y}:{x:b.x+Math.cos(d)*e,y:b.y+Math.sin(d)*e},e=a.val?a.childrenTotal>a.val?a.childrenTotal:a.val:a.childrenTotal,f=(b.end-b.start)/(2*Math.PI),h=2*Math.PI*b.innerR;this.points[a.i]&&(this.points[a.i].innerArcLength=f*h);a.shapeArgs=x(b,{plotX:d.x,plotY:d.y});a.values=x(b,{val:e});a.children.length&&this.setShapeArgs(a,a.values)},this)},translate:function(){var b=this.options,d=this.center=m.call(this),e=this.startAndEndRadians=D(b.startAngle,b.endAngle),f=d[3]/2,l=d[2]/2,g=this.rootNode=F(this.rootNode,b.rootId,""),k=this.nodeMap,p,q=k&&k[g],r,t;this.shapeRoot=q&&q.shapeArgs;v.prototype.translate.call(this);this.levelMap=H(this.options.levels||[],function(a,b){a[b.level]=b;return a},{});t=this.tree=this.getTree();k=this.nodeMap;q=k[g];p=h(q.parent)?q.parent:"";r=k[p];J(t,{before:a,idRoot:g,levelIsConstant:b.levelIsConstant,levelMap:this.levelMap,mapIdToNode:k,points:this.points,series:this});b=k[""].shapeArgs={end:e.end,r:f,radius:(l-f)/(g===p?q.height:q.height+1),start:e.start,val:r.val,x:d[0],y:d[1]};this.setShapeArgs(r,b)},animate:function(a){var b=this.chart,c=[b.plotWidth/2,b.plotHeight/2],e=b.plotLeft,g=b.plotTop,b=this.group;a?(a={translateX:c[0]+e,translateY:c[1]+g,scaleX:.001,scaleY:.001,rotation:10,opacity:.01},b.attr(a)):(a={translateX:e,translateY:g,scaleX:1,scaleY:1,rotation:0,opacity:1},b.animate(a,this.options.animation),this.animate=null)}},{draw:t,shouldDraw:function(){return!this.isNull}})})(D,O,M)})});var tilemap=createCommonjsModule(function(module){(function(g){"object"==="object"&&module.exports?module.exports=g:g(Highcharts)})(function(g){(function(d){var g=d.defined,r=d.each,x=d.noop,u=d.seriesTypes;d.colorPointMixin={isValid:function(){return null!==this.value},setVisible:function(d){var f=this,a=d?"show":"hide";r(["graphic","dataLabel"],function(b){if(f[b]){f[b][a]()}})},setState:function(f){d.Point.prototype.setState.call(this,f);this.graphic&&this.graphic.attr({zIndex:"hover"===f?1:0})}};d.colorSeriesMixin={pointArrayMap:["value"],axisTypes:["xAxis","yAxis","colorAxis"],optionalAxis:"colorAxis",trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:x,parallelArrays:["x","y","value"],colorKey:"value",pointAttribs:u.column.prototype.pointAttribs,translateColors:function(){var d=this,v=this.options.nullColor,a=this.colorAxis,b=this.colorKey;r(this.data,function(c){var e=c[b];if(e=c.options.color||(c.isNull?v:a&&void 0!==e?a.toColor(e,c):c.color||d.color)){c.color=e}})},colorAttribs:function(d){var f={};g(d.color)&&(f[this.colorProp||"fill"]=d.color);return f}}})(g);(function(d){var g=d.colorPointMixin,r=d.each,x=d.merge,u=d.noop,f=d.pick,v=d.Series,a=d.seriesType,b=d.seriesTypes;a("heatmap","scatter",{animation:!1,borderWidth:0,nullColor:"#f7f7f7",dataLabels:{formatter:function(){return this.point.value},inside:!0,verticalAlign:"middle",crop:!1,overflow:!1,padding:0},marker:null,pointRange:null,tooltip:{pointFormat:"{point.x}, {point.y}: {point.value}<br/>"},states:{normal:{animation:!0},hover:{halo:!1,brightness:.2}}},x(d.colorSeriesMixin,{pointArrayMap:["y","value"],hasPointSpecificOptions:!0,getExtremesFromAll:!0,directTouch:!0,init:function(){var c;b.scatter.prototype.init.apply(this,arguments);c=this.options;c.pointRange=f(c.pointRange,c.colsize||1);this.yAxis.axisPointRange=c.rowsize||1},translate:function(){var b=this.options,a=this.xAxis,d=this.yAxis,w=b.pointPadding||0,k=function(b,a,c){return Math.min(Math.max(a,b),c)};this.generatePoints();r(this.points,function(c){var h=(b.colsize||1)/2,e=(b.rowsize||1)/2,l=k(Math.round(a.len-a.translate(c.x-h,0,1,0,1)),-a.len,2*a.len),h=k(Math.round(a.len-a.translate(c.x+h,0,1,0,1)),-a.len,2*a.len),t=k(Math.round(d.translate(c.y-e,0,1,0,1)),-d.len,2*d.len),e=k(Math.round(d.translate(c.y+e,0,1,0,1)),-d.len,2*d.len),m=f(c.pointPadding,w);c.plotX=c.clientX=(l+h)/2;c.plotY=(t+e)/2;c.shapeType="rect";c.shapeArgs={x:Math.min(l,h)+m,y:Math.min(t,e)+m,width:Math.abs(h-l)-2*m,height:Math.abs(e-t)-2*m}});this.translateColors()},drawPoints:function(){b.column.prototype.drawPoints.call(this);r(this.points,function(b){b.graphic.attr(this.colorAttribs(b))},this)},animate:u,getBox:u,drawLegendSymbol:d.LegendSymbolMixin.drawRectangle,alignDataLabel:b.column.prototype.alignDataLabel,getExtremes:function(){v.prototype.getExtremes.call(this,this.valueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;v.prototype.getExtremes.call(this)}}),d.extend({haloPath:function(b){if(!b){return[]}var a=this.shapeArgs;return["M",a.x-b,a.y-b,"L",a.x-b,a.y+a.height+b,a.x+a.width+b,a.y+a.height+b,a.x+a.width+b,a.y-b,"Z"]}},g))})(g);(function(d){var g=d.seriesType,r=d.each,x=d.reduce,u=d.pick,f=function(a,b,c){return Math.min(Math.max(b,a),c)},v=function(a,b,c){a=a.options;return{xPad:(a.colsize||1)/-b,yPad:(a.rowsize||1)/-c}};d.tileShapeTypes={hexagon:{alignDataLabel:d.seriesTypes.scatter.prototype.alignDataLabel,getSeriesPadding:function(a){return v(a,3,2)},haloPath:function(a){if(!a){return[]}var b=this.tileEdges;return["M",b.x2-a,b.y1+a,"L",b.x3+a,b.y1+a,b.x4+1.5*a,b.y2,b.x3+a,b.y3-a,b.x2-a,b.y3-a,b.x1-1.5*a,b.y2,"Z"]},translate:function(){var a=this.options,b=this.xAxis,c=this.yAxis,d=a.pointPadding||0,y=(a.colsize||1)/3,w=(a.rowsize||1)/2,k;this.generatePoints();r(this.points,function(a){var h=f(Math.floor(b.len-b.translate(a.x-2*y,0,1,0,1)),-b.len,2*b.len),e=f(Math.floor(b.len-b.translate(a.x-y,0,1,0,1)),-b.len,2*b.len),l=f(Math.floor(b.len-b.translate(a.x+y,0,1,0,1)),-b.len,2*b.len),t=f(Math.floor(b.len-b.translate(a.x+2*y,0,1,0,1)),-b.len,2*b.len),m=f(Math.floor(c.translate(a.y-w,0,1,0,1)),-c.len,2*c.len),n=f(Math.floor(c.translate(a.y,0,1,0,1)),-c.len,2*c.len),p=f(Math.floor(c.translate(a.y+w,0,1,0,1)),-c.len,2*c.len),q=u(a.pointPadding,d),g=q*Math.abs(e-h)/Math.abs(p-n),g=b.reversed?-g:g,r=b.reversed?-q:q,q=c.reversed?-q:q;a.x%2&&(k=k||Math.round(Math.abs(p-m)/2)*(c.reversed?-1:1),m+=k,n+=k,p+=k);a.plotX=a.clientX=(e+l)/2;a.plotY=n;h+=g+r;e+=r;l-=r;t-=g+r;m-=q;p+=q;a.tileEdges={x1:h,x2:e,x3:l,x4:t,y1:m,y2:n,y3:p};a.shapeType="path";a.shapeArgs={d:["M",e,m,"L",l,m,t,n,l,p,e,p,h,n,"Z"]}});this.translateColors()}},diamond:{alignDataLabel:d.seriesTypes.scatter.prototype.alignDataLabel,getSeriesPadding:function(a){return v(a,2,2)},haloPath:function(a){if(!a){return[]}var b=this.tileEdges;return["M",b.x2,b.y1+a,"L",b.x3+a,b.y2,b.x2,b.y3-a,b.x1-a,b.y2,"Z"]},translate:function(){var a=this.options,b=this.xAxis,c=this.yAxis,d=a.pointPadding||0,g=a.colsize||1,w=(a.rowsize||1)/2,k;this.generatePoints();r(this.points,function(a){var e=f(Math.round(b.len-b.translate(a.x-g,0,1,0,0)),-b.len,2*b.len),h=f(Math.round(b.len-b.translate(a.x,0,1,0,0)),-b.len,2*b.len),l=f(Math.round(b.len-b.translate(a.x+g,0,1,0,0)),-b.len,2*b.len),t=f(Math.round(c.translate(a.y-w,0,1,0,0)),-c.len,2*c.len),m=f(Math.round(c.translate(a.y,0,1,0,0)),-c.len,2*c.len),n=f(Math.round(c.translate(a.y+w,0,1,0,0)),-c.len,2*c.len),p=u(a.pointPadding,d),q=p*Math.abs(h-e)/Math.abs(n-m),q=b.reversed?-q:q,p=c.reversed?-p:p;a.x%2&&(k=Math.abs(n-t)/2*(c.reversed?-1:1),t+=k,m+=k,n+=k);a.plotX=a.clientX=h;a.plotY=m;e+=q;l-=q;t-=p;n+=p;a.tileEdges={x1:e,x2:h,x3:l,y1:t,y2:m,y3:n};a.shapeType="path";a.shapeArgs={d:["M",h,t,"L",l,m,h,n,e,m,"Z"]}});this.translateColors()}},circle:{alignDataLabel:d.seriesTypes.scatter.prototype.alignDataLabel,getSeriesPadding:function(a){return v(a,2,2)},haloPath:function(a){return d.seriesTypes.scatter.prototype.pointClass.prototype.haloPath.call(this,a+(a&&this.radius))},translate:function(){var a=this.options,b=this.xAxis,c=this.yAxis,d=a.pointPadding||0,g=(a.rowsize||1)/2,w=a.colsize||1,k,h,v,u,l=!1;this.generatePoints();r(this.points,function(a){var e=f(Math.round(b.len-b.translate(a.x,0,1,0,0)),-b.len,2*b.len),n=f(Math.round(c.translate(a.y,0,1,0,0)),-c.len,2*c.len),p=d,q=!1;void 0!==a.pointPadding&&(p=a.pointPadding,l=q=!0);if(!u||l){k=Math.abs(f(Math.floor(b.len-b.translate(a.x+w,0,1,0,0)),-b.len,2*b.len)-e),h=Math.abs(f(Math.floor(c.translate(a.y+g,0,1,0,0)),-c.len,2*c.len)-n),v=Math.floor(Math.sqrt(k*k+h*h)/2),u=Math.min(k,v,h)-p,l&&!q&&(l=!1)}a.x%2&&(n+=h*(c.reversed?-1:1));a.plotX=a.clientX=e;a.plotY=n;a.radius=u;a.shapeType="circle";a.shapeArgs={x:e,y:n,r:u}});this.translateColors()}},square:{alignDataLabel:d.seriesTypes.heatmap.prototype.alignDataLabel,translate:d.seriesTypes.heatmap.prototype.translate,getSeriesPadding:function(){},haloPath:d.seriesTypes.heatmap.prototype.pointClass.prototype.haloPath}};d.wrap(d.Axis.prototype,"setAxisTranslation",function(a){a.apply(this,Array.prototype.slice.call(arguments,1));var b=this,c=x(d.map(b.series,function(a){return a.getSeriesPixelPadding&&a.getSeriesPixelPadding(b)}),function(a,b){return(a&&a.padding)>(b&&b.padding)?a:b})||{padding:0,axisLengthFactor:1},e=Math.round(c.padding*c.axisLengthFactor);c.padding&&(b.len-=e,a.apply(b,Array.prototype.slice.call(arguments,1)),b.minPixelPadding+=c.padding,b.len+=e)});g("tilemap","heatmap",{states:{hover:{halo:{enabled:!0,size:2,opacity:.5,attributes:{zIndex:3}}}},pointPadding:2,tileShape:"hexagon"},{setOptions:function(){var a=d.seriesTypes.heatmap.prototype.setOptions.apply(this,Array.prototype.slice.call(arguments));this.tileShape=d.tileShapeTypes[a.tileShape];return a},alignDataLabel:function(){return this.tileShape.alignDataLabel.apply(this,Array.prototype.slice.call(arguments))},getSeriesPixelPadding:function(a){var b=a.isXAxis,c=this.tileShape.getSeriesPadding(this),d;if(!c){return{padding:0,axisLengthFactor:1}}d=Math.round(a.translate(b?2*c.xPad:c.yPad,0,1,0,1));a=Math.round(a.translate(b?c.xPad:0,0,1,0,1));return{padding:Math.abs(d-a)||0,axisLengthFactor:b?2:1.1}},translate:function(){return this.tileShape.translate.apply(this,Array.prototype.slice.call(arguments))}},d.extend({haloPath:function(){return this.series.tileShape.haloPath.apply(this,Array.prototype.slice.call(arguments))}},d.colorPointMixin))})(g)})});var treemap=createCommonjsModule(function(module){(function(u){"object"==="object"&&module.exports?module.exports=u:u(Highcharts)})(function(u){var I=function(d){var u=d.each,x=d.extend,m=d.pick;return{getColor:function(r,p){var E=p.index,l=p.levelMap,g=p.parentColor,u=p.parentColorIndex,w=p.series,q=p.colors,x=p.siblings,f=w.points,t,B,y,C;if(r){f=f[r.i];r=l[r.levelDynamic]||{};if(t=f&&("boolean"===typeof r.colorByPoint?r.colorByPoint:!!w.options.colorByPoint)){y=f.index%(q?q.length:w.chart.options.chart.colorCount),B=q&&q[y]}q=f&&f.options.color;t=r&&r.color;if(l=g){l=(l=r&&r.colorVariation)&&"brightness"===l.key?d.color(g).brighten(E/x*l.to).get():g}t=m(q,t,B,l,w.color);C=m(f&&f.options.colorIndex,r&&r.colorIndex,y,u,p.colorIndex)}return{color:t,colorIndex:C}},setTreeValues:function p(d,l){var g=l.before,z=l.idRoot,w=l.mapIdToNode[z],q=l.points[d.i],A=q&&q.options||{},f=0,t=[];x(d,{levelDynamic:d.level-(("boolean"===typeof l.levelIsConstant?l.levelIsConstant:1)?0:w.level),name:m(q&&q.name,""),visible:z===d.id||("boolean"===typeof l.visible?l.visible:!1)});"function"===typeof g&&(d=g(d,l));u(d.children,function(g,m){var q=x({},l);x(q,{index:m,siblings:d.children.length,visible:d.visible});g=p(g,q);t.push(g);g.visible&&(f+=g.val)});d.visible=0<f||d.visible;g=m(A.value,f);x(d,{children:t,childrenTotal:f,isLeaf:d.visible&&!f,val:g});return d}}}(u);(function(d,u){var x=d.seriesType,m=d.seriesTypes,r=d.map,p=d.merge,E=d.extend,l=d.noop,g=d.each,z=u.getColor,w=d.grep,q=d.isNumber,A=d.isString,f=d.pick,t=d.Series,B=d.stableSort,y=d.Color,C=function(a,b,c){c=c||this;d.objectEach(a,function(k,e){b.call(c,k,e,a)})},F=d.reduce,D=function(a,b,c){c=c||this;a=b.call(c,a);!1!==a&&D(a,b,c)};x("treemap","scatter",{showInLegend:!1,marker:!1,dataLabels:{enabled:!0,defer:!1,verticalAlign:"middle",formatter:function(){return this.point.name||this.point.id},inside:!0},tooltip:{headerFormat:"",pointFormat:"<b>{point.name}</b>: {point.value}<br/>"},ignoreHiddenPoint:!0,layoutAlgorithm:"sliceAndDice",layoutStartingDirection:"vertical",alternateStartingDirection:!1,levelIsConstant:!0,drillUpButton:{position:{align:"right",x:-10,y:10}},borderColor:"#e6e6e6",borderWidth:1,opacity:.15,states:{hover:{borderColor:"#999999",brightness:m.heatmap?0:.1,halo:!1,opacity:.75,shadow:!1}}},{pointArrayMap:["value"],axisTypes:m.heatmap?["xAxis","yAxis","colorAxis"]:["xAxis","yAxis"],directTouch:!0,optionalAxis:"colorAxis",getSymbol:l,parallelArrays:["x","y","value","colorValue"],colorKey:"colorValue",translateColors:m.heatmap&&m.heatmap.prototype.translateColors,colorAttribs:m.heatmap&&m.heatmap.prototype.colorAttribs,trackerGroups:["group","dataLabelsGroup"],getListOfParents:function(a,b){a=F(a||[],function(a,b,e){b=f(b.parent,"");void 0===a[b]&&(a[b]=[]);a[b].push(e);return a},{});C(a,function(a,k,e){""!==k&&-1===d.inArray(k,b)&&(g(a,function(a){e[""].push(a)}),delete e[k])});return a},getTree:function(){var a=r(this.data,function(a){return a.id}),a=this.getListOfParents(this.data,a);this.nodeMap=[];return this.buildNode("",-1,0,a,null)},init:function(a,b){t.prototype.init.call(this,a,b);this.options.allowDrillToNode&&d.addEvent(this,"click",this.onClickDrillToNode)},buildNode:function(a,b,c,k,e){var n=this,d=[],h=n.points[b],G=0,H;g(k[a]||[],function(b){H=n.buildNode(n.points[b].id,b,c+1,k,a);G=Math.max(H.height+1,G);d.push(H)});b={id:a,i:b,children:d,height:G,level:c,parent:e,visible:!1};n.nodeMap[b.id]=b;h&&(h.node=b);return b},setTreeValues:function(a){var b=this,c=b.options,k=b.nodeMap[b.rootNode],c="boolean"===typeof c.levelIsConstant?c.levelIsConstant:!0,e=0,n=[],d,h=b.points[a.i];g(a.children,function(a){a=b.setTreeValues(a);n.push(a);a.ignore||(e+=a.val)});B(n,function(a,b){return a.sortIndex-b.sortIndex});d=f(h&&h.options.value,e);h&&(h.value=d);E(a,{children:n,childrenTotal:e,ignore:!(f(h&&h.visible,!0)&&0<d),isLeaf:a.visible&&!e,levelDynamic:a.level-(c?0:k.level),name:f(h&&h.name,""),sortIndex:f(h&&h.sortIndex,-d),val:d});return a},calculateChildrenAreas:function(a,b){var c=this,k=c.options,e=this.levelMap[a.levelDynamic+1],n=f(c[e&&e.layoutAlgorithm]&&e.layoutAlgorithm,k.layoutAlgorithm),d=k.alternateStartingDirection,h=[];a=w(a.children,function(a){return!a.ignore});e&&e.layoutStartingDirection&&(b.direction="vertical"===e.layoutStartingDirection?0:1);h=c[n](b,a);g(a,function(a,e){e=h[e];a.values=p(e,{val:a.childrenTotal,direction:d?1-b.direction:b.direction});a.pointValues=p(e,{x:e.x/c.axisRatio,width:e.width/c.axisRatio});a.children.length&&c.calculateChildrenAreas(a,a.values)})},setPointValues:function(){var a=this,b=a.xAxis,c=a.yAxis;g(a.points,function(k){var e=k.node,n=e.pointValues,d,h,g;g=(a.pointAttribs(k)["stroke-width"]||0)%2/2;n&&e.visible?(e=Math.round(b.translate(n.x,0,0,0,1))-g,d=Math.round(b.translate(n.x+n.width,0,0,0,1))-g,h=Math.round(c.translate(n.y,0,0,0,1))-g,n=Math.round(c.translate(n.y+n.height,0,0,0,1))-g,k.shapeType="rect",k.shapeArgs={x:Math.min(e,d),y:Math.min(h,n),width:Math.abs(d-e),height:Math.abs(n-h)},k.plotX=k.shapeArgs.x+k.shapeArgs.width/2,k.plotY=k.shapeArgs.y+k.shapeArgs.height/2):(delete k.plotX,delete k.plotY)})},setColorRecursive:function(a,b,c,k,e){var d=this,f=d&&d.chart,f=f&&f.options&&f.options.colors,h;if(a){h=z(a,{colors:f,index:k,levelMap:d.levelMap,parentColor:b,parentColorIndex:c,series:d,siblings:e});if(b=d.points[a.i]){b.color=h.color,b.colorIndex=h.colorIndex}g(a.children||[],function(b,c){d.setColorRecursive(b,h.color,h.colorIndex,c,a.children.length)})}},algorithmGroup:function(a,b,c,d){this.height=a;this.width=b;this.plot=d;this.startDirection=this.direction=c;this.lH=this.nH=this.lW=this.nW=this.total=0;this.elArr=[];this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(a,b){return Math.max(a/b,b/a)}};this.addElement=function(a){this.lP.total=this.elArr[this.elArr.length-1];this.total+=a;0===this.direction?(this.lW=this.nW,this.lP.lH=this.lP.total/this.lW,this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH),this.nW=this.total/this.height,this.lP.nH=this.lP.total/this.nW,this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)):(this.lH=this.nH,this.lP.lW=this.lP.total/this.lH,this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH),this.nH=this.total/this.width,this.lP.nW=this.lP.total/this.nH,this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH));this.elArr.push(a)};this.reset=function(){this.lW=this.nW=0;this.elArr=[];this.total=0}},algorithmCalcPoints:function(a,b,c,d){var e,k,f,h,l=c.lW,m=c.lH,v=c.plot,p,q=0,t=c.elArr.length-1;b?(l=c.nW,m=c.nH):p=c.elArr[c.elArr.length-1];g(c.elArr,function(a){if(b||q<t){0===c.direction?(e=v.x,k=v.y,f=l,h=a/f):(e=v.x,k=v.y,h=m,f=a/h),d.push({x:e,y:k,width:f,height:h}),0===c.direction?v.y+=h:v.x+=f}q+=1});c.reset();0===c.direction?c.width-=l:c.height-=m;v.y=v.parent.y+(v.parent.height-c.height);v.x=v.parent.x+(v.parent.width-c.width);a&&(c.direction=1-c.direction);b||c.addElement(p)},algorithmLowAspectRatio:function(a,b,c){var d=[],e=this,n,f={x:b.x,y:b.y,parent:b},h=0,l=c.length-1,m=new this.algorithmGroup(b.height,b.width,b.direction,f);g(c,function(c){n=c.val/b.val*b.height*b.width;m.addElement(n);m.lP.nR>m.lP.lR&&e.algorithmCalcPoints(a,!1,m,d,f);h===l&&e.algorithmCalcPoints(a,!0,m,d,f);h+=1});return d},algorithmFill:function(a,b,c){var d=[],e,f=b.direction,l=b.x,h=b.y,m=b.width,p=b.height,q,t,r,u;g(c,function(c){e=c.val/b.val*b.height*b.width;q=l;t=h;0===f?(u=p,r=e/u,m-=r,l+=r):(r=m,u=e/r,p-=u,h+=u);d.push({x:q,y:t,width:r,height:u});a&&(f=1-f)});return d},strip:function(a,b){return this.algorithmLowAspectRatio(!1,a,b)},squarified:function(a,b){return this.algorithmLowAspectRatio(!0,a,b)},sliceAndDice:function(a,b){return this.algorithmFill(!0,a,b)},stripes:function(a,b){return this.algorithmFill(!1,a,b)},translate:function(){var a=this,b=a.rootNode=f(a.rootNode,a.options.rootId,""),c,d;t.prototype.translate.call(a);a.levelMap=F(a.options.levels||[],function(a,b){a[b.level]=b;return a},{});d=a.tree=a.getTree();c=a.nodeMap[b];""===b||c&&c.children.length||(a.drillToNode("",!1),b=a.rootNode,c=a.nodeMap[b]);D(a.nodeMap[a.rootNode],function(b){var c=!1,d=b.parent;b.visible=!0;if(d||""===d){c=a.nodeMap[d]}return c});D(a.nodeMap[a.rootNode].children,function(a){var b=!1;g(a,function(a){a.visible=!0;a.children.length&&(b=(b||[]).concat(a.children))});return b});a.setTreeValues(d);a.axisRatio=a.xAxis.len/a.yAxis.len;a.nodeMap[""].pointValues=b={x:0,y:0,width:100,height:100};a.nodeMap[""].values=b=p(b,{width:b.width*a.axisRatio,direction:"vertical"===a.options.layoutStartingDirection?0:1,val:d.val});a.calculateChildrenAreas(d,b);a.colorAxis?a.translateColors():a.options.colorByPoint||a.setColorRecursive(a.tree);a.options.allowDrillToNode&&(c=c.pointValues,a.xAxis.setExtremes(c.x,c.x+c.width,!1),a.yAxis.setExtremes(c.y,c.y+c.height,!1),a.xAxis.setScale(),a.yAxis.setScale());a.setPointValues()},drawDataLabels:function(){var a=this,b=w(a.points,function(a){return a.node.visible}),c,d;g(b,function(b){d=a.levelMap[b.node.levelDynamic];c={style:{}};b.node.isLeaf||(c.enabled=!1);d&&d.dataLabels&&(c=p(c,d.dataLabels),a._hasPointLabels=!0);b.shapeArgs&&(c.style.width=b.shapeArgs.width,b.dataLabel&&b.dataLabel.css({width:b.shapeArgs.width+"px"}));b.dlOptions=p(c,b.options.dataLabels)});t.prototype.drawDataLabels.call(this)},alignDataLabel:function(a){m.column.prototype.alignDataLabel.apply(this,arguments);a.dataLabel&&a.dataLabel.attr({zIndex:(a.node.zIndex||0)+1})},pointAttribs:function(a,b){var c=a&&this.levelMap[a.node.levelDynamic]||{},d=this.options,e=b&&d.states[b]||{},g=a&&a.getClassName()||"";a={stroke:a&&a.borderColor||c.borderColor||e.borderColor||d.borderColor,"stroke-width":f(a&&a.borderWidth,c.borderWidth,e.borderWidth,d.borderWidth),dashstyle:a&&a.borderDashStyle||c.borderDashStyle||e.borderDashStyle||d.borderDashStyle,fill:a&&a.color||this.color};-1!==g.indexOf("highcharts-above-level")?(a.fill="none",a["stroke-width"]=0):-1!==g.indexOf("highcharts-internal-node-interactive")?(b=f(e.opacity,d.opacity),a.fill=y(a.fill).setOpacity(b).get(),a.cursor="pointer"):-1!==g.indexOf("highcharts-internal-node")?a.fill="none":b&&(a.fill=y(a.fill).brighten(e.brightness).get());return a},drawPoints:function(){var a=this,b=w(a.points,function(a){return a.node.visible});g(b,function(b){var c="level-group-"+b.node.levelDynamic;a[c]||(a[c]=a.chart.renderer.g(c).attr({zIndex:1e3-b.node.levelDynamic}).add(a.group));b.group=a[c]});m.column.prototype.drawPoints.call(this);a.options.allowDrillToNode&&g(b,function(b){b.graphic&&(b.drillId=a.options.interactByLeaf?a.drillToByLeaf(b):a.drillToByGroup(b))})},onClickDrillToNode:function(a){var b=(a=a.point)&&a.drillId;A(b)&&(a.setState(""),this.drillToNode(b))},drillToByGroup:function(a){var b=!1;1!==a.node.level-this.nodeMap[this.rootNode].level||a.node.isLeaf||(b=a.id);return b},drillToByLeaf:function(a){var b=!1;if(a.node.parent!==this.rootNode&&a.node.isLeaf){for(a=a.node;!b;){a=this.nodeMap[a.parent],a.parent===this.rootNode&&(b=a.id)}}return b},drillUp:function(){var a=this.nodeMap[this.rootNode];a&&A(a.parent)&&this.drillToNode(a.parent)},drillToNode:function(a,b){var c=this.nodeMap[a];this.idPreviousRoot=this.rootNode;this.rootNode=a;""===a?this.drillUpButton=this.drillUpButton.destroy():this.showDrillUpButton(c&&c.name||a);this.isDirty=!0;f(b,!0)&&this.chart.redraw()},showDrillUpButton:function(a){var b=this;a=a||"< Back";var c=b.options.drillUpButton,d,e;c.text&&(a=c.text);this.drillUpButton?this.drillUpButton.attr({text:a}).align():(e=(d=c.theme)&&d.states,this.drillUpButton=this.chart.renderer.button(a,null,null,function(){b.drillUp()},d,e&&e.hover,e&&e.select).attr({align:c.position.align,zIndex:7}).add().align(c.position,!1,c.relativeTo||"plotBox"))},buildKDTree:l,drawLegendSymbol:d.LegendSymbolMixin.drawRectangle,getExtremes:function(){t.prototype.getExtremes.call(this,this.colorValueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;t.prototype.getExtremes.call(this)},getExtremesFromAll:!0,bindAxes:function(){var a={endOnTick:!1,gridLineWidth:0,lineWidth:0,min:0,dataMin:0,minPadding:0,max:100,dataMax:100,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};t.prototype.bindAxes.call(this);d.extend(this.yAxis.options,a);d.extend(this.xAxis.options,a)},utils:{recursive:D,reduce:F}},{getClassName:function(){var a=d.Point.prototype.getClassName.call(this),b=this.series,c=b.options;this.node.level<=b.nodeMap[b.rootNode].level?a+=" highcharts-above-level":this.node.isLeaf||f(c.interactByLeaf,!c.allowDrillToNode)?this.node.isLeaf||(a+=" highcharts-internal-node"):a+=" highcharts-internal-node-interactive";return a},isValid:function(){return this.id||q(this.value)},setState:function(a){d.Point.prototype.setState.call(this,a);this.graphic&&this.graphic.attr({zIndex:"hover"===a?1:0})},setVisible:m.pie.prototype.pointClass.prototype.setVisible})})(u,I)})});var variablePie=createCommonjsModule(function(module){(function(g){"object"==="object"&&module.exports?module.exports=g:g(Highcharts)})(function(g){(function(f){var g=f.pick,t=f.each,q=f.grep,u=f.arrayMin,w=f.arrayMax,x=f.seriesType,y=f.seriesTypes.pie.prototype;x("variablepie","pie",{minPointSize:"10%",maxPointSize:"100%",zMin:void 0,zMax:void 0,sizeBy:"area",tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}<br/>Value: {point.y}<br/>Size: {point.z}<br/>'}},{pointArrayMap:["y","z"],parallelArrays:["x","y","z"],redraw:function(){this.center=null;y.redraw.call(this,arguments)},zValEval:function(a){return"number"!==typeof a||isNaN(a)?null:!0},calculateExtremes:function(){var a=this.chart,k=this.options,e;e=this.zData;var z=Math.min(a.plotWidth,a.plotHeight)-2*(k.slicedOffset||0),h={},a=this.center||this.getCenter();t(["minPointSize","maxPointSize"],function(a){var b=k[a],c=/%$/.test(b),b=parseInt(b,10);h[a]=c?z*b/100:2*b});this.minPxSize=a[3]+h.minPointSize;this.maxPxSize=Math.max(Math.min(a[2],h.maxPointSize),a[3]+h.minPointSize);e.length&&(a=g(k.zMin,u(q(e,this.zValEval))),e=g(k.zMax,w(q(e,this.zValEval))),this.getRadii(a,e,this.minPxSize,this.maxPxSize))},getRadii:function(a,k,e,g){var h=0,b,l=this.zData,c=l.length,n=[],f="radius"!==this.options.sizeBy,m=k-a;for(h;h<c;h++){b=this.zValEval(l[h])?l[h]:a,b<=a?b=e/2:b>=k?b=g/2:(b=0<m?(b-a)/m:.5,f&&(b=Math.sqrt(b)),b=Math.ceil(e+b*(g-e))/2),n.push(b)}this.radii=n},translate:function(a){this.generatePoints();var k=0,e=this.options,f=e.slicedOffset,h=f+(e.borderWidth||0),b,l,c,n=e.startAngle||0,r=Math.PI/180*(n-90),m=Math.PI/180*(g(e.endAngle,n+360)-90),n=m-r,q=this.points,v,t=e.dataLabels.distance,e=e.ignoreHiddenPoint,u=q.length,d,p;this.startAngleRad=r;this.endAngleRad=m;this.calculateExtremes();a||(this.center=a=this.getCenter());this.getX=function(b,e,d){var f=d.series.radii[d.index];c=Math.asin(Math.min((b-a[1])/(f+d.labelDistance),1));return a[0]+(e?-1:1)*Math.cos(c)*(f+d.labelDistance)};for(m=0;m<u;m++){d=q[m];p=this.radii[m];d.labelDistance=g(d.options.dataLabels&&d.options.dataLabels.distance,t);this.maxLabelDistance=Math.max(this.maxLabelDistance||0,d.labelDistance);l=r+k*n;if(!e||d.visible){k+=d.percentage/100}b=r+k*n;d.shapeType="arc";d.shapeArgs={x:a[0],y:a[1],r:p,innerR:a[3]/2,start:Math.round(1e3*l)/1e3,end:Math.round(1e3*b)/1e3};c=(b+l)/2;c>1.5*Math.PI?c-=2*Math.PI:c<-Math.PI/2&&(c+=2*Math.PI);d.slicedTranslation={translateX:Math.round(Math.cos(c)*f),translateY:Math.round(Math.sin(c)*f)};b=Math.cos(c)*a[2]/2;v=Math.sin(c)*a[2]/2;l=Math.cos(c)*p;p*=Math.sin(c);d.tooltipPos=[a[0]+.7*b,a[1]+.7*v];d.half=c<-Math.PI/2||c>Math.PI/2?1:0;d.angle=c;b=Math.min(h,d.labelDistance/5);d.labelPos=[a[0]+l+Math.cos(c)*d.labelDistance,a[1]+p+Math.sin(c)*d.labelDistance,a[0]+l+Math.cos(c)*b,a[1]+p+Math.sin(c)*b,a[0]+l,a[1]+p,0>d.labelDistance?"center":d.half?"right":"left",c]}}})})(g)})});var variwide=createCommonjsModule(function(module){(function(d){"object"==="object"&&module.exports?module.exports=d:d(Highcharts)})(function(d){(function(b){var d=b.seriesType,l=b.seriesTypes,k=b.each,m=b.pick;d("variwide","column",{pointPadding:0,groupPadding:0},{pointArrayMap:["y","z"],parallelArrays:["x","y","z"],processData:function(){var a=this;this.totalZ=0;this.relZ=[];l.column.prototype.processData.call(this);k(this.zData,function(g,c){a.relZ[c]=a.totalZ;a.totalZ+=g});this.xAxis.categories&&(this.xAxis.variwide=!0)},postTranslate:function(a,g){var c=this.relZ,h=this.xAxis.len,e=this.totalZ,f=a/c.length*h,b=(a+1)/c.length*h,d=m(c[a],e)/e*h;a=m(c[a+1],e)/e*h;return d+(g-f)*(a-d)/(b-f)},translate:function(){var a=this.options.crisp;this.options.crisp=!1;l.column.prototype.translate.call(this);this.options.crisp=a;var b=this.chart.inverted,c=this.borderWidth%2/2;k(this.points,function(a,e){var f=this.postTranslate(e,a.shapeArgs.x),d=this.postTranslate(e,a.shapeArgs.x+a.shapeArgs.width);this.options.crisp&&(f=Math.round(f)-c,d=Math.round(d)-c);a.shapeArgs.x=f;a.shapeArgs.width=d-f;a.tooltipPos[b?1:0]=this.postTranslate(e,a.tooltipPos[b?1:0])},this)}},{isValid:function(){return b.isNumber(this.y,!0)&&b.isNumber(this.z,!0)}});b.Tick.prototype.postTranslate=function(a,b,c){a[b]=this.axis.pos+this.axis.series[0].postTranslate(c,a[b]-this.axis.pos)};b.wrap(b.Tick.prototype,"getPosition",function(a,b,c){var d=this.axis,e=a.apply(this,Array.prototype.slice.call(arguments,1)),f=b?"x":"y";d.categories&&d.variwide&&(this[f+"Orig"]=e[f],this.postTranslate(e,f,c));return e});b.wrap(b.Tick.prototype,"getLabelPosition",function(a,b,d,h,e,f,l,k){var c=Array.prototype.slice.call(arguments,1),g=e?"x":"y";this.axis.variwide&&"number"===typeof this[g+"Orig"]&&(c[e?0:1]=this[g+"Orig"]);c=a.apply(this,c);this.axis.variwide&&this.axis.categories&&this.postTranslate(c,g,k);return c})})(d)})});var vector=createCommonjsModule(function(module){(function(d){"object"==="object"&&module.exports?module.exports=d:d(Highcharts)})(function(d){(function(b){var d=b.each,e=b.seriesType;e("vector","scatter",{lineWidth:2,marker:null,rotationOrigin:"center",states:{hover:{lineWidthPlus:1}},tooltip:{pointFormat:"<b>[{point.x}, {point.y}]</b><br/>Length: <b>{point.length}</b><br/>Direction: <b>{point.direction}¬∞</b><br/>"},vectorLength:20},{pointArrayMap:["y","length","direction"],parallelArrays:["x","y","length","direction"],pointAttribs:function(a,c){a=this.options;var b=this.color,d=this.options.lineWidth;c&&(b=a.states[c].color||b,d=(a.states[c].lineWidth||d)+(a.states[c].lineWidthPlus||0));return{stroke:b,"stroke-width":d}},markerAttribs:b.noop,getSymbol:b.noop,arrow:function(a){var c={start:10,center:0,end:-10}[this.options.rotationOrigin]||0;a=a.length/this.lengthMax*this.options.vectorLength/20;return["M",0,7*a+c,"L",-1.5*a,7*a+c,0,10*a+c,1.5*a,7*a+c,0,7*a+c,0,-10*a+c]},translate:function(){b.Series.prototype.translate.call(this);this.lengthMax=b.arrayMax(this.lengthData)},drawPoints:function(){d(this.points,function(a){var c=a.plotX,b=a.plotY;a.graphic||(a.graphic=this.chart.renderer.path().add(this.markerGroup));a.graphic.attr({d:this.arrow(a),translateX:c,translateY:b,rotation:a.direction}).attr(this.pointAttribs(a))},this)},drawGraph:b.noop,animate:function(a){a?this.markerGroup.attr({opacity:.01}):(this.markerGroup.animate({opacity:1},b.animObject(this.options.animation)),this.animate=null)}})})(d)})});var windbarb=createCommonjsModule(function(module){(function(g){"object"==="object"&&module.exports?module.exports=g:g(Highcharts)})(function(g){var x=function(f){var g=f.each,n=f.seriesTypes,r=f.stableSort;return{translate:function(){n.column.prototype.translate.apply(this);var c=this.options,e=this.chart,d=this.points,a=d.length-1,b,f,p=c.onSeries;b=p&&e.get(p);var c=c.onKey||"y",p=b&&b.options.step,l=b&&b.points,k=l&&l.length,m=this.xAxis,w=this.yAxis,t=m.getExtremes(),u=0,h,v,q;if(b&&b.visible&&k){for(u=(b.pointXOffset||0)+(b.barW||0)/2,b=b.currentDataGrouping,v=l[k-1].x+(b?b.totalRange:0),r(d,function(a,b){return a.x-b.x}),c="plot"+c[0].toUpperCase()+c.substr(1);k--&&d[a]&&!(b=d[a],h=l[k],h.x<=b.x&&void 0!==h[c]&&(b.x<=v&&(b.plotY=h[c],h.x<b.x&&!p&&(q=l[k+1])&&void 0!==q[c]&&(b.plotY+=(b.x-h.x)/(q.x-h.x)*(q[c]-h[c]))),a--,k++,0>a));){}}g(d,function(a,b){var c;void 0===a.plotY&&(a.x>=t.min&&a.x<=t.max?a.plotY=e.chartHeight-m.bottom-(m.opposite?m.height:0)+m.offset-w.top:a.shapeArgs={});a.plotX+=u;(f=d[b-1])&&f.plotX===a.plotX&&(void 0===f.stackIndex&&(f.stackIndex=0),c=f.stackIndex+1);a.stackIndex=c})}}}(g);(function(f,g){var n=f.each,r=f.seriesType;r("windbarb","column",{lineWidth:2,onSeries:null,states:{hover:{lineWidthPlus:0}},tooltip:{pointFormat:"<b>{series.name}</b>: {point.value} ({point.beaufort})<br/>"},vectorLength:20,yOffset:-20},{pointArrayMap:["value","direction"],parallelArrays:["x","value","direction"],beaufortName:"Calm;Light air;Light breeze;Gentle breeze;Moderate breeze;Fresh breeze;Strong breeze;Near gale;Gale;Strong gale;Storm;Violent storm;Hurricane".split(";"),beaufortFloor:[0,.3,1.6,3.4,5.5,8,10.8,13.9,17.2,20.8,24.5,28.5,32.7],trackerGroups:["markerGroup"],pointAttribs:function(c,e){c=this.options;var d=this.color,a=this.options.lineWidth;e&&(d=c.states[e].color||d,a=(c.states[e].lineWidth||a)+(c.states[e].lineWidthPlus||0));return{stroke:d,"stroke-width":a}},markerAttribs:function(){},windArrow:function(c){var e=1.943844*c.value,d,a=this.options.vectorLength/20,b=-10;if(c.isNull){return[]}if(0===c.beaufortLevel){return this.chart.renderer.symbols.circle(-10*a,-10*a,20*a,20*a)}c=["M",0,7*a,"L",-1.5*a,7*a,0,10*a,1.5*a,7*a,0,7*a,0,-10*a];d=(e-e%50)/50;if(0<d){for(;d--;){c.push(-10===b?"L":"M",0,b*a,"L",5*a,b*a+2,"L",0,b*a+4),e-=50,b+=7}}d=(e-e%10)/10;if(0<d){for(;d--;){c.push(-10===b?"L":"M",0,b*a,"L",7*a,b*a),e-=10,b+=3}}d=(e-e%5)/5;if(0<d){for(;d--;){c.push(-10===b?"L":"M",0,b*a,"L",4*a,b*a),e-=5,b+=3}}return c},translate:function(){var c=this.beaufortFloor,e=this.beaufortName;g.translate.call(this);n(this.points,function(d){for(var a=0;a<c.length&&!(c[a]>d.value);a++){}d.beaufortLevel=a-1;d.beaufort=e[a-1]})},drawPoints:function(){var c=this.chart,e=this.yAxis;n(this.points,function(d){var a=d.plotX,b=d.plotY;d.graphic||(d.graphic=this.chart.renderer.path().add(this.markerGroup));d.graphic.attr({d:this.windArrow(d),translateX:a,translateY:b+this.options.yOffset,rotation:d.direction}).attr(this.pointAttribs(d));d.tooltipPos=c.inverted?[e.len+e.pos-c.plotLeft-b,this.xAxis.len-a]:[a,b+e.pos-c.plotTop+this.options.yOffset-this.options.vectorLength/2]},this)},animate:function(c){c?this.markerGroup.attr({opacity:.01}):(this.markerGroup.animate({opacity:1},f.animObject(this.options.animation)),this.animate=null)}},{isValid:function(){return f.isNumber(this.value)&&0<=this.value}})})(g,x)})});var wordcloud=createCommonjsModule(function(module){(function(m){"object"==="object"&&module.exports?module.exports=m:m(Highcharts)})(function(m){var w=function(){return function(d){var n=this,k=n.graphic,p=d.animate,m=d.attr,q=d.onComplete,z=d.css,r=d.group,v=d.renderer,D=d.shapeArgs;d=d.shapeType;n.shouldDraw()?(k||(n.graphic=k=v[d](D).add(r)),k.css(z).attr(m).animate(p,void 0,q)):k&&k.animate(p,void 0,function(){n.graphic=k=k.destroy();"function"===typeof q&&q()});k&&k.addClass(n.getClassName(),!0)}}();(function(d,n){var k=d.each,p=d.extend,m=d.isArray,q=d.isNumber,z=d.isObject,r=d.Series,v=function(a,b){return!(b.left>a.right||b.right<a.left||b.top>a.bottom||b.bottom<a.top)},D=function(a,b){var c=!1,g=a.rect,f;a.lastCollidedWith&&(f=a.lastCollidedWith.rect,(c=v(g,f))||delete a.lastCollidedWith);c||(c=!!d.find(b,function(b){var c;f=b.rect;if(c=v(g,f)){a.lastCollidedWith=b}return c}));return c},B=function(a){var b=Math.ceil((Math.sqrt(a)-1)/2),c=2*b+1,g=Math.pow(c,2),f=!1,c=c-1;1e4>=a&&("boolean"===typeof f&&a>=g-c&&(f={x:b-(g-a),y:-b}),g-=c,"boolean"===typeof f&&a>=g-c&&(f={x:-b,y:-b+(g-a)}),g-=c,"boolean"===typeof f&&(f=a>=g-c?{x:-b+(g-a),y:b}:{x:b,y:b-(g-a-c)}),f.x*=5,f.y*=5);return f},w=function(a,b){a/=b;return{width:256*a,height:256,ratio:a}},C=function(a,b,c){return b+(c-b)/(a-1)*Math.floor(Math.random()*a)},G=function(a,b){a=a.getBBox();var c=b.width/2,g=-(b.height/2),f=b.height/2;return!(-(b.width/2)<a.x&&c>a.x+a.width&&g<a.y&&f>a.y+a.height)};d.seriesType("wordcloud","column",{animation:{duration:500},borderWidth:0,clip:!1,colorByPoint:!0,placementStrategy:"center",rotation:{from:0,orientations:2,to:90},showInLegend:!1,spiral:"rectangular",style:{fontFamily:"Impact, sans-serif"},tooltip:{followPointer:!0,pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.weight}</b><br/>'}},{animate:r.prototype.animate,bindAxes:function(){var a={endOnTick:!1,gridLineWidth:0,lineWidth:0,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};r.prototype.bindAxes.call(this);p(this.yAxis.options,a);p(this.xAxis.options,a)},deriveFontSize:function(a){return Math.floor(25*a)},drawPoints:function(){var a=this,b=a.hasRendered,c=a.xAxis,g=a.yAxis,f=a.group,d=a.options,m=d.animation,n=a.chart.renderer,A=n.text().add(f),r=[],v=a.placementStrategy[d.placementStrategy],B=a.spirals[d.spiral],C=d.rotation,H=a.points.map(function(a){return a.weight}),I=Math.max.apply(null,H),t=w(c.len,g.len),E=a.points.sort(function(a,b){return b.weight-a.weight});k(E,function(c){var g=p({fontSize:a.deriveFontSize(1/I*c.weight)+"px",fill:c.color},d.style),l=v(c,{data:E,field:t,placed:r,rotation:C}),h={align:"center",x:l.x,y:l.y,text:c.name,rotation:l.rotation},k,x,e;A.css(g).attr(h);c.clientRect=e=p({},A.element.getBoundingClientRect());x=A;for(var w=t,F=1,y={x:0,y:0},u=c.rect=p({},e);(D(c,r)||G(x,w))&&!1!==y;){y=B(F,{field:w}),z(y)&&(u.left=e.left+y.x,u.right=u.left+u.width,u.top=e.top+y.y,u.bottom=u.top+u.height),F++}x=y;if(z(x)){h.x+=x.x;h.y+=x.y;p(l,{left:h.x-e.width/2,right:h.x+e.width/2,top:h.y-e.height/2,bottom:h.y+e.height/2});e=t;if(!q(e.left)||e.left>l.left){e.left=l.left}if(!q(e.right)||e.right<l.right){e.right=l.right}if(!q(e.top)||e.top>l.top){e.top=l.top}if(!q(e.bottom)||e.bottom<l.bottom){e.bottom=l.bottom}t=e;r.push(c);c.isNull=!1}else{c.isNull=!0}m&&(k={x:h.x,y:h.y},b?(delete h.x,delete h.y):(h.x=0,h.y=0));c.draw({animate:k,attr:h,css:g,group:f,renderer:n,shapeArgs:void 0,shapeType:"text"})});A=A.destroy();c=Math.min(1/(2*Math.max(Math.abs(t.left),Math.abs(t.right)))*c.len,1/(2*Math.max(Math.abs(t.top),Math.abs(t.bottom)))*g.len);a.group.attr({scaleX:c,scaleY:c})},hasData:function(){return z(this)&&!0===this.visible&&m(this.points)&&0<this.points.length},placementStrategy:{random:function(a,b){a=b.field;b=b.rotation;return{x:Math.round(a.width*(Math.random()+.5)/2)-a.width/2,y:Math.round(a.height*(Math.random()+.5)/2)-a.height/2,rotation:C(b.orientations,b.from,b.to)}},center:function(a,b){a=b.rotation;return{x:0,y:0,rotation:C(a.orientations,a.from,a.to)}}},pointArrayMap:["weight"],spirals:{archimedean:function(a,b){var c=b.field;b=!1;var c=c.width*c.width+c.height*c.height,d=.2*a;1e4>=a&&(b={x:d*Math.cos(d),y:d*Math.sin(d)},Math.min(Math.abs(b.x),Math.abs(b.y))<c||(b=!1));return b},rectangular:function(a,b){a=B(a,b);b=b.field;a&&(a.x*=b.ratio);return a},square:B},getPlotBox:function(){var a=this.chart,b=a.inverted,c=this[b?"yAxis":"xAxis"],b=this[b?"xAxis":"yAxis"];return{translateX:(c?c.left:a.plotLeft)+(c?c.len:a.plotWidth)/2,translateY:(b?b.top:a.plotTop)+(b?b.len:a.plotHeight)/2,scaleX:1,scaleY:1}}},{draw:n,shouldDraw:function(){return!this.isNull}})})(m,w)})});var xrange=createCommonjsModule(function(module){(function(g){"object"==="object"&&module.exports?module.exports=g:g(Highcharts)})(function(g){(function(d){var g=d.defined,u=d.Color,r=d.seriesTypes.column,k=d.each,v=d.isNumber,q=d.isObject,p=d.merge,n=d.pick,w=d.seriesType,x=d.wrap,y=d.Axis,t=d.Point,z=d.Series;w("xrange","column",{colorByPoint:!0,dataLabels:{verticalAlign:"middle",inside:!0,formatter:function(){var a=this.point.partialFill;q(a)&&(a=a.amount);g(a)||(a=0);return 100*a+"%"}},tooltip:{headerFormat:'<span style="font-size: 0.85em">{point.x} - {point.x2}</span><br/>',pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.yCategory}</b><br/>'},borderRadius:3,pointRange:0},{type:"xrange",parallelArrays:["x","x2","y"],requireSorting:!1,animate:d.seriesTypes.line.prototype.animate,cropShoulder:1,getExtremesFromAll:!0,getColumnMetrics:function(){function a(){k(c.series,function(a){var b=a.xAxis;a.xAxis=a.yAxis;a.yAxis=b})}var b,c=this.chart;a();b=r.prototype.getColumnMetrics.call(this);a();return b},cropData:function(a,b,c,f){b=z.prototype.cropData.call(this,this.x2Data,b,c,f);b.xData=a.slice(b.start,b.end);return b},translatePoint:function(a){var b=this.xAxis,c=this.columnMetrics,f=this.options.minPointLength||0,e=a.plotX,d=n(a.x2,a.x+(a.len||0)),h=b.translate(d,0,0,0,1),d=h-e,m=this.chart.inverted,l=n(this.options.borderWidth,1)%2/2;f&&(f-=d,0>f&&(f=0),e-=f/2,h+=f/2);e=Math.max(e,-10);h=Math.min(Math.max(h,-10),b.len+10);a.shapeArgs={x:Math.floor(Math.min(e,h))+l,y:Math.floor(a.plotY+c.offset)+l,width:Math.round(Math.abs(h-e)),height:Math.round(c.width),r:this.options.borderRadius};e=a.shapeArgs.x;f=e+a.shapeArgs.width;0>e||f>b.len?(e=Math.min(b.len,Math.max(0,e)),f=Math.max(0,Math.min(f,b.len)),b=f-e,a.dlBox=p(a.shapeArgs,{x:e,width:f-e,centerX:b?b/2:null})):a.dlBox=null;a.tooltipPos[0]+=m?0:d/2;a.tooltipPos[1]-=m?d/2:c.width/2;if(b=a.partialFill){q(b)&&(b=b.amount),v(b)||(b=0),c=a.shapeArgs,a.partShapeArgs={x:c.x,y:c.y,width:c.width,height:c.height,r:this.options.borderRadius},a.clipRectArgs={x:c.x,y:c.y,width:Math.round(c.width*b),height:c.height}}},translate:function(){r.prototype.translate.apply(this,arguments);k(this.points,function(a){this.translatePoint(a)},this)},drawPoint:function(a,b){var c=this.options,f=this.chart.renderer,e=a.graphic,d=a.shapeType,h=a.shapeArgs,m=a.partShapeArgs,l=a.clipRectArgs,g=a.partialFill,k=a.selected&&"select",n=c.stacking&&!c.borderRadius;if(a.isNull){e&&(a.graphic=e.destroy())}else{if(e){a.graphicOriginal[b](p(h))}else{a.graphic=e=f.g("point").addClass(a.getClassName()).add(a.group||this.group),a.graphicOriginal=f[d](h).addClass(a.getClassName()).addClass("highcharts-partfill-original").add(e)}m&&(a.graphicOverlay?(a.graphicOverlay[b](p(m)),a.clipRect.animate(p(l))):(a.clipRect=f.clipRect(l.x,l.y,l.width,l.height),a.graphicOverlay=f[d](m).addClass("highcharts-partfill-overlay").add(e).clip(a.clipRect)));a.graphicOriginal.attr(this.pointAttribs(a,k)).shadow(c.shadow,null,n);m&&(q(g)||(g={}),q(c.partialFill)&&(g=p(g,c.partialFill)),b=g.fill||u(a.color||this.color).brighten(-.3).get(),a.graphicOverlay.attr(this.pointAttribs(a,k)).attr({fill:b}).shadow(c.shadow,null,n))}},drawPoints:function(){var a=this,b=this.chart.pointCount<(a.options.animationLimit||250)?"animate":"attr";k(a.points,function(c){a.drawPoint(c,b)})}},{init:function(){t.prototype.init.apply(this,arguments);var a;a=this.series;var b=a.chart.options.chart.colorCount;this.y||(this.y=0);a.options.colorByPoint&&(a=a.options.colors||a.chart.options.colors,b=a.length,!this.options.color&&a[this.y%b]&&(this.color=a[this.y%b]));this.colorIndex=this.y%b;return this},getLabelConfig:function(){var a=t.prototype.getLabelConfig.call(this),b=this.series.yAxis.categories;a.x2=this.x2;a.yCategory=this.yCategory=b&&b[this.y];return a},tooltipDateKeys:["x","x2"],isValid:function(){return"number"===typeof this.x&&"number"===typeof this.x2}});x(y.prototype,"getSeriesExtremes",function(a){var b=this.series,c,d;a.call(this);this.isXAxis&&(c=n(this.dataMax,-Number.MAX_VALUE),k(b,function(a){a.x2Data&&k(a.x2Data,function(a){a>c&&(c=a,d=!0)})}),d&&(this.dataMax=c))})})(g)})});var whiteTheme={chart:{backgroundColor:"#FFFFFF",spacing:8,style:{fontFamily:"NotoSansCJKjp-Jxck serif"}},colors:["#C092F5","#61C8FF","#7CD6AB","#FFC96B","#F57177","#CBCFD4","#484848"],legend:{itemStyle:{color:"#484848",fontWeight:"normal"},margin:8,padding:0},plotOptions:{series:{borderWidth:0,fillOpacity:.25,marker:{fillColor:"white",lineWidth:2,lineColor:null}},bullet:{borderWidth:0}},tooltip:{padding:16,backgroundColor:"rgb(72,72,72)",borderRadius:6,borderWidth:0,style:{color:"white"}},xAxis:{gridLineWidth:0},yAxis:{gridLineColor:"#EFEFEF",gridLineWidth:1,lineWidth:0}};var themes={applyTheme:name=>{if(name===void 0)name="white";let theme;switch(name){case"white":theme=whiteTheme;break;default:break}highcharts.theme=theme;highcharts.setOptions(highcharts.theme)}};themes.applyTheme("white");highchartsMore(highcharts);annotations(highcharts);boost(highcharts);bullet(highcharts);drilldown(highcharts);exporting(highcharts);funnel(highcharts);heatmap(highcharts);histogramBellcurve(highcharts);offlineExporting(highcharts);pareto(highcharts);sankey(highcharts);seriesLabel(highcharts);solidGauge(highcharts);streamgraph(highcharts);sunburst(highcharts);tilemap(highcharts);treemap(highcharts);variablePie(highcharts);variwide(highcharts);vector(highcharts);windbarb(highcharts);wordcloud(highcharts);xrange(highcharts);highcharts.setOptions({title:{text:null},subtitle:{text:null},boost:{allowForce:false},chart:{defaultSeriesType:"bar",zoomType:"x",backgroundColor:"transparent"},credits:{enabled:false},exporting:{enabled:false},legend:{enabled:true,navigation:{enabled:true}},plotOptions:{series:{animation:{duration:300},boostThreshold:2e3,cursor:"pointer",label:{enabled:false}},heatmap:{dataLabels:{enabled:true}}},tooltip:{crosshairs:true,enabled:true},xAxis:{title:null,labels:{style:{fontSize:"8px"}}},yAxis:{title:null,labels:{style:{fontSize:"8px"}}}});var script$2=function(){const store=this.riotx.get();const updateChart=()=>{const canvasElm=this.refs.canvas;if(!canvasElm){return}const data=this.data;highcharts.chart(canvasElm,data)};const getData=()=>{return Promise.resolve().then(()=>{this.isLoading=true;this.update()}).then(()=>Promise.all([new Promise(resolve=>setTimeout(resolve,300)),store.action("components.get",this.opts.id,this.opts.def)])).then(()=>{this.isLoading=false;this.update()}).then(()=>{updateChart()}).catch(err=>{this.isLoading=false;if(err.status===401){this.error="Ë™çË®º„Ç®„É©„Éº„ÄÇ"}else{const api=this.opts.def.api;this.error=`[${api.method.toUpperCase()} ${api.path}]ÈÄö‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ`}this.update()})};const validate=data=>{if(!isObject_1(data)){return"TODO: „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏"}return null};this.data=null;this.isLoading=true;this.error=null;this.autoRefreshSec=null;let autoRefreshIntervalId=null;const activateAutoRefresh=()=>{if(!this.autoRefreshSec){return}if(autoRefreshIntervalId){return}autoRefreshIntervalId=window.setInterval(()=>{getData()},this.autoRefreshSec*1e3)};const inactivateAutoRefresh=()=>{window.clearInterval(autoRefreshIntervalId);autoRefreshIntervalId=null};this.listen(this.opts.id,()=>{this.data=store.getter("components.response",this.opts.id);this.error=validate(this.data);this.autoRefreshSec=store.getter("components.autoRefreshSec",this.opts.id);activateAutoRefresh();this.update()});this.on("mount",()=>{getData()}).on("unmount",()=>{inactivateAutoRefresh();store.action("components.remove",this.opts.id)});this.handleRefreshButtonTap=(()=>{getData()})};riot$1.tag2("viron-components-page-chart",'<div class="ComponentsPage_Card_Chart__head"> <div class="ComponentsPage_Card_Chart__title">{opts.def.name}</div> <div class="ComponentsPage_Card_Chart__control"> <viron-icon-reload onclick="{getClickHandler(\'handleRefreshButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleRefreshButtonTap\')}"></viron-icon-reload> </div> </div> <div class="ComponentsPage_Card_Chart__body"> <virtual if="{isLoading}"> <div class="ComponentsPage_Card_Chart__progress"> <viron-icon-reload></viron-icon-reload> </div> </virtual> <virtual if="{!isLoading}"> <virtual if="{!!error}"> <div class="ComponentsPage_Card_Chart__error">{error}</div> </virtual> <virtual if="{!error}"> <div class="ComponentsPage_Card_Chart__canvas" ref="canvas" id="{_riot_id}"></div> </virtual> </virtual> </div> <div class="ComponentsPage_Card_Chart__blocker" if="{isLoading}"></div>',"",'class="ComponentsPage_Card_Chart"',function(opts){this.external(script$2)});function toNumber(val){if(typeof val==="number"){return val}if(!val){return 0}if(typeof val==="string"){return parseFloat(val)}if(isArray_1$1(val)){return NaN}return Number(val)}var toNumber_1=toNumber;function currencyFormat(val,nDecimalDigits,decimalSeparator,thousandsSeparator){val=toNumber_1(val);nDecimalDigits=nDecimalDigits==null?2:nDecimalDigits;decimalSeparator=decimalSeparator==null?".":decimalSeparator;thousandsSeparator=thousandsSeparator==null?",":thousandsSeparator;var fixed=val.toFixed(nDecimalDigits),parts=new RegExp("^(-?\\d{1,3})((?:\\d{3})+)(\\.(\\d{"+nDecimalDigits+"}))?$").exec(fixed);if(parts){return parts[1]+parts[2].replace(/\d{3}/g,thousandsSeparator+"$&")+(parts[4]?decimalSeparator+parts[4]:"")}else{return fixed.replace(".",decimalSeparator)}}var currencyFormat_1=currencyFormat;var script$3=function(){const store=this.riotx.get();const getData=()=>{return Promise.resolve().then(()=>{this.isLoading=true;this.update()}).then(()=>Promise.all([new Promise(resolve=>setTimeout(resolve,300)),store.action("components.get",this.opts.id,this.opts.def)])).then(()=>{this.isLoading=false;this.update()}).catch(err=>{this.isLoading=false;if(err.status===401){this.error="Ë™çË®º„Ç®„É©„Éº„ÄÇ"}else{const api=this.opts.def.api;this.error=`[${api.method.toUpperCase()} ${api.path}]ÈÄö‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ`}this.update()})};const validate=data=>{if(!data){return"TODO: „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏"}if(!isNumber_1(data.value)){return"TODO: „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏"}return null};this.data=null;this.isLoading=true;this.error=null;this.autoRefreshSec=null;let autoRefreshIntervalId=null;const activateAutoRefresh=()=>{if(!this.autoRefreshSec){return}if(autoRefreshIntervalId){return}autoRefreshIntervalId=window.setInterval(()=>{getData()},this.autoRefreshSec*1e3)};const inactivateAutoRefresh=()=>{window.clearInterval(autoRefreshIntervalId);autoRefreshIntervalId=null};this.getValue=(()=>{return currencyFormat_1(this.data.value,0)});this.listen(this.opts.id,()=>{this.data=store.getter("components.response",this.opts.id);this.error=validate(this.data);this.autoRefreshSec=store.getter("components.autoRefreshSec",this.opts.id);activateAutoRefresh();this.update()});this.on("mount",()=>{getData()}).on("unmount",()=>{inactivateAutoRefresh();store.action("components.remove",this.opts.id)});this.handleRefreshButtonTap=(()=>{getData()})};riot$1.tag2("viron-components-page-number",'<div class="ComponentsPage_Card_Number__head"> <div class="ComponentsPage_Card_Number__title">{opts.def.name}</div> <div class="ComponentsPage_Card_Number__control"> <viron-icon-reload onclick="{getClickHandler(\'handleRefreshButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleRefreshButtonTap\')}"></viron-icon-reload> </div> </div> <div class="ComponentsPage_Card_Number__body"> <virtual if="{isLoading}"> <div class="ComponentsPage_Card_Number__progress"> <viron-icon-reload></viron-icon-reload> </div> </virtual> <virtual if="{!isLoading}"> <virtual if="{!!error}"> <div class="ComponentsPage_Card_Number__error">{error}</div> </virtual> <virtual if="{!error}"> <div class="ComponentsPage_Card_Number__valueWrapper"> <div class="ComponentsPage_Card_Number__value">{getValue()}</div> <div class="ComponentsPage_Card_Number__unit" if="{!!data.unit}">{data.unit}</div> </div> </virtual> </virtual> </div> <div class="ComponentsPage_Card_Number__blocker" if="{isLoading}"></div>',"",'class="ComponentsPage_Card_Number"',function(opts){this.external(script$3)});riot$1.tag2("viron-icon-filter",'<svg viewbox="-1832 11377 16.002 16"> <g transform="translate(-2104 11230)"> <rect width="12" height="1.5" rx="0.4" transform="translate(276 154.25)"></rect> <rect width="6" height="1.5" rx="0.4" transform="translate(282 148.75)"></rect> <rect width="12" height="1.5" rx="0.4" transform="translate(284 161.25) rotate(180)"></rect> <path d="M4700.5-19588a2.5,2.5,0,0,1-2.5-2.5,2.5,2.5,0,0,1,2.5-2.5,2.506,2.506,0,0,1,2.5,2.5A2.5,2.5,0,0,1,4700.5-19588Zm0-3a.5.5,0,0,0-.5.5.5.5,0,0,0,.5.5.5.5,0,0,0,.5-.5A.5.5,0,0,0,4700.5-19591Z" transform="translate(-4426 19745.5)"></path> <path d="M4700.5-19588a2.5,2.5,0,0,1-2.5-2.5,2.5,2.5,0,0,1,2.5-2.5,2.506,2.506,0,0,1,2.5,2.5A2.5,2.5,0,0,1,4700.5-19588Zm0-3a.5.5,0,0,0-.5.5.5.5,0,0,0,.5.5.5.5,0,0,0,.5-.5A.5.5,0,0,0,4700.5-19591Z" transform="translate(-4415 19751)"></path> <path d="M4700.5-19588a2.5,2.5,0,0,1-2.5-2.5,2.5,2.5,0,0,1,2.5-2.5,2.506,2.506,0,0,1,2.5,2.5A2.5,2.5,0,0,1,4700.5-19588Zm0-3a.5.5,0,0,0-.5.5.5.5,0,0,0,.5.5.5.5,0,0,0,.5-.5A.5.5,0,0,0,4700.5-19591Z" transform="translate(-4420.501 19740)"></path> <rect width="7" height="1.5" rx="0.4" transform="translate(272 148.75)"></rect> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconFilter {opts.class}"',function(opts){});riot$1.tag2("viron-icon-plus",'<svg viewbox="-2612 10790 16 16"> <g transform="translate(-3874 10766)"> <rect width="16" height="3" rx="0.2" transform="translate(1262 30.5)"></rect> <rect width="16" height="3" rx="0.2" transform="translate(1271.5 24) rotate(90)"></rect> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconPlus {opts.class}"',function(opts){});riot$1.tag2("viron-icon-setting",'<svg viewbox="-3464 14060 16 16.001"> <path d="M15.953,7.112a.521.521,0,0,0-.514-.394,1.767,1.767,0,0,1-1.209-3.075.444.444,0,0,0,.049-.6A7.916,7.916,0,0,0,13.01,1.76a.445.445,0,0,0-.608.049,1.844,1.844,0,0,1-2,.448A1.777,1.777,0,0,1,9.327.521.444.444,0,0,0,8.934.053a7.987,7.987,0,0,0-1.8,0,.445.445,0,0,0-.4.458,1.78,1.78,0,0,1-1.1,1.707,1.849,1.849,0,0,1-1.98-.451.446.446,0,0,0-.6-.051,7.946,7.946,0,0,0-1.294,1.28.445.445,0,0,0,.048.608,1.773,1.773,0,0,1,.447,2A1.85,1.85,0,0,1,.518,6.677a.435.435,0,0,0-.462.393,8.014,8.014,0,0,0,0,1.819.529.529,0,0,0,.525.393,1.755,1.755,0,0,1,1.646,1.1,1.779,1.779,0,0,1-.447,1.978.445.445,0,0,0-.049.6,7.945,7.945,0,0,0,1.266,1.28.445.445,0,0,0,.609-.048A1.841,1.841,0,0,1,5.6,13.743,1.774,1.774,0,0,1,6.679,15.48a.444.444,0,0,0,.393.467,7.962,7.962,0,0,0,1.8,0,.445.445,0,0,0,.4-.458,1.778,1.778,0,0,1,1.095-1.706,1.846,1.846,0,0,1,1.981.451.447.447,0,0,0,.6.05,7.965,7.965,0,0,0,1.294-1.28.444.444,0,0,0-.048-.608,1.773,1.773,0,0,1-.448-2,1.791,1.791,0,0,1,1.637-1.085l.1,0a.445.445,0,0,0,.468-.392A8.007,8.007,0,0,0,15.953,7.112ZM8.015,10.686a2.669,2.669,0,1,1,2.668-2.669A2.671,2.671,0,0,1,8.015,10.686Z" transform="translate(-3464.003 14060)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconSetting {opts.class}"',function(opts){});riot$1.tag2("viron-icon-arrow-left",'<svg viewbox="-3581 14060.002 10.04 16.002"> <path d="M1793.942-16723.971l-7.4-7.4-.018-.023-.385-.385a.2.2,0,0,1,0-.281l7.8-7.8a.2.2,0,0,1,.281,0l1.84,1.84a.2.2,0,0,1,0,.281l-5.82,5.82,5.82,5.816a.2.2,0,0,1,0,.287l-1.84,1.84a.2.2,0,0,1-.141.057A.2.2,0,0,1,1793.942-16723.971Z" transform="translate(-5367.083 30799.918)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconArrowLeft {opts.class}"',function(opts){});riot$1.tag2("viron-icon-arrow-right",'<svg viewbox="-3551.038 14059.998 10.039 16.002"> <path d="M1763.979-16723.969l-7.394-7.4a.291.291,0,0,1-.022-.025l-.381-.383a.2.2,0,0,1,0-.281l7.8-7.8a.2.2,0,0,1,.286,0l1.836,1.84a.191.191,0,0,1,0,.277l-5.819,5.822,5.819,5.818a.2.2,0,0,1,0,.287l-1.836,1.84a.21.21,0,0,1-.143.057A.21.21,0,0,1,1763.979-16723.969Z" transform="translate(-1784.878 -2663.914) rotate(180)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconArrowRight {opts.class}"',function(opts){});riot$1.tag2("viron-icon-dots",'<svg viewbox="-3614 14066 16 4"> <g transform="translate(-3894 14025)"> <circle cx="2" cy="2" r="2" transform="translate(280 41)"></circle> <circle cx="2" cy="2" r="2" transform="translate(286 41)"></circle> <circle cx="2" cy="2" r="2" transform="translate(292 41)"></circle> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconDots {opts.class}"',function(opts){});function times(n,callback,thisObj){var i=-1;while(++i<n){if(callback.call(thisObj,i)===false){break}}}var times_1=times;var script$4=function(){this.getIsSimpleMode=(()=>{return this.opts.max<=this.opts.size});this.getBasePages=(()=>{const size=this.opts.size;const current=this.opts.current;const max=this.opts.max;if(this.getIsSimpleMode()){const ret=[];times_1(max,i=>{i=i+1;ret.push({num:i,isSelected:i===current})});return ret}let startPage=current-Math.floor(size/2);let endPage=current+Math.floor(size/2)-(size%2?0:1);if(startPage<1){endPage=endPage+Math.abs(startPage+1);startPage=1}if(endPage>max){startPage=startPage-(endPage-max);endPage=max}const ret=[];for(let i=startPage;i<=endPage;i++){ret.push({num:i,isSelected:i===current})}return ret});this.handlePrevButtonTap=(()=>{if(!this.opts.onchange){return}if(this.opts.current===1){return}let newPage=this.opts.current-1;if(newPage<1){newPage=1}this.opts.onchange(newPage)});this.handleFirstPageButtonTap=(()=>{if(!this.opts.onchange){return}this.opts.onchange(1)});this.handleRecedeButtonTap=(()=>{if(!this.opts.onchange){return}let newPage=this.opts.current-this.opts.size;if(newPage<1){newPage=1}this.opts.onchange(newPage)});this.handlePageButtonTap=(e=>{if(!this.opts.onchange){return}const newPage=e.item.page.num;this.opts.onchange(newPage)});this.handleProceedButtonTap=(()=>{if(!this.opts.onchange){return}let newPage=this.opts.current+this.opts.size;if(newPage>this.opts.max){newPage=this.opts.max}this.opts.onchange(newPage)});this.handleLastPageButtonTap=(()=>{if(!this.opts.onchange){return}this.opts.onchange(this.opts.max)});this.handleNextButtonTap=(()=>{if(!this.opts.onchange){return}if(this.opts.current===this.opts.max){return}let newPage=this.opts.current+1;if(newPage>this.opts.max){newPage=this.opts.max}this.opts.onchange(newPage)})};riot$1.tag2("viron-pagination",'<div class="Pagination__control"> <virtual if="{getIsSimpleMode()}"> <div class="Pagination__button {\'Pagination__button--disabled\': opts.current === 1}" onclick="{getClickHandler(\'handlePrevButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePrevButtonTap\')}"> <viron-icon-arrow-left></viron-icon-arrow-left> </div> <div class="Pagination__button {\'Pagination__button--selected\': page.isSelected}" each="{page in getBasePages()}" onclick="{getClickHandler(\'handlePageButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePageButtonTap\')}">{page.num}</div> <div class="Pagination__button {\'Pagination__button--disabled\': opts.current === opts.max}" onclick="{getClickHandler(\'handleNextButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleNextButtonTap\')}"> <viron-icon-arrow-right></viron-icon-arrow-right> </div> </virtual> <virtual if="{!getIsSimpleMode()}"> <div class="Pagination__button {\'Pagination__button--disabled\': opts.current === 1}" onclick="{getClickHandler(\'handlePrevButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePrevButtonTap\')}"> <viron-icon-arrow-left></viron-icon-arrow-left> </div> <div class="Pagination__button" if="{getBasePages()[0].num !== 1}" onclick="{getClickHandler(\'handleFirstPageButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleFirstPageButtonTap\')}">1</div> <div class="Pagination__button Pagination__button--moderate" if="{getBasePages()[0].num &gt;= 3}" onclick="{getClickHandler(\'handleRecedeButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleRecedeButtonTap\')}"> <viron-icon-dots class="Pagination__dotsIcon"></viron-icon-dots> <viron-icon-arrow-left class="Pagination__arrowIcon"></viron-icon-arrow-left> </div> <div class="Pagination__button {\'Pagination__button--selected\': page.isSelected}" each="{page in getBasePages()}" onclick="{getClickHandler(\'handlePageButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePageButtonTap\')}">{page.num}</div> <div class="Pagination__button Pagination__button--moderate" if="{getBasePages()[getBasePages().length - 1].num &lt;= opts.max - 2}" onclick="{getClickHandler(\'handleProceedButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleProceedButtonTap\')}"> <viron-icon-dots class="Pagination__dotsIcon"></viron-icon-dots> <viron-icon-arrow-right class="Pagination__arrowIcon"></viron-icon-arrow-right> </div> <div class="Pagination__button" if="{getBasePages()[getBasePages().length - 1].num !== opts.max}" onclick="{getClickHandler(\'handleLastPageButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleLastPageButtonTap\')}">{opts.max}</div> <div class="Pagination__button {\'Pagination__button--disabled\': opts.current === opts.max}" onclick="{getClickHandler(\'handleNextButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleNextButtonTap\')}"> <viron-icon-arrow-right></viron-icon-arrow-right> </div> </virtual> </div>',"",'class="Pagination {opts.class}"',function(opts){this.external(script$4)});function isBoolean(val){return isKind_1$1(val,"Boolean")}var isBoolean_1=isBoolean;function isNull(val){return val===null}var isNull_1=isNull;function isString(val){return isKind_1$1(val,"String")}var isString_1=isString;var UNDEF$1;function isUndef(val){return val===UNDEF$1}var isUndefined=isUndef;var script$5=function(){this.isText=false;this.isImage=false;this.isBase64=false;this.mimeType=null;this.isVideo=false;this.videoType=null;this.value=(()=>{const data=this.opts.data;const column=this.opts.column;if(isNull_1(data)){this.isText=true;return"null"}if(isBoolean_1(data)){this.isText=true;return data?"true":"false"}if(isNumber_1(data)){this.isText=true;return String(data)}if(isArray_1$1(data)){this.isText=true;return"[...]"}if(isObject_1(data)){this.isText=true;return"{...}"}if(isString_1(data)){if(column.format==="base64"){this.isBase64=true;this.mimeType=column["x-mime-type"]||"image/png";switch(this.mimeType){case"image/png":case"image/gif":case"image/jpeg":this.isImage=true;break;default:break}return data}const split=data.split(".");if(split.length<2){this.isText=true;return data}const suffix=split[split.length-1];if(contains_1$2(["png","jpg","jpeg","gif"],suffix)){this.isImage=true;return data}if(contains_1$2(["mp4","ogv","webm"],suffix)){this.isVideo=true;this.videoType=suffix;return data}this.isText=true;return data}if(isUndefined(data)){this.isText=true;return""}this.isText=true;return String(data)})()};riot$1.tag2("viron-components-page-table-cell",'<virtual if="{isText}"> <div class="ComponentsPage_Card_Table_Cell__string">{value}</div> </virtual> <virtual if="{isImage}"> <virtual if="{!isBase64}"> <div class="ComponentsPage_Card_Table_Cell__image" riot-style="background-image:url({value});"></div> </virtual> <virtual if="{isBase64}"> <div class="ComponentsPage_Card_Table_Cell__image" riot-style="background-image:url(data:{mimeType};base64,{value});"></div> </virtual> </virtual> <virtual if="{isVideo}"> <componentspage_card_table_cell__video>TODO</ComponentsPage_Card_Table_Cell__video> </virtual>',"",'class="ComponentsPage_Card_Table_Cell"',function(opts){this.external(script$5)});riot$1.tag2("viron-icon-close",'<svg viewbox="-3644.002 14060.002 16.001 16.002"> <path d="M1859.9-16723.971l-5.819-5.822-5.818,5.818a.2.2,0,0,1-.281,0l-1.84-1.842a.2.2,0,0,1,0-.281l5.818-5.816-5.818-5.82a.2.2,0,0,1,0-.281l1.84-1.84a.2.2,0,0,1,.281,0l5.818,5.818,5.82-5.818a.2.2,0,0,1,.286,0l1.84,1.84a.2.2,0,0,1,0,.281l-5.823,5.82,5.819,5.82a.2.2,0,0,1,0,.283l-1.836,1.84a.21.21,0,0,1-.143.057A.21.21,0,0,1,1859.9-16723.971Z" transform="translate(-5490.083 30799.918)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconClose {opts.class}"',function(opts){});var script$7=function(){this.handleTap=(()=>{if(this.opts.isdisabled){return}if(!this.opts.onselect){return}this.opts.onselect()})};riot$1.tag2("viron-button",'<div class="Button__label">{opts.label}</div>',"","class=\"Button Button--{opts.theme || 'primary'} {opts.isdisabled ? 'Button--disabled' : ''}\" onclick=\"{getClickHandler('handleTap')}\" ontouchstart=\"{getTouchStartHandler()}\" ontouchmove=\"{getTouchMoveHandler()}\" ontouchend=\"{getTouchEndHandler('handleTap')}\"",function(opts){this.external(script$7)});riot$1.tag2("viron-icon-check",'<svg viewbox="-2582 10792 15.997 11.266"> <g transform="translate(-2935 10688)"> <g transform="translate(122.702 -49.51)"> <rect width="12.32" height="2.989" rx="0.2" transform="translate(235.47 162.221) rotate(-45)"></rect> <rect width="9.682" height="2.989" rx="0.2" transform="translate(232.412 155.815) rotate(45)"></rect> </g> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconCheck {opts.class}"',function(opts){});var script$8=function(){this.handleTap=(()=>{if(!this.opts.onchange){return}if(this.opts.isdisabled){return}this.opts.onchange(!this.opts.ischecked,this.opts.id)});this.handleBlockerTap=(e=>{e.stopPropagation()})};riot$1.tag2("viron-checkbox",'<div class="Checkbox__content"> <div class="Checkbox__mark"> <viron-icon-check></viron-icon-check> </div> <div class="Checkbox__label" if="{!!opts.label}">{opts.label}</div> </div> <div class="Checkbox__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"","class=\"Checkbox {'Checkbox--checked': opts.ischecked, 'Checkbox--error': opts.iserror, 'Checkbox--disabled': opts.isdisabled} Checkbox--{opts.theme}\" onclick=\"{getClickHandler('handleTap')}\" ontouchstart=\"{getTouchStartHandler()}\" ontouchmove=\"{getTouchMoveHandler()}\" ontouchend=\"{getTouchEndHandler('handleTap')}\"",function(opts){this.external(script$8)});var script$9=function(){const store=this.riotx.get();this.isApplyButtonDisabled=false;const selectedColumnKeys=this.opts.selectedColumnKeys;this.columns=map_1$1(deepClone_1(this.opts.columns),column=>{let isSelected;if(!selectedColumnKeys||contains_1$2(selectedColumnKeys,column.key)){isSelected=true}return objectAssign(column,{isSelected:isSelected})});this.isAllSelected=!selectedColumnKeys||selectedColumnKeys.length===this.columns.length;this.layoutType=store.getter("layout.type");this.isMobile=store.getter("layout.isMobile");this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.isMobile=store.getter("layout.isMobile");this.update()});this.handleCloseButtonTap=(()=>{this.close()});this.handleAllSelectChange=(newIsChecked=>{this.isAllSelected=newIsChecked;map_1$1(this.columns,column=>{column.isSelected=newIsChecked;return column});if(!find_1$2(this.columns,column=>{return column.isSelected})){this.isApplyButtonDisabled=true}else{this.isApplyButtonDisabled=false}this.update()});this.handleItemChange=((newIsSelected,key)=>{const target=find_1$2(this.columns,column=>{return column.key===key});if(!!target){target.isSelected=newIsSelected}if(!find_1$2(this.columns,column=>{return column.isSelected})){this.isApplyButtonDisabled=true}else{this.isApplyButtonDisabled=false}if(find_1$2(this.columns,column=>{return!column.isSelected})){this.isAllSelected=false}else{this.isAllSelected=true}this.update()});this.handleApplyButtonTap=(()=>{if(!this.opts.onChange){return}let newSelectedColumnKeys=map_1$1(filter_1$1(this.columns,column=>{return column.isSelected}),column=>{return column.key});if(newSelectedColumnKeys.length===this.columns.length){newSelectedColumnKeys=null}this.opts.onChange(newSelectedColumnKeys);if(this.isMobile){this.close()}})};riot$1.tag2("viron-components-page-filter",'<div class="ComponentsPage_Filter__head"> <div class="ComponentsPage_Filter__closeButton" onclick="{getClickHandler(\'handleCloseButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCloseButtonTap\')}"> <viron-icon-close></viron-icon-close> </div> <div class="ComponentsPage_Filter__title">Ë°®Á§∫È†ÖÁõÆ„Éï„Ç£„É´„Çø„Éº</div> <div class="ComponentsPage_Filter__description">„ÉÜ„Éº„Éñ„É´„Å´Ë°®Á§∫„Åô„ÇãÈ†ÖÁõÆ„ÇíÈÅ∏Êäû„Åß„Åç„Åæ„Åô„ÄÇË°®Á§∫„Åï„Åõ„Åü„ÅÑÈ†ÖÁõÆ„ÇíON„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</div> <div class="ComponentsPage_Filter__control"> <div class="ComponentsPage_Filter__item"> <viron-checkbox label="ÂÖ®„Å¶ÈÅ∏Êäû„Åô„Çã" ischecked="{isAllSelected}" theme="ghost" onchange="{handleAllSelectChange}"></viron-checkbox> </div> </div> </div> <div class="ComponentsPage_Filter__body"> <div class="ComponentsPage_Filter__item" each="{column in columns}"> <viron-checkbox id="{column.key}" label="{column.description || column.key}" ischecked="{column.isSelected}" theme="ghost" onchange="{handleItemChange}"></viron-checkbox> </div> </div> <div class="ComponentsPage_Filter__tail"> <viron-button label="ÈÅ©Áî®„Åô„Çã" isdisabled="{isApplyButtonDisabled}" onselect="{handleApplyButtonTap}"></viron-button> </div>',"",'class="ComponentsPage_Filter ComponentsPage_Filter--{layoutType}"',function(opts){this.external(script$9)});var clipboard=createCommonjsModule(function(module){(function(name,definition){{module.exports=definition()}})("clipboard",function(){if(typeof document==="undefined"||!document.addEventListener){return null}var clipboard={};clipboard.copy=function(){var _intercept=false;var _data=null;var _bogusSelection=false;function cleanup(){_intercept=false;_data=null;if(_bogusSelection){window.getSelection().removeAllRanges()}_bogusSelection=false}document.addEventListener("copy",function(e){if(_intercept){for(var key in _data){e.clipboardData.setData(key,_data[key])}e.preventDefault()}});function bogusSelect(){var sel=document.getSelection();if(!document.queryCommandEnabled("copy")&&sel.isCollapsed){var range=document.createRange();range.selectNodeContents(document.body);sel.removeAllRanges();sel.addRange(range);_bogusSelection=true}}return function(data){return new Promise(function(resolve,reject){_intercept=true;if(typeof data==="string"){_data={"text/plain":data}}else if(data instanceof Node){_data={"text/html":(new XMLSerializer).serializeToString(data)}}else if(data instanceof Object){_data=data}else{reject("Invalid data type. Must be string, DOM node, or an object mapping MIME types to strings.")}function triggerCopy(tryBogusSelect){try{if(document.execCommand("copy")){cleanup();resolve()}else{if(!tryBogusSelect){bogusSelect();triggerCopy(true)}else{cleanup();throw new Error("Unable to copy. Perhaps it's not available in your browser?")}}}catch(e){cleanup();reject(e)}}triggerCopy(false)})}}();clipboard.paste=function(){var _intercept=false;var _resolve;var _dataType;document.addEventListener("paste",function(e){if(_intercept){_intercept=false;e.preventDefault();var resolve=_resolve;_resolve=null;resolve(e.clipboardData.getData(_dataType))}});return function(dataType){return new Promise(function(resolve,reject){_intercept=true;_resolve=resolve;_dataType=dataType||"text/plain";try{if(!document.execCommand("paste")){_intercept=false;reject(new Error("Unable to paste. Pasting only works in Internet Explorer at the moment."))}}catch(e){_intercept=false;reject(new Error(e))}})}}();if(typeof ClipboardEvent==="undefined"&&typeof window.clipboardData!=="undefined"&&typeof window.clipboardData.setData!=="undefined"){(function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if("object"!=typeof this){throw new TypeError("Promises must be constructed via new")}if("function"!=typeof a){throw new TypeError("not a function")}this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void j(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c){return void(b._state?a.resolve:a.reject)(b._value)}var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this){throw new TypeError("A promise cannot be resolved with itself.")}if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c){return void i(b(c,a),b(e,this),b(f,this))}}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++){d.call(this,this._deferreds[a])}this._deferreds=null}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d){return}d=!0,c(e)}}var j=c.immediateFn||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&k(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h){return void h.call(g,function(a){d(f,a)},c)}}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length){return b([])}for(var e=a.length,f=0;f<a.length;f++){d(f,a[f])}})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++){a[d].then(b,c)}})},"undefined"!="object"&&module.exports?module.exports=c:a.Promise||(a.Promise=c)})(this);clipboard.copy=function(data){return new Promise(function(resolve,reject){if(typeof data!=="string"&&!("text/plain"in data)){throw new Error("You must provide a text/plain type.")}var strData=typeof data==="string"?data:data["text/plain"];var copySucceeded=window.clipboardData.setData("Text",strData);if(copySucceeded){resolve()}else{reject(new Error("Copying was rejected."))}})};clipboard.paste=function(){return new Promise(function(resolve,reject){var strData=window.clipboardData.getData("Text");if(strData){resolve(strData)}else{reject(new Error("Pasting was rejected."))}})}}return clipboard})});var script$10=function(){const store=this.riotx.get();let isClipboardCopySupported=true;this.isMobile=store.getter("layout.isMobile");this.options=[];const config=this.opts.config;const path=config.path;const field=config.field;const query=config.query||{};const fetchAutocompleteOptions=val=>{if(isNull_1(val)||isUndefined(val)){return}Promise.resolve().then(()=>store.action("oas.getAutocomplete",path,objectAssign({},query,{[field]:val}))).then(options=>{this.options=options;this.update()}).catch(err=>store.action("modals.add","viron-error",{error:err}))};this.normalizeValue=(value=>{if(isNumber_1(value)){return String(value)}if(isUndefined(value)){return null}return value});this.on("mount",()=>{fetchAutocompleteOptions(this.normalizeValue(this.refs.input.value))});this.handleFormSubmit=(e=>{e.preventDefault();if(!this.opts.onchange){return}if(this.opts.isdisabled){return}this.opts.onchange(this.normalizeValue(this.opts.val),this.opts.id)});this.handleInputInput=(e=>{if(!this.opts.onchange){return}if(this.opts.isdisabled){return}fetchAutocompleteOptions(this.normalizeValue(e.target.value));this.opts.onchange(this.normalizeValue(e.target.value),this.opts.id)});this.handleInputChange=(e=>{e.stopPropagation()});this.handleInputFocus=(()=>{if(!this.opts.onfocus){return}this.opts.onfocus()});this.handleInputBlur=(()=>{if(!this.opts.onblur){return}this.opts.onblur()});this.handleBlockerTap=(e=>{e.stopPropagation();if(this.isMobile||!isClipboardCopySupported||!this.opts.val){return}Promise.resolve().then(()=>{return clipboard.copy(this.opts.val)}).then(()=>store.action("toasts.add",{message:"„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü„ÄÇ"})).catch(()=>{isClipboardCopySupported=false;store.action("toasts.add",{type:"error",message:"„Åî‰ΩøÁî®‰∏≠„ÅÆ„Éñ„É©„Ç¶„Ç∂„Åß„ÅØ„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„ÉºÂá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"})})})};riot$1.tag2("viron-autocomplete",'<div class="Autocomplete__label" if="{!!opts.label}">{opts.label}</div> <form onsubmit="{handleFormSubmit}"> <input class="Autocomplete__input" type="text" riot-value="{opts.val}" ref="input" list="{_riot_id}" disabled="{opts.isdisabled}" oninput="{handleInputInput}" onchange="{handleInputChange}" onfocus="{handleInputFocus}" onblur="{handleInputBlur}"> </form> <datalist id="{_riot_id}"> <option each="{opt in options}" riot-value="{opt.value}">{opt.name}</option> </datalist> <div class="Autocomplete__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"","class=\"Autocomplete {'Autocomplete--disabled': opts.isdisabled, 'Autocomplete--error': opts.iserror}\"",function(opts){this.external(script$10)});var script$11=function(){const store=this.riotx.get();const mimeType=this.opts.mimetype||"";this.isImage=false;if(mimeType.indexOf("image")===0){this.isImage=true}this.handleBlockerTap=(e=>{e.stopPropagation();if(!this.opts.ispreview){return}store.action("mediapreviews.add",{path:`data:${this.mimeType};base64,${this.opts.val}`})})};riot$1.tag2("viron-base64",'<virtual if="{isImage}"> <div class="Base64__content" riot-style="background-image:url(data:{mimeType};base64,{opts.val});"></div> </virtual> <div class="Base64__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"",'class="Base64"',function(opts){this.external(script$11)});var beautify=createCommonjsModule(function(module,exports){(function(){var legacy_beautify_js=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.i=function(value){return value};__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=6)}([function(module,exports){var nonASCIIidentifierStartChars="¬™¬µ¬∫√Ä-√ñ√ò-√∂√∏-ÀÅÀÜ-ÀëÀ†-À§À¨ÀÆÕ∞-Õ¥Õ∂Õ∑Õ∫-ÕΩŒÜŒà-ŒäŒåŒé-Œ°Œ£-œµœ∑-“Å“ä-‘ß‘±-’ñ’ô’°-÷á◊ê-◊™◊∞-◊≤ÿ†-ŸäŸÆŸØŸ±-€ì€ï€•€¶€Æ€Ø€∫-€º€ø‹ê‹í-‹Ø›ç-ﬁ•ﬁ±ﬂä-ﬂ™ﬂ¥ﬂµﬂ∫‡†Ä-‡†ï‡†ö‡†§‡†®‡°Ä-‡°ò‡¢†‡¢¢-‡¢¨‡§Ñ-‡§π‡§Ω‡•ê‡•ò-‡•°‡•±-‡•∑‡•π-‡•ø‡¶Ö-‡¶å‡¶è‡¶ê‡¶ì-‡¶®‡¶™-‡¶∞‡¶≤‡¶∂-‡¶π‡¶Ω‡ßé‡ßú‡ßù‡ßü-‡ß°‡ß∞‡ß±‡®Ö-‡®ä‡®è‡®ê‡®ì-‡®®‡®™-‡®∞‡®≤‡®≥‡®µ‡®∂‡®∏‡®π‡©ô-‡©ú‡©û‡©≤-‡©¥‡™Ö-‡™ç‡™è-‡™ë‡™ì-‡™®‡™™-‡™∞‡™≤‡™≥‡™µ-‡™π‡™Ω‡´ê‡´†‡´°‡¨Ö-‡¨å‡¨è‡¨ê‡¨ì-‡¨®‡¨™-‡¨∞‡¨≤‡¨≥‡¨µ-‡¨π‡¨Ω‡≠ú‡≠ù‡≠ü-‡≠°‡≠±‡ÆÉ‡ÆÖ-‡Æä‡Æé-‡Æê‡Æí-‡Æï‡Æô‡Æö‡Æú‡Æû‡Æü‡Æ£‡Æ§‡Æ®-‡Æ™‡ÆÆ-‡Æπ‡Øê‡∞Ö-‡∞å‡∞é-‡∞ê‡∞í-‡∞®‡∞™-‡∞≥‡∞µ-‡∞π‡∞Ω‡±ò‡±ô‡±†‡±°‡≤Ö-‡≤å‡≤é-‡≤ê‡≤í-‡≤®‡≤™-‡≤≥‡≤µ-‡≤π‡≤Ω‡≥û‡≥†‡≥°‡≥±‡≥≤‡¥Ö-‡¥å‡¥é-‡¥ê‡¥í-‡¥∫‡¥Ω‡µé‡µ†‡µ°‡µ∫-‡µø‡∂Ö-‡∂ñ‡∂ö-‡∂±‡∂≥-‡∂ª‡∂Ω‡∑Ä-‡∑Ü‡∏Å-‡∏∞‡∏≤‡∏≥‡πÄ-‡πÜ‡∫Å‡∫Ç‡∫Ñ‡∫á‡∫à‡∫ä‡∫ç‡∫î-‡∫ó‡∫ô-‡∫ü‡∫°-‡∫£‡∫•‡∫ß‡∫™‡∫´‡∫≠-‡∫∞‡∫≤‡∫≥‡∫Ω‡ªÄ-‡ªÑ‡ªÜ‡ªú-‡ªü‡ºÄ‡ΩÄ-‡Ωá‡Ωâ-‡Ω¨‡æà-‡æå·ÄÄ-·Ä™·Äø·Åê-·Åï·Åö-·Åù·Å°·Å•·Å¶·ÅÆ-·Å∞·Åµ-·ÇÅ·Çé·Ç†-·ÉÖ·Éá·Éç·Éê-·É∫·Éº-·âà·âä-·âç·âê-·âñ·âò·âö-·âù·â†-·äà·ää-·äç·äê-·ä∞·ä≤-·äµ·ä∏-·äæ·ãÄ·ãÇ-·ãÖ·ãà-·ãñ·ãò-·åê·åí-·åï·åò-·çö·éÄ-·éè·é†-·è¥·êÅ-·ô¨·ôØ-·ôø·öÅ-·öö·ö†-·õ™·õÆ-·õ∞·úÄ-·úå·úé-·úë·ú†-·ú±·ùÄ-·ùë·ù†-·ù¨·ùÆ-·ù∞·ûÄ-·û≥·üó·üú·††-·°∑·¢Ä-·¢®·¢™·¢∞-·£µ·§Ä-·§ú·•ê-·•≠·•∞-·•¥·¶Ä-·¶´·ßÅ-·ßá·®Ä-·®ñ·®†-·©î·™ß·¨Ö-·¨≥·≠Ö-·≠ã·ÆÉ-·Æ†·ÆÆ·ÆØ·Æ∫-·Ø•·∞Ä-·∞£·±ç-·±è·±ö-·±Ω·≥©-·≥¨·≥Æ-·≥±·≥µ·≥∂·¥Ä-·∂ø·∏Ä-·ºï·ºò-·ºù·º†-·ΩÖ·Ωà-·Ωç·Ωê-·Ωó·Ωô·Ωõ·Ωù·Ωü-·ΩΩ·æÄ-·æ¥·æ∂-·æº·ææ·øÇ-·øÑ·øÜ-·øå·øê-·øì·øñ-·øõ·ø†-·ø¨·ø≤-·ø¥·ø∂-·øº‚Å±‚Åø‚Çê-‚Çú‚ÑÇ‚Ñá‚Ñä-‚Ñì‚Ñï‚Ñô-‚Ñù‚Ñ§‚Ñ¶‚Ñ®‚Ñ™-‚Ñ≠‚ÑØ-‚Ñπ‚Ñº-‚Ñø‚ÖÖ-‚Öâ‚Öé‚Ö†-‚Üà‚∞Ä-‚∞Æ‚∞∞-‚±û‚±†-‚≥§‚≥´-‚≥Æ‚≥≤‚≥≥‚¥Ä-‚¥•‚¥ß‚¥≠‚¥∞-‚µß‚µØ‚∂Ä-‚∂ñ‚∂†-‚∂¶‚∂®-‚∂Æ‚∂∞-‚∂∂‚∂∏-‚∂æ‚∑Ä-‚∑Ü‚∑à-‚∑é‚∑ê-‚∑ñ‚∑ò-‚∑û‚∏Ø„ÄÖ-„Äá„Ä°-„Ä©„Ä±-„Äµ„Ä∏-„Äº„ÅÅ-„Çñ„Çù-„Çü„Ç°-„É∫„Éº-„Éø„ÑÖ-„Ñ≠„Ñ±-„Üé„Ü†-„Ü∫„á∞-„áø„êÄ-‰∂µ‰∏Ä-ÈøåÍÄÄ-ÍíåÍìê-ÍìΩÍîÄ-ÍòåÍòê-ÍòüÍò™Íò´ÍôÄ-ÍôÆÍôø-ÍöóÍö†-ÍõØÍúó-ÍúüÍú¢-ÍûàÍûã-ÍûéÍûê-ÍûìÍû†-Íû™Íü∏-Í†ÅÍ†É-Í†ÖÍ†á-Í†äÍ†å-Í†¢Í°Ä-Í°≥Í¢Ç-Í¢≥Í£≤-Í£∑Í£ªÍ§ä-Í§•Í§∞-Í•ÜÍ•†-Í•ºÍ¶Ñ-Í¶≤ÍßèÍ®Ä-Í®®Í©Ä-Í©ÇÍ©Ñ-Í©ãÍ©†-Í©∂Í©∫Í™Ä-Í™ØÍ™±Í™µÍ™∂Í™π-Í™ΩÍ´ÄÍ´ÇÍ´õ-Í´ùÍ´†-Í´™Í´≤-Í´¥Í¨Å-Í¨ÜÍ¨â-Í¨éÍ¨ë-Í¨ñÍ¨†-Í¨¶Í¨®-Í¨ÆÍØÄ-ÍØ¢Í∞Ä-Ìû£Ìû∞-ÌüÜÌüã-ÌüªÔ§Ä-Ô©≠Ô©∞-Ô´ôÔ¨Ä-Ô¨ÜÔ¨ì-Ô¨óÔ¨ùÔ¨ü-Ô¨®Ô¨™-Ô¨∂Ô¨∏-Ô¨ºÔ¨æÔ≠ÄÔ≠ÅÔ≠ÉÔ≠ÑÔ≠Ü-ÔÆ±ÔØì-Ô¥ΩÔµê-Ô∂èÔ∂í-Ô∑áÔ∑∞-Ô∑ªÔπ∞-Ôπ¥Ôπ∂-ÔªºÔº°-Ôº∫ÔΩÅ-ÔΩöÔΩ¶-ÔææÔøÇ-ÔøáÔøä-ÔøèÔøí-ÔøóÔøö-Ôøú";var nonASCIIidentifierChars="ÃÄ-ÕØ“É-“á÷ë-÷Ω÷ø◊Å◊Ç◊Ñ◊Ö◊áÿê-ÿöÿ†-ŸâŸ≤-€ì€ß-€®€ª-€º‹∞-›ä‡†Ä-‡†î‡†õ-‡†£‡†•-‡†ß‡†©-‡†≠‡°Ä-‡°ó‡£§-‡£æ‡§Ä-‡§É‡§∫-‡§º‡§æ-‡•è‡•ë-‡•ó‡•¢-‡•£‡•¶-‡•Ø‡¶Å-‡¶É‡¶º‡¶æ-‡ßÑ‡ßá‡ßà‡ßó‡ßü-‡ß†‡®Å-‡®É‡®º‡®æ-‡©Ç‡©á‡©à‡©ã-‡©ç‡©ë‡©¶-‡©±‡©µ‡™Å-‡™É‡™º‡™æ-‡´Ö‡´á-‡´â‡´ã-‡´ç‡´¢-‡´£‡´¶-‡´Ø‡¨Å-‡¨É‡¨º‡¨æ-‡≠Ñ‡≠á‡≠à‡≠ã-‡≠ç‡≠ñ‡≠ó‡≠ü-‡≠†‡≠¶-‡≠Ø‡ÆÇ‡Ææ-‡ØÇ‡ØÜ-‡Øà‡Øä-‡Øç‡Øó‡Ø¶-‡ØØ‡∞Å-‡∞É‡±Ü-‡±à‡±ä-‡±ç‡±ï‡±ñ‡±¢-‡±£‡±¶-‡±Ø‡≤Ç‡≤É‡≤º‡≤æ-‡≥Ñ‡≥Ü-‡≥à‡≥ä-‡≥ç‡≥ï‡≥ñ‡≥¢-‡≥£‡≥¶-‡≥Ø‡¥Ç‡¥É‡µÜ-‡µà‡µó‡µ¢-‡µ£‡µ¶-‡µØ‡∂Ç‡∂É‡∑ä‡∑è-‡∑î‡∑ñ‡∑ò-‡∑ü‡∑≤‡∑≥‡∏¥-‡∏∫‡πÄ-‡πÖ‡πê-‡πô‡∫¥-‡∫π‡ªà-‡ªç‡ªê-‡ªô‡ºò‡ºô‡º†-‡º©‡ºµ‡º∑‡ºπ‡ΩÅ-‡Ωá‡Ω±-‡æÑ‡æÜ-‡æá‡æç-‡æó‡æô-‡æº‡øÜ·ÄÄ-·Ä©·ÅÄ-·Åâ·Åß-·Å≠·Å±-·Å¥·ÇÇ-·Çç·Çè-·Çù·çù-·çü·úé-·úê·ú†-·ú∞·ùÄ-·ùê·ù≤·ù≥·ûÄ-·û≤·üù·ü†-·ü©·†ã-·†ç·†ê-·†ô·§†-·§´·§∞-·§ª·•ë-·•≠·¶∞-·ßÄ·ßà-·ßâ·ßê-·ßô·®Ä-·®ï·®†-·©ì·©†-·©º·©ø-·™â·™ê-·™ô·≠Ü-·≠ã·≠ê-·≠ô·≠´-·≠≥·Æ∞-·Æπ·Ø¶-·Ø≥·∞Ä-·∞¢·±Ä-·±â·±õ-·±Ω·≥ê-·≥í·¥Ä-·∂æ·∏Å-·ºï‚Äå‚Äç‚Äø‚ÅÄ‚Åî‚Éê-‚Éú‚É°‚É•-‚É∞‚∂Å-‚∂ñ‚∑†-‚∑ø„Ä°-„Ä®„Çô„ÇöÍôÄ-Íô≠Íô¥-ÍôΩÍöüÍõ∞-Íõ±Íü∏-Í†ÄÍ†ÜÍ†ãÍ†£-Í†ßÍ¢Ä-Í¢ÅÍ¢¥-Í£ÑÍ£ê-Í£ôÍ£≥-Í£∑Í§Ä-Í§âÍ§¶-Í§≠Í§∞-Í•ÖÍ¶Ä-Í¶ÉÍ¶≥-ÍßÄÍ®Ä-Í®ßÍ©Ä-Í©ÅÍ©å-Í©çÍ©ê-Í©ôÍ©ªÍ´†-Í´©Í´≤-Í´≥ÍØÄ-ÍØ°ÍØ¨ÍØ≠ÍØ∞-ÍØπÔ¨†-Ô¨®Ô∏Ä-Ô∏èÔ∏†-Ô∏¶Ô∏≥Ô∏¥Ôπç-ÔπèÔºê-ÔºôÔºø";var nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]");var nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");exports.newline=/[\n\r\u2028\u2029]/;exports.lineBreak=new RegExp("\r\n|"+exports.newline.source);exports.allLineBreaks=new RegExp(exports.lineBreak.source,"g");exports.isIdentifierStart=function(code){if(code<65){return code===36||code===64}if(code<91){return true}if(code<97){return code===95}if(code<123){return true}return code>=170&&nonASCIIidentifierStart.test(String.fromCharCode(code))};exports.isIdentifierChar=function(code){if(code<48){return code===36}if(code<58){return true}if(code<65){return false}if(code<91){return true}if(code<97){return code===95}if(code<123){return true}return code>=170&&nonASCIIidentifier.test(String.fromCharCode(code))}},function(module,exports,__webpack_require__){var mergeOpts=__webpack_require__(3).mergeOpts;var acorn=__webpack_require__(0);var Output=__webpack_require__(4).Output;var Tokenizer=__webpack_require__(7).Tokenizer;function remove_redundant_indentation(output,frame){if(frame.multiline_frame||frame.mode===MODE.ForInitializer||frame.mode===MODE.Conditional){return}var start_index=frame.start_line_index;output.remove_indent(start_index)}function in_array(what,arr){for(var i=0;i<arr.length;i+=1){if(arr[i]===what){return true}}return false}function trim(s){return s.replace(/^\s+|\s+$/g,"")}function ltrim(s){return s.replace(/^\s+/g,"")}function generateMapFromStrings(list){var result={};for(var x=0;x<list.length;x++){result[list[x].replace(/-/g,"_")]=list[x]}return result}function sanitizeOperatorPosition(opPosition){opPosition=opPosition||OPERATOR_POSITION.before_newline;if(!in_array(opPosition,validPositionValues)){throw new Error("Invalid Option Value: The option 'operator_position' must be one of the following values\n"+validPositionValues+"\nYou passed in: '"+opPosition+"'")}return opPosition}var validPositionValues=["before-newline","after-newline","preserve-newline"];var OPERATOR_POSITION=generateMapFromStrings(validPositionValues);var OPERATOR_POSITION_BEFORE_OR_PRESERVE=[OPERATOR_POSITION.before_newline,OPERATOR_POSITION.preserve_newline];var MODE={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};function Beautifier(js_source_text,options){"use strict";var output;var tokens=[],token_pos;var tokenizer;var current_token;var last_type,last_last_text,indent_string;var flags,previous_flags,flag_store;var prefix;var handlers,opt;var baseIndentString="";handlers={TK_START_EXPR:handle_start_expr,TK_END_EXPR:handle_end_expr,TK_START_BLOCK:handle_start_block,TK_END_BLOCK:handle_end_block,TK_WORD:handle_word,TK_RESERVED:handle_word,TK_SEMICOLON:handle_semicolon,TK_STRING:handle_string,TK_EQUALS:handle_equals,TK_OPERATOR:handle_operator,TK_COMMA:handle_comma,TK_BLOCK_COMMENT:handle_block_comment,TK_COMMENT:handle_comment,TK_DOT:handle_dot,TK_UNKNOWN:handle_unknown,TK_EOF:handle_eof};function create_flags(flags_base,mode){var next_indent_level=0;if(flags_base){next_indent_level=flags_base.indentation_level;if(!output.just_added_newline()&&flags_base.line_indent_level>next_indent_level){next_indent_level=flags_base.line_indent_level}}var next_flags={mode:mode,parent:flags_base,last_text:flags_base?flags_base.last_text:"",last_word:flags_base?flags_base.last_word:"",declaration_statement:false,declaration_assignment:false,multiline_frame:false,inline_frame:false,if_block:false,else_block:false,do_block:false,do_while:false,import_block:false,in_case_statement:false,in_case:false,case_body:false,indentation_level:next_indent_level,line_indent_level:flags_base?flags_base.line_indent_level:next_indent_level,start_line_index:output.get_line_number(),ternary_depth:0};return next_flags}options=options?options:{};options=mergeOpts(options,"js");opt={};if(options.brace_style==="expand-strict"){options.brace_style="expand"}else if(options.brace_style==="collapse-preserve-inline"){options.brace_style="collapse,preserve-inline"}else if(options.braces_on_own_line!==undefined){options.brace_style=options.braces_on_own_line?"expand":"collapse"}else if(!options.brace_style){options.brace_style="collapse"}var brace_style_split=options.brace_style.split(/[^a-zA-Z0-9_\-]+/);opt.brace_style=brace_style_split[0];opt.brace_preserve_inline=brace_style_split[1]?brace_style_split[1]:false;opt.indent_size=options.indent_size?parseInt(options.indent_size,10):4;opt.indent_char=options.indent_char?options.indent_char:" ";opt.eol=options.eol?options.eol:"auto";opt.preserve_newlines=options.preserve_newlines===undefined?true:options.preserve_newlines;opt.unindent_chained_methods=options.unindent_chained_methods===undefined?false:options.unindent_chained_methods;opt.break_chained_methods=options.break_chained_methods===undefined?false:options.break_chained_methods;opt.max_preserve_newlines=options.max_preserve_newlines===undefined?0:parseInt(options.max_preserve_newlines,10);opt.space_in_paren=options.space_in_paren===undefined?false:options.space_in_paren;opt.space_in_empty_paren=options.space_in_empty_paren===undefined?false:options.space_in_empty_paren;opt.jslint_happy=options.jslint_happy===undefined?false:options.jslint_happy;opt.space_after_anon_function=options.space_after_anon_function===undefined?false:options.space_after_anon_function;opt.keep_array_indentation=options.keep_array_indentation===undefined?false:options.keep_array_indentation;opt.space_before_conditional=options.space_before_conditional===undefined?true:options.space_before_conditional;opt.unescape_strings=options.unescape_strings===undefined?false:options.unescape_strings;opt.wrap_line_length=options.wrap_line_length===undefined?0:parseInt(options.wrap_line_length,10);opt.e4x=options.e4x===undefined?false:options.e4x;opt.end_with_newline=options.end_with_newline===undefined?false:options.end_with_newline;opt.comma_first=options.comma_first===undefined?false:options.comma_first;opt.operator_position=sanitizeOperatorPosition(options.operator_position);opt.test_output_raw=options.test_output_raw===undefined?false:options.test_output_raw;if(opt.jslint_happy){opt.space_after_anon_function=true}if(options.indent_with_tabs){opt.indent_char="\t";opt.indent_size=1}if(opt.eol==="auto"){opt.eol="\n";if(js_source_text&&acorn.lineBreak.test(js_source_text||"")){opt.eol=js_source_text.match(acorn.lineBreak)[0]}}opt.eol=opt.eol.replace(/\\r/,"\r").replace(/\\n/,"\n");indent_string="";while(opt.indent_size>0){indent_string+=opt.indent_char;opt.indent_size-=1}var preindent_index=0;if(js_source_text&&js_source_text.length){while(js_source_text.charAt(preindent_index)===" "||js_source_text.charAt(preindent_index)==="\t"){preindent_index+=1}baseIndentString=js_source_text.substring(0,preindent_index);js_source_text=js_source_text.substring(preindent_index)}last_type="TK_START_BLOCK";last_last_text="";output=new Output(indent_string,baseIndentString);output.raw=opt.test_output_raw;flag_store=[];set_mode(MODE.BlockStatement);this.beautify=function(){var sweet_code;tokenizer=new Tokenizer(js_source_text,opt,indent_string);tokens=tokenizer.tokenize();token_pos=0;current_token=get_token();while(current_token){handlers[current_token.type]();last_last_text=flags.last_text;last_type=current_token.type;flags.last_text=current_token.text;token_pos+=1;current_token=get_token()}sweet_code=output.get_code(opt.end_with_newline,opt.eol);return sweet_code};function handle_whitespace_and_comments(local_token,preserve_statement_flags){var newlines=local_token.newlines;var keep_whitespace=opt.keep_array_indentation&&is_array(flags.mode);var temp_token=current_token;for(var h=0;h<local_token.comments_before.length;h++){current_token=local_token.comments_before[h];handle_whitespace_and_comments(current_token,preserve_statement_flags);handlers[current_token.type](preserve_statement_flags)}current_token=temp_token;if(keep_whitespace){for(var i=0;i<newlines;i+=1){print_newline(i>0,preserve_statement_flags)}}else{if(opt.max_preserve_newlines&&newlines>opt.max_preserve_newlines){newlines=opt.max_preserve_newlines}if(opt.preserve_newlines){if(local_token.newlines>1){print_newline(false,preserve_statement_flags);for(var j=1;j<newlines;j+=1){print_newline(true,preserve_statement_flags)}}}}}function split_linebreaks(s){s=s.replace(acorn.allLineBreaks,"\n");var out=[],idx=s.indexOf("\n");while(idx!==-1){out.push(s.substring(0,idx));s=s.substring(idx+1);idx=s.indexOf("\n")}if(s.length){out.push(s)}return out}var newline_restricted_tokens=["break","continue","return","throw","yield"];function allow_wrap_or_preserved_newline(force_linewrap){force_linewrap=force_linewrap===undefined?false:force_linewrap;if(output.just_added_newline()){return}var shouldPreserveOrForce=opt.preserve_newlines&&current_token.wanted_newline||force_linewrap;var operatorLogicApplies=in_array(flags.last_text,tokenizer.positionable_operators)||in_array(current_token.text,tokenizer.positionable_operators);if(operatorLogicApplies){var shouldPrintOperatorNewline=in_array(flags.last_text,tokenizer.positionable_operators)&&in_array(opt.operator_position,OPERATOR_POSITION_BEFORE_OR_PRESERVE)||in_array(current_token.text,tokenizer.positionable_operators);shouldPreserveOrForce=shouldPreserveOrForce&&shouldPrintOperatorNewline}if(shouldPreserveOrForce){print_newline(false,true)}else if(opt.wrap_line_length){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,newline_restricted_tokens)){return}var proposed_line_length=output.current_line.get_character_count()+current_token.text.length+(output.space_before_token?1:0);if(proposed_line_length>=opt.wrap_line_length){print_newline(false,true)}}}function print_newline(force_newline,preserve_statement_flags){if(!preserve_statement_flags){if(flags.last_text!==";"&&flags.last_text!==","&&flags.last_text!=="="&&last_type!=="TK_OPERATOR"){var next_token=get_token(1);while(flags.mode===MODE.Statement&&!(flags.if_block&&next_token&&next_token.type==="TK_RESERVED"&&next_token.text==="else")&&!flags.do_block){restore_mode()}}}if(output.add_new_line(force_newline)){flags.multiline_frame=true}}function print_token_line_indentation(){if(output.just_added_newline()){if(opt.keep_array_indentation&&is_array(flags.mode)&&current_token.wanted_newline){output.current_line.push(current_token.whitespace_before);output.space_before_token=false}else if(output.set_indent(flags.indentation_level)){flags.line_indent_level=flags.indentation_level}}}function print_token(printable_token){if(output.raw){output.add_raw_token(current_token);return}if(opt.comma_first&&last_type==="TK_COMMA"&&output.just_added_newline()){if(output.previous_line.last()===","){var popped=output.previous_line.pop();if(output.previous_line.is_empty()){output.previous_line.push(popped);output.trim(true);output.current_line.pop();output.trim()}print_token_line_indentation();output.add_token(",");output.space_before_token=true}}printable_token=printable_token||current_token.text;print_token_line_indentation();output.add_token(printable_token)}function indent(){flags.indentation_level+=1}function deindent(){if(flags.indentation_level>0&&(!flags.parent||flags.indentation_level>flags.parent.indentation_level)){flags.indentation_level-=1}}function set_mode(mode){if(flags){flag_store.push(flags);previous_flags=flags}else{previous_flags=create_flags(null,mode)}flags=create_flags(previous_flags,mode)}function is_array(mode){return mode===MODE.ArrayLiteral}function is_expression(mode){return in_array(mode,[MODE.Expression,MODE.ForInitializer,MODE.Conditional])}function restore_mode(){if(flag_store.length>0){previous_flags=flags;flags=flag_store.pop();if(previous_flags.mode===MODE.Statement&&!opt.unindent_chained_methods){remove_redundant_indentation(output,previous_flags)}}}function start_of_object_property(){return flags.parent.mode===MODE.ObjectLiteral&&flags.mode===MODE.Statement&&(flags.last_text===":"&&flags.ternary_depth===0||last_type==="TK_RESERVED"&&in_array(flags.last_text,["get","set"]))}function start_of_statement(){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,["var","let","const"])&&current_token.type==="TK_WORD"||last_type==="TK_RESERVED"&&flags.last_text==="do"||last_type==="TK_RESERVED"&&in_array(flags.last_text,newline_restricted_tokens)&&!current_token.wanted_newline||last_type==="TK_RESERVED"&&flags.last_text==="else"&&!(current_token.type==="TK_RESERVED"&&current_token.text==="if"&&!current_token.comments_before.length)||last_type==="TK_END_EXPR"&&(previous_flags.mode===MODE.ForInitializer||previous_flags.mode===MODE.Conditional)||last_type==="TK_WORD"&&flags.mode===MODE.BlockStatement&&!flags.in_case&&!(current_token.text==="--"||current_token.text==="++")&&last_last_text!=="function"&&current_token.type!=="TK_WORD"&&current_token.type!=="TK_RESERVED"||flags.mode===MODE.ObjectLiteral&&(flags.last_text===":"&&flags.ternary_depth===0||last_type==="TK_RESERVED"&&in_array(flags.last_text,["get","set"]))){set_mode(MODE.Statement);if(!opt.unindent_chained_methods){indent()}handle_whitespace_and_comments(current_token,true);if(!start_of_object_property()){allow_wrap_or_preserved_newline(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["do","for","if","while"]))}return true}return false}function all_lines_start_with(lines,c){for(var i=0;i<lines.length;i++){var line=trim(lines[i]);if(line.charAt(0)!==c){return false}}return true}function each_line_matches_indent(lines,indent){var i=0,len=lines.length,line;for(;i<len;i++){line=lines[i];if(line&&line.indexOf(indent)!==0){return false}}return true}function is_special_word(word){return in_array(word,["case","return","do","if","throw","else"])}function get_token(offset){var index=token_pos+(offset||0);return index<0||index>=tokens.length?null:tokens[index]}function handle_start_expr(){if(!start_of_statement()){handle_whitespace_and_comments(current_token)}var next_mode=MODE.Expression;if(current_token.text==="["){if(last_type==="TK_WORD"||flags.last_text===")"){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,tokenizer.line_starters)){output.space_before_token=true}set_mode(next_mode);print_token();indent();if(opt.space_in_paren){output.space_before_token=true}return}next_mode=MODE.ArrayLiteral;if(is_array(flags.mode)){if(flags.last_text==="["||flags.last_text===","&&(last_last_text==="]"||last_last_text==="}")){if(!opt.keep_array_indentation){print_newline()}}}}else{if(last_type==="TK_RESERVED"&&flags.last_text==="for"){next_mode=MODE.ForInitializer}else if(last_type==="TK_RESERVED"&&in_array(flags.last_text,["if","while"])){next_mode=MODE.Conditional}else{}}if(flags.last_text===";"||last_type==="TK_START_BLOCK"){print_newline()}else if(last_type==="TK_END_EXPR"||last_type==="TK_START_EXPR"||last_type==="TK_END_BLOCK"||flags.last_text==="."){allow_wrap_or_preserved_newline(current_token.wanted_newline)}else if(!(last_type==="TK_RESERVED"&&current_token.text==="(")&&last_type!=="TK_WORD"&&last_type!=="TK_OPERATOR"){output.space_before_token=true}else if(last_type==="TK_RESERVED"&&(flags.last_word==="function"||flags.last_word==="typeof")||flags.last_text==="*"&&(in_array(last_last_text,["function","yield"])||flags.mode===MODE.ObjectLiteral&&in_array(last_last_text,["{",","]))){if(opt.space_after_anon_function){output.space_before_token=true}}else if(last_type==="TK_RESERVED"&&(in_array(flags.last_text,tokenizer.line_starters)||flags.last_text==="catch")){if(opt.space_before_conditional){output.space_before_token=true}}if(current_token.text==="("&&last_type==="TK_RESERVED"&&in_array(flags.last_word,["await","async"])){output.space_before_token=true}if(current_token.text==="("){if(last_type==="TK_EQUALS"||last_type==="TK_OPERATOR"){if(!start_of_object_property()){allow_wrap_or_preserved_newline()}}}if(current_token.text==="("&&last_type!=="TK_WORD"&&last_type!=="TK_RESERVED"){allow_wrap_or_preserved_newline()}set_mode(next_mode);print_token();if(opt.space_in_paren){output.space_before_token=true}indent()}function handle_end_expr(){while(flags.mode===MODE.Statement){restore_mode()}handle_whitespace_and_comments(current_token);if(flags.multiline_frame){allow_wrap_or_preserved_newline(current_token.text==="]"&&is_array(flags.mode)&&!opt.keep_array_indentation)}if(opt.space_in_paren){if(last_type==="TK_START_EXPR"&&!opt.space_in_empty_paren){output.trim();output.space_before_token=false}else{output.space_before_token=true}}if(current_token.text==="]"&&opt.keep_array_indentation){print_token();restore_mode()}else{restore_mode();print_token()}remove_redundant_indentation(output,previous_flags);if(flags.do_while&&previous_flags.mode===MODE.Conditional){previous_flags.mode=MODE.Expression;flags.do_block=false;flags.do_while=false}}function handle_start_block(){handle_whitespace_and_comments(current_token);var next_token=get_token(1);var second_token=get_token(2);if(second_token&&(in_array(second_token.text,[":",","])&&in_array(next_token.type,["TK_STRING","TK_WORD","TK_RESERVED"])||in_array(next_token.text,["get","set","..."])&&in_array(second_token.type,["TK_WORD","TK_RESERVED"]))){if(!in_array(last_last_text,["class","interface"])){set_mode(MODE.ObjectLiteral)}else{set_mode(MODE.BlockStatement)}}else if(last_type==="TK_OPERATOR"&&flags.last_text==="=>"){set_mode(MODE.BlockStatement)}else if(in_array(last_type,["TK_EQUALS","TK_START_EXPR","TK_COMMA","TK_OPERATOR"])||last_type==="TK_RESERVED"&&in_array(flags.last_text,["return","throw","import","default"])){set_mode(MODE.ObjectLiteral)}else{set_mode(MODE.BlockStatement)}var empty_braces=!next_token.comments_before.length&&next_token.text==="}";var empty_anonymous_function=empty_braces&&flags.last_word==="function"&&last_type==="TK_END_EXPR";if(opt.brace_preserve_inline){var index=0;var check_token=null;flags.inline_frame=true;do{index+=1;check_token=get_token(index);if(check_token.wanted_newline){flags.inline_frame=false;break}}while(check_token.type!=="TK_EOF"&&!(check_token.type==="TK_END_BLOCK"&&check_token.opened===current_token))}if((opt.brace_style==="expand"||opt.brace_style==="none"&&current_token.wanted_newline)&&!flags.inline_frame){if(last_type!=="TK_OPERATOR"&&(empty_anonymous_function||last_type==="TK_EQUALS"||last_type==="TK_RESERVED"&&is_special_word(flags.last_text)&&flags.last_text!=="else")){output.space_before_token=true}else{print_newline(false,true)}}else{if(is_array(previous_flags.mode)&&(last_type==="TK_START_EXPR"||last_type==="TK_COMMA")){if(last_type==="TK_COMMA"||opt.space_in_paren){output.space_before_token=true}if(last_type==="TK_COMMA"||last_type==="TK_START_EXPR"&&flags.inline_frame){allow_wrap_or_preserved_newline();previous_flags.multiline_frame=previous_flags.multiline_frame||flags.multiline_frame;flags.multiline_frame=false}}if(last_type!=="TK_OPERATOR"&&last_type!=="TK_START_EXPR"){if(last_type==="TK_START_BLOCK"&&!flags.inline_frame){print_newline()}else{output.space_before_token=true}}}print_token();indent()}function handle_end_block(){handle_whitespace_and_comments(current_token);while(flags.mode===MODE.Statement){restore_mode()}var empty_braces=last_type==="TK_START_BLOCK";if(flags.inline_frame&&!empty_braces){output.space_before_token=true}else if(opt.brace_style==="expand"){if(!empty_braces){print_newline()}}else{if(!empty_braces){if(is_array(flags.mode)&&opt.keep_array_indentation){opt.keep_array_indentation=false;print_newline();opt.keep_array_indentation=true}else{print_newline()}}}restore_mode();print_token()}function handle_word(){if(current_token.type==="TK_RESERVED"){if(in_array(current_token.text,["set","get"])&&flags.mode!==MODE.ObjectLiteral){current_token.type="TK_WORD"}else if(in_array(current_token.text,["as","from"])&&!flags.import_block){current_token.type="TK_WORD"}else if(flags.mode===MODE.ObjectLiteral){var next_token=get_token(1);if(next_token.text===":"){current_token.type="TK_WORD"}}}if(start_of_statement()){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,["var","let","const"])&&current_token.type==="TK_WORD"){flags.declaration_statement=true}}else if(current_token.wanted_newline&&!is_expression(flags.mode)&&(last_type!=="TK_OPERATOR"||(flags.last_text==="--"||flags.last_text==="++"))&&last_type!=="TK_EQUALS"&&(opt.preserve_newlines||!(last_type==="TK_RESERVED"&&in_array(flags.last_text,["var","let","const","set","get"])))){handle_whitespace_and_comments(current_token);print_newline()}else{handle_whitespace_and_comments(current_token)}if(flags.do_block&&!flags.do_while){if(current_token.type==="TK_RESERVED"&&current_token.text==="while"){output.space_before_token=true;print_token();output.space_before_token=true;flags.do_while=true;return}else{print_newline();flags.do_block=false}}if(flags.if_block){if(!flags.else_block&&(current_token.type==="TK_RESERVED"&&current_token.text==="else")){flags.else_block=true}else{while(flags.mode===MODE.Statement){restore_mode()}flags.if_block=false;flags.else_block=false}}if(current_token.type==="TK_RESERVED"&&(current_token.text==="case"||current_token.text==="default"&&flags.in_case_statement)){print_newline();if(flags.case_body||opt.jslint_happy){deindent();flags.case_body=false}print_token();flags.in_case=true;flags.in_case_statement=true;return}if(last_type==="TK_COMMA"||last_type==="TK_START_EXPR"||last_type==="TK_EQUALS"||last_type==="TK_OPERATOR"){if(!start_of_object_property()){allow_wrap_or_preserved_newline()}}if(current_token.type==="TK_RESERVED"&&current_token.text==="function"){if(in_array(flags.last_text,["}",";"])||output.just_added_newline()&&!(in_array(flags.last_text,["(","[","{",":","=",","])||last_type==="TK_OPERATOR")){if(!output.just_added_blankline()&&!current_token.comments_before.length){print_newline();print_newline(true)}}if(last_type==="TK_RESERVED"||last_type==="TK_WORD"){if(last_type==="TK_RESERVED"&&(in_array(flags.last_text,["get","set","new","export","async"])||in_array(flags.last_text,newline_restricted_tokens))){output.space_before_token=true}else if(last_type==="TK_RESERVED"&&flags.last_text==="default"&&last_last_text==="export"){output.space_before_token=true}else{print_newline()}}else if(last_type==="TK_OPERATOR"||flags.last_text==="="){output.space_before_token=true}else if(!flags.multiline_frame&&(is_expression(flags.mode)||is_array(flags.mode))){}else{print_newline()}print_token();flags.last_word=current_token.text;return}prefix="NONE";if(last_type==="TK_END_BLOCK"){if(previous_flags.inline_frame){prefix="SPACE"}else if(!(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["else","catch","finally","from"]))){prefix="NEWLINE"}else{if(opt.brace_style==="expand"||opt.brace_style==="end-expand"||opt.brace_style==="none"&&current_token.wanted_newline){prefix="NEWLINE"}else{prefix="SPACE";output.space_before_token=true}}}else if(last_type==="TK_SEMICOLON"&&flags.mode===MODE.BlockStatement){prefix="NEWLINE"}else if(last_type==="TK_SEMICOLON"&&is_expression(flags.mode)){prefix="SPACE"}else if(last_type==="TK_STRING"){prefix="NEWLINE"}else if(last_type==="TK_RESERVED"||last_type==="TK_WORD"||flags.last_text==="*"&&(in_array(last_last_text,["function","yield"])||flags.mode===MODE.ObjectLiteral&&in_array(last_last_text,["{",","]))){prefix="SPACE"}else if(last_type==="TK_START_BLOCK"){if(flags.inline_frame){prefix="SPACE"}else{prefix="NEWLINE"}}else if(last_type==="TK_END_EXPR"){output.space_before_token=true;prefix="NEWLINE"}if(current_token.type==="TK_RESERVED"&&in_array(current_token.text,tokenizer.line_starters)&&flags.last_text!==")"){if(flags.inline_frame||flags.last_text==="else"||flags.last_text==="export"){prefix="SPACE"}else{prefix="NEWLINE"}}if(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["else","catch","finally"])){if((!(last_type==="TK_END_BLOCK"&&previous_flags.mode===MODE.BlockStatement)||opt.brace_style==="expand"||opt.brace_style==="end-expand"||opt.brace_style==="none"&&current_token.wanted_newline)&&!flags.inline_frame){print_newline()}else{output.trim(true);var line=output.current_line;if(line.last()!=="}"){print_newline()}output.space_before_token=true}}else if(prefix==="NEWLINE"){if(last_type==="TK_RESERVED"&&is_special_word(flags.last_text)){output.space_before_token=true}else if(last_type!=="TK_END_EXPR"){if((last_type!=="TK_START_EXPR"||!(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["var","let","const"])))&&flags.last_text!==":"){if(current_token.type==="TK_RESERVED"&&current_token.text==="if"&&flags.last_text==="else"){output.space_before_token=true}else{print_newline()}}}else if(current_token.type==="TK_RESERVED"&&in_array(current_token.text,tokenizer.line_starters)&&flags.last_text!==")"){print_newline()}}else if(flags.multiline_frame&&is_array(flags.mode)&&flags.last_text===","&&last_last_text==="}"){print_newline()}else if(prefix==="SPACE"){output.space_before_token=true}print_token();flags.last_word=current_token.text;if(current_token.type==="TK_RESERVED"){if(current_token.text==="do"){flags.do_block=true}else if(current_token.text==="if"){flags.if_block=true}else if(current_token.text==="import"){flags.import_block=true}else if(flags.import_block&&current_token.type==="TK_RESERVED"&&current_token.text==="from"){flags.import_block=false}}}function handle_semicolon(){if(start_of_statement()){output.space_before_token=false}else{handle_whitespace_and_comments(current_token)}var next_token=get_token(1);while(flags.mode===MODE.Statement&&!(flags.if_block&&next_token&&next_token.type==="TK_RESERVED"&&next_token.text==="else")&&!flags.do_block){restore_mode()}if(flags.import_block){flags.import_block=false}print_token()}function handle_string(){if(start_of_statement()){output.space_before_token=true}else{handle_whitespace_and_comments(current_token);if(last_type==="TK_RESERVED"||last_type==="TK_WORD"||flags.inline_frame){output.space_before_token=true}else if(last_type==="TK_COMMA"||last_type==="TK_START_EXPR"||last_type==="TK_EQUALS"||last_type==="TK_OPERATOR"){if(!start_of_object_property()){allow_wrap_or_preserved_newline()}}else{print_newline()}}print_token()}function handle_equals(){if(start_of_statement()){}else{handle_whitespace_and_comments(current_token)}if(flags.declaration_statement){flags.declaration_assignment=true}output.space_before_token=true;print_token();output.space_before_token=true}function handle_comma(){handle_whitespace_and_comments(current_token,true);print_token();output.space_before_token=true;if(flags.declaration_statement){if(is_expression(flags.parent.mode)){flags.declaration_assignment=false}if(flags.declaration_assignment){flags.declaration_assignment=false;print_newline(false,true)}else if(opt.comma_first){allow_wrap_or_preserved_newline()}}else if(flags.mode===MODE.ObjectLiteral||flags.mode===MODE.Statement&&flags.parent.mode===MODE.ObjectLiteral){if(flags.mode===MODE.Statement){restore_mode()}if(!flags.inline_frame){print_newline()}}else if(opt.comma_first){allow_wrap_or_preserved_newline()}}function handle_operator(){var isGeneratorAsterisk=current_token.text==="*"&&(last_type==="TK_RESERVED"&&in_array(flags.last_text,["function","yield"])||in_array(last_type,["TK_START_BLOCK","TK_COMMA","TK_END_BLOCK","TK_SEMICOLON"]));var isUnary=in_array(current_token.text,["-","+"])&&(in_array(last_type,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||in_array(flags.last_text,tokenizer.line_starters)||flags.last_text===",");if(start_of_statement()){}else{var preserve_statement_flags=!isGeneratorAsterisk;handle_whitespace_and_comments(current_token,preserve_statement_flags)}if(last_type==="TK_RESERVED"&&is_special_word(flags.last_text)){output.space_before_token=true;print_token();return}if(current_token.text==="*"&&last_type==="TK_DOT"){print_token();return}if(current_token.text==="::"){print_token();return}if(last_type==="TK_OPERATOR"&&in_array(opt.operator_position,OPERATOR_POSITION_BEFORE_OR_PRESERVE)){allow_wrap_or_preserved_newline()}if(current_token.text===":"&&flags.in_case){flags.case_body=true;indent();print_token();print_newline();flags.in_case=false;return}var space_before=true;var space_after=true;var in_ternary=false;if(current_token.text===":"){if(flags.ternary_depth===0){space_before=false}else{flags.ternary_depth-=1;in_ternary=true}}else if(current_token.text==="?"){flags.ternary_depth+=1}if(!isUnary&&!isGeneratorAsterisk&&opt.preserve_newlines&&in_array(current_token.text,tokenizer.positionable_operators)){var isColon=current_token.text===":";var isTernaryColon=isColon&&in_ternary;var isOtherColon=isColon&&!in_ternary;switch(opt.operator_position){case OPERATOR_POSITION.before_newline:output.space_before_token=!isOtherColon;print_token();if(!isColon||isTernaryColon){allow_wrap_or_preserved_newline()}output.space_before_token=true;return;case OPERATOR_POSITION.after_newline:output.space_before_token=true;if(!isColon||isTernaryColon){if(get_token(1).wanted_newline){print_newline(false,true)}else{allow_wrap_or_preserved_newline()}}else{output.space_before_token=false}print_token();output.space_before_token=true;return;case OPERATOR_POSITION.preserve_newline:if(!isOtherColon){allow_wrap_or_preserved_newline()}space_before=!(output.just_added_newline()||isOtherColon);output.space_before_token=space_before;print_token();output.space_before_token=true;return}}if(isGeneratorAsterisk){allow_wrap_or_preserved_newline();space_before=false;var next_token=get_token(1);space_after=next_token&&in_array(next_token.type,["TK_WORD","TK_RESERVED"])}else if(current_token.text==="..."){allow_wrap_or_preserved_newline();space_before=last_type==="TK_START_BLOCK";space_after=false}else if(in_array(current_token.text,["--","++","!","~"])||isUnary){space_before=false;space_after=false;if(current_token.wanted_newline&&(current_token.text==="--"||current_token.text==="++")){print_newline(false,true)}if(flags.last_text===";"&&is_expression(flags.mode)){space_before=true}if(last_type==="TK_RESERVED"){space_before=true}else if(last_type==="TK_END_EXPR"){space_before=!(flags.last_text==="]"&&(current_token.text==="--"||current_token.text==="++"))}else if(last_type==="TK_OPERATOR"){space_before=in_array(current_token.text,["--","-","++","+"])&&in_array(flags.last_text,["--","-","++","+"]);if(in_array(current_token.text,["+","-"])&&in_array(flags.last_text,["--","++"])){space_after=true}}if((flags.mode===MODE.BlockStatement&&!flags.inline_frame||flags.mode===MODE.Statement)&&(flags.last_text==="{"||flags.last_text===";")){print_newline()}}output.space_before_token=output.space_before_token||space_before;print_token();output.space_before_token=space_after}function handle_block_comment(preserve_statement_flags){if(output.raw){output.add_raw_token(current_token);if(current_token.directives&&current_token.directives.preserve==="end"){output.raw=opt.test_output_raw}return}if(current_token.directives){print_newline(false,preserve_statement_flags);print_token();if(current_token.directives.preserve==="start"){output.raw=true}print_newline(false,true);return}if(!acorn.newline.test(current_token.text)&&!current_token.wanted_newline){output.space_before_token=true;print_token();output.space_before_token=true;return}var lines=split_linebreaks(current_token.text);var j;var javadoc=false;var starless=false;var lastIndent=current_token.whitespace_before;var lastIndentLength=lastIndent.length;print_newline(false,preserve_statement_flags);if(lines.length>1){javadoc=all_lines_start_with(lines.slice(1),"*");starless=each_line_matches_indent(lines.slice(1),lastIndent)}print_token(lines[0]);for(j=1;j<lines.length;j++){print_newline(false,true);if(javadoc){print_token(" "+ltrim(lines[j]))}else if(starless&&lines[j].length>lastIndentLength){print_token(lines[j].substring(lastIndentLength))}else{output.add_token(lines[j])}}print_newline(false,preserve_statement_flags)}function handle_comment(preserve_statement_flags){if(current_token.wanted_newline){print_newline(false,preserve_statement_flags)}else{output.trim(true)}output.space_before_token=true;print_token();print_newline(false,preserve_statement_flags)}function handle_dot(){if(start_of_statement()){}else{handle_whitespace_and_comments(current_token,true)}if(last_type==="TK_RESERVED"&&is_special_word(flags.last_text)){output.space_before_token=true}else{allow_wrap_or_preserved_newline(flags.last_text===")"&&opt.break_chained_methods)}print_token()}function handle_unknown(preserve_statement_flags){print_token();if(current_token.text[current_token.text.length-1]==="\n"){print_newline(false,preserve_statement_flags)}}function handle_eof(){while(flags.mode===MODE.Statement){restore_mode()}handle_whitespace_and_comments(current_token)}}module.exports.Beautifier=Beautifier},function(module,exports){function InputScanner(input){var _input=input;var _input_length=_input.length;var _position=0;this.back=function(){_position-=1};this.hasNext=function(){return _position<_input_length};this.next=function(){var val=null;if(this.hasNext()){val=_input.charAt(_position);_position+=1}return val};this.peek=function(index){var val=null;index=index||0;index+=_position;if(index>=0&&index<_input_length){val=_input.charAt(index)}return val};this.peekCharCode=function(index){var val=0;index=index||0;index+=_position;if(index>=0&&index<_input_length){val=_input.charCodeAt(index)}return val};this.test=function(pattern,index){index=index||0;pattern.lastIndex=_position+index;return pattern.test(_input)};this.testChar=function(pattern,index){var val=this.peek(index);return val!==null&&pattern.test(val)};this.match=function(pattern){pattern.lastIndex=_position;var pattern_match=pattern.exec(_input);if(pattern_match&&pattern_match.index===_position){_position+=pattern_match[0].length}else{pattern_match=null}return pattern_match}}module.exports.InputScanner=InputScanner},function(module,exports){function mergeOpts(allOptions,targetType){var finalOpts={};var name;for(name in allOptions){if(name!==targetType){finalOpts[name]=allOptions[name]}}if(targetType in allOptions){for(name in allOptions[targetType]){finalOpts[name]=allOptions[targetType][name]}}return finalOpts}module.exports.mergeOpts=mergeOpts},function(module,exports){function OutputLine(parent){var _character_count=0;var _indent_count=-1;var _items=[];var _empty=true;this.set_indent=function(level){_character_count=parent.baseIndentLength+level*parent.indent_length;_indent_count=level};this.get_character_count=function(){return _character_count};this.is_empty=function(){return _empty};this.last=function(){if(!this._empty){return _items[_items.length-1]}else{return null}};this.push=function(input){_items.push(input);_character_count+=input.length;_empty=false};this.pop=function(){var item=null;if(!_empty){item=_items.pop();_character_count-=item.length;_empty=_items.length===0}return item};this.remove_indent=function(){if(_indent_count>0){_indent_count-=1;_character_count-=parent.indent_length}};this.trim=function(){while(this.last()===" "){_items.pop();_character_count-=1}_empty=_items.length===0};this.toString=function(){var result="";if(!this._empty){if(_indent_count>=0){result=parent.indent_cache[_indent_count]}result+=_items.join("")}return result}}function Output(indent_string,baseIndentString){baseIndentString=baseIndentString||"";this.indent_cache=[baseIndentString];this.baseIndentLength=baseIndentString.length;this.indent_length=indent_string.length;this.raw=false;var lines=[];this.baseIndentString=baseIndentString;this.indent_string=indent_string;this.previous_line=null;this.current_line=null;this.space_before_token=false;this.add_outputline=function(){this.previous_line=this.current_line;this.current_line=new OutputLine(this);lines.push(this.current_line)};this.add_outputline();this.get_line_number=function(){return lines.length};this.add_new_line=function(force_newline){if(this.get_line_number()===1&&this.just_added_newline()){return false}if(force_newline||!this.just_added_newline()){if(!this.raw){this.add_outputline()}return true}return false};this.get_code=function(end_with_newline,eol){var sweet_code=lines.join("\n").replace(/[\r\n\t ]+$/,"");if(end_with_newline){sweet_code+="\n"}if(eol!=="\n"){sweet_code=sweet_code.replace(/[\n]/g,eol)}return sweet_code};this.set_indent=function(level){if(lines.length>1){while(level>=this.indent_cache.length){this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string)}this.current_line.set_indent(level);return true}this.current_line.set_indent(0);return false};this.add_raw_token=function(token){for(var x=0;x<token.newlines;x++){this.add_outputline()}this.current_line.push(token.whitespace_before);this.current_line.push(token.text);this.space_before_token=false};this.add_token=function(printable_token){this.add_space_before_token();this.current_line.push(printable_token)};this.add_space_before_token=function(){if(this.space_before_token&&!this.just_added_newline()){this.current_line.push(" ")}this.space_before_token=false};this.remove_indent=function(index){var output_length=lines.length;while(index<output_length){lines[index].remove_indent();index++}};this.trim=function(eat_newlines){eat_newlines=eat_newlines===undefined?false:eat_newlines;this.current_line.trim(indent_string,baseIndentString);while(eat_newlines&&lines.length>1&&this.current_line.is_empty()){lines.pop();this.current_line=lines[lines.length-1];this.current_line.trim()}this.previous_line=lines.length>1?lines[lines.length-2]:null};this.just_added_newline=function(){return this.current_line.is_empty()};this.just_added_blankline=function(){if(this.just_added_newline()){if(lines.length===1){return true}var line=lines[lines.length-2];return line.is_empty()}return false}}module.exports.Output=Output},function(module,exports){function Token(type,text,newlines,whitespace_before,parent){this.type=type;this.text=text;this.comments_before=[];this.comments_after=[];this.newlines=newlines||0;this.wanted_newline=newlines>0;this.whitespace_before=whitespace_before||"";this.parent=parent||null;this.opened=null;this.directives=null}module.exports.Token=Token},function(module,exports,__webpack_require__){var Beautifier=__webpack_require__(1).Beautifier;function js_beautify(js_source_text,options){var beautifier=new Beautifier(js_source_text,options);return beautifier.beautify()}module.exports=js_beautify},function(module,exports,__webpack_require__){var InputScanner=__webpack_require__(2).InputScanner;var Token=__webpack_require__(5).Token;var acorn=__webpack_require__(0);function trim(s){return s.replace(/^\s+|\s+$/g,"")}function in_array(what,arr){for(var i=0;i<arr.length;i+=1){if(arr[i]===what){return true}}return false}function Tokenizer(input_string,opts){var whitespace="\n\r\t ".split("");var digit=/[0-9]/;var digit_bin=/[01]/;var digit_oct=/[01234567]/;var digit_hex=/[0123456789abcdefABCDEF]/;this.positionable_operators="!= !== % & && * ** + - / : < << <= == === > >= >> >>> ? ^ | ||".split(" ");var punct=this.positionable_operators.concat("! %= &= *= **= ++ += , -- -= /= :: <<= = => >>= >>>= ^= |= ~ ...".split(" "));this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(",");var reserved_words=this.line_starters.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as"]);var block_comment_pattern=/([\s\S]*?)((?:\*\/)|$)/g;var comment_pattern=/([^\n\r\u2028\u2029]*)/g;var directives_block_pattern=/\/\* beautify( \w+[:]\w+)+ \*\//g;var directive_pattern=/ (\w+)[:](\w+)/g;var directives_end_ignore_pattern=/([\s\S]*?)((?:\/\*\sbeautify\signore:end\s\*\/)|$)/g;var template_pattern=/((<\?php|<\?=)[\s\S]*?\?>)|(<%[\s\S]*?%>)/g;var n_newlines,whitespace_before_token,in_html_comment,tokens;var input;this.tokenize=function(){input=new InputScanner(input_string);in_html_comment=false;tokens=[];var next,last;var token_values;var open=null;var open_stack=[];var comments=[];while(!(last&&last.type==="TK_EOF")){token_values=tokenize_next();next=new Token(token_values[1],token_values[0],n_newlines,whitespace_before_token);while(next.type==="TK_COMMENT"||next.type==="TK_BLOCK_COMMENT"||next.type==="TK_UNKNOWN"){if(next.type==="TK_BLOCK_COMMENT"){next.directives=token_values[2]}comments.push(next);token_values=tokenize_next();next=new Token(token_values[1],token_values[0],n_newlines,whitespace_before_token)}if(comments.length){next.comments_before=comments;comments=[]}if(next.type==="TK_START_BLOCK"||next.type==="TK_START_EXPR"){next.parent=last;open_stack.push(open);open=next}else if((next.type==="TK_END_BLOCK"||next.type==="TK_END_EXPR")&&(open&&(next.text==="]"&&open.text==="["||next.text===")"&&open.text==="("||next.text==="}"&&open.text==="{"))){next.parent=open.parent;next.opened=open;open=open_stack.pop()}tokens.push(next);last=next}return tokens};function get_directives(text){if(!text.match(directives_block_pattern)){return null}var directives={};directive_pattern.lastIndex=0;var directive_match=directive_pattern.exec(text);while(directive_match){directives[directive_match[1]]=directive_match[2];directive_match=directive_pattern.exec(text)}return directives}function tokenize_next(){var resulting_string;var whitespace_on_this_line=[];n_newlines=0;whitespace_before_token="";var c=input.next();if(c===null){return["","TK_EOF"]}var last_token;if(tokens.length){last_token=tokens[tokens.length-1]}else{last_token=new Token("TK_START_BLOCK","{")}while(in_array(c,whitespace)){if(acorn.newline.test(c)){if(!(c==="\n"&&input.peek(-2)==="\r")){n_newlines+=1;whitespace_on_this_line=[]}}else{whitespace_on_this_line.push(c)}c=input.next();if(c===null){return["","TK_EOF"]}}if(whitespace_on_this_line.length){whitespace_before_token=whitespace_on_this_line.join("")}if(digit.test(c)||c==="."&&input.testChar(digit)){var allow_decimal=true;var allow_e=true;var local_digit=digit;if(c==="0"&&input.testChar(/[XxOoBb]/)){allow_decimal=false;allow_e=false;if(input.testChar(/[Bb]/)){local_digit=digit_bin}else if(input.testChar(/[Oo]/)){local_digit=digit_oct}else{local_digit=digit_hex}c+=input.next()}else if(c==="."){allow_decimal=false}else{c="";input.back()}while(input.testChar(local_digit)){c+=input.next();if(allow_decimal&&input.peek()==="."){c+=input.next();allow_decimal=false}if(allow_e&&input.testChar(/[Ee]/)){c+=input.next();if(input.testChar(/[+-]/)){c+=input.next()}allow_e=false;allow_decimal=false}}return[c,"TK_WORD"]}if(acorn.isIdentifierStart(input.peekCharCode(-1))){if(input.hasNext()){while(acorn.isIdentifierChar(input.peekCharCode())){c+=input.next();if(!input.hasNext()){break}}}if(!(last_token.type==="TK_DOT"||last_token.type==="TK_RESERVED"&&in_array(last_token.text,["set","get"]))&&in_array(c,reserved_words)){if(c==="in"||c==="of"){return[c,"TK_OPERATOR"]}return[c,"TK_RESERVED"]}return[c,"TK_WORD"]}if(c==="("||c==="["){return[c,"TK_START_EXPR"]}if(c===")"||c==="]"){return[c,"TK_END_EXPR"]}if(c==="{"){return[c,"TK_START_BLOCK"]}if(c==="}"){return[c,"TK_END_BLOCK"]}if(c===";"){return[c,"TK_SEMICOLON"]}if(c==="/"){var comment="";var comment_match;if(input.peek()==="*"){input.next();comment_match=input.match(block_comment_pattern);comment="/*"+comment_match[0];var directives=get_directives(comment);if(directives&&directives.ignore==="start"){comment_match=input.match(directives_end_ignore_pattern);comment+=comment_match[0]}comment=comment.replace(acorn.allLineBreaks,"\n");return[comment,"TK_BLOCK_COMMENT",directives]}if(input.peek()==="/"){input.next();comment_match=input.match(comment_pattern);comment="//"+comment_match[0];return[comment,"TK_COMMENT"]}}var startXmlRegExp=/<()([-a-zA-Z:0-9_.]+|{[\s\S]+?}|!\[CDATA\[[\s\S]*?\]\])(\s+{[\s\S]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{[\s\S]+?}))*\s*(\/?)\s*>/g;if(c==="`"||c==="'"||c==='"'||(c==="/"||opts.e4x&&c==="<"&&input.test(startXmlRegExp,-1))&&(last_token.type==="TK_RESERVED"&&in_array(last_token.text,["return","case","throw","else","do","typeof","yield"])||last_token.type==="TK_END_EXPR"&&last_token.text===")"&&last_token.parent&&last_token.parent.type==="TK_RESERVED"&&in_array(last_token.parent.text,["if","while","for"])||in_array(last_token.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var sep=c,esc=false,has_char_escapes=false;resulting_string=c;if(sep==="/"){var in_char_class=false;while(input.hasNext()&&((esc||in_char_class||input.peek()!==sep)&&!input.testChar(acorn.newline))){resulting_string+=input.peek();if(!esc){esc=input.peek()==="\\";if(input.peek()==="["){in_char_class=true}else if(input.peek()==="]"){in_char_class=false}}else{esc=false}input.next()}}else if(opts.e4x&&sep==="<"){var xmlRegExp=/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[\s\S]+?}|!\[CDATA\[[\s\S]*?\]\])(\s+{[\s\S]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{[\s\S]+?}))*\s*(\/?)\s*>/g;input.back();var xmlStr="";var match=input.match(startXmlRegExp);if(match){var rootTag=match[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}");var isCurlyRoot=rootTag.indexOf("{")===0;var depth=0;while(match){var isEndTag=!!match[1];var tagName=match[2];var isSingletonTag=!!match[match.length-1]||tagName.slice(0,8)==="![CDATA[";if(!isSingletonTag&&(tagName===rootTag||isCurlyRoot&&tagName.replace(/^{\s+/,"{").replace(/\s+}$/,"}"))){if(isEndTag){--depth}else{++depth}}xmlStr+=match[0];if(depth<=0){break}match=input.match(xmlRegExp)}if(!match){xmlStr+=input.match(/[\s\S]*/g)[0]}xmlStr=xmlStr.replace(acorn.allLineBreaks,"\n");return[xmlStr,"TK_STRING"]}}else{var parse_string=function(delimiter,allow_unescaped_newlines,start_sub){var current_char;while(input.hasNext()){current_char=input.peek();if(!(esc||current_char!==delimiter&&(allow_unescaped_newlines||!acorn.newline.test(current_char)))){break}if((esc||allow_unescaped_newlines)&&acorn.newline.test(current_char)){if(current_char==="\r"&&input.peek(1)==="\n"){input.next();current_char=input.peek()}resulting_string+="\n"}else{resulting_string+=current_char}if(esc){if(current_char==="x"||current_char==="u"){has_char_escapes=true}esc=false}else{esc=current_char==="\\"}input.next();if(start_sub&&resulting_string.indexOf(start_sub,resulting_string.length-start_sub.length)!==-1){if(delimiter==="`"){parse_string("}",allow_unescaped_newlines,"`")}else{parse_string("`",allow_unescaped_newlines,"${")}if(input.hasNext()){resulting_string+=input.next()}}}};if(sep==="`"){parse_string("`",true,"${")}else{parse_string(sep)}}if(has_char_escapes&&opts.unescape_strings){resulting_string=unescape_string(resulting_string)}if(input.peek()===sep){resulting_string+=sep;input.next();if(sep==="/"){while(input.hasNext()&&acorn.isIdentifierStart(input.peekCharCode())){resulting_string+=input.next()}}}return[resulting_string,"TK_STRING"]}if(c==="#"){if(tokens.length===0&&input.peek()==="!"){resulting_string=c;while(input.hasNext()&&c!=="\n"){c=input.next();resulting_string+=c}return[trim(resulting_string)+"\n","TK_UNKNOWN"]}var sharp="#";if(input.hasNext()&&input.testChar(digit)){do{c=input.next();sharp+=c}while(input.hasNext()&&c!=="#"&&c!=="=");if(c==="#"){}else if(input.peek()==="["&&input.peek(1)==="]"){sharp+="[]";input.next();input.next()}else if(input.peek()==="{"&&input.peek(1)==="}"){sharp+="{}";input.next();input.next()}return[sharp,"TK_WORD"]}}if(c==="<"&&(input.peek()==="?"||input.peek()==="%")){input.back();var template_match=input.match(template_pattern);if(template_match){c=template_match[0];c=c.replace(acorn.allLineBreaks,"\n");return[c,"TK_STRING"]}}if(c==="<"&&input.match(/\!--/g)){c="\x3c!--";while(input.hasNext()&&!input.testChar(acorn.newline)){c+=input.next()}in_html_comment=true;return[c,"TK_COMMENT"]}if(c==="-"&&in_html_comment&&input.match(/->/g)){in_html_comment=false;return["--\x3e","TK_COMMENT"]}if(c==="."){if(input.peek()==="."&&input.peek(1)==="."){c+=input.next()+input.next();return[c,"TK_OPERATOR"]}return[c,"TK_DOT"]}if(in_array(c,punct)){while(input.hasNext()&&in_array(c+input.peek(),punct)){c+=input.next();if(!input.hasNext()){break}}if(c===","){return[c,"TK_COMMA"]}else if(c==="="){return[c,"TK_EQUALS"]}else{return[c,"TK_OPERATOR"]}}return[c,"TK_UNKNOWN"]}function unescape_string(s){var out="",escaped=0;var input_scan=new InputScanner(s);var matched=null;while(input_scan.hasNext()){matched=input_scan.match(/([\s]|[^\\]|\\\\)+/g);if(matched){out+=matched[0]}if(input_scan.peek()==="\\"){input_scan.next();if(input_scan.peek()==="x"){matched=input_scan.match(/x([0-9A-Fa-f]{2})/g)}else if(input_scan.peek()==="u"){matched=input_scan.match(/u([0-9A-Fa-f]{4})/g)}else{out+="\\";if(input_scan.hasNext()){out+=input_scan.next()}continue}if(!matched){return s}escaped=parseInt(matched[1],16);if(escaped>126&&escaped<=255&&matched[0].indexOf("x")===0){return s}else if(escaped>=0&&escaped<32){out+="\\"+matched[0];continue}else if(escaped===34||escaped===39||escaped===92){out+="\\"+String.fromCharCode(escaped)}else{out+=String.fromCharCode(escaped)}}}return out}}module.exports.Tokenizer=Tokenizer}]);var js_beautify=legacy_beautify_js;if(typeof undefined==="function"&&undefined.amd){undefined([],function(){return{js_beautify:js_beautify}})}else{exports.js_beautify=js_beautify}})()});unwrapExports(beautify);var beautifyCss=createCommonjsModule(function(module,exports){(function(){var legacy_beautify_css=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.i=function(value){return value};__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=4)}([function(module,exports,__webpack_require__){var mergeOpts=__webpack_require__(2).mergeOpts;var acorn=__webpack_require__(1);var Output=__webpack_require__(3).Output;var lineBreak=acorn.lineBreak;var allLineBreaks=acorn.allLineBreaks;function Beautifier(source_text,options){options=options||{};options=mergeOpts(options,"css");source_text=source_text||"";var newlinesFromLastWSEat=0;var indentSize=options.indent_size?parseInt(options.indent_size,10):4;var indentCharacter=options.indent_char||" ";var preserve_newlines=options.preserve_newlines===undefined?false:options.preserve_newlines;var selectorSeparatorNewline=options.selector_separator_newline===undefined?true:options.selector_separator_newline;var end_with_newline=options.end_with_newline===undefined?false:options.end_with_newline;var newline_between_rules=options.newline_between_rules===undefined?true:options.newline_between_rules;var space_around_combinator=options.space_around_combinator===undefined?false:options.space_around_combinator;space_around_combinator=space_around_combinator||(options.space_around_selector_separator===undefined?false:options.space_around_selector_separator);var eol=options.eol?options.eol:"auto";if(options.indent_with_tabs){indentCharacter="\t";indentSize=1}if(eol==="auto"){eol="\n";if(source_text&&lineBreak.test(source_text||"")){eol=source_text.match(lineBreak)[0]}}eol=eol.replace(/\\r/,"\r").replace(/\\n/,"\n");source_text=source_text.replace(allLineBreaks,"\n");var whiteRe=/^\s+$/;var pos=-1,ch;var parenLevel=0;function next(){ch=source_text.charAt(++pos);return ch||""}function peek(skipWhitespace){var result="";var prev_pos=pos;if(skipWhitespace){eatWhitespace()}result=source_text.charAt(pos+1)||"";pos=prev_pos-1;next();return result}function eatString(endChars){var start=pos;while(next()){if(ch==="\\"){next()}else if(endChars.indexOf(ch)!==-1){break}else if(ch==="\n"){break}}return source_text.substring(start,pos+1)}function peekString(endChar){var prev_pos=pos;var str=eatString(endChar);pos=prev_pos-1;next();return str}function eatWhitespace(preserve_newlines_local){var result=0;while(whiteRe.test(peek())){next();if(ch==="\n"&&preserve_newlines_local&&preserve_newlines){output.add_new_line(true);result++}}newlinesFromLastWSEat=result;return result}function skipWhitespace(){var result="";if(ch&&whiteRe.test(ch)){result=ch}while(whiteRe.test(next())){result+=ch}return result}function eatComment(){var start=pos;var singleLine=peek()==="/";next();while(next()){if(!singleLine&&ch==="*"&&peek()==="/"){next();break}else if(singleLine&&ch==="\n"){return source_text.substring(start,pos)}}return source_text.substring(start,pos)+ch}function lookBack(str){return source_text.substring(pos-str.length,pos).toLowerCase()===str}function foundNestedPseudoClass(){var openParen=0;for(var i=pos+1;i<source_text.length;i++){var ch=source_text.charAt(i);if(ch==="{"){return true}else if(ch==="("){openParen+=1}else if(ch===")"){if(openParen===0){return false}openParen-=1}else if(ch===";"||ch==="}"){return false}}return false}var baseIndentString="";var preindent_index=0;if(source_text&&source_text.length){while(source_text.charAt(preindent_index)===" "||source_text.charAt(preindent_index)==="\t"){preindent_index+=1}baseIndentString=source_text.substring(0,preindent_index);js_source_text=source_text.substring(preindent_index)}var singleIndent=new Array(indentSize+1).join(indentCharacter);var indentLevel;var nestedLevel;var output;function print_string(output_string){if(output.just_added_newline()){output.set_indent(indentLevel)}output.add_token(output_string)}function preserveSingleSpace(isAfterSpace){if(isAfterSpace){output.space_before_token=true}}function indent(){indentLevel++}function outdent(){if(indentLevel>0){indentLevel--}}this.beautify=function(){output=new Output(singleIndent,baseIndentString);indentLevel=0;nestedLevel=0;pos=-1;ch=null;parenLevel=0;var insideRule=false;var insidePropertyValue=false;var enteringConditionalGroup=false;var top_ch="";var last_top_ch="";while(true){var whitespace=skipWhitespace();var isAfterSpace=whitespace!=="";var isAfterNewline=whitespace.indexOf("\n")!==-1;last_top_ch=top_ch;top_ch=ch;if(!ch){break}else if(ch==="/"&&peek()==="*"){var header=indentLevel===0;if(isAfterNewline||header){output.add_new_line()}print_string(eatComment());output.add_new_line();if(header){output.add_new_line(true)}}else if(ch==="/"&&peek()==="/"){if(!isAfterNewline&&last_top_ch!=="{"){output.trim(true)}output.space_before_token=true;print_string(eatComment());output.add_new_line()}else if(ch==="@"){preserveSingleSpace(isAfterSpace);if(peek()==="{"){print_string(eatString("}"))}else{print_string(ch);var variableOrRule=peekString(": ,;{}()[]/='\"");if(variableOrRule.match(/[ :]$/)){next();variableOrRule=eatString(": ").replace(/\s$/,"");print_string(variableOrRule);output.space_before_token=true}variableOrRule=variableOrRule.replace(/\s$/,"");if(variableOrRule in this.NESTED_AT_RULE){nestedLevel+=1;if(variableOrRule in this.CONDITIONAL_GROUP_RULE){enteringConditionalGroup=true}}}}else if(ch==="#"&&peek()==="{"){preserveSingleSpace(isAfterSpace);print_string(eatString("}"))}else if(ch==="{"){if(peek(true)==="}"){eatWhitespace();next();output.space_before_token=true;print_string("{}");if(!eatWhitespace(true)){output.add_new_line()}if(newlinesFromLastWSEat<2&&newline_between_rules&&indentLevel===0){output.add_new_line(true)}}else{indent();output.space_before_token=true;print_string(ch);if(!eatWhitespace(true)){output.add_new_line()}if(enteringConditionalGroup){enteringConditionalGroup=false;insideRule=indentLevel>nestedLevel}else{insideRule=indentLevel>=nestedLevel}}}else if(ch==="}"){outdent();output.add_new_line();print_string(ch);insideRule=false;insidePropertyValue=false;if(nestedLevel){nestedLevel--}if(!eatWhitespace(true)){output.add_new_line()}if(newlinesFromLastWSEat<2&&newline_between_rules&&indentLevel===0){output.add_new_line(true)}}else if(ch===":"){eatWhitespace();if((insideRule||enteringConditionalGroup)&&!(lookBack("&")||foundNestedPseudoClass())&&!lookBack("(")){print_string(":");if(!insidePropertyValue){insidePropertyValue=true;output.space_before_token=true}}else{if(lookBack(" ")){output.space_before_token=true}if(peek()===":"){next();print_string("::")}else{print_string(":")}}}else if(ch==='"'||ch==="'"){preserveSingleSpace(isAfterSpace);print_string(eatString(ch))}else if(ch===";"){insidePropertyValue=false;print_string(ch);if(!eatWhitespace(true)){output.add_new_line()}}else if(ch==="("){if(lookBack("url")){print_string(ch);eatWhitespace();if(next()){if(ch!==")"&&ch!=='"'&&ch!=="'"){print_string(eatString(")"))}else{pos--}}}else{parenLevel++;preserveSingleSpace(isAfterSpace);print_string(ch);eatWhitespace()}}else if(ch===")"){print_string(ch);parenLevel--}else if(ch===","){print_string(ch);if(!eatWhitespace(true)&&selectorSeparatorNewline&&!insidePropertyValue&&parenLevel<1){output.add_new_line()}else{output.space_before_token=true}}else if((ch===">"||ch==="+"||ch==="~")&&!insidePropertyValue&&parenLevel<1){if(space_around_combinator){output.space_before_token=true;print_string(ch);output.space_before_token=true}else{print_string(ch);eatWhitespace();if(ch&&whiteRe.test(ch)){ch=""}}}else if(ch==="]"){print_string(ch)}else if(ch==="["){preserveSingleSpace(isAfterSpace);print_string(ch)}else if(ch==="="){eatWhitespace();print_string("=");if(whiteRe.test(ch)){ch=""}}else{preserveSingleSpace(isAfterSpace);print_string(ch)}}var sweetCode=output.get_code(end_with_newline,eol);return sweetCode};this.NESTED_AT_RULE={"@page":true,"@font-face":true,"@keyframes":true,"@media":true,"@supports":true,"@document":true};this.CONDITIONAL_GROUP_RULE={"@media":true,"@supports":true,"@document":true}}module.exports.Beautifier=Beautifier},function(module,exports){var nonASCIIidentifierStartChars="¬™¬µ¬∫√Ä-√ñ√ò-√∂√∏-ÀÅÀÜ-ÀëÀ†-À§À¨ÀÆÕ∞-Õ¥Õ∂Õ∑Õ∫-ÕΩŒÜŒà-ŒäŒåŒé-Œ°Œ£-œµœ∑-“Å“ä-‘ß‘±-’ñ’ô’°-÷á◊ê-◊™◊∞-◊≤ÿ†-ŸäŸÆŸØŸ±-€ì€ï€•€¶€Æ€Ø€∫-€º€ø‹ê‹í-‹Ø›ç-ﬁ•ﬁ±ﬂä-ﬂ™ﬂ¥ﬂµﬂ∫‡†Ä-‡†ï‡†ö‡†§‡†®‡°Ä-‡°ò‡¢†‡¢¢-‡¢¨‡§Ñ-‡§π‡§Ω‡•ê‡•ò-‡•°‡•±-‡•∑‡•π-‡•ø‡¶Ö-‡¶å‡¶è‡¶ê‡¶ì-‡¶®‡¶™-‡¶∞‡¶≤‡¶∂-‡¶π‡¶Ω‡ßé‡ßú‡ßù‡ßü-‡ß°‡ß∞‡ß±‡®Ö-‡®ä‡®è‡®ê‡®ì-‡®®‡®™-‡®∞‡®≤‡®≥‡®µ‡®∂‡®∏‡®π‡©ô-‡©ú‡©û‡©≤-‡©¥‡™Ö-‡™ç‡™è-‡™ë‡™ì-‡™®‡™™-‡™∞‡™≤‡™≥‡™µ-‡™π‡™Ω‡´ê‡´†‡´°‡¨Ö-‡¨å‡¨è‡¨ê‡¨ì-‡¨®‡¨™-‡¨∞‡¨≤‡¨≥‡¨µ-‡¨π‡¨Ω‡≠ú‡≠ù‡≠ü-‡≠°‡≠±‡ÆÉ‡ÆÖ-‡Æä‡Æé-‡Æê‡Æí-‡Æï‡Æô‡Æö‡Æú‡Æû‡Æü‡Æ£‡Æ§‡Æ®-‡Æ™‡ÆÆ-‡Æπ‡Øê‡∞Ö-‡∞å‡∞é-‡∞ê‡∞í-‡∞®‡∞™-‡∞≥‡∞µ-‡∞π‡∞Ω‡±ò‡±ô‡±†‡±°‡≤Ö-‡≤å‡≤é-‡≤ê‡≤í-‡≤®‡≤™-‡≤≥‡≤µ-‡≤π‡≤Ω‡≥û‡≥†‡≥°‡≥±‡≥≤‡¥Ö-‡¥å‡¥é-‡¥ê‡¥í-‡¥∫‡¥Ω‡µé‡µ†‡µ°‡µ∫-‡µø‡∂Ö-‡∂ñ‡∂ö-‡∂±‡∂≥-‡∂ª‡∂Ω‡∑Ä-‡∑Ü‡∏Å-‡∏∞‡∏≤‡∏≥‡πÄ-‡πÜ‡∫Å‡∫Ç‡∫Ñ‡∫á‡∫à‡∫ä‡∫ç‡∫î-‡∫ó‡∫ô-‡∫ü‡∫°-‡∫£‡∫•‡∫ß‡∫™‡∫´‡∫≠-‡∫∞‡∫≤‡∫≥‡∫Ω‡ªÄ-‡ªÑ‡ªÜ‡ªú-‡ªü‡ºÄ‡ΩÄ-‡Ωá‡Ωâ-‡Ω¨‡æà-‡æå·ÄÄ-·Ä™·Äø·Åê-·Åï·Åö-·Åù·Å°·Å•·Å¶·ÅÆ-·Å∞·Åµ-·ÇÅ·Çé·Ç†-·ÉÖ·Éá·Éç·Éê-·É∫·Éº-·âà·âä-·âç·âê-·âñ·âò·âö-·âù·â†-·äà·ää-·äç·äê-·ä∞·ä≤-·äµ·ä∏-·äæ·ãÄ·ãÇ-·ãÖ·ãà-·ãñ·ãò-·åê·åí-·åï·åò-·çö·éÄ-·éè·é†-·è¥·êÅ-·ô¨·ôØ-·ôø·öÅ-·öö·ö†-·õ™·õÆ-·õ∞·úÄ-·úå·úé-·úë·ú†-·ú±·ùÄ-·ùë·ù†-·ù¨·ùÆ-·ù∞·ûÄ-·û≥·üó·üú·††-·°∑·¢Ä-·¢®·¢™·¢∞-·£µ·§Ä-·§ú·•ê-·•≠·•∞-·•¥·¶Ä-·¶´·ßÅ-·ßá·®Ä-·®ñ·®†-·©î·™ß·¨Ö-·¨≥·≠Ö-·≠ã·ÆÉ-·Æ†·ÆÆ·ÆØ·Æ∫-·Ø•·∞Ä-·∞£·±ç-·±è·±ö-·±Ω·≥©-·≥¨·≥Æ-·≥±·≥µ·≥∂·¥Ä-·∂ø·∏Ä-·ºï·ºò-·ºù·º†-·ΩÖ·Ωà-·Ωç·Ωê-·Ωó·Ωô·Ωõ·Ωù·Ωü-·ΩΩ·æÄ-·æ¥·æ∂-·æº·ææ·øÇ-·øÑ·øÜ-·øå·øê-·øì·øñ-·øõ·ø†-·ø¨·ø≤-·ø¥·ø∂-·øº‚Å±‚Åø‚Çê-‚Çú‚ÑÇ‚Ñá‚Ñä-‚Ñì‚Ñï‚Ñô-‚Ñù‚Ñ§‚Ñ¶‚Ñ®‚Ñ™-‚Ñ≠‚ÑØ-‚Ñπ‚Ñº-‚Ñø‚ÖÖ-‚Öâ‚Öé‚Ö†-‚Üà‚∞Ä-‚∞Æ‚∞∞-‚±û‚±†-‚≥§‚≥´-‚≥Æ‚≥≤‚≥≥‚¥Ä-‚¥•‚¥ß‚¥≠‚¥∞-‚µß‚µØ‚∂Ä-‚∂ñ‚∂†-‚∂¶‚∂®-‚∂Æ‚∂∞-‚∂∂‚∂∏-‚∂æ‚∑Ä-‚∑Ü‚∑à-‚∑é‚∑ê-‚∑ñ‚∑ò-‚∑û‚∏Ø„ÄÖ-„Äá„Ä°-„Ä©„Ä±-„Äµ„Ä∏-„Äº„ÅÅ-„Çñ„Çù-„Çü„Ç°-„É∫„Éº-„Éø„ÑÖ-„Ñ≠„Ñ±-„Üé„Ü†-„Ü∫„á∞-„áø„êÄ-‰∂µ‰∏Ä-ÈøåÍÄÄ-ÍíåÍìê-ÍìΩÍîÄ-ÍòåÍòê-ÍòüÍò™Íò´ÍôÄ-ÍôÆÍôø-ÍöóÍö†-ÍõØÍúó-ÍúüÍú¢-ÍûàÍûã-ÍûéÍûê-ÍûìÍû†-Íû™Íü∏-Í†ÅÍ†É-Í†ÖÍ†á-Í†äÍ†å-Í†¢Í°Ä-Í°≥Í¢Ç-Í¢≥Í£≤-Í£∑Í£ªÍ§ä-Í§•Í§∞-Í•ÜÍ•†-Í•ºÍ¶Ñ-Í¶≤ÍßèÍ®Ä-Í®®Í©Ä-Í©ÇÍ©Ñ-Í©ãÍ©†-Í©∂Í©∫Í™Ä-Í™ØÍ™±Í™µÍ™∂Í™π-Í™ΩÍ´ÄÍ´ÇÍ´õ-Í´ùÍ´†-Í´™Í´≤-Í´¥Í¨Å-Í¨ÜÍ¨â-Í¨éÍ¨ë-Í¨ñÍ¨†-Í¨¶Í¨®-Í¨ÆÍØÄ-ÍØ¢Í∞Ä-Ìû£Ìû∞-ÌüÜÌüã-ÌüªÔ§Ä-Ô©≠Ô©∞-Ô´ôÔ¨Ä-Ô¨ÜÔ¨ì-Ô¨óÔ¨ùÔ¨ü-Ô¨®Ô¨™-Ô¨∂Ô¨∏-Ô¨ºÔ¨æÔ≠ÄÔ≠ÅÔ≠ÉÔ≠ÑÔ≠Ü-ÔÆ±ÔØì-Ô¥ΩÔµê-Ô∂èÔ∂í-Ô∑áÔ∑∞-Ô∑ªÔπ∞-Ôπ¥Ôπ∂-ÔªºÔº°-Ôº∫ÔΩÅ-ÔΩöÔΩ¶-ÔææÔøÇ-ÔøáÔøä-ÔøèÔøí-ÔøóÔøö-Ôøú";var nonASCIIidentifierChars="ÃÄ-ÕØ“É-“á÷ë-÷Ω÷ø◊Å◊Ç◊Ñ◊Ö◊áÿê-ÿöÿ†-ŸâŸ≤-€ì€ß-€®€ª-€º‹∞-›ä‡†Ä-‡†î‡†õ-‡†£‡†•-‡†ß‡†©-‡†≠‡°Ä-‡°ó‡£§-‡£æ‡§Ä-‡§É‡§∫-‡§º‡§æ-‡•è‡•ë-‡•ó‡•¢-‡•£‡•¶-‡•Ø‡¶Å-‡¶É‡¶º‡¶æ-‡ßÑ‡ßá‡ßà‡ßó‡ßü-‡ß†‡®Å-‡®É‡®º‡®æ-‡©Ç‡©á‡©à‡©ã-‡©ç‡©ë‡©¶-‡©±‡©µ‡™Å-‡™É‡™º‡™æ-‡´Ö‡´á-‡´â‡´ã-‡´ç‡´¢-‡´£‡´¶-‡´Ø‡¨Å-‡¨É‡¨º‡¨æ-‡≠Ñ‡≠á‡≠à‡≠ã-‡≠ç‡≠ñ‡≠ó‡≠ü-‡≠†‡≠¶-‡≠Ø‡ÆÇ‡Ææ-‡ØÇ‡ØÜ-‡Øà‡Øä-‡Øç‡Øó‡Ø¶-‡ØØ‡∞Å-‡∞É‡±Ü-‡±à‡±ä-‡±ç‡±ï‡±ñ‡±¢-‡±£‡±¶-‡±Ø‡≤Ç‡≤É‡≤º‡≤æ-‡≥Ñ‡≥Ü-‡≥à‡≥ä-‡≥ç‡≥ï‡≥ñ‡≥¢-‡≥£‡≥¶-‡≥Ø‡¥Ç‡¥É‡µÜ-‡µà‡µó‡µ¢-‡µ£‡µ¶-‡µØ‡∂Ç‡∂É‡∑ä‡∑è-‡∑î‡∑ñ‡∑ò-‡∑ü‡∑≤‡∑≥‡∏¥-‡∏∫‡πÄ-‡πÖ‡πê-‡πô‡∫¥-‡∫π‡ªà-‡ªç‡ªê-‡ªô‡ºò‡ºô‡º†-‡º©‡ºµ‡º∑‡ºπ‡ΩÅ-‡Ωá‡Ω±-‡æÑ‡æÜ-‡æá‡æç-‡æó‡æô-‡æº‡øÜ·ÄÄ-·Ä©·ÅÄ-·Åâ·Åß-·Å≠·Å±-·Å¥·ÇÇ-·Çç·Çè-·Çù·çù-·çü·úé-·úê·ú†-·ú∞·ùÄ-·ùê·ù≤·ù≥·ûÄ-·û≤·üù·ü†-·ü©·†ã-·†ç·†ê-·†ô·§†-·§´·§∞-·§ª·•ë-·•≠·¶∞-·ßÄ·ßà-·ßâ·ßê-·ßô·®Ä-·®ï·®†-·©ì·©†-·©º·©ø-·™â·™ê-·™ô·≠Ü-·≠ã·≠ê-·≠ô·≠´-·≠≥·Æ∞-·Æπ·Ø¶-·Ø≥·∞Ä-·∞¢·±Ä-·±â·±õ-·±Ω·≥ê-·≥í·¥Ä-·∂æ·∏Å-·ºï‚Äå‚Äç‚Äø‚ÅÄ‚Åî‚Éê-‚Éú‚É°‚É•-‚É∞‚∂Å-‚∂ñ‚∑†-‚∑ø„Ä°-„Ä®„Çô„ÇöÍôÄ-Íô≠Íô¥-ÍôΩÍöüÍõ∞-Íõ±Íü∏-Í†ÄÍ†ÜÍ†ãÍ†£-Í†ßÍ¢Ä-Í¢ÅÍ¢¥-Í£ÑÍ£ê-Í£ôÍ£≥-Í£∑Í§Ä-Í§âÍ§¶-Í§≠Í§∞-Í•ÖÍ¶Ä-Í¶ÉÍ¶≥-ÍßÄÍ®Ä-Í®ßÍ©Ä-Í©ÅÍ©å-Í©çÍ©ê-Í©ôÍ©ªÍ´†-Í´©Í´≤-Í´≥ÍØÄ-ÍØ°ÍØ¨ÍØ≠ÍØ∞-ÍØπÔ¨†-Ô¨®Ô∏Ä-Ô∏èÔ∏†-Ô∏¶Ô∏≥Ô∏¥Ôπç-ÔπèÔºê-ÔºôÔºø";var nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]");var nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");exports.newline=/[\n\r\u2028\u2029]/;exports.lineBreak=new RegExp("\r\n|"+exports.newline.source);exports.allLineBreaks=new RegExp(exports.lineBreak.source,"g");exports.isIdentifierStart=function(code){if(code<65){return code===36||code===64}if(code<91){return true}if(code<97){return code===95}if(code<123){return true}return code>=170&&nonASCIIidentifierStart.test(String.fromCharCode(code))};exports.isIdentifierChar=function(code){if(code<48){return code===36}if(code<58){return true}if(code<65){return false}if(code<91){return true}if(code<97){return code===95}if(code<123){return true}return code>=170&&nonASCIIidentifier.test(String.fromCharCode(code))}},function(module,exports){function mergeOpts(allOptions,targetType){var finalOpts={};var name;for(name in allOptions){if(name!==targetType){finalOpts[name]=allOptions[name]}}if(targetType in allOptions){for(name in allOptions[targetType]){finalOpts[name]=allOptions[targetType][name]}}return finalOpts}module.exports.mergeOpts=mergeOpts},function(module,exports){function OutputLine(parent){var _character_count=0;var _indent_count=-1;var _items=[];var _empty=true;this.set_indent=function(level){_character_count=parent.baseIndentLength+level*parent.indent_length;_indent_count=level};this.get_character_count=function(){return _character_count};this.is_empty=function(){return _empty};this.last=function(){if(!this._empty){return _items[_items.length-1]}else{return null}};this.push=function(input){_items.push(input);_character_count+=input.length;_empty=false};this.pop=function(){var item=null;if(!_empty){item=_items.pop();_character_count-=item.length;_empty=_items.length===0}return item};this.remove_indent=function(){if(_indent_count>0){_indent_count-=1;_character_count-=parent.indent_length}};this.trim=function(){while(this.last()===" "){_items.pop();_character_count-=1}_empty=_items.length===0};this.toString=function(){var result="";if(!this._empty){if(_indent_count>=0){result=parent.indent_cache[_indent_count]}result+=_items.join("")}return result}}function Output(indent_string,baseIndentString){baseIndentString=baseIndentString||"";this.indent_cache=[baseIndentString];this.baseIndentLength=baseIndentString.length;this.indent_length=indent_string.length;this.raw=false;var lines=[];this.baseIndentString=baseIndentString;this.indent_string=indent_string;this.previous_line=null;this.current_line=null;this.space_before_token=false;this.add_outputline=function(){this.previous_line=this.current_line;this.current_line=new OutputLine(this);lines.push(this.current_line)};this.add_outputline();this.get_line_number=function(){return lines.length};this.add_new_line=function(force_newline){if(this.get_line_number()===1&&this.just_added_newline()){return false}if(force_newline||!this.just_added_newline()){if(!this.raw){this.add_outputline()}return true}return false};this.get_code=function(end_with_newline,eol){var sweet_code=lines.join("\n").replace(/[\r\n\t ]+$/,"");if(end_with_newline){sweet_code+="\n"}if(eol!=="\n"){sweet_code=sweet_code.replace(/[\n]/g,eol)}return sweet_code};this.set_indent=function(level){if(lines.length>1){while(level>=this.indent_cache.length){this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string)}this.current_line.set_indent(level);return true}this.current_line.set_indent(0);return false};this.add_raw_token=function(token){for(var x=0;x<token.newlines;x++){this.add_outputline()}this.current_line.push(token.whitespace_before);this.current_line.push(token.text);this.space_before_token=false};this.add_token=function(printable_token){this.add_space_before_token();this.current_line.push(printable_token)};this.add_space_before_token=function(){if(this.space_before_token&&!this.just_added_newline()){this.current_line.push(" ")}this.space_before_token=false};this.remove_indent=function(index){var output_length=lines.length;while(index<output_length){lines[index].remove_indent();index++}};this.trim=function(eat_newlines){eat_newlines=eat_newlines===undefined?false:eat_newlines;this.current_line.trim(indent_string,baseIndentString);while(eat_newlines&&lines.length>1&&this.current_line.is_empty()){lines.pop();this.current_line=lines[lines.length-1];this.current_line.trim()}this.previous_line=lines.length>1?lines[lines.length-2]:null};this.just_added_newline=function(){return this.current_line.is_empty()};this.just_added_blankline=function(){if(this.just_added_newline()){if(lines.length===1){return true}var line=lines[lines.length-2];return line.is_empty()}return false}}module.exports.Output=Output},function(module,exports,__webpack_require__){var Beautifier=__webpack_require__(0).Beautifier;function css_beautify(source_text,options){var beautifier=new Beautifier(source_text,options);return beautifier.beautify()}module.exports=css_beautify}]);var css_beautify=legacy_beautify_css;if(typeof undefined==="function"&&undefined.amd){undefined([],function(){return{css_beautify:css_beautify}})}else{exports.css_beautify=css_beautify}})()});unwrapExports(beautifyCss);var beautifyHtml=createCommonjsModule(function(module,exports){(function(){var legacy_beautify_html=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.i=function(value){return value};__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=3)}([function(module,exports,__webpack_require__){var mergeOpts=__webpack_require__(2).mergeOpts;var acorn=__webpack_require__(1);var lineBreak=acorn.lineBreak;var allLineBreaks=acorn.allLineBreaks;function ltrim(s){return s.replace(/^\s+/g,"")}function rtrim(s){return s.replace(/\s+$/g,"")}function Beautifier(html_source,options,js_beautify,css_beautify){html_source=html_source||"";var multi_parser,indent_inner_html,indent_body_inner_html,indent_head_inner_html,indent_size,indent_character,wrap_line_length,brace_style,unformatted,content_unformatted,preserve_newlines,max_preserve_newlines,indent_handlebars,wrap_attributes,wrap_attributes_indent_size,is_wrap_attributes_force,is_wrap_attributes_force_expand_multiline,is_wrap_attributes_force_aligned,end_with_newline,extra_liners,eol;options=options||{};options=mergeOpts(options,"html");if((options.wrap_line_length===undefined||parseInt(options.wrap_line_length,10)===0)&&(options.max_char!==undefined&&parseInt(options.max_char,10)!==0)){options.wrap_line_length=options.max_char}indent_inner_html=options.indent_inner_html===undefined?false:options.indent_inner_html;indent_body_inner_html=options.indent_body_inner_html===undefined?true:options.indent_body_inner_html;indent_head_inner_html=options.indent_head_inner_html===undefined?true:options.indent_head_inner_html;indent_size=options.indent_size===undefined?4:parseInt(options.indent_size,10);indent_character=options.indent_char===undefined?" ":options.indent_char;brace_style=options.brace_style===undefined?"collapse":options.brace_style;wrap_line_length=parseInt(options.wrap_line_length,10)===0?32786:parseInt(options.wrap_line_length||250,10);unformatted=options.unformatted||["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","address","big","dt","ins","strike","tt"];content_unformatted=options.content_unformatted||["pre"];preserve_newlines=options.preserve_newlines===undefined?true:options.preserve_newlines;max_preserve_newlines=preserve_newlines?isNaN(parseInt(options.max_preserve_newlines,10))?32786:parseInt(options.max_preserve_newlines,10):0;indent_handlebars=options.indent_handlebars===undefined?false:options.indent_handlebars;wrap_attributes=options.wrap_attributes===undefined?"auto":options.wrap_attributes;wrap_attributes_indent_size=isNaN(parseInt(options.wrap_attributes_indent_size,10))?indent_size:parseInt(options.wrap_attributes_indent_size,10);is_wrap_attributes_force=wrap_attributes.substr(0,"force".length)==="force";is_wrap_attributes_force_expand_multiline=wrap_attributes==="force-expand-multiline";is_wrap_attributes_force_aligned=wrap_attributes==="force-aligned";end_with_newline=options.end_with_newline===undefined?false:options.end_with_newline;extra_liners=typeof options.extra_liners==="object"&&options.extra_liners?options.extra_liners.concat():typeof options.extra_liners==="string"?options.extra_liners.split(","):"head,body,/html".split(",");eol=options.eol?options.eol:"auto";if(options.indent_with_tabs){indent_character="\t";indent_size=1}if(eol==="auto"){eol="\n";if(html_source&&lineBreak.test(html_source||"")){eol=html_source.match(lineBreak)[0]}}eol=eol.replace(/\\r/,"\r").replace(/\\n/,"\n");html_source=html_source.replace(allLineBreaks,"\n");function Parser(){this.pos=0;this.token="";this.current_mode="CONTENT";this.tags={parent:"parent1",parentcount:1,parent1:""};this.tag_type="";this.token_text=this.last_token=this.last_text=this.token_type="";this.newlines=0;this.indent_content=indent_inner_html;this.indent_body_inner_html=indent_body_inner_html;this.indent_head_inner_html=indent_head_inner_html;this.Utils={whitespace:"\n\r\t ".split(""),single_token:options.void_elements||["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","?php","basefont","isindex"],extra_liners:extra_liners,in_array:function(what,arr){for(var i=0;i<arr.length;i++){if(what===arr[i]){return true}}return false}};this.is_whitespace=function(text){for(var n=0;n<text.length;n++){if(!this.Utils.in_array(text.charAt(n),this.Utils.whitespace)){return false}}return true};this.traverse_whitespace=function(){var input_char="";input_char=this.input.charAt(this.pos);if(this.Utils.in_array(input_char,this.Utils.whitespace)){this.newlines=0;while(this.Utils.in_array(input_char,this.Utils.whitespace)){if(preserve_newlines&&input_char==="\n"&&this.newlines<=max_preserve_newlines){this.newlines+=1}this.pos++;input_char=this.input.charAt(this.pos)}return true}return false};this.space_or_wrap=function(content){if(this.line_char_count>=this.wrap_line_length){this.print_newline(false,content);this.print_indentation(content);return true}else{this.line_char_count++;content.push(" ");return false}};this.get_content=function(){var input_char="",content=[],handlebarsStarted=0;while(this.input.charAt(this.pos)!=="<"||handlebarsStarted===2){if(this.pos>=this.input.length){return content.length?content.join(""):["","TK_EOF"]}if(handlebarsStarted<2&&this.traverse_whitespace()){this.space_or_wrap(content);continue}input_char=this.input.charAt(this.pos);if(indent_handlebars){if(input_char==="{"){handlebarsStarted+=1}else if(handlebarsStarted<2){handlebarsStarted=0}if(input_char==="}"&&handlebarsStarted>0){if(handlebarsStarted--===0){break}}var peek3=this.input.substr(this.pos,3);if(peek3==="{{#"||peek3==="{{/"){break}else if(peek3==="{{!"){return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"]}else if(this.input.substr(this.pos,2)==="{{"){if(this.get_tag(true)==="{{else}}"){break}}}this.pos++;this.line_char_count++;content.push(input_char)}return content.length?content.join(""):""};this.get_contents_to=function(name){if(this.pos===this.input.length){return["","TK_EOF"]}var content="";var reg_match=new RegExp("</"+name+"\\s*>","igm");reg_match.lastIndex=this.pos;var reg_array=reg_match.exec(this.input);var end_script=reg_array?reg_array.index:this.input.length;if(this.pos<end_script){content=this.input.substring(this.pos,end_script);this.pos=end_script}return content};this.record_tag=function(tag){if(this.tags[tag+"count"]){this.tags[tag+"count"]++;this.tags[tag+this.tags[tag+"count"]]=this.indent_level}else{this.tags[tag+"count"]=1;this.tags[tag+this.tags[tag+"count"]]=this.indent_level}this.tags[tag+this.tags[tag+"count"]+"parent"]=this.tags.parent;this.tags.parent=tag+this.tags[tag+"count"]};this.retrieve_tag=function(tag){if(this.tags[tag+"count"]){var temp_parent=this.tags.parent;while(temp_parent){if(tag+this.tags[tag+"count"]===temp_parent){break}temp_parent=this.tags[temp_parent+"parent"]}if(temp_parent){this.indent_level=this.tags[tag+this.tags[tag+"count"]];this.tags.parent=this.tags[temp_parent+"parent"]}delete this.tags[tag+this.tags[tag+"count"]+"parent"];delete this.tags[tag+this.tags[tag+"count"]];if(this.tags[tag+"count"]===1){delete this.tags[tag+"count"]}else{this.tags[tag+"count"]--}}};this.indent_to_tag=function(tag){if(!this.tags[tag+"count"]){return}var temp_parent=this.tags.parent;while(temp_parent){if(tag+this.tags[tag+"count"]===temp_parent){break}temp_parent=this.tags[temp_parent+"parent"]}if(temp_parent){this.indent_level=this.tags[tag+this.tags[tag+"count"]]}};this.get_tag=function(peek){var input_char="",content=[],comment="",space=false,first_attr=true,has_wrapped_attrs=false,tag_start,tag_end,tag_start_char,orig_pos=this.pos,orig_line_char_count=this.line_char_count,is_tag_closed=false,tail;peek=peek!==undefined?peek:false;do{if(this.pos>=this.input.length){if(peek){this.pos=orig_pos;this.line_char_count=orig_line_char_count}return content.length?content.join(""):["","TK_EOF"]}input_char=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(input_char,this.Utils.whitespace)){space=true;continue}if(input_char==="'"||input_char==='"'){input_char+=this.get_unformatted(input_char);space=true}if(input_char==="="){space=false}tail=this.input.substr(this.pos-1);if(is_wrap_attributes_force_expand_multiline&&has_wrapped_attrs&&!is_tag_closed&&(input_char===">"||input_char==="/")){if(tail.match(/^\/?\s*>/)){space=false;is_tag_closed=true;this.print_newline(false,content);this.print_indentation(content)}}if(content.length&&content[content.length-1]!=="="&&input_char!==">"&&space){var wrapped=this.space_or_wrap(content);var indentAttrs=wrapped&&input_char!=="/"&&!is_wrap_attributes_force;space=false;if(is_wrap_attributes_force&&input_char!=="/"){var force_first_attr_wrap=false;if(is_wrap_attributes_force_expand_multiline&&first_attr){var is_only_attribute=tail.match(/^\S*(="([^"]|\\")*")?\s*\/?\s*>/)!==null;force_first_attr_wrap=!is_only_attribute}if(!first_attr||force_first_attr_wrap){this.print_newline(false,content);this.print_indentation(content);indentAttrs=true}}if(indentAttrs){has_wrapped_attrs=true;var alignment_size=wrap_attributes_indent_size;if(is_wrap_attributes_force_aligned){alignment_size=content.indexOf(" ")+1}for(var count=0;count<alignment_size;count++){content.push(" ")}}if(first_attr){for(var i=0;i<content.length;i++){if(content[i]===" "){first_attr=false;break}}}}if(indent_handlebars&&tag_start_char==="<"){if(input_char+this.input.charAt(this.pos)==="{{"){input_char+=this.get_unformatted("}}");if(content.length&&content[content.length-1]!==" "&&content[content.length-1]!=="<"){input_char=" "+input_char}space=true}}if(input_char==="<"&&!tag_start_char){tag_start=this.pos-1;tag_start_char="<"}if(indent_handlebars&&!tag_start_char){if(content.length>=2&&content[content.length-1]==="{"&&content[content.length-2]==="{"){if(input_char==="#"||input_char==="/"||input_char==="!"){tag_start=this.pos-3}else{tag_start=this.pos-2}tag_start_char="{"}}this.line_char_count++;content.push(input_char);if(content[1]&&(content[1]==="!"||content[1]==="?"||content[1]==="%")){content=[this.get_comment(tag_start)];break}if(indent_handlebars&&content[1]&&content[1]==="{"&&content[2]&&content[2]==="!"){content=[this.get_comment(tag_start)];break}if(indent_handlebars&&tag_start_char==="{"&&content.length>2&&content[content.length-2]==="}"&&content[content.length-1]==="}"){break}}while(input_char!==">");var tag_complete=content.join("");var tag_index;var tag_offset;if(tag_complete.indexOf(" ")!==-1){tag_index=tag_complete.indexOf(" ")}else if(tag_complete.indexOf("\n")!==-1){tag_index=tag_complete.indexOf("\n")}else if(tag_complete.charAt(0)==="{"){tag_index=tag_complete.indexOf("}")}else{tag_index=tag_complete.indexOf(">")}if(tag_complete.charAt(0)==="<"||!indent_handlebars){tag_offset=1}else{tag_offset=tag_complete.charAt(2)==="#"?3:2}var tag_check=tag_complete.substring(tag_offset,tag_index).toLowerCase();if(tag_complete.charAt(tag_complete.length-2)==="/"||this.Utils.in_array(tag_check,this.Utils.single_token)){if(!peek){this.tag_type="SINGLE"}}else if(indent_handlebars&&tag_complete.charAt(0)==="{"&&tag_check==="else"){if(!peek){this.indent_to_tag("if");this.tag_type="HANDLEBARS_ELSE";this.indent_content=true;this.traverse_whitespace()}}else if(this.is_unformatted(tag_check,unformatted)||this.is_unformatted(tag_check,content_unformatted)){comment=this.get_unformatted("</"+tag_check+">",tag_complete);content.push(comment);this.tag_type="SINGLE"}else if(tag_check==="script"&&(tag_complete.search("type")===-1||tag_complete.search("type")>-1&&tag_complete.search(/\b(text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect)/)>-1)){if(!peek){this.record_tag(tag_check);this.tag_type="SCRIPT"}}else if(tag_check==="style"&&(tag_complete.search("type")===-1||tag_complete.search("type")>-1&&tag_complete.search("text/css")>-1)){if(!peek){this.record_tag(tag_check);this.tag_type="STYLE"}}else if(tag_check.charAt(0)==="!"){if(!peek){this.tag_type="SINGLE";this.traverse_whitespace()}}else if(!peek){if(tag_check.charAt(0)==="/"){this.retrieve_tag(tag_check.substring(1));this.tag_type="END"}else{this.record_tag(tag_check);if(tag_check.toLowerCase()!=="html"){this.indent_content=true}this.tag_type="START"}if(this.traverse_whitespace()){this.space_or_wrap(content)}if(this.Utils.in_array(tag_check,this.Utils.extra_liners)){this.print_newline(false,this.output);if(this.output.length&&this.output[this.output.length-2]!=="\n"){this.print_newline(true,this.output)}}}if(peek){this.pos=orig_pos;this.line_char_count=orig_line_char_count}return content.join("")};this.get_comment=function(start_pos){var comment="",delimiter=">",matched=false;this.pos=start_pos;var input_char=this.input.charAt(this.pos);this.pos++;while(this.pos<=this.input.length){comment+=input_char;if(comment.charAt(comment.length-1)===delimiter.charAt(delimiter.length-1)&&comment.indexOf(delimiter)!==-1){break}if(!matched&&comment.length<10){if(comment.indexOf("<![if")===0){delimiter="<![endif]>";matched=true}else if(comment.indexOf("<![cdata[")===0){delimiter="]]>";matched=true}else if(comment.indexOf("<![")===0){delimiter="]>";matched=true}else if(comment.indexOf("\x3c!--")===0){delimiter="--\x3e";matched=true}else if(comment.indexOf("{{!--")===0){delimiter="--}}";matched=true}else if(comment.indexOf("{{!")===0){if(comment.length===5&&comment.indexOf("{{!--")===-1){delimiter="}}";matched=true}}else if(comment.indexOf("<?")===0){delimiter="?>";matched=true}else if(comment.indexOf("<%")===0){delimiter="%>";matched=true}}input_char=this.input.charAt(this.pos);this.pos++}return comment};function tokenMatcher(delimiter){var token="";var add=function(str){var newToken=token+str.toLowerCase();token=newToken.length<=delimiter.length?newToken:newToken.substr(newToken.length-delimiter.length,delimiter.length)};var doesNotMatch=function(){return token.indexOf(delimiter)===-1};return{add:add,doesNotMatch:doesNotMatch}}this.get_unformatted=function(delimiter,orig_tag){if(orig_tag&&orig_tag.toLowerCase().indexOf(delimiter)!==-1){return""}var input_char="";var content="";var space=true;var delimiterMatcher=tokenMatcher(delimiter);do{if(this.pos>=this.input.length){return content}input_char=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(input_char,this.Utils.whitespace)){if(!space){this.line_char_count--;continue}if(input_char==="\n"||input_char==="\r"){content+="\n";this.line_char_count=0;continue}}content+=input_char;delimiterMatcher.add(input_char);this.line_char_count++;space=true;if(indent_handlebars&&input_char==="{"&&content.length&&content.charAt(content.length-2)==="{"){content+=this.get_unformatted("}}")}}while(delimiterMatcher.doesNotMatch());return content};this.get_token=function(){var token;if(this.last_token==="TK_TAG_SCRIPT"||this.last_token==="TK_TAG_STYLE"){var type=this.last_token.substr(7);token=this.get_contents_to(type);if(typeof token!=="string"){return token}return[token,"TK_"+type]}if(this.current_mode==="CONTENT"){token=this.get_content();if(typeof token!=="string"){return token}else{return[token,"TK_CONTENT"]}}if(this.current_mode==="TAG"){token=this.get_tag();if(typeof token!=="string"){return token}else{var tag_name_type="TK_TAG_"+this.tag_type;return[token,tag_name_type]}}};this.get_full_indent=function(level){level=this.indent_level+level||0;if(level<1){return""}return Array(level+1).join(this.indent_string)};this.is_unformatted=function(tag_check,unformatted){if(!this.Utils.in_array(tag_check,unformatted)){return false}if(tag_check.toLowerCase()!=="a"||!this.Utils.in_array("a",unformatted)){return true}var next_tag=this.get_tag(true);var tag=(next_tag||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);if(!tag||this.Utils.in_array(tag[1],unformatted)){return true}else{return false}};this.printer=function(js_source,indent_character,indent_size,wrap_line_length,brace_style){this.input=js_source||"";this.input=this.input.replace(/\r\n|[\r\u2028\u2029]/g,"\n");this.output=[];this.indent_character=indent_character;this.indent_string="";this.indent_size=indent_size;this.brace_style=brace_style;this.indent_level=0;this.wrap_line_length=wrap_line_length;this.line_char_count=0;for(var i=0;i<this.indent_size;i++){this.indent_string+=this.indent_character}this.print_newline=function(force,arr){this.line_char_count=0;if(!arr||!arr.length){return}if(force||arr[arr.length-1]!=="\n"){if(arr[arr.length-1]!=="\n"){arr[arr.length-1]=rtrim(arr[arr.length-1])}arr.push("\n")}};this.print_indentation=function(arr){for(var i=0;i<this.indent_level;i++){arr.push(this.indent_string);this.line_char_count+=this.indent_string.length}};this.print_token=function(text){if(this.is_whitespace(text)&&!this.output.length){return}if(text||text!==""){if(this.output.length&&this.output[this.output.length-1]==="\n"){this.print_indentation(this.output);text=ltrim(text)}}this.print_token_raw(text)};this.print_token_raw=function(text){if(this.newlines>0){text=rtrim(text)}if(text&&text!==""){if(text.length>1&&text.charAt(text.length-1)==="\n"){this.output.push(text.slice(0,-1));this.print_newline(false,this.output)}else{this.output.push(text)}}for(var n=0;n<this.newlines;n++){this.print_newline(n>0,this.output)}this.newlines=0};this.indent=function(){this.indent_level++};this.unindent=function(){if(this.indent_level>0){this.indent_level--}}};return this}this.beautify=function(){multi_parser=new Parser;multi_parser.printer(html_source,indent_character,indent_size,wrap_line_length,brace_style);while(true){var t=multi_parser.get_token();multi_parser.token_text=t[0];multi_parser.token_type=t[1];if(multi_parser.token_type==="TK_EOF"){break}switch(multi_parser.token_type){case"TK_TAG_START":multi_parser.print_newline(false,multi_parser.output);multi_parser.print_token(multi_parser.token_text);if(multi_parser.indent_content){if((multi_parser.indent_body_inner_html||!multi_parser.token_text.match(/<body(?:.*)>/))&&(multi_parser.indent_head_inner_html||!multi_parser.token_text.match(/<head(?:.*)>/))){multi_parser.indent()}multi_parser.indent_content=false}multi_parser.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":multi_parser.print_newline(false,multi_parser.output);multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="CONTENT";break;case"TK_TAG_END":if(multi_parser.last_token==="TK_CONTENT"&&multi_parser.last_text===""){var tag_name=(multi_parser.token_text.match(/\w+/)||[])[0];var tag_extracted_from_last_output=null;if(multi_parser.output.length){tag_extracted_from_last_output=multi_parser.output[multi_parser.output.length-1].match(/(?:<|{{#)\s*(\w+)/)}if(tag_extracted_from_last_output===null||tag_extracted_from_last_output[1]!==tag_name&&!multi_parser.Utils.in_array(tag_extracted_from_last_output[1],unformatted)){multi_parser.print_newline(false,multi_parser.output)}}multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var tag_check=multi_parser.token_text.match(/^\s*<([a-z-]+)/i);if(!tag_check||!multi_parser.Utils.in_array(tag_check[1],unformatted)){multi_parser.print_newline(false,multi_parser.output)}multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":var foundIfOnCurrentLine=false;for(var lastCheckedOutput=multi_parser.output.length-1;lastCheckedOutput>=0;lastCheckedOutput--){if(multi_parser.output[lastCheckedOutput]==="\n"){break}else{if(multi_parser.output[lastCheckedOutput].match(/{{#if/)){foundIfOnCurrentLine=true;break}}}if(!foundIfOnCurrentLine){multi_parser.print_newline(false,multi_parser.output)}multi_parser.print_token(multi_parser.token_text);if(multi_parser.indent_content){multi_parser.indent();multi_parser.indent_content=false}multi_parser.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="TAG";break;case"TK_CONTENT":multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(multi_parser.token_text!==""){multi_parser.print_newline(false,multi_parser.output);var text=multi_parser.token_text,_beautifier,script_indent_level=1;if(multi_parser.token_type==="TK_SCRIPT"){_beautifier=typeof js_beautify==="function"&&js_beautify}else if(multi_parser.token_type==="TK_STYLE"){_beautifier=typeof css_beautify==="function"&&css_beautify}if(options.indent_scripts==="keep"){script_indent_level=0}else if(options.indent_scripts==="separate"){script_indent_level=-multi_parser.indent_level}var indentation=multi_parser.get_full_indent(script_indent_level);if(_beautifier){var Child_options=function(){this.eol="\n"};Child_options.prototype=options;var child_options=new Child_options;text=_beautifier(text.replace(/^\s*/,indentation),child_options)}else{var white=text.match(/^\s*/)[0];var _level=white.match(/[^\n\r]*$/)[0].split(multi_parser.indent_string).length-1;var reindent=multi_parser.get_full_indent(script_indent_level-_level);text=text.replace(/^\s*/,indentation).replace(/\r\n|\r|\n/g,"\n"+reindent).replace(/\s+$/,"")}if(text){multi_parser.print_token_raw(text);multi_parser.print_newline(true,multi_parser.output)}}multi_parser.current_mode="TAG";break;default:if(multi_parser.token_text!==""){multi_parser.print_token(multi_parser.token_text)}break}multi_parser.last_token=multi_parser.token_type;multi_parser.last_text=multi_parser.token_text}var sweet_code=multi_parser.output.join("").replace(/[\r\n\t ]+$/,"");if(end_with_newline){sweet_code+="\n"}if(eol!=="\n"){sweet_code=sweet_code.replace(/[\n]/g,eol)}return sweet_code}}module.exports.Beautifier=Beautifier},function(module,exports){var nonASCIIidentifierStartChars="¬™¬µ¬∫√Ä-√ñ√ò-√∂√∏-ÀÅÀÜ-ÀëÀ†-À§À¨ÀÆÕ∞-Õ¥Õ∂Õ∑Õ∫-ÕΩŒÜŒà-ŒäŒåŒé-Œ°Œ£-œµœ∑-“Å“ä-‘ß‘±-’ñ’ô’°-÷á◊ê-◊™◊∞-◊≤ÿ†-ŸäŸÆŸØŸ±-€ì€ï€•€¶€Æ€Ø€∫-€º€ø‹ê‹í-‹Ø›ç-ﬁ•ﬁ±ﬂä-ﬂ™ﬂ¥ﬂµﬂ∫‡†Ä-‡†ï‡†ö‡†§‡†®‡°Ä-‡°ò‡¢†‡¢¢-‡¢¨‡§Ñ-‡§π‡§Ω‡•ê‡•ò-‡•°‡•±-‡•∑‡•π-‡•ø‡¶Ö-‡¶å‡¶è‡¶ê‡¶ì-‡¶®‡¶™-‡¶∞‡¶≤‡¶∂-‡¶π‡¶Ω‡ßé‡ßú‡ßù‡ßü-‡ß°‡ß∞‡ß±‡®Ö-‡®ä‡®è‡®ê‡®ì-‡®®‡®™-‡®∞‡®≤‡®≥‡®µ‡®∂‡®∏‡®π‡©ô-‡©ú‡©û‡©≤-‡©¥‡™Ö-‡™ç‡™è-‡™ë‡™ì-‡™®‡™™-‡™∞‡™≤‡™≥‡™µ-‡™π‡™Ω‡´ê‡´†‡´°‡¨Ö-‡¨å‡¨è‡¨ê‡¨ì-‡¨®‡¨™-‡¨∞‡¨≤‡¨≥‡¨µ-‡¨π‡¨Ω‡≠ú‡≠ù‡≠ü-‡≠°‡≠±‡ÆÉ‡ÆÖ-‡Æä‡Æé-‡Æê‡Æí-‡Æï‡Æô‡Æö‡Æú‡Æû‡Æü‡Æ£‡Æ§‡Æ®-‡Æ™‡ÆÆ-‡Æπ‡Øê‡∞Ö-‡∞å‡∞é-‡∞ê‡∞í-‡∞®‡∞™-‡∞≥‡∞µ-‡∞π‡∞Ω‡±ò‡±ô‡±†‡±°‡≤Ö-‡≤å‡≤é-‡≤ê‡≤í-‡≤®‡≤™-‡≤≥‡≤µ-‡≤π‡≤Ω‡≥û‡≥†‡≥°‡≥±‡≥≤‡¥Ö-‡¥å‡¥é-‡¥ê‡¥í-‡¥∫‡¥Ω‡µé‡µ†‡µ°‡µ∫-‡µø‡∂Ö-‡∂ñ‡∂ö-‡∂±‡∂≥-‡∂ª‡∂Ω‡∑Ä-‡∑Ü‡∏Å-‡∏∞‡∏≤‡∏≥‡πÄ-‡πÜ‡∫Å‡∫Ç‡∫Ñ‡∫á‡∫à‡∫ä‡∫ç‡∫î-‡∫ó‡∫ô-‡∫ü‡∫°-‡∫£‡∫•‡∫ß‡∫™‡∫´‡∫≠-‡∫∞‡∫≤‡∫≥‡∫Ω‡ªÄ-‡ªÑ‡ªÜ‡ªú-‡ªü‡ºÄ‡ΩÄ-‡Ωá‡Ωâ-‡Ω¨‡æà-‡æå·ÄÄ-·Ä™·Äø·Åê-·Åï·Åö-·Åù·Å°·Å•·Å¶·ÅÆ-·Å∞·Åµ-·ÇÅ·Çé·Ç†-·ÉÖ·Éá·Éç·Éê-·É∫·Éº-·âà·âä-·âç·âê-·âñ·âò·âö-·âù·â†-·äà·ää-·äç·äê-·ä∞·ä≤-·äµ·ä∏-·äæ·ãÄ·ãÇ-·ãÖ·ãà-·ãñ·ãò-·åê·åí-·åï·åò-·çö·éÄ-·éè·é†-·è¥·êÅ-·ô¨·ôØ-·ôø·öÅ-·öö·ö†-·õ™·õÆ-·õ∞·úÄ-·úå·úé-·úë·ú†-·ú±·ùÄ-·ùë·ù†-·ù¨·ùÆ-·ù∞·ûÄ-·û≥·üó·üú·††-·°∑·¢Ä-·¢®·¢™·¢∞-·£µ·§Ä-·§ú·•ê-·•≠·•∞-·•¥·¶Ä-·¶´·ßÅ-·ßá·®Ä-·®ñ·®†-·©î·™ß·¨Ö-·¨≥·≠Ö-·≠ã·ÆÉ-·Æ†·ÆÆ·ÆØ·Æ∫-·Ø•·∞Ä-·∞£·±ç-·±è·±ö-·±Ω·≥©-·≥¨·≥Æ-·≥±·≥µ·≥∂·¥Ä-·∂ø·∏Ä-·ºï·ºò-·ºù·º†-·ΩÖ·Ωà-·Ωç·Ωê-·Ωó·Ωô·Ωõ·Ωù·Ωü-·ΩΩ·æÄ-·æ¥·æ∂-·æº·ææ·øÇ-·øÑ·øÜ-·øå·øê-·øì·øñ-·øõ·ø†-·ø¨·ø≤-·ø¥·ø∂-·øº‚Å±‚Åø‚Çê-‚Çú‚ÑÇ‚Ñá‚Ñä-‚Ñì‚Ñï‚Ñô-‚Ñù‚Ñ§‚Ñ¶‚Ñ®‚Ñ™-‚Ñ≠‚ÑØ-‚Ñπ‚Ñº-‚Ñø‚ÖÖ-‚Öâ‚Öé‚Ö†-‚Üà‚∞Ä-‚∞Æ‚∞∞-‚±û‚±†-‚≥§‚≥´-‚≥Æ‚≥≤‚≥≥‚¥Ä-‚¥•‚¥ß‚¥≠‚¥∞-‚µß‚µØ‚∂Ä-‚∂ñ‚∂†-‚∂¶‚∂®-‚∂Æ‚∂∞-‚∂∂‚∂∏-‚∂æ‚∑Ä-‚∑Ü‚∑à-‚∑é‚∑ê-‚∑ñ‚∑ò-‚∑û‚∏Ø„ÄÖ-„Äá„Ä°-„Ä©„Ä±-„Äµ„Ä∏-„Äº„ÅÅ-„Çñ„Çù-„Çü„Ç°-„É∫„Éº-„Éø„ÑÖ-„Ñ≠„Ñ±-„Üé„Ü†-„Ü∫„á∞-„áø„êÄ-‰∂µ‰∏Ä-ÈøåÍÄÄ-ÍíåÍìê-ÍìΩÍîÄ-ÍòåÍòê-ÍòüÍò™Íò´ÍôÄ-ÍôÆÍôø-ÍöóÍö†-ÍõØÍúó-ÍúüÍú¢-ÍûàÍûã-ÍûéÍûê-ÍûìÍû†-Íû™Íü∏-Í†ÅÍ†É-Í†ÖÍ†á-Í†äÍ†å-Í†¢Í°Ä-Í°≥Í¢Ç-Í¢≥Í£≤-Í£∑Í£ªÍ§ä-Í§•Í§∞-Í•ÜÍ•†-Í•ºÍ¶Ñ-Í¶≤ÍßèÍ®Ä-Í®®Í©Ä-Í©ÇÍ©Ñ-Í©ãÍ©†-Í©∂Í©∫Í™Ä-Í™ØÍ™±Í™µÍ™∂Í™π-Í™ΩÍ´ÄÍ´ÇÍ´õ-Í´ùÍ´†-Í´™Í´≤-Í´¥Í¨Å-Í¨ÜÍ¨â-Í¨éÍ¨ë-Í¨ñÍ¨†-Í¨¶Í¨®-Í¨ÆÍØÄ-ÍØ¢Í∞Ä-Ìû£Ìû∞-ÌüÜÌüã-ÌüªÔ§Ä-Ô©≠Ô©∞-Ô´ôÔ¨Ä-Ô¨ÜÔ¨ì-Ô¨óÔ¨ùÔ¨ü-Ô¨®Ô¨™-Ô¨∂Ô¨∏-Ô¨ºÔ¨æÔ≠ÄÔ≠ÅÔ≠ÉÔ≠ÑÔ≠Ü-ÔÆ±ÔØì-Ô¥ΩÔµê-Ô∂èÔ∂í-Ô∑áÔ∑∞-Ô∑ªÔπ∞-Ôπ¥Ôπ∂-ÔªºÔº°-Ôº∫ÔΩÅ-ÔΩöÔΩ¶-ÔææÔøÇ-ÔøáÔøä-ÔøèÔøí-ÔøóÔøö-Ôøú";var nonASCIIidentifierChars="ÃÄ-ÕØ“É-“á÷ë-÷Ω÷ø◊Å◊Ç◊Ñ◊Ö◊áÿê-ÿöÿ†-ŸâŸ≤-€ì€ß-€®€ª-€º‹∞-›ä‡†Ä-‡†î‡†õ-‡†£‡†•-‡†ß‡†©-‡†≠‡°Ä-‡°ó‡£§-‡£æ‡§Ä-‡§É‡§∫-‡§º‡§æ-‡•è‡•ë-‡•ó‡•¢-‡•£‡•¶-‡•Ø‡¶Å-‡¶É‡¶º‡¶æ-‡ßÑ‡ßá‡ßà‡ßó‡ßü-‡ß†‡®Å-‡®É‡®º‡®æ-‡©Ç‡©á‡©à‡©ã-‡©ç‡©ë‡©¶-‡©±‡©µ‡™Å-‡™É‡™º‡™æ-‡´Ö‡´á-‡´â‡´ã-‡´ç‡´¢-‡´£‡´¶-‡´Ø‡¨Å-‡¨É‡¨º‡¨æ-‡≠Ñ‡≠á‡≠à‡≠ã-‡≠ç‡≠ñ‡≠ó‡≠ü-‡≠†‡≠¶-‡≠Ø‡ÆÇ‡Ææ-‡ØÇ‡ØÜ-‡Øà‡Øä-‡Øç‡Øó‡Ø¶-‡ØØ‡∞Å-‡∞É‡±Ü-‡±à‡±ä-‡±ç‡±ï‡±ñ‡±¢-‡±£‡±¶-‡±Ø‡≤Ç‡≤É‡≤º‡≤æ-‡≥Ñ‡≥Ü-‡≥à‡≥ä-‡≥ç‡≥ï‡≥ñ‡≥¢-‡≥£‡≥¶-‡≥Ø‡¥Ç‡¥É‡µÜ-‡µà‡µó‡µ¢-‡µ£‡µ¶-‡µØ‡∂Ç‡∂É‡∑ä‡∑è-‡∑î‡∑ñ‡∑ò-‡∑ü‡∑≤‡∑≥‡∏¥-‡∏∫‡πÄ-‡πÖ‡πê-‡πô‡∫¥-‡∫π‡ªà-‡ªç‡ªê-‡ªô‡ºò‡ºô‡º†-‡º©‡ºµ‡º∑‡ºπ‡ΩÅ-‡Ωá‡Ω±-‡æÑ‡æÜ-‡æá‡æç-‡æó‡æô-‡æº‡øÜ·ÄÄ-·Ä©·ÅÄ-·Åâ·Åß-·Å≠·Å±-·Å¥·ÇÇ-·Çç·Çè-·Çù·çù-·çü·úé-·úê·ú†-·ú∞·ùÄ-·ùê·ù≤·ù≥·ûÄ-·û≤·üù·ü†-·ü©·†ã-·†ç·†ê-·†ô·§†-·§´·§∞-·§ª·•ë-·•≠·¶∞-·ßÄ·ßà-·ßâ·ßê-·ßô·®Ä-·®ï·®†-·©ì·©†-·©º·©ø-·™â·™ê-·™ô·≠Ü-·≠ã·≠ê-·≠ô·≠´-·≠≥·Æ∞-·Æπ·Ø¶-·Ø≥·∞Ä-·∞¢·±Ä-·±â·±õ-·±Ω·≥ê-·≥í·¥Ä-·∂æ·∏Å-·ºï‚Äå‚Äç‚Äø‚ÅÄ‚Åî‚Éê-‚Éú‚É°‚É•-‚É∞‚∂Å-‚∂ñ‚∑†-‚∑ø„Ä°-„Ä®„Çô„ÇöÍôÄ-Íô≠Íô¥-ÍôΩÍöüÍõ∞-Íõ±Íü∏-Í†ÄÍ†ÜÍ†ãÍ†£-Í†ßÍ¢Ä-Í¢ÅÍ¢¥-Í£ÑÍ£ê-Í£ôÍ£≥-Í£∑Í§Ä-Í§âÍ§¶-Í§≠Í§∞-Í•ÖÍ¶Ä-Í¶ÉÍ¶≥-ÍßÄÍ®Ä-Í®ßÍ©Ä-Í©ÅÍ©å-Í©çÍ©ê-Í©ôÍ©ªÍ´†-Í´©Í´≤-Í´≥ÍØÄ-ÍØ°ÍØ¨ÍØ≠ÍØ∞-ÍØπÔ¨†-Ô¨®Ô∏Ä-Ô∏èÔ∏†-Ô∏¶Ô∏≥Ô∏¥Ôπç-ÔπèÔºê-ÔºôÔºø";var nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]");var nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");exports.newline=/[\n\r\u2028\u2029]/;exports.lineBreak=new RegExp("\r\n|"+exports.newline.source);exports.allLineBreaks=new RegExp(exports.lineBreak.source,"g");exports.isIdentifierStart=function(code){if(code<65){return code===36||code===64}if(code<91){return true}if(code<97){return code===95}if(code<123){return true}return code>=170&&nonASCIIidentifierStart.test(String.fromCharCode(code))};exports.isIdentifierChar=function(code){if(code<48){return code===36}if(code<58){return true}if(code<65){return false}if(code<91){return true}if(code<97){return code===95}if(code<123){return true}return code>=170&&nonASCIIidentifier.test(String.fromCharCode(code))}},function(module,exports){function mergeOpts(allOptions,targetType){var finalOpts={};var name;for(name in allOptions){if(name!==targetType){finalOpts[name]=allOptions[name]}}if(targetType in allOptions){for(name in allOptions[targetType]){finalOpts[name]=allOptions[targetType][name]}}return finalOpts}module.exports.mergeOpts=mergeOpts},function(module,exports,__webpack_require__){var Beautifier=__webpack_require__(0).Beautifier;function style_html(html_source,options,js_beautify,css_beautify){var beautifier=new Beautifier(html_source,options,js_beautify,css_beautify);return beautifier.beautify()}module.exports=style_html}]);var style_html=legacy_beautify_html;if(typeof undefined==="function"&&undefined.amd){undefined(["require","./beautify","./beautify-css"],function(requireamd){var js_beautify=requireamd("./beautify");var css_beautify=requireamd("./beautify-css");return{html_beautify:function(html_source,options){return style_html(html_source,options,js_beautify.js_beautify,css_beautify.css_beautify)}}})}else{var js_beautify=beautify;var css_beautify=beautifyCss;exports.html_beautify=function(html_source,options){return style_html(html_source,options,js_beautify.js_beautify,css_beautify.css_beautify)}}})()});unwrapExports(beautifyHtml);var js=createCommonjsModule(function(module){function get_beautify(js_beautify,css_beautify,html_beautify){var beautify$$1=function(src,config){return js_beautify.js_beautify(src,config)};beautify$$1.js=js_beautify.js_beautify;beautify$$1.css=css_beautify.css_beautify;beautify$$1.html=html_beautify.html_beautify;beautify$$1.js_beautify=js_beautify.js_beautify;beautify$$1.css_beautify=css_beautify.css_beautify;beautify$$1.html_beautify=html_beautify.html_beautify;return beautify$$1}if(typeof undefined==="function"&&undefined.amd){undefined(["./lib/beautify","./lib/beautify-css","./lib/beautify-html"],function(js_beautify,css_beautify,html_beautify){return get_beautify(js_beautify,css_beautify,html_beautify)})}else{(function(mod){var js_beautify=beautify;var css_beautify=beautifyCss;var html_beautify=beautifyHtml;mod.exports=get_beautify(js_beautify,css_beautify,html_beautify)})(module)}});"use strict";var cache;var isWhitespace=function isWhitespace(str){return typeof str==="string"&&regex().test(str)};function regex(){return cache||(cache=new RegExp('^[\\s\t\n\v\f\r ¬†·öÄ·†é‚ÄÄ‚ÄÅ‚ÄÇ‚ÄÉ‚ÄÑ‚ÄÖ‚ÄÜ‚Äá‚Äà‚Äâ‚Ää‚ÄØ‚Åü„ÄÄ\u2028\u2029\ufeff"]+$'))}"use strict";var isExtendable=function isExtendable(val){return typeof val!=="undefined"&&val!==null&&(typeof val==="object"||typeof val==="function")};"use strict";var extendShallow=function extend(o){if(!isExtendable(o)){o={}}var len=arguments.length;for(var i=1;i<len;i++){var obj=arguments[i];if(isExtendable(obj)){assign(o,obj)}}return o};function assign(a,b){for(var key in b){if(hasOwn$5(b,key)){a[key]=b[key]}}}function hasOwn$5(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}var isBuffer_1=function(obj){return obj!=null&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)};function isBuffer(obj){return!!obj.constructor&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return typeof obj.readFloatLE==="function"&&typeof obj.slice==="function"&&isBuffer(obj.slice(0,0))}var toString$2=Object.prototype.toString;var kindOf$3=function kindOf(val){if(typeof val==="undefined"){return"undefined"}if(val===null){return"null"}if(val===true||val===false||val instanceof Boolean){return"boolean"}if(typeof val==="string"||val instanceof String){return"string"}if(typeof val==="number"||val instanceof Number){return"number"}if(typeof val==="function"||val instanceof Function){return"function"}if(typeof Array.isArray!=="undefined"&&Array.isArray(val)){return"array"}if(val instanceof RegExp){return"regexp"}if(val instanceof Date){return"date"}var type=toString$2.call(val);if(type==="[object RegExp]"){return"regexp"}if(type==="[object Date]"){return"date"}if(type==="[object Arguments]"){return"arguments"}if(type==="[object Error]"){return"error"}if(isBuffer_1(val)){return"buffer"}if(type==="[object Set]"){return"set"}if(type==="[object WeakSet]"){return"weakset"}if(type==="[object Map]"){return"map"}if(type==="[object WeakMap]"){return"weakmap"}if(type==="[object Symbol]"){return"symbol"}if(type==="[object Int8Array]"){return"int8array"}if(type==="[object Uint8Array]"){return"uint8array"}if(type==="[object Uint8ClampedArray]"){return"uint8clampedarray"}if(type==="[object Int16Array]"){return"int16array"}if(type==="[object Uint16Array]"){return"uint16array"}if(type==="[object Int32Array]"){return"int32array"}if(type==="[object Uint32Array]"){return"uint32array"}if(type==="[object Float32Array]"){return"float32array"}if(type==="[object Float64Array]"){return"float64array"}return"object"};"use strict";var condenseNewlines=function(str,options){var opts=extendShallow({},options);var sep=opts.sep||"\n\n";var min=opts.min;var re;if(typeof min==="number"&&min!==2){re=new RegExp("(\\r\\n|\\n|\\u2424) {"+min+",}")}if(typeof re==="undefined"){re=opts.regex||/(\r\n|\n|\u2424){2,}/g}if(opts.keepWhitespace!==true){str=str.split("\n").map(function(line){return isWhitespace(line)?line.trim():line}).join("\n")}str=trailingNewline(str,opts);return str.replace(re,sep)};function trailingNewline(str,options){var val=options.trailingNewline;if(val===false){return str}switch(kindOf$3(val)){case"string":str=str.replace(/\s+$/,options.trailingNewline);break;case"function":str=options.trailingNewline(str);break;case"undefined":case"boolean":default:{str=str.replace(/\s+$/,"\n");break}}return str}"use strict";var defaults$1={unformatted:["code","pre","em","strong","span"],indent_inner_html:true,indent_char:" ",indent_size:2,sep:"\n"};var pretty=function pretty(str,options){var opts=extendShallow({},defaults$1,options);str=js.html(str,opts);if(opts.ocd===true){if(opts.newlines){opts.sep=opts.newlines}return ocd(str,opts)}return str};function ocd(str,options){return condenseNewlines(str,options).replace(/^\s+/g,"").replace(/\s+$/g,"\n").replace(/(\s*<!--)/g,"\n$1").replace(/>(\s*)(?=<!--\s*\/)/g,"> ")}var script$12=function(){this.getBeautifiedHtml=(()=>{const data=this.opts.data;if(!data){return""}return pretty(data)})};riot$1.tag2("viron-prettyhtml","<pre>{getBeautifiedHtml()}</pre>","",'class="Prettyhtml"',function(opts){this.external(script$12)});var script$13=function(){const store=this.riotx.get();let isClipboardCopySupported=true;this.isMobile=store.getter("layout.isMobile");this.normalizeValue=(value=>{if(!isString_1(value)){return null}return value});this.handleTap=(()=>{if(this.opts.isdisabled){return}this.refs.input.focus()});this.handleFormSubmit=(e=>{e.preventDefault();if(!this.opts.onchange){return}if(this.opts.isdisabled){return}const newVal=this.normalizeValue(this.opts.val);this.opts.onchange(newVal,this.opts.id)});this.handleTextareaChange=(e=>{e.stopPropagation()});this.handleTextareaInput=(e=>{if(!this.opts.onchange){return}if(this.opts.isdisabled){return}const newVal=this.normalizeValue(e.target.value);this.opts.onchange(newVal,this.opts.id)});this.handleTextareaFocus=(()=>{if(!this.opts.onfocus){return}this.opts.onfocus()});this.handleTextareaBlur=(()=>{if(!this.opts.onblur){return}this.opts.onblur()});this.handleBlockerTap=(e=>{e.stopPropagation();if(this.isMobile||!isClipboardCopySupported||!this.opts.val){return}Promise.resolve().then(()=>{return clipboard.copy(this.opts.val)}).then(()=>store.action("toasts.add",{message:"„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü„ÄÇ"})).catch(()=>{isClipboardCopySupported=false;store.action("toasts.add",{type:"error",message:"„Åî‰ΩøÁî®‰∏≠„ÅÆ„Éñ„É©„Ç¶„Ç∂„Åß„ÅØ„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„ÉºÂá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"})})})};riot$1.tag2("viron-textarea",'<div class="Textarea__label" if="{!!opts.label}">{opts.label}</div> <form class="Textarea__form" ref="form" onsubmit="{handleFormSubmit}"> <virtual if="{!opts.ispreview}"> <textarea class="Textarea__input" ref="input" riot-value="{normalizeValue(opts.val)}" placeholder="{opts.placeholder}" disabled="{!!opts.isdisabled}" oninput="{handleTextareaInput}" onchange="{handleTextareaChange}" onfocus="{handleTextareaFocus}" onblur="{handleTextareaBlur}"></textarea> </virtual> <virtual if="{opts.ispreview}"> <pre class="Textarea__input Textarea__input--break">{normalizeValue(opts.val)}</pre> </virtual> </form> <div class="Textarea__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"",'class="Textarea {\'Textarea--disabled\': opts.isdisabled, \'Textarea--error\': opts.iserror}" onclick="{getClickHandler(\'handleTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleTap\')}"',function(opts){this.external(script$13)});var script$14=function(){const store=this.riotx.get();let isClipboardCopySupported=true;this.isMobile=store.getter("layout.isMobile");this.isEditorMode=true;this.isPreviewMode=false;this.on("mount",()=>{this.update()}).on("update",()=>{});this.handleEditorTabTap=(()=>{this.isEditorMode=true;this.isPreviewMode=false;this.update()});this.handlePreviewTabTap=(()=>{this.isEditorMode=false;this.isPreviewMode=true;this.update()});this.handleEditorChange=(newText=>{if(!this.opts.onchange){return}this.opts.onchange(newText)});this.handleEditorFocus=(()=>{if(!this.opts.onfocus){return}this.opts.onfocus()});this.handleEditorBlur=(()=>{if(!this.opts.onblur){return}this.opts.onblur()});this.handleBlockerTap=(e=>{e.stopPropagation();if(this.isMobile||!isClipboardCopySupported||!this.opts.val){return}Promise.resolve().then(()=>{return clipboard.copy(this.opts.val)}).then(()=>store.action("toasts.add",{message:"„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü„ÄÇ"})).catch(()=>{isClipboardCopySupported=false;store.action("toasts.add",{type:"error",message:"„Åî‰ΩøÁî®‰∏≠„ÅÆ„Éñ„É©„Ç¶„Ç∂„Åß„ÅØ„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„ÉºÂá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"})})})};riot$1.tag2("viron-html",'<div class="Html__tabs"> <div class="Html__tab {\'Html__tab--selected\': isEditorMode}" onclick="{getClickHandler(\'handleEditorTabTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleEditorTabTap\')}">„Ç®„Éá„Ç£„Çø</div> <div class="Html__tab {\'Html__tab--selected\': isPreviewMode}" onclick="{getClickHandler(\'handlePreviewTabTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePreviewTabTap\')}">„Éó„É¨„Éì„É•„Éº</div> </div> <div class="Html__body"> <div class="Html__editor" if="{isEditorMode}"> <viron-textarea val="{opts.val}" isdisabled="{opts.isdisabled}" onchange="{handleEditorChange}" onfocus="{handleEditorFocus}" onblur="{handleEditorBlur}"></viron-textarea> </div> <div class="Html__preview" if="{isPreviewMode}"> <viron-prettyhtml data="{opts.val}"></viron-prettyhtml> </div> </div> <div class="Html__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"","class=\"Html {'Html--disabled': opts.isdisabled, 'Html--error': opts.haserror}\"",function(opts){this.external(script$14)});var script$15=function(){const store=this.riotx.get();this.handleBlockerTap=(e=>{e.stopPropagation();if(!this.opts.ispreview){return}store.action("mediapreviews.add",{path:this.opts.val})})};riot$1.tag2("viron-image",'<div class="Image__content" riot-style="background-image:url({opts.val});"></div> <div class="Image__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"",'class="Image"',function(opts){this.external(script$15)});function isNaN$3(val){return typeof val==="number"&&val!=val}var _isNaN$1=isNaN$3;function isNaN$1(val){return!isNumber_1(val)||_isNaN$1(Number(val))}var _isNaN=isNaN$1;var script$16=function(){const store=this.riotx.get();let isClipboardCopySupported=true;this.isMobile=store.getter("layout.isMobile");const isNumber=num=>{if(_isNaN(num)){return false}return isNumber_1(num)};this.normalizeValue=(value=>{if(isNull_1(value)){return value}if(isUndefined(value)){return null}if(isString_1(value)){value=value.replace(/[^-^0-9]/g,"");if(!value.length){return null}value=Number(value);if(_isNaN(value)){return null}}return value});this.handleTap=(()=>{this.refs.input.focus()});this.handleFormSubmit=(e=>{e.preventDefault();if(!this.opts.onchange){return}const newVal=this.normalizeValue(this.opts.val);this.opts.onchange(newVal,this.opts.id)});this.handleInputChange=(e=>{e.stopPropagation()});this.handleInputInput=(e=>{if(!this.opts.onchange){return}const newVal=this.normalizeValue(e.target.value);this.opts.onchange(newVal,this.opts.id)});this.handleInputFocus=(()=>{if(!this.opts.onfocus){return}this.opts.onfocus()});this.handleInputBlur=(()=>{if(!this.opts.onblur){return}this.opts.onblur()});this.handleBlockerTap=(e=>{e.stopPropagation();if(this.isMobile||!isClipboardCopySupported||!isNumber(this.opts.val)){return}Promise.resolve().then(()=>{return clipboard.copy(String(this.opts.val))}).then(()=>store.action("toasts.add",{message:"„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü„ÄÇ"})).catch(()=>{isClipboardCopySupported=false;store.action("toasts.add",{type:"error",message:"„Åî‰ΩøÁî®‰∏≠„ÅÆ„Éñ„É©„Ç¶„Ç∂„Åß„ÅØ„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„ÉºÂá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"})})})};riot$1.tag2("viron-numberinput",'<div class="Numberinput__label" if="{!!opts.label}">{opts.label}</div> <form class="Numberinput__form" ref="form" onsubmit="{handleFormSubmit}"> <input class="Numberinput__input" ref="input" type="text" riot-value="{normalizeValue(opts.val)}" placeholder="{opts.placeholder}" disabled="{!!opts.isdisabled}" oninput="{handleInputInput}" onchange="{handleInputChange}" onfocus="{handleInputFocus}" onblur="{handleInputBlur}"> </form> <div class="Numberinput__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"",'class="Numberinput {\'Numberinput--disabled\': opts.isdisabled, \'Numberinput--error\': opts.iserror} Numberinput--{opts.theme}" onclick="{getClickHandler(\'handleTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleTap\')}"',function(opts){this.external(script$16)});var script$17=function(){const store=this.riotx.get();let isClipboardCopySupported=true;this.isMobile=store.getter("layout.isMobile");this.isEditorMode=true;this.isPreviewMode=false;this.on("mount",()=>{this.update()}).on("update",()=>{});this.handleEditorTabTap=(()=>{this.isEditorMode=true;this.isPreviewMode=false;this.update()});this.handlePreviewTabTap=(()=>{this.isEditorMode=false;this.isPreviewMode=true;this.update()});this.handleEditorChange=(newText=>{if(!this.opts.onchange){return}this.opts.onchange(newText)});this.handleEditorFocus=(()=>{if(!this.opts.onfocus){return}this.opts.onfocus()});this.handleEditorBlur=(()=>{if(!this.opts.onblur){return}this.opts.onblur()});this.handleBlockerTap=(e=>{e.stopPropagation();e.stopPropagation();if(this.isMobile||!isClipboardCopySupported||!this.opts.val){return}Promise.resolve().then(()=>{return clipboard.copy(this.opts.val)}).then(()=>store.action("toasts.add",{message:"„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü„ÄÇ"})).catch(()=>{isClipboardCopySupported=false;store.action("toasts.add",{type:"error",message:"„Åî‰ΩøÁî®‰∏≠„ÅÆ„Éñ„É©„Ç¶„Ç∂„Åß„ÅØ„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„ÉºÂá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"})})})};riot$1.tag2("viron-pug",'<div class="Pug__tabs"> <div class="Pug__tab {\'Pug__tab--selected\': isEditorMode}" onclick="{getClickHandler(\'handleEditorTabTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleEditorTabTap\')}">„Ç®„Éá„Ç£„Çø</div> <div class="Pug__tab {\'Pug__tab--selected\': isPreviewMode}" onclick="{getClickHandler(\'handlePreviewTabTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePreviewTabTap\')}">„Éó„É¨„Éì„É•„Éº</div> </div> <div class="Pug__body"> <div class="Pug__editor" if="{isEditorMode}"> <viron-textarea val="{opts.val}" isdisabled="{opts.isdisabled}" onchange="{handleEditorChange}" onfocus="{handleEditorFocus}" onblur="{handleEditorBlur}"></viron-textarea> </div> <div class="Pug__preview" if="{isPreviewMode}"> <viron-prettyhtml data="{opts.val}"></viron-prettyhtml> </div> </div> <div class="Pug__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"","class=\"Pug {'Pug--disabled': opts.isdisabled, 'Pug--error': opts.haserror}\"",function(opts){this.external(script$17)});riot$1.tag2("viron-icon-arrow-down",'<svg viewbox="-3523.999 14062.964 16.004 10.037"> <path d="M1736.94-16726.932l-5.963-5.963-1.433-1.432-.019-.023-.384-.385a.2.2,0,0,1,0-.281l7.8-7.8a.2.2,0,0,1,.281,0l1.84,1.84a.2.2,0,0,1,0,.277l-5.82,5.824,5.82,5.818a.205.205,0,0,1,0,.283l-1.84,1.84a.2.2,0,0,1-.141.061A.2.2,0,0,1,1736.94-16726.932Z" transform="translate(13218.876 15802.083) rotate(-90)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconArrowDown {opts.class}"',function(opts){});var script$18=function(){const getNewOptions=()=>{const selectedIndex=this.refs.select.selectedIndex;const newOptions=[];forEach_1$2(this.opts.options,(option,idx)=>{newOptions.push(objectAssign({},option,{isSelected:idx===selectedIndex}))});return newOptions};this.handleFormSubmit=(e=>{e.preventDefault();if(!this.opts.onchange){return}if(this.opts.isdisabled){return}this.opts.onchange(getNewOptions())});this.handleSelectInput=(()=>{if(!this.opts.onchange){return}if(this.opts.isdisabled){return}this.opts.onchange(getNewOptions())});this.handleSelectChange=(e=>{e.stopPropagation()});this.handleBlockerTap=(e=>{e.stopPropagation()})};riot$1.tag2("viron-select",'<form class="Select__form" onsubmit="{handleFormSubmit}"> <select class="Select__select" ref="select" disabled="{opts.isdisabled}" oninput="{handleSelectInput}" onchange="{handleSelectChange}"> <option class="Select__option" each="{option in opts.options}" selected="{option.isSelected}">{option.label}</option> </select> <viron-icon-arrow-down class="Select__icon"></viron-icon-arrow-down> </form> <div class="Select__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"","class=\"Select {'Select--disabled': opts.isdisabled, 'Select--error': opts.iserror}\"",function(opts){this.external(script$18)});var script$19=function(){const store=this.riotx.get();let isClipboardCopySupported=true;this.isMobile=store.getter("layout.isMobile");this.normalizeValue=(value=>{if(!isString_1(value)){return null}return value});this.handleTap=(()=>{if(this.opts.isdisabled){return}this.refs.input.focus()});this.handleFormSubmit=(e=>{e.preventDefault();if(!this.opts.onchange){return}const newVal=this.normalizeValue(this.opts.val);this.opts.onchange(newVal,this.opts.id)});this.handleInputChange=(e=>{e.stopPropagation()});this.handleInputInput=(e=>{if(!this.opts.onchange){return}if(this.opts.isdisabled){return}const newVal=this.normalizeValue(e.target.value);this.opts.onchange(newVal,this.opts.id)});this.handleInputFocus=(()=>{if(!this.opts.onfocus){return}this.opts.onfocus()});this.handleInputBlur=(()=>{if(!this.opts.onblur){return}this.opts.onblur()});this.handleBlockerTap=(e=>{e.stopPropagation();if(this.isMobile||!isClipboardCopySupported||!this.opts.val){return}Promise.resolve().then(()=>{return clipboard.copy(this.opts.val)}).then(()=>store.action("toasts.add",{message:"„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü„ÄÇ"})).catch(()=>{isClipboardCopySupported=false;store.action("toasts.add",{type:"error",message:"„Åî‰ΩøÁî®‰∏≠„ÅÆ„Éñ„É©„Ç¶„Ç∂„Åß„ÅØ„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„Ç≥„Éî„ÉºÂá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"})})})};riot$1.tag2("viron-textinput",'<div class="Textinput__label" if="{!!opts.label}">{opts.label}</div> <form class="Textinput__form" ref="form" onsubmit="{handleFormSubmit}"> <input class="Textinput__input" ref="input" type="{opts.type || \'text\'}" riot-value="{normalizeValue(opts.val)}" placeholder="{opts.placeholder}" disabled="{!!opts.isdisabled}" oninput="{handleInputInput}" onchange="{handleInputChange}" onfocus="{handleInputFocus}" onblur="{handleInputBlur}"> </form> <div class="Textinput__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"",'class="Textinput {\'Textinput--disabled\': opts.isdisabled, \'Textinput--error\': opts.iserror} Textinput--{opts.theme}" onclick="{getClickHandler(\'handleTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleTap\')}"',function(opts){this.external(script$19)});riot$1.tag2("viron-icon-file",'<svg viewbox="3093.704 22727.934 46.089 60.576"> <path d="M78.81,0H54.481a6.457,6.457,0,0,0-6.447,6.447V54.128a6.454,6.454,0,0,0,6.447,6.447h33.2a6.454,6.454,0,0,0,6.445-6.447V15.259Zm8.867,56.627h-33.2a2.5,2.5,0,0,1-2.5-2.5V51.239s0-20.952,0-44.792a2.5,2.5,0,0,1,2.5-2.495l22.852-.024v8.447A4.473,4.473,0,0,0,81.8,16.847l8.275-.024.093,37.305A2.5,2.5,0,0,1,87.678,56.627Z" transform="translate(3045.671 22727.934)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconFile {opts.class}"',function(opts){});riot$1.tag2("viron-icon-file-add",'<svg viewbox="2937 22889 57.219 64.002"> <g transform="translate(2863 22751)"> <g transform="translate(-347 -90)"> <g transform="translate(421 228)"> <path d="M6.449,56.554a2.5,2.5,0,0,1-2.5-2.5V6.449a2.5,2.5,0,0,1,2.5-2.482l22.825-.02v8.442a4.476,4.476,0,0,0,4.476,4.476l8.259-.02.041,19.509a13.014,13.014,0,0,1,1.79-.122,15.508,15.508,0,0,1,2.2.163V15.237L30.739,0H6.449A6.451,6.451,0,0,0,0,6.449V54.072a6.451,6.451,0,0,0,6.449,6.449H33.363a14.909,14.909,0,0,1-2.645-3.947H6.449Z"></path> </g> <g transform="translate(169.449 90.915)"> <g transform="translate(282 174.316)"> <path d="M-4190.615-7823.229A13.4,13.4,0,0,1-4204-7836.616,13.4,13.4,0,0,1-4190.615-7850a13.4,13.4,0,0,1,13.385,13.385A13.4,13.4,0,0,1-4190.615-7823.229Zm-6.292-14.64a.4.4,0,0,0-.4.4v1.71a.4.4,0,0,0,.4.4h5.038v5.038a.4.4,0,0,0,.4.4h1.71a.4.4,0,0,0,.4-.4v-5.038h5.038a.4.4,0,0,0,.4-.4v-1.71a.4.4,0,0,0-.4-.4h-5.038v-5.04a.4.4,0,0,0-.4-.4h-1.71a.4.4,0,0,0-.4.4v5.04Z" transform="translate(4204 7850)"></path> </g> </g> </g> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconFileAdd {opts.class}"',function(opts){});riot$1.tag2("viron-icon-file-csv",'<svg viewbox="3040.477 22887.934 49.316 60.576"> <path d="M42.872,60.575H9.675a6.454,6.454,0,0,1-6.448-6.447V51.24H2.6a2.6,2.6,0,0,1-2.6-2.6V32.886a2.6,2.6,0,0,1,2.6-2.6h.629V6.448A6.455,6.455,0,0,1,9.675,0H34L49.316,15.259v38.87A6.453,6.453,0,0,1,42.872,60.575ZM7.177,51.239v2.89a2.5,2.5,0,0,0,2.5,2.5h33.2a2.5,2.5,0,0,0,2.495-2.5l-.093-37.306L37,16.846a4.476,4.476,0,0,1-4.471-4.47V3.929L9.675,3.952a2.5,2.5,0,0,0-2.5,2.5v23.84H38.124a2.6,2.6,0,0,1,2.6,2.6V48.641a2.6,2.6,0,0,1-2.6,2.6H7.177Zm10.262-6.831a.6.6,0,0,0-.3.084.521.521,0,0,0-.28.48,1.662,1.662,0,0,0,.248.872,1.247,1.247,0,0,0,.664.553,6.509,6.509,0,0,0,2.256.352c2.749,0,4.144-1.131,4.144-3.361a3.17,3.17,0,0,0-.84-2.272,7.269,7.269,0,0,0-3-1.568c-1-.33-1.5-.884-1.5-1.648a1.3,1.3,0,0,1,.417-1.024,1.788,1.788,0,0,1,1.216-.368,6.72,6.72,0,0,1,2.384.448.691.691,0,0,0,.257.053.646.646,0,0,0,.35-.108.586.586,0,0,0,.288-.52,1.472,1.472,0,0,0-.256-.841,1.168,1.168,0,0,0-.672-.488,8.977,8.977,0,0,0-2.512-.3,4.058,4.058,0,0,0-2.736.849,2.907,2.907,0,0,0-.976,2.3,3.124,3.124,0,0,0,.856,2.208,6.7,6.7,0,0,0,2.776,1.552,3.284,3.284,0,0,1,1.3.728A1.453,1.453,0,0,1,21.9,43.42c0,1.019-.684,1.536-2.032,1.536a5.049,5.049,0,0,1-2.16-.481A.606.606,0,0,0,17.439,44.408Zm-5.713-9.66a5.161,5.161,0,0,0-4.008,1.577,6.368,6.368,0,0,0-1.432,4.424,6.228,6.228,0,0,0,1.48,4.44,5.282,5.282,0,0,0,4.008,1.561,11.7,11.7,0,0,0,2-.144,1.013,1.013,0,0,0,.671-.4,1.237,1.237,0,0,0,.256-.768.659.659,0,0,0-.288-.56.758.758,0,0,0-.449-.15.851.851,0,0,0-.191.023,7.671,7.671,0,0,1-1.76.208,3.134,3.134,0,0,1-2.5-1.1,4.656,4.656,0,0,1-.944-3.1,4.758,4.758,0,0,1,.9-3.1,3.075,3.075,0,0,1,2.488-1.088,7.264,7.264,0,0,1,1.728.193.865.865,0,0,0,.19.022.724.724,0,0,0,.442-.151.665.665,0,0,0,.28-.56,1.194,1.194,0,0,0-.272-.768,1.077,1.077,0,0,0-.688-.4A12.221,12.221,0,0,0,11.726,34.747Zm14.4.16a.857.857,0,0,0-.816,1.136l3.136,9.409a1.556,1.556,0,0,0,.6.823,1.665,1.665,0,0,0,.984.312,1.633,1.633,0,0,0,.976-.312,1.66,1.66,0,0,0,.608-.823l3.136-9.44a.838.838,0,0,0-.112-.76.778.778,0,0,0-.672-.344,1.559,1.559,0,0,0-1.488,1.12L30.062,44.38l-2.416-8.32a1.582,1.582,0,0,0-1.52-1.152Z" transform="translate(3040.477 22887.934)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconFileCSV {opts.class}"',function(opts){});var script$20=function(){this.inputId=`Uploader__input${this._riot_id}`;this.file=null;this.fileName=null;this.isTypeOfImage=false;this.isTypeOfCsv=false;this.isTypeOfOther=false;this.blobURL=this.opts.initialbloburl||null;this.isDragWatching=false;this.isDroppable=false;this.reset=(()=>{window.URL.revokeObjectURL(this.blobURL);this.refs.form.reset();this.file=null;this.fileName=null;this.isTypeOfImage=false;this.isTypeOfCsv=false;this.isTypeOfOther=false;this.blobURL=this.opts.initialbloburl||null;this.opts.onchange&&this.opts.onchange(this.file,this.blobURL)});this.handleChange=(e=>{e.stopPropagation()});this.handleFileChange=((e,fromDnD)=>{if(!this.opts.onchange){return}if(this.opts.isdisabled){return}let files;if(fromDnD){files=e.dataTransfer.files}else{files=e.target.files}if(!files.length){this.reset();return}const file=files[0];this.file=file;this.fileName=file.name;if(file.type.indexOf("image/")===0){this.isTypeOfImage=true;this.isTypeOfCsv=false;this.isTypeOfOther=false}else if(file.type.indexOf("text/csv")===0){this.isTypeOfImage=false;this.isTypeOfCsv=true;this.isTypeOfOther=false}else{this.isTypeOfImage=false;this.isTypeOfCsv=false;this.isTypeOfOther=true}this.blobURL=window.URL.createObjectURL(file);this.opts.onchange(this.file,this.blobURL)});this.handleHandlerDragEnter=(e=>{e.preventDefault();if(this.opts.isdisabled){return}this.isDragWatching=true;this.update()});this.handleHandlerDragOver=(e=>{e.preventDefault()});this.handleHandlerDragLeave=(()=>{if(this.opts.isdisabled){return}this.isDragWatching=false;this.update()});this.handleHandlerDrop=(e=>{e.preventDefault();if(this.opts.isdisabled){return}this.isDragWatching=false;this.update();this.handleFileChange(e,true)});this.handleResetButtonTap=(()=>{if(this.opts.isdisabled){return}this.reset()});this.handleBlockerTap=(e=>{e.stopPropagation()})};riot$1.tag2("viron-uploader",'<form class="Uploader__form" ref="form"> <input class="Uploader__input" type="file" id="{inputId}" accept="{opts.accept || \'*\'}" disabled="{opts.isdisabled}" onchange="{handleFileChange}"> <label class="Uploader__label" for="{inputId}"> <virtual if="{!file || !blobURL}"> <div class="Uploader__icon"> <viron-icon-file-add></viron-icon-file-add> </div> </virtual> <virtual if="{!!file &amp;&amp; !!blobURL}"> <virtual if="{isTypeOfImage}"> <div class="Uploader__image" riot-style="background-image:url({blobURL});"></div> </virtual> <virtual if="{isTypeOfCsv}"> <div class="Uploader__icon"> <viron-icon-file-csv></viron-icon-file-csv> </div> </virtual> <virtual if="{isTypeOfOther}"> <div class="Uploader__icon"> <viron-icon-file></viron-icon-file> </div> </virtual> </virtual> <div class="Uploader__dragHandler" ondragenter="{handleHandlerDragEnter}" ondragover="{handleHandlerDragOver}" ondragleave="{handleHandlerDragLeave}" ondrop="{handleHandlerDrop}"></div> </label> </form> <div class="Uploader__reset" if="{!!file}" onclick="{getClickHandler(\'handleResetButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleResetButtonTap\')}"> <viron-icon-close></viron-icon-close> </div> <div class="Uploader__fileName" if="{!!fileName}">{fileName}</div> <div class="Uploader__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"","class=\"Uploader {'Uploader--dragWatching' : isDragWatching, 'Uploader--disabled': opts.isdisabled, 'Uploader--error': opts.haserror}\" onchange=\"{handleChange}\"",function(opts){this.external(script$20)});function now(){return now.get()}now.get=typeof Date.now==="function"?Date.now:function(){return+new Date};var now_1=now;function throttle(fn,delay){var context,timeout,result,args,diff,prevCall=0;function delayed(){prevCall=now_1();timeout=null;result=fn.apply(context,args)}function throttled(){context=this;args=arguments;diff=delay-(now_1()-prevCall);if(diff<=0){clearTimeout(timeout);delayed()}else if(!timeout){timeout=setTimeout(delayed,diff)}return result}throttled.cancel=function(){clearTimeout(timeout)};return throttled}var throttle_1=throttle;var tinymce$1=createCommonjsModule(function(module){(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!Array",Array);defineGlobal("global!Error",Error);define("ephox.katamari.api.Fun",["global!Array","global!Error"],function(Array,Error){var noop=function(){};var noarg=function(f){return function(){return f()}};var compose=function(fa,fb){return function(){return fa(fb.apply(null,arguments))}};var constant=function(value){return function(){return value}};var identity=function(x){return x};var tripleEquals=function(a,b){return a===b};var curry=function(f){var args=new Array(arguments.length-1);for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}return function(){var newArgs=new Array(arguments.length);for(var j=0;j<newArgs.length;j++){newArgs[j]=arguments[j]}var all=args.concat(newArgs);return f.apply(null,all)}};var not=function(f){return function(){return!f.apply(null,arguments)}};var die=function(msg){return function(){throw new Error(msg)}};var apply=function(f){return f()};var call=function(f){f()};var never=constant(false);var always=constant(true);return{noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always}});defineGlobal("global!window",window);defineGlobal("global!Object",Object);define("ephox.katamari.api.Option",["ephox.katamari.api.Fun","global!Object"],function(Fun,Object){var never=Fun.never;var always=Fun.always;var none=function(){return NONE};var NONE=function(){var eq=function(o){return o.isNone()};var call=function(thunk){return thunk()};var id=function(n){return n};var noop=function(){};var me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},or:id,orThunk:call,map:none,ap:none,each:noop,bind:none,flatten:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:Fun.constant("none()")};if(Object.freeze){Object.freeze(me)}return me}();var some=function(a){var constant_a=function(){return a};var self=function(){return me};var map=function(f){return some(f(a))};var bind=function(f){return f(a)};var me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,or:self,orThunk:self,map:map,ap:function(optfab){return optfab.fold(none,function(fab){return some(fab(a))})},each:function(f){f(a)},bind:bind,flatten:constant_a,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return me};var from=function(value){return value===null||value===undefined?NONE:some(value)};return{some:some,none:none,from:from}});defineGlobal("global!String",String);define("ephox.katamari.api.Arr",["ephox.katamari.api.Option","global!Array","global!Error","global!String"],function(Option,Array,Error,String){var rawIndexOf=function(){var pIndexOf=Array.prototype.indexOf;var fastIndex=function(xs,x){return pIndexOf.call(xs,x)};var slowIndex=function(xs,x){return slowIndexOf(xs,x)};return pIndexOf===undefined?slowIndex:fastIndex}();var indexOf=function(xs,x){var r=rawIndexOf(xs,x);return r===-1?Option.none():Option.some(r)};var contains=function(xs,x){return rawIndexOf(xs,x)>-1};var exists=function(xs,pred){return findIndex(xs,pred).isSome()};var range=function(num,f){var r=[];for(var i=0;i<num;i++){r.push(f(i))}return r};var chunk=function(array,size){var r=[];for(var i=0;i<array.length;i+=size){var s=array.slice(i,i+size);r.push(s)}return r};var map=function(xs,f){var len=xs.length;var r=new Array(len);for(var i=0;i<len;i++){var x=xs[i];r[i]=f(x,i,xs)}return r};var each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];f(x,i,xs)}};var eachr=function(xs,f){for(var i=xs.length-1;i>=0;i--){var x=xs[i];f(x,i,xs)}};var partition=function(xs,pred){var pass=[];var fail=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];var arr=pred(x,i,xs)?pass:fail;arr.push(x)}return{pass:pass,fail:fail}};var filter=function(xs,pred){var r=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs)){r.push(x)}}return r};var groupBy=function(xs,f){if(xs.length===0){return[]}else{var wasType=f(xs[0]);var r=[];var group=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];var type=f(x);if(type!==wasType){r.push(group);group=[]}wasType=type;group.push(x)}if(group.length!==0){r.push(group)}return r}};var foldr=function(xs,f,acc){eachr(xs,function(x){acc=f(acc,x)});return acc};var foldl=function(xs,f,acc){each(xs,function(x){acc=f(acc,x)});return acc};var find=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs)){return Option.some(x)}}return Option.none()};var findIndex=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs)){return Option.some(i)}}return Option.none()};var slowIndexOf=function(xs,x){for(var i=0,len=xs.length;i<len;++i){if(xs[i]===x){return i}}return-1};var push=Array.prototype.push;var flatten=function(xs){var r=[];for(var i=0,len=xs.length;i<len;++i){if(!Array.prototype.isPrototypeOf(xs[i])){throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs)}push.apply(r,xs[i])}return r};var bind=function(xs,f){var output=map(xs,f);return flatten(output)};var forall=function(xs,pred){for(var i=0,len=xs.length;i<len;++i){var x=xs[i];if(pred(x,i,xs)!==true){return false}}return true};var equal=function(a1,a2){return a1.length===a2.length&&forall(a1,function(x,i){return x===a2[i]})};var slice=Array.prototype.slice;var reverse=function(xs){var r=slice.call(xs,0);r.reverse();return r};var difference=function(a1,a2){return filter(a1,function(x){return!contains(a2,x)})};var mapToObject=function(xs,f){var r={};for(var i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r};var pure=function(x){return[x]};var sort=function(xs,comparator){var copy=slice.call(xs,0);copy.sort(comparator);return copy};var head=function(xs){return xs.length===0?Option.none():Option.some(xs[0])};var last=function(xs){return xs.length===0?Option.none():Option.some(xs[xs.length-1])};return{map:map,each:each,eachr:eachr,partition:partition,filter:filter,groupBy:groupBy,indexOf:indexOf,foldr:foldr,foldl:foldl,find:find,findIndex:findIndex,flatten:flatten,bind:bind,forall:forall,exists:exists,contains:contains,equal:equal,reverse:reverse,chunk:chunk,difference:difference,mapToObject:mapToObject,pure:pure,sort:sort,range:range,head:head,last:last}});defineGlobal("global!document",document);define("ephox.katamari.api.Global",[],function(){var global=typeof window!=="undefined"?window:Function("return this;")();return global});define("ephox.katamari.api.Resolve",["ephox.katamari.api.Global"],function(Global){var path=function(parts,scope){var o=scope!==undefined?scope:Global;for(var i=0;i<parts.length&&o!==undefined&&o!==null;++i){o=o[parts[i]]}return o};var resolve=function(p,scope){var parts=p.split(".");return path(parts,scope)};var step=function(o,part){if(o[part]===undefined||o[part]===null){o[part]={}}return o[part]};var forge=function(parts,target){var o=target!==undefined?target:Global;for(var i=0;i<parts.length;++i){o=step(o,parts[i])}return o};var namespace=function(name,target){var parts=name.split(".");return forge(parts,target)};return{path:path,resolve:resolve,forge:forge,namespace:namespace}});define("ephox.sand.util.Global",["ephox.katamari.api.Resolve"],function(Resolve){var unsafe=function(name,scope){return Resolve.resolve(name,scope)};var getOrDie=function(name,scope){var actual=unsafe(name,scope);if(actual===undefined){throw name+" not available on this browser"}return actual};return{getOrDie:getOrDie}});define("ephox.sand.api.URL",["ephox.sand.util.Global"],function(Global){var url=function(){return Global.getOrDie("URL")};var createObjectURL=function(blob){return url().createObjectURL(blob)};var revokeObjectURL=function(u){url().revokeObjectURL(u)};return{createObjectURL:createObjectURL,revokeObjectURL:revokeObjectURL}});defineGlobal("global!matchMedia",matchMedia);defineGlobal("global!navigator",navigator);define("tinymce.core.Env",["ephox.sand.api.URL","global!document","global!matchMedia","global!navigator","global!window"],function(URL,document,matchMedia,navigator,window){var nav=navigator,userAgent=nav.userAgent;var opera,webkit,ie,ie11,ie12,gecko,mac,iDevice,android,fileApi,phone,tablet,windowsPhone;var matchMediaQuery=function(query){return"matchMedia"in window?matchMedia(query).matches:false};opera=window.opera&&window.opera.buildNumber;android=/Android/.test(userAgent);webkit=/WebKit/.test(userAgent);ie=!webkit&&!opera&&/MSIE/gi.test(userAgent)&&/Explorer/gi.test(nav.appName);ie=ie&&/MSIE (\w+)\./.exec(userAgent)[1];ie11=userAgent.indexOf("Trident/")!=-1&&(userAgent.indexOf("rv:")!=-1||nav.appName.indexOf("Netscape")!=-1)?11:false;ie12=userAgent.indexOf("Edge/")!=-1&&!ie&&!ie11?12:false;ie=ie||ie11||ie12;gecko=!webkit&&!ie11&&/Gecko/.test(userAgent);mac=userAgent.indexOf("Mac")!=-1;iDevice=/(iPad|iPhone)/.test(userAgent);fileApi="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL;phone=matchMediaQuery("only screen and (max-device-width: 480px)")&&(android||iDevice);tablet=matchMediaQuery("only screen and (min-width: 800px)")&&(android||iDevice);windowsPhone=userAgent.indexOf("Windows Phone")!=-1;if(ie12){webkit=false}var contentEditable=!iDevice||fileApi||userAgent.match(/AppleWebKit\/(\d*)/)[1]>=534;return{opera:opera,webkit:webkit,ie:ie,gecko:gecko,mac:mac,iOS:iDevice,android:android,contentEditable:contentEditable,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:ie!=8,range:window.getSelection&&"Range"in window,documentMode:ie&&!ie12?document.documentMode||7:10,fileApi:fileApi,ceFalse:ie===false||ie>8,canHaveCSP:ie===false||ie>11,desktop:!phone&&!tablet,windowsPhone:windowsPhone}});defineGlobal("global!clearInterval",clearInterval);defineGlobal("global!clearTimeout",clearTimeout);defineGlobal("global!setInterval",setInterval);defineGlobal("global!setTimeout",setTimeout);define("tinymce.core.util.Promise",[],function(){if(window.Promise){return window.Promise}var asap=Promise.immediateFn||typeof setImmediate==="function"&&setImmediate||function(fn){setTimeout(fn,1)};function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}var isArray=Array.isArray||function(value){return Object.prototype.toString.call(value)==="[object Array]"};function Promise(fn){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof fn!=="function"){throw new TypeError("not a function")}this._state=null;this._value=null;this._deferreds=[];doResolve(fn,bind(resolve,this),bind(reject,this))}function handle(deferred){var me=this;if(this._state===null){this._deferreds.push(deferred);return}asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(cb===null){(me._state?deferred.resolve:deferred.reject)(me._value);return}var ret;try{ret=cb(me._value)}catch(e){deferred.reject(e);return}deferred.resolve(ret)})}function resolve(newValue){try{if(newValue===this){throw new TypeError("A promise cannot be resolved with itself.")}if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(typeof then==="function"){doResolve(bind(then,newValue),bind(resolve,this),bind(reject,this));return}}this._state=true;this._value=newValue;finale.call(this)}catch(e){reject.call(this,e)}}function reject(newValue){this._state=false;this._value=newValue;finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++){handle.call(this,this._deferreds[i])}this._deferreds=null}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.resolve=resolve;this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=false;try{fn(function(value){if(done){return}done=true;onFulfilled(value)},function(reason){if(done){return}done=true;onRejected(reason)})}catch(ex){if(done){return}done=true;onRejected(ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject))})};Promise.all=function(){var args=Array.prototype.slice.call(arguments.length===1&&isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,reject){if(args.length===0){return resolve([])}var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};return Promise});define("tinymce.core.util.Delay",["global!clearInterval","global!clearTimeout","global!document","global!setInterval","global!setTimeout","global!window","tinymce.core.util.Promise"],function(clearInterval,clearTimeout,document,setInterval,setTimeout,window,Promise){var requestAnimationFramePromise;var requestAnimationFrame=function(callback,element){var i,requestAnimationFrameFunc=window.requestAnimationFrame,vendors=["ms","moz","webkit"];var featurefill=function(callback){window.setTimeout(callback,0)};for(i=0;i<vendors.length&&!requestAnimationFrameFunc;i++){requestAnimationFrameFunc=window[vendors[i]+"RequestAnimationFrame"]}if(!requestAnimationFrameFunc){requestAnimationFrameFunc=featurefill}requestAnimationFrameFunc(callback,element)};var wrappedSetTimeout=function(callback,time){if(typeof time!="number"){time=0}return setTimeout(callback,time)};var wrappedSetInterval=function(callback,time){if(typeof time!="number"){time=1}return setInterval(callback,time)};var wrappedClearTimeout=function(id){return clearTimeout(id)};var wrappedClearInterval=function(id){return clearInterval(id)};var debounce=function(callback,time){var timer,func;func=function(){var args=arguments;clearTimeout(timer);timer=wrappedSetTimeout(function(){callback.apply(this,args)},time)};func.stop=function(){clearTimeout(timer)};return func};return{requestAnimationFrame:function(callback,element){if(requestAnimationFramePromise){requestAnimationFramePromise.then(callback);return}requestAnimationFramePromise=new Promise(function(resolve){if(!element){element=document.body}requestAnimationFrame(resolve,element)}).then(callback)},setTimeout:wrappedSetTimeout,setInterval:wrappedSetInterval,setEditorTimeout:function(editor,callback,time){return wrappedSetTimeout(function(){if(!editor.removed){callback()}},time)},setEditorInterval:function(editor,callback,time){var timer;timer=wrappedSetInterval(function(){if(!editor.removed){callback()}else{clearInterval(timer)}},time);return timer},debounce:debounce,throttle:debounce,clearInterval:wrappedClearInterval,clearTimeout:wrappedClearTimeout}});define("tinymce.core.dom.EventUtils",["global!document","global!window","tinymce.core.Env","tinymce.core.util.Delay"],function(document,window,Env,Delay){"use strict";var eventExpandoPrefix="mce-data-";var mouseEventRe=/^(?:mouse|contextmenu)|click/;var deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1};var hasIsDefaultPrevented=function(event){return event.isDefaultPrevented===returnTrue||event.isDefaultPrevented===returnFalse};var returnFalse=function(){return false};var returnTrue=function(){return true};var addEvent=function(target,name,callback,capture){if(target.addEventListener){target.addEventListener(name,callback,capture||false)}else if(target.attachEvent){target.attachEvent("on"+name,callback)}};var removeEvent=function(target,name,callback,capture){if(target.removeEventListener){target.removeEventListener(name,callback,capture||false)}else if(target.detachEvent){target.detachEvent("on"+name,callback)}};var getTargetFromShadowDom=function(event,defaultTarget){var path,target=defaultTarget;path=event.path;if(path&&path.length>0){target=path[0]}if(event.deepPath){path=event.deepPath();if(path&&path.length>0){target=path[0]}}return target};var fix=function(originalEvent,data){var name,event=data||{},undef;for(name in originalEvent){if(!deprecated[name]){event[name]=originalEvent[name]}}if(!event.target){event.target=event.srcElement||document}if(Env.experimentalShadowDom){event.target=getTargetFromShadowDom(originalEvent,event.target)}if(originalEvent&&mouseEventRe.test(originalEvent.type)&&originalEvent.pageX===undef&&originalEvent.clientX!==undef){var eventDoc=event.target.ownerDocument||document;var doc=eventDoc.documentElement;var body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}event.preventDefault=function(){event.isDefaultPrevented=returnTrue;if(originalEvent){if(originalEvent.preventDefault){originalEvent.preventDefault()}else{originalEvent.returnValue=false}}};event.stopPropagation=function(){event.isPropagationStopped=returnTrue;if(originalEvent){if(originalEvent.stopPropagation){originalEvent.stopPropagation()}else{originalEvent.cancelBubble=true}}};event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue;event.stopPropagation()};if(hasIsDefaultPrevented(event)===false){event.isDefaultPrevented=returnFalse;event.isPropagationStopped=returnFalse;event.isImmediatePropagationStopped=returnFalse}if(typeof event.metaKey=="undefined"){event.metaKey=false}return event};var bindOnReady=function(win,callback,eventUtils){var doc=win.document,event={type:"ready"};if(eventUtils.domLoaded){callback(event);return}var isDocReady=function(){return doc.readyState==="complete"||doc.readyState==="interactive"&&doc.body};var readyHandler=function(){if(!eventUtils.domLoaded){eventUtils.domLoaded=true;callback(event)}};var waitForDomLoaded=function(){if(isDocReady()){removeEvent(doc,"readystatechange",waitForDomLoaded);readyHandler()}};var tryScroll=function(){try{doc.documentElement.doScroll("left")}catch(ex){Delay.setTimeout(tryScroll);return}readyHandler()};if(doc.addEventListener&&!(Env.ie&&Env.ie<11)){if(isDocReady()){readyHandler()}else{addEvent(win,"DOMContentLoaded",readyHandler)}}else{addEvent(doc,"readystatechange",waitForDomLoaded);if(doc.documentElement.doScroll&&win.self===win.top){tryScroll()}}addEvent(win,"load",readyHandler)};var EventUtils=function(){var self=this,events={},count,expando,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave;expando=eventExpandoPrefix+(+new Date).toString(32);hasMouseEnterLeave="onmouseenter"in document.documentElement;hasFocusIn="onfocusin"in document.documentElement;mouseEnterLeave={mouseenter:"mouseover",mouseleave:"mouseout"};count=1;self.domLoaded=false;self.events=events;var executeHandlers=function(evt,id){var callbackList,i,l,callback,container=events[id];callbackList=container&&container[evt.type];if(callbackList){for(i=0,l=callbackList.length;i<l;i++){callback=callbackList[i];if(callback&&callback.func.call(callback.scope,evt)===false){evt.preventDefault()}if(evt.isImmediatePropagationStopped()){return}}}};self.bind=function(target,names,callback,scope){var id,callbackList,i,name,fakeName,nativeHandler,capture,win=window;var defaultNativeHandler=function(evt){executeHandlers(fix(evt||win.event),id)};if(!target||target.nodeType===3||target.nodeType===8){return}if(!target[expando]){id=count++;target[expando]=id;events[id]={}}else{id=target[expando]}scope=scope||target;names=names.split(" ");i=names.length;while(i--){name=names[i];nativeHandler=defaultNativeHandler;fakeName=capture=false;if(name==="DOMContentLoaded"){name="ready"}if(self.domLoaded&&name==="ready"&&target.readyState=="complete"){callback.call(scope,fix({type:name}));continue}if(!hasMouseEnterLeave){fakeName=mouseEnterLeave[name];if(fakeName){nativeHandler=function(evt){var current,related;current=evt.currentTarget;related=evt.relatedTarget;if(related&&current.contains){related=current.contains(related)}else{while(related&&related!==current){related=related.parentNode}}if(!related){evt=fix(evt||win.event);evt.type=evt.type==="mouseout"?"mouseleave":"mouseenter";evt.target=current;executeHandlers(evt,id)}}}}if(!hasFocusIn&&(name==="focusin"||name==="focusout")){capture=true;fakeName=name==="focusin"?"focus":"blur";nativeHandler=function(evt){evt=fix(evt||win.event);evt.type=evt.type==="focus"?"focusin":"focusout";executeHandlers(evt,id)}}callbackList=events[id][name];if(!callbackList){events[id][name]=callbackList=[{func:callback,scope:scope}];callbackList.fakeName=fakeName;callbackList.capture=capture;callbackList.nativeHandler=nativeHandler;if(name==="ready"){bindOnReady(target,nativeHandler,self)}else{addEvent(target,fakeName||name,nativeHandler,capture)}}else{if(name==="ready"&&self.domLoaded){callback({type:name})}else{callbackList.push({func:callback,scope:scope})}}}target=callbackList=0;return callback};self.unbind=function(target,names,callback){var id,callbackList,i,ci,name,eventMap;if(!target||target.nodeType===3||target.nodeType===8){return self}id=target[expando];if(id){eventMap=events[id];if(names){names=names.split(" ");i=names.length;while(i--){name=names[i];callbackList=eventMap[name];if(callbackList){if(callback){ci=callbackList.length;while(ci--){if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler;var fakeName=callbackList.fakeName,capture=callbackList.capture;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1));callbackList.nativeHandler=nativeHandler;callbackList.fakeName=fakeName;callbackList.capture=capture;eventMap[name]=callbackList}}}if(!callback||callbackList.length===0){delete eventMap[name];removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture)}}}}else{for(name in eventMap){callbackList=eventMap[name];removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture)}eventMap={}}for(name in eventMap){return self}delete events[id];try{delete target[expando]}catch(ex){target[expando]=null}}return self};self.fire=function(target,name,args){var id;if(!target||target.nodeType===3||target.nodeType===8){return self}args=fix(null,args);args.type=name;args.target=target;do{id=target[expando];if(id){executeHandlers(args,id)}target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow}while(target&&!args.isPropagationStopped());return self};self.clean=function(target){var i,children,unbind=self.unbind;if(!target||target.nodeType===3||target.nodeType===8){return self}if(target[expando]){unbind(target)}if(!target.getElementsByTagName){target=target.document}if(target&&target.getElementsByTagName){unbind(target);children=target.getElementsByTagName("*");i=children.length;while(i--){target=children[i];if(target[expando]){unbind(target)}}}return self};self.destroy=function(){events={}};self.cancel=function(e){if(e){e.preventDefault();e.stopImmediatePropagation()}return false}};EventUtils.Event=new EventUtils;EventUtils.Event.bind(window,"ready",function(){});return EventUtils});define("tinymce.core.dom.Sizzle",[],function(){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i}}return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]}if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector)){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if(old=context.getAttribute("id")){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}return cache[key+" "]=value}return cache}function markFunction(fn){fn[expando]=true;return fn}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j])}}})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;function getTop(win){try{return win.top}catch(ex){}return null}if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==getTop(parent)){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument()},false)}else if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument()})}}support.attributes=true;support.getElementsByTagName=true;support.getElementsByClassName=rnative.test(doc.getElementsByClassName);support.getById=true;Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}};Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];support.disconnectedMatch=true;rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}return sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}cur=a;while(cur=cur.parentNode){ap.unshift(cur)}cur=b;while(cur=cur.parentNode){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]){match[2]=match[4]||match[5]||""}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false}}return true},parent:function(elem){return!Expr.pseudos["empty"](elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2]}else{outerCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem)}}postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1,len=elems.length;if(outermost){outermostContext=context!==document&&context}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique}}if(bySet){if(elem=!matcher&&elem){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else if(compiled){context=context.parentNode}selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=true;return Sizzle});define("tinymce.core.util.Arr",[],function(){var isArray=Array.isArray||function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};var toArray=function(obj){var array=obj,i,l;if(!isArray(obj)){array=[];for(i=0,l=obj.length;i<l;i++){array[i]=obj[i]}}return array};var each=function(o,cb,s){var n,l;if(!o){return 0}s=s||o;if(o.length!==undefined){for(n=0,l=o.length;n<l;n++){if(cb.call(s,o[n],n,o)===false){return 0}}}else{for(n in o){if(o.hasOwnProperty(n)){if(cb.call(s,o[n],n,o)===false){return 0}}}}return 1};var map=function(array,callback){var out=[];each(array,function(item,index){out.push(callback(item,index,array))});return out};var filter=function(a,f){var o=[];each(a,function(v,index){if(!f||f(v,index,a)){o.push(v)}});return o};var indexOf=function(a,v){var i,l;if(a){for(i=0,l=a.length;i<l;i++){if(a[i]===v){return i}}}return-1};var reduce=function(collection,iteratee,accumulator,thisArg){var i=0;if(arguments.length<3){accumulator=collection[0]}for(;i<collection.length;i++){accumulator=iteratee.call(thisArg,accumulator,collection[i],i)}return accumulator};var findIndex=function(array,predicate,thisArg){var i,l;for(i=0,l=array.length;i<l;i++){if(predicate.call(thisArg,array[i],i,array)){return i}}return-1};var find=function(array,predicate,thisArg){var idx=findIndex(array,predicate,thisArg);if(idx!==-1){return array[idx]}return undefined};var last=function(collection){return collection[collection.length-1]};return{isArray:isArray,toArray:toArray,each:each,map:map,filter:filter,indexOf:indexOf,reduce:reduce,findIndex:findIndex,find:find,last:last}});define("tinymce.core.util.Tools",["global!window","tinymce.core.Env","tinymce.core.util.Arr"],function(window,Env,Arr){var whiteSpaceRegExp=/^\s*|\s*$/g;var trim=function(str){return str===null||str===undefined?"":(""+str).replace(whiteSpaceRegExp,"")};var is=function(obj,type){if(!type){return obj!==undefined}if(type=="array"&&Arr.isArray(obj)){return true}return typeof obj==type};var makeMap=function(items,delim,map){var i;items=items||[];delim=delim||",";if(typeof items=="string"){items=items.split(delim)}map=map||{};i=items.length;while(i--){map[items[i]]={}}return map};var hasOwnProperty=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)};var create=function(s,p,root){var self=this,sp,ns,cn,scn,c,de=0;s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s);cn=s[3].match(/(^|\.)(\w+)$/i)[2];ns=self.createNS(s[3].replace(/\.\w+$/,""),root);if(ns[cn]){return}if(s[2]=="static"){ns[cn]=p;if(this.onCreate){this.onCreate(s[2],s[3],ns[cn])}return}if(!p[cn]){p[cn]=function(){};de=1}ns[cn]=p[cn];self.extend(ns[cn].prototype,p);if(s[5]){sp=self.resolve(s[5]).prototype;scn=s[5].match(/\.(\w+)$/i)[1];c=ns[cn];if(de){ns[cn]=function(){return sp[scn].apply(this,arguments)}}else{ns[cn]=function(){this.parent=sp[scn];return c.apply(this,arguments)}}ns[cn].prototype[cn]=ns[cn];self.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]});self.each(p,function(f,n){if(sp[n]){ns[cn].prototype[n]=function(){this.parent=sp[n];return f.apply(this,arguments)}}else{if(n!=cn){ns[cn].prototype[n]=f}}})}self.each(p["static"],function(f,n){ns[cn][n]=f})};var extend=function(obj,ext){var i,l,name,args=arguments,value;for(i=1,l=args.length;i<l;i++){ext=args[i];for(name in ext){if(ext.hasOwnProperty(name)){value=ext[name];if(value!==undefined){obj[name]=value}}}}return obj};var walk=function(o,f,n,s){s=s||this;if(o){if(n){o=o[n]}Arr.each(o,function(o,i){if(f.call(s,o,i,n)===false){return false}walk(o,f,n,s)})}};var createNS=function(n,o){var i,v;o=o||window;n=n.split(".");for(i=0;i<n.length;i++){v=n[i];if(!o[v]){o[v]={}}o=o[v]}return o};var resolve=function(n,o){var i,l;o=o||window;n=n.split(".");for(i=0,l=n.length;i<l;i++){o=o[n[i]];if(!o){break}}return o};var explode=function(s,d){if(!s||is(s,"array")){return s}return Arr.map(s.split(d||","),trim)};var _addCacheSuffix=function(url){var cacheSuffix=Env.cacheSuffix;if(cacheSuffix){url+=(url.indexOf("?")===-1?"?":"&")+cacheSuffix}return url};return{trim:trim,isArray:Arr.isArray,is:is,toArray:Arr.toArray,makeMap:makeMap,each:Arr.each,map:Arr.map,grep:Arr.filter,inArray:Arr.indexOf,hasOwn:hasOwnProperty,extend:extend,create:create,walk:walk,createNS:createNS,resolve:resolve,explode:explode,_addCacheSuffix:_addCacheSuffix}});define("tinymce.core.dom.DomQuery",["global!document","tinymce.core.dom.EventUtils","tinymce.core.dom.Sizzle","tinymce.core.Env","tinymce.core.util.Tools"],function(document,EventUtils,Sizzle,Env,Tools){var doc=document,push=Array.prototype.push,slice=Array.prototype.slice;var rquickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/;var Event=EventUtils.Event,undef;var skipUniques=Tools.makeMap("children,contents,next,prev");var isDefined=function(obj){return typeof obj!=="undefined"};var isString=function(obj){return typeof obj==="string"};var isWindow=function(obj){return obj&&obj==obj.window};var createFragment=function(html,fragDoc){var frag,node,container;fragDoc=fragDoc||doc;container=fragDoc.createElement("div");frag=fragDoc.createDocumentFragment();container.innerHTML=html;while(node=container.firstChild){frag.appendChild(node)}return frag};var domManipulate=function(targetNodes,sourceItem,callback,reverse){var i;if(isString(sourceItem)){sourceItem=createFragment(sourceItem,getElementDocument(targetNodes[0]))}else if(sourceItem.length&&!sourceItem.nodeType){sourceItem=DomQuery.makeArray(sourceItem);if(reverse){for(i=sourceItem.length-1;i>=0;i--){domManipulate(targetNodes,sourceItem[i],callback,reverse)}}else{for(i=0;i<sourceItem.length;i++){domManipulate(targetNodes,sourceItem[i],callback,reverse)}}return targetNodes}if(sourceItem.nodeType){i=targetNodes.length;while(i--){callback.call(targetNodes[i],sourceItem)}}return targetNodes};var hasClass=function(node,className){return node&&className&&(" "+node.className+" ").indexOf(" "+className+" ")!==-1};var wrap=function(elements,wrapper,all){var lastParent,newWrapper;wrapper=DomQuery(wrapper)[0];elements.each(function(){var self=this;if(!all||lastParent!=self.parentNode){lastParent=self.parentNode;newWrapper=wrapper.cloneNode(false);self.parentNode.insertBefore(newWrapper,self);newWrapper.appendChild(self)}else{newWrapper.appendChild(self)}});return elements};var numericCssMap=Tools.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");var booleanMap=Tools.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," ");var propFix={for:"htmlFor",class:"className",readonly:"readOnly"};var cssFix={float:"cssFloat"};var attrHooks={},cssHooks={};var DomQuery=function(selector,context){return new DomQuery.fn.init(selector,context)};var inArray=function(item,array){var i;if(array.indexOf){return array.indexOf(item)}i=array.length;while(i--){if(array[i]===item){return i}}return-1};var whiteSpaceRegExp=/^\s*|\s*$/g;var trim=function(str){return str===null||str===undef?"":(""+str).replace(whiteSpaceRegExp,"")};var each=function(obj,callback){var length,key,i,undef,value;if(obj){length=obj.length;if(length===undef){for(key in obj){if(obj.hasOwnProperty(key)){value=obj[key];if(callback.call(value,key,value)===false){break}}}}else{for(i=0;i<length;i++){value=obj[i];if(callback.call(value,i,value)===false){break}}}}return obj};var grep=function(array,callback){var out=[];each(array,function(i,item){if(callback(item,i)){out.push(item)}});return out};var getElementDocument=function(element){if(!element){return doc}if(element.nodeType==9){return element}return element.ownerDocument};DomQuery.fn=DomQuery.prototype={constructor:DomQuery,selector:"",context:null,length:0,init:function(selector,context){var self=this,match,node;if(!selector){return self}if(selector.nodeType){self.context=self[0]=selector;self.length=1;return self}if(context&&context.nodeType){self.context=context}else{if(context){return DomQuery(selector).attr(context)}self.context=context=document}if(isString(selector)){self.selector=selector;if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match){if(match[1]){node=createFragment(selector,getElementDocument(context)).firstChild;while(node){push.call(self,node);node=node.nextSibling}}else{node=getElementDocument(context).getElementById(match[2]);if(!node){return self}if(node.id!==match[2]){return self.find(selector)}self.length=1;self[0]=node}}else{return DomQuery(context).find(selector)}}else{this.add(selector,false)}return self},toArray:function(){return Tools.toArray(this)},add:function(items,sort){var self=this,nodes,i;if(isString(items)){return self.add(DomQuery(items))}if(sort!==false){nodes=DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));self.length=nodes.length;for(i=0;i<nodes.length;i++){self[i]=nodes[i]}}else{push.apply(self,DomQuery.makeArray(items))}return self},attr:function(name,value){var self=this,hook;if(typeof name==="object"){each(name,function(name,value){self.attr(name,value)})}else if(isDefined(value)){this.each(function(){var hook;if(this.nodeType===1){hook=attrHooks[name];if(hook&&hook.set){hook.set(this,value);return}if(value===null){this.removeAttribute(name,2)}else{this.setAttribute(name,value,2)}}})}else{if(self[0]&&self[0].nodeType===1){hook=attrHooks[name];if(hook&&hook.get){return hook.get(self[0],name)}if(booleanMap[name]){return self.prop(name)?name:undef}value=self[0].getAttribute(name,2);if(value===null){value=undef}}return value}return self},removeAttr:function(name){return this.attr(name,null)},prop:function(name,value){var self=this;name=propFix[name]||name;if(typeof name==="object"){each(name,function(name,value){self.prop(name,value)})}else if(isDefined(value)){this.each(function(){if(this.nodeType==1){this[name]=value}})}else{if(self[0]&&self[0].nodeType&&name in self[0]){return self[0][name]}return value}return self},css:function(name,value){var self=this,elm,hook;var camel=function(name){return name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()})};var dashed=function(name){return name.replace(/[A-Z]/g,function(a){return"-"+a})};if(typeof name==="object"){each(name,function(name,value){self.css(name,value)})}else{if(isDefined(value)){name=camel(name);if(typeof value==="number"&&!numericCssMap[name]){value+="px"}self.each(function(){var style=this.style;hook=cssHooks[name];if(hook&&hook.set){hook.set(this,value);return}try{this.style[cssFix[name]||name]=value}catch(ex){}if(value===null||value===""){if(style.removeProperty){style.removeProperty(dashed(name))}else{style.removeAttribute(name)}}})}else{elm=self[0];hook=cssHooks[name];if(hook&&hook.get){return hook.get(elm)}if(elm.ownerDocument.defaultView){try{return elm.ownerDocument.defaultView.getComputedStyle(elm,null).getPropertyValue(dashed(name))}catch(ex){return undef}}else if(elm.currentStyle){return elm.currentStyle[camel(name)]}}}return self},remove:function(){var self=this,node,i=this.length;while(i--){node=self[i];Event.clean(node);if(node.parentNode){node.parentNode.removeChild(node)}}return this},empty:function(){var self=this,node,i=this.length;while(i--){node=self[i];while(node.firstChild){node.removeChild(node.firstChild)}}return this},html:function(value){var self=this,i;if(isDefined(value)){i=self.length;try{while(i--){self[i].innerHTML=value}}catch(ex){DomQuery(self[i]).empty().append(value)}return self}return self[0]?self[0].innerHTML:""},text:function(value){var self=this,i;if(isDefined(value)){i=self.length;while(i--){if("innerText"in self[i]){self[i].innerText=value}else{self[0].textContent=value}}return self}return self[0]?self[0].innerText||self[0].textContent:""},append:function(){return domManipulate(this,arguments,function(node){if(this.nodeType===1||this.host&&this.host.nodeType===1){this.appendChild(node)}})},prepend:function(){return domManipulate(this,arguments,function(node){if(this.nodeType===1||this.host&&this.host.nodeType===1){this.insertBefore(node,this.firstChild)}},true)},before:function(){var self=this;if(self[0]&&self[0].parentNode){return domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this)})}return self},after:function(){var self=this;if(self[0]&&self[0].parentNode){return domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this.nextSibling)},true)}return self},appendTo:function(val){DomQuery(val).append(this);return this},prependTo:function(val){DomQuery(val).prepend(this);return this},replaceWith:function(content){return this.before(content).remove()},wrap:function(content){return wrap(this,content)},wrapAll:function(content){return wrap(this,content,true)},wrapInner:function(content){this.each(function(){DomQuery(this).contents().wrapAll(content)});return this},unwrap:function(){return this.parent().each(function(){DomQuery(this).replaceWith(this.childNodes)})},clone:function(){var result=[];this.each(function(){result.push(this.cloneNode(true))});return DomQuery(result)},addClass:function(className){return this.toggleClass(className,true)},removeClass:function(className){return this.toggleClass(className,false)},toggleClass:function(className,state){var self=this;if(typeof className!="string"){return self}if(className.indexOf(" ")!==-1){each(className.split(" "),function(){self.toggleClass(this,state)})}else{self.each(function(index,node){var existingClassName,classState;classState=hasClass(node,className);if(classState!==state){existingClassName=node.className;if(classState){node.className=trim((" "+existingClassName+" ").replace(" "+className+" "," "))}else{node.className+=existingClassName?" "+className:className}}})}return self},hasClass:function(className){return hasClass(this[0],className)},each:function(callback){return each(this,callback)},on:function(name,callback){return this.each(function(){Event.bind(this,name,callback)})},off:function(name,callback){return this.each(function(){Event.unbind(this,name,callback)})},trigger:function(name){return this.each(function(){if(typeof name=="object"){Event.fire(this,name.type,name)}else{Event.fire(this,name)}})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new DomQuery(slice.apply(this,arguments))},eq:function(index){return index===-1?this.slice(index):this.slice(index,+index+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(selector){var i,l,ret=[];for(i=0,l=this.length;i<l;i++){DomQuery.find(selector,this[i],ret)}return DomQuery(ret)},filter:function(selector){if(typeof selector=="function"){return DomQuery(grep(this.toArray(),function(item,i){return selector(i,item)}))}return DomQuery(DomQuery.filter(selector,this.toArray()))},closest:function(selector){var result=[];if(selector instanceof DomQuery){selector=selector[0]}this.each(function(i,node){while(node){if(typeof selector=="string"&&DomQuery(node).is(selector)){result.push(node);break}else if(node==selector){result.push(node);break}node=node.parentNode}});return DomQuery(result)},offset:function(offset){var elm,doc,docElm;var x=0,y=0,pos;if(!offset){elm=this[0];if(elm){doc=elm.ownerDocument;docElm=doc.documentElement;if(elm.getBoundingClientRect){pos=elm.getBoundingClientRect();x=pos.left+(docElm.scrollLeft||doc.body.scrollLeft)-docElm.clientLeft;y=pos.top+(docElm.scrollTop||doc.body.scrollTop)-docElm.clientTop}}return{left:x,top:y}}return this.css(offset)},push:push,sort:[].sort,splice:[].splice};Tools.extend(DomQuery,{extend:Tools.extend,makeArray:function(object){if(isWindow(object)||object.nodeType){return[object]}return Tools.toArray(object)},inArray:inArray,isArray:Tools.isArray,each:each,trim:trim,grep:grep,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,contains:Sizzle.contains,filter:function(expr,elems,not){var i=elems.length;if(not){expr=":not("+expr+")"}while(i--){if(elems[i].nodeType!=1){elems.splice(i,1)}}if(elems.length===1){elems=DomQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]}else{elems=DomQuery.find.matches(expr,elems)}return elems}});var dir=function(el,prop,until){var matched=[],cur=el[prop];if(typeof until!="string"&&until instanceof DomQuery){until=until[0]}while(cur&&cur.nodeType!==9){if(until!==undefined){if(cur===until){break}if(typeof until=="string"&&DomQuery(cur).is(until)){break}}if(cur.nodeType===1){matched.push(cur)}cur=cur[prop]}return matched};var sibling=function(node,siblingName,nodeType,until){var result=[];if(until instanceof DomQuery){until=until[0]}for(;node;node=node[siblingName]){if(nodeType&&node.nodeType!==nodeType){continue}if(until!==undefined){if(node===until){break}if(typeof until=="string"&&DomQuery(node).is(until)){break}}result.push(node)}return result};var firstSibling=function(node,siblingName,nodeType){for(node=node[siblingName];node;node=node[siblingName]){if(node.nodeType==nodeType){return node}}return null};each({parent:function(node){var parent=node.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(node){return dir(node,"parentNode")},next:function(node){return firstSibling(node,"nextSibling",1)},prev:function(node){return firstSibling(node,"previousSibling",1)},children:function(node){return sibling(node.firstChild,"nextSibling",1)},contents:function(node){return Tools.toArray((node.nodeName==="iframe"?node.contentDocument||node.contentWindow.document:node).childNodes)}},function(name,fn){DomQuery.fn[name]=function(selector){var self=this,result=[];self.each(function(){var nodes=fn.call(result,this,selector,result);if(nodes){if(DomQuery.isArray(nodes)){result.push.apply(result,nodes)}else{result.push(nodes)}}});if(this.length>1){if(!skipUniques[name]){result=DomQuery.unique(result)}if(name.indexOf("parents")===0){result=result.reverse()}}result=DomQuery(result);if(selector){return result.filter(selector)}return result}});each({parentsUntil:function(node,until){return dir(node,"parentNode",until)},nextUntil:function(node,until){return sibling(node,"nextSibling",1,until).slice(1)},prevUntil:function(node,until){return sibling(node,"previousSibling",1,until).slice(1)}},function(name,fn){DomQuery.fn[name]=function(selector,filter){var self=this,result=[];self.each(function(){var nodes=fn.call(result,this,selector,result);if(nodes){if(DomQuery.isArray(nodes)){result.push.apply(result,nodes)}else{result.push(nodes)}}});if(this.length>1){result=DomQuery.unique(result);if(name.indexOf("parents")===0||name==="prevUntil"){result=result.reverse()}}result=DomQuery(result);if(filter){return result.filter(filter)}return result}});DomQuery.fn.is=function(selector){return!!selector&&this.filter(selector).length>0};DomQuery.fn.init.prototype=DomQuery.fn;DomQuery.overrideDefaults=function(callback){var defaults;var sub=function(selector,context){defaults=defaults||callback();if(arguments.length===0){selector=defaults.element}if(!context){context=defaults.context}return new sub.fn.init(selector,context)};DomQuery.extend(sub,this);return sub};var appendHooks=function(targetHooks,prop,hooks){each(hooks,function(name,func){targetHooks[name]=targetHooks[name]||{};targetHooks[name][prop]=func})};if(Env.ie&&Env.ie<8){appendHooks(attrHooks,"get",{maxlength:function(elm){var value=elm.maxLength;if(value===2147483647){return undef}return value},size:function(elm){var value=elm.size;if(value===20){return undef}return value},class:function(elm){return elm.className},style:function(elm){var value=elm.style.cssText;if(value.length===0){return undef}return value}});appendHooks(attrHooks,"set",{class:function(elm,value){elm.className=value},style:function(elm,value){elm.style.cssText=value}})}if(Env.ie&&Env.ie<9){cssFix["float"]="styleFloat";appendHooks(cssHooks,"set",{opacity:function(elm,value){var style=elm.style;if(value===null||value===""){style.removeAttribute("filter")}else{style.zoom=1;style.filter="alpha(opacity="+value*100+")"}}})}DomQuery.attrHooks=attrHooks;DomQuery.cssHooks=cssHooks;return DomQuery});define("ephox.katamari.api.Thunk",[],function(){var cached=function(f){var called=false;var r;return function(){if(!called){called=true;r=f.apply(null,arguments)}return r}};return{cached:cached}});defineGlobal("global!Number",Number);define("ephox.sand.detect.Version",["ephox.katamari.api.Arr","global!Number","global!String"],function(Arr,Number,String){var firstMatch=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s)){return x}}return undefined};var find=function(regexes,agent){var r=firstMatch(regexes,agent);if(!r){return{major:0,minor:0}}var group=function(i){return Number(agent.replace(r,"$"+i))};return nu(group(1),group(2))};var detect=function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();if(versionRegexes.length===0){return unknown()}return find(versionRegexes,cleanedAgent)};var unknown=function(){return nu(0,0)};var nu=function(major,minor){return{major:major,minor:minor}};return{nu:nu,detect:detect,unknown:unknown}});define("ephox.sand.core.Browser",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(Fun,Version){var edge="Edge";var chrome="Chrome";var ie="IE";var opera="Opera";var firefox="Firefox";var safari="Safari";var isBrowser=function(name,current){return function(){return current===name}};var unknown=function(){return nu({current:undefined,version:Version.unknown()})};var nu=function(info){var current=info.current;var version=info.version;return{current:current,version:version,isEdge:isBrowser(edge,current),isChrome:isBrowser(chrome,current),isIE:isBrowser(ie,current),isOpera:isBrowser(opera,current),isFirefox:isBrowser(firefox,current),isSafari:isBrowser(safari,current)}};return{unknown:unknown,nu:nu,edge:Fun.constant(edge),chrome:Fun.constant(chrome),ie:Fun.constant(ie),opera:Fun.constant(opera),firefox:Fun.constant(firefox),safari:Fun.constant(safari)}});define("ephox.sand.core.OperatingSystem",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(Fun,Version){var windows="Windows";var ios="iOS";var android="Android";var linux="Linux";var osx="OSX";var solaris="Solaris";var freebsd="FreeBSD";var isOS=function(name,current){return function(){return current===name}};var unknown=function(){return nu({current:undefined,version:Version.unknown()})};var nu=function(info){var current=info.current;var version=info.version;return{current:current,version:version,isWindows:isOS(windows,current),isiOS:isOS(ios,current),isAndroid:isOS(android,current),isOSX:isOS(osx,current),isLinux:isOS(linux,current),isSolaris:isOS(solaris,current),isFreeBSD:isOS(freebsd,current)}};return{unknown:unknown,nu:nu,windows:Fun.constant(windows),ios:Fun.constant(ios),android:Fun.constant(android),linux:Fun.constant(linux),osx:Fun.constant(osx),solaris:Fun.constant(solaris),freebsd:Fun.constant(freebsd)}});define("ephox.sand.detect.DeviceType",["ephox.katamari.api.Fun"],function(Fun){return function(os,browser,userAgent){var isiPad=os.isiOS()&&/ipad/i.test(userAgent)===true;var isiPhone=os.isiOS()&&!isiPad;var isAndroid3=os.isAndroid()&&os.version.major===3;var isAndroid4=os.isAndroid()&&os.version.major===4;var isTablet=isiPad||isAndroid3||isAndroid4&&/mobile/i.test(userAgent)===true;var isTouch=os.isiOS()||os.isAndroid();var isPhone=isTouch&&!isTablet;var iOSwebview=browser.isSafari()&&os.isiOS()&&/safari/i.test(userAgent)===false;return{isiPad:Fun.constant(isiPad),isiPhone:Fun.constant(isiPhone),isTablet:Fun.constant(isTablet),isPhone:Fun.constant(isPhone),isTouch:Fun.constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:Fun.constant(iOSwebview)}}});define("ephox.sand.detect.UaString",["ephox.katamari.api.Arr","ephox.sand.detect.Version","global!String"],function(Arr,Version,String){var detect=function(candidates,userAgent){var agent=String(userAgent).toLowerCase();return Arr.find(candidates,function(candidate){return candidate.search(agent)})};var detectBrowser=function(browsers,userAgent){return detect(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})};var detectOs=function(oses,userAgent){return detect(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})};return{detectBrowser:detectBrowser,detectOs:detectOs}});define("ephox.katamari.str.StrAppend",[],function(){var addToStart=function(str,prefix){return prefix+str};var addToEnd=function(str,suffix){return str+suffix};var removeFromStart=function(str,numChars){return str.substring(numChars)};var removeFromEnd=function(str,numChars){return str.substring(0,str.length-numChars)};return{addToStart:addToStart,addToEnd:addToEnd,removeFromStart:removeFromStart,removeFromEnd:removeFromEnd}});define("ephox.katamari.str.StringParts",["ephox.katamari.api.Option","global!Error"],function(Option,Error){var first=function(str,count){return str.substr(0,count)};var last=function(str,count){return str.substr(str.length-count,str.length)};var head=function(str){return str===""?Option.none():Option.some(str.substr(0,1))};var tail=function(str){return str===""?Option.none():Option.some(str.substring(1))};return{first:first,last:last,head:head,tail:tail}});define("ephox.katamari.api.Strings",["ephox.katamari.str.StrAppend","ephox.katamari.str.StringParts","global!Error"],function(StrAppend,StringParts,Error){var checkRange=function(str,substr,start){if(substr===""){return true}if(str.length<substr.length){return false}var x=str.substr(start,start+substr.length);return x===substr};var supplant=function(str,obj){var isStringOrNumber=function(a){var t=typeof a;return t==="string"||t==="number"};return str.replace(/\${([^{}]*)}/g,function(a,b){var value=obj[b];return isStringOrNumber(value)?value:a})};var removeLeading=function(str,prefix){return startsWith(str,prefix)?StrAppend.removeFromStart(str,prefix.length):str};var removeTrailing=function(str,prefix){return endsWith(str,prefix)?StrAppend.removeFromEnd(str,prefix.length):str};var ensureLeading=function(str,prefix){return startsWith(str,prefix)?str:StrAppend.addToStart(str,prefix)};var ensureTrailing=function(str,prefix){return endsWith(str,prefix)?str:StrAppend.addToEnd(str,prefix)};var contains=function(str,substr){return str.indexOf(substr)!==-1};var capitalize=function(str){return StringParts.head(str).bind(function(head){return StringParts.tail(str).map(function(tail){return head.toUpperCase()+tail})}).getOr(str)};var startsWith=function(str,prefix){return checkRange(str,prefix,0)};var endsWith=function(str,suffix){return checkRange(str,suffix,str.length-suffix.length)};var trim=function(str){return str.replace(/^\s+|\s+$/g,"")};var lTrim=function(str){return str.replace(/^\s+/g,"")};var rTrim=function(str){return str.replace(/\s+$/g,"")};return{supplant:supplant,startsWith:startsWith,removeLeading:removeLeading,removeTrailing:removeTrailing,ensureLeading:ensureLeading,ensureTrailing:ensureTrailing,endsWith:endsWith,contains:contains,trim:trim,lTrim:lTrim,rTrim:rTrim,capitalize:capitalize}});define("ephox.sand.info.PlatformInfo",["ephox.katamari.api.Fun","ephox.katamari.api.Strings"],function(Fun,Strings){var normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;var checkContains=function(target){return function(uastring){return Strings.contains(uastring,target)}};var browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){var monstrosity=Strings.contains(uastring,"edge/")&&Strings.contains(uastring,"chrome")&&Strings.contains(uastring,"safari")&&Strings.contains(uastring,"applewebkit");return monstrosity}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return Strings.contains(uastring,"chrome")&&!Strings.contains(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return Strings.contains(uastring,"msie")||Strings.contains(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(Strings.contains(uastring,"safari")||Strings.contains(uastring,"mobile/"))&&Strings.contains(uastring,"applewebkit")}}];var oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return Strings.contains(uastring,"iphone")||Strings.contains(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]}];return{browsers:Fun.constant(browsers),oses:Fun.constant(oses)}});define("ephox.sand.core.PlatformDetection",["ephox.sand.core.Browser","ephox.sand.core.OperatingSystem","ephox.sand.detect.DeviceType","ephox.sand.detect.UaString","ephox.sand.info.PlatformInfo"],function(Browser,OperatingSystem,DeviceType,UaString,PlatformInfo){var detect=function(userAgent){var browsers=PlatformInfo.browsers();var oses=PlatformInfo.oses();var browser=UaString.detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu);var os=UaString.detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu);var deviceType=DeviceType(os,browser,userAgent);return{browser:browser,os:os,deviceType:deviceType}};return{detect:detect}});define("ephox.sand.api.PlatformDetection",["ephox.katamari.api.Thunk","ephox.sand.core.PlatformDetection","global!navigator"],function(Thunk,PlatformDetection,navigator){var detect=Thunk.cached(function(){var userAgent=navigator.userAgent;return PlatformDetection.detect(userAgent)});return{detect:detect}});define("global!console",[],function(){if(typeof console==="undefined"){console={log:function(){}}}return console});define("ephox.sugar.api.node.Element",["ephox.katamari.api.Fun","ephox.katamari.api.Option","global!Error","global!console","global!document"],function(Fun,Option,Error,console,document){var fromHtml=function(html,scope){var doc=scope||document;var div=doc.createElement("div");div.innerHTML=html;if(!div.hasChildNodes()||div.childNodes.length>1){console.error("HTML does not have a single root node",html);throw"HTML must have a single root node"}return fromDom(div.childNodes[0])};var fromTag=function(tag,scope){var doc=scope||document;var node=doc.createElement(tag);return fromDom(node)};var fromText=function(text,scope){var doc=scope||document;var node=doc.createTextNode(text);return fromDom(node)};var fromDom=function(node){if(node===null||node===undefined){throw new Error("Node cannot be null or undefined")}return{dom:Fun.constant(node)}};var fromPoint=function(doc,x,y){return Option.from(doc.dom().elementFromPoint(x,y)).map(fromDom)};return{fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,fromPoint:fromPoint}});define("ephox.sugar.api.node.NodeTypes",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}});define("ephox.sugar.api.node.Node",["ephox.sugar.api.node.NodeTypes"],function(NodeTypes){var name=function(element){var r=element.dom().nodeName;return r.toLowerCase()};var type=function(element){return element.dom().nodeType};var value=function(element){return element.dom().nodeValue};var isType=function(t){return function(element){return type(element)===t}};var isComment=function(element){return type(element)===NodeTypes.COMMENT||name(element)==="#comment"};var isElement=isType(NodeTypes.ELEMENT);var isText=isType(NodeTypes.TEXT);var isDocument=isType(NodeTypes.DOCUMENT);return{name:name,type:type,value:value,isElement:isElement,isText:isText,isDocument:isDocument,isComment:isComment}});define("ephox.katamari.api.Type",["global!Array","global!String"],function(Array,String){var typeOf=function(x){if(x===null){return"null"}var t=typeof x;if(t==="object"&&Array.prototype.isPrototypeOf(x)){return"array"}if(t==="object"&&String.prototype.isPrototypeOf(x)){return"string"}return t};var isType=function(type){return function(value){return typeOf(value)===type}};return{isString:isType("string"),isObject:isType("object"),isArray:isType("array"),isNull:isType("null"),isBoolean:isType("boolean"),isUndefined:isType("undefined"),isFunction:isType("function"),isNumber:isType("number")}});define("ephox.katamari.api.Obj",["ephox.katamari.api.Option","global!Object"],function(Option,Object){var keys=function(){var fastKeys=Object.keys;var slowKeys=function(o){var r=[];for(var i in o){if(o.hasOwnProperty(i)){r.push(i)}}return r};return fastKeys===undefined?slowKeys:fastKeys}();var each=function(obj,f){var props=keys(obj);for(var k=0,len=props.length;k<len;k++){var i=props[k];var x=obj[i];f(x,i,obj)}};var objectMap=function(obj,f){return tupleMap(obj,function(x,i,obj){return{k:i,v:f(x,i,obj)}})};var tupleMap=function(obj,f){var r={};each(obj,function(x,i){var tuple=f(x,i,obj);r[tuple.k]=tuple.v});return r};var bifilter=function(obj,pred){var t={};var f={};each(obj,function(x,i){var branch=pred(x,i)?t:f;branch[i]=x});return{t:t,f:f}};var mapToArray=function(obj,f){var r=[];each(obj,function(value,name){r.push(f(value,name))});return r};var find=function(obj,pred){var props=keys(obj);for(var k=0,len=props.length;k<len;k++){var i=props[k];var x=obj[i];if(pred(x,i,obj)){return Option.some(x)}}return Option.none()};var values=function(obj){return mapToArray(obj,function(v){return v})};var size=function(obj){return values(obj).length};return{bifilter:bifilter,each:each,map:objectMap,mapToArray:mapToArray,tupleMap:tupleMap,find:find,keys:keys,values:values,size:size}});define("ephox.sugar.api.properties.Attr",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.sugar.api.node.Node","global!Error","global!console"],function(Type,Arr,Obj,Node,Error,console){var rawSet=function(dom,key,value){if(Type.isString(value)||Type.isBoolean(value)||Type.isNumber(value)){dom.setAttribute(key,value+"")}else{console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom);throw new Error("Attribute value was not simple")}};var set=function(element,key,value){rawSet(element.dom(),key,value)};var setAll=function(element,attrs){var dom=element.dom();Obj.each(attrs,function(v,k){rawSet(dom,k,v)})};var get=function(element,key){var v=element.dom().getAttribute(key);return v===null?undefined:v};var has=function(element,key){var dom=element.dom();return dom&&dom.hasAttribute?dom.hasAttribute(key):false};var remove=function(element,key){element.dom().removeAttribute(key)};var hasNone=function(element){var attrs=element.dom().attributes;return attrs===undefined||attrs===null||attrs.length===0};var clone=function(element){return Arr.foldl(element.dom().attributes,function(acc,attr){acc[attr.name]=attr.value;return acc},{})};var transferOne=function(source,destination,attr){if(has(source,attr)&&!has(destination,attr)){set(destination,attr,get(source,attr))}};var transfer=function(source,destination,attrs){if(!Node.isElement(source)||!Node.isElement(destination)){return}Arr.each(attrs,function(attr){transferOne(source,destination,attr)})};return{clone:clone,set:set,setAll:setAll,get:get,has:has,remove:remove,hasNone:hasNone,transfer:transfer}});define("ephox.sugar.api.node.Body",["ephox.katamari.api.Thunk","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","global!document"],function(Thunk,Element,Node,document){var inBody=function(element){var dom=Node.isText(element)?element.dom().parentNode:element.dom();return dom!==undefined&&dom!==null&&dom.ownerDocument.body.contains(dom)};var body=Thunk.cached(function(){return getBody(Element.fromDom(document))});var getBody=function(doc){var body=doc.dom().body;if(body===null||body===undefined){throw"Body is not available yet"}return Element.fromDom(body)};return{body:body,getBody:getBody,inBody:inBody}});define("ephox.sugar.impl.Style",[],function(){var isSupported=function(dom){return dom.style!==undefined};return{isSupported:isSupported}});define("ephox.sugar.api.properties.Css",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Body","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.impl.Style","ephox.katamari.api.Strings","global!Error","global!console","global!window"],function(Type,Arr,Obj,Option,Attr,Body,Element,Node,Style,Strings,Error,console,window){var internalSet=function(dom,property,value){if(!Type.isString(value)){console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom);throw new Error("CSS value must be a string: "+value)}if(Style.isSupported(dom)){dom.style.setProperty(property,value)}};var internalRemove=function(dom,property){if(Style.isSupported(dom)){dom.style.removeProperty(property)}};var set=function(element,property,value){var dom=element.dom();internalSet(dom,property,value)};var setAll=function(element,css){var dom=element.dom();Obj.each(css,function(v,k){internalSet(dom,k,v)})};var setOptions=function(element,css){var dom=element.dom();Obj.each(css,function(v,k){v.fold(function(){internalRemove(dom,k)},function(value){internalSet(dom,k,value)})})};var get=function(element,property){var dom=element.dom();var styles=window.getComputedStyle(dom);var r=styles.getPropertyValue(property);var v=r===""&&!Body.inBody(element)?getUnsafeProperty(dom,property):r;return v===null?undefined:v};var getUnsafeProperty=function(dom,property){return Style.isSupported(dom)?dom.style.getPropertyValue(property):""};var getRaw=function(element,property){var dom=element.dom();var raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return r.length>0})};var getAllRaw=function(element){var css={};var dom=element.dom();if(Style.isSupported(dom)){for(var i=0;i<dom.style.length;i++){var ruleName=dom.style.item(i);css[ruleName]=dom.style[ruleName]}}return css};var isValidValue=function(tag,property,value){var element=Element.fromTag(tag);set(element,property,value);var style=getRaw(element,property);return style.isSome()};var remove=function(element,property){var dom=element.dom();internalRemove(dom,property);if(Attr.has(element,"style")&&Strings.trim(Attr.get(element,"style"))===""){Attr.remove(element,"style")}};var preserve=function(element,f){var oldStyles=Attr.get(element,"style");var result=f(element);var restore=oldStyles===undefined?Attr.remove:Attr.set;restore(element,"style",oldStyles);return result};var copy=function(source,target){var sourceDom=source.dom();var targetDom=target.dom();if(Style.isSupported(sourceDom)&&Style.isSupported(targetDom)){targetDom.style.cssText=sourceDom.style.cssText}};var reflow=function(e){return e.dom().offsetWidth};var transferOne=function(source,destination,style){getRaw(source,style).each(function(value){if(getRaw(destination,style).isNone()){set(destination,style,value)}})};var transfer=function(source,destination,styles){if(!Node.isElement(source)||!Node.isElement(destination)){return}Arr.each(styles,function(style){transferOne(source,destination,style)})};return{copy:copy,set:set,preserve:preserve,setAll:setAll,setOptions:setOptions,remove:remove,get:get,getRaw:getRaw,getAllRaw:getAllRaw,isValidValue:isValidValue,reflow:reflow,transfer:transfer}});define("ephox.katamari.data.Immutable",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","global!Array","global!Error"],function(Arr,Fun,Array,Error){return function(){var fields=arguments;return function(){var values=new Array(arguments.length);for(var i=0;i<values.length;i++){values[i]=arguments[i]}if(fields.length!==values.length){throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments")}var struct={};Arr.each(fields,function(name,i){struct[name]=Fun.constant(values[i])});return struct}}});define("ephox.katamari.util.BagUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Type","global!Error"],function(Arr,Type,Error){var sort=function(arr){return arr.slice(0).sort()};var reqMessage=function(required,keys){throw new Error("All required keys ("+sort(required).join(", ")+") were not specified. Specified keys were: "+sort(keys).join(", ")+".")};var unsuppMessage=function(unsupported){throw new Error("Unsupported keys for object: "+sort(unsupported).join(", "))};var validateStrArr=function(label,array){if(!Type.isArray(array)){throw new Error("The "+label+" fields must be an array. Was: "+array+".")}Arr.each(array,function(a){if(!Type.isString(a)){throw new Error("The value "+a+" in the "+label+" fields was not a string.")}})};var invalidTypeMessage=function(incorrect,type){throw new Error("All values need to be of type: "+type+". Keys ("+sort(incorrect).join(", ")+") were not.")};var checkDupes=function(everything){var sorted=sort(everything);var dupe=Arr.find(sorted,function(s,i){return i<sorted.length-1&&s===sorted[i+1]});dupe.each(function(d){throw new Error("The field: "+d+" occurs more than once in the combined fields: ["+sorted.join(", ")+"].")})};return{sort:sort,reqMessage:reqMessage,unsuppMessage:unsuppMessage,validateStrArr:validateStrArr,invalidTypeMessage:invalidTypeMessage,checkDupes:checkDupes}});define("ephox.katamari.data.MixedBag",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.katamari.util.BagUtils","global!Error","global!Object"],function(Arr,Fun,Obj,Option,BagUtils,Error,Object){return function(required,optional){var everything=required.concat(optional);if(everything.length===0){throw new Error("You must specify at least one required or optional field.")}BagUtils.validateStrArr("required",required);BagUtils.validateStrArr("optional",optional);BagUtils.checkDupes(everything);return function(obj){var keys=Obj.keys(obj);var allReqd=Arr.forall(required,function(req){return Arr.contains(keys,req)});if(!allReqd){BagUtils.reqMessage(required,keys)}var unsupported=Arr.filter(keys,function(key){return!Arr.contains(everything,key)});if(unsupported.length>0){BagUtils.unsuppMessage(unsupported)}var r={};Arr.each(required,function(req){r[req]=Fun.constant(obj[req])});Arr.each(optional,function(opt){r[opt]=Fun.constant(Object.prototype.hasOwnProperty.call(obj,opt)?Option.some(obj[opt]):Option.none())});return r}}});define("ephox.katamari.api.Struct",["ephox.katamari.data.Immutable","ephox.katamari.data.MixedBag"],function(Immutable,MixedBag){return{immutable:Immutable,immutableBag:MixedBag}});define("ephox.sugar.alien.Recurse",[],function(){var toArray=function(target,f){var r=[];var recurse=function(e){r.push(e);return f(e)};var cur=f(target);do{cur=cur.bind(recurse)}while(cur.isSome());return r};return{toArray:toArray}});define("ephox.sand.api.Node",["ephox.sand.util.Global"],function(Global){var node=function(){var f=Global.getOrDie("Node");return f};var compareDocumentPosition=function(a,b,match){return(a.compareDocumentPosition(b)&match)!==0};var documentPositionPreceding=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_PRECEDING)};var documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_CONTAINED_BY)};return{documentPositionPreceding:documentPositionPreceding,documentPositionContainedBy:documentPositionContainedBy}});define("ephox.sugar.api.search.Selectors",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.node.NodeTypes","global!Error","global!document"],function(Arr,Option,Element,NodeTypes,Error,document){var ELEMENT=NodeTypes.ELEMENT;var DOCUMENT=NodeTypes.DOCUMENT;var is=function(element,selector){var elem=element.dom();if(elem.nodeType!==ELEMENT){return false}else if(elem.matches!==undefined){return elem.matches(selector)}else if(elem.msMatchesSelector!==undefined){return elem.msMatchesSelector(selector)}else if(elem.webkitMatchesSelector!==undefined){return elem.webkitMatchesSelector(selector)}else if(elem.mozMatchesSelector!==undefined){return elem.mozMatchesSelector(selector)}else{throw new Error("Browser lacks native selectors")}};var bypassSelector=function(dom){return dom.nodeType!==ELEMENT&&dom.nodeType!==DOCUMENT||dom.childElementCount===0};var all=function(selector,scope){var base=scope===undefined?document:scope.dom();return bypassSelector(base)?[]:Arr.map(base.querySelectorAll(selector),Element.fromDom)};var one=function(selector,scope){var base=scope===undefined?document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map(Element.fromDom)};return{all:all,is:is,one:one}});define("ephox.sugar.api.dom.Compare",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sand.api.Node","ephox.sand.api.PlatformDetection","ephox.sugar.api.search.Selectors"],function(Arr,Fun,Node,PlatformDetection,Selectors){var eq=function(e1,e2){return e1.dom()===e2.dom()};var isEqualNode=function(e1,e2){return e1.dom().isEqualNode(e2.dom())};var member=function(element,elements){return Arr.exists(elements,Fun.curry(eq,element))};var regularContains=function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1===d2?false:d1.contains(d2)};var ieContains=function(e1,e2){return Node.documentPositionContainedBy(e1.dom(),e2.dom())};var browser=PlatformDetection.detect().browser;var contains=browser.isIE()?ieContains:regularContains;return{eq:eq,isEqualNode:isEqualNode,member:member,contains:contains,is:Selectors.is}});define("ephox.sugar.api.search.Traverse",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.alien.Recurse","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(Type,Arr,Fun,Option,Struct,Recurse,Compare,Element){var owner=function(element){return Element.fromDom(element.dom().ownerDocument)};var documentElement=function(element){var doc=owner(element);return Element.fromDom(doc.dom().documentElement)};var defaultView=function(element){var el=element.dom();var defaultView=el.ownerDocument.defaultView;return Element.fromDom(defaultView)};var parent=function(element){var dom=element.dom();return Option.from(dom.parentNode).map(Element.fromDom)};var findIndex=function(element){return parent(element).bind(function(p){var kin=children(p);return Arr.findIndex(kin,function(elem){return Compare.eq(element,elem)})})};var parents=function(element,isRoot){var stop=Type.isFunction(isRoot)?isRoot:Fun.constant(false);var dom=element.dom();var ret=[];while(dom.parentNode!==null&&dom.parentNode!==undefined){var rawParent=dom.parentNode;var parent=Element.fromDom(rawParent);ret.push(parent);if(stop(parent)===true){break}else{dom=rawParent}}return ret};var siblings=function(element){var filterSelf=function(elements){return Arr.filter(elements,function(x){return!Compare.eq(element,x)})};return parent(element).map(children).map(filterSelf).getOr([])};var offsetParent=function(element){var dom=element.dom();return Option.from(dom.offsetParent).map(Element.fromDom)};var prevSibling=function(element){var dom=element.dom();return Option.from(dom.previousSibling).map(Element.fromDom)};var nextSibling=function(element){var dom=element.dom();return Option.from(dom.nextSibling).map(Element.fromDom)};var prevSiblings=function(element){return Arr.reverse(Recurse.toArray(element,prevSibling))};var nextSiblings=function(element){return Recurse.toArray(element,nextSibling)};var children=function(element){var dom=element.dom();return Arr.map(dom.childNodes,Element.fromDom)};var child=function(element,index){var children=element.dom().childNodes;return Option.from(children[index]).map(Element.fromDom)};var firstChild=function(element){return child(element,0)};var lastChild=function(element){return child(element,element.dom().childNodes.length-1)};var childNodesCount=function(element){return element.dom().childNodes.length};var hasChildNodes=function(element){return element.dom().hasChildNodes()};var spot=Struct.immutable("element","offset");var leaf=function(element,offset){var cs=children(element);return cs.length>0&&offset<cs.length?spot(cs[offset],0):spot(element,offset)};return{owner:owner,defaultView:defaultView,documentElement:documentElement,parent:parent,findIndex:findIndex,parents:parents,siblings:siblings,prevSibling:prevSibling,offsetParent:offsetParent,prevSiblings:prevSiblings,nextSibling:nextSibling,nextSiblings:nextSiblings,children:children,child:child,firstChild:firstChild,lastChild:lastChild,childNodesCount:childNodesCount,hasChildNodes:hasChildNodes,leaf:leaf}});define("tinymce.core.dom.Position",["ephox.katamari.api.Arr","ephox.sand.api.PlatformDetection","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Css","ephox.sugar.api.search.Traverse"],function(Arr,PlatformDetection,Element,Node,Css,Traverse){var browser=PlatformDetection.detect().browser;var firstElement=function(nodes){return Arr.find(nodes,Node.isElement)};var getTableCaptionDeltaY=function(elm){if(browser.isFirefox()&&Node.name(elm)==="table"){return firstElement(Traverse.children(elm)).filter(function(elm){return Node.name(elm)==="caption"}).bind(function(caption){return firstElement(Traverse.nextSiblings(caption)).map(function(body){var bodyTop=body.dom().offsetTop;var captionTop=caption.dom().offsetTop;var captionHeight=caption.dom().offsetHeight;return bodyTop<=captionTop?-captionHeight:0})}).getOr(0)}else{return 0}};var getPos=function(body,elm,rootElm){var x=0,y=0,offsetParent,doc=body.ownerDocument,pos;rootElm=rootElm?rootElm:body;if(elm){if(rootElm===body&&elm.getBoundingClientRect&&Css.get(Element.fromDom(body),"position")==="static"){pos=elm.getBoundingClientRect();x=pos.left+(doc.documentElement.scrollLeft||body.scrollLeft)-doc.documentElement.clientLeft;y=pos.top+(doc.documentElement.scrollTop||body.scrollTop)-doc.documentElement.clientTop;return{x:x,y:y}}offsetParent=elm;while(offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType){x+=offsetParent.offsetLeft||0;y+=offsetParent.offsetTop||0;offsetParent=offsetParent.offsetParent}offsetParent=elm.parentNode;while(offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType){x-=offsetParent.scrollLeft||0;y-=offsetParent.scrollTop||0;offsetParent=offsetParent.parentNode}y+=getTableCaptionDeltaY(Element.fromDom(elm))}return{x:x,y:y}};return{getPos:getPos}});define("ephox.katamari.api.LazyValue",["ephox.katamari.api.Arr","ephox.katamari.api.Option","global!setTimeout"],function(Arr,Option,setTimeout){var nu=function(baseFn){var data=Option.none();var callbacks=[];var map=function(f){return nu(function(nCallback){get(function(data){nCallback(f(data))})})};var get=function(nCallback){if(isReady()){call(nCallback)}else{callbacks.push(nCallback)}};var set=function(x){data=Option.some(x);run(callbacks);callbacks=[]};var isReady=function(){return data.isSome()};var run=function(cbs){Arr.each(cbs,call)};var call=function(cb){data.each(function(x){setTimeout(function(){cb(x)},0)})};baseFn(set);return{get:get,map:map,isReady:isReady}};var pure=function(a){return nu(function(callback){callback(a)})};return{nu:nu,pure:pure}});define("ephox.katamari.async.Bounce",["global!Array","global!setTimeout"],function(Array,setTimeout){var bounce=function(f){return function(){var args=Array.prototype.slice.call(arguments);var me=this;setTimeout(function(){f.apply(me,args)},0)}};return{bounce:bounce}});define("ephox.katamari.api.Future",["ephox.katamari.api.LazyValue","ephox.katamari.async.Bounce"],function(LazyValue,Bounce){var nu=function(baseFn){var get=function(callback){baseFn(Bounce.bounce(callback))};var map=function(fab){return nu(function(callback){get(function(a){var value=fab(a);callback(value)})})};var bind=function(aFutureB){return nu(function(callback){get(function(a){aFutureB(a).get(callback)})})};var anonBind=function(futureB){return nu(function(callback){get(function(a){futureB.get(callback)})})};var toLazy=function(){return LazyValue.nu(get)};return{map:map,bind:bind,anonBind:anonBind,toLazy:toLazy,get:get}};var pure=function(a){return nu(function(callback){callback(a)})};return{nu:nu,pure:pure}});define("ephox.katamari.async.AsyncValues",["ephox.katamari.api.Arr"],function(Arr){var par=function(asyncValues,nu){return nu(function(callback){var r=[];var count=0;var cb=function(i){return function(value){r[i]=value;count++;if(count>=asyncValues.length){callback(r)}}};if(asyncValues.length===0){callback([])}else{Arr.each(asyncValues,function(asyncValue,i){asyncValue.get(cb(i))})}})};return{par:par}});define("ephox.katamari.api.Futures",["ephox.katamari.api.Arr","ephox.katamari.api.Future","ephox.katamari.async.AsyncValues"],function(Arr,Future,AsyncValues){var par=function(futures){return AsyncValues.par(futures,Future.nu)};var mapM=function(array,fn){var futures=Arr.map(array,fn);return par(futures)};var compose=function(f,g){return function(a){return g(a).bind(f)}};return{par:par,mapM:mapM,compose:compose}});define("ephox.katamari.api.Result",["ephox.katamari.api.Fun","ephox.katamari.api.Option"],function(Fun,Option){var value=function(o){var is=function(v){return o===v};var or=function(opt){return value(o)};var orThunk=function(f){return value(o)};var map=function(f){return value(f(o))};var each=function(f){f(o)};var bind=function(f){return f(o)};var fold=function(_,onValue){return onValue(o)};var exists=function(f){return f(o)};var forall=function(f){return f(o)};var toOption=function(){return Option.some(o)};return{is:is,isValue:Fun.constant(true),isError:Fun.constant(false),getOr:Fun.constant(o),getOrThunk:Fun.constant(o),getOrDie:Fun.constant(o),or:or,orThunk:orThunk,fold:fold,map:map,each:each,bind:bind,exists:exists,forall:forall,toOption:toOption}};var error=function(message){var getOrThunk=function(f){return f()};var getOrDie=function(){return Fun.die(message)()};var or=function(opt){return opt};var orThunk=function(f){return f()};var map=function(f){return error(message)};var bind=function(f){return error(message)};var fold=function(onError,_){return onError(message)};return{is:Fun.constant(false),isValue:Fun.constant(false),isError:Fun.constant(true),getOr:Fun.identity,getOrThunk:getOrThunk,getOrDie:getOrDie,or:or,orThunk:orThunk,fold:fold,map:map,each:Fun.noop,bind:bind,exists:Fun.constant(false),forall:Fun.constant(true),toOption:Option.none}};return{value:value,error:error}});define("tinymce.core.dom.StyleSheetLoader",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Future","ephox.katamari.api.Futures","ephox.katamari.api.Result","global!navigator","tinymce.core.util.Delay","tinymce.core.util.Tools"],function(Arr,Fun,Future,Futures,Result,navigator,Delay,Tools){"use strict";return function(document,settings){var idCount=0,loadedStates={},maxLoadTime;settings=settings||{};maxLoadTime=settings.maxLoadTime||5e3;var appendToHead=function(node){document.getElementsByTagName("head")[0].appendChild(node)};var load=function(url,loadedCallback,errorCallback){var link,style,startTime,state;var passed=function(){var callbacks=state.passed,i=callbacks.length;while(i--){callbacks[i]()}state.status=2;state.passed=[];state.failed=[]};var failed=function(){var callbacks=state.failed,i=callbacks.length;while(i--){callbacks[i]()}state.status=3;state.passed=[];state.failed=[]};var isOldWebKit=function(){var webKitChunks=navigator.userAgent.match(/WebKit\/(\d*)/);return!!(webKitChunks&&webKitChunks[1]<536)};var wait=function(testCallback,waitCallback){if(!testCallback()){if((new Date).getTime()-startTime<maxLoadTime){Delay.setTimeout(waitCallback)}else{failed()}}};var waitForWebKitLinkLoaded=function(){wait(function(){var styleSheets=document.styleSheets,styleSheet,i=styleSheets.length,owner;while(i--){styleSheet=styleSheets[i];owner=styleSheet.ownerNode?styleSheet.ownerNode:styleSheet.owningElement;if(owner&&owner.id===link.id){passed();return true}}},waitForWebKitLinkLoaded)};var waitForGeckoLinkLoaded=function(){wait(function(){try{var cssRules=style.sheet.cssRules;passed();return!!cssRules}catch(ex){}},waitForGeckoLinkLoaded)};url=Tools._addCacheSuffix(url);if(!loadedStates[url]){state={passed:[],failed:[]};loadedStates[url]=state}else{state=loadedStates[url]}if(loadedCallback){state.passed.push(loadedCallback)}if(errorCallback){state.failed.push(errorCallback)}if(state.status==1){return}if(state.status==2){passed();return}if(state.status==3){failed();return}state.status=1;link=document.createElement("link");link.rel="stylesheet";link.type="text/css";link.id="u"+idCount++;link.async=false;link.defer=false;startTime=(new Date).getTime();if("onload"in link&&!isOldWebKit()){link.onload=waitForWebKitLinkLoaded;link.onerror=failed}else{if(navigator.userAgent.indexOf("Firefox")>0){style=document.createElement("style");style.textContent='@import "'+url+'"';waitForGeckoLinkLoaded();appendToHead(style);return}waitForWebKitLinkLoaded()}appendToHead(link);link.href=url};var loadF=function(url){return Future.nu(function(resolve){load(url,Fun.compose(resolve,Fun.constant(Result.value(url))),Fun.compose(resolve,Fun.constant(Result.error(url))))})};var unbox=function(result){return result.fold(Fun.identity,Fun.identity)};var loadAll=function(urls,success,failure){Futures.par(Arr.map(urls,loadF)).get(function(result){var parts=Arr.partition(result,function(r){return r.isValue()});if(parts.fail.length>0){failure(parts.fail.map(unbox))}else{success(parts.pass.map(unbox))}})};return{load:load,loadAll:loadAll}}});define("tinymce.core.dom.TreeWalker",[],function(){return function(startNode,rootNode){var node=startNode;var findSibling=function(node,startName,siblingName,shallow){var sibling,parent;if(node){if(!shallow&&node[startName]){return node[startName]}if(node!=rootNode){sibling=node[siblingName];if(sibling){return sibling}for(parent=node.parentNode;parent&&parent!=rootNode;parent=parent.parentNode){sibling=parent[siblingName];if(sibling){return sibling}}}}};var findPreviousNode=function(node,startName,siblingName,shallow){var sibling,parent,child;if(node){sibling=node[siblingName];if(rootNode&&sibling===rootNode){return}if(sibling){if(!shallow){for(child=sibling[startName];child;child=child[startName]){if(!child[startName]){return child}}}return sibling}parent=node.parentNode;if(parent&&parent!==rootNode){return parent}}};this.current=function(){return node};this.next=function(shallow){node=findSibling(node,"firstChild","nextSibling",shallow);return node};this.prev=function(shallow){node=findSibling(node,"lastChild","previousSibling",shallow);return node};this.prev2=function(shallow){node=findPreviousNode(node,"lastChild","previousSibling",shallow);return node}}});define("tinymce.core.dom.ElementType",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.node.Node"],function(Arr,Fun,Node){var blocks=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"];var voids=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"];var tableCells=["td","th"];var tableSections=["thead","tbody","tfoot"];var textBlocks=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"];var headings=["h1","h2","h3","h4","h5","h6"];var listItems=["li","dd","dt"];var lists=["ul","ol","dl"];var lazyLookup=function(items){var lookup;return function(node){lookup=lookup?lookup:Arr.mapToObject(items,Fun.constant(true));return lookup.hasOwnProperty(Node.name(node))}};var isHeading=lazyLookup(headings);var isBlock=lazyLookup(blocks);var isInline=function(node){return Node.isElement(node)&&!isBlock(node)};var isBr=function(node){return Node.isElement(node)&&Node.name(node)==="br"};return{isBlock:isBlock,isInline:isInline,isHeading:isHeading,isTextBlock:lazyLookup(textBlocks),isList:lazyLookup(lists),isListItem:lazyLookup(listItems),isVoid:lazyLookup(voids),isTableSection:lazyLookup(tableSections),isTableCell:lazyLookup(tableCells),isBr:isBr}});define("tinymce.core.dom.NodeType",[],function(){var isNodeType=function(type){return function(node){return!!node&&node.nodeType==type}};var isElement=isNodeType(1);var matchNodeNames=function(names){names=names.toLowerCase().split(" ");return function(node){var i,name;if(node&&node.nodeType){name=node.nodeName.toLowerCase();for(i=0;i<names.length;i++){if(name===names[i]){return true}}}return false}};var matchStyleValues=function(name,values){values=values.toLowerCase().split(" ");return function(node){var i,cssValue;if(isElement(node)){for(i=0;i<values.length;i++){cssValue=node.ownerDocument.defaultView.getComputedStyle(node,null).getPropertyValue(name);if(cssValue===values[i]){return true}}}return false}};var hasPropValue=function(propName,propValue){return function(node){return isElement(node)&&node[propName]===propValue}};var hasAttribute=function(attrName,attrValue){return function(node){return isElement(node)&&node.hasAttribute(attrName)}};var hasAttributeValue=function(attrName,attrValue){return function(node){return isElement(node)&&node.getAttribute(attrName)===attrValue}};var isBogus=function(node){return isElement(node)&&node.hasAttribute("data-mce-bogus")};var hasContentEditableState=function(value){return function(node){if(isElement(node)){if(node.contentEditable===value){return true}if(node.getAttribute("data-mce-contenteditable")===value){return true}}return false}};return{isText:isNodeType(3),isElement:isElement,isComment:isNodeType(8),isDocument:isNodeType(9),isBr:matchNodeNames("br"),isContentEditableTrue:hasContentEditableState("true"),isContentEditableFalse:hasContentEditableState("false"),matchNodeNames:matchNodeNames,hasPropValue:hasPropValue,hasAttribute:hasAttribute,hasAttributeValue:hasAttributeValue,matchStyleValues:matchStyleValues,isBogus:isBogus}});define("tinymce.core.dom.TrimNode",["ephox.sugar.api.node.Element","tinymce.core.dom.ElementType","tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(Element,ElementType,NodeType,Tools){var surroundedBySpans=function(node){var previousIsSpan=node.previousSibling&&node.previousSibling.nodeName==="SPAN";var nextIsSpan=node.nextSibling&&node.nextSibling.nodeName==="SPAN";return previousIsSpan&&nextIsSpan};var isBookmarkNode=function(node){return node&&node.tagName==="SPAN"&&node.getAttribute("data-mce-type")==="bookmark"};var trimNode=function(dom,node){var i,children=node.childNodes;if(NodeType.isElement(node)&&isBookmarkNode(node)){return}for(i=children.length-1;i>=0;i--){trimNode(dom,children[i])}if(NodeType.isDocument(node)===false){if(NodeType.isText(node)&&node.nodeValue.length>0){var trimmedLength=Tools.trim(node.nodeValue).length;if(dom.isBlock(node.parentNode)||trimmedLength>0){return}if(trimmedLength===0&&surroundedBySpans(node)){return}}else if(NodeType.isElement(node)){children=node.childNodes;if(children.length===1&&isBookmarkNode(children[0])){node.parentNode.insertBefore(children[0],node)}if(children.length||ElementType.isVoid(Element.fromDom(node))){return}}dom.remove(node)}return node};return{trimNode:trimNode}});define("tinymce.core.html.Entities",["ephox.sugar.api.node.Element","tinymce.core.util.Tools"],function(Element,Tools){var makeMap=Tools.makeMap;var namedEntities,baseEntities,reverseEntities,attrsCharsRegExp=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,asciiMap={128:"‚Ç¨",130:"‚Äö",131:"∆í",132:"‚Äû",133:"‚Ä¶",134:"‚Ä†",135:"‚Ä°",136:"ÀÜ",137:"‚Ä∞",138:"≈†",139:"‚Äπ",140:"≈í",142:"≈Ω",145:"‚Äò",146:"‚Äô",147:"‚Äú",148:"‚Äù",149:"‚Ä¢",150:"‚Äì",151:"‚Äî",152:"Àú",153:"‚Ñ¢",154:"≈°",155:"‚Ä∫",156:"≈ì",158:"≈æ",159:"≈∏"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"};reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};var nativeDecode=function(text){var elm;elm=Element.fromTag("div").dom();elm.innerHTML=text;return elm.textContent||elm.innerText||text};var buildEntitiesLookup=function(items,radix){var i,chr,entity,lookup={};if(items){items=items.split(",");radix=radix||10;for(i=0;i<items.length;i+=2){chr=String.fromCharCode(parseInt(items[i],radix));if(!baseEntities[chr]){entity="&"+items[i+1]+";";lookup[chr]=entity;lookup[entity]=chr}}return lookup}};namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,"+"5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,"+"5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,"+"5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,"+"68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,"+"6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,"+"6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,"+"75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,"+"7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,"+"7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,"+"sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,"+"st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,"+"t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,"+"tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,"+"u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,"+"81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,"+"8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,"+"8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,"+"8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,"+"8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,"+"nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,"+"rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,"+"Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,"+"80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,"+"811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var Entities={encodeRaw:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeAllRaw:function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){if(chr.length>1){return"&#"+((chr.charCodeAt(0)-55296)*1024+(chr.charCodeAt(1)-56320)+65536)+";"}return baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed:function(text,attr,entities){entities=entities||namedEntities;return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc:function(name,entities){entities=buildEntitiesLookup(entities)||namedEntities;var encodeNamedAndNumeric=function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){if(baseEntities[chr]!==undefined){return baseEntities[chr]}if(entities[chr]!==undefined){return entities[chr]}if(chr.length>1){return"&#"+((chr.charCodeAt(0)-55296)*1024+(chr.charCodeAt(1)-56320)+65536)+";"}return"&#"+chr.charCodeAt(0)+";"})};var encodeCustomNamed=function(text,attr){return Entities.encodeNamed(text,attr,entities)};name=makeMap(name.replace(/\+/g,","));if(name.named&&name.numeric){return encodeNamedAndNumeric}if(name.named){if(entities){return encodeCustomNamed}return Entities.encodeNamed}if(name.numeric){return Entities.encodeNumeric}return Entities.encodeRaw},decode:function(text){return text.replace(entityRegExp,function(all,numeric){if(numeric){if(numeric.charAt(0).toLowerCase()==="x"){numeric=parseInt(numeric.substr(1),16)}else{numeric=parseInt(numeric,10)}if(numeric>65535){numeric-=65536;return String.fromCharCode(55296+(numeric>>10),56320+(numeric&1023))}return asciiMap[numeric]||String.fromCharCode(numeric)}return reverseEntities[all]||namedEntities[all]||nativeDecode(all)})}};return Entities});define("tinymce.core.html.Schema",["tinymce.core.util.Tools"],function(Tools){var mapCache={},dummyObj={};var makeMap=Tools.makeMap,each=Tools.each,extend=Tools.extend,explode=Tools.explode,inArray=Tools.inArray;var split=function(items,delim){items=Tools.trim(items);return items?items.split(delim||" "):[]};var compileSchema=function(type){var schema={},globalAttributes,blockContent;var phrasingContent,flowContent,html4BlockContent,html4PhrasingContent;var add=function(name,attributes,children){var ni,attributesOrder,element;var arrayToMap=function(array,obj){var map={},i,l;for(i=0,l=array.length;i<l;i++){map[array[i]]=obj||{}}return map};children=children||[];attributes=attributes||"";if(typeof children==="string"){children=split(children)}name=split(name);ni=name.length;while(ni--){attributesOrder=split([globalAttributes,attributes].join(" "));element={attributes:arrayToMap(attributesOrder),attributesOrder:attributesOrder,children:arrayToMap(children,dummyObj)};schema[name[ni]]=element}};var addAttrs=function(name,attributes){var ni,schemaItem,i,l;name=split(name);ni=name.length;attributes=split(attributes);while(ni--){schemaItem=schema[name[ni]];for(i=0,l=attributes.length;i<l;i++){schemaItem.attributes[attributes[i]]={};schemaItem.attributesOrder.push(attributes[i])}}};if(mapCache[type]){return mapCache[type]}globalAttributes="id accesskey class dir lang style tabindex title role";blockContent="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul";phrasingContent="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd "+"label map noscript object q s samp script select small span strong sub sup "+"textarea u var #text #comment";if(type!="html4"){globalAttributes+=" contenteditable contextmenu draggable dropzone "+"hidden spellcheck translate";blockContent+=" article aside details dialog figure header footer hgroup section nav";phrasingContent+=" audio canvas command datalist mark meter output picture "+"progress time wbr video ruby bdi keygen"}if(type!="html5-strict"){globalAttributes+=" xml:lang";html4PhrasingContent="acronym applet basefont big font strike tt";phrasingContent=[phrasingContent,html4PhrasingContent].join(" ");each(split(html4PhrasingContent),function(name){add(name,"",phrasingContent)});html4BlockContent="center dir isindex noframes";blockContent=[blockContent,html4BlockContent].join(" ");flowContent=[blockContent,phrasingContent].join(" ");each(split(html4BlockContent),function(name){add(name,"",flowContent)})}flowContent=flowContent||[blockContent,phrasingContent].join(" ");add("html","manifest","head body");add("head","","base command link meta noscript script style title");add("title hr noscript br");add("base","href target");add("link","href rel media hreflang type sizes hreflang");add("meta","name http-equiv content charset");add("style","media type scoped");add("script","src async defer type charset");add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus "+"onhashchange onload onmessage onoffline ononline onpagehide onpageshow "+"onpopstate onresize onscroll onstorage onunload",flowContent);add("address dt dd div caption","",flowContent);add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",phrasingContent);add("blockquote","cite",flowContent);add("ol","reversed start type","li");add("ul","","li");add("li","value",flowContent);add("dl","","dt dd");add("a","href target rel media hreflang type",phrasingContent);add("q","cite",phrasingContent);add("ins del","cite datetime",flowContent);add("img","src sizes srcset alt usemap ismap width height");add("iframe","src name width height",flowContent);add("embed","src type width height");add("object","data type typemustmatch name usemap form width height",[flowContent,"param"].join(" "));add("param","name value");add("map","name",[flowContent,"area"].join(" "));add("area","alt coords shape href target rel media hreflang type");add("table","border","caption colgroup thead tfoot tbody tr"+(type=="html4"?" col":""));add("colgroup","span","col");add("col","span");add("tbody thead tfoot","","tr");add("tr","","td th");add("td","colspan rowspan headers",flowContent);add("th","colspan rowspan headers scope abbr",flowContent);add("form","accept-charset action autocomplete enctype method name novalidate target",flowContent);add("fieldset","disabled form name",[flowContent,"legend"].join(" "));add("label","form for",phrasingContent);add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate "+"formtarget height list max maxlength min multiple name pattern readonly required size src step type value width");add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",type=="html4"?flowContent:phrasingContent);add("select","disabled form multiple name required size","option optgroup");add("optgroup","disabled label","option");add("option","disabled label selected value");add("textarea","cols dirname disabled form maxlength name readonly required rows wrap");add("menu","type label",[flowContent,"li"].join(" "));add("noscript","",flowContent);if(type!="html4"){add("wbr");add("ruby","",[phrasingContent,"rt rp"].join(" "));add("figcaption","",flowContent);add("mark rt rp summary bdi","",phrasingContent);add("canvas","width height",flowContent);add("video","src crossorigin poster preload autoplay mediagroup loop "+"muted controls width height buffered",[flowContent,"track source"].join(" "));add("audio","src crossorigin preload autoplay mediagroup loop muted controls "+"buffered volume",[flowContent,"track source"].join(" "));add("picture","","img source");add("source","src srcset type media sizes");add("track","kind src srclang label default");add("datalist","",[phrasingContent,"option"].join(" "));add("article section nav aside header footer","",flowContent);add("hgroup","","h1 h2 h3 h4 h5 h6");add("figure","",[flowContent,"figcaption"].join(" "));add("time","datetime",phrasingContent);add("dialog","open",flowContent);add("command","type label icon disabled checked radiogroup command");add("output","for form name",phrasingContent);add("progress","value max",phrasingContent);add("meter","value min max low high optimum",phrasingContent);add("details","open",[flowContent,"summary"].join(" "));add("keygen","autofocus challenge disabled form keytype name")}if(type!="html5-strict"){addAttrs("script","language xml:space");addAttrs("style","xml:space");addAttrs("object","declare classid code codebase codetype archive standby align border hspace vspace");addAttrs("embed","align name hspace vspace");addAttrs("param","valuetype type");addAttrs("a","charset name rev shape coords");addAttrs("br","clear");addAttrs("applet","codebase archive code object alt name width height align hspace vspace");addAttrs("img","name longdesc align border hspace vspace");addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align");addAttrs("font basefont","size color face");addAttrs("input","usemap align");addAttrs("select","onchange");addAttrs("textarea");addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align");addAttrs("ul","type compact");addAttrs("li","type");addAttrs("ol dl menu dir","compact");addAttrs("pre","width xml:space");addAttrs("hr","align noshade size width");addAttrs("isindex","prompt");addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor");addAttrs("col","width align char charoff valign");addAttrs("colgroup","width align char charoff valign");addAttrs("thead","align char charoff valign");addAttrs("tr","align char charoff valign bgcolor");addAttrs("th","axis align char charoff valign nowrap bgcolor width height");addAttrs("form","accept");addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height");addAttrs("tfoot","align char charoff valign");addAttrs("tbody","align char charoff valign");addAttrs("area","nohref");addAttrs("body","background bgcolor text link vlink alink")}if(type!="html4"){addAttrs("input button select textarea","autofocus");addAttrs("input textarea","placeholder");addAttrs("a","download");addAttrs("link script img","crossorigin");addAttrs("iframe","sandbox seamless allowfullscreen")}each(split("a form meter progress dfn"),function(name){if(schema[name]){delete schema[name].children[name]}});delete schema.caption.children.table;delete schema.script;mapCache[type]=schema;return schema};var compileElementMap=function(value,mode){var styles;if(value){styles={};if(typeof value=="string"){value={"*":value}}each(value,function(value,key){styles[key]=styles[key.toUpperCase()]=mode=="map"?makeMap(value,/[, ]/):explode(value,/[, ]/)})}return styles};return function(settings){var self=this,elements={},children={},patternElements=[],validStyles,invalidStyles,schemaItems;var whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,validClasses;var blockElementsMap,nonEmptyElementsMap,moveCaretBeforeOnEnterElementsMap,textBlockElementsMap,textInlineElementsMap;var customElementsMap={},specialElements={};var createLookupTable=function(option,defaultValue,extendWith){var value=settings[option];if(!value){value=mapCache[option];if(!value){value=makeMap(defaultValue," ",makeMap(defaultValue.toUpperCase()," "));value=extend(value,extendWith);mapCache[option]=value}}else{value=makeMap(value,/[, ]/,makeMap(value.toUpperCase(),/[, ]/))}return value};settings=settings||{};schemaItems=compileSchema(settings.schema);if(settings.verify_html===false){settings.valid_elements="*[*]"}validStyles=compileElementMap(settings.valid_styles);invalidStyles=compileElementMap(settings.invalid_styles,"map");validClasses=compileElementMap(settings.valid_classes,"map");whiteSpaceElementsMap=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object code");selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link "+"meta param embed source wbr track");boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize "+"noshade nowrap readonly selected autoplay loop controls");nonEmptyElementsMap=createLookupTable("non_empty_elements","td th iframe video audio object "+"script pre code",shortEndedElementsMap);moveCaretBeforeOnEnterElementsMap=createLookupTable("move_caret_before_on_enter_elements","table",nonEmptyElementsMap);textBlockElementsMap=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form "+"blockquote center dir fieldset header footer article section hgroup aside nav figure");blockElementsMap=createLookupTable("block_elements","hr table tbody thead tfoot "+"th tr td li ol ul caption dl dt dd noscript menu isindex option "+"datalist select optgroup figcaption",textBlockElementsMap);textInlineElementsMap=createLookupTable("text_inline_elements","span strong b em i font strike u var cite "+"dfn code mark q sup sub samp");each((settings.special||"script noscript noframes noembed title style textarea xmp").split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")});var patternToRegExp=function(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")};var addValidElements=function(validElements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value,elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(validElements){validElements=split(validElements,",");if(elements["@"]){globalAttributes=elements["@"].attributes;globalAttributesOrder=elements["@"].attributesOrder}for(ei=0,el=validElements.length;ei<el;ei++){matches=elementRuleRegExp.exec(validElements[ei]);if(matches){prefix=matches[1];elementName=matches[2];outputName=matches[3];attrData=matches[5];attributes={};attributesOrder=[];element={attributes:attributes,attributesOrder:attributesOrder};if(prefix==="#"){element.paddEmpty=true}if(prefix==="-"){element.removeEmpty=true}if(matches[4]==="!"){element.removeEmptyAttrs=true}if(globalAttributes){for(key in globalAttributes){attributes[key]=globalAttributes[key]}attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData){attrData=split(attrData,"|");for(ai=0,al=attrData.length;ai<al;ai++){matches=attrRuleRegExp.exec(attrData[ai]);if(matches){attr={};attrType=matches[1];attrName=matches[2].replace(/[\\:]:/g,":");prefix=matches[3];value=matches[4];if(attrType==="!"){element.attributesRequired=element.attributesRequired||[];element.attributesRequired.push(attrName);attr.required=true}if(attrType==="-"){delete attributes[attrName];attributesOrder.splice(inArray(attributesOrder,attrName),1);continue}if(prefix){if(prefix==="="){element.attributesDefault=element.attributesDefault||[];element.attributesDefault.push({name:attrName,value:value});attr.defaultValue=value}if(prefix===":"){element.attributesForced=element.attributesForced||[];element.attributesForced.push({name:attrName,value:value});attr.forcedValue=value}if(prefix==="<"){attr.validValues=makeMap(value,"?")}}if(hasPatternsRegExp.test(attrName)){element.attributePatterns=element.attributePatterns||[];attr.pattern=patternToRegExp(attrName);element.attributePatterns.push(attr)}else{if(!attributes[attrName]){attributesOrder.push(attrName)}attributes[attrName]=attr}}}}if(!globalAttributes&&elementName=="@"){globalAttributes=attributes;globalAttributesOrder=attributesOrder}if(outputName){element.outputName=elementName;elements[outputName]=element}if(hasPatternsRegExp.test(elementName)){element.pattern=patternToRegExp(elementName);patternElements.push(element)}else{elements[elementName]=element}}}}};var setValidElements=function(validElements){elements={};patternElements=[];addValidElements(validElements);each(schemaItems,function(element,name){children[name]=element.children})};var addCustomElements=function(customElements){var customElementRegExp=/^(~)?(.+)$/;if(customElements){mapCache.text_block_elements=mapCache.block_elements=null;each(split(customElements,","),function(rule){var matches=customElementRegExp.exec(rule),inline=matches[1]==="~",cloneName=inline?"span":"div",name=matches[2];children[name]=children[cloneName];customElementsMap[name]=cloneName;if(!inline){blockElementsMap[name.toUpperCase()]={};blockElementsMap[name]={}}if(!elements[name]){var customRule=elements[cloneName];customRule=extend({},customRule);delete customRule.removeEmptyAttrs;delete customRule.removeEmpty;elements[name]=customRule}each(children,function(element,elmName){if(element[cloneName]){children[elmName]=element=extend({},children[elmName]);element[name]=element[cloneName]}})})}};var addValidChildren=function(validChildren){var childRuleRegExp=/^([+\-]?)(\w+)\[([^\]]+)\]$/;mapCache[settings.schema]=null;if(validChildren){each(split(validChildren,","),function(rule){var matches=childRuleRegExp.exec(rule),parent,prefix;if(matches){prefix=matches[1];if(prefix){parent=children[matches[2]]}else{parent=children[matches[2]]={"#comment":{}}}parent=children[matches[2]];each(split(matches[3],"|"),function(child){if(prefix==="-"){delete parent[child]}else{parent[child]={}}})}})}};var getElementRule=function(name){var element=elements[name],i;if(element){return element}i=patternElements.length;while(i--){element=patternElements[i];if(element.pattern.test(name)){return element}}};if(!settings.valid_elements){each(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder};children[name]=element.children});if(settings.schema!="html5"){each(split("strong/b em/i"),function(item){item=split(item,"/");elements[item[1]].outputName=item[0]})}each(split("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(name){if(elements[name]){elements[name].removeEmpty=true}});each(split("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(name){elements[name].paddEmpty=true});each(split("span"),function(name){elements[name].removeEmptyAttrs=true})}else{setValidElements(settings.valid_elements)}addCustomElements(settings.custom_elements);addValidChildren(settings.valid_children);addValidElements(settings.extended_valid_elements);addValidChildren("+ol[ul|ol],+ul[ul|ol]");each({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(parents,item){if(elements[item]){elements[item].parentsRequired=split(parents)}});if(settings.invalid_elements){each(explode(settings.invalid_elements),function(item){if(elements[item]){delete elements[item]}})}if(!getElementRule("span")){addValidElements("span[!data-mce-type|*]")}self.children=children;self.getValidStyles=function(){return validStyles};self.getInvalidStyles=function(){return invalidStyles};self.getValidClasses=function(){return validClasses};self.getBoolAttrs=function(){return boolAttrMap};self.getBlockElements=function(){return blockElementsMap};self.getTextBlockElements=function(){return textBlockElementsMap};self.getTextInlineElements=function(){return textInlineElementsMap};self.getShortEndedElements=function(){return shortEndedElementsMap};self.getSelfClosingElements=function(){return selfClosingElementsMap};self.getNonEmptyElements=function(){return nonEmptyElementsMap};self.getMoveCaretBeforeOnEnterElements=function(){return moveCaretBeforeOnEnterElementsMap};self.getWhiteSpaceElements=function(){return whiteSpaceElementsMap};self.getSpecialElements=function(){return specialElements};self.isValidChild=function(name,child){var parent=children[name.toLowerCase()];return!!(parent&&parent[child.toLowerCase()])};self.isValid=function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule){if(attr){if(rule.attributes[attr]){return true}attrPatterns=rule.attributePatterns;if(attrPatterns){i=attrPatterns.length;while(i--){if(attrPatterns[i].pattern.test(name)){return true}}}}else{return true}}return false};self.getElementRule=getElementRule;self.getCustomElements=function(){return customElementsMap};self.addValidElements=addValidElements;self.setValidElements=setValidElements;self.addCustomElements=addCustomElements;self.addValidChildren=addValidChildren;self.elements=elements}});define("tinymce.core.html.Styles",[],function(){return function(settings,schema){var rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,i,encodingLookup={},encodingItems,validStyles,invalidStyles,invisibleChar="\ufeff";settings=settings||{};if(schema){validStyles=schema.getValidStyles();invalidStyles=schema.getInvalidStyles()}encodingItems=("\\\" \\' \\; \\: ; : "+invisibleChar).split(" ");for(i=0;i<encodingItems.length;i++){encodingLookup[encodingItems[i]]=invisibleChar+i;encodingLookup[invisibleChar+i]=encodingItems[i]}var toHex=function(match,r,g,b){var hex=function(val){val=parseInt(val,10).toString(16);return val.length>1?val:"0"+val};return"#"+hex(r)+hex(g)+hex(b)};return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){var styles={},matches,name,value,isEncoded,urlConverter=settings.url_converter;var urlConverterScope=settings.url_converter_scope||this;var compress=function(prefix,suffix,noJoin){var top,right,bottom,left;top=styles[prefix+"-top"+suffix];if(!top){return}right=styles[prefix+"-right"+suffix];if(!right){return}bottom=styles[prefix+"-bottom"+suffix];if(!bottom){return}left=styles[prefix+"-left"+suffix];if(!left){return}var box=[top,right,bottom,left];i=box.length-1;while(i--){if(box[i]!==box[i+1]){break}}if(i>-1&&noJoin){return}styles[prefix+suffix]=i==-1?box[0]:box.join(" ");delete styles[prefix+"-top"+suffix];delete styles[prefix+"-right"+suffix];delete styles[prefix+"-bottom"+suffix];delete styles[prefix+"-left"+suffix]};var canCompress=function(key){var value=styles[key],i;if(!value){return}value=value.split(" ");i=value.length;while(i--){if(value[i]!==value[0]){return false}}styles[key]=value[0];return true};var compress2=function(target,a,b,c){if(!canCompress(a)){return}if(!canCompress(b)){return}if(!canCompress(c)){return}styles[target]=styles[a]+" "+styles[b]+" "+styles[c];delete styles[a];delete styles[b];delete styles[c]};var encode=function(str){isEncoded=true;return encodingLookup[str]};var decode=function(str,keepSlashes){if(isEncoded){str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]})}if(!keepSlashes){str=str.replace(/\\([\'\";:])/g,"$1")}return str};var decodeSingleHexSequence=function(escSeq){return String.fromCharCode(parseInt(escSeq.slice(1),16))};var decodeHexSequences=function(value){return value.replace(/\\[0-9a-f]+/gi,decodeSingleHexSequence)};var processUrl=function(match,url,url2,url3,str,str2){str=str||str2;if(str){str=decode(str);return"'"+str.replace(/\'/g,"\\'")+"'"}url=decode(url||url2||url3);if(!settings.allow_script_urls){var scriptUrl=url.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(scriptUrl)){return""}if(!settings.allow_svg_data_urls&&/^data:image\/svg/i.test(scriptUrl)){return""}}if(urlConverter){url=urlConverter.call(urlConverterScope,url,"style")}return"url('"+url.replace(/\'/g,"\\'")+"')"};if(css){css=css.replace(/[\u0000-\u001F]/g,"");css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});while(matches=styleRegExp.exec(css)){styleRegExp.lastIndex=matches.index+matches[0].length;name=matches[1].replace(trimRightRegExp,"").toLowerCase();value=matches[2].replace(trimRightRegExp,"");if(name&&value){name=decodeHexSequences(name);value=decodeHexSequences(value);if(name.indexOf(invisibleChar)!==-1||name.indexOf('"')!==-1){continue}if(!settings.allow_script_urls&&(name=="behavior"||/expression\s*\(|\/\*|\*\//.test(value))){continue}if(name==="font-weight"&&value==="700"){value="bold"}else if(name==="color"||name==="background-color"){value=value.toLowerCase()}value=value.replace(rgbRegExp,toHex);value=value.replace(urlOrStrRegExp,processUrl);styles[name]=isEncoded?decode(value,true):value}}compress("border","",true);compress("border","-width");compress("border","-color");compress("border","-style");compress("padding","");compress("margin","");compress2("border","border-width","border-style","border-color");if(styles.border==="medium none"){delete styles.border}if(styles["border-image"]==="none"){delete styles["border-image"]}}return styles},serialize:function(styles,elementName){var css="",name,value;var serializeStyles=function(name){var styleList,i,l,value;styleList=validStyles[name];if(styleList){for(i=0,l=styleList.length;i<l;i++){name=styleList[i];value=styles[name];if(value){css+=(css.length>0?" ":"")+name+": "+value+";"}}}};var isValid=function(name,elementName){var styleMap;styleMap=invalidStyles["*"];if(styleMap&&styleMap[name]){return false}styleMap=invalidStyles[elementName];if(styleMap&&styleMap[name]){return false}return true};if(elementName&&validStyles){serializeStyles("*");serializeStyles(elementName)}else{for(name in styles){value=styles[name];if(value&&(!invalidStyles||isValid(name,elementName))){css+=(css.length>0?" ":"")+name+": "+value+";"}}}return css}}}});define("tinymce.core.dom.DOMUtils",["global!document","global!window","tinymce.core.Env","tinymce.core.dom.DomQuery","tinymce.core.dom.EventUtils","tinymce.core.dom.Position","tinymce.core.dom.Sizzle","tinymce.core.dom.StyleSheetLoader","tinymce.core.dom.TreeWalker","tinymce.core.dom.TrimNode","tinymce.core.html.Entities","tinymce.core.html.Schema","tinymce.core.html.Styles","tinymce.core.util.Tools"],function(document,window,Env,DomQuery,EventUtils,Position,Sizzle,StyleSheetLoader,TreeWalker,TrimNode,Entities,Schema,Styles,Tools){var each=Tools.each,is=Tools.is,grep=Tools.grep;var isIE=Env.ie;var simpleSelectorRe=/^([a-z0-9],?)+$/i;var whiteSpaceRegExp=/^[ \t\r\n]*$/;var setupAttrHooks=function(domUtils,settings){var attrHooks={},keepValues=settings.keep_values,keepUrlHook;keepUrlHook={set:function($elm,value,name){if(settings.url_converter){value=settings.url_converter.call(settings.url_converter_scope||domUtils,value,name,$elm[0])}$elm.attr("data-mce-"+name,value).attr(name,value)},get:function($elm,name){return $elm.attr("data-mce-"+name)||$elm.attr(name)}};attrHooks={style:{set:function($elm,value){if(value!==null&&typeof value==="object"){$elm.css(value);return}if(keepValues){$elm.attr("data-mce-style",value)}$elm.attr("style",value)},get:function($elm){var value=$elm.attr("data-mce-style")||$elm.attr("style");value=domUtils.serializeStyle(domUtils.parseStyle(value),$elm[0].nodeName);return value}}};if(keepValues){attrHooks.href=attrHooks.src=keepUrlHook}return attrHooks};var updateInternalStyleAttr=function(domUtils,$elm){var value=$elm.attr("style");value=domUtils.serializeStyle(domUtils.parseStyle(value),$elm[0].nodeName);if(!value){value=null}$elm.attr("data-mce-style",value)};var nodeIndex=function(node,normalized){var idx=0,lastNodeType,nodeType;if(node){for(lastNodeType=node.nodeType,node=node.previousSibling;node;node=node.previousSibling){nodeType=node.nodeType;if(normalized&&nodeType==3){if(nodeType==lastNodeType||!node.nodeValue.length){continue}}idx++;lastNodeType=nodeType}}return idx};var DOMUtils=function(doc,settings){var self=this,blockElementsMap;self.doc=doc;self.win=window;self.files={};self.counter=0;self.stdMode=!isIE||doc.documentMode>=8;self.boxModel=!isIE||doc.compatMode=="CSS1Compat"||self.stdMode;self.styleSheetLoader=new StyleSheetLoader(doc);self.boundEvents=[];self.settings=settings=settings||{};self.schema=settings.schema?settings.schema:new Schema({});self.styles=new Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema);self.fixDoc(doc);self.events=settings.ownEvents?new EventUtils(settings.proxy):EventUtils.Event;self.attrHooks=setupAttrHooks(self,settings);blockElementsMap=self.schema.getBlockElements();self.$=DomQuery.overrideDefaults(function(){return{context:doc,element:self.getRoot()}});self.isBlock=function(node){if(!node){return false}var type=node.nodeType;if(type){return!!(type===1&&blockElementsMap[node.nodeName])}return!!blockElementsMap[node]}};DOMUtils.prototype={$$:function(elm){if(typeof elm=="string"){elm=this.get(elm)}return this.$(elm)},root:null,fixDoc:function(doc){var settings=this.settings,name;if(isIE&&settings.schema){("abbr article aside audio canvas "+"details figcaption figure footer "+"header hgroup mark menu meter nav "+"output progress section summary "+"time video").replace(/\w+/g,function(name){doc.createElement(name)});for(name in settings.schema.getCustomElements()){doc.createElement(name)}}},clone:function(node,deep){var self=this,clone,doc;if(!isIE||node.nodeType!==1||deep){return node.cloneNode(deep)}doc=self.doc;if(!deep){clone=doc.createElement(node.nodeName);each(self.getAttribs(node),function(attr){self.setAttrib(clone,attr.nodeName,self.getAttrib(node,attr.nodeName))});return clone}return clone.firstChild},getRoot:function(){var self=this;return self.settings.root_element||self.doc.body},getViewPort:function(win){var doc,rootElm;win=!win?this.win:win;doc=win.document;rootElm=this.boxModel?doc.documentElement:doc.body;return{x:win.pageXOffset||rootElm.scrollLeft,y:win.pageYOffset||rootElm.scrollTop,w:win.innerWidth||rootElm.clientWidth,h:win.innerHeight||rootElm.clientHeight}},getRect:function(elm){var self=this,pos,size;elm=self.get(elm);pos=self.getPos(elm);size=self.getSize(elm);return{x:pos.x,y:pos.y,w:size.w,h:size.h}},getSize:function(elm){var self=this,w,h;elm=self.get(elm);w=self.getStyle(elm,"width");h=self.getStyle(elm,"height");if(w.indexOf("px")===-1){w=0}if(h.indexOf("px")===-1){h=0}return{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight}},getParent:function(node,selector,root){return this.getParents(node,selector,root,false)},getParents:function(node,selector,root,collect){var self=this,selectorVal,result=[];node=self.get(node);collect=collect===undefined;root=root||(self.getRoot().nodeName!="BODY"?self.getRoot().parentNode:null);if(is(selector,"string")){selectorVal=selector;if(selector==="*"){selector=function(node){return node.nodeType==1}}else{selector=function(node){return self.is(node,selectorVal)}}}while(node){if(node==root||!node.nodeType||node.nodeType===9){break}if(!selector||selector(node)){if(collect){result.push(node)}else{return node}}node=node.parentNode}return collect?result:null},get:function(elm){var name;if(elm&&this.doc&&typeof elm=="string"){name=elm;elm=this.doc.getElementById(elm);if(elm&&elm.id!==name){return this.doc.getElementsByName(name)[1]}}return elm},getNext:function(node,selector){return this._findSib(node,selector,"nextSibling")},getPrev:function(node,selector){return this._findSib(node,selector,"previousSibling")},select:function(selector,scope){var self=this;return Sizzle(selector,self.get(scope)||self.settings.root_element||self.doc,[])},is:function(elm,selector){var i;if(!elm){return false}if(elm.length===undefined){if(selector==="*"){return elm.nodeType==1}if(simpleSelectorRe.test(selector)){selector=selector.toLowerCase().split(/,/);elm=elm.nodeName.toLowerCase();for(i=selector.length-1;i>=0;i--){if(selector[i]==elm){return true}}return false}}if(elm.nodeType&&elm.nodeType!=1){return false}var elms=elm.nodeType?[elm]:elm;return Sizzle(selector,elms[0].ownerDocument||elms[0],null,elms).length>0},add:function(parentElm,name,attrs,html,create){var self=this;return this.run(parentElm,function(parentElm){var newElm;newElm=is(name,"string")?self.doc.createElement(name):name;self.setAttribs(newElm,attrs);if(html){if(html.nodeType){newElm.appendChild(html)}else{self.setHTML(newElm,html)}}return!create?parentElm.appendChild(newElm):newElm})},create:function(name,attrs,html){return this.add(this.doc.createElement(name),name,attrs,html,1)},createHTML:function(name,attrs,html){var outHtml="",key;outHtml+="<"+name;for(key in attrs){if(attrs.hasOwnProperty(key)&&attrs[key]!==null&&typeof attrs[key]!="undefined"){outHtml+=" "+key+'="'+this.encode(attrs[key])+'"'}}if(typeof html!="undefined"){return outHtml+">"+html+"</"+name+">"}return outHtml+" />"},createFragment:function(html){var frag,node,doc=this.doc,container;container=doc.createElement("div");frag=doc.createDocumentFragment();if(html){container.innerHTML=html}while(node=container.firstChild){frag.appendChild(node)}return frag},remove:function(node,keepChildren){node=this.$$(node);if(keepChildren){node.each(function(){var child;while(child=this.firstChild){if(child.nodeType==3&&child.data.length===0){this.removeChild(child)}else{this.parentNode.insertBefore(child,this)}}}).remove()}else{node.remove()}return node.length>1?node.toArray():node[0]},setStyle:function(elm,name,value){elm=this.$$(elm).css(name,value);if(this.settings.update_styles){updateInternalStyleAttr(this,elm)}},getStyle:function(elm,name,computed){elm=this.$$(elm);if(computed){return elm.css(name)}name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(name=="float"){name=Env.ie&&Env.ie<12?"styleFloat":"cssFloat"}return elm[0]&&elm[0].style?elm[0].style[name]:undefined},setStyles:function(elm,styles){elm=this.$$(elm).css(styles);if(this.settings.update_styles){updateInternalStyleAttr(this,elm)}},removeAllAttribs:function(e){return this.run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--){e.removeAttributeNode(attrs.item(i))}})},setAttrib:function(elm,name,value){var self=this,originalValue,hook,settings=self.settings;if(value===""){value=null}elm=self.$$(elm);originalValue=elm.attr(name);if(!elm.length){return}hook=self.attrHooks[name];if(hook&&hook.set){hook.set(elm,value,name)}else{elm.attr(name,value)}if(originalValue!=value&&settings.onSetAttrib){settings.onSetAttrib({attrElm:elm,attrName:name,attrValue:value})}},setAttribs:function(elm,attrs){var self=this;self.$$(elm).each(function(i,node){each(attrs,function(value,name){self.setAttrib(node,name,value)})})},getAttrib:function(elm,name,defaultVal){var self=this,hook,value;elm=self.$$(elm);if(elm.length){hook=self.attrHooks[name];if(hook&&hook.get){value=hook.get(elm,name)}else{value=elm.attr(name)}}if(typeof value=="undefined"){value=defaultVal||""}return value},getPos:function(elm,rootElm){return Position.getPos(this.doc.body,this.get(elm),rootElm)},parseStyle:function(cssText){return this.styles.parse(cssText)},serializeStyle:function(styles,name){return this.styles.serialize(styles,name)},addStyle:function(cssText){var self=this,doc=self.doc,head,styleElm;if(self!==DOMUtils.DOM&&doc===document){var addedStyles=DOMUtils.DOM.addedStyles;addedStyles=addedStyles||[];if(addedStyles[cssText]){return}addedStyles[cssText]=true;DOMUtils.DOM.addedStyles=addedStyles}styleElm=doc.getElementById("mceDefaultStyles");if(!styleElm){styleElm=doc.createElement("style");styleElm.id="mceDefaultStyles";styleElm.type="text/css";head=doc.getElementsByTagName("head")[0];if(head.firstChild){head.insertBefore(styleElm,head.firstChild)}else{head.appendChild(styleElm)}}if(styleElm.styleSheet){styleElm.styleSheet.cssText+=cssText}else{styleElm.appendChild(doc.createTextNode(cssText))}},loadCSS:function(url){var self=this,doc=self.doc,head;if(self!==DOMUtils.DOM&&doc===document){DOMUtils.DOM.loadCSS(url);return}if(!url){url=""}head=doc.getElementsByTagName("head")[0];each(url.split(","),function(url){var link;url=Tools._addCacheSuffix(url);if(self.files[url]){return}self.files[url]=true;link=self.create("link",{rel:"stylesheet",href:url});if(isIE&&doc.documentMode&&doc.recalc){link.onload=function(){if(doc.recalc){doc.recalc()}link.onload=null}}head.appendChild(link)})},addClass:function(elm,cls){this.$$(elm).addClass(cls)},removeClass:function(elm,cls){this.toggleClass(elm,cls,false)},hasClass:function(elm,cls){return this.$$(elm).hasClass(cls)},toggleClass:function(elm,cls,state){this.$$(elm).toggleClass(cls,state).each(function(){if(this.className===""){DomQuery(this).attr("class",null)}})},show:function(elm){this.$$(elm).show()},hide:function(elm){this.$$(elm).hide()},isHidden:function(elm){return this.$$(elm).css("display")=="none"},uniqueId:function(prefix){return(!prefix?"mce_":prefix)+this.counter++},setHTML:function(elm,html){elm=this.$$(elm);if(isIE){elm.each(function(i,target){if(target.canHaveHTML===false){return}while(target.firstChild){target.removeChild(target.firstChild)}try{target.innerHTML="<br>"+html;target.removeChild(target.firstChild)}catch(ex){DomQuery("<div></div>").html("<br>"+html).contents().slice(1).appendTo(target)}return html})}else{elm.html(html)}},getOuterHTML:function(elm){elm=this.get(elm);return elm.nodeType==1&&"outerHTML"in elm?elm.outerHTML:DomQuery("<div></div>").append(DomQuery(elm).clone()).html()},setOuterHTML:function(elm,html){var self=this;self.$$(elm).each(function(){try{if("outerHTML"in this){this.outerHTML=html;return}}catch(ex){}self.remove(DomQuery(this).html(html),true)})},decode:Entities.decode,encode:Entities.encodeAllRaw,insertAfter:function(node,referenceNode){referenceNode=this.get(referenceNode);return this.run(node,function(node){var parent,nextSibling;parent=referenceNode.parentNode;nextSibling=referenceNode.nextSibling;if(nextSibling){parent.insertBefore(node,nextSibling)}else{parent.appendChild(node)}return node})},replace:function(newElm,oldElm,keepChildren){var self=this;return self.run(oldElm,function(oldElm){if(is(oldElm,"array")){newElm=newElm.cloneNode(true)}if(keepChildren){each(grep(oldElm.childNodes),function(node){newElm.appendChild(node)})}return oldElm.parentNode.replaceChild(newElm,oldElm)})},rename:function(elm,name){var self=this,newElm;if(elm.nodeName!=name.toUpperCase()){newElm=self.create(name);each(self.getAttribs(elm),function(attrNode){self.setAttrib(newElm,attrNode.nodeName,self.getAttrib(elm,attrNode.nodeName))});self.replace(newElm,elm,1)}return newElm||elm},findCommonAncestor:function(a,b){var ps=a,pe;while(ps){pe=b;while(pe&&ps!=pe){pe=pe.parentNode}if(ps==pe){break}ps=ps.parentNode}if(!ps&&a.ownerDocument){return a.ownerDocument.documentElement}return ps},toHex:function(rgbVal){return this.styles.toHex(Tools.trim(rgbVal))},run:function(elm,func,scope){var self=this,result;if(typeof elm==="string"){elm=self.get(elm)}if(!elm){return false}scope=scope||this;if(!elm.nodeType&&(elm.length||elm.length===0)){result=[];each(elm,function(elm,i){if(elm){if(typeof elm=="string"){elm=self.get(elm)}result.push(func.call(scope,elm,i))}});return result}return func.call(scope,elm)},getAttribs:function(elm){var attrs;elm=this.get(elm);if(!elm){return[]}if(isIE){attrs=[];if(elm.nodeName=="OBJECT"){return elm.attributes}if(elm.nodeName==="OPTION"&&this.getAttrib(elm,"selected")){attrs.push({specified:1,nodeName:"selected"})}var attrRegExp=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;elm.cloneNode(false).outerHTML.replace(attrRegExp,"").replace(/[\w:\-]+/gi,function(a){attrs.push({specified:1,nodeName:a})});return attrs}return elm.attributes},isEmpty:function(node,elements){var self=this,i,attributes,type,whitespace,walker,name,brCount=0;node=node.firstChild;if(node){walker=new TreeWalker(node,node.parentNode);elements=elements||(self.schema?self.schema.getNonEmptyElements():null);whitespace=self.schema?self.schema.getWhiteSpaceElements():{};do{type=node.nodeType;if(type===1){var bogusVal=node.getAttribute("data-mce-bogus");if(bogusVal){node=walker.next(bogusVal==="all");continue}name=node.nodeName.toLowerCase();if(elements&&elements[name]){if(name==="br"){brCount++;node=walker.next();continue}return false}attributes=self.getAttribs(node);i=attributes.length;while(i--){name=attributes[i].nodeName;if(name==="name"||name==="data-mce-bookmark"){return false}}}if(type==8){return false}if(type===3&&!whiteSpaceRegExp.test(node.nodeValue)){return false}if(type===3&&node.parentNode&&whitespace[node.parentNode.nodeName]&&whiteSpaceRegExp.test(node.nodeValue)){return false}node=walker.next()}while(node)}return brCount<=1},createRng:function(){return this.doc.createRange()},nodeIndex:nodeIndex,split:function(parentElm,splitElm,replacementElm){var self=this,r=self.createRng(),bef,aft,pa;if(parentElm&&splitElm){r.setStart(parentElm.parentNode,self.nodeIndex(parentElm));r.setEnd(splitElm.parentNode,self.nodeIndex(splitElm));bef=r.extractContents();r=self.createRng();r.setStart(splitElm.parentNode,self.nodeIndex(splitElm)+1);r.setEnd(parentElm.parentNode,self.nodeIndex(parentElm)+1);aft=r.extractContents();pa=parentElm.parentNode;pa.insertBefore(TrimNode.trimNode(self,bef),parentElm);if(replacementElm){pa.insertBefore(replacementElm,parentElm)}else{pa.insertBefore(splitElm,parentElm)}pa.insertBefore(TrimNode.trimNode(self,aft),parentElm);self.remove(parentElm);return replacementElm||splitElm}},bind:function(target,name,func,scope){var self=this;if(Tools.isArray(target)){var i=target.length;while(i--){target[i]=self.bind(target[i],name,func,scope)}return target}if(self.settings.collect&&(target===self.doc||target===self.win)){self.boundEvents.push([target,name,func,scope])}return self.events.bind(target,name,func,scope||self)},unbind:function(target,name,func){var self=this,i;if(Tools.isArray(target)){i=target.length;while(i--){target[i]=self.unbind(target[i],name,func)}return target}if(self.boundEvents&&(target===self.doc||target===self.win)){i=self.boundEvents.length;while(i--){var item=self.boundEvents[i];if(target==item[0]&&(!name||name==item[1])&&(!func||func==item[2])){this.events.unbind(item[0],item[1],item[2])}}}return this.events.unbind(target,name,func)},fire:function(target,name,evt){return this.events.fire(target,name,evt)},getContentEditable:function(node){var contentEditable;if(!node||node.nodeType!=1){return null}contentEditable=node.getAttribute("data-mce-contenteditable");if(contentEditable&&contentEditable!=="inherit"){return contentEditable}return node.contentEditable!=="inherit"?node.contentEditable:null},getContentEditableParent:function(node){var root=this.getRoot(),state=null;for(;node&&node!==root;node=node.parentNode){state=this.getContentEditable(node);if(state!==null){break}}return state},destroy:function(){var self=this;if(self.boundEvents){var i=self.boundEvents.length;while(i--){var item=self.boundEvents[i];this.events.unbind(item[0],item[1],item[2])}self.boundEvents=null}if(Sizzle.setDocument){Sizzle.setDocument()}self.win=self.doc=self.root=self.events=self.frag=null},isChildOf:function(node,parent){while(node){if(parent===node){return true}node=node.parentNode}return false},dumpRng:function(r){return"startContainer: "+r.startContainer.nodeName+", startOffset: "+r.startOffset+", endContainer: "+r.endContainer.nodeName+", endOffset: "+r.endOffset},_findSib:function(node,selector,name){var self=this,func=selector;if(node){if(typeof func=="string"){func=function(node){return self.is(node,selector)}}for(node=node[name];node;node=node[name]){if(func(node)){return node}}}return null}};DOMUtils.DOM=new DOMUtils(document);DOMUtils.nodeIndex=nodeIndex;return DOMUtils});define("tinymce.core.dom.ScriptLoader",["global!document","tinymce.core.dom.DOMUtils","tinymce.core.util.Tools"],function(document,DOMUtils,Tools){var DOM=DOMUtils.DOM;var each=Tools.each,grep=Tools.grep;var isFunction=function(f){return typeof f==="function"};var ScriptLoader=function(){var QUEUED=0,LOADING=1,LOADED=2,FAILED=3,states={},queue=[],scriptLoadedCallbacks={},queueLoadedCallbacks=[],loading=0,undef;var loadScript=function(url,success,failure){var dom=DOM,elm,id;var done=function(){dom.remove(id);if(elm){elm.onreadystatechange=elm.onload=elm=null}success()};var error=function(){if(isFunction(failure)){failure()}else{if(typeof console!=="undefined"&&console.log){console.log("Failed to load script: "+url)}}};id=dom.uniqueId();elm=document.createElement("script");elm.id=id;elm.type="text/javascript";elm.src=Tools._addCacheSuffix(url);if("onreadystatechange"in elm){elm.onreadystatechange=function(){if(/loaded|complete/.test(elm.readyState)){done()}}}else{elm.onload=done}elm.onerror=error;(document.getElementsByTagName("head")[0]||document.body).appendChild(elm)};this.isDone=function(url){return states[url]==LOADED};this.markDone=function(url){states[url]=LOADED};this.add=this.load=function(url,success,scope,failure){var state=states[url];if(state==undef){queue.push(url);states[url]=QUEUED}if(success){if(!scriptLoadedCallbacks[url]){scriptLoadedCallbacks[url]=[]}scriptLoadedCallbacks[url].push({success:success,failure:failure,scope:scope||this})}};this.remove=function(url){delete states[url];delete scriptLoadedCallbacks[url]};this.loadQueue=function(success,scope,failure){this.loadScripts(queue,success,scope,failure)};this.loadScripts=function(scripts,success,scope,failure){var loadScripts,failures=[];var execCallbacks=function(name,url){each(scriptLoadedCallbacks[url],function(callback){if(isFunction(callback[name])){callback[name].call(callback.scope)}});scriptLoadedCallbacks[url]=undef};queueLoadedCallbacks.push({success:success,failure:failure,scope:scope||this});loadScripts=function(){var loadingScripts=grep(scripts);scripts.length=0;each(loadingScripts,function(url){if(states[url]===LOADED){execCallbacks("success",url);return}if(states[url]===FAILED){execCallbacks("failure",url);return}if(states[url]!==LOADING){states[url]=LOADING;loading++;loadScript(url,function(){states[url]=LOADED;loading--;execCallbacks("success",url);loadScripts()},function(){states[url]=FAILED;loading--;failures.push(url);execCallbacks("failure",url);loadScripts()})}});if(!loading){var notifyCallbacks=queueLoadedCallbacks.slice(0);queueLoadedCallbacks.length=0;each(notifyCallbacks,function(callback){if(failures.length===0){if(isFunction(callback.success)){callback.success.call(callback.scope)}}else{if(isFunction(callback.failure)){callback.failure.call(callback.scope,failures)}}})}};loadScripts()}};ScriptLoader.ScriptLoader=new ScriptLoader;return ScriptLoader});define("tinymce.core.AddOnManager",["ephox.katamari.api.Arr","tinymce.core.dom.ScriptLoader","tinymce.core.util.Tools"],function(Arr,ScriptLoader,Tools){var each=Tools.each;var AddOnManager=function(){var self=this;self.items=[];self.urls={};self.lookup={};self._listeners=[]};AddOnManager.prototype={get:function(name){if(this.lookup[name]){return this.lookup[name].instance}return undefined},dependencies:function(name){var result;if(this.lookup[name]){result=this.lookup[name].dependencies}return result||[]},requireLangPack:function(name,languages){var language=AddOnManager.language;if(language&&AddOnManager.languageLoad!==false){if(languages){languages=","+languages+",";if(languages.indexOf(","+language.substr(0,2)+",")!=-1){language=language.substr(0,2)}else if(languages.indexOf(","+language+",")==-1){return}}ScriptLoader.ScriptLoader.add(this.urls[name]+"/langs/"+language+".js")}},add:function(id,addOn,dependencies){this.items.push(addOn);this.lookup[id]={instance:addOn,dependencies:dependencies};var result=Arr.partition(this._listeners,function(listener){return listener.name===id});this._listeners=result.fail;each(result.pass,function(listener){listener.callback()});return addOn},remove:function(name){delete this.urls[name];delete this.lookup[name]},createUrl:function(baseUrl,dep){if(typeof dep==="object"){return dep}return{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}},addComponents:function(pluginName,scripts){var pluginUrl=this.urls[pluginName];each(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+"/"+script)})},load:function(name,addOnUrl,success,scope,failure){var self=this,url=addOnUrl;var loadDependencies=function(){var dependencies=self.dependencies(name);each(dependencies,function(dep){var newUrl=self.createUrl(addOnUrl,dep);self.load(newUrl.resource,newUrl,undefined,undefined)});if(success){if(scope){success.call(scope)}else{success.call(ScriptLoader)}}};if(self.urls[name]){return}if(typeof addOnUrl==="object"){url=addOnUrl.prefix+addOnUrl.resource+addOnUrl.suffix}if(url.indexOf("/")!==0&&url.indexOf("://")==-1){url=AddOnManager.baseURL+"/"+url}self.urls[name]=url.substring(0,url.lastIndexOf("/"));if(self.lookup[name]){loadDependencies()}else{ScriptLoader.ScriptLoader.add(url,loadDependencies,scope,failure)}},waitFor:function(name,callback){if(this.lookup.hasOwnProperty(name)){callback()}else{this._listeners.push({name:name,callback:callback})}}};AddOnManager.PluginManager=new AddOnManager;AddOnManager.ThemeManager=new AddOnManager;return AddOnManager});define("tinymce.core.text.Zwsp",[],function(){var ZWSP="\ufeff";var isZwsp=function(chr){return chr===ZWSP};var trim=function(text){return text.replace(new RegExp(ZWSP,"g"),"")};return{isZwsp:isZwsp,ZWSP:ZWSP,trim:trim}});define("tinymce.core.caret.CaretContainer",["global!document","tinymce.core.dom.NodeType","tinymce.core.text.Zwsp"],function(document,NodeType,Zwsp){var isElement=NodeType.isElement,isText=NodeType.isText;var isCaretContainerBlock=function(node){if(isText(node)){node=node.parentNode}return isElement(node)&&node.hasAttribute("data-mce-caret")};var isCaretContainerInline=function(node){return isText(node)&&Zwsp.isZwsp(node.data)};var isCaretContainer=function(node){return isCaretContainerBlock(node)||isCaretContainerInline(node)};var hasContent=function(node){return node.firstChild!==node.lastChild||!NodeType.isBr(node.firstChild)};var insertInline=function(node,before){var doc,sibling,textNode,parentNode;doc=node.ownerDocument;textNode=doc.createTextNode(Zwsp.ZWSP);parentNode=node.parentNode;if(!before){sibling=node.nextSibling;if(isText(sibling)){if(isCaretContainer(sibling)){return sibling}if(startsWithCaretContainer(sibling)){sibling.splitText(1);return sibling}}if(node.nextSibling){parentNode.insertBefore(textNode,node.nextSibling)}else{parentNode.appendChild(textNode)}}else{sibling=node.previousSibling;if(isText(sibling)){if(isCaretContainer(sibling)){return sibling}if(endsWithCaretContainer(sibling)){return sibling.splitText(sibling.data.length-1)}}parentNode.insertBefore(textNode,node)}return textNode};var prependInline=function(node){if(NodeType.isText(node)){var data=node.data;if(data.length>0&&data.charAt(0)!==Zwsp.ZWSP){node.insertData(0,Zwsp.ZWSP)}return node}else{return null}};var appendInline=function(node){if(NodeType.isText(node)){var data=node.data;if(data.length>0&&data.charAt(data.length-1)!==Zwsp.ZWSP){node.insertData(data.length,Zwsp.ZWSP)}return node}else{return null}};var isBeforeInline=function(pos){return pos&&NodeType.isText(pos.container())&&pos.container().data.charAt(pos.offset())===Zwsp.ZWSP};var isAfterInline=function(pos){return pos&&NodeType.isText(pos.container())&&pos.container().data.charAt(pos.offset()-1)===Zwsp.ZWSP};var createBogusBr=function(){var br=document.createElement("br");br.setAttribute("data-mce-bogus","1");return br};var insertBlock=function(blockName,node,before){var doc,blockNode,parentNode;doc=node.ownerDocument;blockNode=doc.createElement(blockName);blockNode.setAttribute("data-mce-caret",before?"before":"after");blockNode.setAttribute("data-mce-bogus","all");blockNode.appendChild(createBogusBr());parentNode=node.parentNode;if(!before){if(node.nextSibling){parentNode.insertBefore(blockNode,node.nextSibling)}else{parentNode.appendChild(blockNode)}}else{parentNode.insertBefore(blockNode,node)}return blockNode};var startsWithCaretContainer=function(node){return isText(node)&&node.data[0]==Zwsp.ZWSP};var endsWithCaretContainer=function(node){return isText(node)&&node.data[node.data.length-1]==Zwsp.ZWSP};var trimBogusBr=function(elm){var brs=elm.getElementsByTagName("br");var lastBr=brs[brs.length-1];if(NodeType.isBogus(lastBr)){lastBr.parentNode.removeChild(lastBr)}};var showCaretContainerBlock=function(caretContainer){if(caretContainer&&caretContainer.hasAttribute("data-mce-caret")){trimBogusBr(caretContainer);caretContainer.removeAttribute("data-mce-caret");caretContainer.removeAttribute("data-mce-bogus");caretContainer.removeAttribute("style");caretContainer.removeAttribute("_moz_abspos");return caretContainer}return null};return{isCaretContainer:isCaretContainer,isCaretContainerBlock:isCaretContainerBlock,isCaretContainerInline:isCaretContainerInline,showCaretContainerBlock:showCaretContainerBlock,insertInline:insertInline,prependInline:prependInline,appendInline:appendInline,isBeforeInline:isBeforeInline,isAfterInline:isAfterInline,insertBlock:insertBlock,hasContent:hasContent,startsWithCaretContainer:startsWithCaretContainer,endsWithCaretContainer:endsWithCaretContainer}});define("tinymce.core.caret.CaretCandidate",["tinymce.core.dom.NodeType","tinymce.core.util.Arr","tinymce.core.caret.CaretContainer"],function(NodeType,Arr,CaretContainer){var isContentEditableTrue=NodeType.isContentEditableTrue,isContentEditableFalse=NodeType.isContentEditableFalse,isBr=NodeType.isBr,isText=NodeType.isText,isInvalidTextElement=NodeType.matchNodeNames("script style textarea"),isAtomicInline=NodeType.matchNodeNames("img input textarea hr iframe video audio object"),isTable=NodeType.matchNodeNames("table"),isCaretContainer=CaretContainer.isCaretContainer;var isCaretCandidate=function(node){if(isCaretContainer(node)){return false}if(isText(node)){if(isInvalidTextElement(node.parentNode)){return false}return true}return isAtomicInline(node)||isBr(node)||isTable(node)||isContentEditableFalse(node)};var isInEditable=function(node,rootNode){for(node=node.parentNode;node&&node!=rootNode;node=node.parentNode){if(isContentEditableFalse(node)){return false}if(isContentEditableTrue(node)){return true}}return true};var isAtomicContentEditableFalse=function(node){if(!isContentEditableFalse(node)){return false}return Arr.reduce(node.getElementsByTagName("*"),function(result,elm){return result||isContentEditableTrue(elm)},false)!==true};var isAtomic=function(node){return isAtomicInline(node)||isAtomicContentEditableFalse(node)};var isEditableCaretCandidate=function(node,rootNode){return isCaretCandidate(node)&&isInEditable(node,rootNode)};return{isCaretCandidate:isCaretCandidate,isInEditable:isInEditable,isAtomic:isAtomic,isEditableCaretCandidate:isEditableCaretCandidate}});define("tinymce.core.geom.ClientRect",[],function(){var round=Math.round;var clone=function(rect){if(!rect){return{left:0,top:0,bottom:0,right:0,width:0,height:0}}return{left:round(rect.left),top:round(rect.top),bottom:round(rect.bottom),right:round(rect.right),width:round(rect.width),height:round(rect.height)}};var collapse=function(clientRect,toStart){clientRect=clone(clientRect);if(toStart){clientRect.right=clientRect.left}else{clientRect.left=clientRect.left+clientRect.width;clientRect.right=clientRect.left}clientRect.width=0;return clientRect};var isEqual=function(rect1,rect2){return rect1.left===rect2.left&&rect1.top===rect2.top&&rect1.bottom===rect2.bottom&&rect1.right===rect2.right};var isValidOverflow=function(overflowY,clientRect1,clientRect2){return overflowY>=0&&overflowY<=Math.min(clientRect1.height,clientRect2.height)/2};var isAbove=function(clientRect1,clientRect2){if(clientRect1.bottom-clientRect1.height/2<clientRect2.top){return true}if(clientRect1.top>clientRect2.bottom){return false}return isValidOverflow(clientRect2.top-clientRect1.bottom,clientRect1,clientRect2)};var isBelow=function(clientRect1,clientRect2){if(clientRect1.top>clientRect2.bottom){return true}if(clientRect1.bottom<clientRect2.top){return false}return isValidOverflow(clientRect2.bottom-clientRect1.top,clientRect1,clientRect2)};var isLeft=function(clientRect1,clientRect2){return clientRect1.left<clientRect2.left};var isRight=function(clientRect1,clientRect2){return clientRect1.right>clientRect2.right};var compare=function(clientRect1,clientRect2){if(isAbove(clientRect1,clientRect2)){return-1}if(isBelow(clientRect1,clientRect2)){return 1}if(isLeft(clientRect1,clientRect2)){return-1}if(isRight(clientRect1,clientRect2)){return 1}return 0};var containsXY=function(clientRect,clientX,clientY){return clientX>=clientRect.left&&clientX<=clientRect.right&&clientY>=clientRect.top&&clientY<=clientRect.bottom};return{clone:clone,collapse:collapse,isEqual:isEqual,isAbove:isAbove,isBelow:isBelow,isLeft:isLeft,isRight:isRight,compare:compare,containsXY:containsXY}});define("tinymce.core.selection.RangeNodes",[],function(){var getSelectedNode=function(range){var startContainer=range.startContainer,startOffset=range.startOffset;if(startContainer.hasChildNodes()&&range.endOffset==startOffset+1){return startContainer.childNodes[startOffset]}return null};var getNode=function(container,offset){if(container.nodeType===1&&container.hasChildNodes()){if(offset>=container.childNodes.length){offset=container.childNodes.length-1}container=container.childNodes[offset]}return container};return{getSelectedNode:getSelectedNode,getNode:getNode}});define("tinymce.core.text.ExtendingChar",[],function(){var extendingChars=new RegExp("[ÃÄ-ÕØ“É-“á“à-“â÷ë-÷Ω÷ø◊Å-◊Ç◊Ñ-◊Ö◊áÿê-ÿö"+"Ÿã-ŸüŸ∞€ñ-€ú€ü-€§€ß-€®€™-€≠‹ë‹∞-›äﬁ¶-ﬁ∞"+"ﬂ´-ﬂ≥‡†ñ-‡†ô‡†õ-‡†£‡†•-‡†ß‡†©-‡†≠‡°ô-‡°õ‡££-‡§Ç‡§∫‡§º"+"‡•Å-‡•à‡•ç‡•ë-‡•ó‡•¢-‡•£‡¶Å‡¶º‡¶æ‡ßÅ-‡ßÑ‡ßç‡ßó‡ß¢-‡ß£"+"‡®Å-‡®Ç‡®º‡©Å-‡©Ç‡©á-‡©à‡©ã-‡©ç‡©ë‡©∞-‡©±‡©µ‡™Å-‡™Ç‡™º"+"‡´Å-‡´Ö‡´á-‡´à‡´ç‡´¢-‡´£‡¨Å‡¨º‡¨æ‡¨ø‡≠Å-‡≠Ñ‡≠ç‡≠ñ‡≠ó"+"‡≠¢-‡≠£‡ÆÇ‡Ææ‡ØÄ‡Øç‡Øó‡∞Ä‡∞æ-‡±Ä‡±Ü-‡±à‡±ä-‡±ç‡±ï-‡±ñ"+"‡±¢-‡±£‡≤Å‡≤º‡≤ø‡≥Ç‡≥Ü‡≥å-‡≥ç‡≥ï-‡≥ñ‡≥¢-‡≥£‡¥Å‡¥æ‡µÅ-‡µÑ"+"‡µç‡µó‡µ¢-‡µ£‡∑ä‡∑è‡∑í-‡∑î‡∑ñ‡∑ü‡∏±‡∏¥-‡∏∫‡πá-‡πé‡∫±‡∫¥-‡∫π"+"‡∫ª-‡∫º‡ªà-‡ªç‡ºò-‡ºô‡ºµ‡º∑‡ºπ‡Ω±-‡Ωæ‡æÄ-‡æÑ‡æÜ-‡æá‡æç-‡æó"+"‡æô-‡æº‡øÜ·Ä≠-·Ä∞·Ä≤-·Ä∑·Äπ-·Ä∫·ÄΩ-·Äæ·Åò-·Åô·Åû-·Å†·Å±-·Å¥"+"·ÇÇ·ÇÖ-·ÇÜ·Çç·Çù·çù-·çü·úí-·úî·ú≤-·ú¥·ùí-·ùì·ù≤-·ù≥·û¥-·ûµ"+"·û∑-·ûΩ·üÜ·üâ-·üì·üù·†ã-·†ç·¢©·§†-·§¢·§ß-·§®·§≤·§π-·§ª·®ó-·®ò"+"·®õ·©ñ·©ò-·©û·©†·©¢·©•-·©¨·©≥-·©º·©ø·™∞-·™Ω·™æ·¨Ä-·¨É·¨¥"+"·¨∂-·¨∫·¨º·≠Ç·≠´-·≠≥·ÆÄ-·ÆÅ·Æ¢-·Æ•·Æ®-·Æ©·Æ´-·Æ≠·Ø¶·Ø®-·Ø©"+"·Ø≠·ØØ-·Ø±·∞¨-·∞≥·∞∂-·∞∑·≥ê-·≥í·≥î-·≥†·≥¢-·≥®·≥≠·≥¥·≥∏-·≥π"+"·∑Ä-·∑µ·∑º-·∑ø‚Äå-‚Äç‚Éê-‚Éú‚Éù-‚É†‚É°‚É¢-‚É§‚É•-‚É∞‚≥Ø-‚≥±"+"‚µø‚∑†-‚∑ø„Ä™-„Ä≠„ÄÆ-„ÄØ„Çô-„ÇöÍôØÍô∞-Íô≤Íô¥-ÍôΩÍöû-ÍöüÍõ∞-Íõ±"+"Í†ÇÍ†ÜÍ†ãÍ†•-Í†¶Í£ÑÍ£†-Í£±Í§¶-Í§≠Í•á-Í•ëÍ¶Ä-Í¶ÇÍ¶≥Í¶∂-Í¶πÍ¶º"+"Íß•Í®©-Í®ÆÍ®±-Í®≤Í®µ-Í®∂Í©ÉÍ©åÍ©ºÍ™∞Í™≤-Í™¥Í™∑-Í™∏Í™æ-Í™øÍ´Å"+"Í´¨-Í´≠Í´∂ÍØ•ÍØ®ÍØ≠Ô¨ûÔ∏Ä-Ô∏èÔ∏†-Ô∏ØÔæû-Ôæü]");var isExtendingChar=function(ch){return typeof ch=="string"&&ch.charCodeAt(0)>=768&&extendingChars.test(ch)};return{isExtendingChar:isExtendingChar}});define("tinymce.core.util.Fun",[],function(){var slice=[].slice;var constant=function(value){return function(){return value}};var negate=function(predicate){return function(x){return!predicate(x)}};var compose=function(f,g){return function(x){return f(g(x))}};var or=function(){var args=slice.call(arguments);return function(x){for(var i=0;i<args.length;i++){if(args[i](x)){return true}}return false}};var and=function(){var args=slice.call(arguments);return function(x){for(var i=0;i<args.length;i++){if(!args[i](x)){return false}}return true}};var curry=function(fn){var args=slice.call(arguments);if(args.length-1>=fn.length){return fn.apply(this,args.slice(1))}return function(){var tempArgs=args.concat([].slice.call(arguments));return curry.apply(this,tempArgs)}};var noop=function(){};return{constant:constant,negate:negate,and:and,or:or,curry:curry,compose:compose,noop:noop}});define("tinymce.core.caret.CaretPosition",["tinymce.core.caret.CaretCandidate","tinymce.core.dom.DOMUtils","tinymce.core.dom.NodeType","tinymce.core.geom.ClientRect","tinymce.core.selection.RangeNodes","tinymce.core.text.ExtendingChar","tinymce.core.util.Fun"],function(CaretCandidate,DOMUtils,NodeType,ClientRect,RangeNodes,ExtendingChar,Fun){var isElement=NodeType.isElement,isCaretCandidate=CaretCandidate.isCaretCandidate,isBlock=NodeType.matchStyleValues("display","block table"),isFloated=NodeType.matchStyleValues("float","left right"),isValidElementCaretCandidate=Fun.and(isElement,isCaretCandidate,Fun.negate(isFloated)),isNotPre=Fun.negate(NodeType.matchStyleValues("white-space","pre pre-line pre-wrap")),isText=NodeType.isText,isBr=NodeType.isBr,nodeIndex=DOMUtils.nodeIndex,resolveIndex=RangeNodes.getNode;var createRange=function(doc){return"createRange"in doc?doc.createRange():DOMUtils.DOM.createRng()};var isWhiteSpace=function(chr){return chr&&/[\r\n\t ]/.test(chr)};var isHiddenWhiteSpaceRange=function(range){var container=range.startContainer,offset=range.startOffset,text;if(isWhiteSpace(range.toString())&&isNotPre(container.parentNode)){text=container.data;if(isWhiteSpace(text[offset-1])||isWhiteSpace(text[offset+1])){return true}}return false};var getCaretPositionClientRects=function(caretPosition){var clientRects=[],beforeNode,node;var getBrClientRect=function(brNode){var doc=brNode.ownerDocument,rng=createRange(doc),nbsp=doc.createTextNode("¬†"),parentNode=brNode.parentNode,clientRect;parentNode.insertBefore(nbsp,brNode);rng.setStart(nbsp,0);rng.setEnd(nbsp,1);clientRect=ClientRect.clone(rng.getBoundingClientRect());parentNode.removeChild(nbsp);return clientRect};var getBoundingClientRect=function(item){var clientRect,clientRects;clientRects=item.getClientRects();if(clientRects.length>0){clientRect=ClientRect.clone(clientRects[0])}else{clientRect=ClientRect.clone(item.getBoundingClientRect())}if(isBr(item)&&clientRect.left===0){return getBrClientRect(item)}return clientRect};var collapseAndInflateWidth=function(clientRect,toStart){clientRect=ClientRect.collapse(clientRect,toStart);clientRect.width=1;clientRect.right=clientRect.left+1;return clientRect};var addUniqueAndValidRect=function(clientRect){if(clientRect.height===0){return}if(clientRects.length>0){if(ClientRect.isEqual(clientRect,clientRects[clientRects.length-1])){return}}clientRects.push(clientRect)};var addCharacterOffset=function(container,offset){var range=createRange(container.ownerDocument);if(offset<container.data.length){if(ExtendingChar.isExtendingChar(container.data[offset])){return clientRects}if(ExtendingChar.isExtendingChar(container.data[offset-1])){range.setStart(container,offset);range.setEnd(container,offset+1);if(!isHiddenWhiteSpaceRange(range)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),false));return clientRects}}}if(offset>0){range.setStart(container,offset-1);range.setEnd(container,offset);if(!isHiddenWhiteSpaceRange(range)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),false))}}if(offset<container.data.length){range.setStart(container,offset);range.setEnd(container,offset+1);if(!isHiddenWhiteSpaceRange(range)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),true))}}};if(isText(caretPosition.container())){addCharacterOffset(caretPosition.container(),caretPosition.offset());return clientRects}if(isElement(caretPosition.container())){if(caretPosition.isAtEnd()){node=resolveIndex(caretPosition.container(),caretPosition.offset());if(isText(node)){addCharacterOffset(node,node.data.length)}if(isValidElementCaretCandidate(node)&&!isBr(node)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),false))}}else{node=resolveIndex(caretPosition.container(),caretPosition.offset());if(isText(node)){addCharacterOffset(node,0)}if(isValidElementCaretCandidate(node)&&caretPosition.isAtEnd()){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),false));return clientRects}beforeNode=resolveIndex(caretPosition.container(),caretPosition.offset()-1);if(isValidElementCaretCandidate(beforeNode)&&!isBr(beforeNode)){if(isBlock(beforeNode)||isBlock(node)||!isValidElementCaretCandidate(node)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode),false))}}if(isValidElementCaretCandidate(node)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),true))}}}return clientRects};var CaretPosition=function(container,offset,clientRects){var isAtStart=function(){if(isText(container)){return offset===0}return offset===0};var isAtEnd=function(){if(isText(container)){return offset>=container.data.length}return offset>=container.childNodes.length};var toRange=function(){var range;range=createRange(container.ownerDocument);range.setStart(container,offset);range.setEnd(container,offset);return range};var getClientRects=function(){if(!clientRects){clientRects=getCaretPositionClientRects(new CaretPosition(container,offset))}return clientRects};var isVisible=function(){return getClientRects().length>0};var isEqual=function(caretPosition){return caretPosition&&container===caretPosition.container()&&offset===caretPosition.offset()};var getNode=function(before){return resolveIndex(container,before?offset-1:offset)};return{container:Fun.constant(container),offset:Fun.constant(offset),toRange:toRange,getClientRects:getClientRects,isVisible:isVisible,isAtStart:isAtStart,isAtEnd:isAtEnd,isEqual:isEqual,getNode:getNode}};CaretPosition.fromRangeStart=function(range){return new CaretPosition(range.startContainer,range.startOffset)};CaretPosition.fromRangeEnd=function(range){return new CaretPosition(range.endContainer,range.endOffset)};CaretPosition.after=function(node){return new CaretPosition(node.parentNode,nodeIndex(node)+1)};CaretPosition.before=function(node){return new CaretPosition(node.parentNode,nodeIndex(node))};CaretPosition.isAtStart=function(pos){return pos?pos.isAtStart():false};CaretPosition.isAtEnd=function(pos){return pos?pos.isAtEnd():false};CaretPosition.isTextPosition=function(pos){return pos?NodeType.isText(pos.container()):false};return CaretPosition});define("tinymce.core.caret.CaretUtils",["tinymce.core.util.Fun","tinymce.core.dom.TreeWalker","tinymce.core.dom.NodeType","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretCandidate"],function(Fun,TreeWalker,NodeType,CaretPosition,CaretContainer,CaretCandidate){var isContentEditableTrue=NodeType.isContentEditableTrue,isContentEditableFalse=NodeType.isContentEditableFalse,isBlockLike=NodeType.matchStyleValues("display","block table table-cell table-caption list-item"),isCaretContainer=CaretContainer.isCaretContainer,isCaretContainerBlock=CaretContainer.isCaretContainerBlock,curry=Fun.curry,isElement=NodeType.isElement,isCaretCandidate=CaretCandidate.isCaretCandidate;var isForwards=function(direction){return direction>0};var isBackwards=function(direction){return direction<0};var skipCaretContainers=function(walk,shallow){var node;while(node=walk(shallow)){if(!isCaretContainerBlock(node)){return node}}return null};var findNode=function(node,direction,predicateFn,rootNode,shallow){var walker=new TreeWalker(node,rootNode);if(isBackwards(direction)){if(isContentEditableFalse(node)||isCaretContainerBlock(node)){node=skipCaretContainers(walker.prev,true);if(predicateFn(node)){return node}}while(node=skipCaretContainers(walker.prev,shallow)){if(predicateFn(node)){return node}}}if(isForwards(direction)){if(isContentEditableFalse(node)||isCaretContainerBlock(node)){node=skipCaretContainers(walker.next,true);if(predicateFn(node)){return node}}while(node=skipCaretContainers(walker.next,shallow)){if(predicateFn(node)){return node}}}return null};var getEditingHost=function(node,rootNode){for(node=node.parentNode;node&&node!=rootNode;node=node.parentNode){if(isContentEditableTrue(node)){return node}}return rootNode};var getParentBlock=function(node,rootNode){while(node&&node!=rootNode){if(isBlockLike(node)){return node}node=node.parentNode}return null};var isInSameBlock=function(caretPosition1,caretPosition2,rootNode){return getParentBlock(caretPosition1.container(),rootNode)==getParentBlock(caretPosition2.container(),rootNode)};var isInSameEditingHost=function(caretPosition1,caretPosition2,rootNode){return getEditingHost(caretPosition1.container(),rootNode)==getEditingHost(caretPosition2.container(),rootNode)};var getChildNodeAtRelativeOffset=function(relativeOffset,caretPosition){var container,offset;if(!caretPosition){return null}container=caretPosition.container();offset=caretPosition.offset();if(!isElement(container)){return null}return container.childNodes[offset+relativeOffset]};var beforeAfter=function(before,node){var range=node.ownerDocument.createRange();if(before){range.setStartBefore(node);range.setEndBefore(node)}else{range.setStartAfter(node);range.setEndAfter(node)}return range};var isNodesInSameBlock=function(rootNode,node1,node2){return getParentBlock(node1,rootNode)==getParentBlock(node2,rootNode)};var lean=function(left,rootNode,node){var sibling,siblingName;if(left){siblingName="previousSibling"}else{siblingName="nextSibling"}while(node&&node!=rootNode){sibling=node[siblingName];if(isCaretContainer(sibling)){sibling=sibling[siblingName]}if(isContentEditableFalse(sibling)){if(isNodesInSameBlock(rootNode,sibling,node)){return sibling}break}if(isCaretCandidate(sibling)){break}node=node.parentNode}return null};var before=curry(beforeAfter,true);var after=curry(beforeAfter,false);var normalizeRange=function(direction,rootNode,range){var node,container,offset,location;var leanLeft=curry(lean,true,rootNode);var leanRight=curry(lean,false,rootNode);container=range.startContainer;offset=range.startOffset;if(CaretContainer.isCaretContainerBlock(container)){if(!isElement(container)){container=container.parentNode}location=container.getAttribute("data-mce-caret");if(location=="before"){node=container.nextSibling;if(isContentEditableFalse(node)){return before(node)}}if(location=="after"){node=container.previousSibling;if(isContentEditableFalse(node)){return after(node)}}}if(!range.collapsed){return range}if(NodeType.isText(container)){if(isCaretContainer(container)){if(direction===1){node=leanRight(container);if(node){return before(node)}node=leanLeft(container);if(node){return after(node)}}if(direction===-1){node=leanLeft(container);if(node){return after(node)}node=leanRight(container);if(node){return before(node)}}return range}if(CaretContainer.endsWithCaretContainer(container)&&offset>=container.data.length-1){if(direction===1){node=leanRight(container);if(node){return before(node)}}return range}if(CaretContainer.startsWithCaretContainer(container)&&offset<=1){if(direction===-1){node=leanLeft(container);if(node){return after(node)}}return range}if(offset===container.data.length){node=leanRight(container);if(node){return before(node)}return range}if(offset===0){node=leanLeft(container);if(node){return after(node)}return range}}return range};var isNextToContentEditableFalse=function(relativeOffset,caretPosition){return isContentEditableFalse(getChildNodeAtRelativeOffset(relativeOffset,caretPosition))};return{isForwards:isForwards,isBackwards:isBackwards,findNode:findNode,getEditingHost:getEditingHost,getParentBlock:getParentBlock,isInSameBlock:isInSameBlock,isInSameEditingHost:isInSameEditingHost,isBeforeContentEditableFalse:curry(isNextToContentEditableFalse,0),isAfterContentEditableFalse:curry(isNextToContentEditableFalse,-1),normalizeRange:normalizeRange}});define("tinymce.core.caret.CaretWalker",["tinymce.core.dom.NodeType","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.util.Arr","tinymce.core.util.Fun"],function(NodeType,CaretCandidate,CaretPosition,CaretUtils,Arr,Fun){var isContentEditableFalse=NodeType.isContentEditableFalse,isText=NodeType.isText,isElement=NodeType.isElement,isBr=NodeType.isBr,isForwards=CaretUtils.isForwards,isBackwards=CaretUtils.isBackwards,isCaretCandidate=CaretCandidate.isCaretCandidate,isAtomic=CaretCandidate.isAtomic,isEditableCaretCandidate=CaretCandidate.isEditableCaretCandidate;var getParents=function(node,rootNode){var parents=[];while(node&&node!=rootNode){parents.push(node);node=node.parentNode}return parents};var nodeAtIndex=function(container,offset){if(container.hasChildNodes()&&offset<container.childNodes.length){return container.childNodes[offset]}return null};var getCaretCandidatePosition=function(direction,node){if(isForwards(direction)){if(isCaretCandidate(node.previousSibling)&&!isText(node.previousSibling)){return CaretPosition.before(node)}if(isText(node)){return CaretPosition(node,0)}}if(isBackwards(direction)){if(isCaretCandidate(node.nextSibling)&&!isText(node.nextSibling)){return CaretPosition.after(node)}if(isText(node)){return CaretPosition(node,node.data.length)}}if(isBackwards(direction)){if(isBr(node)){return CaretPosition.before(node)}return CaretPosition.after(node)}return CaretPosition.before(node)};var isBrBeforeBlock=function(node,rootNode){var next;if(!NodeType.isBr(node)){return false}next=findCaretPosition(1,CaretPosition.after(node),rootNode);if(!next){return false}return!CaretUtils.isInSameBlock(CaretPosition.before(node),CaretPosition.before(next),rootNode)};var findCaretPosition=function(direction,startCaretPosition,rootNode){var container,offset,node,nextNode,innerNode,rootContentEditableFalseElm,caretPosition;if(!isElement(rootNode)||!startCaretPosition){return null}if(startCaretPosition.isEqual(CaretPosition.after(rootNode))&&rootNode.lastChild){caretPosition=CaretPosition.after(rootNode.lastChild);if(isBackwards(direction)&&isCaretCandidate(rootNode.lastChild)&&isElement(rootNode.lastChild)){return isBr(rootNode.lastChild)?CaretPosition.before(rootNode.lastChild):caretPosition}}else{caretPosition=startCaretPosition}container=caretPosition.container();offset=caretPosition.offset();if(isText(container)){if(isBackwards(direction)&&offset>0){return CaretPosition(container,--offset)}if(isForwards(direction)&&offset<container.length){return CaretPosition(container,++offset)}node=container}else{if(isBackwards(direction)&&offset>0){nextNode=nodeAtIndex(container,offset-1);if(isCaretCandidate(nextNode)){if(!isAtomic(nextNode)){innerNode=CaretUtils.findNode(nextNode,direction,isEditableCaretCandidate,nextNode);if(innerNode){if(isText(innerNode)){return CaretPosition(innerNode,innerNode.data.length)}return CaretPosition.after(innerNode)}}if(isText(nextNode)){return CaretPosition(nextNode,nextNode.data.length)}return CaretPosition.before(nextNode)}}if(isForwards(direction)&&offset<container.childNodes.length){nextNode=nodeAtIndex(container,offset);if(isCaretCandidate(nextNode)){if(isBrBeforeBlock(nextNode,rootNode)){return findCaretPosition(direction,CaretPosition.after(nextNode),rootNode)}if(!isAtomic(nextNode)){innerNode=CaretUtils.findNode(nextNode,direction,isEditableCaretCandidate,nextNode);if(innerNode){if(isText(innerNode)){return CaretPosition(innerNode,0)}return CaretPosition.before(innerNode)}}if(isText(nextNode)){return CaretPosition(nextNode,0)}return CaretPosition.after(nextNode)}}node=caretPosition.getNode()}if(isForwards(direction)&&caretPosition.isAtEnd()||isBackwards(direction)&&caretPosition.isAtStart()){node=CaretUtils.findNode(node,direction,Fun.constant(true),rootNode,true);if(isEditableCaretCandidate(node)){return getCaretCandidatePosition(direction,node)}}nextNode=CaretUtils.findNode(node,direction,isEditableCaretCandidate,rootNode);rootContentEditableFalseElm=Arr.last(Arr.filter(getParents(container,rootNode),isContentEditableFalse));if(rootContentEditableFalseElm&&(!nextNode||!rootContentEditableFalseElm.contains(nextNode))){if(isForwards(direction)){caretPosition=CaretPosition.after(rootContentEditableFalseElm)}else{caretPosition=CaretPosition.before(rootContentEditableFalseElm)}return caretPosition}if(nextNode){return getCaretCandidatePosition(direction,nextNode)}return null};return function(rootNode){return{next:function(caretPosition){return findCaretPosition(1,caretPosition,rootNode)},prev:function(caretPosition){return findCaretPosition(-1,caretPosition,rootNode)}}}});define("tinymce.core.InsertList",["tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretWalker","tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(CaretPosition,CaretWalker,NodeType,Tools){var hasOnlyOneChild=function(node){return node.firstChild&&node.firstChild===node.lastChild};var isPaddingNode=function(node){return node.name==="br"||node.value==="¬†"};var isPaddedEmptyBlock=function(schema,node){var blockElements=schema.getBlockElements();return blockElements[node.name]&&hasOnlyOneChild(node)&&isPaddingNode(node.firstChild)};var isEmptyFragmentElement=function(schema,node){var nonEmptyElements=schema.getNonEmptyElements();return node&&(node.isEmpty(nonEmptyElements)||isPaddedEmptyBlock(schema,node))};var isListFragment=function(schema,fragment){var firstChild=fragment.firstChild;var lastChild=fragment.lastChild;if(firstChild&&firstChild.name==="meta"){firstChild=firstChild.next}if(lastChild&&lastChild.attr("id")==="mce_marker"){lastChild=lastChild.prev}if(isEmptyFragmentElement(schema,lastChild)){lastChild=lastChild.prev}if(!firstChild||firstChild!==lastChild){return false}return firstChild.name==="ul"||firstChild.name==="ol"};var cleanupDomFragment=function(domFragment){var firstChild=domFragment.firstChild;var lastChild=domFragment.lastChild;if(firstChild&&firstChild.nodeName==="META"){firstChild.parentNode.removeChild(firstChild)}if(lastChild&&lastChild.id==="mce_marker"){lastChild.parentNode.removeChild(lastChild)}return domFragment};var toDomFragment=function(dom,serializer,fragment){var html=serializer.serialize(fragment);var domFragment=dom.createFragment(html);return cleanupDomFragment(domFragment)};var listItems=function(elm){return Tools.grep(elm.childNodes,function(child){return child.nodeName==="LI"})};var isPadding=function(node){return node.data==="¬†"||NodeType.isBr(node)};var isListItemPadded=function(node){return node&&node.firstChild&&node.firstChild===node.lastChild&&isPadding(node.firstChild)};var isEmptyOrPadded=function(elm){return!elm.firstChild||isListItemPadded(elm)};var trimListItems=function(elms){return elms.length>0&&isEmptyOrPadded(elms[elms.length-1])?elms.slice(0,-1):elms};var getParentLi=function(dom,node){var parentBlock=dom.getParent(node,dom.isBlock);return parentBlock&&parentBlock.nodeName==="LI"?parentBlock:null};var isParentBlockLi=function(dom,node){return!!getParentLi(dom,node)};var getSplit=function(parentNode,rng){var beforeRng=rng.cloneRange();var afterRng=rng.cloneRange();beforeRng.setStartBefore(parentNode);afterRng.setEndAfter(parentNode);return[beforeRng.cloneContents(),afterRng.cloneContents()]};var findFirstIn=function(node,rootNode){var caretPos=CaretPosition.before(node);var caretWalker=new CaretWalker(rootNode);var newCaretPos=caretWalker.next(caretPos);return newCaretPos?newCaretPos.toRange():null};var findLastOf=function(node,rootNode){var caretPos=CaretPosition.after(node);var caretWalker=new CaretWalker(rootNode);var newCaretPos=caretWalker.prev(caretPos);return newCaretPos?newCaretPos.toRange():null};var insertMiddle=function(target,elms,rootNode,rng){var parts=getSplit(target,rng);var parentElm=target.parentNode;parentElm.insertBefore(parts[0],target);Tools.each(elms,function(li){parentElm.insertBefore(li,target)});parentElm.insertBefore(parts[1],target);parentElm.removeChild(target);return findLastOf(elms[elms.length-1],rootNode)};var insertBefore=function(target,elms,rootNode){var parentElm=target.parentNode;Tools.each(elms,function(elm){parentElm.insertBefore(elm,target)});return findFirstIn(target,rootNode)};var insertAfter=function(target,elms,rootNode,dom){dom.insertAfter(elms.reverse(),target);return findLastOf(elms[0],rootNode)};var insertAtCaret=function(serializer,dom,rng,fragment){var domFragment=toDomFragment(dom,serializer,fragment);var liTarget=getParentLi(dom,rng.startContainer);var liElms=trimListItems(listItems(domFragment.firstChild));var BEGINNING=1,END=2;var rootNode=dom.getRoot();var isAt=function(location){var caretPos=CaretPosition.fromRangeStart(rng);var caretWalker=new CaretWalker(dom.getRoot());var newPos=location===BEGINNING?caretWalker.prev(caretPos):caretWalker.next(caretPos);return newPos?getParentLi(dom,newPos.getNode())!==liTarget:true};if(isAt(BEGINNING)){return insertBefore(liTarget,liElms,rootNode)}else if(isAt(END)){return insertAfter(liTarget,liElms,rootNode,dom)}return insertMiddle(liTarget,liElms,rootNode,rng)};return{isListFragment:isListFragment,insertAtCaret:insertAtCaret,isParentBlockLi:isParentBlockLi,trimListItems:trimListItems,listItems:listItems}});define("tinymce.core.caret.CaretBookmark",["tinymce.core.dom.NodeType","tinymce.core.dom.DOMUtils","tinymce.core.util.Fun","tinymce.core.util.Arr","tinymce.core.caret.CaretPosition"],function(NodeType,DomUtils,Fun,Arr,CaretPosition){var isText=NodeType.isText,isBogus=NodeType.isBogus,nodeIndex=DomUtils.nodeIndex;var normalizedParent=function(node){var parentNode=node.parentNode;if(isBogus(parentNode)){return normalizedParent(parentNode)}return parentNode};var getChildNodes=function(node){if(!node){return[]}return Arr.reduce(node.childNodes,function(result,node){if(isBogus(node)&&node.nodeName!="BR"){result=result.concat(getChildNodes(node))}else{result.push(node)}return result},[])};var normalizedTextOffset=function(textNode,offset){while(textNode=textNode.previousSibling){if(!isText(textNode)){break}offset+=textNode.data.length}return offset};var equal=function(targetValue){return function(value){return targetValue===value}};var normalizedNodeIndex=function(node){var nodes,index,numTextFragments;nodes=getChildNodes(normalizedParent(node));index=Arr.findIndex(nodes,equal(node),node);nodes=nodes.slice(0,index+1);numTextFragments=Arr.reduce(nodes,function(result,node,i){if(isText(node)&&isText(nodes[i-1])){result++}return result},0);nodes=Arr.filter(nodes,NodeType.matchNodeNames(node.nodeName));index=Arr.findIndex(nodes,equal(node),node);return index-numTextFragments};var createPathItem=function(node){var name;if(isText(node)){name="text()"}else{name=node.nodeName.toLowerCase()}return name+"["+normalizedNodeIndex(node)+"]"};var parentsUntil=function(rootNode,node,predicate){var parents=[];for(node=node.parentNode;node!=rootNode;node=node.parentNode){if(predicate&&predicate(node)){break}parents.push(node)}return parents};var create=function(rootNode,caretPosition){var container,offset,path=[],outputOffset,childNodes,parents;container=caretPosition.container();offset=caretPosition.offset();if(isText(container)){outputOffset=normalizedTextOffset(container,offset)}else{childNodes=container.childNodes;if(offset>=childNodes.length){outputOffset="after";offset=childNodes.length-1}else{outputOffset="before"}container=childNodes[offset]}path.push(createPathItem(container));parents=parentsUntil(rootNode,container);parents=Arr.filter(parents,Fun.negate(NodeType.isBogus));path=path.concat(Arr.map(parents,function(node){return createPathItem(node)}));return path.reverse().join("/")+","+outputOffset};var resolvePathItem=function(node,name,index){var nodes=getChildNodes(node);nodes=Arr.filter(nodes,function(node,index){return!isText(node)||!isText(nodes[index-1])});nodes=Arr.filter(nodes,NodeType.matchNodeNames(name));return nodes[index]};var findTextPosition=function(container,offset){var node=container,targetOffset=0,dataLen;while(isText(node)){dataLen=node.data.length;if(offset>=targetOffset&&offset<=targetOffset+dataLen){container=node;offset=offset-targetOffset;break}if(!isText(node.nextSibling)){container=node;offset=dataLen;break}targetOffset+=dataLen;node=node.nextSibling}if(offset>container.data.length){offset=container.data.length}return new CaretPosition(container,offset)};var resolve=function(rootNode,path){var parts,container,offset;if(!path){return null}parts=path.split(",");path=parts[0].split("/");offset=parts.length>1?parts[1]:"before";container=Arr.reduce(path,function(result,value){value=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(value);if(!value){return null}if(value[1]==="text()"){value[1]="#text"}return resolvePathItem(result,value[1],parseInt(value[2],10))},rootNode);if(!container){return null}if(!isText(container)){if(offset==="after"){offset=nodeIndex(container)+1}else{offset=nodeIndex(container)}return new CaretPosition(container.parentNode,offset)}return findTextPosition(container,parseInt(offset,10))};return{create:create,resolve:resolve}});define("tinymce.core.dom.GetBookmark",["ephox.katamari.api.Fun","tinymce.core.caret.CaretBookmark","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.selection.RangeNodes","tinymce.core.text.Zwsp","tinymce.core.util.Tools"],function(Fun,CaretBookmark,CaretContainer,CaretPosition,NodeType,RangeNodes,Zwsp,Tools){var isContentEditableFalse=NodeType.isContentEditableFalse;var getNormalizedTextOffset=function(trim,container,offset){var node,trimmedOffset;trimmedOffset=trim(container.data.slice(0,offset)).length;for(node=container.previousSibling;node&&NodeType.isText(node);node=node.previousSibling){trimmedOffset+=trim(node.data).length}return trimmedOffset};var getPoint=function(dom,trim,normalized,rng,start){var container=rng[start?"startContainer":"endContainer"];var offset=rng[start?"startOffset":"endOffset"],point=[],childNodes,after=0;var root=dom.getRoot();if(NodeType.isText(container)){point.push(normalized?getNormalizedTextOffset(trim,container,offset):offset)}else{childNodes=container.childNodes;if(offset>=childNodes.length&&childNodes.length){after=1;offset=Math.max(0,childNodes.length-1)}point.push(dom.nodeIndex(childNodes[offset],normalized)+after)}for(;container&&container!==root;container=container.parentNode){point.push(dom.nodeIndex(container,normalized))}return point};var getLocation=function(trim,selection,normalized,rng){var dom=selection.dom,bookmark={};bookmark.start=getPoint(dom,trim,normalized,rng,true);if(!selection.isCollapsed()){bookmark.end=getPoint(dom,trim,normalized,rng,false)}return bookmark};var trimEmptyTextNode=function(node){if(NodeType.isText(node)&&node.data.length===0){node.parentNode.removeChild(node)}};var findIndex=function(dom,name,element){var count=0;Tools.each(dom.select(name),function(node){if(node.getAttribute("data-mce-bogus")==="all"){return}if(node===element){return false}count++});return count};var moveEndPoint=function(rng,start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"];offset=rng[prefix+"Offset"];if(NodeType.isElement(container)&&container.nodeName==="TR"){childNodes=container.childNodes;container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)];if(container){offset=start?0:container.childNodes.length;rng["set"+(start?"Start":"End")](container,offset)}}};var normalizeTableCellSelection=function(rng){moveEndPoint(rng,true);moveEndPoint(rng,false);return rng};var findSibling=function(node,offset){var sibling;if(NodeType.isElement(node)){node=RangeNodes.getNode(node,offset);if(isContentEditableFalse(node)){return node}}if(CaretContainer.isCaretContainer(node)){if(NodeType.isText(node)&&CaretContainer.isCaretContainerBlock(node)){node=node.parentNode}sibling=node.previousSibling;if(isContentEditableFalse(sibling)){return sibling}sibling=node.nextSibling;if(isContentEditableFalse(sibling)){return sibling}}};var findAdjacentContentEditableFalseElm=function(rng){return findSibling(rng.startContainer,rng.startOffset)||findSibling(rng.endContainer,rng.endOffset)};var getOffsetBookmark=function(trim,normalized,selection){var element=selection.getNode();var name=element?element.nodeName:null;var rng=selection.getRng();if(isContentEditableFalse(element)||name==="IMG"){return{name:name,index:findIndex(selection.dom,name,element)}}element=findAdjacentContentEditableFalseElm(rng);if(element){name=element.tagName;return{name:name,index:findIndex(selection.dom,name,element)}}return getLocation(trim,selection,normalized,rng)};var getCaretBookmark=function(selection){var rng=selection.getRng();return{start:CaretBookmark.create(selection.dom.getRoot(),CaretPosition.fromRangeStart(rng)),end:CaretBookmark.create(selection.dom.getRoot(),CaretPosition.fromRangeEnd(rng))}};var getRangeBookmark=function(selection){return{rng:selection.getRng()}};var getPersistentBookmark=function(selection){var dom=selection.dom;var rng=selection.getRng();var id=dom.uniqueId();var collapsed=selection.isCollapsed();var styles="overflow:hidden;line-height:0px";var element=selection.getNode();var name=element.nodeName;var chr="&#xFEFF;";if(name==="IMG"){return{name:name,index:findIndex(dom,name,element)}}var rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(false);var endBookmarkNode=dom.create("span",{"data-mce-type":"bookmark",id:id+"_end",style:styles},chr);rng2.insertNode(endBookmarkNode);trimEmptyTextNode(endBookmarkNode.nextSibling)}rng=normalizeTableCellSelection(rng);rng.collapse(true);var startBookmarkNode=dom.create("span",{"data-mce-type":"bookmark",id:id+"_start",style:styles},chr);rng.insertNode(startBookmarkNode);trimEmptyTextNode(startBookmarkNode.previousSibling);selection.moveToBookmark({id:id,keep:1});return{id:id}};var getBookmark=function(selection,type,normalized){if(type===2){return getOffsetBookmark(Zwsp.trim,normalized,selection)}else if(type===3){return getCaretBookmark(selection)}else if(type){return getRangeBookmark(selection)}else{return getPersistentBookmark(selection)}};return{getBookmark:getBookmark,getUndoBookmark:Fun.curry(getOffsetBookmark,Fun.identity,true)}});define("ephox.katamari.api.Options",["ephox.katamari.api.Option"],function(Option){var cat=function(arr){var r=[];var push=function(x){r.push(x)};for(var i=0;i<arr.length;i++){arr[i].each(push)}return r};var findMap=function(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome()){return r}}return Option.none()};var liftN=function(arr,f){var r=[];for(var i=0;i<arr.length;i++){var x=arr[i];if(x.isSome()){r.push(x.getOrDie())}else{return Option.none()}}return Option.some(f.apply(null,r))};return{cat:cat,findMap:findMap,liftN:liftN}});define("tinymce.core.dom.ResolveBookmark",["ephox.katamari.api.Option","ephox.katamari.api.Options","tinymce.core.Env","tinymce.core.caret.CaretBookmark","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(Option,Options,Env,CaretBookmark,CaretPosition,NodeType,Tools){var addBogus=function(dom,node){if(dom.isBlock(node)&&!node.innerHTML&&!Env.ie){node.innerHTML='<br data-mce-bogus="1" />'}return node};var resolveCaretPositionBookmark=function(dom,bookmark){var rng,pos;rng=dom.createRng();pos=CaretBookmark.resolve(dom.getRoot(),bookmark.start);rng.setStart(pos.container(),pos.offset());pos=CaretBookmark.resolve(dom.getRoot(),bookmark.end);rng.setEnd(pos.container(),pos.offset());return rng};var setEndPoint=function(dom,start,bookmark,rng){var point=bookmark[start?"start":"end"],i,node,offset,children,root=dom.getRoot();if(point){offset=point[0];for(node=root,i=point.length-1;i>=1;i--){children=node.childNodes;if(point[i]>children.length-1){return}node=children[point[i]]}if(node.nodeType===3){offset=Math.min(point[0],node.nodeValue.length)}if(node.nodeType===1){offset=Math.min(point[0],node.childNodes.length)}if(start){rng.setStart(node,offset)}else{rng.setEnd(node,offset)}}return true};var restoreEndPoint=function(dom,suffix,bookmark){var marker=dom.get(bookmark.id+"_"+suffix),node,idx,next,prev,keep=bookmark.keep;var container,offset;if(marker){node=marker.parentNode;if(suffix==="start"){if(!keep){idx=dom.nodeIndex(marker)}else{node=marker.firstChild;idx=1}container=node;offset=idx}else{if(!keep){idx=dom.nodeIndex(marker)}else{node=marker.firstChild;idx=1}container=node;offset=idx}if(!keep){prev=marker.previousSibling;next=marker.nextSibling;Tools.each(Tools.grep(marker.childNodes),function(node){if(NodeType.isText(node)){node.nodeValue=node.nodeValue.replace(/\uFEFF/g,"")}});while(marker=dom.get(bookmark.id+"_"+suffix)){dom.remove(marker,1)}if(prev&&next&&prev.nodeType===next.nodeType&&NodeType.isText(prev)&&!Env.opera){idx=prev.nodeValue.length;prev.appendData(next.nodeValue);dom.remove(next);if(suffix==="start"){container=prev;offset=idx}else{container=prev;offset=idx}}}return Option.some(CaretPosition(container,offset))}else{return Option.none()}};var alt=function(o1,o2){return o1.isSome()?o1:o2};var resolvePaths=function(dom,bookmark){var rng=dom.createRng();if(setEndPoint(dom,true,bookmark,rng)&&setEndPoint(dom,false,bookmark,rng)){return Option.some(rng)}else{return Option.none()}};var resolveId=function(dom,bookmark){var startPos=restoreEndPoint(dom,"start",bookmark);var endPos=restoreEndPoint(dom,"end",bookmark);return Options.liftN([startPos,alt(endPos,startPos)],function(spos,epos){var rng=dom.createRng();rng.setStart(addBogus(dom,spos.container()),spos.offset());rng.setEnd(addBogus(dom,epos.container()),epos.offset());return rng})};var resolveIndex=function(dom,bookmark){return Option.from(dom.select(bookmark.name)[bookmark.index]).map(function(elm){var rng=dom.createRng();rng.selectNode(elm);return rng})};var resolve=function(selection,bookmark){var dom=selection.dom;if(bookmark){if(Tools.isArray(bookmark.start)){return resolvePaths(dom,bookmark)}else if(typeof bookmark.start==="string"){return Option.some(resolveCaretPositionBookmark(dom,bookmark))}else if(bookmark.id){return resolveId(dom,bookmark)}else if(bookmark.name){return resolveIndex(dom,bookmark)}else if(bookmark.rng){return Option.some(bookmark.rng)}}return Option.none()};return{resolve:resolve}});define("tinymce.core.dom.Bookmarks",["tinymce.core.dom.GetBookmark","tinymce.core.dom.ResolveBookmark"],function(GetBookmark,ResolveBookmark){var getBookmark=function(selection,type,normalized){return GetBookmark.getBookmark(selection,type,normalized)};var moveToBookmark=function(selection,bookmark){ResolveBookmark.resolve(selection,bookmark).each(function(rng){selection.setRng(rng)})};var isBookmarkNode=function(node){return node&&node.tagName==="SPAN"&&node.getAttribute("data-mce-type")==="bookmark"};return{getBookmark:getBookmark,moveToBookmark:moveToBookmark,isBookmarkNode:isBookmarkNode}});define("tinymce.core.dom.ElementUtils",["tinymce.core.dom.Bookmarks","tinymce.core.util.Tools"],function(Bookmarks,Tools){var each=Tools.each;var ElementUtils=function(dom){this.compare=function(node1,node2){if(node1.nodeName!=node2.nodeName){return false}var getAttribs=function(node){var attribs={};each(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();if(name.indexOf("_")!==0&&name!=="style"&&name.indexOf("data-")!==0){attribs[name]=dom.getAttrib(node,name)}});return attribs};var compareObjects=function(obj1,obj2){var value,name;for(name in obj1){if(obj1.hasOwnProperty(name)){value=obj2[name];if(typeof value=="undefined"){return false}if(obj1[name]!=value){return false}delete obj2[name]}}for(name in obj2){if(obj2.hasOwnProperty(name)){return false}}return true};if(!compareObjects(getAttribs(node1),getAttribs(node2))){return false}if(!compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style")))){return false}return!Bookmarks.isBookmarkNode(node1)&&!Bookmarks.isBookmarkNode(node2)}};return ElementUtils});define("ephox.sugar.api.dom.Insert",["ephox.sugar.api.search.Traverse"],function(Traverse){var before=function(marker,element){var parent=Traverse.parent(marker);parent.each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})};var after=function(marker,element){var sibling=Traverse.nextSibling(marker);sibling.fold(function(){var parent=Traverse.parent(marker);parent.each(function(v){append(v,element)})},function(v){before(v,element)})};var prepend=function(parent,element){var firstChild=Traverse.firstChild(parent);firstChild.fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})};var append=function(parent,element){parent.dom().appendChild(element.dom())};var appendAt=function(parent,element,index){Traverse.child(parent,index).fold(function(){append(parent,element)},function(v){before(v,element)})};var wrap=function(element,wrapper){before(element,wrapper);append(wrapper,element)};return{before:before,after:after,prepend:prepend,append:append,appendAt:appendAt,wrap:wrap}});define("ephox.sugar.api.dom.InsertAll",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert"],function(Arr,Insert){var before=function(marker,elements){Arr.each(elements,function(x){Insert.before(marker,x)})};var after=function(marker,elements){Arr.each(elements,function(x,i){var e=i===0?marker:elements[i-1];Insert.after(e,x)})};var prepend=function(parent,elements){Arr.each(elements.slice().reverse(),function(x){Insert.prepend(parent,x)})};var append=function(parent,elements){Arr.each(elements,function(x){Insert.append(parent,x)})};return{before:before,after:after,prepend:prepend,append:append}});define("ephox.sugar.api.dom.Remove",["ephox.katamari.api.Arr","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.search.Traverse"],function(Arr,InsertAll,Traverse){var empty=function(element){element.dom().textContent="";Arr.each(Traverse.children(element),function(rogue){remove(rogue)})};var remove=function(element){var dom=element.dom();if(dom.parentNode!==null){dom.parentNode.removeChild(dom)}};var unwrap=function(wrapper){var children=Traverse.children(wrapper);if(children.length>0){InsertAll.before(wrapper,children)}remove(wrapper)};return{empty:empty,remove:remove,unwrap:unwrap}});define("ephox.sugar.impl.NodeValue",["ephox.sand.api.PlatformDetection","ephox.katamari.api.Option","global!Error"],function(PlatformDetection,Option,Error){return function(is,name){var get=function(element){if(!is(element)){throw new Error("Can only get "+name+" value of a "+name+" node")}return getOption(element).getOr("")};var getOptionIE10=function(element){try{return getOptionSafe(element)}catch(e){return Option.none()}};var getOptionSafe=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()};var browser=PlatformDetection.detect().browser;var getOption=browser.isIE()&&browser.version.major===10?getOptionIE10:getOptionSafe;var set=function(element,value){if(!is(element)){throw new Error("Can only set raw "+name+" value of a "+name+" node")}element.dom().nodeValue=value};return{get:get,getOption:getOption,set:set}}});define("ephox.sugar.api.node.Text",["ephox.sugar.api.node.Node","ephox.sugar.impl.NodeValue"],function(Node,NodeValue){var api=NodeValue(Node.isText,"text");var get=function(element){return api.get(element)};var getOption=function(element){return api.getOption(element)};var set=function(element,value){api.set(element,value)};return{get:get,getOption:getOption,set:set}});define("ephox.sugar.api.search.PredicateFilter",["ephox.katamari.api.Arr","ephox.sugar.api.node.Body","ephox.sugar.api.search.Traverse"],function(Arr,Body,Traverse){var all=function(predicate){return descendants(Body.body(),predicate)};var ancestors=function(scope,predicate,isRoot){return Arr.filter(Traverse.parents(scope,isRoot),predicate)};var siblings=function(scope,predicate){return Arr.filter(Traverse.siblings(scope),predicate)};var children=function(scope,predicate){return Arr.filter(Traverse.children(scope),predicate)};var descendants=function(scope,predicate){var result=[];Arr.each(Traverse.children(scope),function(x){if(predicate(x)){result=result.concat([x])}result=result.concat(descendants(x,predicate))});return result};return{all:all,ancestors:ancestors,siblings:siblings,children:children,descendants:descendants}});define("ephox.sugar.api.search.SelectorFilter",["ephox.sugar.api.search.PredicateFilter","ephox.sugar.api.search.Selectors"],function(PredicateFilter,Selectors){var all=function(selector){return Selectors.all(selector)};var ancestors=function(scope,selector,isRoot){return PredicateFilter.ancestors(scope,function(e){return Selectors.is(e,selector)},isRoot)};var siblings=function(scope,selector){return PredicateFilter.siblings(scope,function(e){return Selectors.is(e,selector)})};var children=function(scope,selector){return PredicateFilter.children(scope,function(e){return Selectors.is(e,selector)})};var descendants=function(scope,selector){return Selectors.all(selector,scope)};return{all:all,ancestors:ancestors,siblings:siblings,children:children,descendants:descendants}});define("tinymce.core.dom.PaddingBr",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.Traverse","tinymce.core.dom.ElementType"],function(Arr,Insert,Remove,Element,Node,Text,SelectorFilter,Traverse,ElementType){var getLastChildren=function(elm){var children=[],rawNode=elm.dom();while(rawNode){children.push(Element.fromDom(rawNode));rawNode=rawNode.lastChild}return children};var removeTrailingBr=function(elm){var allBrs=SelectorFilter.descendants(elm,"br");var brs=Arr.filter(getLastChildren(elm).slice(-1),ElementType.isBr);if(allBrs.length===brs.length){Arr.each(brs,Remove.remove)}};var fillWithPaddingBr=function(elm){Remove.empty(elm);Insert.append(elm,Element.fromHtml('<br data-mce-bogus="1">'))};var isPaddingContents=function(elm){return Node.isText(elm)?Text.get(elm)==="¬†":ElementType.isBr(elm)};var isPaddedElement=function(elm){return Arr.filter(Traverse.children(elm),isPaddingContents).length===1};var trimBlockTrailingBr=function(elm){Traverse.lastChild(elm).each(function(lastChild){Traverse.prevSibling(lastChild).each(function(lastChildPrevSibling){if(ElementType.isBlock(elm)&&ElementType.isBr(lastChild)&&ElementType.isBlock(lastChildPrevSibling)){Remove.remove(lastChild)}})})};return{removeTrailingBr:removeTrailingBr,fillWithPaddingBr:fillWithPaddingBr,isPaddedElement:isPaddedElement,trimBlockTrailingBr:trimBlockTrailingBr}});define("tinymce.core.html.Writer",["tinymce.core.html.Entities","tinymce.core.util.Tools"],function(Entities,Tools){var makeMap=Tools.makeMap;return function(settings){var html=[],indent,indentBefore,indentAfter,encode,htmlOutput;settings=settings||{};indent=settings.indent;indentBefore=makeMap(settings.indent_before||"");indentAfter=makeMap(settings.indent_after||"");encode=Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities);htmlOutput=settings.element_format=="html";return{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n"){html.push("\n")}}html.push("<",name);if(attrs){for(i=0,l=attrs.length;i<l;i++){attr=attrs[i];html.push(" ",attr.name,'="',encode(attr.value,true),'"')}}if(!empty||htmlOutput){html[html.length]=">"}else{html[html.length]=" />"}if(empty&&indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n"){html.push("\n")}}},end:function(name){var value;html.push("</",name,">");if(indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n"){html.push("\n")}}},text:function(text,raw){if(text.length>0){html[html.length]=raw?text:encode(text)}},cdata:function(text){html.push("<![CDATA[",text,"]]>")},comment:function(text){html.push("\x3c!--",text,"--\x3e")},pi:function(name,text){if(text){html.push("<?",name," ",encode(text),"?>")}else{html.push("<?",name,"?>")}if(indent){html.push("\n")}},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,"")}}}});define("tinymce.core.html.Serializer",["tinymce.core.html.Writer","tinymce.core.html.Schema"],function(Writer,Schema){return function(settings,schema){var self=this,writer=new Writer(settings);settings=settings||{};settings.validate="validate"in settings?settings.validate:true;self.schema=schema=schema||new Schema;self.writer=writer;self.serialize=function(node){var handlers,validate;validate=settings.validate;handlers={3:function(node){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild){do{walk(node)}while(node=node.next)}}};writer.reset();var walk=function(node){var handler=handlers[node.type],name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule;if(!handler){name=node.name;isEmpty=node.shortEnded;attrs=node.attributes;if(validate&&attrs&&attrs.length>1){sortedAttrs=[];sortedAttrs.map={};elementRule=schema.getElementRule(node.name);if(elementRule){for(i=0,l=elementRule.attributesOrder.length;i<l;i++){attrName=elementRule.attributesOrder[i];if(attrName in attrs.map){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}for(i=0,l=attrs.length;i<l;i++){attrName=attrs[i].name;if(!(attrName in sortedAttrs.map)){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}attrs=sortedAttrs}}writer.start(node.name,attrs,isEmpty);if(!isEmpty){if(node=node.firstChild){do{walk(node)}while(node=node.next)}writer.end(name)}}else{handler(node)}};if(node.type==1&&!settings.inner){walk(node)}else{handlers[11](node)}return writer.getContent()}}});define("tinymce.core.caret.CaretFinder",["ephox.katamari.api.Fun","ephox.katamari.api.Option","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.dom.NodeType"],function(Fun,Option,CaretCandidate,CaretPosition,CaretUtils,CaretWalker,NodeType){var walkToPositionIn=function(forward,rootNode,startNode){var position=forward?CaretPosition.before(startNode):CaretPosition.after(startNode);return fromPosition(forward,rootNode,position)};var afterElement=function(node){return NodeType.isBr(node)?CaretPosition.before(node):CaretPosition.after(node)};var isBeforeOrStart=function(position){if(CaretPosition.isTextPosition(position)){return position.offset()===0}else{return CaretCandidate.isCaretCandidate(position.getNode())}};var isAfterOrEnd=function(position){if(CaretPosition.isTextPosition(position)){return position.offset()===position.container().data.length}else{return CaretCandidate.isCaretCandidate(position.getNode(true))}};var isBeforeAfterSameElement=function(from,to){return!CaretPosition.isTextPosition(from)&&!CaretPosition.isTextPosition(to)&&from.getNode()===to.getNode(true)};var isAtBr=function(position){return!CaretPosition.isTextPosition(position)&&NodeType.isBr(position.getNode())};var shouldSkipPosition=function(forward,from,to){if(forward){return!isBeforeAfterSameElement(from,to)&&!isAtBr(from)&&isAfterOrEnd(from)&&isBeforeOrStart(to)}else{return!isBeforeAfterSameElement(to,from)&&isBeforeOrStart(from)&&isAfterOrEnd(to)}};var fromPosition=function(forward,rootNode,position){var walker=new CaretWalker(rootNode);return Option.from(forward?walker.next(position):walker.prev(position))};var navigate=function(forward,rootNode,from){return fromPosition(forward,rootNode,from).bind(function(to){if(CaretUtils.isInSameBlock(from,to,rootNode)&&shouldSkipPosition(forward,from,to)){return fromPosition(forward,rootNode,to)}else{return Option.some(to)}})};var positionIn=function(forward,element){var startNode=forward?element.firstChild:element.lastChild;if(NodeType.isText(startNode)){return Option.some(new CaretPosition(startNode,forward?0:startNode.data.length))}else if(startNode){if(CaretCandidate.isCaretCandidate(startNode)){return Option.some(forward?CaretPosition.before(startNode):afterElement(startNode))}else{return walkToPositionIn(forward,element,startNode)}}else{return Option.none()}};return{fromPosition:fromPosition,nextPosition:Fun.curry(fromPosition,true),prevPosition:Fun.curry(fromPosition,false),navigate:navigate,positionIn:positionIn,firstPositionIn:Fun.curry(positionIn,true),lastPositionIn:Fun.curry(positionIn,false)}});define("tinymce.core.selection.RangeNormalizer",["global!document","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils"],function(document,CaretFinder,CaretPosition,CaretUtils){var createRange=function(sc,so,ec,eo){var rng=document.createRange();rng.setStart(sc,so);rng.setEnd(ec,eo);return rng};var normalizeBlockSelectionRange=function(rng){var startPos=CaretPosition.fromRangeStart(rng);var endPos=CaretPosition.fromRangeEnd(rng);var rootNode=rng.commonAncestorContainer;return CaretFinder.fromPosition(false,rootNode,endPos).map(function(newEndPos){if(!CaretUtils.isInSameBlock(startPos,endPos,rootNode)&&CaretUtils.isInSameBlock(startPos,newEndPos,rootNode)){return createRange(startPos.container(),startPos.offset(),newEndPos.container(),newEndPos.offset())}else{return rng}}).getOr(rng)};var normalizeBlockSelection=function(rng){return rng.collapsed?rng:normalizeBlockSelectionRange(rng)};var normalize=function(rng){return normalizeBlockSelection(rng)};return{normalize:normalize}});define("tinymce.core.InsertContent",["ephox.katamari.api.Option","ephox.sugar.api.node.Element","tinymce.core.Env","tinymce.core.InsertList","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretWalker","tinymce.core.dom.ElementUtils","tinymce.core.dom.NodeType","tinymce.core.dom.PaddingBr","tinymce.core.html.Serializer","tinymce.core.selection.RangeNormalizer","tinymce.core.util.Tools"],function(Option,Element,Env,InsertList,CaretPosition,CaretWalker,ElementUtils,NodeType,PaddingBr,Serializer,RangeNormalizer,Tools){var isTableCell=NodeType.matchNodeNames("td th");var validInsertion=function(editor,value,parentNode){if(parentNode.getAttribute("data-mce-bogus")==="all"){parentNode.parentNode.insertBefore(editor.dom.createFragment(value),parentNode)}else{var node=parentNode.firstChild;var node2=parentNode.lastChild;if(!node||node===node2&&node.nodeName==="BR"){editor.dom.setHTML(parentNode,value)}else{editor.selection.setContent(value)}}};var trimBrsFromTableCell=function(dom,elm){Option.from(dom.getParent(elm,"td,th")).map(Element.fromDom).each(PaddingBr.trimBlockTrailingBr)};var insertHtmlAtCaret=function(editor,value,details){var parser,serializer,parentNode,rootNode,fragment,args;var marker,rng,node,node2,bookmarkHtml,merge;var textInlineElements=editor.schema.getTextInlineElements();var selection=editor.selection,dom=editor.dom;var trimOrPaddLeftRight=function(html){var rng,container,offset;rng=selection.getRng(true);container=rng.startContainer;offset=rng.startOffset;var hasSiblingText=function(siblingName){return container[siblingName]&&container[siblingName].nodeType==3};if(container.nodeType==3){if(offset>0){html=html.replace(/^&nbsp;/," ")}else if(!hasSiblingText("previousSibling")){html=html.replace(/^ /,"&nbsp;")}if(offset<container.length){html=html.replace(/&nbsp;(<br>|)$/," ")}else if(!hasSiblingText("nextSibling")){html=html.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;")}}return html};var trimNbspAfterDeleteAndPaddValue=function(){var rng,container,offset;rng=selection.getRng(true);container=rng.startContainer;offset=rng.startOffset;if(container.nodeType==3&&rng.collapsed){if(container.data[offset]==="¬†"){container.deleteData(offset,1);if(!/[\u00a0| ]$/.test(value)){value+=" "}}else if(container.data[offset-1]==="¬†"){container.deleteData(offset-1,1);if(!/[\u00a0| ]$/.test(value)){value=" "+value}}}};var reduceInlineTextElements=function(){if(merge){var root=editor.getBody(),elementUtils=new ElementUtils(dom);Tools.each(dom.select("*[data-mce-fragment]"),function(node){for(var testNode=node.parentNode;testNode&&testNode!=root;testNode=testNode.parentNode){if(textInlineElements[node.nodeName.toLowerCase()]&&elementUtils.compare(testNode,node)){dom.remove(node,true)}}})}};var markFragmentElements=function(fragment){var node=fragment;while(node=node.walk()){if(node.type===1){node.attr("data-mce-fragment","1")}}};var umarkFragmentElements=function(elm){Tools.each(elm.getElementsByTagName("*"),function(elm){elm.removeAttribute("data-mce-fragment")})};var isPartOfFragment=function(node){return!!node.getAttribute("data-mce-fragment")};var canHaveChildren=function(node){return node&&!editor.schema.getShortEndedElements()[node.nodeName]};var moveSelectionToMarker=function(marker){var parentEditableFalseElm,parentBlock,nextRng;var getContentEditableFalseParent=function(node){var root=editor.getBody();for(;node&&node!==root;node=node.parentNode){if(editor.dom.getContentEditable(node)==="false"){return node}}return null};if(!marker){return}selection.scrollIntoView(marker);parentEditableFalseElm=getContentEditableFalseParent(marker);if(parentEditableFalseElm){dom.remove(marker);selection.select(parentEditableFalseElm);return}rng=dom.createRng();node=marker.previousSibling;if(node&&node.nodeType==3){rng.setStart(node,node.nodeValue.length);if(!Env.ie){node2=marker.nextSibling;if(node2&&node2.nodeType==3){node.appendData(node2.data);node2.parentNode.removeChild(node2)}}}else{rng.setStartBefore(marker);rng.setEndBefore(marker)}var findNextCaretRng=function(rng){var caretPos=CaretPosition.fromRangeStart(rng);var caretWalker=new CaretWalker(editor.getBody());caretPos=caretWalker.next(caretPos);if(caretPos){return caretPos.toRange()}};parentBlock=dom.getParent(marker,dom.isBlock);dom.remove(marker);if(parentBlock&&dom.isEmpty(parentBlock)){editor.$(parentBlock).empty();rng.setStart(parentBlock,0);rng.setEnd(parentBlock,0);if(!isTableCell(parentBlock)&&!isPartOfFragment(parentBlock)&&(nextRng=findNextCaretRng(rng))){rng=nextRng;dom.remove(parentBlock)}else{dom.add(parentBlock,dom.create("br",{"data-mce-bogus":"1"}))}}selection.setRng(rng)};if(/^ | $/.test(value)){value=trimOrPaddLeftRight(value)}parser=editor.parser;merge=details.merge;serializer=new Serializer({validate:editor.settings.validate},editor.schema);bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>';args={content:value,format:"html",selection:true,paste:details.paste};args=editor.fire("BeforeSetContent",args);if(args.isDefaultPrevented()){editor.fire("SetContent",{content:args.content,format:"html",selection:true,paste:details.paste});return}value=args.content;if(value.indexOf("{$caret}")==-1){value+="{$caret}"}value=value.replace(/\{\$caret\}/,bookmarkHtml);rng=selection.getRng();var caretElement=rng.startContainer||(rng.parentElement?rng.parentElement():null);var body=editor.getBody();if(caretElement===body&&selection.isCollapsed()){if(dom.isBlock(body.firstChild)&&canHaveChildren(body.firstChild)&&dom.isEmpty(body.firstChild)){rng=dom.createRng();rng.setStart(body.firstChild,0);rng.setEnd(body.firstChild,0);selection.setRng(rng)}}if(!selection.isCollapsed()){editor.selection.setRng(RangeNormalizer.normalize(editor.selection.getRng()));editor.getDoc().execCommand("Delete",false,null);trimNbspAfterDeleteAndPaddValue()}parentNode=selection.getNode();var parserArgs={context:parentNode.nodeName.toLowerCase(),data:details.data,insert:true};fragment=parser.parse(value,parserArgs);if(details.paste===true&&InsertList.isListFragment(editor.schema,fragment)&&InsertList.isParentBlockLi(dom,parentNode)){rng=InsertList.insertAtCaret(serializer,dom,editor.selection.getRng(true),fragment);editor.selection.setRng(rng);editor.fire("SetContent",args);return}markFragmentElements(fragment);node=fragment.lastChild;if(node.attr("id")=="mce_marker"){marker=node;for(node=node.prev;node;node=node.walk(true)){if(node.type==3||!dom.isBlock(node.name)){if(editor.schema.isValidChild(node.parent.name,"span")){node.parent.insert(marker,node,node.name==="br")}break}}}editor._selectionOverrides.showBlockCaretContainer(parentNode);if(!parserArgs.invalid){value=serializer.serialize(fragment);validInsertion(editor,value,parentNode)}else{selection.setContent(bookmarkHtml);parentNode=selection.getNode();rootNode=editor.getBody();if(parentNode.nodeType==9){parentNode=node=rootNode}else{node=parentNode}while(node!==rootNode){parentNode=node;node=node.parentNode}value=parentNode==rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode);value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)})));if(parentNode==rootNode){dom.setHTML(rootNode,value)}else{dom.setOuterHTML(parentNode,value)}}reduceInlineTextElements();moveSelectionToMarker(dom.get("mce_marker"));umarkFragmentElements(editor.getBody());trimBrsFromTableCell(editor.dom,editor.selection.getStart());editor.fire("SetContent",args);editor.addVisual()};var processValue=function(value){var details;if(typeof value!=="string"){details=Tools.extend({paste:value.paste,data:{paste:value.paste}},value);return{content:value.content,details:details}}return{content:value,details:{}}};var insertAtCaret=function(editor,value){var result=processValue(value);insertHtmlAtCaret(editor,result.content,result.details)};return{insertAtCaret:insertAtCaret}});define("ephox.sugar.impl.ClosestOrAncestor",["ephox.katamari.api.Type","ephox.katamari.api.Option"],function(Type,Option){return function(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):Type.isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}});define("ephox.sugar.api.search.PredicateFind",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Body","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.impl.ClosestOrAncestor"],function(Type,Arr,Fun,Option,Body,Compare,Element,ClosestOrAncestor){var first=function(predicate){return descendant(Body.body(),predicate)};var ancestor=function(scope,predicate,isRoot){var element=scope.dom();var stop=Type.isFunction(isRoot)?isRoot:Fun.constant(false);while(element.parentNode){element=element.parentNode;var el=Element.fromDom(element);if(predicate(el)){return Option.some(el)}else if(stop(el)){break}}return Option.none()};var closest=function(scope,predicate,isRoot){var is=function(scope){return predicate(scope)};return ClosestOrAncestor(is,ancestor,scope,predicate,isRoot)};var sibling=function(scope,predicate){var element=scope.dom();if(!element.parentNode){return Option.none()}return child(Element.fromDom(element.parentNode),function(x){return!Compare.eq(scope,x)&&predicate(x)})};var child=function(scope,predicate){var result=Arr.find(scope.dom().childNodes,Fun.compose(predicate,Element.fromDom));return result.map(Element.fromDom)};var descendant=function(scope,predicate){var descend=function(element){for(var i=0;i<element.childNodes.length;i++){if(predicate(Element.fromDom(element.childNodes[i]))){return Option.some(Element.fromDom(element.childNodes[i]))}var res=descend(element.childNodes[i]);if(res.isSome()){return res}}return Option.none()};return descend(scope.dom())};return{first:first,ancestor:ancestor,closest:closest,sibling:sibling,child:child,descendant:descendant}});define("tinymce.core.EditorSettings",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.katamari.api.Strings","ephox.katamari.api.Struct","ephox.katamari.api.Type","ephox.sand.api.PlatformDetection","tinymce.core.util.Tools"],function(Arr,Fun,Obj,Option,Strings,Struct,Type,PlatformDetection,Tools){var sectionResult=Struct.immutable("sections","settings");var detection=PlatformDetection.detect();var isTouch=detection.deviceType.isTouch();var mobilePlugins=["lists","autolink","autosave"];var defaultMobileSettings={theme:"mobile"};var normalizePlugins=function(plugins){var pluginNames=Type.isArray(plugins)?plugins.join(" "):plugins;var trimmedPlugins=Arr.map(Type.isString(pluginNames)?pluginNames.split(" "):[],Strings.trim);return Arr.filter(trimmedPlugins,function(item){return item.length>0})};var filterMobilePlugins=function(plugins){return Arr.filter(plugins,Fun.curry(Arr.contains,mobilePlugins))};var extractSections=function(keys,settings){var result=Obj.bifilter(settings,function(value,key){return Arr.contains(keys,key)});return sectionResult(result.t,result.f)};var getSection=function(sectionResult,name,defaults){var sections=sectionResult.sections();var sectionSettings=sections.hasOwnProperty(name)?sections[name]:{};return Tools.extend({},defaults,sectionSettings)};var hasSection=function(sectionResult,name){return sectionResult.sections().hasOwnProperty(name)};var getDefaultSettings=function(id,documentBaseUrl,editor){return{id:id,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:documentBaseUrl,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:"<!DOCTYPE html>",visual:true,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:true,padd_empty_editor:true,render_ui:true,indentation:"30px",inline_styles:true,convert_fonts_to_spans:true,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,"+"tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,"+"tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:editor.convertURL,url_converter_scope:editor,ie7_compat:true}};var getExternalPlugins=function(overrideSettings,settings){var userDefinedExternalPlugins=settings.external_plugins?settings.external_plugins:{};if(overrideSettings&&overrideSettings.external_plugins){return Tools.extend({},overrideSettings.external_plugins,userDefinedExternalPlugins)}else{return userDefinedExternalPlugins}};var combinePlugins=function(forcedPlugins,plugins){return[].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins))};var processPlugins=function(isTouchDevice,sectionResult,defaultOverrideSettings,settings){var forcedPlugins=normalizePlugins(defaultOverrideSettings.forced_plugins);var plugins=normalizePlugins(settings.plugins);var platformPlugins=isTouchDevice&&hasSection(sectionResult,"mobile")?filterMobilePlugins(plugins):plugins;var combinedPlugins=combinePlugins(forcedPlugins,platformPlugins);return Tools.extend(settings,{plugins:combinedPlugins.join(" ")})};var isOnMobile=function(isTouchDevice,sectionResult){var isInline=sectionResult.settings().inline;return isTouchDevice&&hasSection(sectionResult,"mobile")&&!isInline};var combineSettings=function(isTouchDevice,defaultSettings,defaultOverrideSettings,settings){var sectionResult=extractSections(["mobile"],settings);var extendedSettings=Tools.extend(defaultSettings,defaultOverrideSettings,sectionResult.settings(),isOnMobile(isTouchDevice,sectionResult)?getSection(sectionResult,"mobile",defaultMobileSettings):{},{validate:true,content_editable:sectionResult.settings().inline,external_plugins:getExternalPlugins(defaultOverrideSettings,sectionResult.settings())});return processPlugins(isTouchDevice,sectionResult,defaultOverrideSettings,extendedSettings)};var getEditorSettings=function(editor,id,documentBaseUrl,defaultOverrideSettings,settings){var defaultSettings=getDefaultSettings(id,documentBaseUrl,editor);return combineSettings(isTouch,defaultSettings,defaultOverrideSettings,settings)};var get=function(editor,name){return Option.from(editor.settings[name])};var getFiltered=function(predicate,editor,name){return Option.from(editor.settings[name]).filter(predicate)};return{getEditorSettings:getEditorSettings,get:get,getString:Fun.curry(getFiltered,Type.isString),combineSettings:combineSettings}});define("tinymce.core.text.Bidi",[],function(){var strongRtl=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/;var hasStrongRtl=function(text){return strongRtl.test(text)};return{hasStrongRtl:hasStrongRtl}});define("tinymce.core.keyboard.InlineUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.search.Selectors","tinymce.core.EditorSettings","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.dom.DOMUtils","tinymce.core.dom.NodeType","tinymce.core.text.Bidi"],function(Arr,Fun,Option,Element,Selectors,EditorSettings,CaretContainer,CaretPosition,CaretUtils,DOMUtils,NodeType,Bidi){var isInlineTarget=function(editor,elm){var selector=EditorSettings.getString(editor,"inline_boundaries_selector").getOr("a[href],code");return Selectors.is(Element.fromDom(elm),selector)};var isRtl=function(element){return DOMUtils.DOM.getStyle(element,"direction",true)==="rtl"||Bidi.hasStrongRtl(element.textContent)};var findInlineParents=function(isInlineTarget,rootNode,pos){return Arr.filter(DOMUtils.DOM.getParents(pos.container(),"*",rootNode),isInlineTarget)};var findRootInline=function(isInlineTarget,rootNode,pos){var parents=findInlineParents(isInlineTarget,rootNode,pos);return Option.from(parents[parents.length-1])};var hasSameParentBlock=function(rootNode,node1,node2){var block1=CaretUtils.getParentBlock(node1,rootNode);var block2=CaretUtils.getParentBlock(node2,rootNode);return block1&&block1===block2};var isAtZwsp=function(pos){return CaretContainer.isBeforeInline(pos)||CaretContainer.isAfterInline(pos)};var normalizePosition=function(forward,pos){var container=pos.container(),offset=pos.offset();if(forward){if(CaretContainer.isCaretContainerInline(container)){if(NodeType.isText(container.nextSibling)){return new CaretPosition(container.nextSibling,0)}else{return CaretPosition.after(container)}}else{return CaretContainer.isBeforeInline(pos)?new CaretPosition(container,offset+1):pos}}else{if(CaretContainer.isCaretContainerInline(container)){if(NodeType.isText(container.previousSibling)){return new CaretPosition(container.previousSibling,container.previousSibling.data.length)}else{return CaretPosition.before(container)}}else{return CaretContainer.isAfterInline(pos)?new CaretPosition(container,offset-1):pos}}};var normalizeForwards=Fun.curry(normalizePosition,true);var normalizeBackwards=Fun.curry(normalizePosition,false);return{isInlineTarget:isInlineTarget,findRootInline:findRootInline,isRtl:isRtl,isAtZwsp:isAtZwsp,normalizePosition:normalizePosition,normalizeForwards:normalizeForwards,normalizeBackwards:normalizeBackwards,hasSameParentBlock:hasSameParentBlock}});define("tinymce.core.delete.DeleteUtils",["ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.PredicateFind","tinymce.core.caret.CaretFinder","tinymce.core.dom.ElementType","tinymce.core.keyboard.InlineUtils"],function(Option,Options,Compare,Element,PredicateFind,CaretFinder,ElementType,InlineUtils){var isBeforeRoot=function(rootNode){return function(elm){return Compare.eq(rootNode,Element.fromDom(elm.dom().parentNode))}};var getParentBlock=function(rootNode,elm){return Compare.contains(rootNode,elm)?PredicateFind.closest(elm,function(element){return ElementType.isTextBlock(element)||ElementType.isListItem(element)},isBeforeRoot(rootNode)):Option.none()};var placeCaretInEmptyBody=function(editor){var body=editor.getBody();var node=body.firstChild&&editor.dom.isBlock(body.firstChild)?body.firstChild:body;editor.selection.setCursorLocation(node,0)};var paddEmptyBody=function(editor){if(editor.dom.isEmpty(editor.getBody())){editor.setContent("");placeCaretInEmptyBody(editor)}};var willDeleteLastPositionInElement=function(forward,fromPos,elm){return Options.liftN([CaretFinder.firstPositionIn(elm),CaretFinder.lastPositionIn(elm)],function(firstPos,lastPos){var normalizedFirstPos=InlineUtils.normalizePosition(true,firstPos);var normalizedLastPos=InlineUtils.normalizePosition(false,lastPos);var normalizedFromPos=InlineUtils.normalizePosition(false,fromPos);if(forward){return CaretFinder.nextPosition(elm,normalizedFromPos).map(function(nextPos){return nextPos.isEqual(normalizedLastPos)&&fromPos.isEqual(normalizedFirstPos)}).getOr(false)}else{return CaretFinder.prevPosition(elm,normalizedFromPos).map(function(prevPos){return prevPos.isEqual(normalizedFirstPos)&&fromPos.isEqual(normalizedLastPos)}).getOr(false)}}).getOr(true)};return{getParentBlock:getParentBlock,paddEmptyBody:paddEmptyBody,willDeleteLastPositionInElement:willDeleteLastPositionInElement}});define("ephox.sugar.api.search.SelectorFind",["ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Selectors","ephox.sugar.impl.ClosestOrAncestor"],function(PredicateFind,Selectors,ClosestOrAncestor){var first=function(selector){return Selectors.one(selector)};var ancestor=function(scope,selector,isRoot){return PredicateFind.ancestor(scope,function(e){return Selectors.is(e,selector)},isRoot)};var sibling=function(scope,selector){return PredicateFind.sibling(scope,function(e){return Selectors.is(e,selector)})};var child=function(scope,selector){return PredicateFind.child(scope,function(e){return Selectors.is(e,selector)})};var descendant=function(scope,selector){return Selectors.one(selector,scope)};var closest=function(scope,selector,isRoot){return ClosestOrAncestor(Selectors.is,ancestor,scope,selector,isRoot)};return{first:first,ancestor:ancestor,sibling:sibling,child:child,descendant:descendant,closest:closest}});define("ephox.sugar.api.search.SelectorExists",["ephox.sugar.api.search.SelectorFind"],function(SelectorFind){var any=function(selector){return SelectorFind.first(selector).isSome()};var ancestor=function(scope,selector,isRoot){return SelectorFind.ancestor(scope,selector,isRoot).isSome()};var sibling=function(scope,selector){return SelectorFind.sibling(scope,selector).isSome()};var child=function(scope,selector){return SelectorFind.child(scope,selector).isSome()};var descendant=function(scope,selector){return SelectorFind.descendant(scope,selector).isSome()};var closest=function(scope,selector,isRoot){return SelectorFind.closest(scope,selector,isRoot).isSome()};return{any:any,ancestor:ancestor,sibling:sibling,child:child,descendant:descendant,closest:closest}});define("tinymce.core.dom.Empty",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorExists","tinymce.core.caret.CaretCandidate","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker"],function(Fun,Compare,Element,SelectorExists,CaretCandidate,NodeType,TreeWalker){var hasWhitespacePreserveParent=function(rootNode,node){var rootElement=Element.fromDom(rootNode);var startNode=Element.fromDom(node);return SelectorExists.ancestor(startNode,"pre,code",Fun.curry(Compare.eq,rootElement))};var isWhitespace=function(rootNode,node){return NodeType.isText(node)&&/^[ \t\r\n]*$/.test(node.data)&&hasWhitespacePreserveParent(rootNode,node)===false};var isNamedAnchor=function(node){return NodeType.isElement(node)&&node.nodeName==="A"&&node.hasAttribute("name")};var isContent=function(rootNode,node){return CaretCandidate.isCaretCandidate(node)&&isWhitespace(rootNode,node)===false||isNamedAnchor(node)||isBookmark(node)};var isBookmark=NodeType.hasAttribute("data-mce-bookmark");var isBogus=NodeType.hasAttribute("data-mce-bogus");var isBogusAll=NodeType.hasAttributeValue("data-mce-bogus","all");var isEmptyNode=function(targetNode){var walker,node,brCount=0;if(isContent(targetNode,targetNode)){return false}else{node=targetNode.firstChild;if(!node){return true}walker=new TreeWalker(node,targetNode);do{if(isBogusAll(node)){node=walker.next(true);continue}if(isBogus(node)){node=walker.next();continue}if(NodeType.isBr(node)){brCount++;node=walker.next();continue}if(isContent(targetNode,node)){return false}node=walker.next()}while(node);return brCount<=1}};var isEmpty=function(elm){return isEmptyNode(elm.dom())};return{isEmpty:isEmpty}});define("tinymce.core.delete.BlockBoundary",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteUtils","tinymce.core.dom.Empty","tinymce.core.dom.NodeType"],function(Arr,Fun,Option,Options,Struct,Compare,Element,Node,PredicateFind,Traverse,CaretFinder,CaretPosition,DeleteUtils,Empty,NodeType){var BlockPosition=Struct.immutable("block","position");var BlockBoundary=Struct.immutable("from","to");var getBlockPosition=function(rootNode,pos){var rootElm=Element.fromDom(rootNode);var containerElm=Element.fromDom(pos.container());return DeleteUtils.getParentBlock(rootElm,containerElm).map(function(block){return BlockPosition(block,pos)})};var isDifferentBlocks=function(blockBoundary){return Compare.eq(blockBoundary.from().block(),blockBoundary.to().block())===false};var hasSameParent=function(blockBoundary){return Traverse.parent(blockBoundary.from().block()).bind(function(parent1){return Traverse.parent(blockBoundary.to().block()).filter(function(parent2){return Compare.eq(parent1,parent2)})}).isSome()};var isEditable=function(blockBoundary){return NodeType.isContentEditableFalse(blockBoundary.from().block())===false&&NodeType.isContentEditableFalse(blockBoundary.to().block())===false};var skipLastBr=function(rootNode,forward,blockPosition){if(NodeType.isBr(blockPosition.position().getNode())&&Empty.isEmpty(blockPosition.block())===false){return CaretFinder.positionIn(false,blockPosition.block().dom()).bind(function(lastPositionInBlock){if(lastPositionInBlock.isEqual(blockPosition.position())){return CaretFinder.fromPosition(forward,rootNode,lastPositionInBlock).bind(function(to){return getBlockPosition(rootNode,to)})}else{return Option.some(blockPosition)}}).getOr(blockPosition)}else{return blockPosition}};var readFromRange=function(rootNode,forward,rng){var fromBlockPos=getBlockPosition(rootNode,CaretPosition.fromRangeStart(rng));var toBlockPos=fromBlockPos.bind(function(blockPos){return CaretFinder.fromPosition(forward,rootNode,blockPos.position()).bind(function(to){return getBlockPosition(rootNode,to).map(function(blockPos){return skipLastBr(rootNode,forward,blockPos)})})});return Options.liftN([fromBlockPos,toBlockPos],BlockBoundary).filter(function(blockBoundary){return isDifferentBlocks(blockBoundary)&&hasSameParent(blockBoundary)&&isEditable(blockBoundary)})};var read=function(rootNode,forward,rng){return rng.collapsed?readFromRange(rootNode,forward,rng):Option.none()};return{read:read}});define("tinymce.core.dom.Parents",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.Traverse"],function(Fun,Compare,Traverse){var dropLast=function(xs){return xs.slice(0,-1)};var parentsUntil=function(startNode,rootElm,predicate){if(Compare.contains(rootElm,startNode)){return dropLast(Traverse.parents(startNode,function(elm){return predicate(elm)||Compare.eq(elm,rootElm)}))}else{return[]}};var parents=function(startNode,rootElm){return parentsUntil(startNode,rootElm,Fun.constant(false))};var parentsAndSelf=function(startNode,rootElm){return[startNode].concat(parents(startNode,rootElm))};return{parentsUntil:parentsUntil,parents:parents,parentsAndSelf:parentsAndSelf}});define("tinymce.core.delete.MergeBlocks",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.ElementType","tinymce.core.dom.Empty","tinymce.core.dom.NodeType","tinymce.core.dom.PaddingBr","tinymce.core.dom.Parents"],function(Arr,Option,Compare,Insert,Remove,Element,Traverse,CaretFinder,CaretPosition,ElementType,Empty,NodeType,PaddingBr,Parents){var getChildrenUntilBlockBoundary=function(block){var children=Traverse.children(block);return Arr.findIndex(children,ElementType.isBlock).fold(function(){return children},function(index){return children.slice(0,index)})};var extractChildren=function(block){var children=getChildrenUntilBlockBoundary(block);Arr.each(children,function(node){Remove.remove(node)});return children};var trimBr=function(first,block){CaretFinder.positionIn(first,block.dom()).each(function(position){var node=position.getNode();if(NodeType.isBr(node)){Remove.remove(Element.fromDom(node))}})};var removeEmptyRoot=function(rootNode,block){var parents=Parents.parentsAndSelf(block,rootNode);return Arr.find(parents.reverse(),Empty.isEmpty).each(Remove.remove)};var findParentInsertPoint=function(toBlock,block){var parents=Traverse.parents(block,function(elm){return Compare.eq(elm,toBlock)});return Option.from(parents[parents.length-2])};var getInsertionPoint=function(fromBlock,toBlock){if(Compare.contains(toBlock,fromBlock)){return Traverse.parent(fromBlock).bind(function(parent){return Compare.eq(parent,toBlock)?Option.some(fromBlock):findParentInsertPoint(toBlock,fromBlock)})}else{return Option.none()}};var mergeBlockInto=function(rootNode,fromBlock,toBlock){if(Empty.isEmpty(toBlock)){Remove.remove(toBlock);if(Empty.isEmpty(fromBlock)){PaddingBr.fillWithPaddingBr(fromBlock)}return CaretFinder.firstPositionIn(fromBlock.dom())}else{trimBr(true,fromBlock);trimBr(false,toBlock);var children=extractChildren(fromBlock);return getInsertionPoint(fromBlock,toBlock).fold(function(){removeEmptyRoot(rootNode,fromBlock);var position=CaretFinder.lastPositionIn(toBlock.dom());Arr.each(children,function(node){Insert.append(toBlock,node)});return position},function(target){var position=CaretFinder.prevPosition(toBlock.dom(),CaretPosition.before(target.dom()));Arr.each(children,function(node){Insert.before(target,node)});removeEmptyRoot(rootNode,fromBlock);return position})}};var mergeBlocks=function(rootNode,forward,block1,block2){return forward?mergeBlockInto(rootNode,block2,block1):mergeBlockInto(rootNode,block1,block2)};return{mergeBlocks:mergeBlocks}});define("tinymce.core.delete.BlockBoundaryDelete",["ephox.sugar.api.node.Element","tinymce.core.delete.BlockBoundary","tinymce.core.delete.MergeBlocks"],function(Element,BlockBoundary,MergeBlocks){var backspaceDelete=function(editor,forward){var position,rootNode=Element.fromDom(editor.getBody());position=BlockBoundary.read(rootNode.dom(),forward,editor.selection.getRng()).bind(function(blockBoundary){return MergeBlocks.mergeBlocks(rootNode,forward,blockBoundary.from().block(),blockBoundary.to().block())});position.each(function(pos){editor.selection.setRng(pos.toRange())});return position.isSome()};return{backspaceDelete:backspaceDelete}});define("tinymce.core.delete.BlockRangeDelete",["ephox.katamari.api.Fun","ephox.katamari.api.Options","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.PredicateFind","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteUtils","tinymce.core.delete.MergeBlocks","tinymce.core.dom.ElementType"],function(Fun,Options,Compare,Element,PredicateFind,CaretFinder,CaretPosition,DeleteUtils,MergeBlocks,ElementType){var deleteRangeMergeBlocks=function(rootNode,selection){var rng=selection.getRng();return Options.liftN([DeleteUtils.getParentBlock(rootNode,Element.fromDom(rng.startContainer)),DeleteUtils.getParentBlock(rootNode,Element.fromDom(rng.endContainer))],function(block1,block2){if(Compare.eq(block1,block2)===false){rng.deleteContents();MergeBlocks.mergeBlocks(rootNode,true,block1,block2).each(function(pos){selection.setRng(pos.toRange())});return true}else{return false}}).getOr(false)};var isRawNodeInTable=function(root,rawNode){var node=Element.fromDom(rawNode);var isRoot=Fun.curry(Compare.eq,root);return PredicateFind.ancestor(node,ElementType.isTableCell,isRoot).isSome()};var isSelectionInTable=function(root,rng){return isRawNodeInTable(root,rng.startContainer)||isRawNodeInTable(root,rng.endContainer)};var isEverythingSelected=function(root,rng){var noPrevious=CaretFinder.prevPosition(root.dom(),CaretPosition.fromRangeStart(rng)).isNone();var noNext=CaretFinder.nextPosition(root.dom(),CaretPosition.fromRangeEnd(rng)).isNone();return!isSelectionInTable(root,rng)&&noPrevious&&noNext};var emptyEditor=function(editor){editor.setContent("");editor.selection.setCursorLocation();return true};var deleteRange=function(editor){var rootNode=Element.fromDom(editor.getBody());var rng=editor.selection.getRng();return isEverythingSelected(rootNode,rng)?emptyEditor(editor):deleteRangeMergeBlocks(rootNode,editor.selection)};var backspaceDelete=function(editor,forward){return editor.selection.isCollapsed()?false:deleteRange(editor,editor.selection.getRng())};return{backspaceDelete:backspaceDelete}});define("ephox.katamari.api.Adt",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Type","global!Array","global!Error","global!console"],function(Arr,Obj,Type,Array,Error,console){var generate=function(cases){if(!Type.isArray(cases)){throw new Error("cases must be an array")}if(cases.length===0){throw new Error("there must be at least one case")}var constructors=[];var adt={};Arr.each(cases,function(acase,count){var keys=Obj.keys(acase);if(keys.length!==1){throw new Error("one and only one name per case")}var key=keys[0];var value=acase[key];if(adt[key]!==undefined){throw new Error("duplicate key detected:"+key)}else if(key==="cata"){throw new Error("cannot have a case named cata (sorry)")}else if(!Type.isArray(value)){throw new Error("case arguments must be an array")}constructors.push(key);adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length){throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength)}var args=new Array(argLength);for(var i=0;i<args.length;i++){args[i]=arguments[i]}var match=function(branches){var branchKeys=Obj.keys(branches);if(constructors.length!==branchKeys.length){throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","))}var allReqd=Arr.forall(constructors,function(reqKey){return Arr.contains(branchKeys,reqKey)});if(!allReqd){throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "))}return branches[key].apply(null,args)};return{fold:function(){if(arguments.length!==cases.length){throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length)}var target=arguments[count];return target.apply(null,args)},match:match,log:function(label){console.log(label,{constructors:constructors,constructor:key,params:args})}}}});return adt};return{generate:generate}});define("tinymce.core.delete.CefDeleteAction",["ephox.katamari.api.Adt","ephox.katamari.api.Option","ephox.sugar.api.node.Element","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.delete.DeleteUtils","tinymce.core.dom.Empty","tinymce.core.dom.NodeType"],function(Adt,Option,Element,CaretFinder,CaretPosition,CaretUtils,DeleteUtils,Empty,NodeType){var DeleteAction=Adt.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]);var isAtContentEditableBlockCaret=function(forward,from){var elm=from.getNode(forward===false);var caretLocation=forward?"after":"before";return NodeType.isElement(elm)&&elm.getAttribute("data-mce-caret")===caretLocation};var deleteEmptyBlockOrMoveToCef=function(rootNode,forward,from,to){var toCefElm=to.getNode(forward===false);return DeleteUtils.getParentBlock(Element.fromDom(rootNode),Element.fromDom(from.getNode())).map(function(blockElm){return Empty.isEmpty(blockElm)?DeleteAction.remove(blockElm.dom()):DeleteAction.moveToElement(toCefElm)}).orThunk(function(){return Option.some(DeleteAction.moveToElement(toCefElm))})};var findCefPosition=function(rootNode,forward,from){return CaretFinder.fromPosition(forward,rootNode,from).bind(function(to){if(forward&&NodeType.isContentEditableFalse(to.getNode())){return deleteEmptyBlockOrMoveToCef(rootNode,forward,from,to)}else if(forward===false&&NodeType.isContentEditableFalse(to.getNode(true))){return deleteEmptyBlockOrMoveToCef(rootNode,forward,from,to)}else if(forward&&CaretUtils.isAfterContentEditableFalse(from)){return Option.some(DeleteAction.moveToPosition(to))}else if(forward===false&&CaretUtils.isBeforeContentEditableFalse(from)){return Option.some(DeleteAction.moveToPosition(to))}else{return Option.none()}})};var getContentEditableBlockAction=function(forward,elm){if(forward&&NodeType.isContentEditableFalse(elm.nextSibling)){return Option.some(DeleteAction.moveToElement(elm.nextSibling))}else if(forward===false&&NodeType.isContentEditableFalse(elm.previousSibling)){return Option.some(DeleteAction.moveToElement(elm.previousSibling))}else{return Option.none()}};var skipMoveToActionFromInlineCefToContent=function(root,from,deleteAction){return deleteAction.fold(function(elm){return Option.some(DeleteAction.remove(elm))},function(elm){return Option.some(DeleteAction.moveToElement(elm))},function(to){if(CaretUtils.isInSameBlock(from,to,root)){return Option.none()}else{return Option.some(DeleteAction.moveToPosition(to))}})};var getContentEditableAction=function(rootNode,forward,from){if(isAtContentEditableBlockCaret(forward,from)){return getContentEditableBlockAction(forward,from.getNode(forward===false)).fold(function(){return findCefPosition(rootNode,forward,from)},Option.some)}else{return findCefPosition(rootNode,forward,from).bind(function(deleteAction){return skipMoveToActionFromInlineCefToContent(rootNode,from,deleteAction)})}};var read=function(rootNode,forward,rng){var normalizedRange=CaretUtils.normalizeRange(forward?1:-1,rootNode,rng);var from=CaretPosition.fromRangeStart(normalizedRange);if(forward===false&&CaretUtils.isAfterContentEditableFalse(from)){return Option.some(DeleteAction.remove(from.getNode(true)))}else if(forward&&CaretUtils.isBeforeContentEditableFalse(from)){return Option.some(DeleteAction.remove(from.getNode()))}else{return getContentEditableAction(rootNode,forward,from)}};return{read:read}});define("tinymce.core.delete.DeleteElement",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.Empty","tinymce.core.dom.NodeType"],function(Fun,Option,Options,Insert,Remove,Element,Node,PredicateFind,Traverse,CaretCandidate,CaretFinder,CaretPosition,Empty,NodeType){var needsReposition=function(pos,elm){var container=pos.container();var offset=pos.offset();return CaretPosition.isTextPosition(pos)===false&&container===elm.parentNode&&offset>CaretPosition.before(elm).offset()};var reposition=function(elm,pos){return needsReposition(pos,elm)?new CaretPosition(pos.container(),pos.offset()-1):pos};var beforeOrStartOf=function(node){return NodeType.isText(node)?new CaretPosition(node,0):CaretPosition.before(node)};var afterOrEndOf=function(node){return NodeType.isText(node)?new CaretPosition(node,node.data.length):CaretPosition.after(node)};var getPreviousSiblingCaretPosition=function(elm){if(CaretCandidate.isCaretCandidate(elm.previousSibling)){return Option.some(afterOrEndOf(elm.previousSibling))}else{return elm.previousSibling?CaretFinder.lastPositionIn(elm.previousSibling):Option.none()}};var getNextSiblingCaretPosition=function(elm){if(CaretCandidate.isCaretCandidate(elm.nextSibling)){return Option.some(beforeOrStartOf(elm.nextSibling))}else{return elm.nextSibling?CaretFinder.firstPositionIn(elm.nextSibling):Option.none()}};var findCaretPositionBackwardsFromElm=function(rootElement,elm){var startPosition=CaretPosition.before(elm.previousSibling?elm.previousSibling:elm.parentNode);return CaretFinder.prevPosition(rootElement,startPosition).fold(function(){return CaretFinder.nextPosition(rootElement,CaretPosition.after(elm))},Option.some)};var findCaretPositionForwardsFromElm=function(rootElement,elm){return CaretFinder.nextPosition(rootElement,CaretPosition.after(elm)).fold(function(){return CaretFinder.prevPosition(rootElement,CaretPosition.before(elm))},Option.some)};var findCaretPositionBackwards=function(rootElement,elm){return getPreviousSiblingCaretPosition(elm).orThunk(function(){return getNextSiblingCaretPosition(elm)}).orThunk(function(){return findCaretPositionBackwardsFromElm(rootElement,elm)})};var findCaretPositionForward=function(rootElement,elm){return getNextSiblingCaretPosition(elm).orThunk(function(){return getPreviousSiblingCaretPosition(elm)}).orThunk(function(){return findCaretPositionForwardsFromElm(rootElement,elm)})};var findCaretPosition=function(forward,rootElement,elm){return forward?findCaretPositionForward(rootElement,elm):findCaretPositionBackwards(rootElement,elm)};var findCaretPosOutsideElmAfterDelete=function(forward,rootElement,elm){return findCaretPosition(forward,rootElement,elm).map(Fun.curry(reposition,elm))};var setSelection=function(editor,forward,pos){pos.fold(function(){editor.focus()},function(pos){editor.selection.setRng(pos.toRange(),forward)})};var eqRawNode=function(rawNode){return function(elm){return elm.dom()===rawNode}};var isBlock=function(editor,elm){return elm&&editor.schema.getBlockElements().hasOwnProperty(Node.name(elm))};var paddEmptyBlock=function(elm){if(Empty.isEmpty(elm)){var br=Element.fromHtml('<br data-mce-bogus="1">');Remove.empty(elm);Insert.append(elm,br);return Option.some(CaretPosition.before(br.dom()))}else{return Option.none()}};var deleteNormalized=function(elm,afterDeletePosOpt){return Options.liftN([Traverse.prevSibling(elm),Traverse.nextSibling(elm),afterDeletePosOpt],function(prev,next,afterDeletePos){var offset,prevNode=prev.dom(),nextNode=next.dom();if(NodeType.isText(prevNode)&&NodeType.isText(nextNode)){offset=prevNode.data.length;prevNode.appendData(nextNode.data);Remove.remove(next);Remove.remove(elm);if(afterDeletePos.container()===nextNode){return new CaretPosition(prevNode,offset)}else{return afterDeletePos}}else{Remove.remove(elm);return afterDeletePos}}).orThunk(function(){Remove.remove(elm);return afterDeletePosOpt})};var deleteElement=function(editor,forward,elm){var afterDeletePos=findCaretPosOutsideElmAfterDelete(forward,editor.getBody(),elm.dom());var parentBlock=PredicateFind.ancestor(elm,Fun.curry(isBlock,editor),eqRawNode(editor.getBody()));var normalizedAfterDeletePos=deleteNormalized(elm,afterDeletePos);if(editor.dom.isEmpty(editor.getBody())){editor.setContent("");editor.selection.setCursorLocation()}else{parentBlock.bind(paddEmptyBlock).fold(function(){setSelection(editor,forward,normalizedAfterDeletePos)},function(paddPos){setSelection(editor,forward,Option.some(paddPos))})}};return{deleteElement:deleteElement}});define("tinymce.core.delete.CefDelete",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFilter","tinymce.core.caret.CaretPosition","tinymce.core.delete.CefDeleteAction","tinymce.core.delete.DeleteElement","tinymce.core.delete.DeleteUtils","tinymce.core.dom.NodeType"],function(Arr,Remove,Element,SelectorFilter,CaretPosition,CefDeleteAction,DeleteElement,DeleteUtils,NodeType){var deleteElement=function(editor,forward){return function(element){editor._selectionOverrides.hideFakeCaret();DeleteElement.deleteElement(editor,forward,Element.fromDom(element));return true}};var moveToElement=function(editor,forward){return function(element){var pos=forward?CaretPosition.before(element):CaretPosition.after(element);editor.selection.setRng(pos.toRange());return true}};var moveToPosition=function(editor){return function(pos){editor.selection.setRng(pos.toRange());return true}};var backspaceDeleteCaret=function(editor,forward){var result=CefDeleteAction.read(editor.getBody(),forward,editor.selection.getRng()).map(function(deleteAction){return deleteAction.fold(deleteElement(editor,forward),moveToElement(editor,forward),moveToPosition(editor))});return result.getOr(false)};var deleteOffscreenSelection=function(rootElement){Arr.each(SelectorFilter.descendants(rootElement,".mce-offscreen-selection"),Remove.remove)};var backspaceDeleteRange=function(editor,forward){var selectedElement=editor.selection.getNode();if(NodeType.isContentEditableFalse(selectedElement)){deleteOffscreenSelection(Element.fromDom(editor.getBody()));DeleteElement.deleteElement(editor,forward,Element.fromDom(editor.selection.getNode()));DeleteUtils.paddEmptyBody(editor);return true}else{return false}};var getContentEditableRoot=function(root,node){while(node&&node!==root){if(NodeType.isContentEditableTrue(node)||NodeType.isContentEditableFalse(node)){return node}node=node.parentNode}return null};var paddEmptyElement=function(editor){var br,ceRoot=getContentEditableRoot(editor.getBody(),editor.selection.getNode());if(NodeType.isContentEditableTrue(ceRoot)&&editor.dom.isBlock(ceRoot)&&editor.dom.isEmpty(ceRoot)){br=editor.dom.create("br",{"data-mce-bogus":"1"});editor.dom.setHTML(ceRoot,"");ceRoot.appendChild(br);editor.selection.setRng(CaretPosition.before(br).toRange())}return true};var backspaceDelete=function(editor,forward){if(editor.selection.isCollapsed()){return backspaceDeleteCaret(editor,forward)}else{return backspaceDeleteRange(editor,forward)}};return{backspaceDelete:backspaceDelete,paddEmptyElement:paddEmptyElement}});define("tinymce.core.caret.CaretContainerInline",["ephox.katamari.api.Fun","tinymce.core.dom.NodeType","tinymce.core.text.Zwsp"],function(Fun,NodeType,Zwsp){var isText=NodeType.isText;var startsWithCaretContainer=function(node){return isText(node)&&node.data[0]===Zwsp.ZWSP};var endsWithCaretContainer=function(node){return isText(node)&&node.data[node.data.length-1]===Zwsp.ZWSP};var createZwsp=function(node){return node.ownerDocument.createTextNode(Zwsp.ZWSP)};var insertBefore=function(node){if(isText(node.previousSibling)){if(endsWithCaretContainer(node.previousSibling)){return node.previousSibling}else{node.previousSibling.appendData(Zwsp.ZWSP);return node.previousSibling}}else if(isText(node)){if(startsWithCaretContainer(node)){return node}else{node.insertData(0,Zwsp.ZWSP);return node}}else{var newNode=createZwsp(node);node.parentNode.insertBefore(newNode,node);return newNode}};var insertAfter=function(node){if(isText(node.nextSibling)){if(startsWithCaretContainer(node.nextSibling)){return node.nextSibling}else{node.nextSibling.insertData(0,Zwsp.ZWSP);return node.nextSibling}}else if(isText(node)){if(endsWithCaretContainer(node)){return node}else{node.appendData(Zwsp.ZWSP);return node}}else{var newNode=createZwsp(node);if(node.nextSibling){node.parentNode.insertBefore(newNode,node.nextSibling)}else{node.parentNode.appendChild(newNode)}return newNode}};var insertInline=function(before,node){return before?insertBefore(node):insertAfter(node)};return{insertInline:insertInline,insertInlineBefore:Fun.curry(insertInline,true),insertInlineAfter:Fun.curry(insertInline,false)}});define("tinymce.core.caret.CaretContainerRemove",["ephox.katamari.api.Arr","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.text.Zwsp"],function(Arr,CaretContainer,CaretPosition,NodeType,Zwsp){var isElement=NodeType.isElement;var isText=NodeType.isText;var removeNode=function(node){var parentNode=node.parentNode;if(parentNode){parentNode.removeChild(node)}};var getNodeValue=function(node){try{return node.nodeValue}catch(ex){return""}};var setNodeValue=function(node,text){if(text.length===0){removeNode(node)}else{node.nodeValue=text}};var trimCount=function(text){var trimmedText=Zwsp.trim(text);return{count:text.length-trimmedText.length,text:trimmedText}};var removeUnchanged=function(caretContainer,pos){remove(caretContainer);return pos};var removeTextAndReposition=function(caretContainer,pos){var before=trimCount(caretContainer.data.substr(0,pos.offset()));var after=trimCount(caretContainer.data.substr(pos.offset()));var text=before.text+after.text;if(text.length>0){setNodeValue(caretContainer,text);return new CaretPosition(caretContainer,pos.offset()-before.count)}else{return pos}};var removeElementAndReposition=function(caretContainer,pos){var parentNode=pos.container();var newPosition=Arr.indexOf(parentNode.childNodes,caretContainer).map(function(index){return index<pos.offset()?new CaretPosition(parentNode,pos.offset()-1):pos}).getOr(pos);remove(caretContainer);return newPosition};var removeTextCaretContainer=function(caretContainer,pos){return pos.container()===caretContainer?removeTextAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos)};var removeElementCaretContainer=function(caretContainer,pos){return pos.container()===caretContainer.parentNode?removeElementAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos)};var removeAndReposition=function(container,pos){return CaretPosition.isTextPosition(pos)?removeTextCaretContainer(container,pos):removeElementCaretContainer(container,pos)};var remove=function(caretContainerNode){if(isElement(caretContainerNode)&&CaretContainer.isCaretContainer(caretContainerNode)){if(CaretContainer.hasContent(caretContainerNode)){caretContainerNode.removeAttribute("data-mce-caret")}else{removeNode(caretContainerNode)}}if(isText(caretContainerNode)){var text=Zwsp.trim(getNodeValue(caretContainerNode));setNodeValue(caretContainerNode,text)}};return{removeAndReposition:removeAndReposition,remove:remove}});define("tinymce.core.keyboard.BoundaryCaret",["ephox.katamari.api.Option","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretContainerInline","tinymce.core.caret.CaretContainerRemove","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.keyboard.InlineUtils"],function(Option,CaretContainer,CaretContainerInline,CaretContainerRemove,CaretFinder,CaretPosition,NodeType,InlineUtils){var insertInlinePos=function(pos,before){if(NodeType.isText(pos.container())){return CaretContainerInline.insertInline(before,pos.container())}else{return CaretContainerInline.insertInline(before,pos.getNode())}};var isPosCaretContainer=function(pos,caret){var caretNode=caret.get();return caretNode&&pos.container()===caretNode&&CaretContainer.isCaretContainerInline(caretNode)};var renderCaret=function(caret,location){return location.fold(function(element){CaretContainerRemove.remove(caret.get());var text=CaretContainerInline.insertInlineBefore(element);caret.set(text);return Option.some(new CaretPosition(text,text.length-1))},function(element){return CaretFinder.firstPositionIn(element).map(function(pos){if(!isPosCaretContainer(pos,caret)){CaretContainerRemove.remove(caret.get());var text=insertInlinePos(pos,true);caret.set(text);return new CaretPosition(text,1)}else{return new CaretPosition(caret.get(),1)}})},function(element){return CaretFinder.lastPositionIn(element).map(function(pos){if(!isPosCaretContainer(pos,caret)){CaretContainerRemove.remove(caret.get());var text=insertInlinePos(pos,false);caret.set(text);return new CaretPosition(text,text.length-1)}else{return new CaretPosition(caret.get(),caret.get().length-1)}})},function(element){CaretContainerRemove.remove(caret.get());var text=CaretContainerInline.insertInlineAfter(element);caret.set(text);return Option.some(new CaretPosition(text,1))})};return{renderCaret:renderCaret}});define("tinymce.core.fmt.FormatUtils",["tinymce.core.dom.TreeWalker"],function(TreeWalker){var isInlineBlock=function(node){return node&&/^(IMG)$/.test(node.nodeName)};var moveStart=function(dom,selection,rng){var container=rng.startContainer,offset=rng.startOffset,walker,node,nodes;if(rng.startContainer===rng.endContainer){if(isInlineBlock(rng.startContainer.childNodes[rng.startOffset])){return}}if(container.nodeType===3&&offset>=container.nodeValue.length){offset=dom.nodeIndex(container);container=container.parentNode}if(container.nodeType===1){nodes=container.childNodes;if(offset<nodes.length){container=nodes[offset];walker=new TreeWalker(container,dom.getParent(container,dom.isBlock))}else{container=nodes[nodes.length-1];walker=new TreeWalker(container,dom.getParent(container,dom.isBlock));walker.next(true)}for(node=walker.current();node;node=walker.next()){if(node.nodeType===3&&!isWhiteSpaceNode(node)){rng.setStart(node,0);selection.setRng(rng);return}}}};var getNonWhiteSpaceSibling=function(node,next,inc){if(node){next=next?"nextSibling":"previousSibling";for(node=inc?node:node[next];node;node=node[next]){if(node.nodeType===1||!isWhiteSpaceNode(node)){return node}}}};var isTextBlock=function(editor,name){if(name.nodeType){name=name.nodeName}return!!editor.schema.getTextBlockElements()[name.toLowerCase()]};var isValid=function(ed,parent,child){return ed.schema.isValidChild(parent,child)};var isWhiteSpaceNode=function(node){return node&&node.nodeType===3&&/^([\t \r\n]+|)$/.test(node.nodeValue)};var replaceVars=function(value,vars){if(typeof value!=="string"){value=value(vars)}else if(vars){value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str})}return value};var isEq=function(str1,str2){str1=str1||"";str2=str2||"";str1=""+(str1.nodeName||str1);str2=""+(str2.nodeName||str2);return str1.toLowerCase()===str2.toLowerCase()};var normalizeStyleValue=function(dom,value,name){if(name==="color"||name==="backgroundColor"){value=dom.toHex(value)}if(name==="fontWeight"&&value===700){value="bold"}if(name==="fontFamily"){value=value.replace(/[\'\"]/g,"").replace(/,\s+/g,",")}return""+value};var getStyle=function(dom,node,name){return normalizeStyleValue(dom,dom.getStyle(node,name),name)};var getTextDecoration=function(dom,node){var decoration;dom.getParent(node,function(n){decoration=dom.getStyle(n,"text-decoration");return decoration&&decoration!=="none"});return decoration};var getParents=function(dom,node,selector){return dom.getParents(node,selector,dom.getRoot())};return{isInlineBlock:isInlineBlock,moveStart:moveStart,getNonWhiteSpaceSibling:getNonWhiteSpaceSibling,isTextBlock:isTextBlock,isValid:isValid,isWhiteSpaceNode:isWhiteSpaceNode,replaceVars:replaceVars,isEq:isEq,normalizeStyleValue:normalizeStyleValue,getStyle:getStyle,getTextDecoration:getTextDecoration,getParents:getParents}});define("tinymce.core.fmt.ExpandRange",["tinymce.core.dom.Bookmarks","tinymce.core.dom.TreeWalker","tinymce.core.fmt.FormatUtils","tinymce.core.selection.RangeNodes"],function(Bookmarks,TreeWalker,FormatUtils,RangeNodes){var isBookmarkNode=Bookmarks.isBookmarkNode;var getParents=FormatUtils.getParents,isWhiteSpaceNode=FormatUtils.isWhiteSpaceNode,isTextBlock=FormatUtils.isTextBlock;var findLeaf=function(node,offset){if(typeof offset==="undefined"){offset=node.nodeType===3?node.length:node.childNodes.length}while(node&&node.hasChildNodes()){node=node.childNodes[offset];if(node){offset=node.nodeType===3?node.length:node.childNodes.length}}return{node:node,offset:offset}};var excludeTrailingWhitespace=function(endContainer,endOffset){var leaf=findLeaf(endContainer,endOffset);if(leaf.node){while(leaf.node&&leaf.offset===0&&leaf.node.previousSibling){leaf=findLeaf(leaf.node.previousSibling)}if(leaf.node&&leaf.offset>0&&leaf.node.nodeType===3&&leaf.node.nodeValue.charAt(leaf.offset-1)===" "){if(leaf.offset>1){endContainer=leaf.node;endContainer.splitText(leaf.offset-1)}}}return endContainer};var isBogusBr=function(node){return node.nodeName==="BR"&&node.getAttribute("data-mce-bogus")&&!node.nextSibling};var findParentContentEditable=function(dom,node){var parent=node;while(parent){if(parent.nodeType===1&&dom.getContentEditable(parent)){return dom.getContentEditable(parent)==="false"?parent:node}parent=parent.parentNode}return node};var findSpace=function(start,remove,node,offset){var pos,pos2,str=node.nodeValue;if(typeof offset==="undefined"){offset=start?str.length:0}if(start){pos=str.lastIndexOf(" ",offset);pos2=str.lastIndexOf("¬†",offset);pos=pos>pos2?pos:pos2;if(pos!==-1&&!remove){pos++}}else{pos=str.indexOf(" ",offset);pos2=str.indexOf("¬†",offset);pos=pos!==-1&&(pos2===-1||pos<pos2)?pos:pos2}return pos};var findWordEndPoint=function(dom,body,container,offset,start,remove){var walker,node,pos,lastTextNode;if(container.nodeType===3){pos=findSpace(start,remove,container,offset);if(pos!==-1){return{container:container,offset:pos}}lastTextNode=container}walker=new TreeWalker(container,dom.getParent(container,dom.isBlock)||body);while(node=walker[start?"prev":"next"]()){if(node.nodeType===3){lastTextNode=node;pos=findSpace(start,remove,node);if(pos!==-1){return{container:node,offset:pos}}}else if(dom.isBlock(node)){break}}if(lastTextNode){if(start){offset=0}else{offset=lastTextNode.length}return{container:lastTextNode,offset:offset}}};var findSelectorEndPoint=function(dom,format,rng,container,siblingName){var parents,i,y,curFormat;if(container.nodeType===3&&container.nodeValue.length===0&&container[siblingName]){container=container[siblingName]}parents=getParents(dom,container);for(i=0;i<parents.length;i++){for(y=0;y<format.length;y++){curFormat=format[y];if("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed){continue}if(dom.is(parents[i],curFormat.selector)){return parents[i]}}}return container};var findBlockEndPoint=function(editor,format,container,siblingName){var node,dom=editor.dom,root=dom.getRoot();if(!format[0].wrapper){node=dom.getParent(container,format[0].block,root)}if(!node){var scopeRoot=dom.getParent(container,"LI,TD,TH");node=dom.getParent(container.nodeType===3?container.parentNode:container,function(node){return node!==root&&isTextBlock(editor,node)},scopeRoot)}if(node&&format[0].wrapper){node=getParents(dom,node,"ul,ol").reverse()[0]||node}if(!node){node=container;while(node[siblingName]&&!dom.isBlock(node[siblingName])){node=node[siblingName];if(FormatUtils.isEq(node,"br")){break}}}return node||container};var findParentContainer=function(dom,format,startContainer,startOffset,endContainer,endOffset,start){var container,parent,sibling,siblingName,root;container=parent=start?startContainer:endContainer;siblingName=start?"previousSibling":"nextSibling";root=dom.getRoot();if(container.nodeType===3&&!isWhiteSpaceNode(container)){if(start?startOffset>0:endOffset<container.nodeValue.length){return container}}while(true){if(!format[0].block_expand&&dom.isBlock(parent)){return parent}for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName]){if(!isBookmarkNode(sibling)&&!isWhiteSpaceNode(sibling)&&!isBogusBr(sibling)){return parent}}if(parent===root||parent.parentNode===root){container=parent;break}parent=parent.parentNode}return container};var expandRng=function(editor,rng,format,remove){var endPoint,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,dom=editor.dom;if(startContainer.nodeType===1&&startContainer.hasChildNodes()){startContainer=RangeNodes.getNode(startContainer,startOffset);if(startContainer.nodeType===3){startOffset=0}}if(endContainer.nodeType===1&&endContainer.hasChildNodes()){endContainer=RangeNodes.getNode(endContainer,rng.collapsed?endOffset:endOffset-1);if(endContainer.nodeType===3){endOffset=endContainer.nodeValue.length}}startContainer=findParentContentEditable(dom,startContainer);endContainer=findParentContentEditable(dom,endContainer);if(isBookmarkNode(startContainer.parentNode)||isBookmarkNode(startContainer)){startContainer=isBookmarkNode(startContainer)?startContainer:startContainer.parentNode;startContainer=startContainer.nextSibling||startContainer;if(startContainer.nodeType===3){startOffset=0}}if(isBookmarkNode(endContainer.parentNode)||isBookmarkNode(endContainer)){endContainer=isBookmarkNode(endContainer)?endContainer:endContainer.parentNode;endContainer=endContainer.previousSibling||endContainer;if(endContainer.nodeType===3){endOffset=endContainer.length}}if(format[0].inline){if(rng.collapsed){endPoint=findWordEndPoint(dom,editor.getBody(),startContainer,startOffset,true,remove);if(endPoint){startContainer=endPoint.container;startOffset=endPoint.offset}endPoint=findWordEndPoint(dom,editor.getBody(),endContainer,endOffset,false,remove);if(endPoint){endContainer=endPoint.container;endOffset=endPoint.offset}}endContainer=remove?endContainer:excludeTrailingWhitespace(endContainer,endOffset)}if(format[0].inline||format[0].block_expand){if(!format[0].inline||(startContainer.nodeType!==3||startOffset===0)){startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,true)}if(!format[0].inline||(endContainer.nodeType!==3||endOffset===endContainer.nodeValue.length)){endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,false)}}if(format[0].selector&&format[0].expand!==false&&!format[0].inline){startContainer=findSelectorEndPoint(dom,format,rng,startContainer,"previousSibling");endContainer=findSelectorEndPoint(dom,format,rng,endContainer,"nextSibling")}if(format[0].block||format[0].selector){startContainer=findBlockEndPoint(editor,format,startContainer,"previousSibling");endContainer=findBlockEndPoint(editor,format,endContainer,"nextSibling");if(format[0].block){if(!dom.isBlock(startContainer)){startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,true)}if(!dom.isBlock(endContainer)){endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,false)}}}if(startContainer.nodeType===1){startOffset=dom.nodeIndex(startContainer);startContainer=startContainer.parentNode}if(endContainer.nodeType===1){endOffset=dom.nodeIndex(endContainer)+1;endContainer=endContainer.parentNode}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}};return{expandRng:expandRng}});define("tinymce.core.fmt.MatchFormat",["tinymce.core.fmt.FormatUtils"],function(FormatUtils){var isEq=FormatUtils.isEq;var matchesUnInheritedFormatSelector=function(ed,node,name){var formatList=ed.formatter.get(name);if(formatList){for(var i=0;i<formatList.length;i++){if(formatList[i].inherit===false&&ed.dom.is(node,formatList[i].selector)){return true}}}return false};var matchParents=function(editor,node,name,vars){var root=editor.dom.getRoot();if(node===root){return false}node=editor.dom.getParent(node,function(node){if(matchesUnInheritedFormatSelector(editor,node,name)){return true}return node.parentNode===root||!!matchNode(editor,node,name,vars,true)});return matchNode(editor,node,name,vars)};var matchName=function(dom,node,format){if(isEq(node,format.inline)){return true}if(isEq(node,format.block)){return true}if(format.selector){return node.nodeType===1&&dom.is(node,format.selector)}};var matchItems=function(dom,node,format,itemName,similar,vars){var key,value,items=format[itemName],i;if(format.onmatch){return format.onmatch(node,format,itemName)}if(items){if(typeof items.length==="undefined"){for(key in items){if(items.hasOwnProperty(key)){if(itemName==="attributes"){value=dom.getAttrib(node,key)}else{value=FormatUtils.getStyle(dom,node,key)}if(similar&&!value&&!format.exact){return}if((!similar||format.exact)&&!isEq(value,FormatUtils.normalizeStyleValue(dom,FormatUtils.replaceVars(items[key],vars),key))){return}}}}else{for(i=0;i<items.length;i++){if(itemName==="attributes"?dom.getAttrib(node,items[i]):FormatUtils.getStyle(dom,node,items[i])){return format}}}}return format};var matchNode=function(ed,node,name,vars,similar){var formatList=ed.formatter.get(name),format,i,x,classes,dom=ed.dom;if(formatList&&node){for(i=0;i<formatList.length;i++){format=formatList[i];if(matchName(ed.dom,node,format)&&matchItems(dom,node,format,"attributes",similar,vars)&&matchItems(dom,node,format,"styles",similar,vars)){if(classes=format.classes){for(x=0;x<classes.length;x++){if(!ed.dom.hasClass(node,classes[x])){return}}}return format}}}};var match=function(editor,name,vars,node){var startNode;if(node){return matchParents(editor,node,name,vars)}node=editor.selection.getNode();if(matchParents(editor,node,name,vars)){return true}startNode=editor.selection.getStart();if(startNode!==node){if(matchParents(editor,startNode,name,vars)){return true}}return false};var matchAll=function(editor,names,vars){var startElement,matchedFormatNames=[],checkedMap={};startElement=editor.selection.getStart();editor.dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++){name=names[i];if(!checkedMap[name]&&matchNode(editor,node,name,vars)){checkedMap[name]=true;matchedFormatNames.push(name)}}},editor.dom.getRoot());return matchedFormatNames};var canApply=function(editor,name){var formatList=editor.formatter.get(name),startNode,parents,i,x,selector,dom=editor.dom;if(formatList){startNode=editor.selection.getStart();parents=FormatUtils.getParents(dom,startNode);for(x=formatList.length-1;x>=0;x--){selector=formatList[x].selector;if(!selector||formatList[x].defaultBlock){return true}for(i=parents.length-1;i>=0;i--){if(dom.is(parents[i],selector)){return true}}}}return false};return{matchNode:matchNode,matchName:matchName,match:match,matchAll:matchAll,canApply:canApply,matchesUnInheritedFormatSelector:matchesUnInheritedFormatSelector}});define("tinymce.core.selection.SplitRange",["tinymce.core.dom.NodeType"],function(NodeType){var splitText=function(node,offset){return node.splitText(offset)};var split=function(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;if(startContainer===endContainer&&NodeType.isText(startContainer)){if(startOffset>0&&startOffset<startContainer.nodeValue.length){endContainer=splitText(startContainer,startOffset);startContainer=endContainer.previousSibling;if(endOffset>startOffset){endOffset=endOffset-startOffset;startContainer=endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length;startOffset=0}else{endOffset=0}}}else{if(NodeType.isText(startContainer)&&startOffset>0&&startOffset<startContainer.nodeValue.length){startContainer=splitText(startContainer,startOffset);startOffset=0}if(NodeType.isText(endContainer)&&endOffset>0&&endOffset<endContainer.nodeValue.length){endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length}}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}};return{split:split}});define("tinymce.core.fmt.CaretFormat",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.dom.PaddingBr","tinymce.core.dom.TreeWalker","tinymce.core.fmt.ExpandRange","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.selection.SplitRange","tinymce.core.text.Zwsp","tinymce.core.util.Fun"],function(Arr,Insert,Remove,Element,Node,Attr,CaretPosition,NodeType,PaddingBr,TreeWalker,ExpandRange,FormatUtils,MatchFormat,SplitRange,Zwsp,Fun){var ZWSP=Zwsp.ZWSP,CARET_ID="_mce_caret";var importNode=function(ownerDocument,node){return ownerDocument.importNode(node,true)};var isCaretNode=function(node){return node.nodeType===1&&node.id===CARET_ID};var getEmptyCaretContainers=function(node){var nodes=[];while(node){if(node.nodeType===3&&node.nodeValue!==ZWSP||node.childNodes.length>1){return[]}if(node.nodeType===1){nodes.push(node)}node=node.firstChild}return nodes};var isCaretContainerEmpty=function(node){return getEmptyCaretContainers(node).length>0};var findFirstTextNode=function(node){var walker;if(node){walker=new TreeWalker(node,node);for(node=walker.current();node;node=walker.next()){if(node.nodeType===3){return node}}}return null};var createCaretContainer=function(fill){var caretContainer=Element.fromTag("span");Attr.setAll(caretContainer,{id:CARET_ID,"data-mce-bogus":"1","data-mce-type":"format-caret"});if(fill){Insert.append(caretContainer,Element.fromText(ZWSP))}return caretContainer};var getParentCaretContainer=function(body,node){while(node&&node!==body){if(node.id===CARET_ID){return node}node=node.parentNode}return null};var trimZwspFromCaretContainer=function(caretContainerNode){var textNode=findFirstTextNode(caretContainerNode);if(textNode&&textNode.nodeValue.charAt(0)===ZWSP){textNode.deleteData(0,1)}return textNode};var removeCaretContainerNode=function(dom,selection,node,moveCaret){var rng,block,textNode;rng=selection.getRng(true);block=dom.getParent(node,dom.isBlock);if(isCaretContainerEmpty(node)){if(moveCaret!==false){rng.setStartBefore(node);rng.setEndBefore(node)}dom.remove(node)}else{textNode=trimZwspFromCaretContainer(node);if(rng.startContainer===textNode&&rng.startOffset>0){rng.setStart(textNode,rng.startOffset-1)}if(rng.endContainer===textNode&&rng.endOffset>0){rng.setEnd(textNode,rng.endOffset-1)}dom.remove(node,true)}if(block&&dom.isEmpty(block)){PaddingBr.fillWithPaddingBr(Element.fromDom(block))}selection.setRng(rng)};var removeCaretContainer=function(body,dom,selection,node,moveCaret){if(!node){node=getParentCaretContainer(body,selection.getStart());if(!node){while(node=dom.get(CARET_ID)){removeCaretContainerNode(dom,selection,node,false)}}}else{removeCaretContainerNode(dom,selection,node,moveCaret)}};var insertCaretContainerNode=function(editor,caretContainer,formatNode){var dom=editor.dom,block=dom.getParent(formatNode,Fun.curry(FormatUtils.isTextBlock,editor));if(block&&dom.isEmpty(block)){formatNode.parentNode.replaceChild(caretContainer,formatNode)}else{PaddingBr.removeTrailingBr(Element.fromDom(formatNode));if(dom.isEmpty(formatNode)){formatNode.parentNode.replaceChild(caretContainer,formatNode)}else{dom.insertAfter(caretContainer,formatNode)}}};var appendNode=function(parentNode,node){parentNode.appendChild(node);return node};var insertFormatNodesIntoCaretContainer=function(formatNodes,caretContainer){var innerMostFormatNode=Arr.foldr(formatNodes,function(parentNode,formatNode){return appendNode(parentNode,formatNode.cloneNode(false))},caretContainer);return appendNode(innerMostFormatNode,innerMostFormatNode.ownerDocument.createTextNode(ZWSP))};var applyCaretFormat=function(editor,name,vars){var rng,caretContainer,textNode,offset,bookmark,container,text;var selection=editor.selection;rng=selection.getRng(true);offset=rng.startOffset;container=rng.startContainer;text=container.nodeValue;caretContainer=getParentCaretContainer(editor.getBody(),selection.getStart());if(caretContainer){textNode=findFirstTextNode(caretContainer)}var wordcharRegex=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(text&&offset>0&&offset<text.length&&wordcharRegex.test(text.charAt(offset))&&wordcharRegex.test(text.charAt(offset-1))){bookmark=selection.getBookmark();rng.collapse(true);rng=ExpandRange.expandRng(editor,rng,editor.formatter.get(name));rng=SplitRange.split(rng);editor.formatter.apply(name,vars,rng);selection.moveToBookmark(bookmark)}else{if(!caretContainer||textNode.nodeValue!==ZWSP){caretContainer=importNode(editor.getDoc(),createCaretContainer(true).dom());textNode=caretContainer.firstChild;rng.insertNode(caretContainer);offset=1;editor.formatter.apply(name,vars,caretContainer)}else{editor.formatter.apply(name,vars,caretContainer)}selection.setCursorLocation(textNode,offset)}};var removeCaretFormat=function(editor,name,vars,similar){var dom=editor.dom,selection=editor.selection;var rng=selection.getRng(true),container,offset,bookmark;var hasContentAfter,node,formatNode,parents=[],caretContainer;container=rng.startContainer;offset=rng.startOffset;node=container;if(container.nodeType===3){if(offset!==container.nodeValue.length){hasContentAfter=true}node=node.parentNode}while(node){if(MatchFormat.matchNode(editor,node,name,vars,similar)){formatNode=node;break}if(node.nextSibling){hasContentAfter=true}parents.push(node);node=node.parentNode}if(!formatNode){return}if(hasContentAfter){bookmark=selection.getBookmark();rng.collapse(true);rng=ExpandRange.expandRng(editor,rng,editor.formatter.get(name),true);rng=SplitRange.split(rng);editor.formatter.remove(name,vars,rng);selection.moveToBookmark(bookmark)}else{caretContainer=getParentCaretContainer(editor.getBody(),formatNode);var newCaretContainer=createCaretContainer(false).dom();var caretNode=insertFormatNodesIntoCaretContainer(parents,newCaretContainer);if(caretContainer){insertCaretContainerNode(editor,newCaretContainer,caretContainer)}else{insertCaretContainerNode(editor,newCaretContainer,formatNode)}removeCaretContainerNode(dom,selection,caretContainer,false);selection.setCursorLocation(caretNode,1);if(dom.isEmpty(formatNode)){dom.remove(formatNode)}}};var disableCaretContainer=function(body,dom,selection,keyCode){removeCaretContainer(body,dom,selection,null,false);if(keyCode===8&&selection.isCollapsed()&&selection.getStart().innerHTML===ZWSP){removeCaretContainer(body,dom,selection,getParentCaretContainer(body,selection.getStart()))}if(keyCode===37||keyCode===39){removeCaretContainer(body,dom,selection,getParentCaretContainer(body,selection.getStart()))}};var setup=function(editor){var dom=editor.dom,selection=editor.selection;var body=editor.getBody();editor.on("mouseup keydown",function(e){disableCaretContainer(body,dom,selection,e.keyCode)})};var replaceWithCaretFormat=function(targetNode,formatNodes){var caretContainer=createCaretContainer(false);var innerMost=insertFormatNodesIntoCaretContainer(formatNodes,caretContainer.dom());Insert.before(Element.fromDom(targetNode),caretContainer);Remove.remove(Element.fromDom(targetNode));return CaretPosition(innerMost,0)};var isFormatElement=function(editor,element){var inlineElements=editor.schema.getTextInlineElements();return inlineElements.hasOwnProperty(Node.name(element))&&!isCaretNode(element.dom())&&!NodeType.isBogus(element.dom())};return{setup:setup,applyCaretFormat:applyCaretFormat,removeCaretFormat:removeCaretFormat,isCaretNode:isCaretNode,getParentCaretContainer:getParentCaretContainer,replaceWithCaretFormat:replaceWithCaretFormat,isFormatElement:isFormatElement}});define("tinymce.core.util.LazyEvaluator",["ephox.katamari.api.Option"],function(Option){var evaluateUntil=function(fns,args){for(var i=0;i<fns.length;i++){var result=fns[i].apply(null,args);if(result.isSome()){return result}}return Option.none()};return{evaluateUntil:evaluateUntil}});define("tinymce.core.keyboard.BoundaryLocation",["ephox.katamari.api.Adt","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretUtils","tinymce.core.fmt.CaretFormat","tinymce.core.keyboard.InlineUtils","tinymce.core.util.LazyEvaluator"],function(Adt,Fun,Option,Options,CaretFinder,CaretUtils,CaretFormat,InlineUtils,LazyEvaluator){var Location=Adt.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]);var rescope=function(rootNode,node){var parentBlock=CaretUtils.getParentBlock(node,rootNode);return parentBlock?parentBlock:rootNode};var before=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeForwards(pos);var scope=rescope(rootNode,nPos.container());return InlineUtils.findRootInline(isInlineTarget,scope,nPos).fold(function(){return CaretFinder.nextPosition(scope,nPos).bind(Fun.curry(InlineUtils.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.before(inline)})},Option.none)};var isNotInsideFormatCaretContainer=function(rootNode,elm){return CaretFormat.getParentCaretContainer(rootNode,elm)===null};var findInsideRootInline=function(isInlineTarget,rootNode,pos){return InlineUtils.findRootInline(isInlineTarget,rootNode,pos).filter(Fun.curry(isNotInsideFormatCaretContainer,rootNode))};var start=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeBackwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){var prevPos=CaretFinder.prevPosition(inline,nPos);return prevPos.isNone()?Option.some(Location.start(inline)):Option.none()})};var end=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeForwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){var nextPos=CaretFinder.nextPosition(inline,nPos);return nextPos.isNone()?Option.some(Location.end(inline)):Option.none()})};var after=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeBackwards(pos);var scope=rescope(rootNode,nPos.container());return InlineUtils.findRootInline(isInlineTarget,scope,nPos).fold(function(){return CaretFinder.prevPosition(scope,nPos).bind(Fun.curry(InlineUtils.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.after(inline)})},Option.none)};var isValidLocation=function(location){return InlineUtils.isRtl(getElement(location))===false};var readLocation=function(isInlineTarget,rootNode,pos){var location=LazyEvaluator.evaluateUntil([before,start,end,after],[isInlineTarget,rootNode,pos]);return location.filter(isValidLocation)};var getElement=function(location){return location.fold(Fun.identity,Fun.identity,Fun.identity,Fun.identity)};var getName=function(location){return location.fold(Fun.constant("before"),Fun.constant("start"),Fun.constant("end"),Fun.constant("after"))};var outside=function(location){return location.fold(Location.before,Location.before,Location.after,Location.after)};var inside=function(location){return location.fold(Location.start,Location.start,Location.end,Location.end)};var isEq=function(location1,location2){return getName(location1)===getName(location2)&&getElement(location1)===getElement(location2)};var betweenInlines=function(forward,isInlineTarget,rootNode,from,to,location){return Options.liftN([InlineUtils.findRootInline(isInlineTarget,rootNode,from),InlineUtils.findRootInline(isInlineTarget,rootNode,to)],function(fromInline,toInline){if(fromInline!==toInline&&InlineUtils.hasSameParentBlock(rootNode,fromInline,toInline)){return Location.after(forward?fromInline:toInline)}else{return location}}).getOr(location)};var skipNoMovement=function(fromLocation,toLocation){return fromLocation.fold(Fun.constant(true),function(fromLocation){return!isEq(fromLocation,toLocation)})};var findLocationTraverse=function(forward,isInlineTarget,rootNode,fromLocation,pos){var from=InlineUtils.normalizePosition(forward,pos);var to=CaretFinder.fromPosition(forward,rootNode,from).map(Fun.curry(InlineUtils.normalizePosition,forward));var location=to.fold(function(){return fromLocation.map(outside)},function(to){return readLocation(isInlineTarget,rootNode,to).map(Fun.curry(betweenInlines,forward,isInlineTarget,rootNode,from,to)).filter(Fun.curry(skipNoMovement,fromLocation))});return location.filter(isValidLocation)};var findLocationSimple=function(forward,location){if(forward){return location.fold(Fun.compose(Option.some,Location.start),Option.none,Fun.compose(Option.some,Location.after),Option.none)}else{return location.fold(Option.none,Fun.compose(Option.some,Location.before),Option.none,Fun.compose(Option.some,Location.end))}};var findLocation=function(forward,isInlineTarget,rootNode,pos){var from=InlineUtils.normalizePosition(forward,pos);var fromLocation=readLocation(isInlineTarget,rootNode,from);return readLocation(isInlineTarget,rootNode,from).bind(Fun.curry(findLocationSimple,forward)).orThunk(function(){return findLocationTraverse(forward,isInlineTarget,rootNode,fromLocation,pos)})};return{readLocation:readLocation,findLocation:findLocation,prevLocation:Fun.curry(findLocation,false),nextLocation:Fun.curry(findLocation,true),getElement:getElement,outside:outside,inside:inside}});define("ephox.katamari.api.Cell",[],function(){var Cell=function(initial){var value=initial;var get=function(){return value};var set=function(v){value=v};var clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}};return Cell});define("tinymce.core.selection.WordSelection",["ephox.katamari.api.Type","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition"],function(Type,CaretContainer,CaretPosition){var hasSelectionModifyApi=function(editor){return Type.isFunction(editor.selection.getSel().modify)};var moveRel=function(forward,selection,pos){var delta=forward?1:-1;selection.setRng(CaretPosition(pos.container(),pos.offset()+delta).toRange());selection.getSel().modify("move",forward?"forward":"backward","word");return true};var moveByWord=function(forward,editor){var rng=editor.selection.getRng();var pos=forward?CaretPosition.fromRangeEnd(rng):CaretPosition.fromRangeStart(rng);if(!hasSelectionModifyApi(editor)){return false}else if(forward&&CaretContainer.isBeforeInline(pos)){return moveRel(true,editor.selection,pos)}else if(!forward&&CaretContainer.isAfterInline(pos)){return moveRel(false,editor.selection,pos)}else{return false}};return{hasSelectionModifyApi:hasSelectionModifyApi,moveByWord:moveByWord}});define("tinymce.core.keyboard.BoundarySelection",["ephox.katamari.api.Arr","ephox.katamari.api.Cell","ephox.katamari.api.Fun","tinymce.core.caret.CaretContainerRemove","tinymce.core.caret.CaretPosition","tinymce.core.keyboard.BoundaryCaret","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.InlineUtils","tinymce.core.selection.WordSelection"],function(Arr,Cell,Fun,CaretContainerRemove,CaretPosition,BoundaryCaret,BoundaryLocation,InlineUtils,WordSelection){var setCaretPosition=function(editor,pos){var rng=editor.dom.createRng();rng.setStart(pos.container(),pos.offset());rng.setEnd(pos.container(),pos.offset());editor.selection.setRng(rng)};var isFeatureEnabled=function(editor){return editor.settings.inline_boundaries!==false};var setSelected=function(state,elm){if(state){elm.setAttribute("data-mce-selected","inline-boundary")}else{elm.removeAttribute("data-mce-selected")}};var renderCaretLocation=function(editor,caret,location){return BoundaryCaret.renderCaret(caret,location).map(function(pos){setCaretPosition(editor,pos);return location})};var findLocation=function(editor,caret,forward){var rootNode=editor.getBody();var from=CaretPosition.fromRangeStart(editor.selection.getRng());var isInlineTarget=Fun.curry(InlineUtils.isInlineTarget,editor);var location=BoundaryLocation.findLocation(forward,isInlineTarget,rootNode,from);return location.bind(function(location){return renderCaretLocation(editor,caret,location)})};var toggleInlines=function(isInlineTarget,dom,elms){var selectedInlines=Arr.filter(dom.select('*[data-mce-selected="inline-boundary"]'),isInlineTarget);var targetInlines=Arr.filter(elms,isInlineTarget);Arr.each(Arr.difference(selectedInlines,targetInlines),Fun.curry(setSelected,false));Arr.each(Arr.difference(targetInlines,selectedInlines),Fun.curry(setSelected,true))};var safeRemoveCaretContainer=function(editor,caret){if(editor.selection.isCollapsed()&&editor.composing!==true&&caret.get()){var pos=CaretPosition.fromRangeStart(editor.selection.getRng());if(CaretPosition.isTextPosition(pos)&&InlineUtils.isAtZwsp(pos)===false){setCaretPosition(editor,CaretContainerRemove.removeAndReposition(caret.get(),pos));caret.set(null)}}};var renderInsideInlineCaret=function(isInlineTarget,editor,caret,elms){if(editor.selection.isCollapsed()){var inlines=Arr.filter(elms,isInlineTarget);Arr.each(inlines,function(inline){var pos=CaretPosition.fromRangeStart(editor.selection.getRng());BoundaryLocation.readLocation(isInlineTarget,editor.getBody(),pos).bind(function(location){return renderCaretLocation(editor,caret,location)})})}};var move=function(editor,caret,forward){return function(){return isFeatureEnabled(editor)?findLocation(editor,caret,forward).isSome():false}};var moveWord=function(forward,editor,caret){return function(){return isFeatureEnabled(editor)?WordSelection.moveByWord(forward,editor):false}};var setupSelectedState=function(editor){var caret=new Cell(null);var isInlineTarget=Fun.curry(InlineUtils.isInlineTarget,editor);editor.on("NodeChange",function(e){if(isFeatureEnabled(editor)){toggleInlines(isInlineTarget,editor.dom,e.parents);safeRemoveCaretContainer(editor,caret);renderInsideInlineCaret(isInlineTarget,editor,caret,e.parents)}});return caret};return{move:move,moveNextWord:Fun.curry(moveWord,true),movePrevWord:Fun.curry(moveWord,false),setupSelectedState:setupSelectedState,setCaretPosition:setCaretPosition}});define("tinymce.core.delete.InlineBoundaryDelete",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.node.Element","global!document","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.delete.DeleteElement","tinymce.core.keyboard.BoundaryCaret","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.BoundarySelection","tinymce.core.keyboard.InlineUtils"],function(Fun,Option,Options,Element,document,CaretContainer,CaretFinder,CaretPosition,CaretUtils,DeleteElement,BoundaryCaret,BoundaryLocation,BoundarySelection,InlineUtils){var isFeatureEnabled=function(editor){return editor.settings.inline_boundaries!==false};var rangeFromPositions=function(from,to){var range=document.createRange();range.setStart(from.container(),from.offset());range.setEnd(to.container(),to.offset());return range};var hasOnlyTwoOrLessPositionsLeft=function(elm){return Options.liftN([CaretFinder.firstPositionIn(elm),CaretFinder.lastPositionIn(elm)],function(firstPos,lastPos){var normalizedFirstPos=InlineUtils.normalizePosition(true,firstPos);var normalizedLastPos=InlineUtils.normalizePosition(false,lastPos);return CaretFinder.nextPosition(elm,normalizedFirstPos).map(function(pos){return pos.isEqual(normalizedLastPos)}).getOr(true)}).getOr(true)};var setCaretLocation=function(editor,caret){return function(location){return BoundaryCaret.renderCaret(caret,location).map(function(pos){BoundarySelection.setCaretPosition(editor,pos);return true}).getOr(false)}};var deleteFromTo=function(editor,caret,from,to){var rootNode=editor.getBody();var isInlineTarget=Fun.curry(InlineUtils.isInlineTarget,editor);editor.undoManager.ignore(function(){editor.selection.setRng(rangeFromPositions(from,to));editor.execCommand("Delete");BoundaryLocation.readLocation(isInlineTarget,rootNode,CaretPosition.fromRangeStart(editor.selection.getRng())).map(BoundaryLocation.inside).map(setCaretLocation(editor,caret))});editor.nodeChanged()};var rescope=function(rootNode,node){var parentBlock=CaretUtils.getParentBlock(node,rootNode);return parentBlock?parentBlock:rootNode};var backspaceDeleteCollapsed=function(editor,caret,forward,from){var rootNode=rescope(editor.getBody(),from.container());var isInlineTarget=Fun.curry(InlineUtils.isInlineTarget,editor);var fromLocation=BoundaryLocation.readLocation(isInlineTarget,rootNode,from);return fromLocation.bind(function(location){if(forward){return location.fold(Fun.constant(Option.some(BoundaryLocation.inside(location))),Option.none,Fun.constant(Option.some(BoundaryLocation.outside(location))),Option.none)}else{return location.fold(Option.none,Fun.constant(Option.some(BoundaryLocation.outside(location))),Option.none,Fun.constant(Option.some(BoundaryLocation.inside(location))))}}).map(setCaretLocation(editor,caret)).getOrThunk(function(){var toPosition=CaretFinder.navigate(forward,rootNode,from);var toLocation=toPosition.bind(function(pos){return BoundaryLocation.readLocation(isInlineTarget,rootNode,pos)});if(fromLocation.isSome()&&toLocation.isSome()){return InlineUtils.findRootInline(isInlineTarget,rootNode,from).map(function(elm){if(hasOnlyTwoOrLessPositionsLeft(elm)){DeleteElement.deleteElement(editor,forward,Element.fromDom(elm));return true}else{return false}}).getOr(false)}else{return toLocation.bind(function(_){return toPosition.map(function(to){if(forward){deleteFromTo(editor,caret,from,to)}else{deleteFromTo(editor,caret,to,from)}return true})}).getOr(false)}})};var backspaceDelete=function(editor,caret,forward){if(editor.selection.isCollapsed()&&isFeatureEnabled(editor)){var from=CaretPosition.fromRangeStart(editor.selection.getRng());return backspaceDeleteCollapsed(editor,caret,forward,from)}return false};return{backspaceDelete:backspaceDelete}});define("tinymce.core.delete.TableDeleteAction",["ephox.katamari.api.Adt","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind"],function(Adt,Arr,Fun,Option,Options,Struct,Compare,Element,SelectorFilter,SelectorFind){var tableCellRng=Struct.immutable("start","end");var tableSelection=Struct.immutable("rng","table","cells");var deleteAction=Adt.generate([{removeTable:["element"]},{emptyCells:["cells"]}]);var getClosestCell=function(container,isRoot){return SelectorFind.closest(Element.fromDom(container),"td,th",isRoot)};var getClosestTable=function(cell,isRoot){return SelectorFind.ancestor(cell,"table",isRoot)};var isExpandedCellRng=function(cellRng){return Compare.eq(cellRng.start(),cellRng.end())===false};var getTableFromCellRng=function(cellRng,isRoot){return getClosestTable(cellRng.start(),isRoot).bind(function(startParentTable){return getClosestTable(cellRng.end(),isRoot).bind(function(endParentTable){return Compare.eq(startParentTable,endParentTable)?Option.some(startParentTable):Option.none()})})};var getCellRng=function(rng,isRoot){return Options.liftN([getClosestCell(rng.startContainer,isRoot),getClosestCell(rng.endContainer,isRoot)],tableCellRng).filter(isExpandedCellRng)};var getTableSelectionFromCellRng=function(cellRng,isRoot){return getTableFromCellRng(cellRng,isRoot).bind(function(table){var cells=SelectorFilter.descendants(table,"td,th");return tableSelection(cellRng,table,cells)})};var getTableSelectionFromRng=function(rootNode,rng){var isRoot=Fun.curry(Compare.eq,rootNode);return getCellRng(rng,isRoot).map(function(cellRng){return getTableSelectionFromCellRng(cellRng,isRoot)})};var getCellIndex=function(cellArray,cell){return Arr.findIndex(cellArray,function(x){return Compare.eq(x,cell)})};var getSelectedCells=function(tableSelection){return Options.liftN([getCellIndex(tableSelection.cells(),tableSelection.rng().start()),getCellIndex(tableSelection.cells(),tableSelection.rng().end())],function(startIndex,endIndex){return tableSelection.cells().slice(startIndex,endIndex+1)})};var getAction=function(tableSelection){return getSelectedCells(tableSelection).bind(function(selected){var cells=tableSelection.cells();return selected.length===cells.length?deleteAction.removeTable(tableSelection.table()):deleteAction.emptyCells(selected)})};var getActionFromCells=function(cells){return deleteAction.emptyCells(cells)};var getActionFromRange=function(rootNode,rng){return getTableSelectionFromRng(rootNode,rng).map(getAction)};return{getActionFromRange:getActionFromRange,getActionFromCells:getActionFromCells}});define("tinymce.core.selection.MultiRange",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","tinymce.core.selection.RangeNodes"],function(Arr,Element,RangeNodes){var getRanges=function(selection){var ranges=[];if(selection){for(var i=0;i<selection.rangeCount;i++){ranges.push(selection.getRangeAt(i))}}return ranges};var getSelectedNodes=function(ranges){return Arr.bind(ranges,function(range){var node=RangeNodes.getSelectedNode(range);return node?[Element.fromDom(node)]:[]})};var hasMultipleRanges=function(selection){return getRanges(selection).length>1};return{getRanges:getRanges,getSelectedNodes:getSelectedNodes,hasMultipleRanges:hasMultipleRanges}});define("tinymce.core.selection.TableCellSelection",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFilter","tinymce.core.dom.ElementType","tinymce.core.selection.MultiRange"],function(Arr,Element,SelectorFilter,ElementType,MultiRange){var getCellsFromRanges=function(ranges){return Arr.filter(MultiRange.getSelectedNodes(ranges),ElementType.isTableCell)};var getCellsFromElement=function(elm){var selectedCells=SelectorFilter.descendants(elm,"td[data-mce-selected],th[data-mce-selected]");return selectedCells};var getCellsFromElementOrRanges=function(ranges,element){var selectedCells=getCellsFromElement(element);var rangeCells=getCellsFromRanges(ranges);return selectedCells.length>0?selectedCells:rangeCells};var getCellsFromEditor=function(editor){return getCellsFromElementOrRanges(MultiRange.getRanges(editor.selection.getSel()),Element.fromDom(editor.getBody()))};return{getCellsFromRanges:getCellsFromRanges,getCellsFromElement:getCellsFromElement,getCellsFromElementOrRanges:getCellsFromElementOrRanges,getCellsFromEditor:getCellsFromEditor}});define("tinymce.core.delete.TableDelete",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteElement","tinymce.core.delete.TableDeleteAction","tinymce.core.dom.ElementType","tinymce.core.dom.Empty","tinymce.core.dom.PaddingBr","tinymce.core.dom.Parents","tinymce.core.selection.TableCellSelection"],function(Arr,Fun,Option,Compare,Element,Node,CaretFinder,CaretPosition,DeleteElement,TableDeleteAction,ElementType,Empty,PaddingBr,Parents,TableCellSelection){var emptyCells=function(editor,cells){Arr.each(cells,PaddingBr.fillWithPaddingBr);editor.selection.setCursorLocation(cells[0].dom(),0);return true};var deleteTableElement=function(editor,table){DeleteElement.deleteElement(editor,false,table);return true};var deleteCellRange=function(editor,rootElm,rng){return TableDeleteAction.getActionFromRange(rootElm,rng).map(function(action){return action.fold(Fun.curry(deleteTableElement,editor),Fun.curry(emptyCells,editor))})};var deleteCaptionRange=function(editor,caption){return emptyElement(editor,caption)};var deleteTableRange=function(editor,rootElm,rng,startElm){return getParentCaption(rootElm,startElm).fold(function(){return deleteCellRange(editor,rootElm,rng)},function(caption){return deleteCaptionRange(editor,caption)}).getOr(false)};var deleteRange=function(editor,startElm){var rootNode=Element.fromDom(editor.getBody());var rng=editor.selection.getRng();var selectedCells=TableCellSelection.getCellsFromEditor(editor);return selectedCells.length!==0?emptyCells(editor,selectedCells):deleteTableRange(editor,rootNode,rng,startElm)};var getParentCell=function(rootElm,elm){return Arr.find(Parents.parentsAndSelf(elm,rootElm),ElementType.isTableCell)};var getParentCaption=function(rootElm,elm){return Arr.find(Parents.parentsAndSelf(elm,rootElm),function(elm){return Node.name(elm)==="caption"})};var deleteBetweenCells=function(editor,rootElm,forward,fromCell,from){return CaretFinder.navigate(forward,editor.getBody(),from).bind(function(to){return getParentCell(rootElm,Element.fromDom(to.getNode())).map(function(toCell){return Compare.eq(toCell,fromCell)===false})})};var emptyElement=function(editor,elm){PaddingBr.fillWithPaddingBr(elm);editor.selection.setCursorLocation(elm.dom(),0);return Option.some(true)};var isDeleteOfLastCharPos=function(fromCaption,forward,from,to){return CaretFinder.firstPositionIn(fromCaption.dom()).bind(function(first){return CaretFinder.lastPositionIn(fromCaption.dom()).map(function(last){return forward?from.isEqual(first)&&to.isEqual(last):from.isEqual(last)&&to.isEqual(first)})}).getOr(true)};var emptyCaretCaption=function(editor,elm){return emptyElement(editor,elm)};var validateCaretCaption=function(rootElm,fromCaption,to){return getParentCaption(rootElm,Element.fromDom(to.getNode())).map(function(toCaption){return Compare.eq(toCaption,fromCaption)===false})};var deleteCaretInsideCaption=function(editor,rootElm,forward,fromCaption,from){return CaretFinder.navigate(forward,editor.getBody(),from).bind(function(to){return isDeleteOfLastCharPos(fromCaption,forward,from,to)?emptyCaretCaption(editor,fromCaption):validateCaretCaption(rootElm,fromCaption,to)}).or(Option.some(true))};var deleteCaretCells=function(editor,forward,rootElm,startElm){var from=CaretPosition.fromRangeStart(editor.selection.getRng());return getParentCell(rootElm,startElm).bind(function(fromCell){return Empty.isEmpty(fromCell)?emptyElement(editor,fromCell):deleteBetweenCells(editor,rootElm,forward,fromCell,from)})};var deleteCaretCaption=function(editor,forward,rootElm,fromCaption){var from=CaretPosition.fromRangeStart(editor.selection.getRng());return Empty.isEmpty(fromCaption)?emptyElement(editor,fromCaption):deleteCaretInsideCaption(editor,rootElm,forward,fromCaption,from)};var deleteCaret=function(editor,forward,startElm){var rootElm=Element.fromDom(editor.getBody());return getParentCaption(rootElm,startElm).fold(function(){return deleteCaretCells(editor,forward,rootElm,startElm)},function(fromCaption){return deleteCaretCaption(editor,forward,rootElm,fromCaption)}).getOr(false)};var backspaceDelete=function(editor,forward){var startElm=Element.fromDom(editor.selection.getStart(true));return editor.selection.isCollapsed()?deleteCaret(editor,forward,startElm):deleteRange(editor,startElm)};return{backspaceDelete:backspaceDelete}});define("tinymce.core.delete.DeleteCommands",["tinymce.core.delete.BlockBoundaryDelete","tinymce.core.delete.BlockRangeDelete","tinymce.core.delete.CefDelete","tinymce.core.delete.DeleteUtils","tinymce.core.delete.InlineBoundaryDelete","tinymce.core.delete.TableDelete"],function(BlockBoundaryDelete,BlockRangeDelete,CefDelete,DeleteUtils,BoundaryDelete,TableDelete){var nativeCommand=function(editor,command){editor.getDoc().execCommand(command,false,null)};var deleteCommand=function(editor){if(CefDelete.backspaceDelete(editor,false)){return}else if(BoundaryDelete.backspaceDelete(editor,false)){return}else if(BlockBoundaryDelete.backspaceDelete(editor,false)){return}else if(TableDelete.backspaceDelete(editor)){return}else if(BlockRangeDelete.backspaceDelete(editor,false)){return}else{nativeCommand(editor,"Delete");DeleteUtils.paddEmptyBody(editor)}};var forwardDeleteCommand=function(editor){if(CefDelete.backspaceDelete(editor,true)){return}else if(BoundaryDelete.backspaceDelete(editor,true)){return}else if(BlockBoundaryDelete.backspaceDelete(editor,true)){return}else if(TableDelete.backspaceDelete(editor)){return}else if(BlockRangeDelete.backspaceDelete(editor,true)){return}else{nativeCommand(editor,"ForwardDelete")}};return{deleteCommand:deleteCommand,forwardDeleteCommand:forwardDeleteCommand}});define("tinymce.core.selection.RangeCompare",[],function(){var isEq=function(rng1,rng2){return rng1&&rng2&&(rng1.startContainer===rng2.startContainer&&rng1.startOffset===rng2.startOffset)&&(rng1.endContainer===rng2.endContainer&&rng1.endOffset===rng2.endOffset)};return{isEq:isEq}});define("tinymce.core.selection.NormalizeRange",["ephox.katamari.api.Option","ephox.katamari.api.Struct","tinymce.core.caret.CaretContainer","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.fmt.CaretFormat","tinymce.core.selection.RangeCompare"],function(Option,Struct,CaretContainer,NodeType,TreeWalker,CaretFormat,RangeCompare){var position=Struct.immutable("container","offset");var findParent=function(node,rootNode,predicate){while(node&&node!==rootNode){if(predicate(node)){return node}node=node.parentNode}return null};var hasParent=function(node,rootNode,predicate){return findParent(node,rootNode,predicate)!==null};var hasParentWithName=function(node,rootNode,name){return hasParent(node,rootNode,function(node){return node.nodeName===name})};var isTable=function(node){return node&&node.nodeName==="TABLE"};var isTableCell=function(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)};var isCeFalseCaretContainer=function(node,rootNode){return CaretContainer.isCaretContainer(node)&&hasParent(node,rootNode,CaretFormat.isCaretNode)===false};var hasBrBeforeAfter=function(dom,node,left){var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||dom.getRoot());while(node=walker[left?"prev":"next"]()){if(NodeType.isBr(node)){return true}}};var isPrevNode=function(node,name){return node.previousSibling&&node.previousSibling.nodeName===name};var hasContentEditableFalseParent=function(body,node){while(node&&node!==body){if(NodeType.isContentEditableFalse(node)){return true}node=node.parentNode}return false};var findTextNodeRelative=function(dom,isAfterNode,collapsed,left,startNode){var walker,lastInlineElement,parentBlockContainer,body=dom.getRoot(),node;var nonEmptyElementsMap=dom.schema.getNonEmptyElements();parentBlockContainer=dom.getParent(startNode.parentNode,dom.isBlock)||body;if(left&&NodeType.isBr(startNode)&&isAfterNode&&dom.isEmpty(parentBlockContainer)){return Option.some(position(startNode.parentNode,dom.nodeIndex(startNode)))}walker=new TreeWalker(startNode,parentBlockContainer);while(node=walker[left?"prev":"next"]()){if(dom.getContentEditableParent(node)==="false"||isCeFalseCaretContainer(node,body)){return Option.none()}if(NodeType.isText(node)&&node.nodeValue.length>0){if(hasParentWithName(node,body,"A")===false){return Option.some(position(node,left?node.nodeValue.length:0))}return Option.none()}if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()]){return Option.none()}lastInlineElement=node}if(collapsed&&lastInlineElement){return Option.some(position(lastInlineElement,0))}return Option.none()};var normalizeEndPoint=function(dom,collapsed,start,rng){var container,offset,walker,body=dom.getRoot(),node,nonEmptyElementsMap;var directionLeft,isAfterNode,normalized=false;container=rng[(start?"start":"end")+"Container"];offset=rng[(start?"start":"end")+"Offset"];isAfterNode=NodeType.isElement(container)&&offset===container.childNodes.length;nonEmptyElementsMap=dom.schema.getNonEmptyElements();directionLeft=start;if(CaretContainer.isCaretContainer(container)){return Option.none()}if(NodeType.isElement(container)&&offset>container.childNodes.length-1){directionLeft=false}if(NodeType.isDocument(container)){container=body;offset=0}if(container===body){if(directionLeft){node=container.childNodes[offset>0?offset-1:0];if(node){if(CaretContainer.isCaretContainer(node)){return Option.none()}if(nonEmptyElementsMap[node.nodeName]||isTable(node)){return Option.none()}}}if(container.hasChildNodes()){offset=Math.min(!directionLeft&&offset>0?offset-1:offset,container.childNodes.length-1);container=container.childNodes[offset];offset=NodeType.isText(container)&&isAfterNode?container.data.length:0;if(!collapsed&&container===body.lastChild&&isTable(container)){return Option.none()}if(hasContentEditableFalseParent(body,container)||CaretContainer.isCaretContainer(container)){return Option.none()}if(container.hasChildNodes()&&isTable(container)===false){node=container;walker=new TreeWalker(container,body);do{if(NodeType.isContentEditableFalse(node)||CaretContainer.isCaretContainer(node)){normalized=false;break}if(NodeType.isText(node)&&node.nodeValue.length>0){offset=directionLeft?0:node.nodeValue.length;container=node;normalized=true;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]&&!isTableCell(node)){offset=dom.nodeIndex(node);container=node.parentNode;if((node.nodeName==="IMG"||node.nodeName==="PRE")&&!directionLeft){offset++}normalized=true;break}}while(node=directionLeft?walker.next():walker.prev())}}}if(collapsed){if(NodeType.isText(container)&&offset===0){findTextNodeRelative(dom,isAfterNode,collapsed,true,container).each(function(pos){container=pos.container();offset=pos.offset();normalized=true})}if(NodeType.isElement(container)){node=container.childNodes[offset];if(!node){node=container.childNodes[offset-1]}if(node&&NodeType.isBr(node)&&!isPrevNode(node,"A")&&!hasBrBeforeAfter(dom,node,false)&&!hasBrBeforeAfter(dom,node,true)){findTextNodeRelative(dom,isAfterNode,collapsed,true,node).each(function(pos){container=pos.container();offset=pos.offset();normalized=true})}}}if(directionLeft&&!collapsed&&NodeType.isText(container)&&offset===container.nodeValue.length){findTextNodeRelative(dom,isAfterNode,collapsed,false,container).each(function(pos){container=pos.container();offset=pos.offset();normalized=true})}return normalized?Option.some(position(container,offset)):Option.none()};var normalize=function(dom,rng){var collapsed=rng.collapsed,normRng=rng.cloneRange();normalizeEndPoint(dom,collapsed,true,normRng).each(function(pos){normRng.setStart(pos.container(),pos.offset())});if(!collapsed){normalizeEndPoint(dom,collapsed,false,normRng).each(function(pos){normRng.setEnd(pos.container(),pos.offset())})}if(collapsed){normRng.collapse(true)}return RangeCompare.isEq(rng,normRng)?Option.none():Option.some(normRng)};return{normalize:normalize}});define("tinymce.core.newline.InsertBr",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Insert","ephox.sugar.api.node.Element","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.InlineUtils","tinymce.core.selection.NormalizeRange"],function(Fun,Insert,Element,CaretFinder,CaretPosition,NodeType,TreeWalker,BoundaryLocation,InlineUtils,NormalizeRange){var hasRightSideContent=function(schema,container,parentBlock){var walker=new TreeWalker(container,parentBlock),node;var nonEmptyElementsMap=schema.getNonEmptyElements();while(node=walker.next()){if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||node.length>0){return true}}};var scrollToBr=function(dom,selection,brElm){var marker=dom.create("span",{},"&nbsp;");brElm.parentNode.insertBefore(marker,brElm);selection.scrollIntoView(marker);dom.remove(marker)};var moveSelectionToBr=function(dom,selection,brElm,extraBr){var rng=dom.createRng();if(!extraBr){rng.setStartAfter(brElm);rng.setEndAfter(brElm)}else{rng.setStartBefore(brElm);rng.setEndBefore(brElm)}selection.setRng(rng)};var insertBrAtCaret=function(editor,evt){var selection=editor.selection,dom=editor.dom;var brElm,extraBr;var rng=selection.getRng(true);NormalizeRange.normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset);rng.setEnd(normRng.endContainer,normRng.endOffset)});var offset=rng.startOffset;var container=rng.startContainer;if(container.nodeType===1&&container.hasChildNodes()){var isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&container.nodeType===3){offset=container.nodeValue.length}else{offset=0}}var parentBlock=dom.getParent(container,dom.isBlock);var containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null;var containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"";var isControlKey=evt&&evt.ctrlKey;if(containerBlockName==="LI"&&!isControlKey){parentBlock=containerBlock}if(container&&container.nodeType===3&&offset>=container.nodeValue.length){if(!hasRightSideContent(editor.schema,container,parentBlock)){brElm=dom.create("br");rng.insertNode(brElm);rng.setStartAfter(brElm);rng.setEndAfter(brElm);extraBr=true}}brElm=dom.create("br");rng.insertNode(brElm);scrollToBr(dom,selection,brElm);moveSelectionToBr(dom,selection,brElm,extraBr);editor.undoManager.add()};var insertBrBefore=function(editor,inline){var br=Element.fromTag("br");Insert.before(Element.fromDom(inline),br);editor.undoManager.add()};var insertBrAfter=function(editor,inline){if(!hasBrAfter(editor.getBody(),inline)){Insert.after(Element.fromDom(inline),Element.fromTag("br"))}var br=Element.fromTag("br");Insert.after(Element.fromDom(inline),br);scrollToBr(editor.dom,editor.selection,br.dom());moveSelectionToBr(editor.dom,editor.selection,br.dom(),false);editor.undoManager.add()};var isBeforeBr=function(pos){return NodeType.isBr(pos.getNode())};var hasBrAfter=function(rootNode,startNode){if(isBeforeBr(CaretPosition.after(startNode))){return true}else{return CaretFinder.nextPosition(rootNode,CaretPosition.after(startNode)).map(function(pos){return NodeType.isBr(pos.getNode())}).getOr(false)}};var isAnchorLink=function(elm){return elm&&elm.nodeName==="A"&&"href"in elm};var isInsideAnchor=function(location){return location.fold(Fun.constant(false),isAnchorLink,isAnchorLink,Fun.constant(false))};var readInlineAnchorLocation=function(editor){var isInlineTarget=Fun.curry(InlineUtils.isInlineTarget,editor);var position=CaretPosition.fromRangeStart(editor.selection.getRng());return BoundaryLocation.readLocation(isInlineTarget,editor.getBody(),position).filter(isInsideAnchor)};var insertBrOutsideAnchor=function(editor,location){location.fold(Fun.noop,Fun.curry(insertBrBefore,editor),Fun.curry(insertBrAfter,editor),Fun.noop)};var insert=function(editor,evt){var anchorLocation=readInlineAnchorLocation(editor);if(anchorLocation.isSome()){anchorLocation.each(Fun.curry(insertBrOutsideAnchor,editor))}else{insertBrAtCaret(editor,evt)}};return{insert:insert}});define("ephox.sugar.api.selection.Situ",["ephox.katamari.api.Adt","ephox.katamari.api.Fun"],function(Adt,Fun){var adt=Adt.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]);var cata=function(subject,onBefore,onOn,onAfter){return subject.fold(onBefore,onOn,onAfter)};var getStart=function(situ){return situ.fold(Fun.identity,Fun.identity,Fun.identity)};return{before:adt.before,on:adt.on,after:adt.after,cata:cata,getStart:getStart}});define("ephox.sugar.api.selection.Selection",["ephox.katamari.api.Adt","ephox.katamari.api.Struct","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Situ"],function(Adt,Struct,Element,Traverse,Situ){var type=Adt.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]);var range=Struct.immutable("start","soffset","finish","foffset");var exactFromRange=function(simRange){return type.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())};var getStart=function(selection){return selection.match({domRange:function(rng){return Element.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return Situ.getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})};var getWin=function(selection){var start=getStart(selection);return Traverse.defaultView(start)};return{domRange:type.domRange,relative:type.relative,exact:type.exact,exactFromRange:exactFromRange,range:range,getWin:getWin}});define("tinymce.core.selection.SelectionBookmark",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sand.api.PlatformDetection","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","global!document"],function(Fun,Option,PlatformDetection,Compare,Element,Node,Text,Traverse,Selection,document){var browser=PlatformDetection.detect().browser;var clamp=function(offset,element){var max=Node.isText(element)?Text.get(element).length:Traverse.children(element).length+1;if(offset>max){return max}else if(offset<0){return 0}return offset};var normalizeRng=function(rng){return Selection.range(rng.start(),clamp(rng.soffset(),rng.start()),rng.finish(),clamp(rng.foffset(),rng.finish()))};var isOrContains=function(root,elm){return Compare.contains(root,elm)||Compare.eq(root,elm)};var isRngInRoot=function(root){return function(rng){return isOrContains(root,rng.start())&&isOrContains(root,rng.finish())}};var shouldStore=function(editor){return editor.inline===true||browser.isIE()};var nativeRangeToSelectionRange=function(r){return Selection.range(Element.fromDom(r.startContainer),r.startOffset,Element.fromDom(r.endContainer),r.endOffset)};var readRange=function(win){var selection=win.getSelection();var rng=!selection||selection.rangeCount===0?Option.none():Option.from(selection.getRangeAt(0));return rng.map(nativeRangeToSelectionRange)};var getBookmark=function(root){var win=Traverse.defaultView(root);return readRange(win.dom()).filter(isRngInRoot(root))};var validate=function(root,bookmark){return Option.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng)};var bookmarkToNativeRng=function(bookmark){var rng=document.createRange();rng.setStart(bookmark.start().dom(),bookmark.soffset());rng.setEnd(bookmark.finish().dom(),bookmark.foffset());return Option.some(rng)};var store=function(editor){var newBookmark=shouldStore(editor)?getBookmark(Element.fromDom(editor.getBody())):Option.none();editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark};var storeNative=function(editor,rng){var root=Element.fromDom(editor.getBody());var range=shouldStore(editor)?Option.from(rng):Option.none();var newBookmark=range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark};var getRng=function(editor){var bookmark=editor.bookmark?editor.bookmark:Option.none();return bookmark.bind(Fun.curry(validate,Element.fromDom(editor.getBody()))).bind(bookmarkToNativeRng)};var restore=function(editor){getRng(editor).each(function(rng){editor.selection.setRng(rng)})};return{store:store,storeNative:storeNative,readRange:readRange,restore:restore,getRng:getRng,getBookmark:getBookmark,validate:validate}});define("tinymce.core.EditorCommands",["tinymce.core.Env","tinymce.core.InsertContent","tinymce.core.delete.DeleteCommands","tinymce.core.dom.NodeType","tinymce.core.newline.InsertBr","tinymce.core.selection.SelectionBookmark","tinymce.core.util.Tools"],function(Env,InsertContent,DeleteCommands,NodeType,InsertBr,SelectionBookmark,Tools){var each=Tools.each,extend=Tools.extend;var map=Tools.map,inArray=Tools.inArray,explode=Tools.explode;var TRUE=true,FALSE=false;return function(editor){var dom,selection,formatter,commands={state:{},exec:{},value:{}},settings=editor.settings,bookmark;editor.on("PreInit",function(){dom=editor.dom;selection=editor.selection;settings=editor.settings;formatter=editor.formatter});var execCommand=function(command,ui,value,args){var func,customCommand,state=0;if(editor.removed){return}if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command)&&(!args||!args.skip_focus)){editor.focus()}else{SelectionBookmark.restore(editor)}args=editor.fire("BeforeExecCommand",{command:command,ui:ui,value:value});if(args.isDefaultPrevented()){return false}customCommand=command.toLowerCase();if(func=commands.exec[customCommand]){func(customCommand,ui,value);editor.fire("ExecCommand",{command:command,ui:ui,value:value});return true}each(editor.plugins,function(p){if(p.execCommand&&p.execCommand(command,ui,value)){editor.fire("ExecCommand",{command:command,ui:ui,value:value});state=true;return false}});if(state){return state}if(editor.theme&&editor.theme.execCommand&&editor.theme.execCommand(command,ui,value)){editor.fire("ExecCommand",{command:command,ui:ui,value:value});return true}try{state=editor.getDoc().execCommand(command,ui,value)}catch(ex){}if(state){editor.fire("ExecCommand",{command:command,ui:ui,value:value});return true}return false};var queryCommandState=function(command){var func;if(editor.quirks.isHidden()||editor.removed){return}command=command.toLowerCase();if(func=commands.state[command]){return func(command)}try{return editor.getDoc().queryCommandState(command)}catch(ex){}return false};var queryCommandValue=function(command){var func;if(editor.quirks.isHidden()||editor.removed){return}command=command.toLowerCase();if(func=commands.value[command]){return func(command)}try{return editor.getDoc().queryCommandValue(command)}catch(ex){}};var addCommands=function(commandList,type){type=type||"exec";each(commandList,function(callback,command){each(command.toLowerCase().split(","),function(command){commands[type][command]=callback})})};var addCommand=function(command,callback,scope){command=command.toLowerCase();commands.exec[command]=function(command,ui,value,args){return callback.call(scope||editor,ui,value,args)}};var queryCommandSupported=function(command){command=command.toLowerCase();if(commands.exec[command]){return true}try{return editor.getDoc().queryCommandSupported(command)}catch(ex){}return false};var addQueryStateHandler=function(command,callback,scope){command=command.toLowerCase();commands.state[command]=function(){return callback.call(scope||editor)}};var addQueryValueHandler=function(command,callback,scope){command=command.toLowerCase();commands.value[command]=function(){return callback.call(scope||editor)}};var hasCustomCommand=function(command){command=command.toLowerCase();return!!commands.exec[command]};extend(this,{execCommand:execCommand,queryCommandState:queryCommandState,queryCommandValue:queryCommandValue,queryCommandSupported:queryCommandSupported,addCommands:addCommands,addCommand:addCommand,addQueryStateHandler:addQueryStateHandler,addQueryValueHandler:addQueryValueHandler,hasCustomCommand:hasCustomCommand});var execNativeCommand=function(command,ui,value){if(ui===undefined){ui=FALSE}if(value===undefined){value=null}return editor.getDoc().execCommand(command,ui,value)};var isFormatMatch=function(name){return formatter.match(name)};var toggleFormat=function(name,value){formatter.toggle(name,value?{value:value}:undefined);editor.nodeChanged()};var storeSelection=function(type){bookmark=selection.getBookmark(type)};var restoreSelection=function(){selection.moveToBookmark(bookmark)};addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},"Cut,Copy,Paste":function(command){var doc=editor.getDoc(),failed;try{execNativeCommand(command)}catch(ex){failed=TRUE}if(command==="paste"&&!doc.queryCommandEnabled(command)){failed=true}if(failed||!doc.queryCommandSupported(command)){var msg=editor.translate("Your browser doesn't support direct access to the clipboard. "+"Please use the Ctrl+X/C/V keyboard shortcuts instead.");if(Env.mac){msg=msg.replace(/Ctrl\+/g,"‚åò+")}editor.notificationManager.open({text:msg,type:"error"})}},unlink:function(){if(selection.isCollapsed()){var elm=editor.dom.getParent(editor.selection.getStart(),"a");if(elm){editor.dom.remove(elm,true)}return}formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(command){var align=command.substring(7);if(align=="full"){align="justify"}each("left,center,right,justify".split(","),function(name){if(align!=name){formatter.remove("align"+name)}});if(align!="none"){toggleFormat("align"+align)}},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;execNativeCommand(command);listElm=dom.getParent(selection.getNode(),"ol,ul");if(listElm){listParent=listElm.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)){storeSelection();dom.split(listParent,listElm);restoreSelection()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){toggleFormat(command)},"ForeColor,HiliteColor,FontName":function(command,ui,value){toggleFormat(command,value)},FontSize:function(command,ui,value){var fontClasses,fontSizes;if(value>=1&&value<=7){fontSizes=explode(settings.font_size_style_values);fontClasses=explode(settings.font_size_classes);if(fontClasses){value=fontClasses[value-1]||value}else{value=fontSizes[value-1]||value}}toggleFormat(command,value)},RemoveFormat:function(command){formatter.remove(command)},mceBlockQuote:function(){toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return toggleFormat(value||"p")},mceCleanup:function(){var bookmark=selection.getBookmark();editor.setContent(editor.getContent({cleanup:TRUE}),{cleanup:TRUE});selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,value){var node=value||selection.getNode();if(node!=editor.getBody()){storeSelection();editor.dom.remove(node,TRUE);restoreSelection()}},mceSelectNodeDepth:function(command,ui,value){var counter=0;dom.getParent(selection.getNode(),function(node){if(node.nodeType==1&&counter++==value){selection.select(node);return FALSE}},editor.getBody())},mceSelectNode:function(command,ui,value){selection.select(value)},mceInsertContent:function(command,ui,value){InsertContent.insertAtCaret(editor,value)},mceInsertRawHTML:function(command,ui,value){selection.setContent("tiny_mce_marker");editor.setContent(editor.getContent().replace(/tiny_mce_marker/g,function(){return value}))},mceToggleFormat:function(command,ui,value){toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){var intentValue,indentUnit,value;intentValue=settings.indentation;indentUnit=/[a-z%]+$/i.exec(intentValue);intentValue=parseInt(intentValue,10);if(!queryCommandState("InsertUnorderedList")&&!queryCommandState("InsertOrderedList")){if(!settings.forced_root_block&&!dom.getParent(selection.getNode(),dom.isBlock)){formatter.apply("div")}each(selection.getSelectedBlocks(),function(element){if(dom.getContentEditable(element)==="false"){return}if(element.nodeName!=="LI"){var indentStyleName=editor.getParam("indent_use_margin",false)?"margin":"padding";indentStyleName=element.nodeName==="TABLE"?"margin":indentStyleName;indentStyleName+=dom.getStyle(element,"direction",true)=="rtl"?"Right":"Left";if(command=="outdent"){value=Math.max(0,parseInt(element.style[indentStyleName]||0,10)-intentValue);dom.setStyle(element,indentStyleName,value?value+indentUnit:"")}else{value=parseInt(element.style[indentStyleName]||0,10)+intentValue+indentUnit;dom.setStyle(element,indentStyleName,value)}}})}else{execNativeCommand(command)}},mceRepaint:function(){},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual;editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",false,value.replace(/\{\$selection\}/g,selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;if(typeof value=="string"){value={href:value}}anchor=dom.getParent(selection.getNode(),"a");value.href=value.href.replace(" ","%20");if(!anchor||!value.href){formatter.remove("link")}if(value.href){formatter.apply("link",value,anchor)}},selectAll:function(){var editingHost=dom.getParent(selection.getStart(),NodeType.isContentEditableTrue);if(editingHost){var rng=dom.createRng();rng.selectNodeContents(editingHost);selection.setRng(rng)}},delete:function(){DeleteCommands.deleteCommand(editor)},forwardDelete:function(){DeleteCommands.forwardDeleteCommand(editor)},mceNewDocument:function(){editor.setContent("")},InsertLineBreak:function(command,ui,value){InsertBr.insert(editor,value);return true}});addCommands({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var name="align"+command.substring(7);var nodes=selection.isCollapsed()?[dom.getParent(selection.getNode(),dom.isBlock)]:selection.getSelectedBlocks();var matches=map(nodes,function(node){return!!formatter.matchNode(node,name)});return inArray(matches,TRUE)!==-1},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return isFormatMatch(command)},mceBlockQuote:function(){return isFormatMatch("blockquote")},Outdent:function(){var node;if(settings.inline_styles){if((node=dom.getParent(selection.getStart(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0){return TRUE}if((node=dom.getParent(selection.getEnd(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0){return TRUE}}return queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")||!settings.inline_styles&&!!dom.getParent(selection.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(command){var list=dom.getParent(selection.getNode(),"ul,ol");return list&&(command==="insertunorderedlist"&&list.tagName==="UL"||command==="insertorderedlist"&&list.tagName==="OL")}},"state");addCommands({"FontSize,FontName":function(command){var value=0,parent;if(parent=dom.getParent(selection.getNode(),"span")){if(command=="fontsize"){value=parent.style.fontSize}else{value=parent.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()}}return value}},"value");addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}})}});define("tinymce.core.util.EventDispatcher",["tinymce.core.util.Tools"],function(Tools){var nativeEvents=Tools.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange "+"mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover "+"draggesture dragdrop drop drag submit "+"compositionstart compositionend compositionupdate touchstart touchmove touchend"," ");var Dispatcher=function(settings){var self=this,scope,bindings={},toggleEvent;var returnFalse=function(){return false};var returnTrue=function(){return true};settings=settings||{};scope=settings.scope||self;toggleEvent=settings.toggleEvent||returnFalse;var fire=function(name,args){var handlers,i,l,callback;name=name.toLowerCase();args=args||{};args.type=name;if(!args.target){args.target=scope}if(!args.preventDefault){args.preventDefault=function(){args.isDefaultPrevented=returnTrue};args.stopPropagation=function(){args.isPropagationStopped=returnTrue};args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=returnTrue};args.isDefaultPrevented=returnFalse;args.isPropagationStopped=returnFalse;args.isImmediatePropagationStopped=returnFalse}if(settings.beforeFire){settings.beforeFire(args)}handlers=bindings[name];if(handlers){for(i=0,l=handlers.length;i<l;i++){callback=handlers[i];if(callback.once){off(name,callback.func)}if(args.isImmediatePropagationStopped()){args.stopPropagation();return args}if(callback.func.call(scope,args)===false){args.preventDefault();return args}}}return args};var on=function(name,callback,prepend,extra){var handlers,names,i;if(callback===false){callback=returnFalse}if(callback){callback={func:callback};if(extra){Tools.extend(callback,extra)}names=name.toLowerCase().split(" ");i=names.length;while(i--){name=names[i];handlers=bindings[name];if(!handlers){handlers=bindings[name]=[];toggleEvent(name,true)}if(prepend){handlers.unshift(callback)}else{handlers.push(callback)}}}return self};var off=function(name,callback){var i,handlers,bindingName,names,hi;if(name){names=name.toLowerCase().split(" ");i=names.length;while(i--){name=names[i];handlers=bindings[name];if(!name){for(bindingName in bindings){toggleEvent(bindingName,false);delete bindings[bindingName]}return self}if(handlers){if(!callback){handlers.length=0}else{hi=handlers.length;while(hi--){if(handlers[hi].func===callback){handlers=handlers.slice(0,hi).concat(handlers.slice(hi+1));bindings[name]=handlers}}}if(!handlers.length){toggleEvent(name,false);delete bindings[name]}}}}else{for(name in bindings){toggleEvent(name,false)}bindings={}}return self};var once=function(name,callback,prepend){return on(name,callback,prepend,{once:true})};var has=function(name){name=name.toLowerCase();return!(!bindings[name]||bindings[name].length===0)};self.fire=fire;self.on=on;self.off=off;self.once=once;self.has=has};Dispatcher.isNative=function(name){return!!nativeEvents[name.toLowerCase()]};return Dispatcher});define("tinymce.core.util.Observable",["tinymce.core.util.EventDispatcher"],function(EventDispatcher){var getEventDispatcher=function(obj){if(!obj._eventDispatcher){obj._eventDispatcher=new EventDispatcher({scope:obj,toggleEvent:function(name,state){if(EventDispatcher.isNative(name)&&obj.toggleNativeEvent){obj.toggleNativeEvent(name,state)}}})}return obj._eventDispatcher};return{fire:function(name,args,bubble){var self=this;if(self.removed&&name!=="remove"){return args}args=getEventDispatcher(self).fire(name,args,bubble);if(bubble!==false&&self.parent){var parent=self.parent();while(parent&&!args.isPropagationStopped()){parent.fire(name,args,false);parent=parent.parent()}}return args},on:function(name,callback,prepend){return getEventDispatcher(this).on(name,callback,prepend)},off:function(name,callback){return getEventDispatcher(this).off(name,callback)},once:function(name,callback){return getEventDispatcher(this).once(name,callback)},hasEventListeners:function(name){return getEventDispatcher(this).has(name)}}});define("tinymce.core.EditorObservable",["tinymce.core.util.Observable","tinymce.core.dom.DOMUtils","tinymce.core.util.Tools"],function(Observable,DOMUtils,Tools){var DOM=DOMUtils.DOM,customEventRootDelegates;var getEventTarget=function(editor,eventName){if(eventName=="selectionchange"){return editor.getDoc()}if(!editor.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)){return editor.getDoc().documentElement}if(editor.settings.event_root){if(!editor.eventRoot){editor.eventRoot=DOM.select(editor.settings.event_root)[0]}return editor.eventRoot}return editor.getBody()};var bindEventDelegate=function(editor,eventName){var eventRootElm,delegate;var isListening=function(editor){return!editor.hidden&&!editor.readonly};if(!editor.delegates){editor.delegates={}}if(editor.delegates[eventName]||editor.removed){return}eventRootElm=getEventTarget(editor,eventName);if(editor.settings.event_root){if(!customEventRootDelegates){customEventRootDelegates={};editor.editorManager.on("removeEditor",function(){var name;if(!editor.editorManager.activeEditor){if(customEventRootDelegates){for(name in customEventRootDelegates){editor.dom.unbind(getEventTarget(editor,name))}customEventRootDelegates=null}}})}if(customEventRootDelegates[eventName]){return}delegate=function(e){var target=e.target,editors=editor.editorManager.get(),i=editors.length;while(i--){var body=editors[i].getBody();if(body===target||DOM.isChildOf(target,body)){if(isListening(editors[i])){editors[i].fire(eventName,e)}}}};customEventRootDelegates[eventName]=delegate;DOM.bind(eventRootElm,eventName,delegate)}else{delegate=function(e){if(isListening(editor)){editor.fire(eventName,e)}};DOM.bind(eventRootElm,eventName,delegate);editor.delegates[eventName]=delegate}};var EditorObservable={bindPendingEventDelegates:function(){var self=this;Tools.each(self._pendingNativeEvents,function(name){bindEventDelegate(self,name)})},toggleNativeEvent:function(name,state){var self=this;if(name=="focus"||name=="blur"){return}if(state){if(self.initialized){bindEventDelegate(self,name)}else{if(!self._pendingNativeEvents){self._pendingNativeEvents=[name]}else{self._pendingNativeEvents.push(name)}}}else if(self.initialized){self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]);delete self.delegates[name]}},unbindAllNativeEvents:function(){var self=this,name;if(self.delegates){for(name in self.delegates){self.dom.unbind(getEventTarget(self,name),name,self.delegates[name])}delete self.delegates}if(!self.inline){self.getBody().onload=null;self.dom.unbind(self.getWin());self.dom.unbind(self.getDoc())}self.dom.unbind(self.getBody());self.dom.unbind(self.getContainer())}};EditorObservable=Tools.extend({},Observable,EditorObservable);return EditorObservable});define("tinymce.core.Mode",[],function(){var setEditorCommandState=function(editor,cmd,state){try{editor.getDoc().execCommand(cmd,false,state)}catch(ex){}};var clickBlocker=function(editor){var target,handler;target=editor.getBody();handler=function(e){if(editor.dom.getParents(e.target,"a").length>0){e.preventDefault()}};editor.dom.bind(target,"click",handler);return{unbind:function(){editor.dom.unbind(target,"click",handler)}}};var toggleReadOnly=function(editor,state){if(editor._clickBlocker){editor._clickBlocker.unbind();editor._clickBlocker=null}if(state){editor._clickBlocker=clickBlocker(editor);editor.selection.controlSelection.hideResizeRect();editor.readonly=true;editor.getBody().contentEditable=false}else{editor.readonly=false;editor.getBody().contentEditable=true;setEditorCommandState(editor,"StyleWithCSS",false);setEditorCommandState(editor,"enableInlineTableEditing",false);setEditorCommandState(editor,"enableObjectResizing",false);editor.focus();editor.nodeChanged()}};var setMode=function(editor,mode){var currentMode=editor.readonly?"readonly":"design";if(mode==currentMode){return}if(editor.initialized){toggleReadOnly(editor,mode=="readonly")}else{editor.on("init",function(){toggleReadOnly(editor,mode=="readonly")})}editor.fire("SwitchMode",{mode:mode})};return{setMode:setMode}});define("tinymce.core.Shortcuts",["tinymce.core.util.Tools","tinymce.core.Env"],function(Tools,Env){var each=Tools.each,explode=Tools.explode;var keyCodeLookup={f9:120,f10:121,f11:122};var modifierNames=Tools.makeMap("alt,ctrl,shift,meta,access");return function(editor){var self=this,shortcuts={},pendingPatterns=[];var parseShortcut=function(pattern){var id,key,shortcut={};each(explode(pattern,"+"),function(value){if(value in modifierNames){shortcut[value]=true}else{if(/^[0-9]{2,}$/.test(value)){shortcut.keyCode=parseInt(value,10)}else{shortcut.charCode=value.charCodeAt(0);shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0)}}});id=[shortcut.keyCode];for(key in modifierNames){if(shortcut[key]){id.push(key)}else{shortcut[key]=false}}shortcut.id=id.join(",");if(shortcut.access){shortcut.alt=true;if(Env.mac){shortcut.ctrl=true}else{shortcut.shift=true}}if(shortcut.meta){if(Env.mac){shortcut.meta=true}else{shortcut.ctrl=true;shortcut.meta=false}}return shortcut};var createShortcut=function(pattern,desc,cmdFunc,scope){var shortcuts;shortcuts=Tools.map(explode(pattern,">"),parseShortcut);shortcuts[shortcuts.length-1]=Tools.extend(shortcuts[shortcuts.length-1],{func:cmdFunc,scope:scope||editor});return Tools.extend(shortcuts[0],{desc:editor.translate(desc),subpatterns:shortcuts.slice(1)})};var hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey};var isFunctionKey=function(e){return e.type==="keydown"&&e.keyCode>=112&&e.keyCode<=123};var matchShortcut=function(e,shortcut){if(!shortcut){return false}if(shortcut.ctrl!=e.ctrlKey||shortcut.meta!=e.metaKey){return false}if(shortcut.alt!=e.altKey||shortcut.shift!=e.shiftKey){return false}if(e.keyCode==shortcut.keyCode||e.charCode&&e.charCode==shortcut.charCode){e.preventDefault();return true}return false};var executeShortcutAction=function(shortcut){return shortcut.func?shortcut.func.call(shortcut.scope):null};editor.on("keyup keypress keydown",function(e){if((hasModifier(e)||isFunctionKey(e))&&!e.isDefaultPrevented()){each(shortcuts,function(shortcut){if(matchShortcut(e,shortcut)){pendingPatterns=shortcut.subpatterns.slice(0);if(e.type=="keydown"){executeShortcutAction(shortcut)}return true}});if(matchShortcut(e,pendingPatterns[0])){if(pendingPatterns.length===1){if(e.type=="keydown"){executeShortcutAction(pendingPatterns[0])}}pendingPatterns.shift()}}});self.add=function(pattern,desc,cmdFunc,scope){var cmd;cmd=cmdFunc;if(typeof cmdFunc==="string"){cmdFunc=function(){editor.execCommand(cmd,false,null)}}else if(Tools.isArray(cmd)){cmdFunc=function(){editor.execCommand(cmd[0],cmd[1],cmd[2])}}each(explode(Tools.trim(pattern.toLowerCase())),function(pattern){var shortcut=createShortcut(pattern,desc,cmdFunc,scope);shortcuts[shortcut.id]=shortcut});return true};self.remove=function(pattern){var shortcut=createShortcut(pattern);if(shortcuts[shortcut.id]){delete shortcuts[shortcut.id];return true}return false}}});define("tinymce.core.html.SaxParser",["tinymce.core.html.Schema","tinymce.core.html.Entities","tinymce.core.util.Tools"],function(Schema,Entities,Tools){var each=Tools.each;var isValidPrefixAttrName=function(name){return name.indexOf("data-")===0||name.indexOf("aria-")===0};var trimComments=function(text){return text.replace(/<!--|-->/g,"")};var findEndTag=function(schema,html,startIndex){var count=1,index,matches,tokenRegExp,shortEndedElements;shortEndedElements=schema.getShortEndedElements();tokenRegExp=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;tokenRegExp.lastIndex=index=startIndex;while(matches=tokenRegExp.exec(html)){index=tokenRegExp.lastIndex;if(matches[1]==="/"){count--}else if(!matches[1]){if(matches[2]in shortEndedElements){continue}count++}if(count===0){break}}return index};var SaxParser=function(settings,schema){var self=this;var noop=function(){};settings=settings||{};self.schema=schema=schema||new Schema;if(settings.fix_self_closing!==false){settings.fix_self_closing=true}each("comment cdata text start end pi doctype".split(" "),function(name){if(name){self[name]=settings[name]||noop}});self.parse=function(html){var self=this,matches,index=0,value,endRegExp,stack=[],attrList,i,text,name;var isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded;var validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns;var attributesRequired,attributesDefault,attributesForced,processHtml;var anyAttributesRequired,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,idCount=0;var decode=Entities.decode,fixSelfClosing,filteredUrlAttrs=Tools.makeMap("src,href,data,background,formaction,poster");var scriptUriRegExp=/((java|vb)script|mhtml):/i,dataUriRegExp=/^data:/i;var processEndTag=function(name){var pos,i;pos=stack.length;while(pos--){if(stack[pos].name===name){break}}if(pos>=0){for(i=stack.length-1;i>=pos;i--){name=stack[i];if(name.valid){self.end(name.name)}}stack.length=pos}};var parseAttribute=function(match,name,value,val2,val3){var attrRule,i,trimRegExp=/[\s\u0000-\u001F]+/g;name=name.toLowerCase();value=name in fillAttrsMap?name:decode(value||val2||val3||"");if(validate&&!isInternalElement&&isValidPrefixAttrName(name)===false){attrRule=validAttributesMap[name];if(!attrRule&&validAttributePatterns){i=validAttributePatterns.length;while(i--){attrRule=validAttributePatterns[i];if(attrRule.pattern.test(name)){break}}if(i===-1){attrRule=null}}if(!attrRule){return}if(attrRule.validValues&&!(value in attrRule.validValues)){return}}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,"");try{uri=decodeURIComponent(uri)}catch(ex){uri=unescape(uri)}if(scriptUriRegExp.test(uri)){return}if(!settings.allow_html_data_urls&&dataUriRegExp.test(uri)&&!/^data:image\//i.test(uri)){return}}if(isInternalElement&&(name in filteredUrlAttrs||name.indexOf("on")===0)){return}attrList.map[name]=value;attrList.push({name:name,value:value})};tokenRegExp=new RegExp("<(?:"+"(?:!--([\\w\\W]*?)--\x3e)|"+"(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|"+"(?:!DOCTYPE([\\w\\W]*?)>)|"+"(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|"+"(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|"+"(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>)"+")","g");attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g;shortEndedElements=schema.getShortEndedElements();selfClosing=settings.self_closing_elements||schema.getSelfClosingElements();fillAttrsMap=schema.getBoolAttrs();validate=settings.validate;removeInternalElements=settings.remove_internals;fixSelfClosing=settings.fix_self_closing;specialElements=schema.getSpecialElements();processHtml=html+">";while(matches=tokenRegExp.exec(processHtml)){if(index<matches.index){self.text(decode(html.substr(index,matches.index-index)))}if(value=matches[6]){value=value.toLowerCase();if(value.charAt(0)===":"){value=value.substr(1)}processEndTag(value)}else if(value=matches[7]){if(matches.index+matches[0].length>html.length){self.text(decode(html.substr(matches.index)));index=matches.index+matches[0].length;continue}value=value.toLowerCase();if(value.charAt(0)===":"){value=value.substr(1)}isShortEnded=value in shortEndedElements;if(fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value){processEndTag(value)}if(!validate||(elementRule=schema.getElementRule(value))){isValidElement=true;if(validate){validAttributesMap=elementRule.attributes;validAttributePatterns=elementRule.attributePatterns}if(attribsValue=matches[8]){isInternalElement=attribsValue.indexOf("data-mce-type")!==-1;if(isInternalElement&&removeInternalElements){isValidElement=false}attrList=[];attrList.map={};attribsValue.replace(attrRegExp,parseAttribute)}else{attrList=[];attrList.map={}}if(validate&&!isInternalElement){attributesRequired=elementRule.attributesRequired;attributesDefault=elementRule.attributesDefault;attributesForced=elementRule.attributesForced;anyAttributesRequired=elementRule.removeEmptyAttrs;if(anyAttributesRequired&&!attrList.length){isValidElement=false}if(attributesForced){i=attributesForced.length;while(i--){attr=attributesForced[i];name=attr.name;attrValue=attr.value;if(attrValue==="{$uid}"){attrValue="mce_"+idCount++}attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}if(attributesDefault){i=attributesDefault.length;while(i--){attr=attributesDefault[i];name=attr.name;if(!(name in attrList.map)){attrValue=attr.value;if(attrValue==="{$uid}"){attrValue="mce_"+idCount++}attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}}if(attributesRequired){i=attributesRequired.length;while(i--){if(attributesRequired[i]in attrList.map){break}}if(i===-1){isValidElement=false}}if(attr=attrList.map["data-mce-bogus"]){if(attr==="all"){index=findEndTag(schema,html,tokenRegExp.lastIndex);tokenRegExp.lastIndex=index;continue}isValidElement=false}}if(isValidElement){self.start(value,attrList,isShortEnded)}}else{isValidElement=false}if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matches[0].length;if(matches=endRegExp.exec(html)){if(isValidElement){text=html.substr(index,matches.index-index)}index=matches.index+matches[0].length}else{text=html.substr(index);index=html.length}if(isValidElement){if(text.length>0){self.text(text,true)}self.end(value)}tokenRegExp.lastIndex=index;continue}if(!isShortEnded){if(!attribsValue||attribsValue.indexOf("/")!=attribsValue.length-1){stack.push({name:value,valid:isValidElement})}else if(isValidElement){self.end(value)}}}else if(value=matches[1]){if(value.charAt(0)===">"){value=" "+value}if(!settings.allow_conditional_comments&&value.substr(0,3).toLowerCase()==="[if"){value=" "+value}self.comment(value)}else if(value=matches[2]){self.cdata(trimComments(value))}else if(value=matches[3]){self.doctype(value)}else if(value=matches[4]){self.pi(value,matches[5])}index=matches.index+matches[0].length}if(index<html.length){self.text(decode(html.substr(index)))}for(i=stack.length-1;i>=0;i--){value=stack[i];if(value.valid){self.end(value.name)}}}};SaxParser.findEndTag=findEndTag;return SaxParser});define("tinymce.core.dom.TrimHtml",["tinymce.core.html.SaxParser","tinymce.core.text.Zwsp"],function(SaxParser,Zwsp){var trimHtml=function(tempAttrs,html){var trimContentRegExp=new RegExp(["\\s?("+tempAttrs.join("|")+')="[^"]+"'].join("|"),"gi");return html.replace(trimContentRegExp,"")};var trimInternal=function(serializer,html){var content=html;var bogusAllRegExp=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g;var endTagIndex,index,matchLength,matches,shortEndedElements;var schema=serializer.schema;content=trimHtml(serializer.getTempAttrs(),content);shortEndedElements=schema.getShortEndedElements();while(matches=bogusAllRegExp.exec(content)){index=bogusAllRegExp.lastIndex;matchLength=matches[0].length;if(shortEndedElements[matches[1]]){endTagIndex=index}else{endTagIndex=SaxParser.findEndTag(schema,content,index)}content=content.substring(0,index-matchLength)+content.substring(endTagIndex);bogusAllRegExp.lastIndex=index-matchLength}return content};var trimExternal=function(serializer,html){return Zwsp.trim(trimInternal(serializer,html))};return{trimExternal:trimExternal,trimInternal:trimInternal}});define("ephox.sugar.api.search.PredicateExists",["ephox.sugar.api.search.PredicateFind"],function(PredicateFind){var any=function(predicate){return PredicateFind.first(predicate).isSome()};var ancestor=function(scope,predicate,isRoot){return PredicateFind.ancestor(scope,predicate,isRoot).isSome()};var closest=function(scope,predicate,isRoot){return PredicateFind.closest(scope,predicate,isRoot).isSome()};var sibling=function(scope,predicate){return PredicateFind.sibling(scope,predicate).isSome()};var child=function(scope,predicate){return PredicateFind.child(scope,predicate).isSome()};var descendant=function(scope,predicate){return PredicateFind.descendant(scope,predicate).isSome()};return{any:any,ancestor:ancestor,closest:closest,sibling:sibling,child:child,descendant:descendant}});define("ephox.sugar.api.dom.Focus",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.PredicateExists","ephox.sugar.api.search.Traverse","global!document"],function(Fun,Option,Compare,Element,PredicateExists,Traverse,document){var focus=function(element){element.dom().focus()};var blur=function(element){element.dom().blur()};var hasFocus=function(element){var doc=Traverse.owner(element).dom();return element.dom()===doc.activeElement};var active=function(_doc){var doc=_doc!==undefined?_doc.dom():document;return Option.from(doc.activeElement).map(Element.fromDom)};var focusInside=function(element){var doc=Traverse.owner(element);var inside=active(doc).filter(function(a){return PredicateExists.closest(a,Fun.curry(Compare.eq,element))});inside.fold(function(){focus(element)},Fun.noop)};var search=function(element){return active(Traverse.owner(element)).filter(function(e){return element.dom().contains(e.dom())})};return{hasFocus:hasFocus,focus:focus,blur:blur,active:active,search:search,focusInside:focusInside}});define("tinymce.core.focus.EditorFocus",["ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Focus","ephox.sugar.api.node.Element","tinymce.core.Env","tinymce.core.caret.CaretFinder","tinymce.core.dom.ElementType","tinymce.core.selection.RangeNodes","tinymce.core.selection.SelectionBookmark"],function(Option,Compare,Focus,Element,Env,CaretFinder,ElementType,RangeNodes,SelectionBookmark){var getContentEditableHost=function(editor,node){return editor.dom.getParent(node,function(node){return editor.dom.getContentEditable(node)==="true"})};var getCollapsedNode=function(rng){return rng.collapsed?Option.from(RangeNodes.getNode(rng.startContainer,rng.startOffset)).map(Element.fromDom):Option.none()};var getFocusInElement=function(root,rng){return getCollapsedNode(rng).bind(function(node){if(ElementType.isTableSection(node)){return Option.some(node)}else if(Compare.contains(root,node)===false){return Option.some(root)}else{return Option.none()}})};var normalizeSelection=function(editor,rng){getFocusInElement(Element.fromDom(editor.getBody()),rng).bind(function(elm){return CaretFinder.firstPositionIn(elm.dom())}).fold(function(){editor.selection.normalize()},function(caretPos){editor.selection.setRng(caretPos.toRange())})};var focusBody=function(body){if(body.setActive){try{body.setActive()}catch(ex){body.focus()}}else{body.focus()}};var hasElementFocus=function(elm){return Focus.hasFocus(elm)||Focus.search(elm).isSome()};var hasIframeFocus=function(editor){return editor.iframeElement&&Focus.hasFocus(Element.fromDom(editor.iframeElement))};var hasInlineFocus=function(editor){var rawBody=editor.getBody();return rawBody&&hasElementFocus(Element.fromDom(rawBody))};var hasFocus=function(editor){return editor.inline?hasInlineFocus(editor):hasIframeFocus(editor)};var focusEditor=function(editor){var selection=editor.selection,contentEditable=editor.settings.content_editable;var body=editor.getBody(),contentEditableHost,rng=selection.getRng();editor.quirks.refreshContentEditable();contentEditableHost=getContentEditableHost(editor,selection.getNode());if(editor.$.contains(body,contentEditableHost)){focusBody(contentEditableHost);normalizeSelection(editor,rng);activateEditor(editor);return}if(editor.bookmark!==undefined&&hasFocus(editor)===false){SelectionBookmark.getRng(editor).each(function(bookmarkRng){editor.selection.setRng(bookmarkRng);rng=bookmarkRng})}if(!contentEditable){if(!Env.opera){focusBody(body)}editor.getWin().focus()}if(Env.gecko||contentEditable){focusBody(body);normalizeSelection(editor,rng)}activateEditor(editor)};var activateEditor=function(editor){editor.editorManager.setActive(editor)};var focus=function(editor,skipFocus){if(editor.removed){return}skipFocus?activateEditor(editor):focusEditor(editor)};return{focus:focus,hasFocus:hasFocus}});define("tinymce.core.EditorView",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Css","ephox.sugar.api.search.Traverse"],function(Fun,Option,Compare,Element,Css,Traverse){var getProp=function(propName,elm){var rawElm=elm.dom();return rawElm[propName]};var getComputedSizeProp=function(propName,elm){return parseInt(Css.get(elm,propName),10)};var getClientWidth=Fun.curry(getProp,"clientWidth");var getClientHeight=Fun.curry(getProp,"clientHeight");var getMarginTop=Fun.curry(getComputedSizeProp,"margin-top");var getMarginLeft=Fun.curry(getComputedSizeProp,"margin-left");var getBoundingClientRect=function(elm){return elm.dom().getBoundingClientRect()};var isInsideElementContentArea=function(bodyElm,clientX,clientY){var clientWidth=getClientWidth(bodyElm);var clientHeight=getClientHeight(bodyElm);return clientX>=0&&clientY>=0&&clientX<=clientWidth&&clientY<=clientHeight};var transpose=function(inline,elm,clientX,clientY){var clientRect=getBoundingClientRect(elm);var deltaX=inline?clientRect.left+elm.dom().clientLeft+getMarginLeft(elm):0;var deltaY=inline?clientRect.top+elm.dom().clientTop+getMarginTop(elm):0;var x=clientX-deltaX;var y=clientY-deltaY;return{x:x,y:y}};var isXYInContentArea=function(editor,clientX,clientY){var bodyElm=Element.fromDom(editor.getBody());var targetElm=editor.inline?bodyElm:Traverse.documentElement(bodyElm);var transposedPoint=transpose(editor.inline,targetElm,clientX,clientY);return isInsideElementContentArea(targetElm,transposedPoint.x,transposedPoint.y)};var fromDomSafe=function(node){return Option.from(node).map(Element.fromDom)};var isEditorAttachedToDom=function(editor){var rawContainer=editor.inline?editor.getBody():editor.getContentAreaContainer();return fromDomSafe(rawContainer).map(function(container){return Compare.contains(Traverse.owner(container),container)}).getOr(false)};return{isXYInContentArea:isXYInContentArea,isEditorAttachedToDom:isEditorAttachedToDom}});define("tinymce.core.ui.NotificationManagerImpl",[],function(){return function(){var unimplemented=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:unimplemented,close:unimplemented,reposition:unimplemented,getArgs:unimplemented}}});define("tinymce.core.api.NotificationManager",["ephox.katamari.api.Arr","ephox.katamari.api.Option","tinymce.core.EditorView","tinymce.core.ui.NotificationManagerImpl","tinymce.core.util.Delay"],function(Arr,Option,EditorView,NotificationManagerImpl,Delay){return function(editor){var notifications=[];var getImplementation=function(){var theme=editor.theme;return theme&&theme.getNotificationManagerImpl?theme.getNotificationManagerImpl():NotificationManagerImpl()};var getTopNotification=function(){return Option.from(notifications[0])};var isEqual=function(a,b){return a.type===b.type&&a.text===b.text&&!a.progressBar&&!a.timeout&&!b.progressBar&&!b.timeout};var reposition=function(){if(notifications.length>0){getImplementation().reposition(notifications)}};var addNotification=function(notification){notifications.push(notification)};var closeNotification=function(notification){Arr.findIndex(notifications,function(otherNotification){return otherNotification===notification}).each(function(index){notifications.splice(index,1)})};var open=function(args){if(editor.removed||!EditorView.isEditorAttachedToDom(editor)){return}return Arr.find(notifications,function(notification){return isEqual(getImplementation().getArgs(notification),args)}).getOrThunk(function(){editor.editorManager.setActive(editor);var notification=getImplementation().open(args,function(){closeNotification(notification);reposition()});addNotification(notification);reposition();return notification})};var close=function(){getTopNotification().each(function(notification){getImplementation().close(notification);closeNotification(notification);reposition()})};var getNotifications=function(){return notifications};var registerEvents=function(editor){editor.on("SkinLoaded",function(){var serviceMessage=editor.settings.service_message;if(serviceMessage){open({text:serviceMessage,type:"warning",timeout:0,icon:""})}});editor.on("ResizeEditor ResizeWindow",function(){Delay.requestAnimationFrame(reposition)});editor.on("remove",function(){Arr.each(notifications,function(notification){getImplementation().close(notification)})})};registerEvents(editor);return{open:open,close:close,getNotifications:getNotifications}}});define("tinymce.core.ui.WindowManagerImpl",[],function(){return function(){var unimplemented=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:unimplemented,alert:unimplemented,confirm:unimplemented,close:unimplemented,getParams:unimplemented,setParams:unimplemented}}});define("tinymce.core.api.WindowManager",["ephox.katamari.api.Arr","ephox.katamari.api.Option","tinymce.core.selection.SelectionBookmark","tinymce.core.ui.WindowManagerImpl"],function(Arr,Option,SelectionBookmark,WindowManagerImpl){return function(editor){var windows=[];var getImplementation=function(){var theme=editor.theme;return theme&&theme.getWindowManagerImpl?theme.getWindowManagerImpl():WindowManagerImpl()};var funcBind=function(scope,f){return function(){return f?f.apply(scope,arguments):undefined}};var fireOpenEvent=function(win){editor.fire("OpenWindow",{win:win})};var fireCloseEvent=function(win){editor.fire("CloseWindow",{win:win})};var addWindow=function(win){windows.push(win);fireOpenEvent(win)};var closeWindow=function(win){Arr.findIndex(windows,function(otherWindow){return otherWindow===win}).each(function(index){windows.splice(index,1);fireCloseEvent(win);if(windows.length===0){editor.focus()}})};var getTopWindow=function(){return Option.from(windows[windows.length-1])};var open=function(args,params){editor.editorManager.setActive(editor);SelectionBookmark.store(editor);var win=getImplementation().open(args,params,closeWindow);addWindow(win);return win};var alert=function(message,callback,scope){var win=getImplementation().alert(message,funcBind(scope?scope:this,callback),closeWindow);addWindow(win)};var confirm=function(message,callback,scope){var win=getImplementation().confirm(message,funcBind(scope?scope:this,callback),closeWindow);addWindow(win)};var close=function(){getTopWindow().each(function(win){getImplementation().close(win);closeWindow(win)})};var getParams=function(){return getTopWindow().map(getImplementation().getParams).getOr(null)};var setParams=function(params){getTopWindow().each(function(win){getImplementation().setParams(win,params)})};var getWindows=function(){return windows};editor.on("remove",function(){Arr.each(windows.slice(0),function(win){getImplementation().close(win)})});return{windows:windows,open:open,alert:alert,confirm:confirm,close:close,getParams:getParams,setParams:setParams,getWindows:getWindows}}});define("tinymce.core.ErrorReporter",["global!window","tinymce.core.AddOnManager"],function(window,AddOnManager){var PluginManager=AddOnManager.PluginManager;var resolvePluginName=function(targetUrl,suffix){for(var name in PluginManager.urls){var matchUrl=PluginManager.urls[name]+"/plugin"+suffix+".js";if(matchUrl===targetUrl){return name}}return null};var pluginUrlToMessage=function(editor,url){var plugin=resolvePluginName(url,editor.suffix);return plugin?"Failed to load plugin: "+plugin+" from url "+url:"Failed to load plugin url: "+url};var displayNotification=function(editor,message){editor.notificationManager.open({type:"error",text:message})};var displayError=function(editor,message){if(editor._skinLoaded){displayNotification(editor,message)}else{editor.on("SkinLoaded",function(){displayNotification(editor,message)})}};var uploadError=function(editor,message){displayError(editor,"Failed to upload image: "+message)};var pluginLoadError=function(editor,url){displayError(editor,pluginUrlToMessage(editor,url))};var initError=function(message){var console=window.console;if(console&&!window.test){if(console.error){console.error.apply(console,arguments)}else{console.log.apply(console,arguments)}}};return{pluginLoadError:pluginLoadError,uploadError:uploadError,displayError:displayError,initError:initError}});define("tinymce.core.PluginManager",["tinymce.core.AddOnManager"],function(AddOnManager){return AddOnManager.PluginManager});define("tinymce.core.ThemeManager",["tinymce.core.AddOnManager"],function(AddOnManager){return AddOnManager.ThemeManager});define("ephox.sand.api.XMLHttpRequest",["ephox.sand.util.Global"],function(Global){return function(){var f=Global.getOrDie("XMLHttpRequest");return new f}});define("tinymce.core.file.Uploader",["ephox.sand.api.XMLHttpRequest","global!window","tinymce.core.util.Fun","tinymce.core.util.Promise","tinymce.core.util.Tools"],function(XMLHttpRequest,window,Fun,Promise,Tools){return function(uploadStatus,settings){var pendingPromises={};var pathJoin=function(path1,path2){if(path1){return path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,"")}return path2};var defaultHandler=function(blobInfo,success,failure,progress){var xhr,formData;xhr=new XMLHttpRequest;xhr.open("POST",settings.url);xhr.withCredentials=settings.credentials;xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100)};xhr.onerror=function(){failure("Image upload failed due to a XHR Transport error. Code: "+xhr.status)};xhr.onload=function(){var json;if(xhr.status<200||xhr.status>=300){failure("HTTP Error: "+xhr.status);return}json=JSON.parse(xhr.responseText);if(!json||typeof json.location!="string"){failure("Invalid JSON: "+xhr.responseText);return}success(pathJoin(settings.basePath,json.location))};formData=new window.FormData;formData.append("file",blobInfo.blob(),blobInfo.filename());xhr.send(formData)};var noUpload=function(){return new Promise(function(resolve){resolve([])})};var handlerSuccess=function(blobInfo,url){return{url:url,blobInfo:blobInfo,status:true}};var handlerFailure=function(blobInfo,error){return{url:"",blobInfo:blobInfo,status:false,error:error}};var resolvePending=function(blobUri,result){Tools.each(pendingPromises[blobUri],function(resolve){resolve(result)});delete pendingPromises[blobUri]};var uploadBlobInfo=function(blobInfo,handler,openNotification){uploadStatus.markPending(blobInfo.blobUri());return new Promise(function(resolve){var notification,progress;var noop=function(){};try{var closeNotification=function(){if(notification){notification.close();progress=noop}};var success=function(url){closeNotification();uploadStatus.markUploaded(blobInfo.blobUri(),url);resolvePending(blobInfo.blobUri(),handlerSuccess(blobInfo,url));resolve(handlerSuccess(blobInfo,url))};var failure=function(error){closeNotification();uploadStatus.removeFailed(blobInfo.blobUri());resolvePending(blobInfo.blobUri(),handlerFailure(blobInfo,error));resolve(handlerFailure(blobInfo,error))};progress=function(percent){if(percent<0||percent>100){return}if(!notification){notification=openNotification()}notification.progressBar.value(percent)};handler(blobInfo,success,failure,progress)}catch(ex){resolve(handlerFailure(blobInfo,ex.message))}})};var isDefaultHandler=function(handler){return handler===defaultHandler};var pendingUploadBlobInfo=function(blobInfo){var blobUri=blobInfo.blobUri();return new Promise(function(resolve){pendingPromises[blobUri]=pendingPromises[blobUri]||[];pendingPromises[blobUri].push(resolve)})};var uploadBlobs=function(blobInfos,openNotification){blobInfos=Tools.grep(blobInfos,function(blobInfo){return!uploadStatus.isUploaded(blobInfo.blobUri())});return Promise.all(Tools.map(blobInfos,function(blobInfo){return uploadStatus.isPending(blobInfo.blobUri())?pendingUploadBlobInfo(blobInfo):uploadBlobInfo(blobInfo,settings.handler,openNotification)}))};var upload=function(blobInfos,openNotification){return!settings.url&&isDefaultHandler(settings.handler)?noUpload():uploadBlobs(blobInfos,openNotification)};settings=Tools.extend({credentials:false,handler:defaultHandler},settings);return{upload:upload}}});define("ephox.sand.api.Blob",["ephox.sand.util.Global"],function(Global){return function(parts,properties){var f=Global.getOrDie("Blob");return new f(parts,properties)}});define("ephox.sand.api.FileReader",["ephox.sand.util.Global"],function(Global){return function(){var f=Global.getOrDie("FileReader");return new f}});define("ephox.sand.api.Uint8Array",["ephox.sand.util.Global"],function(Global){return function(arr){var f=Global.getOrDie("Uint8Array");return new f(arr)}});define("ephox.sand.api.Window",["ephox.sand.util.Global"],function(Global){var requestAnimationFrame=function(callback){var f=Global.getOrDie("requestAnimationFrame");f(callback)};var atob=function(base64){var f=Global.getOrDie("atob");return f(base64)};return{atob:atob,requestAnimationFrame:requestAnimationFrame}});define("tinymce.core.file.Conversions",["ephox.sand.api.Blob","ephox.sand.api.FileReader","ephox.sand.api.Uint8Array","ephox.sand.api.Window","ephox.sand.api.XMLHttpRequest","tinymce.core.util.Promise"],function(Blob,FileReader,Uint8Array,Window,XMLHttpRequest,Promise){var blobUriToBlob=function(url){return new Promise(function(resolve,reject){var rejectWithError=function(){reject("Cannot convert "+url+" to Blob. Resource might not exist or is inaccessible.")};try{var xhr=new XMLHttpRequest;xhr.open("GET",url,true);xhr.responseType="blob";xhr.onload=function(){if(this.status==200){resolve(this.response)}else{rejectWithError()}};xhr.onerror=rejectWithError;xhr.send()}catch(ex){rejectWithError()}})};var parseDataUri=function(uri){var type,matches;uri=decodeURIComponent(uri).split(",");matches=/data:([^;]+)/.exec(uri[0]);if(matches){type=matches[1]}return{type:type,data:uri[1]}};var dataUriToBlob=function(uri){return new Promise(function(resolve){var str,arr,i;uri=parseDataUri(uri);try{str=Window.atob(uri.data)}catch(e){resolve(new Blob([]));return}arr=new Uint8Array(str.length);for(i=0;i<arr.length;i++){arr[i]=str.charCodeAt(i)}resolve(new Blob([arr],{type:uri.type}))})};var uriToBlob=function(url){if(url.indexOf("blob:")===0){return blobUriToBlob(url)}if(url.indexOf("data:")===0){return dataUriToBlob(url)}return null};var blobToDataUri=function(blob){return new Promise(function(resolve){var reader=new FileReader;reader.onloadend=function(){resolve(reader.result)};reader.readAsDataURL(blob)})};return{uriToBlob:uriToBlob,blobToDataUri:blobToDataUri,parseDataUri:parseDataUri}});define("tinymce.core.file.ImageScanner",["tinymce.core.util.Promise","tinymce.core.util.Arr","tinymce.core.util.Fun","tinymce.core.file.Conversions","tinymce.core.Env"],function(Promise,Arr,Fun,Conversions,Env){var count=0;var uniqueId=function(prefix){return(prefix||"blobid")+count++};var imageToBlobInfo=function(blobCache,img,resolve,reject){var base64,blobInfo;if(img.src.indexOf("blob:")===0){blobInfo=blobCache.getByUri(img.src);if(blobInfo){resolve({image:img,blobInfo:blobInfo})}else{Conversions.uriToBlob(img.src).then(function(blob){Conversions.blobToDataUri(blob).then(function(dataUri){base64=Conversions.parseDataUri(dataUri).data;blobInfo=blobCache.create(uniqueId(),blob,base64);blobCache.add(blobInfo);resolve({image:img,blobInfo:blobInfo})})},function(err){reject(err)})}return}base64=Conversions.parseDataUri(img.src).data;blobInfo=blobCache.findFirst(function(cachedBlobInfo){return cachedBlobInfo.base64()===base64});if(blobInfo){resolve({image:img,blobInfo:blobInfo})}else{Conversions.uriToBlob(img.src).then(function(blob){blobInfo=blobCache.create(uniqueId(),blob,base64);blobCache.add(blobInfo);resolve({image:img,blobInfo:blobInfo})},function(err){reject(err)})}};var getAllImages=function(elm){return elm?elm.getElementsByTagName("img"):[]};return function(uploadStatus,blobCache){var cachedPromises={};var findAll=function(elm,predicate){var images,promises;if(!predicate){predicate=Fun.constant(true)}images=Arr.filter(getAllImages(elm),function(img){var src=img.src;if(!Env.fileApi){return false}if(img.hasAttribute("data-mce-bogus")){return false}if(img.hasAttribute("data-mce-placeholder")){return false}if(!src||src==Env.transparentSrc){return false}if(src.indexOf("blob:")===0){return!uploadStatus.isUploaded(src)}if(src.indexOf("data:")===0){return predicate(img)}return false});promises=Arr.map(images,function(img){var newPromise;if(cachedPromises[img.src]){return new Promise(function(resolve){cachedPromises[img.src].then(function(imageInfo){if(typeof imageInfo==="string"){return imageInfo}resolve({image:img,blobInfo:imageInfo.blobInfo})})})}newPromise=new Promise(function(resolve,reject){imageToBlobInfo(blobCache,img,resolve,reject)}).then(function(result){delete cachedPromises[result.image.src];return result})["catch"](function(error){delete cachedPromises[img.src];return error});cachedPromises[img.src]=newPromise;return newPromise});return Promise.all(promises)};return{findAll:findAll}}});define("tinymce.core.util.Uuid",[],function(){var count=0;var seed=function(){var rnd=function(){return Math.round(Math.random()*4294967295).toString(36)};var now=(new Date).getTime();return"s"+now.toString(36)+rnd()+rnd()+rnd()};var uuid=function(prefix){return prefix+count+++seed()};return{uuid:uuid}});define("tinymce.core.file.BlobCache",["ephox.sand.api.URL","tinymce.core.util.Arr","tinymce.core.util.Fun","tinymce.core.util.Uuid"],function(URL,Arr,Fun,Uuid){return function(){var cache=[],constant=Fun.constant;var mimeToExt=function(mime){var mimes={"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"};return mimes[mime.toLowerCase()]||"dat"};var create=function(o,blob,base64,filename){return typeof o==="object"?toBlobInfo(o):toBlobInfo({id:o,name:filename,blob:blob,base64:base64})};var toBlobInfo=function(o){var id,name;if(!o.blob||!o.base64){throw"blob and base64 representations of the image are required for BlobInfo to be created"}id=o.id||Uuid.uuid("blobid");name=o.name||id;return{id:constant(id),name:constant(name),filename:constant(name+"."+mimeToExt(o.blob.type)),blob:constant(o.blob),base64:constant(o.base64),blobUri:constant(o.blobUri||URL.createObjectURL(o.blob)),uri:constant(o.uri)}};var add=function(blobInfo){if(!get(blobInfo.id())){cache.push(blobInfo)}};var get=function(id){return findFirst(function(cachedBlobInfo){return cachedBlobInfo.id()===id})};var findFirst=function(predicate){return Arr.filter(cache,predicate)[0]};var getByUri=function(blobUri){return findFirst(function(blobInfo){return blobInfo.blobUri()==blobUri})};var removeByUri=function(blobUri){cache=Arr.filter(cache,function(blobInfo){if(blobInfo.blobUri()===blobUri){URL.revokeObjectURL(blobInfo.blobUri());return false}return true})};var destroy=function(){Arr.each(cache,function(cachedBlobInfo){URL.revokeObjectURL(cachedBlobInfo.blobUri())});cache=[]};return{create:create,add:add,get:get,getByUri:getByUri,findFirst:findFirst,removeByUri:removeByUri,destroy:destroy}}});define("tinymce.core.file.UploadStatus",[],function(){return function(){var PENDING=1,UPLOADED=2;var blobUriStatuses={};var createStatus=function(status,resultUri){return{status:status,resultUri:resultUri}};var hasBlobUri=function(blobUri){return blobUri in blobUriStatuses};var getResultUri=function(blobUri){var result=blobUriStatuses[blobUri];return result?result.resultUri:null};var isPending=function(blobUri){return hasBlobUri(blobUri)?blobUriStatuses[blobUri].status===PENDING:false};var isUploaded=function(blobUri){return hasBlobUri(blobUri)?blobUriStatuses[blobUri].status===UPLOADED:false};var markPending=function(blobUri){blobUriStatuses[blobUri]=createStatus(PENDING,null)};var markUploaded=function(blobUri,resultUri){blobUriStatuses[blobUri]=createStatus(UPLOADED,resultUri)};var removeFailed=function(blobUri){delete blobUriStatuses[blobUri]};var destroy=function(){blobUriStatuses={}};return{hasBlobUri:hasBlobUri,getResultUri:getResultUri,isPending:isPending,isUploaded:isUploaded,markPending:markPending,markUploaded:markUploaded,removeFailed:removeFailed,destroy:destroy}}});define("tinymce.core.EditorUpload",["tinymce.core.util.Arr","tinymce.core.file.Uploader","tinymce.core.file.ImageScanner","tinymce.core.file.BlobCache","tinymce.core.file.UploadStatus","tinymce.core.ErrorReporter"],function(Arr,Uploader,ImageScanner,BlobCache,UploadStatus,ErrorReporter){return function(editor){var blobCache=new BlobCache,uploader,imageScanner,settings=editor.settings;var uploadStatus=new UploadStatus;var aliveGuard=function(callback){return function(result){if(editor.selection){return callback(result)}return[]}};var cacheInvalidator=function(){return"?"+(new Date).getTime()};var replaceString=function(content,search,replace){var index=0;do{index=content.indexOf(search,index);if(index!==-1){content=content.substring(0,index)+replace+content.substr(index+search.length);index+=replace.length-search.length+1}}while(index!==-1);return content};var replaceImageUrl=function(content,targetUrl,replacementUrl){content=replaceString(content,'src="'+targetUrl+'"','src="'+replacementUrl+'"');content=replaceString(content,'data-mce-src="'+targetUrl+'"','data-mce-src="'+replacementUrl+'"');return content};var replaceUrlInUndoStack=function(targetUrl,replacementUrl){Arr.each(editor.undoManager.data,function(level){if(level.type==="fragmented"){level.fragments=Arr.map(level.fragments,function(fragment){return replaceImageUrl(fragment,targetUrl,replacementUrl)})}else{level.content=replaceImageUrl(level.content,targetUrl,replacementUrl)}})};var openNotification=function(){return editor.notificationManager.open({text:editor.translate("Image uploading..."),type:"info",timeout:-1,progressBar:true})};var replaceImageUri=function(image,resultUri){blobCache.removeByUri(image.src);replaceUrlInUndoStack(image.src,resultUri);editor.$(image).attr({src:settings.images_reuse_filename?resultUri+cacheInvalidator():resultUri,"data-mce-src":editor.convertURL(resultUri,"src")})};var uploadImages=function(callback){if(!uploader){uploader=new Uploader(uploadStatus,{url:settings.images_upload_url,basePath:settings.images_upload_base_path,credentials:settings.images_upload_credentials,handler:settings.images_upload_handler})}return scanForImages().then(aliveGuard(function(imageInfos){var blobInfos;blobInfos=Arr.map(imageInfos,function(imageInfo){return imageInfo.blobInfo});return uploader.upload(blobInfos,openNotification).then(aliveGuard(function(result){var filteredResult=Arr.map(result,function(uploadInfo,index){var image=imageInfos[index].image;if(uploadInfo.status&&editor.settings.images_replace_blob_uris!==false){replaceImageUri(image,uploadInfo.url)}else if(uploadInfo.error){ErrorReporter.uploadError(editor,uploadInfo.error)}return{element:image,status:uploadInfo.status}});if(callback){callback(filteredResult)}return filteredResult}))}))};var uploadImagesAuto=function(callback){if(settings.automatic_uploads!==false){return uploadImages(callback)}};var isValidDataUriImage=function(imgElm){return settings.images_dataimg_filter?settings.images_dataimg_filter(imgElm):true};var scanForImages=function(){if(!imageScanner){imageScanner=new ImageScanner(uploadStatus,blobCache)}return imageScanner.findAll(editor.getBody(),isValidDataUriImage).then(aliveGuard(function(result){result=Arr.filter(result,function(resultItem){if(typeof resultItem==="string"){ErrorReporter.displayError(editor,resultItem);return false}return true});Arr.each(result,function(resultItem){replaceUrlInUndoStack(resultItem.image.src,resultItem.blobInfo.blobUri());resultItem.image.src=resultItem.blobInfo.blobUri();resultItem.image.removeAttribute("data-mce-src")});return result}))};var destroy=function(){blobCache.destroy();uploadStatus.destroy();imageScanner=uploader=null};var replaceBlobUris=function(content){return content.replace(/src="(blob:[^"]+)"/g,function(match,blobUri){var resultUri=uploadStatus.getResultUri(blobUri);if(resultUri){return'src="'+resultUri+'"'}var blobInfo=blobCache.getByUri(blobUri);if(!blobInfo){blobInfo=Arr.reduce(editor.editorManager.get(),function(result,editor){return result||editor.editorUpload&&editor.editorUpload.blobCache.getByUri(blobUri)},null)}if(blobInfo){return'src="data:'+blobInfo.blob().type+";base64,"+blobInfo.base64()+'"'}return match})};editor.on("setContent",function(){if(editor.settings.automatic_uploads!==false){uploadImagesAuto()}else{scanForImages()}});editor.on("RawSaveContent",function(e){e.content=replaceBlobUris(e.content)});editor.on("getContent",function(e){if(e.source_view||e.format=="raw"){return}e.content=replaceBlobUris(e.content)});editor.on("PostRender",function(){editor.parser.addNodeFilter("img",function(images){Arr.each(images,function(img){var src=img.attr("src");if(blobCache.getByUri(src)){return}var resultUri=uploadStatus.getResultUri(src);if(resultUri){img.attr("src",resultUri)}})})});return{blobCache:blobCache,uploadImages:uploadImages,uploadImagesAuto:uploadImagesAuto,scanForImages:scanForImages,destroy:destroy}}});define("tinymce.core.ForceBlocks",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.node.Element","tinymce.core.dom.Bookmarks","tinymce.core.dom.NodeType","tinymce.core.dom.Parents","tinymce.core.focus.EditorFocus"],function(Arr,Fun,Element,Bookmarks,NodeType,Parents,EditorFocus){var isBlockElement=function(blockElements,node){return blockElements.hasOwnProperty(node.nodeName)};var isValidTarget=function(blockElements,node){if(NodeType.isText(node)){return true}else if(NodeType.isElement(node)){return!isBlockElement(blockElements,node)&&!Bookmarks.isBookmarkNode(node)}else{return false}};var hasBlockParent=function(blockElements,root,node){return Arr.exists(Parents.parents(Element.fromDom(node),Element.fromDom(root)),function(elm){return isBlockElement(blockElements,elm.dom())})};var addRootBlocks=function(editor){var settings=editor.settings,dom=editor.dom,selection=editor.selection;var schema=editor.schema,blockElements=schema.getBlockElements();var node=selection.getStart(),rootNode=editor.getBody(),rng;var startContainer,startOffset,endContainer,endOffset,rootBlockNode;var tempNode,wrapped,restoreSelection;var rootNodeName,forcedRootBlock;forcedRootBlock=settings.forced_root_block;if(!node||!NodeType.isElement(node)||!forcedRootBlock){return}rootNodeName=rootNode.nodeName.toLowerCase();if(!schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())||hasBlockParent(blockElements,rootNode,node)){return}rng=selection.getRng();startContainer=rng.startContainer;startOffset=rng.startOffset;endContainer=rng.endContainer;endOffset=rng.endOffset;restoreSelection=EditorFocus.hasFocus(editor);node=rootNode.firstChild;while(node){if(isValidTarget(blockElements,node)){if(NodeType.isText(node)&&node.nodeValue.length===0){tempNode=node;node=node.nextSibling;dom.remove(tempNode);continue}if(!rootBlockNode){rootBlockNode=dom.create(forcedRootBlock,editor.settings.forced_root_block_attrs);node.parentNode.insertBefore(rootBlockNode,node);wrapped=true}tempNode=node;node=node.nextSibling;rootBlockNode.appendChild(tempNode)}else{rootBlockNode=null;node=node.nextSibling}}if(wrapped&&restoreSelection){rng.setStart(startContainer,startOffset);rng.setEnd(endContainer,endOffset);selection.setRng(rng);editor.nodeChanged()}};var setup=function(editor){if(editor.settings.forced_root_block){editor.on("NodeChange",Fun.curry(addRootBlocks,editor))}};return{setup:setup}});define("tinymce.core.NodeChange",["tinymce.core.Env","tinymce.core.selection.RangeCompare","tinymce.core.util.Delay"],function(Env,RangeCompare,Delay){return function(editor){var lastRng,lastPath=[];var isSameElementPath=function(startElm){var i,currentPath;currentPath=editor.$(startElm).parentsUntil(editor.getBody()).add(startElm);if(currentPath.length===lastPath.length){for(i=currentPath.length;i>=0;i--){if(currentPath[i]!==lastPath[i]){break}}if(i===-1){lastPath=currentPath;return true}}lastPath=currentPath;return false};if(!("onselectionchange"in editor.getDoc())){editor.on("NodeChange Click MouseUp KeyUp Focus",function(e){var nativeRng,fakeRng;nativeRng=editor.selection.getRng();fakeRng={startContainer:nativeRng.startContainer,startOffset:nativeRng.startOffset,endContainer:nativeRng.endContainer,endOffset:nativeRng.endOffset};if(e.type=="nodechange"||!RangeCompare.isEq(fakeRng,lastRng)){editor.fire("SelectionChange")}lastRng=fakeRng})}editor.on("contextmenu",function(){editor.fire("SelectionChange")});editor.on("SelectionChange",function(){var startElm=editor.selection.getStart(true);if(!startElm||!Env.range&&editor.selection.isCollapsed()){return}if(!isSameElementPath(startElm)&&editor.dom.isChildOf(startElm,editor.getBody())){editor.nodeChanged({selectionChange:true})}});editor.on("MouseUp",function(e){if(!e.isDefaultPrevented()){if(editor.selection.getNode().nodeName=="IMG"){Delay.setEditorTimeout(editor,function(){editor.nodeChanged()})}else{editor.nodeChanged()}}});this.nodeChanged=function(args){var selection=editor.selection,node,parents,root;if(editor.initialized&&selection&&!editor.settings.disable_nodechange&&!editor.readonly){root=editor.getBody();node=selection.getStart(true)||root;if(node.ownerDocument!=editor.getDoc()||!editor.dom.isChildOf(node,root)){node=root}parents=[];editor.dom.getParent(node,function(node){if(node===root){return true}parents.push(node)});args=args||{};args.element=node;args.parents=parents;editor.fire("NodeChange",args)}}}});define("tinymce.core.dom.MousePosition",[],function(){var getAbsolutePosition=function(elm){var doc,docElem,win,clientRect;clientRect=elm.getBoundingClientRect();doc=elm.ownerDocument;docElem=doc.documentElement;win=doc.defaultView;return{top:clientRect.top+win.pageYOffset-docElem.clientTop,left:clientRect.left+win.pageXOffset-docElem.clientLeft}};var getBodyPosition=function(editor){return editor.inline?getAbsolutePosition(editor.getBody()):{left:0,top:0}};var getScrollPosition=function(editor){var body=editor.getBody();return editor.inline?{left:body.scrollLeft,top:body.scrollTop}:{left:0,top:0}};var getBodyScroll=function(editor){var body=editor.getBody(),docElm=editor.getDoc().documentElement;var inlineScroll={left:body.scrollLeft,top:body.scrollTop};var iframeScroll={left:body.scrollLeft||docElm.scrollLeft,top:body.scrollTop||docElm.scrollTop};return editor.inline?inlineScroll:iframeScroll};var getMousePosition=function(editor,event){if(event.target.ownerDocument!==editor.getDoc()){var iframePosition=getAbsolutePosition(editor.getContentAreaContainer());var scrollPosition=getBodyScroll(editor);return{left:event.pageX-iframePosition.left+scrollPosition.left,top:event.pageY-iframePosition.top+scrollPosition.top}}return{left:event.pageX,top:event.pageY}};var calculatePosition=function(bodyPosition,scrollPosition,mousePosition){return{pageX:mousePosition.left-bodyPosition.left+scrollPosition.left,pageY:mousePosition.top-bodyPosition.top+scrollPosition.top}};var calc=function(editor,event){return calculatePosition(getBodyPosition(editor),getScrollPosition(editor),getMousePosition(editor,event))};return{calc:calc}});define("tinymce.core.DragDropOverrides",["global!document","tinymce.core.dom.DOMUtils","tinymce.core.dom.MousePosition","tinymce.core.dom.NodeType","tinymce.core.util.Arr","tinymce.core.util.Delay","tinymce.core.util.Fun"],function(document,DOMUtils,MousePosition,NodeType,Arr,Delay,Fun){var isContentEditableFalse=NodeType.isContentEditableFalse,isContentEditableTrue=NodeType.isContentEditableTrue;var isDraggable=function(rootElm,elm){return isContentEditableFalse(elm)&&elm!==rootElm};var isValidDropTarget=function(editor,targetElement,dragElement){if(targetElement===dragElement||editor.dom.isChildOf(targetElement,dragElement)){return false}if(isContentEditableFalse(targetElement)){return false}return true};var cloneElement=function(elm){var cloneElm=elm.cloneNode(true);cloneElm.removeAttribute("data-mce-selected");return cloneElm};var createGhost=function(editor,elm,width,height){var clonedElm=elm.cloneNode(true);editor.dom.setStyles(clonedElm,{width:width,height:height});editor.dom.setAttrib(clonedElm,"data-mce-selected",null);var ghostElm=editor.dom.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});editor.dom.setStyles(ghostElm,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:width,height:height});editor.dom.setStyles(clonedElm,{margin:0,boxSizing:"border-box"});ghostElm.appendChild(clonedElm);return ghostElm};var appendGhostToBody=function(ghostElm,bodyElm){if(ghostElm.parentNode!==bodyElm){bodyElm.appendChild(ghostElm)}};var moveGhost=function(ghostElm,position,width,height,maxX,maxY){var overflowX=0,overflowY=0;ghostElm.style.left=position.pageX+"px";ghostElm.style.top=position.pageY+"px";if(position.pageX+width>maxX){overflowX=position.pageX+width-maxX}if(position.pageY+height>maxY){overflowY=position.pageY+height-maxY}ghostElm.style.width=width-overflowX+"px";ghostElm.style.height=height-overflowY+"px"};var removeElement=function(elm){if(elm&&elm.parentNode){elm.parentNode.removeChild(elm)}};var isLeftMouseButtonPressed=function(e){return e.button===0};var hasDraggableElement=function(state){return state.element};var applyRelPos=function(state,position){return{pageX:position.pageX-state.relX,pageY:position.pageY+5}};var start=function(state,editor){return function(e){if(isLeftMouseButtonPressed(e)){var ceElm=Arr.find(editor.dom.getParents(e.target),Fun.or(isContentEditableFalse,isContentEditableTrue));if(isDraggable(editor.getBody(),ceElm)){var elmPos=editor.dom.getPos(ceElm);var bodyElm=editor.getBody();var docElm=editor.getDoc().documentElement;state.element=ceElm;state.screenX=e.screenX;state.screenY=e.screenY;state.maxX=(editor.inline?bodyElm.scrollWidth:docElm.offsetWidth)-2;state.maxY=(editor.inline?bodyElm.scrollHeight:docElm.offsetHeight)-2;state.relX=e.pageX-elmPos.x;state.relY=e.pageY-elmPos.y;state.width=ceElm.offsetWidth;state.height=ceElm.offsetHeight;state.ghost=createGhost(editor,ceElm,state.width,state.height)}}}};var move=function(state,editor){var throttledPlaceCaretAt=Delay.throttle(function(clientX,clientY){editor._selectionOverrides.hideFakeCaret();editor.selection.placeCaretAt(clientX,clientY)},0);return function(e){var movement=Math.max(Math.abs(e.screenX-state.screenX),Math.abs(e.screenY-state.screenY));if(hasDraggableElement(state)&&!state.dragging&&movement>10){var args=editor.fire("dragstart",{target:state.element});if(args.isDefaultPrevented()){return}state.dragging=true;editor.focus()}if(state.dragging){var targetPos=applyRelPos(state,MousePosition.calc(editor,e));appendGhostToBody(state.ghost,editor.getBody());moveGhost(state.ghost,targetPos,state.width,state.height,state.maxX,state.maxY);throttledPlaceCaretAt(e.clientX,e.clientY)}}};var getRawTarget=function(selection){var rng=selection.getSel().getRangeAt(0);var startContainer=rng.startContainer;return startContainer.nodeType===3?startContainer.parentNode:startContainer};var drop=function(state,editor){return function(e){if(state.dragging){if(isValidDropTarget(editor,getRawTarget(editor.selection),state.element)){var targetClone=cloneElement(state.element);var args=editor.fire("drop",{targetClone:targetClone,clientX:e.clientX,clientY:e.clientY});if(!args.isDefaultPrevented()){targetClone=args.targetClone;editor.undoManager.transact(function(){removeElement(state.element);editor.insertContent(editor.dom.getOuterHTML(targetClone));editor._selectionOverrides.hideFakeCaret()})}}}removeDragState(state)}};var stop=function(state,editor){return function(){removeDragState(state);if(state.dragging){editor.fire("dragend")}}};var removeDragState=function(state){state.dragging=false;state.element=null;removeElement(state.ghost)};var bindFakeDragEvents=function(editor){var state={},pageDom,dragStartHandler,dragHandler,dropHandler,dragEndHandler,rootDocument;pageDom=DOMUtils.DOM;rootDocument=document;dragStartHandler=start(state,editor);dragHandler=move(state,editor);dropHandler=drop(state,editor);dragEndHandler=stop(state,editor);editor.on("mousedown",dragStartHandler);editor.on("mousemove",dragHandler);editor.on("mouseup",dropHandler);pageDom.bind(rootDocument,"mousemove",dragHandler);pageDom.bind(rootDocument,"mouseup",dragEndHandler);editor.on("remove",function(){pageDom.unbind(rootDocument,"mousemove",dragHandler);pageDom.unbind(rootDocument,"mouseup",dragEndHandler)})};var blockIeDrop=function(editor){editor.on("drop",function(e){var realTarget=typeof e.clientX!=="undefined"?editor.getDoc().elementFromPoint(e.clientX,e.clientY):null;if(isContentEditableFalse(realTarget)||isContentEditableFalse(editor.dom.getContentEditableParent(realTarget))){e.preventDefault()}})};var init=function(editor){bindFakeDragEvents(editor);blockIeDrop(editor)};return{init:init}});define("tinymce.core.caret.FakeCaret",["global!clearInterval","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretContainerRemove","tinymce.core.dom.DomQuery","tinymce.core.dom.NodeType","tinymce.core.geom.ClientRect","tinymce.core.util.Delay"],function(clearInterval,CaretContainer,CaretContainerRemove,DomQuery,NodeType,ClientRect,Delay){var isContentEditableFalse=NodeType.isContentEditableFalse;var isTableCell=function(node){return node&&/^(TD|TH)$/i.test(node.nodeName)};return function(rootNode,isBlock){var cursorInterval,$lastVisualCaret=null,caretContainerNode;var getAbsoluteClientRect=function(node,before){var clientRect=ClientRect.collapse(node.getBoundingClientRect(),before),docElm,scrollX,scrollY,margin,rootRect;if(rootNode.tagName=="BODY"){docElm=rootNode.ownerDocument.documentElement;scrollX=rootNode.scrollLeft||docElm.scrollLeft;scrollY=rootNode.scrollTop||docElm.scrollTop}else{rootRect=rootNode.getBoundingClientRect();scrollX=rootNode.scrollLeft-rootRect.left;scrollY=rootNode.scrollTop-rootRect.top}clientRect.left+=scrollX;clientRect.right+=scrollX;clientRect.top+=scrollY;clientRect.bottom+=scrollY;clientRect.width=1;margin=node.offsetWidth-node.clientWidth;if(margin>0){if(before){margin*=-1}clientRect.left+=margin;clientRect.right+=margin}return clientRect};var trimInlineCaretContainers=function(){var contentEditableFalseNodes,node,sibling,i,data;contentEditableFalseNodes=DomQuery("*[contentEditable=false]",rootNode);for(i=0;i<contentEditableFalseNodes.length;i++){node=contentEditableFalseNodes[i];sibling=node.previousSibling;if(CaretContainer.endsWithCaretContainer(sibling)){data=sibling.data;if(data.length==1){sibling.parentNode.removeChild(sibling)}else{sibling.deleteData(data.length-1,1)}}sibling=node.nextSibling;if(CaretContainer.startsWithCaretContainer(sibling)){data=sibling.data;if(data.length==1){sibling.parentNode.removeChild(sibling)}else{sibling.deleteData(0,1)}}}return null};var show=function(before,node){var clientRect,rng;hide();if(isTableCell(node)){return null}if(isBlock(node)){caretContainerNode=CaretContainer.insertBlock("p",node,before);clientRect=getAbsoluteClientRect(node,before);DomQuery(caretContainerNode).css("top",clientRect.top);$lastVisualCaret=DomQuery('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(clientRect).appendTo(rootNode);if(before){$lastVisualCaret.addClass("mce-visual-caret-before")}startBlink();rng=node.ownerDocument.createRange();rng.setStart(caretContainerNode,0);rng.setEnd(caretContainerNode,0)}else{caretContainerNode=CaretContainer.insertInline(node,before);rng=node.ownerDocument.createRange();if(isContentEditableFalse(caretContainerNode.nextSibling)){rng.setStart(caretContainerNode,0);rng.setEnd(caretContainerNode,0)}else{rng.setStart(caretContainerNode,1);rng.setEnd(caretContainerNode,1)}return rng}return rng};var hide=function(){trimInlineCaretContainers();if(caretContainerNode){CaretContainerRemove.remove(caretContainerNode);caretContainerNode=null}if($lastVisualCaret){$lastVisualCaret.remove();$lastVisualCaret=null}clearInterval(cursorInterval)};var hasFocus=function(){return rootNode.ownerDocument.activeElement===rootNode};var startBlink=function(){cursorInterval=Delay.setInterval(function(){if(hasFocus()){DomQuery("div.mce-visual-caret",rootNode).toggleClass("mce-visual-caret-hidden")}else{DomQuery("div.mce-visual-caret",rootNode).addClass("mce-visual-caret-hidden")}},500)};var destroy=function(){Delay.clearInterval(cursorInterval)};var getCss=function(){return".mce-visual-caret {"+"position: absolute;"+"background-color: black;"+"background-color: currentcolor;"+"}"+".mce-visual-caret-hidden {"+"display: none;"+"}"+"*[data-mce-caret] {"+"position: absolute;"+"left: -1000px;"+"right: auto;"+"top: 0;"+"margin: 0;"+"padding: 0;"+"}"};return{show:show,hide:hide,getCss:getCss,destroy:destroy}}});define("tinymce.core.dom.Dimensions",["tinymce.core.util.Arr","tinymce.core.dom.NodeType","tinymce.core.geom.ClientRect"],function(Arr,NodeType,ClientRect){var getClientRects=function(node){var toArrayWithNode=function(clientRects){return Arr.map(clientRects,function(clientRect){clientRect=ClientRect.clone(clientRect);clientRect.node=node;return clientRect})};if(Arr.isArray(node)){return Arr.reduce(node,function(result,node){return result.concat(getClientRects(node))},[])}if(NodeType.isElement(node)){return toArrayWithNode(node.getClientRects())}if(NodeType.isText(node)){var rng=node.ownerDocument.createRange();rng.setStart(node,0);rng.setEnd(node,node.data.length);return toArrayWithNode(rng.getClientRects())}};return{getClientRects:getClientRects}});define("tinymce.core.caret.LineUtils",["tinymce.core.util.Fun","tinymce.core.util.Arr","tinymce.core.dom.NodeType","tinymce.core.dom.Dimensions","tinymce.core.geom.ClientRect","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretCandidate"],function(Fun,Arr,NodeType,Dimensions,ClientRect,CaretUtils,CaretCandidate){var isContentEditableFalse=NodeType.isContentEditableFalse,findNode=CaretUtils.findNode,curry=Fun.curry;var distanceToRectLeft=function(clientRect,clientX){return Math.abs(clientRect.left-clientX)};var distanceToRectRight=function(clientRect,clientX){return Math.abs(clientRect.right-clientX)};var findClosestClientRect=function(clientRects,clientX){var isInside=function(clientX,clientRect){return clientX>=clientRect.left&&clientX<=clientRect.right};return Arr.reduce(clientRects,function(oldClientRect,clientRect){var oldDistance,newDistance;oldDistance=Math.min(distanceToRectLeft(oldClientRect,clientX),distanceToRectRight(oldClientRect,clientX));newDistance=Math.min(distanceToRectLeft(clientRect,clientX),distanceToRectRight(clientRect,clientX));if(isInside(clientX,clientRect)){return clientRect}if(isInside(clientX,oldClientRect)){return oldClientRect}if(newDistance==oldDistance&&isContentEditableFalse(clientRect.node)){return clientRect}if(newDistance<oldDistance){return clientRect}return oldClientRect})};var walkUntil=function(direction,rootNode,predicateFn,node){while(node=findNode(node,direction,CaretCandidate.isEditableCaretCandidate,rootNode)){if(predicateFn(node)){return}}};var findLineNodeRects=function(rootNode,targetNodeRect){var clientRects=[];var collect=function(checkPosFn,node){var lineRects;lineRects=Arr.filter(Dimensions.getClientRects(node),function(clientRect){return!checkPosFn(clientRect,targetNodeRect)});clientRects=clientRects.concat(lineRects);return lineRects.length===0};clientRects.push(targetNodeRect);walkUntil(-1,rootNode,curry(collect,ClientRect.isAbove),targetNodeRect.node);walkUntil(1,rootNode,curry(collect,ClientRect.isBelow),targetNodeRect.node);return clientRects};var getContentEditableFalseChildren=function(rootNode){return Arr.filter(Arr.toArray(rootNode.getElementsByTagName("*")),isContentEditableFalse)};var caretInfo=function(clientRect,clientX){return{node:clientRect.node,before:distanceToRectLeft(clientRect,clientX)<distanceToRectRight(clientRect,clientX)}};var closestCaret=function(rootNode,clientX,clientY){var contentEditableFalseNodeRects,closestNodeRect;contentEditableFalseNodeRects=Dimensions.getClientRects(getContentEditableFalseChildren(rootNode));contentEditableFalseNodeRects=Arr.filter(contentEditableFalseNodeRects,function(clientRect){return clientY>=clientRect.top&&clientY<=clientRect.bottom});closestNodeRect=findClosestClientRect(contentEditableFalseNodeRects,clientX);if(closestNodeRect){closestNodeRect=findClosestClientRect(findLineNodeRects(rootNode,closestNodeRect),clientX);if(closestNodeRect&&isContentEditableFalse(closestNodeRect.node)){return caretInfo(closestNodeRect,clientX)}}return null};return{findClosestClientRect:findClosestClientRect,findLineNodeRects:findLineNodeRects,closestCaret:closestCaret}});define("tinymce.core.dom.RangePoint",["ephox.katamari.api.Arr","tinymce.core.geom.ClientRect"],function(Arr,ClientRect){var isXYWithinRange=function(clientX,clientY,range){if(range.collapsed){return false}return Arr.foldl(range.getClientRects(),function(state,rect){return state||ClientRect.containsXY(rect,clientX,clientY)},false)};return{isXYWithinRange:isXYWithinRange}});define("ephox.katamari.api.Throttler",["global!clearTimeout","global!setTimeout"],function(clearTimeout,setTimeout){var adaptable=function(fn,rate){var timer=null;var args=null;var cancel=function(){if(timer!==null){clearTimeout(timer);timer=null;args=null}};var throttle=function(){args=arguments;if(timer===null){timer=setTimeout(function(){fn.apply(null,args);timer=null;args=null},rate)}};return{cancel:cancel,throttle:throttle}};var first=function(fn,rate){var timer=null;var cancel=function(){if(timer!==null){clearTimeout(timer);timer=null}};var throttle=function(){var args=arguments;if(timer===null){timer=setTimeout(function(){fn.apply(null,args);timer=null;args=null},rate)}};return{cancel:cancel,throttle:throttle}};var last=function(fn,rate){var timer=null;var cancel=function(){if(timer!==null){clearTimeout(timer);timer=null}};var throttle=function(){var args=arguments;if(timer!==null){clearTimeout(timer)}timer=setTimeout(function(){fn.apply(null,args);timer=null;args=null},rate)};return{cancel:cancel,throttle:throttle}};return{adaptable:adaptable,first:first,last:last}});define("tinymce.core.keyboard.CefUtils",["tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.dom.NodeType","tinymce.core.util.Fun"],function(CaretPosition,CaretUtils,NodeType,Fun){var isContentEditableTrue=NodeType.isContentEditableTrue;var isContentEditableFalse=NodeType.isContentEditableFalse;var showCaret=function(direction,editor,node,before){return editor._selectionOverrides.showCaret(direction,node,before)};var getNodeRange=function(node){var rng=node.ownerDocument.createRange();rng.selectNode(node);return rng};var selectNode=function(editor,node){var e;e=editor.fire("BeforeObjectSelected",{target:node});if(e.isDefaultPrevented()){return null}return getNodeRange(node)};var renderCaretAtRange=function(editor,range){var caretPosition,ceRoot;range=CaretUtils.normalizeRange(1,editor.getBody(),range);caretPosition=CaretPosition.fromRangeStart(range);if(isContentEditableFalse(caretPosition.getNode())){return showCaret(1,editor,caretPosition.getNode(),!caretPosition.isAtEnd())}if(isContentEditableFalse(caretPosition.getNode(true))){return showCaret(1,editor,caretPosition.getNode(true),false)}ceRoot=editor.dom.getParent(caretPosition.getNode(),Fun.or(isContentEditableFalse,isContentEditableTrue));if(isContentEditableFalse(ceRoot)){return showCaret(1,editor,ceRoot,false)}return null};var renderRangeCaret=function(editor,range){var caretRange;if(!range||!range.collapsed){return range}caretRange=renderCaretAtRange(editor,range);if(caretRange){return caretRange}return range};return{showCaret:showCaret,selectNode:selectNode,renderCaretAtRange:renderCaretAtRange,renderRangeCaret:renderRangeCaret}});define("tinymce.core.focus.CefFocus",["ephox.katamari.api.Throttler","tinymce.core.keyboard.CefUtils"],function(Throttler,CefUtils){var setup=function(editor){var renderFocusCaret=Throttler.first(function(){if(!editor.removed){var caretRange=CefUtils.renderRangeCaret(editor,editor.selection.getRng());editor.selection.setRng(caretRange)}},0);editor.on("focus",function(){renderFocusCaret.throttle()});editor.on("blur",function(){renderFocusCaret.cancel()})};return{setup:setup}});define("tinymce.core.util.VK",["tinymce.core.Env"],function(Env){return{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return Env.mac?e.metaKey:e.ctrlKey&&!e.altKey}}});define("tinymce.core.SelectionOverrides",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","tinymce.core.DragDropOverrides","tinymce.core.EditorView","tinymce.core.Env","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.caret.FakeCaret","tinymce.core.caret.LineUtils","tinymce.core.dom.NodeType","tinymce.core.dom.RangePoint","tinymce.core.focus.CefFocus","tinymce.core.keyboard.CefUtils","tinymce.core.util.VK"],function(Arr,Remove,Element,Attr,SelectorFilter,SelectorFind,DragDropOverrides,EditorView,Env,CaretContainer,CaretPosition,CaretUtils,CaretWalker,FakeCaret,LineUtils,NodeType,RangePoint,CefFocus,CefUtils,VK){var isContentEditableTrue=NodeType.isContentEditableTrue,isContentEditableFalse=NodeType.isContentEditableFalse,isAfterContentEditableFalse=CaretUtils.isAfterContentEditableFalse,isBeforeContentEditableFalse=CaretUtils.isBeforeContentEditableFalse;var SelectionOverrides=function(editor){var isBlock=function(node){return editor.dom.isBlock(node)};var rootNode=editor.getBody();var fakeCaret=new FakeCaret(editor.getBody(),isBlock),realSelectionId="sel-"+editor.dom.uniqueId(),selectedContentEditableNode;var isFakeSelectionElement=function(elm){return editor.dom.hasClass(elm,"mce-offscreen-selection")};var getRealSelectionElement=function(){var container=editor.dom.get(realSelectionId);return container?container.getElementsByTagName("*")[0]:container};var setRange=function(range){if(range){editor.selection.setRng(range)}};var getRange=function(){return editor.selection.getRng()};var scrollIntoView=function(node,alignToTop){editor.selection.scrollIntoView(node,alignToTop)};var showCaret=function(direction,node,before){var e;e=editor.fire("ShowCaret",{target:node,direction:direction,before:before});if(e.isDefaultPrevented()){return null}scrollIntoView(node,direction===-1);return fakeCaret.show(before,node)};var getNormalizedRangeEndPoint=function(direction,range){range=CaretUtils.normalizeRange(direction,rootNode,range);if(direction==-1){return CaretPosition.fromRangeStart(range)}return CaretPosition.fromRangeEnd(range)};var showBlockCaretContainer=function(blockCaretContainer){if(blockCaretContainer.hasAttribute("data-mce-caret")){CaretContainer.showCaretContainerBlock(blockCaretContainer);setRange(getRange());scrollIntoView(blockCaretContainer[0])}};var registerEvents=function(){var getContentEditableRoot=function(node){var root=editor.getBody();while(node&&node!=root){if(isContentEditableTrue(node)||isContentEditableFalse(node)){return node}node=node.parentNode}return null};editor.on("mouseup",function(e){var range=getRange();if(range.collapsed&&EditorView.isXYInContentArea(editor,e.clientX,e.clientY)){setRange(CefUtils.renderCaretAtRange(editor,range))}});editor.on("click",function(e){var contentEditableRoot;contentEditableRoot=getContentEditableRoot(e.target);if(contentEditableRoot){if(isContentEditableFalse(contentEditableRoot)){e.preventDefault();editor.focus()}if(isContentEditableTrue(contentEditableRoot)){if(editor.dom.isChildOf(contentEditableRoot,editor.selection.getNode())){removeContentEditableSelection()}}}});editor.on("blur NewBlock",function(){removeContentEditableSelection()});var handleTouchSelect=function(editor){var moved=false;editor.on("touchstart",function(){moved=false});editor.on("touchmove",function(){moved=true});editor.on("touchend",function(e){var contentEditableRoot=getContentEditableRoot(e.target);if(isContentEditableFalse(contentEditableRoot)){if(!moved){e.preventDefault();setContentEditableSelection(CefUtils.selectNode(editor,contentEditableRoot))}}})};var hasNormalCaretPosition=function(elm){var caretWalker=new CaretWalker(elm);if(!elm.firstChild){return false}var startPos=CaretPosition.before(elm.firstChild);var newPos=caretWalker.next(startPos);return newPos&&!isBeforeContentEditableFalse(newPos)&&!isAfterContentEditableFalse(newPos)};var isInSameBlock=function(node1,node2){var block1=editor.dom.getParent(node1,editor.dom.isBlock);var block2=editor.dom.getParent(node2,editor.dom.isBlock);return block1===block2};var hasBetterMouseTarget=function(targetNode,caretNode){var targetBlock=editor.dom.getParent(targetNode,editor.dom.isBlock);var caretBlock=editor.dom.getParent(caretNode,editor.dom.isBlock);return targetBlock&&!isInSameBlock(targetBlock,caretBlock)&&hasNormalCaretPosition(targetBlock)};handleTouchSelect(editor);editor.on("mousedown",function(e){var contentEditableRoot;if(EditorView.isXYInContentArea(editor,e.clientX,e.clientY)===false){return}contentEditableRoot=getContentEditableRoot(e.target);if(contentEditableRoot){if(isContentEditableFalse(contentEditableRoot)){e.preventDefault();setContentEditableSelection(CefUtils.selectNode(editor,contentEditableRoot))}else{removeContentEditableSelection();if(!(isContentEditableTrue(contentEditableRoot)&&e.shiftKey)&&!RangePoint.isXYWithinRange(e.clientX,e.clientY,editor.selection.getRng())){editor.selection.placeCaretAt(e.clientX,e.clientY)}}}else{removeContentEditableSelection();hideFakeCaret();var caretInfo=LineUtils.closestCaret(rootNode,e.clientX,e.clientY);if(caretInfo){if(!hasBetterMouseTarget(e.target,caretInfo.node)){e.preventDefault();editor.getBody().focus();setRange(showCaret(1,caretInfo.node,caretInfo.before))}}}});editor.on("keypress",function(e){if(VK.modifierPressed(e)){return}switch(e.keyCode){default:if(isContentEditableFalse(editor.selection.getNode())){e.preventDefault()}break}});editor.on("getSelectionRange",function(e){var rng=e.range;if(selectedContentEditableNode){if(!selectedContentEditableNode.parentNode){selectedContentEditableNode=null;return}rng=rng.cloneRange();rng.selectNode(selectedContentEditableNode);e.range=rng}});editor.on("setSelectionRange",function(e){var rng;rng=setContentEditableSelection(e.range,e.forward);if(rng){e.range=rng}});editor.on("AfterSetSelectionRange",function(e){var rng=e.range;if(!isRangeInCaretContainer(rng)){hideFakeCaret()}if(!isFakeSelectionElement(rng.startContainer.parentNode)){removeContentEditableSelection()}});editor.on("copy",function(e){var clipboardData=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!Env.ie){var realSelectionElement=getRealSelectionElement();if(realSelectionElement){e.preventDefault();clipboardData.clearData();clipboardData.setData("text/html",realSelectionElement.outerHTML);clipboardData.setData("text/plain",realSelectionElement.outerText)}}});DragDropOverrides.init(editor);CefFocus.setup(editor)};var addCss=function(){var styles=editor.contentStyles,rootClass=".mce-content-body";styles.push(fakeCaret.getCss());styles.push(rootClass+" .mce-offscreen-selection {"+"position: absolute;"+"left: -9999999999px;"+"max-width: 1000000px;"+"}"+rootClass+" *[contentEditable=false] {"+"cursor: default;"+"}"+rootClass+" *[contentEditable=true] {"+"cursor: text;"+"}")};var isWithinCaretContainer=function(node){return CaretContainer.isCaretContainer(node)||CaretContainer.startsWithCaretContainer(node)||CaretContainer.endsWithCaretContainer(node)};var isRangeInCaretContainer=function(rng){return isWithinCaretContainer(rng.startContainer)||isWithinCaretContainer(rng.endContainer)};var setContentEditableSelection=function(range,forward){var node,$=editor.$,dom=editor.dom,$realSelectionContainer,sel,startContainer,startOffset,endOffset,e,caretPosition,targetClone,origTargetClone;if(!range){return null}if(range.collapsed){if(!isRangeInCaretContainer(range)){if(forward===false){caretPosition=getNormalizedRangeEndPoint(-1,range);if(isContentEditableFalse(caretPosition.getNode(true))){return showCaret(-1,caretPosition.getNode(true),false)}if(isContentEditableFalse(caretPosition.getNode())){return showCaret(-1,caretPosition.getNode(),!caretPosition.isAtEnd())}}else{caretPosition=getNormalizedRangeEndPoint(1,range);if(isContentEditableFalse(caretPosition.getNode())){return showCaret(1,caretPosition.getNode(),!caretPosition.isAtEnd())}if(isContentEditableFalse(caretPosition.getNode(true))){return showCaret(1,caretPosition.getNode(true),false)}}}return null}startContainer=range.startContainer;startOffset=range.startOffset;endOffset=range.endOffset;if(startContainer.nodeType===3&&startOffset===0&&isContentEditableFalse(startContainer.parentNode)){startContainer=startContainer.parentNode;startOffset=dom.nodeIndex(startContainer);startContainer=startContainer.parentNode}if(startContainer.nodeType!=1){return null}if(endOffset==startOffset+1){node=startContainer.childNodes[startOffset]}if(!isContentEditableFalse(node)){return null}targetClone=origTargetClone=node.cloneNode(true);e=editor.fire("ObjectSelected",{target:node,targetClone:targetClone});if(e.isDefaultPrevented()){return null}$realSelectionContainer=SelectorFind.descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).fold(function(){return $([])},function(elm){return $([elm.dom()])});targetClone=e.targetClone;if($realSelectionContainer.length===0){$realSelectionContainer=$('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",realSelectionId);$realSelectionContainer.appendTo(editor.getBody())}range=editor.dom.createRng();if(targetClone===origTargetClone&&Env.ie){$realSelectionContainer.empty().append('<p style="font-size: 0" data-mce-bogus="all">¬†</p>').append(targetClone);range.setStartAfter($realSelectionContainer[0].firstChild.firstChild);range.setEndAfter(targetClone)}else{$realSelectionContainer.empty().append("¬†").append(targetClone).append("¬†");range.setStart($realSelectionContainer[0].firstChild,1);range.setEnd($realSelectionContainer[0].lastChild,0)}$realSelectionContainer.css({top:dom.getPos(node,editor.getBody()).y});$realSelectionContainer[0].focus();sel=editor.selection.getSel();sel.removeAllRanges();sel.addRange(range);Arr.each(SelectorFilter.descendants(Element.fromDom(editor.getBody()),"*[data-mce-selected]"),function(elm){Attr.remove(elm,"data-mce-selected")});node.setAttribute("data-mce-selected",1);selectedContentEditableNode=node;hideFakeCaret();return range};var removeContentEditableSelection=function(){if(selectedContentEditableNode){selectedContentEditableNode.removeAttribute("data-mce-selected");SelectorFind.descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).each(Remove.remove);selectedContentEditableNode=null}};var destroy=function(){fakeCaret.destroy();selectedContentEditableNode=null};var hideFakeCaret=function(){fakeCaret.hide()};if(Env.ceFalse){registerEvents();addCss()}return{showCaret:showCaret,showBlockCaretContainer:showBlockCaretContainer,hideFakeCaret:hideFakeCaret,destroy:destroy}};return SelectionOverrides});define("tinymce.core.undo.Diff",[],function(){var KEEP=0,INSERT=1,DELETE=2;var diff=function(left,right){var size=left.length+right.length+2;var vDown=new Array(size);var vUp=new Array(size);var snake=function(start,end,diag){return{start:start,end:end,diag:diag}};var buildScript=function(start1,end1,start2,end2,script){var middle=getMiddleSnake(start1,end1,start2,end2);if(middle===null||middle.start===end1&&middle.diag===end1-end2||middle.end===start1&&middle.diag===start1-start2){var i=start1;var j=start2;while(i<end1||j<end2){if(i<end1&&j<end2&&left[i]===right[j]){script.push([KEEP,left[i]]);++i;++j}else{if(end1-start1>end2-start2){script.push([DELETE,left[i]]);++i}else{script.push([INSERT,right[j]]);++j}}}}else{buildScript(start1,middle.start,start2,middle.start-middle.diag,script);for(var i2=middle.start;i2<middle.end;++i2){script.push([KEEP,left[i2]])}buildScript(middle.end,end1,middle.end-middle.diag,end2,script)}};var buildSnake=function(start,diag,end1,end2){var end=start;while(end-diag<end2&&end<end1&&left[end]===right[end-diag]){++end}return snake(start,end,diag)};var getMiddleSnake=function(start1,end1,start2,end2){var m=end1-start1;var n=end2-start2;if(m===0||n===0){return null}var delta=m-n;var sum=n+m;var offset=(sum%2===0?sum:sum+1)/2;vDown[1+offset]=start1;vUp[1+offset]=end1+1;for(var d=0;d<=offset;++d){for(var k=-d;k<=d;k+=2){var i=k+offset;if(k===-d||k!=d&&vDown[i-1]<vDown[i+1]){vDown[i]=vDown[i+1]}else{vDown[i]=vDown[i-1]+1}var x=vDown[i];var y=x-start1+start2-k;while(x<end1&&y<end2&&left[x]===right[y]){vDown[i]=++x;++y}if(delta%2!=0&&delta-d<=k&&k<=delta+d){if(vUp[i-delta]<=vDown[i]){return buildSnake(vUp[i-delta],k+start1-start2,end1,end2)}}}for(k=delta-d;k<=delta+d;k+=2){i=k+offset-delta;if(k===delta-d||k!=delta+d&&vUp[i+1]<=vUp[i-1]){vUp[i]=vUp[i+1]-1}else{vUp[i]=vUp[i-1]}x=vUp[i]-1;y=x-start1+start2-k;while(x>=start1&&y>=start2&&left[x]===right[y]){vUp[i]=x--;y--}if(delta%2===0&&-d<=k&&k<=d){if(vUp[i]<=vDown[i+delta]){return buildSnake(vUp[i],k+start1-start2,end1,end2)}}}}};var script=[];buildScript(0,left.length,0,right.length,script);return script};return{KEEP:KEEP,DELETE:DELETE,INSERT:INSERT,diff:diff}});define("tinymce.core.undo.Fragments",["global!document","tinymce.core.html.Entities","tinymce.core.undo.Diff","tinymce.core.util.Arr"],function(document,Entities,Diff,Arr){var getOuterHtml=function(elm){if(elm.nodeType===1){return elm.outerHTML}else if(elm.nodeType===3){return Entities.encodeRaw(elm.data,false)}else if(elm.nodeType===8){return"\x3c!--"+elm.data+"--\x3e"}return""};var createFragment=function(html){var frag,node,container;container=document.createElement("div");frag=document.createDocumentFragment();if(html){container.innerHTML=html}while(node=container.firstChild){frag.appendChild(node)}return frag};var insertAt=function(elm,html,index){var fragment=createFragment(html);if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.insertBefore(fragment,target)}else{elm.appendChild(fragment)}};var removeAt=function(elm,index){if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.removeChild(target)}};var applyDiff=function(diff,elm){var index=0;Arr.each(diff,function(action){if(action[0]===Diff.KEEP){index++}else if(action[0]===Diff.INSERT){insertAt(elm,action[1],index);index++}else if(action[0]===Diff.DELETE){removeAt(elm,index)}})};var read=function(elm){return Arr.filter(Arr.map(elm.childNodes,getOuterHtml),function(item){return item.length>0})};var write=function(fragments,elm){var currentFragments=Arr.map(elm.childNodes,getOuterHtml);applyDiff(Diff.diff(currentFragments,fragments),elm);return elm};return{read:read,write:write}});define("tinymce.core.undo.Levels",["ephox.katamari.api.Arr","tinymce.core.dom.TrimHtml","tinymce.core.undo.Fragments"],function(Arr,TrimHtml,Fragments){var hasIframes=function(html){return html.indexOf("</iframe>")!==-1};var createFragmentedLevel=function(fragments){return{type:"fragmented",fragments:fragments,content:"",bookmark:null,beforeBookmark:null}};var createCompleteLevel=function(content){return{type:"complete",fragments:null,content:content,bookmark:null,beforeBookmark:null}};var createFromEditor=function(editor){var fragments,content,trimmedFragments;fragments=Fragments.read(editor.getBody());trimmedFragments=Arr.bind(fragments,function(html){var trimmed=TrimHtml.trimInternal(editor.serializer,html);return trimmed.length>0?[trimmed]:[]});content=trimmedFragments.join("");return hasIframes(content)?createFragmentedLevel(trimmedFragments):createCompleteLevel(content)};var applyToEditor=function(editor,level,before){if(level.type==="fragmented"){Fragments.write(level.fragments,editor.getBody())}else{editor.setContent(level.content,{format:"raw"})}editor.selection.moveToBookmark(before?level.beforeBookmark:level.bookmark)};var getLevelContent=function(level){return level.type==="fragmented"?level.fragments.join(""):level.content};var isEq=function(level1,level2){return!!level1&&!!level2&&getLevelContent(level1)===getLevelContent(level2)};return{createFragmentedLevel:createFragmentedLevel,createCompleteLevel:createCompleteLevel,createFromEditor:createFromEditor,applyToEditor:applyToEditor,isEq:isEq}});define("tinymce.core.UndoManager",["tinymce.core.dom.GetBookmark","tinymce.core.undo.Levels","tinymce.core.util.Tools"],function(GetBookmark,Levels,Tools){return function(editor){var self=this,index=0,data=[],beforeBookmark,isFirstTypedCharacter,locks=0;var isUnlocked=function(){return locks===0};var setTyping=function(typing){if(isUnlocked()){self.typing=typing}};var setDirty=function(state){editor.setDirty(state)};var addNonTypingUndoLevel=function(e){setTyping(false);self.add({},e)};var endTyping=function(){if(self.typing){setTyping(false);self.add()}};editor.on("init",function(){self.add()});editor.on("BeforeExecCommand",function(e){var cmd=e.command;if(cmd!=="Undo"&&cmd!=="Redo"&&cmd!=="mceRepaint"){endTyping();self.beforeChange()}});editor.on("ExecCommand",function(e){var cmd=e.command;if(cmd!=="Undo"&&cmd!=="Redo"&&cmd!=="mceRepaint"){addNonTypingUndoLevel(e)}});editor.on("ObjectResizeStart Cut",function(){self.beforeChange()});editor.on("SaveContent ObjectResized blur",addNonTypingUndoLevel);editor.on("DragEnd",addNonTypingUndoLevel);editor.on("KeyUp",function(e){var keyCode=e.keyCode;if(e.isDefaultPrevented()){return}if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode===45||e.ctrlKey){addNonTypingUndoLevel();editor.nodeChanged()}if(keyCode===46||keyCode===8){editor.nodeChanged()}if(isFirstTypedCharacter&&self.typing&&Levels.isEq(Levels.createFromEditor(editor),data[0])===false){if(editor.isDirty()===false){setDirty(true);editor.fire("change",{level:data[0],lastLevel:null})}editor.fire("TypingUndo");isFirstTypedCharacter=false;editor.nodeChanged()}});editor.on("KeyDown",function(e){var keyCode=e.keyCode;if(e.isDefaultPrevented()){return}if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode===45){if(self.typing){addNonTypingUndoLevel(e)}return}var modKey=e.ctrlKey&&!e.altKey||e.metaKey;if((keyCode<16||keyCode>20)&&keyCode!==224&&keyCode!==91&&!self.typing&&!modKey){self.beforeChange();setTyping(true);self.add({},e);isFirstTypedCharacter=true}});editor.on("MouseDown",function(e){if(self.typing){addNonTypingUndoLevel(e)}});editor.addShortcut("meta+z","","Undo");editor.addShortcut("meta+y,meta+shift+z","","Redo");editor.on("AddUndo Undo Redo ClearUndos",function(e){if(!e.isDefaultPrevented()){editor.nodeChanged()}});self={data:data,typing:false,beforeChange:function(){if(isUnlocked()){beforeBookmark=GetBookmark.getUndoBookmark(editor.selection)}},add:function(level,event){var i,settings=editor.settings,lastLevel,currentLevel;currentLevel=Levels.createFromEditor(editor);level=level||{};level=Tools.extend(level,currentLevel);if(isUnlocked()===false||editor.removed){return null}lastLevel=data[index];if(editor.fire("BeforeAddUndo",{level:level,lastLevel:lastLevel,originalEvent:event}).isDefaultPrevented()){return null}if(lastLevel&&Levels.isEq(lastLevel,level)){return null}if(data[index]){data[index].beforeBookmark=beforeBookmark}if(settings.custom_undo_redo_levels){if(data.length>settings.custom_undo_redo_levels){for(i=0;i<data.length-1;i++){data[i]=data[i+1]}data.length--;index=data.length}}level.bookmark=GetBookmark.getUndoBookmark(editor.selection);if(index<data.length-1){data.length=index+1}data.push(level);index=data.length-1;var args={level:level,lastLevel:lastLevel,originalEvent:event};editor.fire("AddUndo",args);if(index>0){setDirty(true);editor.fire("change",args)}return level},undo:function(){var level;if(self.typing){self.add();self.typing=false;setTyping(false)}if(index>0){level=data[--index];Levels.applyToEditor(editor,level,true);setDirty(true);editor.fire("undo",{level:level})}return level},redo:function(){var level;if(index<data.length-1){level=data[++index];Levels.applyToEditor(editor,level,false);setDirty(true);editor.fire("redo",{level:level})}return level},clear:function(){data=[];index=0;self.typing=false;self.data=data;editor.fire("ClearUndos")},hasUndo:function(){return index>0||self.typing&&data[0]&&!Levels.isEq(Levels.createFromEditor(editor),data[0])},hasRedo:function(){return index<data.length-1&&!self.typing},transact:function(callback){endTyping();self.beforeChange();self.ignore(callback);return self.add()},ignore:function(callback){try{locks++;callback()}finally{locks--}},extra:function(callback1,callback2){var lastLevel,bookmark;if(self.transact(callback1)){bookmark=data[index].bookmark;lastLevel=data[index-1];Levels.applyToEditor(editor,lastLevel,true);if(self.transact(callback2)){data[index-1].beforeBookmark=bookmark}}}};return self}});define("tinymce.core.fmt.Hooks",["tinymce.core.util.Arr","tinymce.core.dom.NodeType","tinymce.core.dom.DomQuery"],function(Arr,NodeType,$){var postProcessHooks={},filter=Arr.filter,each=Arr.each;var addPostProcessHook=function(name,hook){var hooks=postProcessHooks[name];if(!hooks){postProcessHooks[name]=hooks=[]}postProcessHooks[name].push(hook)};var postProcess=function(name,editor){each(postProcessHooks[name],function(hook){hook(editor)})};addPostProcessHook("pre",function(editor){var rng=editor.selection.getRng(),isPre,blocks;var hasPreSibling=function(pre){return isPre(pre.previousSibling)&&Arr.indexOf(blocks,pre.previousSibling)!==-1};var joinPre=function(pre1,pre2){$(pre2).remove();$(pre1).append("<br><br>").append(pre2.childNodes)};isPre=NodeType.matchNodeNames("pre");if(!rng.collapsed){blocks=editor.selection.getSelectedBlocks();each(filter(filter(blocks,isPre),hasPreSibling),function(pre){joinPre(pre.previousSibling,pre)})}});return{postProcess:postProcess}});define("tinymce.core.selection.RangeWalk",["tinymce.core.util.Tools"],function(Tools){var each=Tools.each;var getEndChild=function(container,index){var childNodes=container.childNodes;index--;if(index>childNodes.length-1){index=childNodes.length-1}else if(index<0){index=0}return childNodes[index]||container};var walk=function(dom,rng,callback){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,ancestor,startPoint,endPoint,node,parent,siblings,nodes;nodes=dom.select("td[data-mce-selected],th[data-mce-selected]");if(nodes.length>0){each(nodes,function(node){callback([node])});return}var exclude=function(nodes){var node;node=nodes[0];if(node.nodeType===3&&node===startContainer&&startOffset>=node.nodeValue.length){nodes.splice(0,1)}node=nodes[nodes.length-1];if(endOffset===0&&nodes.length>0&&node===endContainer&&node.nodeType===3){nodes.splice(nodes.length-1,1)}return nodes};var collectSiblings=function(node,name,endNode){var siblings=[];for(;node&&node!=endNode;node=node[name]){siblings.push(node)}return siblings};var findEndPoint=function(node,root){do{if(node.parentNode===root){return node}node=node.parentNode}while(node)};var walkBoundary=function(startNode,endNode,next){var siblingName=next?"nextSibling":"previousSibling";for(node=startNode,parent=node.parentNode;node&&node!=endNode;node=parent){parent=node.parentNode;siblings=collectSiblings(node===startNode?node:node[siblingName],siblingName);if(siblings.length){if(!next){siblings.reverse()}callback(exclude(siblings))}}};if(startContainer.nodeType===1&&startContainer.hasChildNodes()){startContainer=startContainer.childNodes[startOffset]}if(endContainer.nodeType===1&&endContainer.hasChildNodes()){endContainer=getEndChild(endContainer,endOffset)}if(startContainer===endContainer){return callback(exclude([startContainer]))}ancestor=dom.findCommonAncestor(startContainer,endContainer);for(node=startContainer;node;node=node.parentNode){if(node===endContainer){return walkBoundary(startContainer,ancestor,true)}if(node===ancestor){break}}for(node=endContainer;node;node=node.parentNode){if(node===startContainer){return walkBoundary(endContainer,ancestor)}if(node===ancestor){break}}startPoint=findEndPoint(startContainer,ancestor)||startContainer;endPoint=findEndPoint(endContainer,ancestor)||endContainer;walkBoundary(startContainer,startPoint,true);siblings=collectSiblings(startPoint===startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint===endContainer?endPoint.nextSibling:endPoint);if(siblings.length){callback(exclude(siblings))}walkBoundary(endContainer,endPoint)};return{walk:walk}});define("tinymce.core.fmt.RemoveFormat",["tinymce.core.dom.Bookmarks","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.ExpandRange","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.selection.RangeWalk","tinymce.core.util.Tools"],function(Bookmarks,NodeType,TreeWalker,CaretFormat,ExpandRange,FormatUtils,MatchFormat,RangeWalk,Tools){var MCE_ATTR_RE=/^(src|href|style)$/;var each=Tools.each;var isEq=FormatUtils.isEq;var isTableCell=function(node){return/^(TH|TD)$/.test(node.nodeName)};var getContainer=function(ed,rng,start){var container,offset,lastIdx;container=rng[start?"startContainer":"endContainer"];offset=rng[start?"startOffset":"endOffset"];if(NodeType.isElement(container)){lastIdx=container.childNodes.length-1;if(!start&&offset){offset--}container=container.childNodes[offset>lastIdx?lastIdx:offset]}if(NodeType.isText(container)&&start&&offset>=container.nodeValue.length){container=new TreeWalker(container,ed.getBody()).next()||container}if(NodeType.isText(container)&&!start&&offset===0){container=new TreeWalker(container,ed.getBody()).prev()||container}return container};var wrap=function(dom,node,name,attrs){var wrapper=dom.create(name,attrs);node.parentNode.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper};var matchName=function(dom,node,format){if(isEq(node,format.inline)){return true}if(isEq(node,format.block)){return true}if(format.selector){return NodeType.isElement(node)&&dom.is(node,format.selector)}};var isColorFormatAndAnchor=function(node,format){return format.links&&node.tagName==="A"};var find=function(dom,node,next,inc){node=FormatUtils.getNonWhiteSpaceSibling(node,next,inc);return!node||(node.nodeName==="BR"||dom.isBlock(node))};var removeNode=function(ed,node,format){var parentNode=node.parentNode,rootBlockElm;var dom=ed.dom,forcedRootBlock=ed.settings.forced_root_block;if(format.block){if(!forcedRootBlock){if(dom.isBlock(node)&&!dom.isBlock(parentNode)){if(!find(dom,node,false)&&!find(dom,node.firstChild,true,1)){node.insertBefore(dom.create("br"),node.firstChild)}if(!find(dom,node,true)&&!find(dom,node.lastChild,false,1)){node.appendChild(dom.create("br"))}}}else{if(parentNode===dom.getRoot()){if(!format.list_block||!isEq(node,format.list_block)){each(Tools.grep(node.childNodes),function(node){if(FormatUtils.isValid(ed,forcedRootBlock,node.nodeName.toLowerCase())){if(!rootBlockElm){rootBlockElm=wrap(dom,node,forcedRootBlock);dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs)}else{rootBlockElm.appendChild(node)}}else{rootBlockElm=0}})}}}}if(format.selector&&format.inline&&!isEq(format.inline,node)){return}dom.remove(node,1)};var removeFormat=function(ed,format,vars,node,compareNode){var i,attrs,stylesModified,dom=ed.dom;if(!matchName(dom,node,format)&&!isColorFormatAndAnchor(node,format)){return false}if(format.remove!=="all"){each(format.styles,function(value,name){value=FormatUtils.normalizeStyleValue(dom,FormatUtils.replaceVars(value,vars),name);if(typeof name==="number"){name=value;compareNode=0}if(format.remove_similar||(!compareNode||isEq(FormatUtils.getStyle(dom,compareNode,name),value))){dom.setStyle(node,name,"")}stylesModified=1});if(stylesModified&&dom.getAttrib(node,"style")===""){node.removeAttribute("style");node.removeAttribute("data-mce-style")}each(format.attributes,function(value,name){var valueOut;value=FormatUtils.replaceVars(value,vars);if(typeof name==="number"){name=value;compareNode=0}if(!compareNode||isEq(dom.getAttrib(compareNode,name),value)){if(name==="class"){value=dom.getAttrib(node,name);if(value){valueOut="";each(value.split(/\s+/),function(cls){if(/mce\-\w+/.test(cls)){valueOut+=(valueOut?" ":"")+cls}});if(valueOut){dom.setAttrib(node,name,valueOut);return}}}if(name==="class"){node.removeAttribute("className")}if(MCE_ATTR_RE.test(name)){node.removeAttribute("data-mce-"+name)}node.removeAttribute(name)}});each(format.classes,function(value){value=FormatUtils.replaceVars(value,vars);if(!compareNode||dom.hasClass(compareNode,value)){dom.removeClass(node,value)}});attrs=dom.getAttribs(node);for(i=0;i<attrs.length;i++){var attrName=attrs[i].nodeName;if(attrName.indexOf("_")!==0&&attrName.indexOf("data-")!==0){return false}}}if(format.remove!=="none"){removeNode(ed,node,format);return true}};var findFormatRoot=function(editor,container,name,vars,similar){var formatRoot;each(FormatUtils.getParents(editor.dom,container.parentNode).reverse(),function(parent){var format;if(!formatRoot&&parent.id!=="_start"&&parent.id!=="_end"){format=MatchFormat.matchNode(editor,parent,name,vars,similar);if(format&&format.split!==false){formatRoot=parent}}});return formatRoot};var wrapAndSplit=function(editor,formatList,formatRoot,container,target,split,format,vars){var parent,clone,lastClone,firstClone,i,formatRootParent,dom=editor.dom;if(formatRoot){formatRootParent=formatRoot.parentNode;for(parent=container.parentNode;parent&&parent!==formatRootParent;parent=parent.parentNode){clone=dom.clone(parent,false);for(i=0;i<formatList.length;i++){if(removeFormat(editor,formatList[i],vars,clone,clone)){clone=0;break}}if(clone){if(lastClone){clone.appendChild(lastClone)}if(!firstClone){firstClone=clone}lastClone=clone}}if(split&&(!format.mixed||!dom.isBlock(formatRoot))){container=dom.split(formatRoot,container)}if(lastClone){target.parentNode.insertBefore(lastClone,target);firstClone.appendChild(target)}}return container};var remove=function(ed,name,vars,node,similar){var formatList=ed.formatter.get(name),format=formatList[0];var bookmark,rng,contentEditable=true,dom=ed.dom,selection=ed.selection;var splitToFormatRoot=function(container){var formatRoot=findFormatRoot(ed,container,name,vars,similar);return wrapAndSplit(ed,formatList,formatRoot,container,container,true,format,vars)};var process=function(node){var children,i,l,lastContentEditable,hasContentEditableState;if(NodeType.isElement(node)&&dom.getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=dom.getContentEditable(node)==="true";hasContentEditableState=true}children=Tools.grep(node.childNodes);if(contentEditable&&!hasContentEditableState){for(i=0,l=formatList.length;i<l;i++){if(removeFormat(ed,formatList[i],vars,node,node)){break}}}if(format.deep){if(children.length){for(i=0,l=children.length;i<l;i++){process(children[i])}if(hasContentEditableState){contentEditable=lastContentEditable}}}};var unwrap=function(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];if(Bookmarks.isBookmarkNode(out)){out=out[start?"firstChild":"lastChild"]}if(NodeType.isText(out)&&out.data.length===0){out=start?node.previousSibling||node.nextSibling:node.nextSibling||node.previousSibling}dom.remove(node,true);return out};var removeRngStyle=function(rng){var startContainer,endContainer;var commonAncestorContainer=rng.commonAncestorContainer;rng=ExpandRange.expandRng(ed,rng,formatList,true);if(format.split){startContainer=getContainer(ed,rng,true);endContainer=getContainer(ed,rng);if(startContainer!==endContainer){if(/^(TR|TH|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild){if(startContainer.nodeName==="TR"){startContainer=startContainer.firstChild.firstChild||startContainer}else{startContainer=startContainer.firstChild||startContainer}}if(commonAncestorContainer&&/^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName)&&isTableCell(endContainer)&&endContainer.firstChild){endContainer=endContainer.firstChild||endContainer}if(dom.isChildOf(startContainer,endContainer)&&startContainer!==endContainer&&!dom.isBlock(endContainer)&&!isTableCell(startContainer)&&!isTableCell(endContainer)){startContainer=wrap(dom,startContainer,"span",{id:"_start","data-mce-type":"bookmark"});splitToFormatRoot(startContainer);startContainer=unwrap(true);return}startContainer=wrap(dom,startContainer,"span",{id:"_start","data-mce-type":"bookmark"});endContainer=wrap(dom,endContainer,"span",{id:"_end","data-mce-type":"bookmark"});splitToFormatRoot(startContainer);splitToFormatRoot(endContainer);startContainer=unwrap(true);endContainer=unwrap()}else{startContainer=endContainer=splitToFormatRoot(startContainer)}rng.startContainer=startContainer.parentNode?startContainer.parentNode:startContainer;rng.startOffset=dom.nodeIndex(startContainer);rng.endContainer=endContainer.parentNode?endContainer.parentNode:endContainer;rng.endOffset=dom.nodeIndex(endContainer)+1}RangeWalk.walk(dom,rng,function(nodes){each(nodes,function(node){process(node);if(NodeType.isElement(node)&&ed.dom.getStyle(node,"text-decoration")==="underline"&&node.parentNode&&FormatUtils.getTextDecoration(dom,node.parentNode)==="underline"){removeFormat(ed,{deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,node)}})})};if(node){if(node.nodeType){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);removeRngStyle(rng)}else{removeRngStyle(node)}return}if(dom.getContentEditable(selection.getNode())==="false"){node=selection.getNode();for(var i=0,l=formatList.length;i<l;i++){if(formatList[i].ceFalseOverride){if(removeFormat(ed,formatList[i],vars,node,node)){break}}}return}if(!selection.isCollapsed()||!format.inline||dom.select("td[data-mce-selected],th[data-mce-selected]").length){bookmark=selection.getBookmark();removeRngStyle(selection.getRng(true));selection.moveToBookmark(bookmark);if(format.inline&&MatchFormat.match(ed,name,vars,selection.getStart())){FormatUtils.moveStart(dom,selection,selection.getRng(true))}ed.nodeChanged()}else{CaretFormat.removeCaretFormat(ed,name,vars,similar)}};return{removeFormat:removeFormat,remove:remove}});define("tinymce.core.fmt.MergeFormats",["ephox.katamari.api.Fun","tinymce.core.dom.Bookmarks","tinymce.core.dom.ElementUtils","tinymce.core.dom.NodeType","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.RemoveFormat","tinymce.core.util.Tools"],function(Fun,Bookmarks,ElementUtils,NodeType,CaretFormat,FormatUtils,MatchFormat,RemoveFormat,Tools){var each=Tools.each;var isElementNode=function(node){return node&&node.nodeType===1&&!Bookmarks.isBookmarkNode(node)&&!CaretFormat.isCaretNode(node)&&!NodeType.isBogus(node)};var findElementSibling=function(node,siblingName){var sibling;for(sibling=node;sibling;sibling=sibling[siblingName]){if(sibling.nodeType===3&&sibling.nodeValue.length!==0){return node}if(sibling.nodeType===1&&!Bookmarks.isBookmarkNode(sibling)){return sibling}}return node};var mergeSiblingsNodes=function(dom,prev,next){var sibling,tmpSibling,elementUtils=new ElementUtils(dom);if(prev&&next){prev=findElementSibling(prev,"previousSibling");next=findElementSibling(next,"nextSibling");if(elementUtils.compare(prev,next)){for(sibling=prev.nextSibling;sibling&&sibling!==next;){tmpSibling=sibling;sibling=sibling.nextSibling;prev.appendChild(tmpSibling)}dom.remove(next);Tools.each(Tools.grep(next.childNodes),function(node){prev.appendChild(node)});return prev}}return next};var processChildElements=function(node,filter,process){each(node.childNodes,function(node){if(isElementNode(node)){if(filter(node)){process(node)}if(node.hasChildNodes()){processChildElements(node,filter,process)}}})};var hasStyle=function(dom,name){return Fun.curry(function(name,node){return!!(node&&FormatUtils.getStyle(dom,node,name))},name)};var applyStyle=function(dom,name,value){return Fun.curry(function(name,value,node){dom.setStyle(node,name,value);if(node.getAttribute("style")===""){node.removeAttribute("style")}unwrapEmptySpan(dom,node)},name,value)};var unwrapEmptySpan=function(dom,node){if(node.nodeName==="SPAN"&&dom.getAttribs(node).length===0){dom.remove(node,true)}};var processUnderlineAndColor=function(dom,node){var textDecoration;if(node.nodeType===1&&node.parentNode&&node.parentNode.nodeType===1){textDecoration=FormatUtils.getTextDecoration(dom,node.parentNode);if(dom.getStyle(node,"color")&&textDecoration){dom.setStyle(node,"text-decoration",textDecoration)}else if(dom.getStyle(node,"text-decoration")===textDecoration){dom.setStyle(node,"text-decoration",null)}}};var mergeUnderlineAndColor=function(dom,format,vars,node){if(format.styles.color||format.styles.textDecoration){Tools.walk(node,Fun.curry(processUnderlineAndColor,dom),"childNodes");processUnderlineAndColor(dom,node)}};var mergeBackgroundColorAndFontSize=function(dom,format,vars,node){if(format.styles&&format.styles.backgroundColor){processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"backgroundColor",FormatUtils.replaceVars(format.styles.backgroundColor,vars)))}};var mergeSubSup=function(dom,format,vars,node){if(format.inline==="sub"||format.inline==="sup"){processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"fontSize",""));dom.remove(dom.select(format.inline==="sup"?"sub":"sup",node),true)}};var mergeSiblings=function(dom,format,vars,node){if(node&&format.merge_siblings!==false){node=mergeSiblingsNodes(dom,FormatUtils.getNonWhiteSpaceSibling(node),node);node=mergeSiblingsNodes(dom,node,FormatUtils.getNonWhiteSpaceSibling(node,true))}};var clearChildStyles=function(dom,format,node){if(format.clear_child_styles){var selector=format.links?"*:not(a)":"*";each(dom.select(selector,node),function(node){if(isElementNode(node)){each(format.styles,function(value,name){dom.setStyle(node,name,"")})}})}};var mergeWithChildren=function(editor,formatList,vars,node){each(formatList,function(format){each(editor.dom.select(format.inline,node),function(child){if(!isElementNode(child)){return}RemoveFormat.removeFormat(editor,format,vars,child,format.exact?child:null)});clearChildStyles(editor.dom,format,node)})};var mergeWithParents=function(editor,format,name,vars,node){if(MatchFormat.matchNode(editor,node.parentNode,name,vars)){if(RemoveFormat.removeFormat(editor,format,vars,node)){return}}if(format.merge_with_parents){editor.dom.getParent(node.parentNode,function(parent){if(MatchFormat.matchNode(editor,parent,name,vars)){RemoveFormat.removeFormat(editor,format,vars,node);return true}})}};return{mergeWithChildren:mergeWithChildren,mergeUnderlineAndColor:mergeUnderlineAndColor,mergeBackgroundColorAndFontSize:mergeBackgroundColorAndFontSize,mergeSubSup:mergeSubSup,mergeSiblings:mergeSiblings,mergeWithParents:mergeWithParents}});define("tinymce.core.fmt.ApplyFormat",["tinymce.core.dom.Bookmarks","tinymce.core.dom.NodeType","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.ExpandRange","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.Hooks","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.MergeFormats","tinymce.core.selection.RangeNormalizer","tinymce.core.selection.RangeWalk","tinymce.core.util.Tools"],function(Bookmarks,NodeType,CaretFormat,ExpandRange,FormatUtils,Hooks,MatchFormat,MergeFormats,RangeNormalizer,RangeWalk,Tools){var each=Tools.each;var isElementNode=function(node){return node&&node.nodeType===1&&!Bookmarks.isBookmarkNode(node)&&!CaretFormat.isCaretNode(node)&&!NodeType.isBogus(node)};var applyFormat=function(ed,name,vars,node){var formatList=ed.formatter.get(name),format=formatList[0],bookmark,rng,isCollapsed=!node&&ed.selection.isCollapsed();var dom=ed.dom,selection=ed.selection;var setElementFormat=function(elm,fmt){fmt=fmt||format;if(elm){if(fmt.onformat){fmt.onformat(elm,fmt,vars,node)}each(fmt.styles,function(value,name){dom.setStyle(elm,name,FormatUtils.replaceVars(value,vars))});if(fmt.styles){var styleVal=dom.getAttrib(elm,"style");if(styleVal){elm.setAttribute("data-mce-style",styleVal)}}each(fmt.attributes,function(value,name){dom.setAttrib(elm,name,FormatUtils.replaceVars(value,vars))});each(fmt.classes,function(value){value=FormatUtils.replaceVars(value,vars);if(!dom.hasClass(elm,value)){dom.addClass(elm,value)}})}};var applyNodeStyle=function(formatList,node){var found=false;if(!format.selector){return false}each(formatList,function(format){if("collapsed"in format&&format.collapsed!==isCollapsed){return}if(dom.is(node,format.selector)&&!CaretFormat.isCaretNode(node)){setElementFormat(node,format);found=true;return false}});return found};var applyRngStyle=function(dom,rng,bookmark,nodeSpecific){var newWrappers=[],wrapName,wrapElm,contentEditable=true;wrapName=format.inline||format.block;wrapElm=dom.create(wrapName);setElementFormat(wrapElm);RangeWalk.walk(dom,rng,function(nodes){var currentWrapElm;var process=function(node){var nodeName,parentName,hasContentEditableState,lastContentEditable;lastContentEditable=contentEditable;nodeName=node.nodeName.toLowerCase();parentName=node.parentNode.nodeName.toLowerCase();if(node.nodeType===1&&dom.getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=dom.getContentEditable(node)==="true";hasContentEditableState=true}if(FormatUtils.isEq(nodeName,"br")){currentWrapElm=0;if(format.block){dom.remove(node)}return}if(format.wrapper&&MatchFormat.matchNode(ed,node,name,vars)){currentWrapElm=0;return}if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&FormatUtils.isTextBlock(ed,nodeName)&&FormatUtils.isValid(ed,parentName,wrapName)){node=dom.rename(node,wrapName);setElementFormat(node);newWrappers.push(node);currentWrapElm=0;return}if(format.selector){var found=applyNodeStyle(formatList,node);if(!format.inline||found){currentWrapElm=0;return}}if(contentEditable&&!hasContentEditableState&&FormatUtils.isValid(ed,wrapName,nodeName)&&FormatUtils.isValid(ed,parentName,wrapName)&&!(!nodeSpecific&&node.nodeType===3&&node.nodeValue.length===1&&node.nodeValue.charCodeAt(0)===65279)&&!CaretFormat.isCaretNode(node)&&(!format.inline||!dom.isBlock(node))){if(!currentWrapElm){currentWrapElm=dom.clone(wrapElm,false);node.parentNode.insertBefore(currentWrapElm,node);newWrappers.push(currentWrapElm)}currentWrapElm.appendChild(node)}else{currentWrapElm=0;each(Tools.grep(node.childNodes),process);if(hasContentEditableState){contentEditable=lastContentEditable}currentWrapElm=0}};each(nodes,process)});if(format.links===true){each(newWrappers,function(node){var process=function(node){if(node.nodeName==="A"){setElementFormat(node,format)}each(Tools.grep(node.childNodes),process)};process(node)})}each(newWrappers,function(node){var childCount;var getChildCount=function(node){var count=0;each(node.childNodes,function(node){if(!FormatUtils.isWhiteSpaceNode(node)&&!Bookmarks.isBookmarkNode(node)){count++}});return count};var getChildElementNode=function(root){var child=false;each(root.childNodes,function(node){if(isElementNode(node)){child=node;return false}});return child};var mergeStyles=function(node){var child,clone;child=getChildElementNode(node);if(child&&!Bookmarks.isBookmarkNode(child)&&MatchFormat.matchName(dom,child,format)){clone=dom.clone(child,false);setElementFormat(clone);dom.replace(clone,node,true);dom.remove(child,1)}return clone||node};childCount=getChildCount(node);if((newWrappers.length>1||!dom.isBlock(node))&&childCount===0){dom.remove(node,1);return}if(format.inline||format.wrapper){if(!format.exact&&childCount===1){node=mergeStyles(node)}MergeFormats.mergeWithChildren(ed,formatList,vars,node);MergeFormats.mergeWithParents(ed,format,name,vars,node);MergeFormats.mergeBackgroundColorAndFontSize(dom,format,vars,node);MergeFormats.mergeSubSup(dom,format,vars,node);MergeFormats.mergeSiblings(dom,format,vars,node)}})};if(dom.getContentEditable(selection.getNode())==="false"){node=selection.getNode();for(var i=0,l=formatList.length;i<l;i++){if(formatList[i].ceFalseOverride&&dom.is(node,formatList[i].selector)){setElementFormat(node,formatList[i]);return}}return}if(format){if(node){if(node.nodeType){if(!applyNodeStyle(formatList,node)){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);applyRngStyle(dom,ExpandRange.expandRng(ed,rng,formatList),null,true)}}else{applyRngStyle(dom,node,null,true)}}else{if(!isCollapsed||!format.inline||dom.select("td[data-mce-selected],th[data-mce-selected]").length){var curSelNode=ed.selection.getNode();if(!ed.settings.forced_root_block&&formatList[0].defaultBlock&&!dom.getParent(curSelNode,dom.isBlock)){applyFormat(ed,formatList[0].defaultBlock)}ed.selection.setRng(RangeNormalizer.normalize(ed.selection.getRng()));bookmark=selection.getBookmark();applyRngStyle(dom,ExpandRange.expandRng(ed,selection.getRng(true),formatList),bookmark);if(format.styles){MergeFormats.mergeUnderlineAndColor(dom,format,vars,curSelNode)}selection.moveToBookmark(bookmark);FormatUtils.moveStart(dom,selection,selection.getRng(true));ed.nodeChanged()}else{CaretFormat.applyCaretFormat(ed,name,vars)}}Hooks.postProcess(name,ed)}};return{applyFormat:applyFormat}});define("tinymce.core.fmt.FormatChanged",["ephox.katamari.api.Cell","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.util.Tools"],function(Cell,FormatUtils,MatchFormat,Tools){var each=Tools.each;var setup=function(formatChangeData,editor){var currentFormats={};formatChangeData.set({});editor.on("NodeChange",function(e){var parents=FormatUtils.getParents(editor.dom,e.element),matchedFormats={};parents=Tools.grep(parents,function(node){return node.nodeType===1&&!node.getAttribute("data-mce-bogus")});each(formatChangeData.get(),function(callbacks,format){each(parents,function(node){if(editor.formatter.matchNode(node,format,{},callbacks.similar)){if(!currentFormats[format]){each(callbacks,function(callback){callback(true,{node:node,format:format,parents:parents})});currentFormats[format]=callbacks}matchedFormats[format]=callbacks;return false}if(MatchFormat.matchesUnInheritedFormatSelector(editor,node,format)){return false}})});each(currentFormats,function(callbacks,format){if(!matchedFormats[format]){delete currentFormats[format];each(callbacks,function(callback){callback(false,{node:e.element,format:format,parents:parents})})}})})};var addListeners=function(formatChangeData,formats,callback,similar){var formatChangeItems=formatChangeData.get();each(formats.split(","),function(format){if(!formatChangeItems[format]){formatChangeItems[format]=[];formatChangeItems[format].similar=similar}formatChangeItems[format].push(callback)});formatChangeData.set(formatChangeItems)};var formatChanged=function(editor,formatChangeState,formats,callback,similar){if(formatChangeState.get()===null){setup(formatChangeState,editor)}addListeners(formatChangeState,formats,callback,similar)};return{formatChanged:formatChanged}});define("tinymce.core.fmt.DefaultFormats",["tinymce.core.util.Tools"],function(Tools){var get=function(dom){var formats={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:false,classes:"align-left",ceFalseOverride:true,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:false,preview:false,defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:false,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:false,classes:"align-center",ceFalseOverride:true,preview:"font-family font-size"},{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:false},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:false,classes:"align-right",ceFalseOverride:true,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:false,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:false,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:true,remove_similar:true,clear_child_styles:true},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:true,remove_similar:true,clear_child_styles:true},fontname:{inline:"span",styles:{fontFamily:"%value"},clear_child_styles:true},fontsize:{inline:"span",styles:{fontSize:"%value"},clear_child_styles:true},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(){return true},onformat:function(elm,fmt,vars){Tools.each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]};Tools.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(name){formats[name]={block:name,remove:"all"}});return formats};return{get:get}});define("tinymce.core.fmt.FormatRegistry",["tinymce.core.fmt.DefaultFormats","tinymce.core.util.Tools"],function(DefaultFormats,Tools){return function(editor){var formats={};var get=function(name){return name?formats[name]:formats};var register=function(name,format){if(name){if(typeof name!=="string"){Tools.each(name,function(format,name){register(name,format)})}else{format=format.length?format:[format];Tools.each(format,function(format){if(typeof format.deep==="undefined"){format.deep=!format.selector}if(typeof format.split==="undefined"){format.split=!format.selector||format.inline}if(typeof format.remove==="undefined"&&format.selector&&!format.inline){format.remove="none"}if(format.selector&&format.inline){format.mixed=true;format.block_expand=true}if(typeof format.classes==="string"){format.classes=format.classes.split(/\s+/)}});formats[name]=format}}};var unregister=function(name){if(name&&formats[name]){delete formats[name]}return formats};register(DefaultFormats.get(editor.dom));register(editor.settings.formats);return{get:get,register:register,unregister:unregister}}});define("tinymce.core.fmt.Preview",["tinymce.core.dom.DOMUtils","tinymce.core.util.Tools","tinymce.core.html.Schema"],function(DOMUtils,Tools,Schema){var each=Tools.each;var dom=DOMUtils.DOM;var parsedSelectorToHtml=function(ancestry,editor){var elm,item,fragment;var schema=editor&&editor.schema||new Schema({});var decorate=function(elm,item){if(item.classes.length){dom.addClass(elm,item.classes.join(" "))}dom.setAttribs(elm,item.attrs)};var createElement=function(sItem){var elm;item=typeof sItem==="string"?{name:sItem,classes:[],attrs:{}}:sItem;elm=dom.create(item.name);decorate(elm,item);return elm};var getRequiredParent=function(elm,candidate){var name=typeof elm!=="string"?elm.nodeName.toLowerCase():elm;var elmRule=schema.getElementRule(name);var parentsRequired=elmRule&&elmRule.parentsRequired;if(parentsRequired&&parentsRequired.length){return candidate&&Tools.inArray(parentsRequired,candidate)!==-1?candidate:parentsRequired[0]}else{return false}};var wrapInHtml=function(elm,ancestry,siblings){var parent,parentCandidate,parentRequired;var ancestor=ancestry.length>0&&ancestry[0];var ancestorName=ancestor&&ancestor.name;parentRequired=getRequiredParent(elm,ancestorName);if(parentRequired){if(ancestorName===parentRequired){parentCandidate=ancestry[0];ancestry=ancestry.slice(1)}else{parentCandidate=parentRequired}}else if(ancestor){parentCandidate=ancestry[0];ancestry=ancestry.slice(1)}else if(!siblings){return elm}if(parentCandidate){parent=createElement(parentCandidate);parent.appendChild(elm)}if(siblings){if(!parent){parent=dom.create("div");parent.appendChild(elm)}Tools.each(siblings,function(sibling){var siblingElm=createElement(sibling);parent.insertBefore(siblingElm,elm)})}return wrapInHtml(parent,ancestry,parentCandidate&&parentCandidate.siblings)};if(ancestry&&ancestry.length){item=ancestry[0];elm=createElement(item);fragment=dom.create("div");fragment.appendChild(wrapInHtml(elm,ancestry.slice(1),item.siblings));return fragment}else{return""}};var selectorToHtml=function(selector,editor){return parsedSelectorToHtml(parseSelector(selector),editor)};var parseSelectorItem=function(item){var tagName;var obj={classes:[],attrs:{}};item=obj.selector=Tools.trim(item);if(item!=="*"){tagName=item.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function($0,$1,$2,$3,$4){switch($1){case"#":obj.attrs.id=$2;break;case".":obj.classes.push($2);break;case":":if(Tools.inArray("checked disabled enabled read-only required".split(" "),$2)!==-1){obj.attrs[$2]=$2}break}if($3==="["){var m=$4.match(/([\w\-]+)(?:\=\"([^\"]+))?/);if(m){obj.attrs[m[1]]=m[2]}}return""})}obj.name=tagName||"div";return obj};var parseSelector=function(selector){if(!selector||typeof selector!=="string"){return[]}selector=selector.split(/\s*,\s*/)[0];selector=selector.replace(/\s*(~\+|~|\+|>)\s*/g,"$1");return Tools.map(selector.split(/(?:>|\s+(?![^\[\]]+\]))/),function(item){var siblings=Tools.map(item.split(/(?:~\+|~|\+)/),parseSelectorItem);var obj=siblings.pop();if(siblings.length){obj.siblings=siblings}return obj}).reverse()};var getCssText=function(editor,format){var name,previewFrag,previewElm,items;var previewCss="",parentFontSize,previewStyles;previewStyles=editor.settings.preview_styles;if(previewStyles===false){return""}if(typeof previewStyles!=="string"){previewStyles="font-family font-size font-weight font-style text-decoration "+"text-transform color background-color border border-radius outline text-shadow"}var removeVars=function(val){return val.replace(/%(\w+)/g,"")};if(typeof format==="string"){format=editor.formatter.get(format);if(!format){return}format=format[0]}if("preview"in format){previewStyles=format.preview;if(previewStyles===false){return""}}name=format.block||format.inline||"span";items=parseSelector(format.selector);if(items.length){if(!items[0].name){items[0].name=name}name=format.selector;previewFrag=parsedSelectorToHtml(items,editor)}else{previewFrag=parsedSelectorToHtml([name],editor)}previewElm=dom.select(name,previewFrag)[0]||previewFrag.firstChild;each(format.styles,function(value,name){value=removeVars(value);if(value){dom.setStyle(previewElm,name,value)}});each(format.attributes,function(value,name){value=removeVars(value);if(value){dom.setAttrib(previewElm,name,value)}});each(format.classes,function(value){value=removeVars(value);if(!dom.hasClass(previewElm,value)){dom.addClass(previewElm,value)}});editor.fire("PreviewFormats");dom.setStyles(previewFrag,{position:"absolute",left:-65535});editor.getBody().appendChild(previewFrag);parentFontSize=dom.getStyle(editor.getBody(),"fontSize",true);parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0;each(previewStyles.split(" "),function(name){var value=dom.getStyle(previewElm,name,true);if(name==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)){value=dom.getStyle(editor.getBody(),name,true);if(dom.toHex(value).toLowerCase()==="#ffffff"){return}}if(name==="color"){if(dom.toHex(value).toLowerCase()==="#000000"){return}}if(name==="font-size"){if(/em|%$/.test(value)){if(parentFontSize===0){return}value=parseFloat(value,10)/(/%$/.test(value)?100:1);value=value*parentFontSize+"px"}}if(name==="border"&&value){previewCss+="padding:0 2px;"}previewCss+=name+":"+value+";"});editor.fire("AfterPreviewFormats");dom.remove(previewFrag);return previewCss};return{getCssText:getCssText,parseSelector:parseSelector,selectorToHtml:selectorToHtml}});define("tinymce.core.fmt.ToggleFormat",["tinymce.core.fmt.ApplyFormat","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.RemoveFormat"],function(ApplyFormat,MatchFormat,RemoveFormat){var toggle=function(editor,formats,name,vars,node){var fmt=formats.get(name);if(MatchFormat.match(editor,name,vars,node)&&(!("toggle"in fmt[0])||fmt[0].toggle)){RemoveFormat.remove(editor,name,vars,node)}else{ApplyFormat.applyFormat(editor,name,vars,node)}};return{toggle:toggle}});define("tinymce.core.keyboard.FormatShortcuts",[],function(){var setup=function(editor){editor.addShortcut("meta+b","","Bold");editor.addShortcut("meta+i","","Italic");editor.addShortcut("meta+u","","Underline");for(var i=1;i<=6;i++){editor.addShortcut("access+"+i,"",["FormatBlock",false,"h"+i])}editor.addShortcut("access+7","",["FormatBlock",false,"p"]);editor.addShortcut("access+8","",["FormatBlock",false,"div"]);editor.addShortcut("access+9","",["FormatBlock",false,"address"])};return{setup:setup}});define("tinymce.core.api.Formatter",["ephox.katamari.api.Cell","ephox.katamari.api.Fun","tinymce.core.fmt.ApplyFormat","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.FormatChanged","tinymce.core.fmt.FormatRegistry","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.Preview","tinymce.core.fmt.RemoveFormat","tinymce.core.fmt.ToggleFormat","tinymce.core.keyboard.FormatShortcuts"],function(Cell,Fun,ApplyFormat,CaretFormat,FormatChanged,FormatRegistry,MatchFormat,Preview,RemoveFormat,ToggleFormat,FormatShortcuts){return function(editor){var formats=FormatRegistry(editor);var formatChangeState=Cell(null);FormatShortcuts.setup(editor);CaretFormat.setup(editor);return{get:formats.get,register:formats.register,unregister:formats.unregister,apply:Fun.curry(ApplyFormat.applyFormat,editor),remove:Fun.curry(RemoveFormat.remove,editor),toggle:Fun.curry(ToggleFormat.toggle,editor,formats),match:Fun.curry(MatchFormat.match,editor),matchAll:Fun.curry(MatchFormat.matchAll,editor),matchNode:Fun.curry(MatchFormat.matchNode,editor),canApply:Fun.curry(MatchFormat.canApply,editor),formatChanged:Fun.curry(FormatChanged.formatChanged,editor,formatChangeState),getCssText:Fun.curry(Preview.getCssText,editor)}}});define("ephox.katamari.api.Merger",["ephox.katamari.api.Type","global!Array","global!Error"],function(Type,Array,Error){var shallow=function(old,nu){return nu};var deep=function(old,nu){var bothObjects=Type.isObject(old)&&Type.isObject(nu);return bothObjects?deepMerge(old,nu):nu};var baseMerge=function(merger){return function(){var objects=new Array(arguments.length);for(var i=0;i<objects.length;i++){objects[i]=arguments[i]}if(objects.length===0){throw new Error("Can't merge zero objects")}var ret={};for(var j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject){if(curObject.hasOwnProperty(key)){ret[key]=merger(ret[key],curObject[key])}}}return ret}};var deepMerge=baseMerge(deep);var merge=baseMerge(shallow);return{deepMerge:deepMerge,merge:merge}});define("tinymce.core.api.Events",[],function(){var firePreProcess=function(editor,args){return editor.fire("PreProcess",args)};var firePostProcess=function(editor,args){return editor.fire("PostProcess",args)};return{firePreProcess:firePreProcess,firePostProcess:firePostProcess}});define("tinymce.core.dom.DomSerializerFilters",["ephox.katamari.api.Arr","tinymce.core.html.Entities"],function(Arr,Entities){var register=function(htmlParser,settings,dom){htmlParser.addAttributeFilter("data-mce-tabindex",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];node.attr("tabindex",node.attributes.map["data-mce-tabindex"]);node.attr(name,null)}});htmlParser.addAttributeFilter("src,href,style",function(nodes,name){var i=nodes.length,node,value,internalName="data-mce-"+name;var urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope,undef;while(i--){node=nodes[i];value=node.attributes.map[internalName];if(value!==undef){node.attr(name,value.length>0?value:null);node.attr(internalName,null)}else{value=node.attributes.map[name];if(name==="style"){value=dom.serializeStyle(dom.parseStyle(value),node.name)}else if(urlConverter){value=urlConverter.call(urlConverterScope,value,name,node.name)}node.attr(name,value.length>0?value:null)}}});htmlParser.addAttributeFilter("class",function(nodes){var i=nodes.length,node,value;while(i--){node=nodes[i];value=node.attr("class");if(value){value=node.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,"");node.attr("class",value.length>0?value:null)}}});htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){var i=nodes.length,node;while(i--){node=nodes[i];if(node.attributes.map["data-mce-type"]==="bookmark"&&!args.cleanup){node.remove()}}});htmlParser.addNodeFilter("noscript",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i].firstChild;if(node){node.value=Entities.decode(node.value)}}});htmlParser.addNodeFilter("script,style",function(nodes,name){var i=nodes.length,node,value,type;var trim=function(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};while(i--){node=nodes[i];value=node.firstChild?node.firstChild.value:"";if(name==="script"){type=node.attr("type");if(type){node.attr("type",type==="mce-no/type"?null:type.replace(/^mce\-/,""))}if(settings.element_format==="xhtml"&&value.length>0){node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]>"}}else{if(settings.element_format==="xhtml"&&value.length>0){node.firstChild.value="\x3c!--\n"+trim(value)+"\n--\x3e"}}}});htmlParser.addNodeFilter("#comment",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];if(node.value.indexOf("[CDATA[")===0){node.name="#cdata";node.type=4;node.value=node.value.replace(/^\[CDATA\[|\]\]$/g,"")}else if(node.value.indexOf("mce:protected ")===0){node.name="#text";node.type=3;node.raw=true;node.value=unescape(node.value).substr(14)}}});htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];if(node.type===7){node.remove()}else if(node.type===1){if(name==="input"&&!("type"in node.attributes.map)){node.attr("type","text")}}}});htmlParser.addAttributeFilter("data-mce-type",function(nodes){Arr.each(nodes,function(node){if(node.attr("data-mce-type")==="format-caret"){if(node.isEmpty(htmlParser.schema.getNonEmptyElements())){node.remove()}else{node.unwrap()}}})});htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,"+"data-mce-selected,data-mce-expando,"+"data-mce-type,data-mce-resize",function(nodes,name){var i=nodes.length;while(i--){nodes[i].attr(name,null)}})};var trimTrailingBr=function(rootNode){var brNode1,brNode2;var isBr=function(node){return node&&node.name==="br"};brNode1=rootNode.lastChild;if(isBr(brNode1)){brNode2=brNode1.prev;if(isBr(brNode2)){brNode1.remove();brNode2.remove()}}};return{register:register,trimTrailingBr:trimTrailingBr}});define("tinymce.core.dom.DomSerializerPreProcess",["ephox.katamari.api.Merger","global!document","tinymce.core.api.Events","tinymce.core.util.Tools"],function(Merger,document,Events,Tools){var preProcess=function(editor,node,args){var impl,doc,oldDoc;var dom=editor.dom;node=node.cloneNode(true);impl=document.implementation;if(impl.createHTMLDocument){doc=impl.createHTMLDocument("");Tools.each(node.nodeName==="BODY"?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,true))});if(node.nodeName!=="BODY"){node=doc.body.firstChild}else{node=doc.body}oldDoc=dom.doc;dom.doc=doc}Events.firePreProcess(editor,Merger.merge(args,{node:node}));if(oldDoc){dom.doc=oldDoc}return node};var shouldFireEvent=function(editor,args){return editor&&editor.hasEventListeners("PreProcess")&&!args.no_events};var process=function(editor,node,args){return shouldFireEvent(editor,args)?preProcess(editor,node,args):node};return{process:process}});define("tinymce.core.html.LegacyFilter",["ephox.katamari.api.Arr","tinymce.core.html.Styles","tinymce.core.util.Tools"],function(Arr,Styles,Tools){var removeAttrs=function(node,names){Arr.each(names,function(name){node.attr(name,null)})};var addFontToSpansFilter=function(domParser,styles,fontSizes){domParser.addNodeFilter("font",function(nodes){Arr.each(nodes,function(node){var props=styles.parse(node.attr("style"));var color=node.attr("color");var face=node.attr("face");var size=node.attr("size");if(color){props.color=color}if(face){props["font-family"]=face}if(size){props["font-size"]=fontSizes[parseInt(node.attr("size"),10)-1]}node.name="span";node.attr("style",styles.serialize(props));removeAttrs(node,["color","face","size"])})})};var addStrikeToSpanFilter=function(domParser,styles){domParser.addNodeFilter("strike",function(nodes){Arr.each(nodes,function(node){var props=styles.parse(node.attr("style"));props["text-decoration"]="line-through";node.name="span";node.attr("style",styles.serialize(props))})})};var addFilters=function(domParser,settings){var styles=Styles();if(settings.convert_fonts_to_spans){addFontToSpansFilter(domParser,styles,Tools.explode(settings.font_size_legacy_values))}addStrikeToSpanFilter(domParser,styles)};var register=function(domParser,settings){if(settings.inline_styles){addFilters(domParser,settings)}};return{register:register}});define("tinymce.core.html.Node",[],function(){var whiteSpaceRegExp=/^[ \t\r\n]*$/;var typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};var walk=function(node,rootNode,prev){var sibling,parent,startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName]){return node[startName]}if(node!==rootNode){sibling=node[siblingName];if(sibling){return sibling}for(parent=node.parent;parent&&parent!==rootNode;parent=parent.parent){sibling=parent[siblingName];if(sibling){return sibling}}}};var Node=function(name,type){this.name=name;this.type=type;if(type===1){this.attributes=[];this.attributes.map={}}};Node.prototype={replace:function(node){var self=this;if(node.parent){node.remove()}self.insert(node,self);self.remove();return self},attr:function(name,value){var self=this,attrs,i,undef;if(typeof name!=="string"){for(i in name){self.attr(i,name[i])}return self}if(attrs=self.attributes){if(value!==undef){if(value===null){if(name in attrs.map){delete attrs.map[name];i=attrs.length;while(i--){if(attrs[i].name===name){attrs=attrs.splice(i,1);return self}}}return self}if(name in attrs.map){i=attrs.length;while(i--){if(attrs[i].name===name){attrs[i].value=value;break}}}else{attrs.push({name:name,value:value})}attrs.map[name]=value;return self}return attrs.map[name]}},clone:function(){var self=this,clone=new Node(self.name,self.type),i,l,selfAttrs,selfAttr,cloneAttrs;if(selfAttrs=self.attributes){cloneAttrs=[];cloneAttrs.map={};for(i=0,l=selfAttrs.length;i<l;i++){selfAttr=selfAttrs[i];if(selfAttr.name!=="id"){cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value};cloneAttrs.map[selfAttr.name]=selfAttr.value}}clone.attributes=cloneAttrs}clone.value=self.value;clone.shortEnded=self.shortEnded;return clone},wrap:function(wrapper){var self=this;self.parent.insert(wrapper,self);wrapper.append(self);return self},unwrap:function(){var self=this,node,next;for(node=self.firstChild;node;){next=node.next;self.insert(node,self,true);node=next}self.remove()},remove:function(){var self=this,parent=self.parent,next=self.next,prev=self.prev;if(parent){if(parent.firstChild===self){parent.firstChild=next;if(next){next.prev=null}}else{prev.next=next}if(parent.lastChild===self){parent.lastChild=prev;if(prev){prev.next=null}}else{next.prev=prev}self.parent=self.next=self.prev=null}return self},append:function(node){var self=this,last;if(node.parent){node.remove()}last=self.lastChild;if(last){last.next=node;node.prev=last;self.lastChild=node}else{self.lastChild=self.firstChild=node}node.parent=self;return node},insert:function(node,refNode,before){var parent;if(node.parent){node.remove()}parent=refNode.parent||this;if(before){if(refNode===parent.firstChild){parent.firstChild=node}else{refNode.prev.next=node}node.prev=refNode.prev;node.next=refNode;refNode.prev=node}else{if(refNode===parent.lastChild){parent.lastChild=node}else{refNode.next.prev=node}node.next=refNode.next;node.prev=refNode;refNode.next=node}node.parent=parent;return node},getAll:function(name){var self=this,node,collection=[];for(node=self.firstChild;node;node=walk(node,self)){if(node.name===name){collection.push(node)}}return collection},empty:function(){var self=this,nodes,i,node;if(self.firstChild){nodes=[];for(node=self.firstChild;node;node=walk(node,self)){nodes.push(node)}i=nodes.length;while(i--){node=nodes[i];node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}}self.firstChild=self.lastChild=null;return self},isEmpty:function(elements,whitespace,predicate){var self=this,node=self.firstChild,i,name;whitespace=whitespace||{};if(node){do{if(node.type===1){if(node.attributes.map["data-mce-bogus"]){continue}if(elements[node.name]){return false}i=node.attributes.length;while(i--){name=node.attributes[i].name;if(name==="name"||name.indexOf("data-mce-bookmark")===0){return false}}}if(node.type===8){return false}if(node.type===3&&!whiteSpaceRegExp.test(node.value)){return false}if(node.type===3&&node.parent&&whitespace[node.parent.name]&&whiteSpaceRegExp.test(node.value)){return false}if(predicate&&predicate(node)){return false}}while(node=walk(node,self))}return true},walk:function(prev){return walk(this,null,prev)}};Node.create=function(name,attrs){var node,attrName;node=new Node(name,typeLookup[name]||1);if(attrs){for(attrName in attrs){node.attr(attrName,attrs[attrName])}}return node};return Node});define("tinymce.core.html.DomParser",["tinymce.core.html.LegacyFilter","tinymce.core.html.Node","tinymce.core.html.SaxParser","tinymce.core.html.Schema","tinymce.core.util.Tools"],function(LegacyFilter,Node,SaxParser,Schema,Tools){var makeMap=Tools.makeMap,each=Tools.each,explode=Tools.explode,extend=Tools.extend;var paddEmptyNode=function(settings,args,blockElements,node){var brPreferred=settings.padd_empty_with_br||args.insert;if(brPreferred&&blockElements[node.name]){node.empty().append(new Node("br","1")).shortEnded=true}else{node.empty().append(new Node("#text","3")).value="¬†"}};var isPaddedWithNbsp=function(node){return hasOnlyChild(node,"#text")&&node.firstChild.value==="¬†"};var hasOnlyChild=function(node,name){return node&&node.firstChild&&node.firstChild===node.lastChild&&node.firstChild.name===name};var isPadded=function(schema,node){var rule=schema.getElementRule(node.name);return rule&&rule.paddEmpty};var isEmpty=function(schema,nonEmptyElements,whitespaceElements,node){return node.isEmpty(nonEmptyElements,whitespaceElements,function(node){return isPadded(schema,node)})};return function(settings,schema){var self=this,nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{};settings.validate="validate"in settings?settings.validate:true;settings.root_name=settings.root_name||"body";self.schema=schema=schema||new Schema;var fixInvalidChildren=function(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i;var nonEmptyElements,whitespaceElements,nonSplitableElements,textBlockElements,specialElements,sibling,nextNode;nonSplitableElements=makeMap("tr,td,th,tbody,thead,tfoot,table");nonEmptyElements=schema.getNonEmptyElements();whitespaceElements=schema.getWhiteSpaceElements();textBlockElements=schema.getTextBlockElements();specialElements=schema.getSpecialElements();for(ni=0;ni<nodes.length;ni++){node=nodes[ni];if(!node.parent||node.fixed){continue}if(textBlockElements[node.name]&&node.parent.name=="li"){sibling=node.next;while(sibling){if(textBlockElements[sibling.name]){sibling.name="li";sibling.fixed=true;node.parent.insert(sibling,node.parent)}else{break}sibling=sibling.next}node.unwrap(node);continue}parents=[node];for(parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent){parents.push(parent)}if(parent&&parents.length>1){parents.reverse();newParent=currentNode=self.filterNode(parents[0].clone());for(i=0;i<parents.length-1;i++){if(schema.isValidChild(currentNode.name,parents[i].name)){tempNode=self.filterNode(parents[i].clone());currentNode.append(tempNode)}else{tempNode=currentNode}for(childNode=parents[i].firstChild;childNode&&childNode!=parents[i+1];){nextNode=childNode.next;tempNode.append(childNode);childNode=nextNode}currentNode=tempNode}if(!isEmpty(schema,nonEmptyElements,whitespaceElements,newParent)){parent.insert(newParent,parents[0],true);parent.insert(node,newParent)}else{parent.insert(node,parents[0],true)}parent=parents[0];if(isEmpty(schema,nonEmptyElements,whitespaceElements,parent)||hasOnlyChild(parent,"br")){parent.empty().remove()}}else if(node.parent){if(node.name==="li"){sibling=node.prev;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.append(node);continue}sibling=node.next;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.insert(node,sibling.firstChild,true);continue}node.wrap(self.filterNode(new Node("ul",1)));continue}if(schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name)){node.wrap(self.filterNode(new Node("div",1)))}else{if(specialElements[node.name]){node.empty().remove()}else{node.unwrap()}}}}};self.filterNode=function(node){var i,name,list;if(name in nodeFilters){list=matchedNodes[name];if(list){list.push(node)}else{matchedNodes[name]=[node]}}i=attributeFilters.length;while(i--){name=attributeFilters[i].name;if(name in node.attributes.map){list=matchedAttributes[name];if(list){list.push(node)}else{matchedAttributes[name]=[node]}}}return node};self.addNodeFilter=function(name,callback){each(explode(name),function(name){var list=nodeFilters[name];if(!list){nodeFilters[name]=list=[]}list.push(callback)})};self.addAttributeFilter=function(name,callback){each(explode(name),function(name){var i;for(i=0;i<attributeFilters.length;i++){if(attributeFilters[i].name===name){attributeFilters[i].callbacks.push(callback);return}}attributeFilters.push({name:name,callbacks:[callback]})})};self.parse=function(html,args){var parser,rootNode,node,nodes,i,l,fi,fl,list,name,validate;var blockElements,startWhiteSpaceRegExp,invalidChildren=[],isInWhiteSpacePreservedElement;var endWhiteSpaceRegExp,allWhiteSpaceRegExp,isAllWhiteSpaceRegExp,whiteSpaceElements;var children,nonEmptyElements,rootBlockName;args=args||{};matchedNodes={};matchedAttributes={};blockElements=extend(makeMap("script,style,head,html,body,title,meta,param"),schema.getBlockElements());nonEmptyElements=schema.getNonEmptyElements();children=schema.children;validate=settings.validate;rootBlockName="forced_root_block"in args?args.forced_root_block:settings.forced_root_block;whiteSpaceElements=schema.getWhiteSpaceElements();startWhiteSpaceRegExp=/^[ \t\r\n]+/;endWhiteSpaceRegExp=/[ \t\r\n]+$/;allWhiteSpaceRegExp=/[ \t\r\n]+/g;isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;var addRootBlocks=function(){var node=rootNode.firstChild,next,rootBlockNode;var trim=function(rootBlockNode){if(rootBlockNode){node=rootBlockNode.firstChild;if(node&&node.type==3){node.value=node.value.replace(startWhiteSpaceRegExp,"")}node=rootBlockNode.lastChild;if(node&&node.type==3){node.value=node.value.replace(endWhiteSpaceRegExp,"")}}};if(!schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){return}while(node){next=node.next;if(node.type==3||node.type==1&&node.name!=="p"&&!blockElements[node.name]&&!node.attr("data-mce-type")){if(!rootBlockNode){rootBlockNode=createNode(rootBlockName,1);rootBlockNode.attr(settings.forced_root_block_attrs);rootNode.insert(rootBlockNode,node);rootBlockNode.append(node)}else{rootBlockNode.append(node)}}else{trim(rootBlockNode);rootBlockNode=null}node=next}trim(rootBlockNode)};var createNode=function(name,type){var node=new Node(name,type),list;if(name in nodeFilters){list=matchedNodes[name];if(list){list.push(node)}else{matchedNodes[name]=[node]}}return node};var removeWhitespaceBefore=function(node){var textNode,textNodeNext,textVal,sibling,blockElements=schema.getBlockElements();for(textNode=node.prev;textNode&&textNode.type===3;){textVal=textNode.value.replace(endWhiteSpaceRegExp,"");if(textVal.length>0){textNode.value=textVal;return}textNodeNext=textNode.next;if(textNodeNext){if(textNodeNext.type==3&&textNodeNext.value.length){textNode=textNode.prev;continue}if(!blockElements[textNodeNext.name]&&textNodeNext.name!="script"&&textNodeNext.name!="style"){textNode=textNode.prev;continue}}sibling=textNode.prev;textNode.remove();textNode=sibling}};var cloneAndExcludeBlocks=function(input){var name,output={};for(name in input){if(name!=="li"&&name!="p"){output[name]=input[name]}}return output};parser=new SaxParser({validate:validate,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;if(!isInWhiteSpacePreservedElement){text=text.replace(allWhiteSpaceRegExp," ");if(node.lastChild&&blockElements[node.lastChild.name]){text=text.replace(startWhiteSpaceRegExp,"")}}if(text.length!==0){textNode=createNode("#text",3);textNode.raw=!!raw;node.append(textNode).value=text}},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text;removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10));newNode.value=text;removeWhitespaceBefore(node)},start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,attrName,parent;elementRule=validate?schema.getElementRule(name):{};if(elementRule){newNode=createNode(elementRule.outputName||name,1);newNode.attributes=attrs;newNode.shortEnded=empty;node.append(newNode);parent=children[node.name];if(parent&&children[newNode.name]&&!parent[newNode.name]){invalidChildren.push(newNode)}attrFiltersLen=attributeFilters.length;while(attrFiltersLen--){attrName=attributeFilters[attrFiltersLen].name;if(attrName in attrs.map){list=matchedAttributes[attrName];if(list){list.push(newNode)}else{matchedAttributes[attrName]=[newNode]}}}if(blockElements[name]){removeWhitespaceBefore(newNode)}if(!empty){node=newNode}if(!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]){isInWhiteSpacePreservedElement=true}}},end:function(name){var textNode,elementRule,text,sibling,tempNode;elementRule=validate?schema.getElementRule(name):{};if(elementRule){if(blockElements[name]){if(!isInWhiteSpacePreservedElement){textNode=node.firstChild;if(textNode&&textNode.type===3){text=textNode.value.replace(startWhiteSpaceRegExp,"");if(text.length>0){textNode.value=text;textNode=textNode.next}else{sibling=textNode.next;textNode.remove();textNode=sibling;while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.next;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}}textNode=node.lastChild;if(textNode&&textNode.type===3){text=textNode.value.replace(endWhiteSpaceRegExp,"");if(text.length>0){textNode.value=text;textNode=textNode.prev}else{sibling=textNode.prev;textNode.remove();textNode=sibling;while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.prev;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}}}}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]){isInWhiteSpacePreservedElement=false}if(elementRule.removeEmpty&&isEmpty(schema,nonEmptyElements,whiteSpaceElements,node)){if(!node.attributes.map.name&&!node.attributes.map.id){tempNode=node.parent;if(blockElements[node.name]){node.empty().remove()}else{node.unwrap()}node=tempNode;return}}if(elementRule.paddEmpty&&(isPaddedWithNbsp(node)||isEmpty(schema,nonEmptyElements,whiteSpaceElements,node))){paddEmptyNode(settings,args,blockElements,node)}node=node.parent}}},schema);rootNode=node=new Node(args.context||settings.root_name,11);parser.parse(html);if(validate&&invalidChildren.length){if(!args.context){fixInvalidChildren(invalidChildren)}else{args.invalid=true}}if(rootBlockName&&(rootNode.name=="body"||args.isRootContent)){addRootBlocks()}if(!args.invalid){for(name in matchedNodes){list=nodeFilters[name];nodes=matchedNodes[name];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1)}}for(i=0,l=list.length;i<l;i++){list[i](nodes,name,args)}}for(i=0,l=attributeFilters.length;i<l;i++){list=attributeFilters[i];if(list.name in matchedAttributes){nodes=matchedAttributes[list.name];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1)}}for(fi=0,fl=list.callbacks.length;fi<fl;fi++){list.callbacks[fi](nodes,list.name,args)}}}}return rootNode};if(settings.remove_trailing_brs){self.addNodeFilter("br",function(nodes,_,args){var i,l=nodes.length,node,blockElements=extend({},schema.getBlockElements());var nonEmptyElements=schema.getNonEmptyElements(),parent,lastParent,prev,prevName;var whiteSpaceElements=schema.getNonEmptyElements();var elementRule,textNode;blockElements.body=1;for(i=0;i<l;i++){node=nodes[i];parent=node.parent;if(blockElements[node.parent.name]&&node===parent.lastChild){prev=node.prev;while(prev){prevName=prev.name;if(prevName!=="span"||prev.attr("data-mce-type")!=="bookmark"){if(prevName!=="br"){break}if(prevName==="br"){node=null;break}}prev=prev.prev}if(node){node.remove();if(isEmpty(schema,nonEmptyElements,whiteSpaceElements,parent)){elementRule=schema.getElementRule(parent.name);if(elementRule){if(elementRule.removeEmpty){parent.remove()}else if(elementRule.paddEmpty){paddEmptyNode(settings,args,blockElements,parent)}}}}}else{lastParent=node;while(parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent){lastParent=parent;if(blockElements[parent.name]){break}parent=parent.parent}if(lastParent===parent&&settings.padd_empty_with_br!==true){textNode=new Node("#text",3);textNode.value="¬†";node.replace(textNode)}}}})}self.addAttributeFilter("href",function(nodes){var i=nodes.length,node;var appendRel=function(rel){var parts=rel.split(" ").filter(function(p){return p.length>0});return parts.concat(["noopener"]).sort().join(" ")};var addNoOpener=function(rel){var newRel=rel?Tools.trim(rel):"";if(!/\b(noopener)\b/g.test(newRel)){return appendRel(newRel)}else{return newRel}};if(!settings.allow_unsafe_link_target){while(i--){node=nodes[i];if(node.name==="a"&&node.attr("target")==="_blank"){node.attr("rel",addNoOpener(node.attr("rel")))}}}});if(!settings.allow_html_in_named_anchor){self.addAttributeFilter("id,name",function(nodes){var i=nodes.length,sibling,prevSibling,parent,node;while(i--){node=nodes[i];if(node.name==="a"&&node.firstChild&&!node.attr("href")){parent=node.parent;sibling=node.lastChild;do{prevSibling=sibling.prev;parent.insert(sibling,node);sibling=prevSibling}while(sibling)}}})}if(settings.fix_list_elements){self.addNodeFilter("ul,ol",function(nodes){var i=nodes.length,node,parentNode;while(i--){node=nodes[i];parentNode=node.parent;if(parentNode.name==="ul"||parentNode.name==="ol"){if(node.prev&&node.prev.name==="li"){node.prev.append(node)}else{var li=new Node("li",1);li.attr("style","list-style-type: none");node.wrap(li)}}}})}if(settings.validate&&schema.getValidClasses()){self.addAttributeFilter("class",function(nodes){var i=nodes.length,node,classList,ci,className,classValue;var validClasses=schema.getValidClasses(),validClassesMap,valid;while(i--){node=nodes[i];classList=node.attr("class").split(" ");classValue="";for(ci=0;ci<classList.length;ci++){className=classList[ci];valid=false;validClassesMap=validClasses["*"];if(validClassesMap&&validClassesMap[className]){valid=true}validClassesMap=validClasses[node.name];if(!valid&&validClassesMap&&validClassesMap[className]){valid=true}if(valid){if(classValue){classValue+=" "}classValue+=className}}if(!classValue.length){classValue=null}node.attr("class",classValue)}})}LegacyFilter.register(this,settings)}});define("tinymce.core.dom.DomSerializer",["ephox.katamari.api.Fun","ephox.katamari.api.Merger","tinymce.core.api.Events","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomSerializerFilters","tinymce.core.dom.DomSerializerPreProcess","tinymce.core.html.DomParser","tinymce.core.html.Schema","tinymce.core.html.Serializer","tinymce.core.text.Zwsp","tinymce.core.util.Tools"],function(Fun,Merger,Events,DOMUtils,DomSerializerFilters,DomSerializerPreProcess,DomParser,Schema,Serializer,Zwsp,Tools){var addTempAttr=function(htmlParser,tempAttrs,name){if(Tools.inArray(tempAttrs,name)===-1){htmlParser.addAttributeFilter(name,function(nodes,name){var i=nodes.length;while(i--){nodes[i].attr(name,null)}});tempAttrs.push(name)}};var postProcess=function(editor,args,content){if(!args.no_events&&editor){var outArgs=Events.firePostProcess(editor,Merger.merge(args,{content:content}));return outArgs.content}else{return content}};var getHtmlFromNode=function(dom,node,args){var html=Zwsp.trim(args.getInner?node.innerHTML:dom.getOuterHTML(node));return args.selection?html:Tools.trim(html)};var parseHtml=function(htmlParser,dom,html,args){var parserArgs=args.selection?Merger.merge({forced_root_block:false},args):args;var rootNode=htmlParser.parse(html,parserArgs);DomSerializerFilters.trimTrailingBr(rootNode);return rootNode};var serializeNode=function(settings,schema,node){var htmlSerializer=new Serializer(settings,schema);return htmlSerializer.serialize(node)};var toHtml=function(editor,settings,schema,rootNode,args){var content=serializeNode(settings,schema,rootNode);return postProcess(editor,args,content)};return function(settings,editor){var dom,schema,htmlParser,tempAttrs=["data-mce-selected"];dom=editor&&editor.dom?editor.dom:DOMUtils.DOM;schema=editor&&editor.schema?editor.schema:new Schema(settings);settings.entity_encoding=settings.entity_encoding||"named";settings.remove_trailing_brs="remove_trailing_brs"in settings?settings.remove_trailing_brs:true;htmlParser=new DomParser(settings,schema);DomSerializerFilters.register(htmlParser,settings,dom);var serialize=function(node,parserArgs){var args=Merger.merge({format:"html"},parserArgs?parserArgs:{});var targetNode=DomSerializerPreProcess.process(editor,node,args);var html=getHtmlFromNode(dom,targetNode,args);var rootNode=parseHtml(htmlParser,dom,html,args);return args.format==="tree"?rootNode:toHtml(editor,settings,schema,rootNode,args)};return{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:serialize,addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)},addTempAttr:Fun.curry(addTempAttr,htmlParser,tempAttrs),getTempAttrs:function(){return tempAttrs}}}});define("tinymce.core.api.dom.Serializer",["tinymce.core.dom.DomSerializer"],function(DomSerializer){return function(settings,editor){var domSerializer=new DomSerializer(settings,editor);return{schema:domSerializer.schema,addNodeFilter:domSerializer.addNodeFilter,addAttributeFilter:domSerializer.addAttributeFilter,serialize:domSerializer.serialize,addRules:domSerializer.addRules,setRules:domSerializer.setRules,addTempAttr:domSerializer.addTempAttr,getTempAttrs:domSerializer.getTempAttrs}}});define("tinymce.core.caret.CaretContainerInput",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFind","tinymce.core.caret.CaretContainer"],function(Fun,Element,SelectorFind,CaretContainer){var findBlockCaretContainer=function(editor){return SelectorFind.descendant(Element.fromDom(editor.getBody()),"*[data-mce-caret]").fold(Fun.constant(null),function(elm){return elm.dom()})};var removeIeControlRect=function(editor){editor.selection.setRng(editor.selection.getRng())};var showBlockCaretContainer=function(editor,blockCaretContainer){if(blockCaretContainer.hasAttribute("data-mce-caret")){CaretContainer.showCaretContainerBlock(blockCaretContainer);removeIeControlRect(editor);editor.selection.scrollIntoView(blockCaretContainer)}};var handleBlockContainer=function(editor,e){var blockCaretContainer=findBlockCaretContainer(editor);if(!blockCaretContainer){return}if(e.type==="compositionstart"){e.preventDefault();e.stopPropagation();showBlockCaretContainer(blockCaretContainer);return}if(CaretContainer.hasContent(blockCaretContainer)){showBlockCaretContainer(editor,blockCaretContainer)}};var setup=function(editor){editor.on("keyup compositionstart",Fun.curry(handleBlockContainer,editor))};return{setup:setup}});define("tinymce.core.api.dom.BookmarkManager",["ephox.katamari.api.Fun","tinymce.core.dom.Bookmarks"],function(Fun,Bookmarks){var BookmarkManager=function(selection){return{getBookmark:Fun.curry(Bookmarks.getBookmark,selection),moveToBookmark:Fun.curry(Bookmarks.moveToBookmark,selection)}};BookmarkManager.isBookmarkNode=Bookmarks.isBookmarkNode;return BookmarkManager});define("tinymce.core.dom.ControlSelection",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.search.Selectors","global!document","tinymce.core.dom.NodeType","tinymce.core.dom.RangePoint","tinymce.core.Env","tinymce.core.util.Delay","tinymce.core.util.Tools","tinymce.core.util.VK"],function(Fun,Element,Selectors,document,NodeType,RangePoint,Env,Delay,Tools,VK){var isContentEditableFalse=NodeType.isContentEditableFalse;var isContentEditableTrue=NodeType.isContentEditableTrue;var getContentEditableRoot=function(root,node){while(node&&node!=root){if(isContentEditableTrue(node)||isContentEditableFalse(node)){return node}node=node.parentNode}return null};return function(selection,editor){var dom=editor.dom,each=Tools.each;var selectedElm,selectedElmGhost,resizeHelper,resizeHandles,selectedHandle;var startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted;var width,height,editableDoc=editor.getDoc(),rootDocument=document;var abs=Math.abs,round=Math.round,rootElement=editor.getBody(),startScrollWidth,startScrollHeight;resizeHandles={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var rootClass=".mce-content-body";editor.contentStyles.push(rootClass+" div.mce-resizehandle {"+"position: absolute;"+"border: 1px solid black;"+"box-sizing: content-box;"+"background: #FFF;"+"width: 7px;"+"height: 7px;"+"z-index: 10000"+"}"+rootClass+" .mce-resizehandle:hover {"+"background: #000"+"}"+rootClass+" img[data-mce-selected],"+rootClass+" hr[data-mce-selected] {"+"outline: 1px solid black;"+"resize: none"+"}"+rootClass+" .mce-clonedresizable {"+"position: absolute;"+(Env.gecko?"":"outline: 1px dashed black;")+"opacity: .5;"+"filter: alpha(opacity=50);"+"z-index: 10000"+"}"+rootClass+" .mce-resize-helper {"+"background: #555;"+"background: rgba(0,0,0,0.75);"+"border-radius: 3px;"+"border: 1px;"+"color: white;"+"display: none;"+"font-family: sans-serif;"+"font-size: 12px;"+"white-space: nowrap;"+"line-height: 14px;"+"margin: 5px 10px;"+"padding: 5px;"+"position: absolute;"+"z-index: 10001"+"}");var isImage=function(elm){return elm&&(elm.nodeName==="IMG"||editor.dom.is(elm,"figure.image"))};var isEventOnImageOutsideRange=function(evt,range){return isImage(evt.target)&&!RangePoint.isXYWithinRange(evt.clientX,evt.clientY,range)};var contextMenuSelectImage=function(evt){var target=evt.target;if(isEventOnImageOutsideRange(evt,editor.selection.getRng())&&!evt.isDefaultPrevented()){evt.preventDefault();editor.selection.select(target)}};var getResizeTarget=function(elm){return editor.dom.is(elm,"figure.image")?elm.querySelector("img"):elm};var isResizable=function(elm){var selector=editor.settings.object_resizing;if(selector===false||Env.iOS){return false}if(typeof selector!="string"){selector="table,img,figure.image,div"}if(elm.getAttribute("data-mce-resize")==="false"){return false}if(elm==editor.getBody()){return false}return Selectors.is(Element.fromDom(elm),selector)};var resizeGhostElement=function(e){var deltaX,deltaY,proportional;var resizeHelperX,resizeHelperY;deltaX=e.screenX-startX;deltaY=e.screenY-startY;width=deltaX*selectedHandle[2]+startW;height=deltaY*selectedHandle[3]+startH;width=width<5?5:width;height=height<5?5:height;if(isImage(selectedElm)&&editor.settings.resize_img_proportional!==false){proportional=!VK.modifierPressed(e)}else{proportional=VK.modifierPressed(e)||isImage(selectedElm)&&selectedHandle[2]*selectedHandle[3]!==0}if(proportional){if(abs(deltaX)>abs(deltaY)){height=round(width*ratio);width=round(height/ratio)}else{width=round(height/ratio);height=round(width*ratio)}}dom.setStyles(getResizeTarget(selectedElmGhost),{width:width,height:height});resizeHelperX=selectedHandle.startPos.x+deltaX;resizeHelperY=selectedHandle.startPos.y+deltaY;resizeHelperX=resizeHelperX>0?resizeHelperX:0;resizeHelperY=resizeHelperY>0?resizeHelperY:0;dom.setStyles(resizeHelper,{left:resizeHelperX,top:resizeHelperY,display:"block"});resizeHelper.innerHTML=width+" &times; "+height;if(selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width){dom.setStyle(selectedElmGhost,"left",selectedElmX+(startW-width))}if(selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height){dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height))}deltaX=rootElement.scrollWidth-startScrollWidth;deltaY=rootElement.scrollHeight-startScrollHeight;if(deltaX+deltaY!==0){dom.setStyles(resizeHelper,{left:resizeHelperX-deltaX,top:resizeHelperY-deltaY})}if(!resizeStarted){editor.fire("ObjectResizeStart",{target:selectedElm,width:startW,height:startH});resizeStarted=true}};var endGhostResize=function(){resizeStarted=false;var setSizeProp=function(name,value){if(value){if(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)){dom.setStyle(getResizeTarget(selectedElm),name,value)}else{dom.setAttrib(getResizeTarget(selectedElm),name,value)}}};setSizeProp("width",width);setSizeProp("height",height);dom.unbind(editableDoc,"mousemove",resizeGhostElement);dom.unbind(editableDoc,"mouseup",endGhostResize);if(rootDocument!=editableDoc){dom.unbind(rootDocument,"mousemove",resizeGhostElement);dom.unbind(rootDocument,"mouseup",endGhostResize)}dom.remove(selectedElmGhost);dom.remove(resizeHelper);showResizeRect(selectedElm);editor.fire("ObjectResized",{target:selectedElm,width:width,height:height});dom.setAttrib(selectedElm,"style",dom.getAttrib(selectedElm,"style"));editor.nodeChanged()};var showResizeRect=function(targetElm){var position,targetWidth,targetHeight,e,rect;hideResizeRect();unbindResizeHandleEvents();position=dom.getPos(targetElm,rootElement);selectedElmX=position.x;selectedElmY=position.y;rect=targetElm.getBoundingClientRect();targetWidth=rect.width||rect.right-rect.left;targetHeight=rect.height||rect.bottom-rect.top;if(selectedElm!=targetElm){selectedElm=targetElm;width=height=0}e=editor.fire("ObjectSelected",{target:targetElm});if(isResizable(targetElm)&&!e.isDefaultPrevented()){each(resizeHandles,function(handle,name){var handleElm;var startDrag=function(e){startX=e.screenX;startY=e.screenY;startW=getResizeTarget(selectedElm).clientWidth;startH=getResizeTarget(selectedElm).clientHeight;ratio=startH/startW;selectedHandle=handle;handle.startPos={x:targetWidth*handle[0]+selectedElmX,y:targetHeight*handle[1]+selectedElmY};startScrollWidth=rootElement.scrollWidth;startScrollHeight=rootElement.scrollHeight;selectedElmGhost=selectedElm.cloneNode(true);dom.addClass(selectedElmGhost,"mce-clonedresizable");dom.setAttrib(selectedElmGhost,"data-mce-bogus","all");selectedElmGhost.contentEditable=false;selectedElmGhost.unSelectabe=true;dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0});selectedElmGhost.removeAttribute("data-mce-selected");rootElement.appendChild(selectedElmGhost);dom.bind(editableDoc,"mousemove",resizeGhostElement);dom.bind(editableDoc,"mouseup",endGhostResize);if(rootDocument!=editableDoc){dom.bind(rootDocument,"mousemove",resizeGhostElement);dom.bind(rootDocument,"mouseup",endGhostResize)}resizeHelper=dom.add(rootElement,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},startW+" &times; "+startH)};handleElm=dom.get("mceResizeHandle"+name);if(handleElm){dom.remove(handleElm)}handleElm=dom.add(rootElement,"div",{id:"mceResizeHandle"+name,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:true,style:"cursor:"+name+"-resize; margin:0; padding:0"});if(Env.ie){handleElm.contentEditable=false}dom.bind(handleElm,"mousedown",function(e){e.stopImmediatePropagation();e.preventDefault();startDrag(e)});handle.elm=handleElm;dom.setStyles(handleElm,{left:targetWidth*handle[0]+selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2})})}else{hideResizeRect()}selectedElm.setAttribute("data-mce-selected","1")};var hideResizeRect=function(){var name,handleElm;unbindResizeHandleEvents();if(selectedElm){selectedElm.removeAttribute("data-mce-selected")}for(name in resizeHandles){handleElm=dom.get("mceResizeHandle"+name);if(handleElm){dom.unbind(handleElm);dom.remove(handleElm)}}};var updateResizeRect=function(e){var startElm,controlElm;var isChildOrEqual=function(node,parent){if(node){do{if(node===parent){return true}}while(node=node.parentNode)}};if(resizeStarted||editor.removed){return}each(dom.select("img[data-mce-selected],hr[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")});controlElm=e.type=="mousedown"?e.target:selection.getNode();controlElm=dom.$(controlElm).closest("table,img,figure.image,hr")[0];if(isChildOrEqual(controlElm,rootElement)){disableGeckoResize();startElm=selection.getStart(true);if(isChildOrEqual(startElm,controlElm)&&isChildOrEqual(selection.getEnd(true),controlElm)){showResizeRect(controlElm);return}}hideResizeRect()};var isWithinContentEditableFalse=function(elm){return isContentEditableFalse(getContentEditableRoot(editor.getBody(),elm))};var unbindResizeHandleEvents=function(){for(var name in resizeHandles){var handle=resizeHandles[name];if(handle.elm){dom.unbind(handle.elm);delete handle.elm}}};var disableGeckoResize=function(){try{editor.getDoc().execCommand("enableObjectResizing",false,false)}catch(ex){}};editor.on("init",function(){disableGeckoResize();if(Env.ie&&Env.ie>=11){editor.on("mousedown click",function(e){var target=e.target,nodeName=target.nodeName;if(!resizeStarted&&/^(TABLE|IMG|HR)$/.test(nodeName)&&!isWithinContentEditableFalse(target)){if(e.button!==2){editor.selection.select(target,nodeName=="TABLE")}if(e.type=="mousedown"){editor.nodeChanged()}}});editor.dom.bind(rootElement,"mscontrolselect",function(e){var delayedSelect=function(node){Delay.setEditorTimeout(editor,function(){editor.selection.select(node)})};if(isWithinContentEditableFalse(e.target)){e.preventDefault();delayedSelect(e.target);return}if(/^(TABLE|IMG|HR)$/.test(e.target.nodeName)){e.preventDefault();if(e.target.tagName=="IMG"){delayedSelect(e.target)}}})}var throttledUpdateResizeRect=Delay.throttle(function(e){if(!editor.composing){updateResizeRect(e)}});editor.on("nodechange ResizeEditor ResizeWindow drop",throttledUpdateResizeRect);editor.on("keyup compositionend",function(e){if(selectedElm&&selectedElm.nodeName=="TABLE"){throttledUpdateResizeRect(e)}});editor.on("hide blur",hideResizeRect);editor.on("contextmenu",contextMenuSelectImage)});editor.on("remove",unbindResizeHandleEvents);var destroy=function(){selectedElm=selectedElmGhost=null};return{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,destroy:destroy}}});define("tinymce.core.dom.ScrollIntoView",["tinymce.core.dom.NodeType"],function(NodeType){var getPos=function(elm){var x=0,y=0;var offsetParent=elm;while(offsetParent&&offsetParent.nodeType){x+=offsetParent.offsetLeft||0;y+=offsetParent.offsetTop||0;offsetParent=offsetParent.offsetParent}return{x:x,y:y}};var fireScrollIntoViewEvent=function(editor,elm,alignToTop){var scrollEvent={elm:elm,alignToTop:alignToTop};editor.fire("scrollIntoView",scrollEvent);return scrollEvent.isDefaultPrevented()};var scrollIntoView=function(editor,elm,alignToTop){var y,viewPort,dom=editor.dom,root=dom.getRoot(),viewPortY,viewPortH,offsetY=0;if(fireScrollIntoViewEvent(editor,elm,alignToTop)){return}if(!NodeType.isElement(elm)){return}if(alignToTop===false){offsetY=elm.offsetHeight}if(root.nodeName!=="BODY"){var scrollContainer=editor.selection.getScrollContainer();if(scrollContainer){y=getPos(elm).y-getPos(scrollContainer).y+offsetY;viewPortH=scrollContainer.clientHeight;viewPortY=scrollContainer.scrollTop;if(y<viewPortY||y+25>viewPortY+viewPortH){scrollContainer.scrollTop=y<viewPortY?y:y-viewPortH+25}return}}viewPort=dom.getViewPort(editor.getWin());y=dom.getPos(elm).y+offsetY;viewPortY=viewPort.y;viewPortH=viewPort.h;if(y<viewPort.y||y+25>viewPortY+viewPortH){editor.getWin().scrollTo(0,y<viewPortY?y:y-viewPortH+25)}};return{scrollIntoView:scrollIntoView}});define("tinymce.core.selection.CaretRangeFromPoint",["tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(NodeType,Tools){var hasCeProperty=function(node){return NodeType.isContentEditableTrue(node)||NodeType.isContentEditableFalse(node)};var findParent=function(node,rootNode,predicate){while(node&&node!==rootNode){if(predicate(node)){return node}node=node.parentNode}return null};var findClosestIeRange=function(clientX,clientY,doc){var element,rng,rects;element=doc.elementFromPoint(clientX,clientY);rng=doc.body.createTextRange();if(!element||element.tagName==="HTML"){element=doc.body}rng.moveToElementText(element);rects=Tools.toArray(rng.getClientRects());rects=rects.sort(function(a,b){a=Math.abs(Math.max(a.top-clientY,a.bottom-clientY));b=Math.abs(Math.max(b.top-clientY,b.bottom-clientY));return a-b});if(rects.length>0){clientY=(rects[0].bottom+rects[0].top)/2;try{rng.moveToPoint(clientX,clientY);rng.collapse(true);return rng}catch(ex){}}return null};var moveOutOfContentEditableFalse=function(rng,rootNode){var parentElement=rng&&rng.parentElement?rng.parentElement():null;return NodeType.isContentEditableFalse(findParent(parentElement,rootNode,hasCeProperty))?null:rng};var fromPoint=function(clientX,clientY,doc){var rng,point;if(doc.caretPositionFromPoint){point=doc.caretPositionFromPoint(clientX,clientY);if(point){rng=doc.createRange();rng.setStart(point.offsetNode,point.offset);rng.collapse(true)}}else if(doc.caretRangeFromPoint){rng=doc.caretRangeFromPoint(clientX,clientY)}else if(doc.body.createTextRange){rng=doc.body.createTextRange();try{rng.moveToPoint(clientX,clientY);rng.collapse(true)}catch(ex){rng=findClosestIeRange(clientX,clientY,doc)}return moveOutOfContentEditableFalse(rng,doc.body)}return rng};return{fromPoint:fromPoint}});define("tinymce.core.selection.EventProcessRanges",["ephox.katamari.api.Arr"],function(Arr){var processRanges=function(editor,ranges){return Arr.map(ranges,function(range){var evt=editor.fire("GetSelectionRange",{range:range});return evt.range!==range?evt.range:range})};return{processRanges:processRanges}});define("ephox.sugar.api.dom.Replication",["ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Traverse"],function(Attr,Element,Insert,InsertAll,Remove,Traverse){var clone=function(original,deep){return Element.fromDom(original.dom().cloneNode(deep))};var shallow=function(original){return clone(original,false)};var deep=function(original){return clone(original,true)};var shallowAs=function(original,tag){var nu=Element.fromTag(tag);var attributes=Attr.clone(original);Attr.setAll(nu,attributes);return nu};var copy=function(original,tag){var nu=shallowAs(original,tag);var cloneChildren=Traverse.children(deep(original));InsertAll.append(nu,cloneChildren);return nu};var mutate=function(original,tag){var nu=shallowAs(original,tag);Insert.before(original,nu);var children=Traverse.children(original);InsertAll.append(nu,children);Remove.remove(original);return nu};return{shallow:shallow,shallowAs:shallowAs,deep:deep,copy:copy,mutate:mutate}});define("ephox.sugar.api.node.Fragment",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","global!document"],function(Arr,Element,document){var fromElements=function(elements,scope){var doc=scope||document;var fragment=doc.createDocumentFragment();Arr.each(elements,function(element){fragment.appendChild(element.dom())});return Element.fromDom(fragment)};return{fromElements:fromElements}});define("tinymce.core.selection.SelectionUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.Traverse","tinymce.core.dom.NodeType"],function(Arr,Fun,Option,Options,Compare,Element,Node,Traverse,NodeType){var getStartNode=function(rng){var sc=rng.startContainer,so=rng.startOffset;if(NodeType.isText(sc)){return so===0?Option.some(Element.fromDom(sc)):Option.none()}else{return Option.from(sc.childNodes[so]).map(Element.fromDom)}};var getEndNode=function(rng){var ec=rng.endContainer,eo=rng.endOffset;if(NodeType.isText(ec)){return eo===ec.data.length?Option.some(Element.fromDom(ec)):Option.none()}else{return Option.from(ec.childNodes[eo-1]).map(Element.fromDom)}};var getFirstChildren=function(node){return Traverse.firstChild(node).fold(Fun.constant([node]),function(child){return[node].concat(getFirstChildren(child))})};var getLastChildren=function(node){return Traverse.lastChild(node).fold(Fun.constant([node]),function(child){if(Node.name(child)==="br"){return Traverse.prevSibling(child).map(function(sibling){return[node].concat(getLastChildren(sibling))}).getOr([])}else{return[node].concat(getLastChildren(child))}})};var hasAllContentsSelected=function(elm,rng){return Options.liftN([getStartNode(rng),getEndNode(rng)],function(startNode,endNode){var start=Arr.find(getFirstChildren(elm),Fun.curry(Compare.eq,startNode));var end=Arr.find(getLastChildren(elm),Fun.curry(Compare.eq,endNode));return start.isSome()&&end.isSome()}).getOr(false)};return{hasAllContentsSelected:hasAllContentsSelected}});define("tinymce.core.selection.SimpleTableModel",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter"],function(Arr,Option,Struct,Compare,Insert,InsertAll,Replication,Element,Attr,SelectorFilter){var tableModel=Struct.immutable("element","width","rows");var tableRow=Struct.immutable("element","cells");var cellPosition=Struct.immutable("x","y");var getSpan=function(td,key){var value=parseInt(Attr.get(td,key),10);return isNaN(value)?1:value};var fillout=function(table,x,y,tr,td){var rowspan=getSpan(td,"rowspan");var colspan=getSpan(td,"colspan");var rows=table.rows();for(var y2=y;y2<y+rowspan;y2++){if(!rows[y2]){rows[y2]=tableRow(Replication.deep(tr),[])}for(var x2=x;x2<x+colspan;x2++){var cells=rows[y2].cells();cells[x2]=y2==y&&x2==x?td:Replication.shallow(td)}}};var cellExists=function(table,x,y){var rows=table.rows();var cells=rows[y]?rows[y].cells():[];return!!cells[x]};var skipCellsX=function(table,x,y){while(cellExists(table,x,y)){x++}return x};var getWidth=function(rows){return Arr.foldl(rows,function(acc,row){return row.cells().length>acc?row.cells().length:acc},0)};var findElementPos=function(table,element){var rows=table.rows();for(var y=0;y<rows.length;y++){var cells=rows[y].cells();for(var x=0;x<cells.length;x++){if(Compare.eq(cells[x],element)){return Option.some(cellPosition(x,y))}}}return Option.none()};var extractRows=function(table,sx,sy,ex,ey){var newRows=[];var rows=table.rows();for(var y=sy;y<=ey;y++){var cells=rows[y].cells();var slice=sx<ex?cells.slice(sx,ex+1):cells.slice(ex,sx+1);newRows.push(tableRow(rows[y].element(),slice))}return newRows};var subTable=function(table,startPos,endPos){var sx=startPos.x(),sy=startPos.y();var ex=endPos.x(),ey=endPos.y();var newRows=sy<ey?extractRows(table,sx,sy,ex,ey):extractRows(table,sx,ey,ex,sy);return tableModel(table.element(),getWidth(newRows),newRows)};var createDomTable=function(table,rows){var tableElement=Replication.shallow(table.element());var tableBody=Element.fromTag("tbody");InsertAll.append(tableBody,rows);Insert.append(tableElement,tableBody);return tableElement};var modelRowsToDomRows=function(table){return Arr.map(table.rows(),function(row){var cells=Arr.map(row.cells(),function(cell){var td=Replication.deep(cell);Attr.remove(td,"colspan");Attr.remove(td,"rowspan");return td});var tr=Replication.shallow(row.element());InsertAll.append(tr,cells);return tr})};var fromDom=function(tableElm){var table=tableModel(Replication.shallow(tableElm),0,[]);Arr.each(SelectorFilter.descendants(tableElm,"tr"),function(tr,y){Arr.each(SelectorFilter.descendants(tr,"td,th"),function(td,x){fillout(table,skipCellsX(table,x,y),y,tr,td)})});return tableModel(table.element(),getWidth(table.rows()),table.rows())};var toDom=function(table){return createDomTable(table,modelRowsToDomRows(table))};var subsection=function(table,startElement,endElement){return findElementPos(table,startElement).bind(function(startPos){return findElementPos(table,endElement).map(function(endPos){return subTable(table,startPos,endPos)})})};return{fromDom:fromDom,toDom:toDom,subsection:subsection}});define("tinymce.core.selection.FragmentReader",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.node.Fragment","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse","tinymce.core.dom.ElementType","tinymce.core.dom.Parents","tinymce.core.selection.SelectionUtils","tinymce.core.selection.SimpleTableModel","tinymce.core.selection.TableCellSelection"],function(Arr,Fun,Compare,Insert,Replication,Element,Fragment,Node,SelectorFind,Traverse,ElementType,Parents,SelectionUtils,SimpleTableModel,TableCellSelection){var findParentListContainer=function(parents){return Arr.find(parents,function(elm){return Node.name(elm)==="ul"||Node.name(elm)==="ol"})};var getFullySelectedListWrappers=function(parents,rng){return Arr.find(parents,function(elm){return Node.name(elm)==="li"&&SelectionUtils.hasAllContentsSelected(elm,rng)}).fold(Fun.constant([]),function(li){return findParentListContainer(parents).map(function(listCont){return[Element.fromTag("li"),Element.fromTag(Node.name(listCont))]}).getOr([])})};var wrap=function(innerElm,elms){var wrapped=Arr.foldl(elms,function(acc,elm){Insert.append(elm,acc);return elm},innerElm);return elms.length>0?Fragment.fromElements([wrapped]):wrapped};var directListWrappers=function(commonAnchorContainer){if(ElementType.isListItem(commonAnchorContainer)){return Traverse.parent(commonAnchorContainer).filter(ElementType.isList).fold(Fun.constant([]),function(listElm){return[commonAnchorContainer,listElm]})}else{return ElementType.isList(commonAnchorContainer)?[commonAnchorContainer]:[]}};var getWrapElements=function(rootNode,rng){var commonAnchorContainer=Element.fromDom(rng.commonAncestorContainer);var parents=Parents.parentsAndSelf(commonAnchorContainer,rootNode);var wrapElements=Arr.filter(parents,function(elm){return ElementType.isInline(elm)||ElementType.isHeading(elm)});var listWrappers=getFullySelectedListWrappers(parents,rng);var allWrappers=wrapElements.concat(listWrappers.length?listWrappers:directListWrappers(commonAnchorContainer));return Arr.map(allWrappers,Replication.shallow)};var emptyFragment=function(){return Fragment.fromElements([])};var getFragmentFromRange=function(rootNode,rng){return wrap(Element.fromDom(rng.cloneContents()),getWrapElements(rootNode,rng))};var getParentTable=function(rootElm,cell){return SelectorFind.ancestor(cell,"table",Fun.curry(Compare.eq,rootElm))};var getTableFragment=function(rootNode,selectedTableCells){return getParentTable(rootNode,selectedTableCells[0]).bind(function(tableElm){var firstCell=selectedTableCells[0];var lastCell=selectedTableCells[selectedTableCells.length-1];var fullTableModel=SimpleTableModel.fromDom(tableElm);return SimpleTableModel.subsection(fullTableModel,firstCell,lastCell).map(function(sectionedTableModel){return Fragment.fromElements([SimpleTableModel.toDom(sectionedTableModel)])})}).getOrThunk(emptyFragment)};var getSelectionFragment=function(rootNode,ranges){return ranges.length>0&&ranges[0].collapsed?emptyFragment():getFragmentFromRange(rootNode,ranges[0])};var read=function(rootNode,ranges){var selectedCells=TableCellSelection.getCellsFromElementOrRanges(ranges,rootNode);return selectedCells.length>0?getTableFragment(rootNode,selectedCells):getSelectionFragment(rootNode,ranges)};return{read:read}});define("tinymce.core.selection.GetSelectionContent",["ephox.sugar.api.node.Element","tinymce.core.selection.EventProcessRanges","tinymce.core.selection.FragmentReader","tinymce.core.selection.MultiRange","tinymce.core.text.Zwsp"],function(Element,EventProcessRanges,FragmentReader,MultiRange,Zwsp){var getContent=function(editor,args){var rng=editor.selection.getRng(),tmpElm=editor.dom.create("body");var sel=editor.selection.getSel(),fragment;var ranges=EventProcessRanges.processRanges(editor,MultiRange.getRanges(sel));args=args||{};args.get=true;args.format=args.format||"html";args.selection=true;args=editor.fire("BeforeGetContent",args);if(args.isDefaultPrevented()){editor.fire("GetContent",args);return args.content}if(args.format==="text"){return editor.selection.isCollapsed()?"":Zwsp.trim(rng.text||(sel.toString?sel.toString():""))}if(rng.cloneContents){fragment=args.contextual?FragmentReader.read(Element.fromDom(editor.getBody()),ranges).dom():rng.cloneContents();if(fragment){tmpElm.appendChild(fragment)}}else if(rng.item!==undefined||rng.htmlText!==undefined){tmpElm.innerHTML="<br>"+(rng.item?rng.item(0).outerHTML:rng.htmlText);tmpElm.removeChild(tmpElm.firstChild)}else{tmpElm.innerHTML=rng.toString()}args.getInner=true;var content=editor.selection.serializer.serialize(tmpElm,args);if(args.format==="tree"){return content}args.content=editor.selection.isCollapsed()?"":content;editor.fire("GetContent",args);return args.content};return{getContent:getContent}});define("tinymce.core.selection.SetSelectionContent",[],function(){var setContent=function(editor,content,args){var rng=editor.selection.getRng(),caretNode,doc=editor.getDoc(),frag,temp;args=args||{format:"html"};args.set=true;args.selection=true;args.content=content;if(!args.no_events){args=editor.fire("BeforeSetContent",args);if(args.isDefaultPrevented()){editor.fire("SetContent",args);return}}content=args.content;if(rng.insertNode){content+='<span id="__caret">_</span>';if(rng.startContainer==doc&&rng.endContainer==doc){doc.body.innerHTML=content}else{rng.deleteContents();if(doc.body.childNodes.length===0){doc.body.innerHTML=content}else{if(rng.createContextualFragment){rng.insertNode(rng.createContextualFragment(content))}else{frag=doc.createDocumentFragment();temp=doc.createElement("div");frag.appendChild(temp);temp.outerHTML=content;rng.insertNode(frag)}}}caretNode=editor.dom.get("__caret");rng=doc.createRange();rng.setStartBefore(caretNode);rng.setEndBefore(caretNode);editor.selection.setRng(rng);editor.dom.remove("__caret");try{editor.selection.setRng(rng)}catch(ex){}}else{if(rng.item){doc.execCommand("Delete",false,null);rng=editor.getRng()}if(/^\s+/.test(content)){rng.pasteHTML('<span id="__mce_tmp">_</span>'+content);editor.dom.remove("__mce_tmp")}else{rng.pasteHTML(content)}}if(!args.no_events){editor.fire("SetContent",args)}};return{setContent:setContent}});define("tinymce.core.dom.Selection",["ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","tinymce.core.Env","tinymce.core.api.dom.BookmarkManager","tinymce.core.caret.CaretPosition","tinymce.core.dom.ControlSelection","tinymce.core.dom.ScrollIntoView","tinymce.core.dom.TreeWalker","tinymce.core.focus.EditorFocus","tinymce.core.selection.CaretRangeFromPoint","tinymce.core.selection.EventProcessRanges","tinymce.core.selection.GetSelectionContent","tinymce.core.selection.MultiRange","tinymce.core.selection.NormalizeRange","tinymce.core.selection.SelectionBookmark","tinymce.core.selection.SetSelectionContent","tinymce.core.util.Tools"],function(Compare,Element,Env,BookmarkManager,CaretPosition,ControlSelection,ScrollIntoView,TreeWalker,EditorFocus,CaretRangeFromPoint,EventProcessRanges,GetSelectionContent,MultiRange,NormalizeRange,SelectionBookmark,SetSelectionContent,Tools){var each=Tools.each,trim=Tools.trim;var isAttachedToDom=function(node){return!!(node&&node.ownerDocument)&&Compare.contains(Element.fromDom(node.ownerDocument),Element.fromDom(node))};var isValidRange=function(rng){if(!rng){return false}else if(rng.select){return true}else{return isAttachedToDom(rng.startContainer)&&isAttachedToDom(rng.endContainer)}};var Selection=function(dom,win,serializer,editor){var self=this;self.dom=dom;self.win=win;self.serializer=serializer;self.editor=editor;self.bookmarkManager=new BookmarkManager(self);self.controlSelection=new ControlSelection(self,editor)};Selection.prototype={setCursorLocation:function(node,offset){var self=this,rng=self.dom.createRng();if(!node){self._moveEndPoint(rng,self.editor.getBody(),true);self.setRng(rng)}else{rng.setStart(node,offset);rng.setEnd(node,offset);self.setRng(rng);self.collapse(false)}},getContent:function(args){return GetSelectionContent.getContent(this.editor,args)},setContent:function(content,args){SetSelectionContent.setContent(this.editor,content,args)},getStart:function(real){var self=this,rng=self.getRng(),startElement;startElement=rng.startContainer;if(startElement.nodeType==1&&startElement.hasChildNodes()){if(!real||!rng.collapsed){startElement=startElement.childNodes[Math.min(startElement.childNodes.length-1,rng.startOffset)]}}if(startElement&&startElement.nodeType==3){return startElement.parentNode}return startElement},getEnd:function(real){var self=this,rng=self.getRng(),endElement,endOffset;endElement=rng.endContainer;endOffset=rng.endOffset;if(endElement.nodeType==1&&endElement.hasChildNodes()){if(!real||!rng.collapsed){endElement=endElement.childNodes[endOffset>0?endOffset-1:endOffset]}}if(endElement&&endElement.nodeType==3){return endElement.parentNode}return endElement},getBookmark:function(type,normalized){return this.bookmarkManager.getBookmark(type,normalized)},moveToBookmark:function(bookmark){return this.bookmarkManager.moveToBookmark(bookmark)},select:function(node,content){var self=this,dom=self.dom,rng=dom.createRng(),idx;if(node){idx=dom.nodeIndex(node);rng.setStart(node.parentNode,idx);rng.setEnd(node.parentNode,idx+1);if(content){self._moveEndPoint(rng,node,true);self._moveEndPoint(rng,node)}self.setRng(rng)}return node},isCollapsed:function(){var self=this,rng=self.getRng(),sel=self.getSel();if(!rng||rng.item){return false}if(rng.compareEndPoints){return rng.compareEndPoints("StartToEnd",rng)===0}return!sel||rng.collapsed},collapse:function(toStart){var self=this,rng=self.getRng();rng.collapse(!!toStart);self.setRng(rng)},getSel:function(){var win=this.win;return win.getSelection?win.getSelection():win.document.selection},getRng:function(w3c){var self=this,selection,rng,elm,doc;var tryCompareBoundaryPoints=function(how,sourceRange,destinationRange){try{return sourceRange.compareBoundaryPoints(how,destinationRange)}catch(ex){return-1}};if(!self.win){return null}doc=self.win.document;if(typeof doc==="undefined"||doc===null){return null}if(self.editor.bookmark!==undefined&&EditorFocus.hasFocus(self.editor)===false){var bookmark=SelectionBookmark.getRng(self.editor);if(bookmark.isSome()){return bookmark.getOr(doc.createRange())}}try{if(selection=self.getSel()){if(selection.rangeCount>0){rng=selection.getRangeAt(0)}else{rng=selection.createRange?selection.createRange():doc.createRange()}}}catch(ex){}rng=EventProcessRanges.processRanges(self.editor,[rng])[0];if(!rng){rng=doc.createRange?doc.createRange():doc.body.createTextRange()}if(rng.setStart&&rng.startContainer.nodeType===9&&rng.collapsed){elm=self.dom.getRoot();rng.setStart(elm,0);rng.setEnd(elm,0)}if(self.selectedRange&&self.explicitRange){if(tryCompareBoundaryPoints(rng.START_TO_START,rng,self.selectedRange)===0&&tryCompareBoundaryPoints(rng.END_TO_END,rng,self.selectedRange)===0){rng=self.explicitRange}else{self.selectedRange=null;self.explicitRange=null}}return rng},setRng:function(rng,forward){var self=this,sel,node,evt;if(!isValidRange(rng)){return}if(rng.select){self.explicitRange=null;try{rng.select()}catch(ex){}return}sel=self.getSel();evt=self.editor.fire("SetSelectionRange",{range:rng,forward:forward});rng=evt.range;if(sel){self.explicitRange=rng;try{sel.removeAllRanges();sel.addRange(rng)}catch(ex){}if(forward===false&&sel.extend){sel.collapse(rng.endContainer,rng.endOffset);sel.extend(rng.startContainer,rng.startOffset)}self.selectedRange=sel.rangeCount>0?sel.getRangeAt(0):null}if(!rng.collapsed&&rng.startContainer===rng.endContainer&&sel.setBaseAndExtent&&!Env.ie){if(rng.endOffset-rng.startOffset<2){if(rng.startContainer.hasChildNodes()){node=rng.startContainer.childNodes[rng.startOffset];if(node&&node.tagName==="IMG"){sel.setBaseAndExtent(rng.startContainer,rng.startOffset,rng.endContainer,rng.endOffset);if(sel.anchorNode!==rng.startContainer||sel.focusNode!==rng.endContainer){sel.setBaseAndExtent(node,0,node,1)}}}}}self.editor.fire("AfterSetSelectionRange",{range:rng,forward:forward})},setNode:function(elm){var self=this;self.setContent(self.dom.getOuterHTML(elm));return elm},getNode:function(){var self=this,rng=self.getRng(),elm;var startContainer,endContainer,startOffset,endOffset,root=self.dom.getRoot();var skipEmptyTextNodes=function(node,forwards){var orig=node;while(node&&node.nodeType===3&&node.length===0){node=forwards?node.nextSibling:node.previousSibling}return node||orig};if(!rng){return root}startContainer=rng.startContainer;endContainer=rng.endContainer;startOffset=rng.startOffset;endOffset=rng.endOffset;elm=rng.commonAncestorContainer;if(!rng.collapsed){if(startContainer==endContainer){if(endOffset-startOffset<2){if(startContainer.hasChildNodes()){elm=startContainer.childNodes[startOffset]}}}if(startContainer.nodeType===3&&endContainer.nodeType===3){if(startContainer.length===startOffset){startContainer=skipEmptyTextNodes(startContainer.nextSibling,true)}else{startContainer=startContainer.parentNode}if(endOffset===0){endContainer=skipEmptyTextNodes(endContainer.previousSibling,false)}else{endContainer=endContainer.parentNode}if(startContainer&&startContainer===endContainer){return startContainer}}}if(elm&&elm.nodeType==3){return elm.parentNode}return elm},getSelectedBlocks:function(startElm,endElm){var self=this,dom=self.dom,node,root,selectedBlocks=[];root=dom.getRoot();startElm=dom.getParent(startElm||self.getStart(),dom.isBlock);endElm=dom.getParent(endElm||self.getEnd(),dom.isBlock);if(startElm&&startElm!=root){selectedBlocks.push(startElm)}if(startElm&&endElm&&startElm!=endElm){node=startElm;var walker=new TreeWalker(startElm,root);while((node=walker.next())&&node!=endElm){if(dom.isBlock(node)){selectedBlocks.push(node)}}}if(endElm&&startElm!=endElm&&endElm!=root){selectedBlocks.push(endElm)}return selectedBlocks},isForward:function(){var dom=this.dom,sel=this.getSel(),anchorRange,focusRange;if(!sel||!sel.anchorNode||!sel.focusNode){return true}anchorRange=dom.createRng();anchorRange.setStart(sel.anchorNode,sel.anchorOffset);anchorRange.collapse(true);focusRange=dom.createRng();focusRange.setStart(sel.focusNode,sel.focusOffset);focusRange.collapse(true);return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0},normalize:function(){var self=this,rng=self.getRng();if(!MultiRange.hasMultipleRanges(self.getSel())){var normRng=NormalizeRange.normalize(self.dom,rng);normRng.each(function(normRng){self.setRng(normRng,self.isForward())});return normRng.getOr(rng)}return rng},selectorChanged:function(selector,callback){var self=this,currentSelectors;if(!self.selectorChangedData){self.selectorChangedData={};currentSelectors={};self.editor.on("NodeChange",function(e){var node=e.element,dom=self.dom,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};each(self.selectorChangedData,function(callbacks,selector){each(parents,function(node){if(dom.is(node,selector)){if(!currentSelectors[selector]){each(callbacks,function(callback){callback(true,{node:node,selector:selector,parents:parents})});currentSelectors[selector]=callbacks}matchedSelectors[selector]=callbacks;return false}})});each(currentSelectors,function(callbacks,selector){if(!matchedSelectors[selector]){delete currentSelectors[selector];each(callbacks,function(callback){callback(false,{node:node,selector:selector,parents:parents})})}})})}if(!self.selectorChangedData[selector]){self.selectorChangedData[selector]=[]}self.selectorChangedData[selector].push(callback);return self},getScrollContainer:function(){var scrollContainer,node=this.dom.getRoot();while(node&&node.nodeName!="BODY"){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break}node=node.parentNode}return scrollContainer},scrollIntoView:function(elm,alignToTop){ScrollIntoView.scrollIntoView(this.editor,elm,alignToTop)},placeCaretAt:function(clientX,clientY){this.setRng(CaretRangeFromPoint.fromPoint(clientX,clientY,this.editor.getDoc()))},_moveEndPoint:function(rng,node,start){var root=node,walker=new TreeWalker(node,root);var nonEmptyElementsMap=this.dom.schema.getNonEmptyElements();do{if(node.nodeType==3&&trim(node.nodeValue).length!==0){if(start){rng.setStart(node,0)}else{rng.setEnd(node,node.nodeValue.length)}return}if(nonEmptyElementsMap[node.nodeName]&&!/^(TD|TH)$/.test(node.nodeName)){if(start){rng.setStartBefore(node)}else{if(node.nodeName=="BR"){rng.setEndBefore(node)}else{rng.setEndAfter(node)}}return}if(Env.ie&&Env.ie<11&&this.dom.isBlock(node)&&this.dom.isEmpty(node)){if(start){rng.setStart(node,0)}else{rng.setEnd(node,0)}return}}while(node=start?walker.next():walker.prev());if(root.nodeName=="BODY"){if(start){rng.setStart(root,0)}else{rng.setEnd(root,root.childNodes.length)}}},getBoundingClientRect:function(){var rng=this.getRng();return rng.collapsed?CaretPosition.fromRangeStart(rng).getClientRects()[0]:rng.getBoundingClientRect()},destroy:function(){this.win=null;this.controlSelection.destroy()}};return Selection});define("tinymce.core.caret.LineWalker",["tinymce.core.util.Fun","tinymce.core.util.Arr","tinymce.core.dom.Dimensions","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.caret.CaretPosition","tinymce.core.geom.ClientRect"],function(Fun,Arr,Dimensions,CaretCandidate,CaretUtils,CaretWalker,CaretPosition,ClientRect){var curry=Fun.curry;var findUntil=function(direction,rootNode,predicateFn,node){while(node=CaretUtils.findNode(node,direction,CaretCandidate.isEditableCaretCandidate,rootNode)){if(predicateFn(node)){return}}};var walkUntil=function(direction,isAboveFn,isBeflowFn,rootNode,predicateFn,caretPosition){var line=0,node,result=[],targetClientRect;var add=function(node){var i,clientRect,clientRects;clientRects=Dimensions.getClientRects(node);if(direction==-1){clientRects=clientRects.reverse()}for(i=0;i<clientRects.length;i++){clientRect=clientRects[i];if(isBeflowFn(clientRect,targetClientRect)){continue}if(result.length>0&&isAboveFn(clientRect,Arr.last(result))){line++}clientRect.line=line;if(predicateFn(clientRect)){return true}result.push(clientRect)}};targetClientRect=Arr.last(caretPosition.getClientRects());if(!targetClientRect){return result}node=caretPosition.getNode();add(node);findUntil(direction,rootNode,add,node);return result};var aboveLineNumber=function(lineNumber,clientRect){return clientRect.line>lineNumber};var isLine=function(lineNumber,clientRect){return clientRect.line===lineNumber};var upUntil=curry(walkUntil,-1,ClientRect.isAbove,ClientRect.isBelow);var downUntil=curry(walkUntil,1,ClientRect.isBelow,ClientRect.isAbove);var positionsUntil=function(direction,rootNode,predicateFn,node){var caretWalker=new CaretWalker(rootNode),walkFn,isBelowFn,isAboveFn,caretPosition,result=[],line=0,clientRect,targetClientRect;var getClientRect=function(caretPosition){if(direction==1){return Arr.last(caretPosition.getClientRects())}return Arr.last(caretPosition.getClientRects())};if(direction==1){walkFn=caretWalker.next;isBelowFn=ClientRect.isBelow;isAboveFn=ClientRect.isAbove;caretPosition=CaretPosition.after(node)}else{walkFn=caretWalker.prev;isBelowFn=ClientRect.isAbove;isAboveFn=ClientRect.isBelow;caretPosition=CaretPosition.before(node)}targetClientRect=getClientRect(caretPosition);do{if(!caretPosition.isVisible()){continue}clientRect=getClientRect(caretPosition);if(isAboveFn(clientRect,targetClientRect)){continue}if(result.length>0&&isBelowFn(clientRect,Arr.last(result))){line++}clientRect=ClientRect.clone(clientRect);clientRect.position=caretPosition;clientRect.line=line;if(predicateFn(clientRect)){return result}result.push(clientRect)}while(caretPosition=walkFn(caretPosition));return result};return{upUntil:upUntil,downUntil:downUntil,positionsUntil:positionsUntil,isAboveLine:curry(aboveLineNumber),isLine:curry(isLine)}});define("tinymce.core.keyboard.CefNavigation",["tinymce.core.Env","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.caret.LineUtils","tinymce.core.caret.LineWalker","tinymce.core.dom.NodeType","tinymce.core.keyboard.CefUtils","tinymce.core.selection.RangeNodes","tinymce.core.util.Arr","tinymce.core.util.Fun"],function(Env,CaretContainer,CaretPosition,CaretUtils,CaretWalker,LineUtils,LineWalker,NodeType,CefUtils,RangeNodes,Arr,Fun){var isContentEditableFalse=NodeType.isContentEditableFalse;var getSelectedNode=RangeNodes.getSelectedNode;var isAfterContentEditableFalse=CaretUtils.isAfterContentEditableFalse;var isBeforeContentEditableFalse=CaretUtils.isBeforeContentEditableFalse;var getVisualCaretPosition=function(walkFn,caretPosition){while(caretPosition=walkFn(caretPosition)){if(caretPosition.isVisible()){return caretPosition}}return caretPosition};var isMoveInsideSameBlock=function(fromCaretPosition,toCaretPosition){var inSameBlock=CaretUtils.isInSameBlock(fromCaretPosition,toCaretPosition);if(!inSameBlock&&NodeType.isBr(fromCaretPosition.getNode())){return true}return inSameBlock};var isRangeInCaretContainerBlock=function(range){return CaretContainer.isCaretContainerBlock(range.startContainer)};var getNormalizedRangeEndPoint=function(direction,rootNode,range){range=CaretUtils.normalizeRange(direction,rootNode,range);if(direction===-1){return CaretPosition.fromRangeStart(range)}return CaretPosition.fromRangeEnd(range)};var moveToCeFalseHorizontally=function(direction,editor,getNextPosFn,isBeforeContentEditableFalseFn,range){var node,caretPosition,peekCaretPosition,rangeIsInContainerBlock;if(!range.collapsed){node=getSelectedNode(range);if(isContentEditableFalse(node)){return CefUtils.showCaret(direction,editor,node,direction===-1)}}rangeIsInContainerBlock=isRangeInCaretContainerBlock(range);caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range);if(isBeforeContentEditableFalseFn(caretPosition)){return CefUtils.selectNode(editor,caretPosition.getNode(direction===-1))}caretPosition=getNextPosFn(caretPosition);if(!caretPosition){if(rangeIsInContainerBlock){return range}return null}if(isBeforeContentEditableFalseFn(caretPosition)){return CefUtils.showCaret(direction,editor,caretPosition.getNode(direction===-1),direction===1)}peekCaretPosition=getNextPosFn(caretPosition);if(isBeforeContentEditableFalseFn(peekCaretPosition)){if(isMoveInsideSameBlock(caretPosition,peekCaretPosition)){return CefUtils.showCaret(direction,editor,peekCaretPosition.getNode(direction===-1),direction===1)}}if(rangeIsInContainerBlock){return CefUtils.renderRangeCaret(editor,caretPosition.toRange())}return null};var moveToCeFalseVertically=function(direction,editor,walkerFn,range){var caretPosition,linePositions,nextLinePositions,closestNextLineRect,caretClientRect,clientX,dist1,dist2,contentEditableFalseNode;contentEditableFalseNode=getSelectedNode(range);caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range);linePositions=walkerFn(editor.getBody(),LineWalker.isAboveLine(1),caretPosition);nextLinePositions=Arr.filter(linePositions,LineWalker.isLine(1));caretClientRect=Arr.last(caretPosition.getClientRects());if(isBeforeContentEditableFalse(caretPosition)){contentEditableFalseNode=caretPosition.getNode()}if(isAfterContentEditableFalse(caretPosition)){contentEditableFalseNode=caretPosition.getNode(true)}if(!caretClientRect){return null}clientX=caretClientRect.left;closestNextLineRect=LineUtils.findClosestClientRect(nextLinePositions,clientX);if(closestNextLineRect){if(isContentEditableFalse(closestNextLineRect.node)){dist1=Math.abs(clientX-closestNextLineRect.left);dist2=Math.abs(clientX-closestNextLineRect.right);return CefUtils.showCaret(direction,editor,closestNextLineRect.node,dist1<dist2)}}if(contentEditableFalseNode){var caretPositions=LineWalker.positionsUntil(direction,editor.getBody(),LineWalker.isAboveLine(1),contentEditableFalseNode);closestNextLineRect=LineUtils.findClosestClientRect(Arr.filter(caretPositions,LineWalker.isLine(1)),clientX);if(closestNextLineRect){return CefUtils.renderRangeCaret(editor,closestNextLineRect.position.toRange())}closestNextLineRect=Arr.last(Arr.filter(caretPositions,LineWalker.isLine(0)));if(closestNextLineRect){return CefUtils.renderRangeCaret(editor,closestNextLineRect.position.toRange())}}};var createTextBlock=function(editor){var textBlock=editor.dom.create(editor.settings.forced_root_block);if(!Env.ie||Env.ie>=11){textBlock.innerHTML='<br data-mce-bogus="1">'}return textBlock};var exitPreBlock=function(editor,direction,range){var pre,caretPos,newBlock;var caretWalker=new CaretWalker(editor.getBody());var getNextVisualCaretPosition=Fun.curry(getVisualCaretPosition,caretWalker.next);var getPrevVisualCaretPosition=Fun.curry(getVisualCaretPosition,caretWalker.prev);if(range.collapsed&&editor.settings.forced_root_block){pre=editor.dom.getParent(range.startContainer,"PRE");if(!pre){return}if(direction===1){caretPos=getNextVisualCaretPosition(CaretPosition.fromRangeStart(range))}else{caretPos=getPrevVisualCaretPosition(CaretPosition.fromRangeStart(range))}if(!caretPos){newBlock=createTextBlock(editor);if(direction===1){editor.$(pre).after(newBlock)}else{editor.$(pre).before(newBlock)}editor.selection.select(newBlock,true);editor.selection.collapse()}}};var getHorizontalRange=function(editor,forward){var caretWalker=new CaretWalker(editor.getBody());var getNextVisualCaretPosition=Fun.curry(getVisualCaretPosition,caretWalker.next);var getPrevVisualCaretPosition=Fun.curry(getVisualCaretPosition,caretWalker.prev);var newRange,direction=forward?1:-1;var getNextPosFn=forward?getNextVisualCaretPosition:getPrevVisualCaretPosition;var isBeforeContentEditableFalseFn=forward?isBeforeContentEditableFalse:isAfterContentEditableFalse;var range=editor.selection.getRng();newRange=moveToCeFalseHorizontally(direction,editor,getNextPosFn,isBeforeContentEditableFalseFn,range);if(newRange){return newRange}newRange=exitPreBlock(editor,direction,range);if(newRange){return newRange}return null};var getVerticalRange=function(editor,down){var newRange,direction=down?1:-1;var walkerFn=down?LineWalker.downUntil:LineWalker.upUntil;var range=editor.selection.getRng();newRange=moveToCeFalseVertically(direction,editor,walkerFn,range);if(newRange){return newRange}newRange=exitPreBlock(editor,direction,range);if(newRange){return newRange}return null};var moveH=function(editor,forward){return function(){var newRng=getHorizontalRange(editor,forward);if(newRng){editor.selection.setRng(newRng);return true}else{return false}}};var moveV=function(editor,down){return function(){var newRng=getVerticalRange(editor,down);if(newRng){editor.selection.setRng(newRng);return true}else{return false}}};return{moveH:moveH,moveV:moveV}});define("tinymce.core.keyboard.MatchKeys",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Merger"],function(Arr,Fun,Merger){var defaultPatterns=function(patterns){return Arr.map(patterns,function(pattern){return Merger.merge({shiftKey:false,altKey:false,ctrlKey:false,metaKey:false,keyCode:0,action:Fun.noop},pattern)})};var matchesEvent=function(pattern,evt){return evt.keyCode===pattern.keyCode&&evt.shiftKey===pattern.shiftKey&&evt.altKey===pattern.altKey&&evt.ctrlKey===pattern.ctrlKey&&evt.metaKey===pattern.metaKey};var match=function(patterns,evt){return Arr.bind(defaultPatterns(patterns),function(pattern){return matchesEvent(pattern,evt)?[pattern]:[]})};var action=function(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}};var execute=function(patterns,evt){return Arr.find(match(patterns,evt),function(pattern){return pattern.action()})};return{match:match,action:action,execute:execute}});define("tinymce.core.keyboard.ArrowKeys",["ephox.sand.api.PlatformDetection","tinymce.core.keyboard.BoundarySelection","tinymce.core.keyboard.CefNavigation","tinymce.core.keyboard.MatchKeys","tinymce.core.util.VK"],function(PlatformDetection,BoundarySelection,CefNavigation,MatchKeys,VK){var executeKeydownOverride=function(editor,caret,evt){var os=PlatformDetection.detect().os;MatchKeys.execute([{keyCode:VK.RIGHT,action:CefNavigation.moveH(editor,true)},{keyCode:VK.LEFT,action:CefNavigation.moveH(editor,false)},{keyCode:VK.UP,action:CefNavigation.moveV(editor,false)},{keyCode:VK.DOWN,action:CefNavigation.moveV(editor,true)},{keyCode:VK.RIGHT,action:BoundarySelection.move(editor,caret,true)},{keyCode:VK.LEFT,action:BoundarySelection.move(editor,caret,false)},{keyCode:VK.RIGHT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:BoundarySelection.moveNextWord(editor,caret)},{keyCode:VK.LEFT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:BoundarySelection.movePrevWord(editor,caret)}],evt).each(function(_){evt.preventDefault()})};var setup=function(editor,caret){editor.on("keydown",function(evt){if(evt.isDefaultPrevented()===false){executeKeydownOverride(editor,caret,evt)}})};return{setup:setup}});define("tinymce.core.delete.InlineFormatDelete",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteElement","tinymce.core.delete.DeleteUtils","tinymce.core.dom.ElementType","tinymce.core.dom.Parents","tinymce.core.fmt.CaretFormat"],function(Arr,Fun,Element,Traverse,CaretPosition,DeleteElement,DeleteUtils,ElementType,Parents,CaretFormat){var getParentInlines=function(rootElm,startElm){var parents=Parents.parentsAndSelf(startElm,rootElm);return Arr.findIndex(parents,ElementType.isBlock).fold(Fun.constant(parents),function(index){return parents.slice(0,index)})};var hasOnlyOneChild=function(elm){return Traverse.children(elm).length===1};var deleteLastPosition=function(forward,editor,target,parentInlines){var isFormatElement=Fun.curry(CaretFormat.isFormatElement,editor);var formatNodes=Arr.map(Arr.filter(parentInlines,isFormatElement),function(elm){return elm.dom()});if(formatNodes.length===0){DeleteElement.deleteElement(editor,forward,target)}else{var pos=CaretFormat.replaceWithCaretFormat(target.dom(),formatNodes);editor.selection.setRng(pos.toRange())}};var deleteCaret=function(editor,forward){var rootElm=Element.fromDom(editor.getBody());var startElm=Element.fromDom(editor.selection.getStart());var parentInlines=Arr.filter(getParentInlines(rootElm,startElm),hasOnlyOneChild);return Arr.last(parentInlines).map(function(target){var fromPos=CaretPosition.fromRangeStart(editor.selection.getRng());if(DeleteUtils.willDeleteLastPositionInElement(forward,fromPos,target.dom())){deleteLastPosition(forward,editor,target,parentInlines);return true}else{return false}}).getOr(false)};var backspaceDelete=function(editor,forward){return editor.selection.isCollapsed()?deleteCaret(editor,forward):false};return{backspaceDelete:backspaceDelete}});define("tinymce.core.keyboard.DeleteBackspaceKeys",["tinymce.core.delete.BlockBoundaryDelete","tinymce.core.delete.BlockRangeDelete","tinymce.core.delete.CefDelete","tinymce.core.delete.InlineBoundaryDelete","tinymce.core.delete.InlineFormatDelete","tinymce.core.delete.TableDelete","tinymce.core.keyboard.MatchKeys","tinymce.core.util.VK"],function(BlockBoundaryDelete,BlockRangeDelete,CefDelete,InlineBoundaryDelete,InlineFormatDelete,TableDelete,MatchKeys,VK){var executeKeydownOverride=function(editor,caret,evt){MatchKeys.execute([{keyCode:VK.BACKSPACE,action:MatchKeys.action(CefDelete.backspaceDelete,editor,false)},{keyCode:VK.DELETE,action:MatchKeys.action(CefDelete.backspaceDelete,editor,true)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(InlineBoundaryDelete.backspaceDelete,editor,caret,false)},{keyCode:VK.DELETE,action:MatchKeys.action(InlineBoundaryDelete.backspaceDelete,editor,caret,true)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(BlockRangeDelete.backspaceDelete,editor,false)},{keyCode:VK.DELETE,action:MatchKeys.action(BlockRangeDelete.backspaceDelete,editor,true)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(BlockBoundaryDelete.backspaceDelete,editor,false)},{keyCode:VK.DELETE,action:MatchKeys.action(BlockBoundaryDelete.backspaceDelete,editor,true)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(TableDelete.backspaceDelete,editor,false)},{keyCode:VK.DELETE,action:MatchKeys.action(TableDelete.backspaceDelete,editor,true)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(InlineFormatDelete.backspaceDelete,editor,false)},{keyCode:VK.DELETE,action:MatchKeys.action(InlineFormatDelete.backspaceDelete,editor,true)}],evt).each(function(_){evt.preventDefault()})};var executeKeyupOverride=function(editor,evt){MatchKeys.execute([{keyCode:VK.BACKSPACE,action:MatchKeys.action(CefDelete.paddEmptyElement,editor)},{keyCode:VK.DELETE,action:MatchKeys.action(CefDelete.paddEmptyElement,editor)}],evt)};var setup=function(editor,caret){editor.on("keydown",function(evt){if(evt.isDefaultPrevented()===false){executeKeydownOverride(editor,caret,evt)}});editor.on("keyup",function(evt){if(evt.isDefaultPrevented()===false){executeKeyupOverride(editor,evt)}})};return{setup:setup}});define("tinymce.core.api.Settings",[],function(){var getBodySetting=function(editor,name,defaultValue){var value=editor.getParam(name,defaultValue);if(value.indexOf("=")!==-1){var bodyObj=editor.getParam(name,"","hash");return bodyObj.hasOwnProperty(editor.id)?bodyObj[editor.id]:defaultValue}else{return value}};var getIframeAttrs=function(editor){return editor.getParam("iframe_attrs",{})};var getDocType=function(editor){return editor.getParam("doctype","<!DOCTYPE html>")};var getDocumentBaseUrl=function(editor){return editor.getParam("document_base_url","")};var getBodyId=function(editor){return getBodySetting(editor,"body_id","tinymce")};var getBodyClass=function(editor){return getBodySetting(editor,"body_class","")};var getContentSecurityPolicy=function(editor){return editor.getParam("content_security_policy","")};var shouldPutBrInPre=function(editor){return editor.getParam("br_in_pre",true)};var getForcedRootBlock=function(editor){if(editor.getParam("force_p_newlines",false)){return"p"}var block=editor.getParam("forced_root_block","p");return block===false?"":block};var getForcedRootBlockAttrs=function(editor){return editor.getParam("forced_root_block_attrs",{})};var getBrNewLineSelector=function(editor){return editor.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")};var getNoNewLineSelector=function(editor){return editor.getParam("no_newline_selector","")};var shouldKeepStyles=function(editor){return editor.getParam("keep_styles",true)};var shouldEndContainerOnEmtpyBlock=function(editor){return editor.getParam("end_container_on_empty_block",false)};return{getIframeAttrs:getIframeAttrs,getDocType:getDocType,getDocumentBaseUrl:getDocumentBaseUrl,getBodyId:getBodyId,getBodyClass:getBodyClass,getContentSecurityPolicy:getContentSecurityPolicy,shouldPutBrInPre:shouldPutBrInPre,getForcedRootBlock:getForcedRootBlock,getForcedRootBlockAttrs:getForcedRootBlockAttrs,getBrNewLineSelector:getBrNewLineSelector,getNoNewLineSelector:getNoNewLineSelector,shouldKeepStyles:shouldKeepStyles,shouldEndContainerOnEmtpyBlock:shouldEndContainerOnEmtpyBlock}});define("tinymce.core.newline.NewLineUtils",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Element","tinymce.core.dom.ElementType","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker"],function(Fun,Option,Element,ElementType,NodeType,TreeWalker){var firstNonWhiteSpaceNodeSibling=function(node){while(node){if(node.nodeType===1||node.nodeType===3&&node.data&&/[\r\n\s]/.test(node.data)){return node}node=node.nextSibling}};var moveToCaretPosition=function(editor,root){var walker,node,rng,lastNode=root,tempElm,dom=editor.dom;var moveCaretBeforeOnEnterElementsMap=editor.schema.getMoveCaretBeforeOnEnterElements();if(!root){return}if(/^(LI|DT|DD)$/.test(root.nodeName)){var firstChild=firstNonWhiteSpaceNodeSibling(root.firstChild);if(firstChild&&/^(UL|OL|DL)$/.test(firstChild.nodeName)){root.insertBefore(dom.doc.createTextNode("¬†"),root.firstChild)}}rng=dom.createRng();root.normalize();if(root.hasChildNodes()){walker=new TreeWalker(root,root);while(node=walker.current()){if(NodeType.isText(node)){rng.setStart(node,0);rng.setEnd(node,0);break}if(moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node);rng.setEndBefore(node);break}lastNode=node;node=walker.next()}if(!node){rng.setStart(lastNode,0);rng.setEnd(lastNode,0)}}else{if(NodeType.isBr(root)){if(root.nextSibling&&dom.isBlock(root.nextSibling)){rng.setStartBefore(root);rng.setEndBefore(root)}else{rng.setStartAfter(root);rng.setEndAfter(root)}}else{rng.setStart(root,0);rng.setEnd(root,0)}}editor.selection.setRng(rng);dom.remove(tempElm);editor.selection.scrollIntoView(root)};var getEditableRoot=function(dom,node){var root=dom.getRoot(),parent,editableRoot;parent=node;while(parent!==root&&dom.getContentEditable(parent)!=="false"){if(dom.getContentEditable(parent)==="true"){editableRoot=parent}parent=parent.parentNode}return parent!==root?editableRoot:root};var getParentBlock=function(editor){return Option.from(editor.dom.getParent(editor.selection.getStart(true),editor.dom.isBlock))};var getParentBlockName=function(editor){return getParentBlock(editor).fold(Fun.constant(""),function(parentBlock){return parentBlock.nodeName.toUpperCase()})};var isListItemParentBlock=function(editor){return getParentBlock(editor).filter(function(elm){return ElementType.isListItem(Element.fromDom(elm))}).isSome()};return{moveToCaretPosition:moveToCaretPosition,getEditableRoot:getEditableRoot,getParentBlock:getParentBlock,getParentBlockName:getParentBlockName,isListItemParentBlock:isListItemParentBlock}});define("tinymce.core.newline.InsertLi",["tinymce.core.dom.NodeType","tinymce.core.newline.NewLineUtils"],function(NodeType,NewLineUtils){var hasFirstChild=function(elm,name){return elm.firstChild&&elm.firstChild.nodeName===name};var hasParent=function(elm,parentName){return elm&&elm.parentNode&&elm.parentNode.nodeName===parentName};var isListBlock=function(elm){return elm&&/^(OL|UL|LI)$/.test(elm.nodeName)};var isNestedList=function(elm){return isListBlock(elm)&&isListBlock(elm.parentNode)};var getContainerBlock=function(containerBlock){var containerBlockParent=containerBlock.parentNode;if(/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)){return containerBlockParent}return containerBlock};var isFirstOrLastLi=function(containerBlock,parentBlock,first){var node=containerBlock[first?"firstChild":"lastChild"];while(node){if(NodeType.isElement(node)){break}node=node[first?"nextSibling":"previousSibling"]}return node===parentBlock};var insert=function(editor,createNewBlock,containerBlock,parentBlock,newBlockName){var dom=editor.dom;var rng=editor.selection.getRng();if(containerBlock===editor.getBody()){return}if(isNestedList(containerBlock)){newBlockName="LI"}var newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR");if(isFirstOrLastLi(containerBlock,parentBlock,true)&&isFirstOrLastLi(containerBlock,parentBlock,false)){if(hasParent(containerBlock,"LI")){dom.insertAfter(newBlock,getContainerBlock(containerBlock))}else{dom.replace(newBlock,containerBlock)}}else if(isFirstOrLastLi(containerBlock,parentBlock,true)){if(hasParent(containerBlock,"LI")){dom.insertAfter(newBlock,getContainerBlock(containerBlock));newBlock.appendChild(dom.doc.createTextNode(" "));newBlock.appendChild(containerBlock)}else{containerBlock.parentNode.insertBefore(newBlock,containerBlock)}}else if(isFirstOrLastLi(containerBlock,parentBlock,false)){dom.insertAfter(newBlock,getContainerBlock(containerBlock))}else{containerBlock=getContainerBlock(containerBlock);var tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock);tmpRng.setEndAfter(containerBlock);var fragment=tmpRng.extractContents();if(newBlockName==="LI"&&hasFirstChild(fragment,"LI")){newBlock=fragment.firstChild;dom.insertAfter(fragment,containerBlock)}else{dom.insertAfter(fragment,containerBlock);dom.insertAfter(newBlock,containerBlock)}}dom.remove(parentBlock);NewLineUtils.moveToCaretPosition(editor,newBlock)};return{insert:insert}});define("tinymce.core.newline.InsertBlock",["tinymce.core.api.Settings","tinymce.core.caret.CaretContainer","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.fmt.CaretFormat","tinymce.core.newline.InsertLi","tinymce.core.newline.NewLineUtils","tinymce.core.selection.NormalizeRange","tinymce.core.text.Zwsp","tinymce.core.util.Tools"],function(Settings,CaretContainer,NodeType,TreeWalker,CaretFormat,InsertLi,NewLineUtils,NormalizeRange,Zwsp,Tools){var isEmptyAnchor=function(elm){return elm&&elm.nodeName==="A"&&Tools.trim(Zwsp.trim(elm.innerText||elm.textContent)).length===0};var isTableCell=function(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)};var emptyBlock=function(elm){elm.innerHTML='<br data-mce-bogus="1">'};var containerAndSiblingName=function(container,nodeName){return container.nodeName===nodeName||container.previousSibling&&container.previousSibling.nodeName===nodeName};var canSplitBlock=function(dom,node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&dom.getContentEditable(node)!=="true"};var trimInlineElementsOnLeftSideOfBlock=function(dom,nonEmptyElementsMap,block){var node=block,firstChilds=[],i;if(!node){return}while(node=node.firstChild){if(dom.isBlock(node)){return}if(NodeType.isElement(node)&&!nonEmptyElementsMap[node.nodeName.toLowerCase()]){firstChilds.push(node)}}i=firstChilds.length;while(i--){node=firstChilds[i];if(!node.hasChildNodes()||node.firstChild===node.lastChild&&node.firstChild.nodeValue===""){dom.remove(node)}else{if(isEmptyAnchor(node)){dom.remove(node)}}}};var normalizeZwspOffset=function(start,container,offset){if(NodeType.isText(container)===false){return offset}if(start){return offset===1&&container.data.charAt(offset-1)===Zwsp.ZWSP?0:offset}else{return offset===container.data.length-1&&container.data.charAt(offset)===Zwsp.ZWSP?container.data.length:offset}};var includeZwspInRange=function(rng){var newRng=rng.cloneRange();newRng.setStart(rng.startContainer,normalizeZwspOffset(true,rng.startContainer,rng.startOffset));newRng.setEnd(rng.endContainer,normalizeZwspOffset(false,rng.endContainer,rng.endOffset));return newRng};var trimLeadingLineBreaks=function(node){do{if(NodeType.isText(node)){node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"")}node=node.firstChild}while(node)};var getEditableRoot=function(dom,node){var root=dom.getRoot(),parent,editableRoot;parent=node;while(parent!==root&&dom.getContentEditable(parent)!=="false"){if(dom.getContentEditable(parent)==="true"){editableRoot=parent}parent=parent.parentNode}return parent!==root?editableRoot:root};var setForcedBlockAttrs=function(editor,node){var forcedRootBlockName=Settings.getForcedRootBlock(editor);if(forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()){editor.dom.setAttribs(node,Settings.getForcedRootBlockAttrs(editor))}};var wrapSelfAndSiblingsInDefaultBlock=function(editor,newBlockName,rng,container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName,blockName=newBlockName||"P";var dom=editor.dom,editableRoot=getEditableRoot(dom,container);parentBlock=dom.getParent(container,dom.isBlock);if(!parentBlock||!canSplitBlock(dom,parentBlock)){parentBlock=parentBlock||editableRoot;if(parentBlock===editor.getBody()||isTableCell(parentBlock)){rootBlockName=parentBlock.nodeName.toLowerCase()}else{rootBlockName=parentBlock.parentNode.nodeName.toLowerCase()}if(!parentBlock.hasChildNodes()){newBlock=dom.create(blockName);setForcedBlockAttrs(editor,newBlock);parentBlock.appendChild(newBlock);rng.setStart(newBlock,0);rng.setEnd(newBlock,0);return newBlock}node=container;while(node.parentNode!==parentBlock){node=node.parentNode}while(node&&!dom.isBlock(node)){startNode=node;node=node.previousSibling}if(startNode&&editor.schema.isValidChild(rootBlockName,blockName.toLowerCase())){newBlock=dom.create(blockName);setForcedBlockAttrs(editor,newBlock);startNode.parentNode.insertBefore(newBlock,startNode);node=startNode;while(node&&!dom.isBlock(node)){next=node.nextSibling;newBlock.appendChild(node);node=next}rng.setStart(container,offset);rng.setEnd(container,offset)}}return container};var addBrToBlockIfNeeded=function(dom,block){var lastChild;block.normalize();lastChild=block.lastChild;if(!lastChild||/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",true))){dom.add(block,"br")}};var insert=function(editor,evt){var tmpRng,editableRoot,container,offset,parentBlock,shiftKey;var newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer;var dom=editor.dom;var schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements();var rng=editor.selection.getRng();var createNewBlock=function(name){var node=container,block,clonedNode,caretNode,textInlineElements=schema.getTextInlineElements();if(name||parentBlockName==="TABLE"||parentBlockName==="HR"){block=dom.create(name||newBlockName);setForcedBlockAttrs(editor,block)}else{block=parentBlock.cloneNode(false)}caretNode=block;if(Settings.shouldKeepStyles(editor)===false){dom.setAttrib(block,"style",null);dom.setAttrib(block,"class",null)}else{do{if(textInlineElements[node.nodeName]){if(CaretFormat.isCaretNode(node)){continue}clonedNode=node.cloneNode(false);dom.setAttrib(clonedNode,"id","");if(block.hasChildNodes()){clonedNode.appendChild(block.firstChild);block.appendChild(clonedNode)}else{caretNode=clonedNode;block.appendChild(clonedNode)}}}while((node=node.parentNode)&&node!==editableRoot)}emptyBlock(caretNode);return block};var isCaretAtStartOrEndOfBlock=function(start){var walker,node,name,normalizedOffset;normalizedOffset=normalizeZwspOffset(start,container,offset);if(NodeType.isText(container)&&(start?normalizedOffset>0:normalizedOffset<container.nodeValue.length)){return false}if(container.parentNode===parentBlock&&isAfterLastNodeInContainer&&!start){return true}if(start&&NodeType.isElement(container)&&container===parentBlock.firstChild){return true}if(containerAndSiblingName(container,"TABLE")||containerAndSiblingName(container,"HR")){return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start}walker=new TreeWalker(container,parentBlock);if(NodeType.isText(container)){if(start&&normalizedOffset===0){walker.prev()}else if(!start&&normalizedOffset===container.nodeValue.length){walker.next()}}while(node=walker.current()){if(NodeType.isElement(node)){if(!node.getAttribute("data-mce-bogus")){name=node.nodeName.toLowerCase();if(nonEmptyElementsMap[name]&&name!=="br"){return false}}}else if(NodeType.isText(node)&&!/^[ \t\r\n]*$/.test(node.nodeValue)){return false}if(start){walker.prev()}else{walker.next()}}return true};var insertNewBlockAfter=function(){if(/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&containerBlockName!=="HGROUP"){newBlock=createNewBlock(newBlockName)}else{newBlock=createNewBlock()}if(Settings.shouldEndContainerOnEmtpyBlock(editor)&&canSplitBlock(dom,containerBlock)&&dom.isEmpty(parentBlock)){newBlock=dom.split(containerBlock,parentBlock)}else{dom.insertAfter(newBlock,parentBlock)}NewLineUtils.moveToCaretPosition(editor,newBlock)};NormalizeRange.normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset);rng.setEnd(normRng.endContainer,normRng.endOffset)});container=rng.startContainer;offset=rng.startOffset;newBlockName=Settings.getForcedRootBlock(editor);shiftKey=evt.shiftKey;if(NodeType.isElement(container)&&container.hasChildNodes()){isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&NodeType.isText(container)){offset=container.nodeValue.length}else{offset=0}}editableRoot=getEditableRoot(dom,container);if(!editableRoot){return}if(newBlockName&&!shiftKey||!newBlockName&&shiftKey){container=wrapSelfAndSiblingsInDefaultBlock(editor,newBlockName,rng,container,offset)}parentBlock=dom.getParent(container,dom.isBlock);containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null;parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"";containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"";if(containerBlockName==="LI"&&!evt.ctrlKey){parentBlock=containerBlock;containerBlock=containerBlock.parentNode;parentBlockName=containerBlockName}if(/^(LI|DT|DD)$/.test(parentBlockName)){if(dom.isEmpty(parentBlock)){InsertLi.insert(editor,createNewBlock,containerBlock,parentBlock,newBlockName);return}}if(newBlockName&&parentBlock===editor.getBody()){return}newBlockName=newBlockName||"P";if(CaretContainer.isCaretContainerBlock(parentBlock)){newBlock=CaretContainer.showCaretContainerBlock(parentBlock);if(dom.isEmpty(parentBlock)){emptyBlock(parentBlock)}NewLineUtils.moveToCaretPosition(editor,newBlock)}else if(isCaretAtStartOrEndOfBlock()){insertNewBlockAfter()}else if(isCaretAtStartOrEndOfBlock(true)){newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock);NewLineUtils.moveToCaretPosition(editor,containerAndSiblingName(parentBlock,"HR")?newBlock:parentBlock)}else{tmpRng=includeZwspInRange(rng).cloneRange();tmpRng.setEndAfter(parentBlock);fragment=tmpRng.extractContents();trimLeadingLineBreaks(fragment);newBlock=fragment.firstChild;dom.insertAfter(fragment,parentBlock);trimInlineElementsOnLeftSideOfBlock(dom,nonEmptyElementsMap,newBlock);addBrToBlockIfNeeded(dom,parentBlock);if(dom.isEmpty(parentBlock)){emptyBlock(parentBlock)}newBlock.normalize();if(dom.isEmpty(newBlock)){dom.remove(newBlock);insertNewBlockAfter()}else{NewLineUtils.moveToCaretPosition(editor,newBlock)}}dom.setAttrib(newBlock,"id","");editor.fire("NewBlock",{newBlock:newBlock})};return{insert:insert}});define("tinymce.core.newline.ContextSelectors",["ephox.sugar.api.node.Element","ephox.sugar.api.search.Selectors","tinymce.core.api.Settings","tinymce.core.newline.NewLineUtils"],function(Element,Selectors,Settings,NewLineUtils){var matchesSelector=function(editor,selector){return NewLineUtils.getParentBlock(editor).filter(function(parentBlock){return selector.length>0&&Selectors.is(Element.fromDom(parentBlock),selector)}).isSome()};var shouldInsertBr=function(editor){return matchesSelector(editor,Settings.getBrNewLineSelector(editor))};var shouldBlockNewLine=function(editor){return matchesSelector(editor,Settings.getNoNewLineSelector(editor))};return{shouldInsertBr:shouldInsertBr,shouldBlockNewLine:shouldBlockNewLine}});define("tinymce.core.newline.NewLineAction",["ephox.katamari.api.Adt","ephox.katamari.api.Arr","ephox.katamari.api.Option","tinymce.core.api.Settings","tinymce.core.newline.ContextSelectors","tinymce.core.newline.NewLineUtils","tinymce.core.util.LazyEvaluator"],function(Adt,Arr,Option,Settings,ContextSelectors,NewLineUtils,LazyEvaluator){var newLineAction=Adt.generate([{br:[]},{block:[]},{none:[]}]);var shouldBlockNewLine=function(editor,shiftKey){return ContextSelectors.shouldBlockNewLine(editor)};var isBrMode=function(requiredState){return function(editor,shiftKey){var brMode=Settings.getForcedRootBlock(editor)==="";return brMode===requiredState}};var inListBlock=function(requiredState){return function(editor,shiftKey){return NewLineUtils.isListItemParentBlock(editor)===requiredState}};var inPreBlock=function(requiredState){return function(editor,shiftKey){var inPre=NewLineUtils.getParentBlockName(editor)==="PRE";return inPre===requiredState}};var shouldPutBrInPre=function(requiredState){return function(editor,shiftKey){return Settings.shouldPutBrInPre(editor)===requiredState}};var inBrContext=function(editor,shiftKey){return ContextSelectors.shouldInsertBr(editor)};var hasShiftKey=function(editor,shiftKey){return shiftKey};var canInsertIntoEditableRoot=function(editor){var forcedRootBlock=Settings.getForcedRootBlock(editor);var rootEditable=NewLineUtils.getEditableRoot(editor.dom,editor.selection.getStart());return rootEditable&&editor.schema.isValidChild(rootEditable.nodeName,forcedRootBlock?forcedRootBlock:"P")};var match=function(predicates,action){return function(editor,shiftKey){var isMatch=Arr.foldl(predicates,function(res,p){return res&&p(editor,shiftKey)},true);return isMatch?Option.some(action):Option.none()}};var getAction=function(editor,evt){return LazyEvaluator.evaluateUntil([match([shouldBlockNewLine],newLineAction.none()),match([inPreBlock(true),shouldPutBrInPre(false),hasShiftKey],newLineAction.br()),match([inPreBlock(true),shouldPutBrInPre(false)],newLineAction.block()),match([inPreBlock(true),shouldPutBrInPre(true),hasShiftKey],newLineAction.block()),match([inPreBlock(true),shouldPutBrInPre(true)],newLineAction.br()),match([inListBlock(true),hasShiftKey],newLineAction.br()),match([inListBlock(true)],newLineAction.block()),match([isBrMode(true),hasShiftKey,canInsertIntoEditableRoot],newLineAction.block()),match([isBrMode(true)],newLineAction.br()),match([inBrContext],newLineAction.br()),match([isBrMode(false),hasShiftKey],newLineAction.br()),match([canInsertIntoEditableRoot],newLineAction.block())],[editor,evt.shiftKey]).getOr(newLineAction.none())};return{getAction:getAction}});define("tinymce.core.newline.InsertNewLine",["ephox.katamari.api.Fun","tinymce.core.newline.InsertBlock","tinymce.core.newline.InsertBr","tinymce.core.newline.NewLineAction"],function(Fun,InsertBlock,InsertBr,NewLineAction){var insert=function(editor,evt){NewLineAction.getAction(editor,evt).fold(function(){InsertBr.insert(editor,evt)},function(){InsertBlock.insert(editor,evt)},Fun.noop)};return{insert:insert}});define("tinymce.core.keyboard.EnterKey",["tinymce.core.newline.InsertNewLine","tinymce.core.util.VK"],function(InsertNewLine,VK){var endTypingLevel=function(undoManager){if(undoManager.typing){undoManager.typing=false;undoManager.add()}};var handleEnterKeyEvent=function(editor,event){if(event.isDefaultPrevented()){return}event.preventDefault();endTypingLevel(editor.undoManager);editor.undoManager.transact(function(){if(editor.selection.isCollapsed()===false){editor.execCommand("Delete")}InsertNewLine.insert(editor,event)})};var setup=function(editor){editor.on("keydown",function(event){if(event.keyCode===VK.ENTER){handleEnterKeyEvent(editor,event)}})};return{setup:setup}});define("tinymce.core.keyboard.InsertSpace",["ephox.katamari.api.Fun","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.InlineUtils"],function(Fun,CaretPosition,NodeType,BoundaryLocation,InlineUtils){var isValidInsertPoint=function(location,caretPosition){return isAtStartOrEnd(location)&&NodeType.isText(caretPosition.container())};var insertNbspAtPosition=function(editor,caretPosition){var container=caretPosition.container();var offset=caretPosition.offset();container.insertData(offset,"¬†");editor.selection.setCursorLocation(container,offset+1)};var insertAtLocation=function(editor,caretPosition,location){if(isValidInsertPoint(location,caretPosition)){insertNbspAtPosition(editor,caretPosition);return true}else{return false}};var insertAtCaret=function(editor){var isInlineTarget=Fun.curry(InlineUtils.isInlineTarget,editor);var caretPosition=CaretPosition.fromRangeStart(editor.selection.getRng());var boundaryLocation=BoundaryLocation.readLocation(isInlineTarget,editor.getBody(),caretPosition);return boundaryLocation.map(Fun.curry(insertAtLocation,editor,caretPosition)).getOr(false)};var isAtStartOrEnd=function(location){return location.fold(Fun.constant(false),Fun.constant(true),Fun.constant(true),Fun.constant(false))};var insertAtSelection=function(editor){return editor.selection.isCollapsed()?insertAtCaret(editor):false};return{insertAtSelection:insertAtSelection}});define("tinymce.core.keyboard.SpaceKey",["tinymce.core.keyboard.InsertSpace","tinymce.core.keyboard.MatchKeys","tinymce.core.util.VK"],function(InsertSpace,MatchKeys,VK){var executeKeydownOverride=function(editor,evt){MatchKeys.execute([{keyCode:VK.SPACEBAR,action:MatchKeys.action(InsertSpace.insertAtSelection,editor)}],evt).each(function(_){evt.preventDefault()})};var setup=function(editor){editor.on("keydown",function(evt){if(evt.isDefaultPrevented()===false){executeKeydownOverride(editor,evt)}})};return{setup:setup}});define("tinymce.core.keyboard.KeyboardOverrides",["tinymce.core.keyboard.ArrowKeys","tinymce.core.keyboard.BoundarySelection","tinymce.core.keyboard.DeleteBackspaceKeys","tinymce.core.keyboard.EnterKey","tinymce.core.keyboard.SpaceKey"],function(ArrowKeys,BoundarySelection,DeleteBackspaceKeys,EnterKey,SpaceKey){var setup=function(editor){var caret=BoundarySelection.setupSelectedState(editor);ArrowKeys.setup(editor,caret);DeleteBackspaceKeys.setup(editor,caret);EnterKey.setup(editor);SpaceKey.setup(editor)};return{setup:setup}});define("tinymce.core.util.Quirks",["global!document","global!window","tinymce.core.Env","tinymce.core.caret.CaretContainer","tinymce.core.selection.CaretRangeFromPoint","tinymce.core.util.Delay","tinymce.core.util.Tools","tinymce.core.util.VK"],function(document,window,Env,CaretContainer,CaretRangeFromPoint,Delay,Tools,VK){return function(editor){var each=Tools.each;var BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings,parser=editor.parser;var isGecko=Env.gecko,isIE=Env.ie,isWebKit=Env.webkit;var mceInternalUrlPrefix="data:text/mce-internal,";var mceInternalDataType=isIE?"Text":"URL";var setEditorCommandState=function(cmd,state){try{editor.getDoc().execCommand(cmd,false,state)}catch(ex){}};var isDefaultPrevented=function(e){return e.isDefaultPrevented()};var setMceInternalContent=function(e){var selectionHtml,internalContent;if(e.dataTransfer){if(editor.selection.isCollapsed()&&e.target.tagName=="IMG"){selection.select(e.target)}selectionHtml=editor.selection.getContent();if(selectionHtml.length>0){internalContent=mceInternalUrlPrefix+escape(editor.id)+","+escape(selectionHtml);e.dataTransfer.setData(mceInternalDataType,internalContent)}}};var getMceInternalContent=function(e){var internalContent;if(e.dataTransfer){internalContent=e.dataTransfer.getData(mceInternalDataType);if(internalContent&&internalContent.indexOf(mceInternalUrlPrefix)>=0){internalContent=internalContent.substr(mceInternalUrlPrefix.length).split(",");return{id:unescape(internalContent[0]),html:unescape(internalContent[1])}}}return null};var insertClipboardContents=function(content,internal){if(editor.queryCommandSupported("mceInsertClipboardContent")){editor.execCommand("mceInsertClipboardContent",false,{content:content,internal:internal})}else{editor.execCommand("mceInsertContent",false,content)}};var emptyEditorWhenDeleting=function(){var serializeRng=function(rng){var body=dom.create("body");var contents=rng.cloneContents();body.appendChild(contents);return selection.serializer.serialize(body,{format:"html"})};var allContentsSelected=function(rng){var selection=serializeRng(rng);var allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection};editor.on("keydown",function(e){var keyCode=e.keyCode,isCollapsed,body;if(!isDefaultPrevented(e)&&(keyCode==DELETE||keyCode==BACKSPACE)){isCollapsed=editor.selection.isCollapsed();body=editor.getBody();if(isCollapsed&&!dom.isEmpty(body)){return}if(!isCollapsed&&!allContentsSelected(editor.selection.getRng())){return}e.preventDefault();editor.setContent("");if(body.firstChild&&dom.isBlock(body.firstChild)){editor.selection.setCursorLocation(body.firstChild,0)}else{editor.selection.setCursorLocation(body,0)}editor.nodeChanged()}})};var selectAll=function(){editor.shortcuts.add("meta+a",null,"SelectAll")};var inputMethodFocus=function(){if(!editor.settings.content_editable){dom.bind(editor.getDoc(),"mousedown mouseup",function(e){var rng;if(e.target==editor.getDoc().documentElement){rng=selection.getRng();editor.getBody().focus();if(e.type=="mousedown"){if(CaretContainer.isCaretContainer(rng.startContainer)){return}selection.placeCaretAt(e.clientX,e.clientY)}else{selection.setRng(rng)}}})}};var removeHrOnBackspace=function(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(!editor.getBody().getElementsByTagName("hr").length){return}if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var node=selection.getNode();var previousSibling=node.previousSibling;if(node.nodeName=="HR"){dom.remove(node);e.preventDefault();return}if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==="hr"){dom.remove(previousSibling);e.preventDefault()}}}})};var focusBody=function(){if(!window.Range.prototype.getClientRects){editor.on("mousedown",function(e){if(!isDefaultPrevented(e)&&e.target.nodeName==="HTML"){var body=editor.getBody();body.blur();Delay.setEditorTimeout(editor,function(){body.focus()})}})}};var selectControlElements=function(){editor.on("click",function(e){var target=e.target;if(/^(IMG|HR)$/.test(target.nodeName)&&dom.getContentEditableParent(target)!=="false"){e.preventDefault();editor.selection.select(target);editor.nodeChanged()}if(target.nodeName=="A"&&dom.hasClass(target,"mce-item-anchor")){e.preventDefault();selection.select(target)}})};var removeStylesWhenDeletingAcrossBlockElements=function(){var getAttributeApplyFunction=function(){var template=dom.getAttribs(selection.getStart().cloneNode(false));return function(){var target=selection.getStart();if(target!==editor.getBody()){dom.setAttrib(target,"style",null);each(template,function(attr){target.setAttributeNode(attr.cloneNode(true))})}}};var isSelectionAcrossElements=function(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!=dom.getParent(selection.getEnd(),dom.isBlock)};editor.on("keypress",function(e){var applyAttributes;if(!isDefaultPrevented(e)&&(e.keyCode==8||e.keyCode==46)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();editor.getDoc().execCommand("delete",false,null);applyAttributes();e.preventDefault();return false}});dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;if(!isDefaultPrevented(e)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();Delay.setEditorTimeout(editor,function(){applyAttributes()})}})};var disableBackspaceIntoATable=function(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==="table"){e.preventDefault();return false}}}})};var removeBlockQuoteOnBackSpace=function(){editor.on("keydown",function(e){var rng,container,offset,root,parent;if(isDefaultPrevented(e)||e.keyCode!=VK.BACKSPACE){return}rng=selection.getRng();container=rng.startContainer;offset=rng.startOffset;root=dom.getRoot();parent=container;if(!rng.collapsed||offset!==0){return}while(parent&&parent.parentNode&&parent.parentNode.firstChild==parent&&parent.parentNode!=root){parent=parent.parentNode}if(parent.tagName==="BLOCKQUOTE"){editor.formatter.toggle("blockquote",null,parent);rng=dom.createRng();rng.setStart(container,0);rng.setEnd(container,0);selection.setRng(rng)}})};var setGeckoEditingOptions=function(){var setOpts=function(){setEditorCommandState("StyleWithCSS",false);setEditorCommandState("enableInlineTableEditing",false);if(!settings.object_resizing){setEditorCommandState("enableObjectResizing",false)}};if(!settings.readonly){editor.on("BeforeExecCommand MouseDown",setOpts)}};var addBrAfterLastLinks=function(){var fixLinks=function(){each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){while(parentNode&&!dom.isBlock(parentNode)){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root){return}parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})};editor.on("SetContent ExecCommand",function(e){if(e.type=="setcontent"||e.command==="mceInsertLink"){fixLinks()}})};var setDefaultBlockType=function(){if(settings.forced_root_block){editor.on("init",function(){setEditorCommandState("DefaultParagraphSeparator",settings.forced_root_block)})}};var normalizeSelection=function(){editor.on("keyup focusin mouseup",function(e){if(!VK.modifierPressed(e)){selection.normalize()}},true)};var showBrokenImageIcon=function(){editor.contentStyles.push("img:-moz-broken {"+"-moz-force-broken-image-icon:1;"+"min-width:24px;"+"min-height:24px"+"}")};var restoreFocusOnKeyDown=function(){if(!editor.inline){editor.on("keydown",function(){if(document.activeElement==document.body){editor.getWin().focus()}})}};var bodyHeight=function(){if(!editor.inline){editor.contentStyles.push("body {min-height: 150px}");editor.on("click",function(e){var rng;if(e.target.nodeName=="HTML"){if(Env.ie>11){editor.getBody().focus();return}rng=editor.selection.getRng();editor.getBody().focus();editor.selection.setRng(rng);editor.selection.normalize();editor.nodeChanged()}})}};var blockCmdArrowNavigation=function(){if(Env.mac){editor.on("keydown",function(e){if(VK.metaKeyPressed(e)&&!e.shiftKey&&(e.keyCode==37||e.keyCode==39)){e.preventDefault();editor.selection.getSel().modify("move",e.keyCode==37?"backward":"forward","lineboundary")}})}};var disableAutoUrlDetect=function(){setEditorCommandState("AutoUrlDetect",false)};var tapLinksAndImages=function(){editor.on("click",function(e){var elm=e.target;do{if(elm.tagName==="A"){e.preventDefault();return}}while(elm=elm.parentNode)});editor.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")};var blockFormSubmitInsideEditor=function(){editor.on("init",function(){editor.dom.bind(editor.getBody(),"submit",function(e){e.preventDefault()})})};var removeAppleInterchangeBrs=function(){parser.addNodeFilter("br",function(nodes){var i=nodes.length;while(i--){if(nodes[i].attr("class")=="Apple-interchange-newline"){nodes[i].remove()}}})};var ieInternalDragAndDrop=function(){editor.on("dragstart",function(e){setMceInternalContent(e)});editor.on("drop",function(e){if(!isDefaultPrevented(e)){var internalContent=getMceInternalContent(e);if(internalContent&&internalContent.id!=editor.id){e.preventDefault();var rng=CaretRangeFromPoint.fromPoint(e.x,e.y,editor.getDoc());selection.setRng(rng);insertClipboardContents(internalContent.html,true)}}})};var refreshContentEditable=function(){};var isHidden=function(){var sel;if(!isGecko||editor.removed){return 0}sel=editor.selection.getSel();return!sel||!sel.rangeCount||sel.rangeCount===0};removeBlockQuoteOnBackSpace();emptyEditorWhenDeleting();if(!Env.windowsPhone){normalizeSelection()}if(isWebKit){inputMethodFocus();selectControlElements();setDefaultBlockType();blockFormSubmitInsideEditor();disableBackspaceIntoATable();removeAppleInterchangeBrs();if(Env.iOS){restoreFocusOnKeyDown();bodyHeight();tapLinksAndImages()}else{selectAll()}}if(Env.ie>=11){bodyHeight();disableBackspaceIntoATable()}if(Env.ie){selectAll();disableAutoUrlDetect();ieInternalDragAndDrop()}if(isGecko){removeHrOnBackspace();focusBody();removeStylesWhenDeletingAcrossBlockElements();setGeckoEditingOptions();addBrAfterLastLinks();showBrokenImageIcon();blockCmdArrowNavigation();disableBackspaceIntoATable()}return{refreshContentEditable:refreshContentEditable,isHidden:isHidden}}});define("tinymce.core.init.InitContentBody",["ephox.sugar.api.dom.Insert","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","global!document","global!window","tinymce.core.EditorUpload","tinymce.core.ForceBlocks","tinymce.core.NodeChange","tinymce.core.SelectionOverrides","tinymce.core.UndoManager","tinymce.core.api.Formatter","tinymce.core.api.dom.Serializer","tinymce.core.caret.CaretContainerInput","tinymce.core.dom.DOMUtils","tinymce.core.dom.Selection","tinymce.core.html.DomParser","tinymce.core.html.Node","tinymce.core.html.Schema","tinymce.core.keyboard.KeyboardOverrides","tinymce.core.util.Delay","tinymce.core.util.Quirks","tinymce.core.util.Tools"],function(Insert,Element,Attr,document,window,EditorUpload,ForceBlocks,NodeChange,SelectionOverrides,UndoManager,Formatter,Serializer,CaretContainerInput,DOMUtils,Selection,DomParser,Node,Schema,KeyboardOverrides,Delay,Quirks,Tools){var DOM=DOMUtils.DOM;var appendStyle=function(editor,text){var head=Element.fromDom(editor.getDoc().head);var tag=Element.fromTag("style");Attr.set(tag,"type","text/css");Insert.append(tag,Element.fromText(text));Insert.append(head,tag)};var createParser=function(editor){var parser=new DomParser(editor.settings,editor.schema);parser.addAttributeFilter("src,href,style,tabindex",function(nodes,name){var i=nodes.length,node,dom=editor.dom,value,internalName;while(i--){node=nodes[i];value=node.attr(name);internalName="data-mce-"+name;if(!node.attributes.map[internalName]){if(value.indexOf("data:")===0||value.indexOf("blob:")===0){continue}if(name==="style"){value=dom.serializeStyle(dom.parseStyle(value),node.name);if(!value.length){value=null}node.attr(internalName,value);node.attr(name,value)}else if(name==="tabindex"){node.attr(internalName,value);node.attr(name,null)}else{node.attr(internalName,editor.convertURL(value,name,node.name))}}}});parser.addNodeFilter("script",function(nodes){var i=nodes.length,node,type;while(i--){node=nodes[i];type=node.attr("type")||"no/type";if(type.indexOf("mce-")!==0){node.attr("type","mce-"+type)}}});parser.addNodeFilter("#cdata",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];node.type=8;node.name="#comment";node.value="[CDATA["+node.value+"]]"}});parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(nodes){var i=nodes.length,node,nonEmptyElements=editor.schema.getNonEmptyElements();while(i--){node=nodes[i];if(node.isEmpty(nonEmptyElements)&&node.getAll("br").length===0){node.append(new Node("br",1)).shortEnded=true}}});return parser};var autoFocus=function(editor){if(editor.settings.auto_focus){Delay.setEditorTimeout(editor,function(){var focusEditor;if(editor.settings.auto_focus===true){focusEditor=editor}else{focusEditor=editor.editorManager.get(editor.settings.auto_focus)}if(!focusEditor.destroyed){focusEditor.focus()}},100)}};var initEditor=function(editor){editor.bindPendingEventDelegates();editor.initialized=true;editor.fire("init");editor.focus(true);editor.nodeChanged({initial:true});editor.execCallback("init_instance_callback",editor);autoFocus(editor)};var getStyleSheetLoader=function(editor){return editor.inline?DOM.styleSheetLoader:editor.dom.styleSheetLoader};var initContentBody=function(editor,skipWrite){var settings=editor.settings,targetElm=editor.getElement(),doc=editor.getDoc(),body,contentCssText;if(!settings.inline){editor.getElement().style.visibility=editor.orgVisibility}if(!skipWrite&&!settings.content_editable){doc.open();doc.write(editor.iframeHTML);doc.close()}if(settings.content_editable){editor.on("remove",function(){var bodyEl=this.getBody();DOM.removeClass(bodyEl,"mce-content-body");DOM.removeClass(bodyEl,"mce-edit-focus");DOM.setAttrib(bodyEl,"contentEditable",null)});DOM.addClass(targetElm,"mce-content-body");editor.contentDocument=doc=settings.content_document||document;editor.contentWindow=settings.content_window||window;editor.bodyElement=targetElm;settings.content_document=settings.content_window=null;settings.root_name=targetElm.nodeName.toLowerCase()}body=editor.getBody();body.disabled=true;editor.readonly=settings.readonly;if(!editor.readonly){if(editor.inline&&DOM.getStyle(body,"position",true)==="static"){body.style.position="relative"}body.contentEditable=editor.getParam("content_editable_state",true)}body.disabled=false;editor.editorUpload=new EditorUpload(editor);editor.schema=new Schema(settings);editor.dom=new DOMUtils(doc,{keep_values:true,url_converter:editor.convertURL,url_converter_scope:editor,hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:true,root_element:editor.inline?editor.getBody():null,collect:settings.content_editable,schema:editor.schema,onSetAttrib:function(e){editor.fire("SetAttrib",e)}});editor.parser=createParser(editor);editor.serializer=new Serializer(settings,editor);editor.selection=new Selection(editor.dom,editor.getWin(),editor.serializer,editor);editor.formatter=new Formatter(editor);editor.undoManager=new UndoManager(editor);editor._nodeChangeDispatcher=new NodeChange(editor);editor._selectionOverrides=new SelectionOverrides(editor);CaretContainerInput.setup(editor);KeyboardOverrides.setup(editor);ForceBlocks.setup(editor);editor.fire("PreInit");if(!settings.browser_spellcheck&&!settings.gecko_spellcheck){doc.body.spellcheck=false;DOM.setAttrib(body,"spellcheck","false")}editor.quirks=new Quirks(editor);editor.fire("PostRender");if(settings.directionality){body.dir=settings.directionality}if(settings.nowrap){body.style.whiteSpace="nowrap"}if(settings.protect){editor.on("BeforeSetContent",function(e){Tools.each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return"\x3c!--mce:protected "+escape(str)+"--\x3e"})})})}editor.on("SetContent",function(){editor.addVisual(editor.getBody())});if(settings.padd_empty_editor){editor.on("PostProcess",function(e){e.content=e.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|<br \/>|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")})}editor.load({initial:true,format:"html"});editor.startContent=editor.getContent({format:"raw"});editor.on("compositionstart compositionend",function(e){editor.composing=e.type==="compositionstart"});if(editor.contentStyles.length>0){contentCssText="";Tools.each(editor.contentStyles,function(style){contentCssText+=style+"\r\n"});editor.dom.addStyle(contentCssText)}getStyleSheetLoader(editor).loadAll(editor.contentCSS,function(_){initEditor(editor)},function(urls){initEditor(editor)});if(settings.content_style){appendStyle(editor,settings.content_style)}};return{initContentBody:initContentBody}});define("tinymce.core.init.InitIframe",["ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","global!document","global!window","tinymce.core.Env","tinymce.core.api.Settings","tinymce.core.dom.DOMUtils","tinymce.core.init.InitContentBody","tinymce.core.util.Uuid"],function(Element,Attr,Css,document,window,Env,Settings,DOMUtils,InitContentBody,Uuid){var DOM=DOMUtils.DOM;var relaxDomain=function(editor,ifr){if(document.domain!==window.location.hostname&&Env.ie&&Env.ie<12){var bodyUuid=Uuid.uuid("mce");editor[bodyUuid]=function(){InitContentBody.initContentBody(editor)};var domainRelaxUrl="javascript:(function(){"+'document.open();document.domain="'+document.domain+'";'+'var ed = window.parent.tinymce.get("'+editor.id+'");document.write(ed.iframeHTML);'+"document.close();ed."+bodyUuid+"(true);})()";DOM.setAttrib(ifr,"src",domainRelaxUrl);return true}return false};var normalizeHeight=function(height){var normalizedHeight=typeof height==="number"?height+"px":height;return normalizedHeight?normalizedHeight:""};var createIframeElement=function(id,title,height,customAttrs){var iframe=Element.fromTag("iframe");Attr.setAll(iframe,customAttrs);Attr.setAll(iframe,{id:id+"_ifr",frameBorder:"0",allowTransparency:"true",title:title});Css.setAll(iframe,{width:"100%",height:normalizeHeight(height),display:"block"});return iframe};var getIframeHtml=function(editor){var bodyId,bodyClass,iframeHTML;iframeHTML=Settings.getDocType(editor)+"<html><head>";if(Settings.getDocumentBaseUrl(editor)!==editor.documentBaseUrl){iframeHTML+='<base href="'+editor.documentBaseURI.getURI()+'" />'}iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';bodyId=Settings.getBodyId(editor);bodyClass=Settings.getBodyClass(editor);if(Settings.getContentSecurityPolicy(editor)){iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+Settings.getContentSecurityPolicy(editor)+'" />'}iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" data-id="'+editor.id+'"><br></body></html>';return iframeHTML};var createIframe=function(editor,o){var title=editor.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. "+"Press ALT-F10 for toolbar. Press ALT-0 for help");var ifr=createIframeElement(editor.id,title,o.height,Settings.getIframeAttrs(editor)).dom();ifr.onload=function(){ifr.onload=null;editor.fire("load")};var isDomainRelaxed=relaxDomain(editor,ifr);editor.contentAreaContainer=o.iframeContainer;editor.iframeElement=ifr;editor.iframeHTML=getIframeHtml(editor);DOM.add(o.iframeContainer,ifr);return isDomainRelaxed};var init=function(editor,boxInfo){var isDomainRelaxed=createIframe(editor,boxInfo);if(boxInfo.editorContainer){DOM.get(boxInfo.editorContainer).style.display=editor.orgDisplay;editor.hidden=DOM.isHidden(boxInfo.editorContainer)}editor.getElement().style.display="none";DOM.setAttrib(editor.id,"aria-hidden",true);if(!isDomainRelaxed){InitContentBody.initContentBody(editor)}};return{init:init}});define("tinymce.core.init.Init",["ephox.katamari.api.Type","global!document","global!window","tinymce.core.PluginManager","tinymce.core.ThemeManager","tinymce.core.dom.DOMUtils","tinymce.core.init.InitContentBody","tinymce.core.init.InitIframe","tinymce.core.util.Tools"],function(Type,document,window,PluginManager,ThemeManager,DOMUtils,InitContentBody,InitIframe,Tools){var DOM=DOMUtils.DOM;var initPlugin=function(editor,initializedPlugins,plugin){var Plugin=PluginManager.get(plugin),pluginUrl,pluginInstance;pluginUrl=PluginManager.urls[plugin]||editor.documentBaseUrl.replace(/\/$/,"");plugin=Tools.trim(plugin);if(Plugin&&Tools.inArray(initializedPlugins,plugin)===-1){Tools.each(PluginManager.dependencies(plugin),function(dep){initPlugin(editor,initializedPlugins,dep)});if(editor.plugins[plugin]){return}pluginInstance=new Plugin(editor,pluginUrl,editor.$);editor.plugins[plugin]=pluginInstance;if(pluginInstance.init){pluginInstance.init(editor,pluginUrl);initializedPlugins.push(plugin)}}};var trimLegacyPrefix=function(name){return name.replace(/^\-/,"")};var initPlugins=function(editor){var initializedPlugins=[];Tools.each(editor.settings.plugins.split(/[ ,]/),function(name){initPlugin(editor,initializedPlugins,trimLegacyPrefix(name))})};var initTheme=function(editor){var Theme,theme=editor.settings.theme;if(Type.isString(theme)){editor.settings.theme=trimLegacyPrefix(theme);Theme=ThemeManager.get(theme);editor.theme=new Theme(editor,ThemeManager.urls[theme]);if(editor.theme.init){editor.theme.init(editor,ThemeManager.urls[theme]||editor.documentBaseUrl.replace(/\/$/,""),editor.$)}}else{editor.theme={}}};var renderFromLoadedTheme=function(editor){var w,h,minHeight,re,info,settings=editor.settings,elm=editor.getElement();w=settings.width||DOM.getStyle(elm,"width")||"100%";h=settings.height||DOM.getStyle(elm,"height")||elm.offsetHeight;minHeight=settings.min_height||100;re=/^[0-9\.]+(|px)$/i;if(re.test(""+w)){w=Math.max(parseInt(w,10),100)}if(re.test(""+h)){h=Math.max(parseInt(h,10),minHeight)}info=editor.theme.renderUI({targetNode:elm,width:w,height:h,deltaWidth:settings.delta_width,deltaHeight:settings.delta_height});if(!settings.content_editable){h=(info.iframeHeight||h)+(typeof h==="number"?info.deltaHeight||0:"");if(h<minHeight){h=minHeight}}info.height=h;return info};var renderFromThemeFunc=function(editor){var info,elm=editor.getElement();info=editor.settings.theme(editor,elm);if(info.editorContainer.nodeType){info.editorContainer.id=info.editorContainer.id||editor.id+"_parent"}if(info.iframeContainer&&info.iframeContainer.nodeType){info.iframeContainer.id=info.iframeContainer.id||editor.id+"_iframecontainer"}info.height=info.iframeHeight?info.iframeHeight:elm.offsetHeight;return info};var createThemeFalseResult=function(element){return{editorContainer:element,iframeContainer:element}};var renderThemeFalseIframe=function(targetElement){var iframeContainer=DOM.create("div");DOM.insertAfter(iframeContainer,targetElement);return createThemeFalseResult(iframeContainer)};var renderThemeFalse=function(editor){var targetElement=editor.getElement();return editor.inline?createThemeFalseResult(null):renderThemeFalseIframe(targetElement)};var renderThemeUi=function(editor){var settings=editor.settings,elm=editor.getElement();editor.orgDisplay=elm.style.display;if(Type.isString(settings.theme)){return renderFromLoadedTheme(editor)}else if(Type.isFunction(settings.theme)){return renderFromThemeFunc(editor)}else{return renderThemeFalse(editor)}};var init=function(editor){var settings=editor.settings,elm=editor.getElement(),boxInfo;editor.rtl=settings.rtl_ui||editor.editorManager.i18n.rtl;editor.editorManager.i18n.setCode(settings.language);settings.aria_label=settings.aria_label||DOM.getAttrib(elm,"aria-label",editor.getLang("aria.rich_text_area"));editor.fire("ScriptsLoaded");initTheme(editor);initPlugins(editor);boxInfo=renderThemeUi(editor);editor.editorContainer=boxInfo.editorContainer?boxInfo.editorContainer:null;if(settings.content_css){Tools.each(Tools.explode(settings.content_css),function(u){editor.contentCSS.push(editor.documentBaseURI.toAbsolute(u))})}if(settings.content_editable){return InitContentBody.initContentBody(editor)}else{return InitIframe.init(editor,boxInfo)}};return{init:init}});define("tinymce.core.init.Render",["ephox.katamari.api.Type","global!window","tinymce.core.api.NotificationManager","tinymce.core.api.WindowManager","tinymce.core.dom.DOMUtils","tinymce.core.dom.EventUtils","tinymce.core.dom.ScriptLoader","tinymce.core.Env","tinymce.core.ErrorReporter","tinymce.core.init.Init","tinymce.core.PluginManager","tinymce.core.ThemeManager","tinymce.core.util.Tools"],function(Type,window,NotificationManager,WindowManager,DOMUtils,EventUtils,ScriptLoader,Env,ErrorReporter,Init,PluginManager,ThemeManager,Tools){var DOM=DOMUtils.DOM;var hasSkipLoadPrefix=function(name){return name.charAt(0)==="-"};var loadLanguage=function(scriptLoader,editor){var settings=editor.settings;if(settings.language&&settings.language!=="en"&&!settings.language_url){settings.language_url=editor.editorManager.baseURL+"/langs/"+settings.language+".js"}if(settings.language_url&&!editor.editorManager.i18n.data[settings.language]){scriptLoader.add(settings.language_url)}};var loadTheme=function(scriptLoader,editor,suffix,callback){var settings=editor.settings,theme=settings.theme;if(Type.isString(theme)){if(!hasSkipLoadPrefix(theme)&&!ThemeManager.urls.hasOwnProperty(theme)){var themeUrl=settings.theme_url;if(themeUrl){ThemeManager.load(theme,editor.documentBaseURI.toAbsolute(themeUrl))}else{ThemeManager.load(theme,"themes/"+theme+"/theme"+suffix+".js")}}scriptLoader.loadQueue(function(){ThemeManager.waitFor(theme,callback)})}else{callback()}};var loadPlugins=function(settings,suffix){if(Tools.isArray(settings.plugins)){settings.plugins=settings.plugins.join(" ")}Tools.each(settings.external_plugins,function(url,name){PluginManager.load(name,url);settings.plugins+=" "+name});Tools.each(settings.plugins.split(/[ ,]/),function(plugin){plugin=Tools.trim(plugin);if(plugin&&!PluginManager.urls[plugin]){if(hasSkipLoadPrefix(plugin)){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);Tools.each(dependencies,function(dep){var defaultSettings={prefix:"plugins/",resource:dep,suffix:"/plugin"+suffix+".js"};dep=PluginManager.createUrl(defaultSettings,dep);PluginManager.load(dep.resource,dep)})}else{PluginManager.load(plugin,{prefix:"plugins/",resource:plugin,suffix:"/plugin"+suffix+".js"})}}})};var loadScripts=function(editor,suffix){var scriptLoader=ScriptLoader.ScriptLoader;loadTheme(scriptLoader,editor,suffix,function(){loadLanguage(scriptLoader,editor);loadPlugins(editor.settings,suffix);scriptLoader.loadQueue(function(){if(!editor.removed){Init.init(editor)}},editor,function(urls){ErrorReporter.pluginLoadError(editor,urls[0]);if(!editor.removed){Init.init(editor)}})})};var render=function(editor){var settings=editor.settings,id=editor.id;var readyHandler=function(){DOM.unbind(window,"ready",readyHandler);editor.render()};if(!EventUtils.Event.domLoaded){DOM.bind(window,"ready",readyHandler);return}if(!editor.getElement()){return}if(!Env.contentEditable){return}if(!settings.inline){editor.orgVisibility=editor.getElement().style.visibility;editor.getElement().style.visibility="hidden"}else{editor.inline=true}var form=editor.getElement().form||DOM.getParent(id,"form");if(form){editor.formElement=form;if(settings.hidden_input&&!/TEXTAREA|INPUT/i.test(editor.getElement().nodeName)){DOM.insertAfter(DOM.create("input",{type:"hidden",name:id}),id);editor.hasHiddenInput=true}editor.formEventDelegate=function(e){editor.fire(e.type,e)};DOM.bind(form,"submit reset",editor.formEventDelegate);editor.on("reset",function(){editor.setContent(editor.startContent,{format:"raw"})});if(settings.submit_patch&&!form.submit.nodeType&&!form.submit.length&&!form._mceOldSubmit){form._mceOldSubmit=form.submit;form.submit=function(){editor.editorManager.triggerSave();editor.setDirty(false);return form._mceOldSubmit(form)}}}editor.windowManager=new WindowManager(editor);editor.notificationManager=new NotificationManager(editor);if(settings.encoding==="xml"){editor.on("GetContent",function(e){if(e.save){e.content=DOM.encode(e.content)}})}if(settings.add_form_submit_trigger){editor.on("submit",function(){if(editor.initialized){editor.save()}})}if(settings.add_unload_trigger){editor._beforeUnload=function(){if(editor.initialized&&!editor.destroyed&&!editor.isHidden()){editor.save({format:"raw",no_events:true,set_dirty:false})}};editor.editorManager.on("BeforeUnload",editor._beforeUnload)}editor.editorManager.add(editor);loadScripts(editor,editor.suffix)};return{render:render}});define("tinymce.core.ui.Sidebar",[],function(){var add=function(editor,name,settings){var sidebars=editor.sidebars?editor.sidebars:[];sidebars.push({name:name,settings:settings});editor.sidebars=sidebars};return{add:add}});define("tinymce.core.util.URI",["global!document","tinymce.core.util.Tools"],function(document,Tools){var each=Tools.each,trim=Tools.trim;var queryParts="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");var DEFAULT_PORTS={ftp:21,http:80,https:443,mailto:25};var URI=function(url,settings){var self=this,baseUri,baseUrl;url=trim(url);settings=self.settings=settings||{};baseUri=settings.base_uri;if(/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url)){self.source=url;return}var isProtocolRelative=url.indexOf("//")===0;if(url.indexOf("/")===0&&!isProtocolRelative){url=(baseUri?baseUri.protocol||"http":"http")+"://mce_host"+url}if(!/^[\w\-]*:?\/\//.test(url)){baseUrl=settings.base_uri?settings.base_uri.path:new URI(document.location.href).directory;if(settings.base_uri.protocol===""){url="//mce_host"+self.toAbsPath(baseUrl,url)}else{url=/([^#?]*)([#?]?.*)/.exec(url);url=(baseUri&&baseUri.protocol||"http")+"://mce_host"+self.toAbsPath(baseUrl,url[1])+url[2]}}url=url.replace(/@@/g,"(mce_at)");url=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url);each(queryParts,function(v,i){var part=url[i];if(part){part=part.replace(/\(mce_at\)/g,"@@")}self[v]=part});if(baseUri){if(!self.protocol){self.protocol=baseUri.protocol}if(!self.userInfo){self.userInfo=baseUri.userInfo}if(!self.port&&self.host==="mce_host"){self.port=baseUri.port}if(!self.host||self.host==="mce_host"){self.host=baseUri.host}self.source=""}if(isProtocolRelative){self.protocol=""}};URI.prototype={setPath:function(path){var self=this;path=/^(.*?)\/?(\w+)?$/.exec(path);self.path=path[0];self.directory=path[1];self.file=path[2];self.source="";self.getURI()},toRelative:function(uri){var self=this,output;if(uri==="./"){return uri}uri=new URI(uri,{base_uri:self});if(uri.host!="mce_host"&&self.host!=uri.host&&uri.host||self.port!=uri.port||self.protocol!=uri.protocol&&uri.protocol!==""){return uri.getURI()}var tu=self.getURI(),uu=uri.getURI();if(tu==uu||tu.charAt(tu.length-1)=="/"&&tu.substr(0,tu.length-1)==uu){return tu}output=self.toRelPath(self.path,uri.path);if(uri.query){output+="?"+uri.query}if(uri.anchor){output+="#"+uri.anchor}return output},toAbsolute:function(uri,noHost){uri=new URI(uri,{base_uri:this});return uri.getURI(noHost&&this.isSameOrigin(uri))},isSameOrigin:function(uri){if(this.host==uri.host&&this.protocol==uri.protocol){if(this.port==uri.port){return true}var defaultPort=DEFAULT_PORTS[this.protocol];if(defaultPort&&(this.port||defaultPort)==(uri.port||defaultPort)){return true}}return false},toRelPath:function(base,path){var items,breakPoint=0,out="",i,l;base=base.substring(0,base.lastIndexOf("/"));base=base.split("/");items=path.split("/");if(base.length>=items.length){for(i=0,l=base.length;i<l;i++){if(i>=items.length||base[i]!=items[i]){breakPoint=i+1;break}}}if(base.length<items.length){for(i=0,l=items.length;i<l;i++){if(i>=base.length||base[i]!=items[i]){breakPoint=i+1;break}}}if(breakPoint===1){return path}for(i=0,l=base.length-(breakPoint-1);i<l;i++){out+="../"}for(i=breakPoint-1,l=items.length;i<l;i++){if(i!=breakPoint-1){out+="/"+items[i]}else{out+=items[i]}}return out},toAbsPath:function(base,path){var i,nb=0,o=[],tr,outPath;tr=/\/$/.test(path)?"/":"";base=base.split("/");path=path.split("/");each(base,function(k){if(k){o.push(k)}});base=o;for(i=path.length-1,o=[];i>=0;i--){if(path[i].length===0||path[i]==="."){continue}if(path[i]===".."){nb++;continue}if(nb>0){nb--;continue}o.push(path[i])}i=base.length-nb;if(i<=0){outPath=o.reverse().join("/")}else{outPath=base.slice(0,i).join("/")+"/"+o.reverse().join("/")}if(outPath.indexOf("/")!==0){outPath="/"+outPath}if(tr&&outPath.lastIndexOf("/")!==outPath.length-1){outPath+=tr}return outPath},getURI:function(noProtoHost){var s,self=this;if(!self.source||noProtoHost){s="";if(!noProtoHost){if(self.protocol){s+=self.protocol+"://"}else{s+="//"}if(self.userInfo){s+=self.userInfo+"@"}if(self.host){s+=self.host}if(self.port){s+=":"+self.port}}if(self.path){s+=self.path}if(self.query){s+="?"+self.query}if(self.anchor){s+="#"+self.anchor}self.source=s}return self.source}};URI.parseDataUri=function(uri){var type,matches;uri=decodeURIComponent(uri).split(",");matches=/data:([^;]+)/.exec(uri[0]);if(matches){type=matches[1]}return{type:type,data:uri[1]}};URI.getDocumentBaseUrl=function(loc){var baseUrl;if(loc.protocol.indexOf("http")!==0&&loc.protocol!=="file:"){baseUrl=loc.href}else{baseUrl=loc.protocol+"//"+loc.host+loc.pathname}if(/^[^:]+:\/\/\/?[^\/]+\//.test(baseUrl)){baseUrl=baseUrl.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");if(!/[\/\\]$/.test(baseUrl)){baseUrl+="/"}}return baseUrl};return URI});define("tinymce.core.Editor",["tinymce.core.AddOnManager","tinymce.core.EditorCommands","tinymce.core.EditorObservable","tinymce.core.EditorSettings","tinymce.core.Env","tinymce.core.Mode","tinymce.core.Shortcuts","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomQuery","tinymce.core.dom.TrimHtml","tinymce.core.focus.EditorFocus","tinymce.core.html.Serializer","tinymce.core.init.Render","tinymce.core.ui.Sidebar","tinymce.core.util.Tools","tinymce.core.util.URI","tinymce.core.util.Uuid"],function(AddOnManager,EditorCommands,EditorObservable,EditorSettings,Env,Mode,Shortcuts,DOMUtils,DomQuery,TrimHtml,EditorFocus,Serializer,Render,Sidebar,Tools,URI,Uuid){var DOM=DOMUtils.DOM;var extend=Tools.extend,each=Tools.each;var trim=Tools.trim,resolve=Tools.resolve;var ie=Env.ie;var Editor=function(id,settings,editorManager){var self=this,documentBaseUrl,baseUri;documentBaseUrl=self.documentBaseUrl=editorManager.documentBaseURL;baseUri=editorManager.baseURI;settings=EditorSettings.getEditorSettings(self,id,documentBaseUrl,editorManager.defaultSettings,settings);self.settings=settings;AddOnManager.language=settings.language||"en";AddOnManager.languageLoad=settings.language_load;AddOnManager.baseURL=editorManager.baseURL;self.id=id;self.setDirty(false);self.plugins={};self.documentBaseURI=new URI(settings.document_base_url,{base_uri:baseUri});self.baseURI=baseUri;self.contentCSS=[];self.contentStyles=[];self.shortcuts=new Shortcuts(self);self.loadedCSS={};self.editorCommands=new EditorCommands(self);self.suffix=editorManager.suffix;self.editorManager=editorManager;self.inline=settings.inline;self.buttons={};self.menuItems={};if(settings.cache_suffix){Env.cacheSuffix=settings.cache_suffix.replace(/^[\?\&]+/,"")}if(settings.override_viewport===false){Env.overrideViewPort=false}editorManager.fire("SetupEditor",self);self.execCallback("setup",self);self.$=DomQuery.overrideDefaults(function(){return{context:self.inline?self.getBody():self.getDoc(),element:self.getBody()}})};Editor.prototype={render:function(){Render.render(this)},focus:function(skipFocus){EditorFocus.focus(this,skipFocus)},execCallback:function(name){var self=this,callback=self.settings[name],scope;if(!callback){return}if(self.callbackLookup&&(scope=self.callbackLookup[name])){callback=scope.func;scope=scope.scope}if(typeof callback==="string"){scope=callback.replace(/\.\w+$/,"");scope=scope?resolve(scope):0;callback=resolve(callback);self.callbackLookup=self.callbackLookup||{};self.callbackLookup[name]={func:callback,scope:scope}}return callback.apply(scope||self,Array.prototype.slice.call(arguments,1))},translate:function(text){if(text&&Tools.is(text,"string")){var lang=this.settings.language||"en",i18n=this.editorManager.i18n;text=i18n.data[lang+"."+text]||text.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n.data[lang+"."+b]||"{#"+b+"}"})}return this.editorManager.translate(text)},getLang:function(name,defaultVal){return this.editorManager.i18n.data[(this.settings.language||"en")+"."+name]||(defaultVal!==undefined?defaultVal:"{#"+name+"}")},getParam:function(name,defaultVal,type){var value=name in this.settings?this.settings[name]:defaultVal,output;if(type==="hash"){output={};if(typeof value==="string"){each(value.indexOf("=")>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(","),function(value){value=value.split("=");if(value.length>1){output[trim(value[0])]=trim(value[1])}else{output[trim(value[0])]=trim(value)}})}else{output=value}return output}return value},nodeChanged:function(args){this._nodeChangeDispatcher.nodeChanged(args)},addButton:function(name,settings){var self=this;if(settings.cmd){settings.onclick=function(){self.execCommand(settings.cmd)}}if(settings.stateSelector&&typeof settings.active==="undefined"){settings.active=false}if(!settings.text&&!settings.icon){settings.icon=name}self.buttons=self.buttons;settings.tooltip=settings.tooltip||settings.title;self.buttons[name]=settings},addSidebar:function(name,settings){return Sidebar.add(this,name,settings)},addMenuItem:function(name,settings){var self=this;if(settings.cmd){settings.onclick=function(){self.execCommand(settings.cmd)}}self.menuItems=self.menuItems;self.menuItems[name]=settings},addContextToolbar:function(predicate,items){var self=this,selector;self.contextToolbars=self.contextToolbars||[];if(typeof predicate=="string"){selector=predicate;predicate=function(elm){return self.dom.is(elm,selector)}}self.contextToolbars.push({id:Uuid.uuid("mcet"),predicate:predicate,items:items})},addCommand:function(name,callback,scope){this.editorCommands.addCommand(name,callback,scope)},addQueryStateHandler:function(name,callback,scope){this.editorCommands.addQueryStateHandler(name,callback,scope)},addQueryValueHandler:function(name,callback,scope){this.editorCommands.addQueryValueHandler(name,callback,scope)},addShortcut:function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope)},execCommand:function(cmd,ui,value,args){return this.editorCommands.execCommand(cmd,ui,value,args)},queryCommandState:function(cmd){return this.editorCommands.queryCommandState(cmd)},queryCommandValue:function(cmd){return this.editorCommands.queryCommandValue(cmd)},queryCommandSupported:function(cmd){return this.editorCommands.queryCommandSupported(cmd)},show:function(){var self=this;if(self.hidden){self.hidden=false;if(self.inline){self.getBody().contentEditable=true}else{DOM.show(self.getContainer());DOM.hide(self.id)}self.load();self.fire("show")}},hide:function(){var self=this,doc=self.getDoc();if(!self.hidden){if(ie&&doc&&!self.inline){doc.execCommand("SelectAll")}self.save();if(self.inline){self.getBody().contentEditable=false;if(self==self.editorManager.focusedEditor){self.editorManager.focusedEditor=null}}else{DOM.hide(self.getContainer());DOM.setStyle(self.id,"display",self.orgDisplay)}self.hidden=true;self.fire("hide")}},isHidden:function(){return!!this.hidden},setProgressState:function(state,time){this.fire("ProgressState",{state:state,time:time})},load:function(args){var self=this,elm=self.getElement(),html;if(self.removed){return""}if(elm){args=args||{};args.load=true;html=self.setContent(elm.value!==undefined?elm.value:elm.innerHTML,args);args.element=elm;if(!args.no_events){self.fire("LoadContent",args)}args.element=elm=null;return html}},save:function(args){var self=this,elm=self.getElement(),html,form;if(!elm||!self.initialized||self.removed){return}args=args||{};args.save=true;args.element=elm;html=args.content=self.getContent(args);if(!args.no_events){self.fire("SaveContent",args)}if(args.format=="raw"){self.fire("RawSaveContent",args)}html=args.content;if(!/TEXTAREA|INPUT/i.test(elm.nodeName)){if(!self.inline){elm.innerHTML=html}if(form=DOM.getParent(self.id,"form")){each(form.elements,function(elm){if(elm.name==self.id){elm.value=html;return false}})}}else{elm.value=html}args.element=elm=null;if(args.set_dirty!==false){self.setDirty(false)}return html},setContent:function(content,args){var self=this,body=self.getBody(),forcedRootBlockName,padd;args=args||{};args.format=args.format||"html";args.set=true;args.content=content;if(!args.no_events){self.fire("BeforeSetContent",args)}content=args.content;if(content.length===0||/^\s+$/.test(content)){padd=ie&&ie<11?"":'<br data-mce-bogus="1">';if(body.nodeName=="TABLE"){content="<tr><td>"+padd+"</td></tr>"}else if(/^(UL|OL)$/.test(body.nodeName)){content="<li>"+padd+"</li>"}forcedRootBlockName=self.settings.forced_root_block;if(forcedRootBlockName&&self.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())){content=padd;content=self.dom.createHTML(forcedRootBlockName,self.settings.forced_root_block_attrs,content)}else if(!ie&&!content){content='<br data-mce-bogus="1">'}self.dom.setHTML(body,content);self.fire("SetContent",args)}else{if(args.format!=="raw"){content=new Serializer({validate:self.validate},self.schema).serialize(self.parser.parse(content,{isRootContent:true,insert:true}))}args.content=trim(content);self.dom.setHTML(body,args.content);if(!args.no_events){self.fire("SetContent",args)}}return args.content},getContent:function(args){var self=this,content,body=self.getBody();if(self.removed){return""}args=args||{};args.format=args.format||"html";args.get=true;args.getInner=true;if(!args.no_events){self.fire("BeforeGetContent",args)}if(args.format==="raw"){content=Tools.trim(TrimHtml.trimExternal(self.serializer,body.innerHTML))}else if(args.format==="text"){content=body.innerText||body.textContent}else if(args.format==="tree"){return self.serializer.serialize(body,args)}else{content=self.serializer.serialize(body,args)}if(args.format!=="text"){args.content=trim(content)}else{args.content=content}if(!args.no_events){self.fire("GetContent",args)}return args.content},insertContent:function(content,args){if(args){content=extend({content:content},args)}this.execCommand("mceInsertContent",false,content)},isDirty:function(){return!this.isNotDirty},setDirty:function(state){var oldState=!this.isNotDirty;this.isNotDirty=!state;if(state&&state!=oldState){this.fire("dirty")}},setMode:function(mode){Mode.setMode(this,mode)},getContainer:function(){var self=this;if(!self.container){self.container=DOM.get(self.editorContainer||self.id+"_parent")}return self.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){if(!this.targetElm){this.targetElm=DOM.get(this.id)}return this.targetElm},getWin:function(){var self=this,elm;if(!self.contentWindow){elm=self.iframeElement;if(elm){self.contentWindow=elm.contentWindow}}return self.contentWindow},getDoc:function(){var self=this,win;if(!self.contentDocument){win=self.getWin();if(win){self.contentDocument=win.document}}return self.contentDocument},getBody:function(){var doc=this.getDoc();return this.bodyElement||(doc?doc.body:null)},convertURL:function(url,name,elm){var self=this,settings=self.settings;if(settings.urlconverter_callback){return self.execCallback("urlconverter_callback",url,elm,true,name)}if(!settings.convert_urls||elm&&elm.nodeName=="LINK"||url.indexOf("file:")===0||url.length===0){return url}if(settings.relative_urls){return self.documentBaseURI.toRelative(url)}url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host);return url},addVisual:function(elm){var self=this,settings=self.settings,dom=self.dom,cls;elm=elm||self.getBody();if(self.hasVisual===undefined){self.hasVisual=settings.visual}each(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case"TABLE":cls=settings.visual_table_class||"mce-item-table";value=dom.getAttrib(elm,"border");if((!value||value=="0")&&self.hasVisual){dom.addClass(elm,cls)}else{dom.removeClass(elm,cls)}return;case"A":if(!dom.getAttrib(elm,"href",false)){value=dom.getAttrib(elm,"name")||elm.id;cls=settings.visual_anchor_class||"mce-item-anchor";if(value&&self.hasVisual){dom.addClass(elm,cls)}else{dom.removeClass(elm,cls)}}return}});self.fire("VisualAid",{element:elm,hasVisual:self.hasVisual})},remove:function(){var self=this;if(!self.removed){self.save();self.removed=1;self.unbindAllNativeEvents();if(self.hasHiddenInput){DOM.remove(self.getElement().nextSibling)}if(!self.inline){if(ie&&ie<10){self.getDoc().execCommand("SelectAll",false,null)}DOM.setStyle(self.id,"display",self.orgDisplay);self.getBody().onload=null}self.fire("remove");self.editorManager.remove(self);DOM.remove(self.getContainer());self._selectionOverrides.destroy();self.editorUpload.destroy();self.destroy()}},destroy:function(automatic){var self=this,form;if(self.destroyed){return}if(!automatic&&!self.removed){self.remove();return}if(!automatic){self.editorManager.off("beforeunload",self._beforeUnload);if(self.theme&&self.theme.destroy){self.theme.destroy()}self.selection.destroy();self.dom.destroy()}form=self.formElement;if(form){if(form._mceOldSubmit){form.submit=form._mceOldSubmit;form._mceOldSubmit=null}DOM.unbind(form,"submit reset",self.formEventDelegate)}self.contentAreaContainer=self.formElement=self.container=self.editorContainer=null;self.bodyElement=self.contentDocument=self.contentWindow=null;self.iframeElement=self.targetElm=null;if(self.selection){self.selection=self.selection.win=self.selection.dom=self.selection.dom.doc=null}self.destroyed=1},uploadImages:function(callback){return this.editorUpload.uploadImages(callback)},_scanForImages:function(){return this.editorUpload.scanForImages()}};extend(Editor.prototype,EditorObservable);return Editor});define("tinymce.core.api.FocusManager",["global!document"],function(document){var isEditorUIElement=function(elm){return elm.className.toString().indexOf("mce-")!==-1};return{isEditorUIElement:isEditorUIElement}});define("tinymce.core.selection.SelectionRestore",["ephox.katamari.api.Throttler","ephox.sand.api.PlatformDetection","global!document","tinymce.core.dom.DOMUtils","tinymce.core.selection.SelectionBookmark"],function(Throttler,PlatformDetection,document,DOMUtils,SelectionBookmark){var isManualNodeChange=function(e){return e.type==="nodechange"&&e.selectionChange};var registerPageMouseUp=function(editor,throttledStore){var mouseUpPage=function(){throttledStore.throttle()};DOMUtils.DOM.bind(document,"mouseup",mouseUpPage);editor.on("remove",function(){DOMUtils.DOM.unbind(document,"mouseup",mouseUpPage)})};var registerFocusOut=function(editor){editor.on("focusout",function(){SelectionBookmark.store(editor)})};var registerMouseUp=function(editor,throttledStore){editor.on("mouseup touchend",function(e){throttledStore.throttle()})};var registerEditorEvents=function(editor,throttledStore){var browser=PlatformDetection.detect().browser;if(browser.isIE()||browser.isEdge()){registerFocusOut(editor)}else{registerMouseUp(editor,throttledStore)}editor.on("keyup nodechange",function(e){if(!isManualNodeChange(e)){SelectionBookmark.store(editor)}})};var register=function(editor){var throttledStore=Throttler.first(function(){SelectionBookmark.store(editor)},0);if(editor.inline){registerPageMouseUp(editor,throttledStore)}editor.on("init",function(){registerEditorEvents(editor,throttledStore)});editor.on("remove",function(){throttledStore.cancel()})};return{register:register}});define("tinymce.core.focus.FocusController",["ephox.katamari.api.Fun","global!document","tinymce.core.api.FocusManager","tinymce.core.dom.DOMUtils","tinymce.core.selection.SelectionRestore","tinymce.core.util.Delay"],function(Fun,document,FocusManager,DOMUtils,SelectionRestore,Delay){var documentFocusInHandler,DOM=DOMUtils.DOM;var isEditorUIElement=function(elm){return FocusManager.isEditorUIElement(elm)};var isUIElement=function(editor,elm){var customSelector=editor?editor.settings.custom_ui_selector:"";var parent=DOM.getParent(elm,function(elm){return isEditorUIElement(elm)||(customSelector?editor.dom.is(elm,customSelector):false)});return parent!==null};var getActiveElement=function(){try{return document.activeElement}catch(ex){return document.body}};var registerEvents=function(editorManager,e){var editor=e.editor;SelectionRestore.register(editor);editor.on("focusin",function(){var focusedEditor=editorManager.focusedEditor;if(focusedEditor!=editor){if(focusedEditor){focusedEditor.fire("blur",{focusedEditor:editor})}editorManager.setActive(editor);editorManager.focusedEditor=editor;editor.fire("focus",{blurredEditor:focusedEditor});editor.focus(true)}});editor.on("focusout",function(){Delay.setEditorTimeout(editor,function(){var focusedEditor=editorManager.focusedEditor;if(!isUIElement(editor,getActiveElement())&&focusedEditor==editor){editor.fire("blur",{focusedEditor:null});editorManager.focusedEditor=null}})});if(!documentFocusInHandler){documentFocusInHandler=function(e){var activeEditor=editorManager.activeEditor,target;target=e.target;if(activeEditor&&target.ownerDocument===document){if(target!==document.body&&!isUIElement(activeEditor,target)&&editorManager.focusedEditor===activeEditor){activeEditor.fire("blur",{focusedEditor:null});editorManager.focusedEditor=null}}};DOM.bind(document,"focusin",documentFocusInHandler)}};var unregisterDocumentEvents=function(editorManager,e){if(editorManager.focusedEditor==e.editor){editorManager.focusedEditor=null}if(!editorManager.activeEditor){DOM.unbind(document,"focusin",documentFocusInHandler);documentFocusInHandler=null}};var setup=function(editorManager){editorManager.on("AddEditor",Fun.curry(registerEvents,editorManager));editorManager.on("RemoveEditor",Fun.curry(unregisterDocumentEvents,editorManager))};return{setup:setup,isEditorUIElement:isEditorUIElement,isUIElement:isUIElement}});define("tinymce.core.util.I18n",["tinymce.core.util.Tools"],function(Tools){"use strict";var data={},code="en";return{setCode:function(newCode){if(newCode){code=newCode;this.rtl=this.data[newCode]?this.data[newCode]._dir==="rtl":false}},getCode:function(){return code},rtl:false,add:function(code,items){var langData=data[code];if(!langData){data[code]=langData={}}for(var name in items){langData[name]=items[name]}this.setCode(code)},translate:function(text){var langData=data[code]||{};var toString=function(obj){if(Tools.is(obj,"function")){return Object.prototype.toString.call(obj)}return!isEmpty(obj)?""+obj:""};var isEmpty=function(text){return text===""||text===null||Tools.is(text,"undefined")};var getLangData=function(text){text=toString(text);return Tools.hasOwn(langData,text)?toString(langData[text]):text};if(isEmpty(text)){return""}if(Tools.is(text,"object")&&Tools.hasOwn(text,"raw")){return toString(text.raw)}if(Tools.is(text,"array")){var values=text.slice(1);text=getLangData(text[0]).replace(/\{([0-9]+)\}/g,function($1,$2){return Tools.hasOwn(values,$2)?toString(values[$2]):$1})}return getLangData(text).replace(/{context:\w+}$/,"")},data:data}});define("tinymce.core.EditorManager",["ephox.katamari.api.Arr","ephox.katamari.api.Type","global!document","global!window","tinymce.core.AddOnManager","tinymce.core.Editor","tinymce.core.Env","tinymce.core.ErrorReporter","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomQuery","tinymce.core.focus.FocusController","tinymce.core.util.I18n","tinymce.core.util.Observable","tinymce.core.util.Promise","tinymce.core.util.Tools","tinymce.core.util.URI"],function(Arr,Type,document,window,AddOnManager,Editor,Env,ErrorReporter,DOMUtils,DomQuery,FocusController,I18n,Observable,Promise,Tools,URI){var DOM=DOMUtils.DOM;var explode=Tools.explode,each=Tools.each,extend=Tools.extend;var instanceCounter=0,beforeUnloadDelegate,EditorManager,boundGlobalEvents=false;var legacyEditors=[],editors=[];var isValidLegacyKey=function(id){return id!=="length"};var globalEventDelegate=function(e){each(EditorManager.get(),function(editor){if(e.type==="scroll"){editor.fire("ScrollWindow",e)}else{editor.fire("ResizeWindow",e)}})};var toggleGlobalEvents=function(state){if(state!==boundGlobalEvents){if(state){DomQuery(window).on("resize scroll",globalEventDelegate)}else{DomQuery(window).off("resize scroll",globalEventDelegate)}boundGlobalEvents=state}};var removeEditorFromList=function(targetEditor){var oldEditors=editors;delete legacyEditors[targetEditor.id];for(var i=0;i<legacyEditors.length;i++){if(legacyEditors[i]===targetEditor){legacyEditors.splice(i,1);break}}editors=Arr.filter(editors,function(editor){return targetEditor!==editor});if(EditorManager.activeEditor===targetEditor){EditorManager.activeEditor=editors.length>0?editors[0]:null}if(EditorManager.focusedEditor===targetEditor){EditorManager.focusedEditor=null}return oldEditors.length!==editors.length};var purgeDestroyedEditor=function(editor){if(editor&&editor.initialized&&!(editor.getContainer()||editor.getBody()).parentNode){removeEditorFromList(editor);editor.unbindAllNativeEvents();editor.destroy(true);editor.removed=true;editor=null}return editor};EditorManager={defaultSettings:{},$:DomQuery,majorVersion:"4",minorVersion:"7.4",releaseDate:"2017-12-05",editors:legacyEditors,i18n:I18n,activeEditor:null,settings:{},setup:function(){var self=this,baseURL,documentBaseURL,suffix="",preInit,src;documentBaseURL=URI.getDocumentBaseUrl(document.location);if(/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)){documentBaseURL=documentBaseURL.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");if(!/[\/\\]$/.test(documentBaseURL)){documentBaseURL+="/"}}preInit=window.tinymce||window.tinyMCEPreInit;if(preInit){baseURL=preInit.base||preInit.baseURL;suffix=preInit.suffix}else{var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){src=scripts[i].src;var srcScript=src.substring(src.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){if(srcScript.indexOf(".min")!=-1){suffix=".min"}baseURL=src.substring(0,src.lastIndexOf("/"));break}}if(!baseURL&&document.currentScript){src=document.currentScript.src;if(src.indexOf(".min")!=-1){suffix=".min"}baseURL=src.substring(0,src.lastIndexOf("/"))}}self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL);self.documentBaseURL=documentBaseURL;self.baseURI=new URI(self.baseURL);self.suffix=suffix;FocusController.setup(self)},overrideDefaults:function(defaultSettings){var baseUrl,suffix;baseUrl=defaultSettings.base_url;if(baseUrl){this.baseURL=new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\/+$/,""));this.baseURI=new URI(this.baseURL)}suffix=defaultSettings.suffix;if(defaultSettings.suffix){this.suffix=suffix}this.defaultSettings=defaultSettings;var pluginBaseUrls=defaultSettings.plugin_base_urls;for(var name in pluginBaseUrls){AddOnManager.PluginManager.urls[name]=pluginBaseUrls[name]}},init:function(settings){var self=this,result,invalidInlineTargets;invalidInlineTargets=Tools.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track "+"colgroup option tbody tfoot thead tr script noscript style textarea video audio iframe object menu"," ");var isInvalidInlineTarget=function(settings,elm){return settings.inline&&elm.tagName.toLowerCase()in invalidInlineTargets};var createId=function(elm){var id=elm.id;if(!id){id=elm.name;if(id&&!DOM.get(id)){id=elm.name}else{id=DOM.uniqueId()}elm.setAttribute("id",id)}return id};var execCallback=function(name){var callback=settings[name];if(!callback){return}return callback.apply(self,Array.prototype.slice.call(arguments,2))};var hasClass=function(elm,className){return className.constructor===RegExp?className.test(elm.className):DOM.hasClass(elm,className)};var findTargets=function(settings){var l,targets=[];if(Env.ie&&Env.ie<11){ErrorReporter.initError("TinyMCE does not support the browser you are using. For a list of supported"+" browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/");return[]}if(settings.types){each(settings.types,function(type){targets=targets.concat(DOM.select(type.selector))});return targets}else if(settings.selector){return DOM.select(settings.selector)}else if(settings.target){return[settings.target]}switch(settings.mode){case"exact":l=settings.elements||"";if(l.length>0){each(explode(l),function(id){var elm;if(elm=DOM.get(id)){targets.push(elm)}else{each(document.forms,function(f){each(f.elements,function(e){if(e.name===id){id="mce_editor_"+instanceCounter++;DOM.setAttrib(e,"id",id);targets.push(e)}})})}})}break;case"textareas":case"specific_textareas":each(DOM.select("textarea"),function(elm){if(settings.editor_deselector&&hasClass(elm,settings.editor_deselector)){return}if(!settings.editor_selector||hasClass(elm,settings.editor_selector)){targets.push(elm)}});break}return targets};var provideResults=function(editors){result=editors};var initEditors=function(){var initCount=0,editors=[],targets;var createEditor=function(id,settings,targetElm){var editor=new Editor(id,settings,self);editors.push(editor);editor.on("init",function(){if(++initCount===targets.length){provideResults(editors)}});editor.targetElm=editor.targetElm||targetElm;editor.render()};DOM.unbind(window,"ready",initEditors);execCallback("onpageload");targets=DomQuery.unique(findTargets(settings));if(settings.types){each(settings.types,function(type){Tools.each(targets,function(elm){if(DOM.is(elm,type.selector)){createEditor(createId(elm),extend({},settings,type),elm);return false}return true})});return}Tools.each(targets,function(elm){purgeDestroyedEditor(self.get(elm.id))});targets=Tools.grep(targets,function(elm){return!self.get(elm.id)});if(targets.length===0){provideResults([])}else{each(targets,function(elm){if(isInvalidInlineTarget(settings,elm)){ErrorReporter.initError("Could not initialize inline editor on invalid inline target element",elm)}else{createEditor(createId(elm),settings,elm)}})}};self.settings=settings;DOM.bind(window,"ready",initEditors);return new Promise(function(resolve){if(result){resolve(result)}else{provideResults=function(editors){resolve(editors)}}})},get:function(id){if(arguments.length===0){return editors.slice(0)}else if(Type.isString(id)){return Arr.find(editors,function(editor){return editor.id===id}).getOr(null)}else if(Type.isNumber(id)){return editors[id]?editors[id]:null}else{return null}},add:function(editor){var self=this,existingEditor;existingEditor=legacyEditors[editor.id];if(existingEditor===editor){return editor}if(self.get(editor.id)===null){if(isValidLegacyKey(editor.id)){legacyEditors[editor.id]=editor}legacyEditors.push(editor);editors.push(editor)}toggleGlobalEvents(true);self.activeEditor=editor;self.fire("AddEditor",{editor:editor});if(!beforeUnloadDelegate){beforeUnloadDelegate=function(){self.fire("BeforeUnload")};DOM.bind(window,"beforeunload",beforeUnloadDelegate)}return editor},createEditor:function(id,settings){return this.add(new Editor(id,settings,this))},remove:function(selector){var self=this,i,editor;if(!selector){for(i=editors.length-1;i>=0;i--){self.remove(editors[i])}return}if(Type.isString(selector)){selector=selector.selector||selector;each(DOM.select(selector),function(elm){editor=self.get(elm.id);if(editor){self.remove(editor)}});return}editor=selector;if(Type.isNull(self.get(editor.id))){return null}if(removeEditorFromList(editor)){self.fire("RemoveEditor",{editor:editor})}if(editors.length===0){DOM.unbind(window,"beforeunload",beforeUnloadDelegate)}editor.remove();toggleGlobalEvents(editors.length>0);return editor},execCommand:function(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case"mceAddEditor":if(!self.get(value)){new Editor(value,self.settings,self).render()}return true;case"mceRemoveEditor":if(editor){editor.remove()}return true;case"mceToggleEditor":if(!editor){self.execCommand("mceAddEditor",0,value);return true}if(editor.isHidden()){editor.show()}else{editor.hide()}return true}if(self.activeEditor){return self.activeEditor.execCommand(cmd,ui,value)}return false},triggerSave:function(){each(editors,function(editor){editor.save()})},addI18n:function(code,items){I18n.add(code,items)},translate:function(text){return I18n.translate(text)},setActive:function(editor){var activeEditor=this.activeEditor;if(this.activeEditor!=editor){if(activeEditor){activeEditor.fire("deactivate",{relatedTarget:editor})}editor.fire("activate",{relatedTarget:activeEditor})}this.activeEditor=editor}};extend(EditorManager,Observable);EditorManager.setup();return EditorManager});define("tinymce.core.api.dom.RangeUtils",["ephox.katamari.api.Fun","tinymce.core.selection.CaretRangeFromPoint","tinymce.core.selection.NormalizeRange","tinymce.core.selection.RangeCompare","tinymce.core.selection.RangeNodes","tinymce.core.selection.RangeWalk","tinymce.core.selection.SplitRange"],function(Fun,CaretRangeFromPoint,NormalizeRange,RangeCompare,RangeNodes,RangeWalk,SplitRange){var RangeUtils=function(dom){var walk=function(rng,callback){return RangeWalk.walk(dom,rng,callback)};var split=SplitRange.split;var normalize=function(rng){return NormalizeRange.normalize(dom,rng).fold(Fun.constant(false),function(normalizedRng){rng.setStart(normalizedRng.startContainer,normalizedRng.startOffset);rng.setEnd(normalizedRng.endContainer,normalizedRng.endOffset);return true})};return{walk:walk,split:split,normalize:normalize}};RangeUtils.compareRanges=RangeCompare.isEq;RangeUtils.getCaretRangeFromPoint=CaretRangeFromPoint.fromPoint;RangeUtils.getSelectedNode=RangeNodes.getSelectedNode;RangeUtils.getNode=RangeNodes.getNode;return RangeUtils});define("tinymce.core.geom.Rect",[],function(){"use strict";var min=Math.min,max=Math.max,round=Math.round;var relativePosition=function(rect,targetRect,rel){var x,y,w,h,targetW,targetH;x=targetRect.x;y=targetRect.y;w=rect.w;h=rect.h;targetW=targetRect.w;targetH=targetRect.h;rel=(rel||"").split("");if(rel[0]==="b"){y+=targetH}if(rel[1]==="r"){x+=targetW}if(rel[0]==="c"){y+=round(targetH/2)}if(rel[1]==="c"){x+=round(targetW/2)}if(rel[3]==="b"){y-=h}if(rel[4]==="r"){x-=w}if(rel[3]==="c"){y-=round(h/2)}if(rel[4]==="c"){x-=round(w/2)}return create(x,y,w,h)};var findBestRelativePosition=function(rect,targetRect,constrainRect,rels){var pos,i;for(i=0;i<rels.length;i++){pos=relativePosition(rect,targetRect,rels[i]);if(pos.x>=constrainRect.x&&pos.x+pos.w<=constrainRect.w+constrainRect.x&&pos.y>=constrainRect.y&&pos.y+pos.h<=constrainRect.h+constrainRect.y){return rels[i]}}return null};var inflate=function(rect,w,h){return create(rect.x-w,rect.y-h,rect.w+w*2,rect.h+h*2)};var intersect=function(rect,cropRect){var x1,y1,x2,y2;x1=max(rect.x,cropRect.x);y1=max(rect.y,cropRect.y);x2=min(rect.x+rect.w,cropRect.x+cropRect.w);y2=min(rect.y+rect.h,cropRect.y+cropRect.h);if(x2-x1<0||y2-y1<0){return null}return create(x1,y1,x2-x1,y2-y1)};var clamp=function(rect,clampRect,fixedSize){var underflowX1,underflowY1,overflowX2,overflowY2,x1,y1,x2,y2,cx2,cy2;x1=rect.x;y1=rect.y;x2=rect.x+rect.w;y2=rect.y+rect.h;cx2=clampRect.x+clampRect.w;cy2=clampRect.y+clampRect.h;underflowX1=max(0,clampRect.x-x1);underflowY1=max(0,clampRect.y-y1);overflowX2=max(0,x2-cx2);overflowY2=max(0,y2-cy2);x1+=underflowX1;y1+=underflowY1;if(fixedSize){x2+=underflowX1;y2+=underflowY1;x1-=overflowX2;y1-=overflowY2}x2-=overflowX2;y2-=overflowY2;return create(x1,y1,x2-x1,y2-y1)};var create=function(x,y,w,h){return{x:x,y:y,w:w,h:h}};var fromClientRect=function(clientRect){return create(clientRect.left,clientRect.top,clientRect.width,clientRect.height)};return{inflate:inflate,relativePosition:relativePosition,findBestRelativePosition:findBestRelativePosition,intersect:intersect,clamp:clamp,create:create,fromClientRect:fromClientRect}});define("tinymce.core.ui.Factory",[],function(){"use strict";var types={};return{add:function(type,typeClass){types[type.toLowerCase()]=typeClass},has:function(type){return!!types[type.toLowerCase()]},get:function(type){var lctype=type.toLowerCase();var controlType=types.hasOwnProperty(lctype)?types[lctype]:null;if(controlType===null){throw new Error("Could not find module for type: "+type)}return controlType},create:function(type,settings){var ControlType;if(typeof type=="string"){settings=settings||{};settings.type=type}else{settings=type;type=settings.type}type=type.toLowerCase();ControlType=types[type];if(!ControlType){throw new Error("Could not find control by type: "+type)}ControlType=new ControlType(settings);ControlType.type=type;return ControlType}}});define("tinymce.core.util.Class",["tinymce.core.util.Tools"],function(Tools){var each=Tools.each,extend=Tools.extend;var extendClass,initializing;var Class=function(){};Class.extend=extendClass=function(prop){var self=this,_super=self.prototype,prototype,name,member;var Class=function(){var i,mixins,mixin,self=this;if(!initializing){if(self.init){self.init.apply(self,arguments)}mixins=self.Mixins;if(mixins){i=mixins.length;while(i--){mixin=mixins[i];if(mixin.init){mixin.init.apply(self,arguments)}}}}};var dummy=function(){return this};var createMethod=function(name,fn){return function(){var self=this,tmp=self._super,ret;self._super=_super[name];ret=fn.apply(self,arguments);self._super=tmp;return ret}};initializing=true;prototype=new self;initializing=false;if(prop.Mixins){each(prop.Mixins,function(mixin){for(var name in mixin){if(name!=="init"){prop[name]=mixin[name]}}});if(_super.Mixins){prop.Mixins=_super.Mixins.concat(prop.Mixins)}}if(prop.Methods){each(prop.Methods.split(","),function(name){prop[name]=dummy})}if(prop.Properties){each(prop.Properties.split(","),function(name){var fieldName="_"+name;prop[name]=function(value){var self=this,undef;if(value!==undef){self[fieldName]=value;return self}return self[fieldName]}})}if(prop.Statics){each(prop.Statics,function(func,name){Class[name]=func})}if(prop.Defaults&&_super.Defaults){prop.Defaults=extend({},_super.Defaults,prop.Defaults)}for(name in prop){member=prop[name];if(typeof member=="function"&&_super[name]){prototype[name]=createMethod(name,member)}else{prototype[name]=member}}Class.prototype=prototype;Class.constructor=Class;Class.extend=extendClass;return Class};return Class});define("tinymce.core.util.Color",[],function(){var min=Math.min,max=Math.max,round=Math.round;var Color=function(value){var self=this,r=0,g=0,b=0;var rgb2hsv=function(r,g,b){var h,s,v,d,minRGB,maxRGB;h=0;s=0;v=0;r=r/255;g=g/255;b=b/255;minRGB=min(r,min(g,b));maxRGB=max(r,max(g,b));if(minRGB==maxRGB){v=minRGB;return{h:0,s:0,v:v*100}}d=r==minRGB?g-b:b==minRGB?r-g:b-r;h=r==minRGB?3:b==minRGB?1:5;h=60*(h-d/(maxRGB-minRGB));s=(maxRGB-minRGB)/maxRGB;v=maxRGB;return{h:round(h),s:round(s*100),v:round(v*100)}};var hsvToRgb=function(hue,saturation,brightness){var side,chroma,x,match;hue=(parseInt(hue,10)||0)%360;saturation=parseInt(saturation,10)/100;brightness=parseInt(brightness,10)/100;saturation=max(0,min(saturation,1));brightness=max(0,min(brightness,1));if(saturation===0){r=g=b=round(255*brightness);return}side=hue/60;chroma=brightness*saturation;x=chroma*(1-Math.abs(side%2-1));match=brightness-chroma;switch(Math.floor(side)){case 0:r=chroma;g=x;b=0;break;case 1:r=x;g=chroma;b=0;break;case 2:r=0;g=chroma;b=x;break;case 3:r=0;g=x;b=chroma;break;case 4:r=x;g=0;b=chroma;break;case 5:r=chroma;g=0;b=x;break;default:r=g=b=0}r=round(255*(r+match));g=round(255*(g+match));b=round(255*(b+match))};var toHex=function(){var hex=function(val){val=parseInt(val,10).toString(16);return val.length>1?val:"0"+val};return"#"+hex(r)+hex(g)+hex(b)};var toRgb=function(){return{r:r,g:g,b:b}};var toHsv=function(){return rgb2hsv(r,g,b)};var parse=function(value){var matches;if(typeof value=="object"){if("r"in value){r=value.r;g=value.g;b=value.b}else if("v"in value){hsvToRgb(value.h,value.s,value.v)}}else{if(matches=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(value)){r=parseInt(matches[1],10);g=parseInt(matches[2],10);b=parseInt(matches[3],10)}else if(matches=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)){r=parseInt(matches[1],16);g=parseInt(matches[2],16);b=parseInt(matches[3],16)}else if(matches=/#([0-F])([0-F])([0-F])/gi.exec(value)){r=parseInt(matches[1]+matches[1],16);g=parseInt(matches[2]+matches[2],16);b=parseInt(matches[3]+matches[3],16)}}r=r<0?0:r>255?255:r;g=g<0?0:g>255?255:g;b=b<0?0:b>255?255:b;return self};if(value){parse(value)}self.toRgb=toRgb;self.toHsv=toHsv;self.toHex=toHex;self.parse=parse};return Color});define("tinymce.core.util.JSON",["global!window"],function(window){var serialize=function(o,quote){var i,v,t,name;quote=quote||'"';if(o===null){return"null"}t=typeof o;if(t=="string"){v="\bb\tt\nn\ff\rr\"\"''\\\\";return quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){if(quote==='"'&&a==="'"){return a}i=v.indexOf(b);if(i+1){return"\\"+v.charAt(i+1)}a=b.charCodeAt().toString(16);return"\\u"+"0000".substring(a.length)+a})+quote}if(t=="object"){if(o.hasOwnProperty&&Object.prototype.toString.call(o)==="[object Array]"){for(i=0,v="[";i<o.length;i++){v+=(i>0?",":"")+serialize(o[i],quote)}return v+"]"}v="{";for(name in o){if(o.hasOwnProperty(name)){v+=typeof o[name]!="function"?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):""}}return v+"}"}return""+o};return{serialize:serialize,parse:function(text){try{return window[String.fromCharCode(101)+"val"]("("+text+")")}catch(ex){}}}});define("tinymce.core.util.JSONP",["tinymce.core.dom.DOMUtils"],function(DOMUtils){return{callbacks:{},count:0,send:function(settings){var self=this,dom=DOMUtils.DOM,count=settings.count!==undefined?settings.count:self.count;var id="tinymce_jsonp_"+count;self.callbacks[count]=function(json){dom.remove(id);delete self.callbacks[count];settings.callback(json)};dom.add(dom.doc.body,"script",{id:id,src:settings.url,type:"text/javascript"});self.count++}}});define("tinymce.core.util.XHR",["ephox.sand.api.XMLHttpRequest","global!setTimeout","tinymce.core.util.Observable","tinymce.core.util.Tools"],function(XMLHttpRequest,setTimeout,Observable,Tools){var XHR={send:function(settings){var xhr,count=0;var ready=function(){if(!settings.async||xhr.readyState==4||count++>1e4){if(settings.success&&count<1e4&&xhr.status==200){settings.success.call(settings.success_scope,""+xhr.responseText,xhr,settings)}else if(settings.error){settings.error.call(settings.error_scope,count>1e4?"TIMED_OUT":"GENERAL",xhr,settings)}xhr=null}else{setTimeout(ready,10)}};settings.scope=settings.scope||this;settings.success_scope=settings.success_scope||settings.scope;settings.error_scope=settings.error_scope||settings.scope;settings.async=settings.async===false?false:true;settings.data=settings.data||"";XHR.fire("beforeInitialize",{settings:settings});xhr=new XMLHttpRequest;if(xhr){if(xhr.overrideMimeType){xhr.overrideMimeType(settings.content_type)}xhr.open(settings.type||(settings.data?"POST":"GET"),settings.url,settings.async);if(settings.crossDomain){xhr.withCredentials=true}if(settings.content_type){xhr.setRequestHeader("Content-Type",settings.content_type)}if(settings.requestheaders){Tools.each(settings.requestheaders,function(header){xhr.setRequestHeader(header.key,header.value)})}xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr=XHR.fire("beforeSend",{xhr:xhr,settings:settings}).xhr;xhr.send(settings.data);if(!settings.async){return ready()}setTimeout(ready,10)}}};Tools.extend(XHR,Observable);return XHR});define("tinymce.core.util.JSONRequest",["tinymce.core.util.JSON","tinymce.core.util.XHR","tinymce.core.util.Tools"],function(JSON,XHR,Tools){var extend=Tools.extend;var JSONRequest=function(settings){this.settings=extend({},settings);this.count=0};JSONRequest.sendRPC=function(o){return(new JSONRequest).send(o)};JSONRequest.prototype={send:function(args){var ecb=args.error,scb=args.success;args=extend(this.settings,args);args.success=function(c,x){c=JSON.parse(c);if(typeof c=="undefined"){c={error:"JSON Parse error."}}if(c.error){ecb.call(args.error_scope||args.scope,c.error,x)}else{scb.call(args.success_scope||args.scope,c.result)}};args.error=function(ty,x){if(ecb){ecb.call(args.error_scope||args.scope,ty,x)}};args.data=JSON.serialize({id:args.id||"c"+this.count++,method:args.method,params:args.params});args.content_type="application/json";XHR.send(args)}};return JSONRequest});define("tinymce.core.util.LocalStorage",["global!document","global!window"],function(document,window){var LocalStorage,storageElm,items,keys,userDataKey,hasOldIEDataSupport;try{if(window.localStorage){return window.localStorage}}catch(ex){}userDataKey="tinymce";storageElm=document.documentElement;hasOldIEDataSupport=!!storageElm.addBehavior;if(hasOldIEDataSupport){storageElm.addBehavior("#default#userData")}var updateKeys=function(){keys=[];for(var key in items){keys.push(key)}LocalStorage.length=keys.length};var load=function(){var key,data,value,pos=0;items={};if(!hasOldIEDataSupport){return}var next=function(end){var value,nextPos;nextPos=end!==undefined?pos+end:data.indexOf(",",pos);if(nextPos===-1||nextPos>data.length){return null}value=data.substring(pos,nextPos);pos=nextPos+1;return value};storageElm.load(userDataKey);data=storageElm.getAttribute(userDataKey)||"";do{var offset=next();if(offset===null){break}key=next(parseInt(offset,32)||0);if(key!==null){offset=next();if(offset===null){break}value=next(parseInt(offset,32)||0);if(key){items[key]=value}}}while(key!==null);updateKeys()};var save=function(){var value,data="";if(!hasOldIEDataSupport){return}for(var key in items){value=items[key];data+=(data?",":"")+key.length.toString(32)+","+key+","+value.length.toString(32)+","+value}storageElm.setAttribute(userDataKey,data);try{storageElm.save(userDataKey)}catch(ex){}updateKeys()};LocalStorage={key:function(index){return keys[index]},getItem:function(key){return key in items?items[key]:null},setItem:function(key,value){items[key]=""+value;save()},removeItem:function(key){delete items[key];save()},clear:function(){items={};save()}};load();return LocalStorage});define("tinymce.core.api.Tinymce",["tinymce.core.AddOnManager","tinymce.core.Editor","tinymce.core.EditorCommands","tinymce.core.EditorManager","tinymce.core.EditorObservable","tinymce.core.Env","tinymce.core.Shortcuts","tinymce.core.UndoManager","tinymce.core.api.FocusManager","tinymce.core.api.Formatter","tinymce.core.api.NotificationManager","tinymce.core.api.WindowManager","tinymce.core.api.dom.BookmarkManager","tinymce.core.api.dom.RangeUtils","tinymce.core.api.dom.Serializer","tinymce.core.dom.ControlSelection","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomQuery","tinymce.core.dom.EventUtils","tinymce.core.dom.ScriptLoader","tinymce.core.dom.Selection","tinymce.core.dom.Sizzle","tinymce.core.dom.TreeWalker","tinymce.core.geom.Rect","tinymce.core.html.DomParser","tinymce.core.html.Entities","tinymce.core.html.Node","tinymce.core.html.SaxParser","tinymce.core.html.Schema","tinymce.core.html.Serializer","tinymce.core.html.Styles","tinymce.core.html.Writer","tinymce.core.ui.Factory","tinymce.core.util.Class","tinymce.core.util.Color","tinymce.core.util.Delay","tinymce.core.util.EventDispatcher","tinymce.core.util.I18n","tinymce.core.util.JSON","tinymce.core.util.JSONP","tinymce.core.util.JSONRequest","tinymce.core.util.LocalStorage","tinymce.core.util.Observable","tinymce.core.util.Promise","tinymce.core.util.Tools","tinymce.core.util.URI","tinymce.core.util.VK","tinymce.core.util.XHR"],function(AddOnManager,Editor,EditorCommands,EditorManager,EditorObservable,Env,Shortcuts,UndoManager,FocusManager,Formatter,NotificationManager,WindowManager,BookmarkManager,RangeUtils,DomSerializer,ControlSelection,DOMUtils,DomQuery,EventUtils,ScriptLoader,Selection,Sizzle,TreeWalker,Rect,DomParser,Entities,Node,SaxParser,Schema,HtmlSerializer,Styles,Writer,Factory,Class,Color,Delay,EventDispatcher,I18n,JSON,JSONP,JSONRequest,LocalStorage,Observable,Promise,Tools,URI,VK,XHR){var tinymce=EditorManager;var publicApi={geom:{Rect:Rect},util:{Promise:Promise,Delay:Delay,Tools:Tools,VK:VK,URI:URI,Class:Class,EventDispatcher:EventDispatcher,Observable:Observable,I18n:I18n,XHR:XHR,JSON:JSON,JSONRequest:JSONRequest,JSONP:JSONP,LocalStorage:LocalStorage,Color:Color},dom:{EventUtils:EventUtils,Sizzle:Sizzle,DomQuery:DomQuery,TreeWalker:TreeWalker,DOMUtils:DOMUtils,ScriptLoader:ScriptLoader,RangeUtils:RangeUtils,Serializer:DomSerializer,ControlSelection:ControlSelection,BookmarkManager:BookmarkManager,Selection:Selection,Event:EventUtils.Event},html:{Styles:Styles,Entities:Entities,Node:Node,Schema:Schema,SaxParser:SaxParser,DomParser:DomParser,Writer:Writer,Serializer:HtmlSerializer},ui:{Factory:Factory},Env:Env,AddOnManager:AddOnManager,Formatter:Formatter,UndoManager:UndoManager,EditorCommands:EditorCommands,WindowManager:WindowManager,NotificationManager:NotificationManager,EditorObservable:EditorObservable,Shortcuts:Shortcuts,Editor:Editor,FocusManager:FocusManager,EditorManager:EditorManager,DOM:DOMUtils.DOM,ScriptLoader:ScriptLoader.ScriptLoader,PluginManager:AddOnManager.PluginManager,ThemeManager:AddOnManager.ThemeManager,trim:Tools.trim,isArray:Tools.isArray,is:Tools.is,toArray:Tools.toArray,makeMap:Tools.makeMap,each:Tools.each,map:Tools.map,grep:Tools.grep,inArray:Tools.inArray,extend:Tools.extend,create:Tools.create,walk:Tools.walk,createNS:Tools.createNS,resolve:Tools.resolve,explode:Tools.explode,_addCacheSuffix:Tools._addCacheSuffix,isOpera:Env.opera,isWebKit:Env.webkit,isIE:Env.ie,isGecko:Env.gecko,isMac:Env.mac};tinymce=Tools.extend(tinymce,publicApi);return tinymce});define("tinymce.core.api.Main",["ephox.katamari.api.Fun","global!window","tinymce.core.api.Tinymce"],function(Fun,window,Tinymce){var context=this||window;var exportToModuleLoaders=function(tinymce){if(typeof context.define==="function"&&!context.define.amd){context.define("ephox/tinymce",[],Fun.constant(tinymce));context.define("tinymce.core.EditorManager",[],Fun.constant(tinymce))}{module.exports=tinymce}};var exportToWindowGlobal=function(tinymce){window.tinymce=tinymce;window.tinyMCE=tinymce};return function(){exportToWindowGlobal(Tinymce);exportToModuleLoaders(Tinymce);return Tinymce}});dem("tinymce.core.api.Main")()})()});(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});define("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.DOMUtils")});define("tinymce.plugins.code.api.Settings",["tinymce.core.dom.DOMUtils"],function(DOMUtils){var getMinWidth=function(editor){return editor.getParam("code_dialog_width",600)};var getMinHeight=function(editor){return editor.getParam("code_dialog_height",Math.min(DOMUtils.DOM.getViewPort().h-200,500))};return{getMinWidth:getMinWidth,getMinHeight:getMinHeight}});define("tinymce.plugins.code.core.Content",[],function(){var setContent=function(editor,html){editor.focus();editor.undoManager.transact(function(){editor.setContent(html)});editor.selection.setCursorLocation();editor.nodeChanged()};var getContent=function(editor){return editor.getContent({source_view:true})};return{setContent:setContent,getContent:getContent}});define("tinymce.plugins.code.ui.Dialog",["tinymce.plugins.code.api.Settings","tinymce.plugins.code.core.Content"],function(Settings,Content){var open=function(editor){var minWidth=Settings.getMinWidth(editor);var minHeight=Settings.getMinHeight(editor);var win=editor.windowManager.open({title:"Source code",body:{type:"textbox",name:"code",multiline:true,minWidth:minWidth,minHeight:minHeight,spellcheck:false,style:"direction: ltr; text-align: left"},onSubmit:function(e){Content.setContent(editor,e.data.code)}});win.find("#code").value(Content.getContent(editor))};return{open:open}});define("tinymce.plugins.code.api.Commands",["tinymce.plugins.code.ui.Dialog"],function(Dialog){var register=function(editor){editor.addCommand("mceCodeEditor",function(){Dialog.open(editor)})};return{register:register}});define("tinymce.plugins.code.ui.Buttons",["tinymce.plugins.code.ui.Dialog"],function(Dialog){var register=function(editor){editor.addButton("code",{icon:"code",tooltip:"Source code",onclick:function(){Dialog.open(editor)}});editor.addMenuItem("code",{icon:"code",text:"Source code",onclick:function(){Dialog.open(editor)}})};return{register:register}});define("tinymce.plugins.code.Plugin",["tinymce.core.PluginManager","tinymce.plugins.code.api.Commands","tinymce.plugins.code.ui.Buttons"],function(PluginManager,Commands,Buttons){PluginManager.add("code",function(editor){Commands.register(editor);Buttons.register(editor);return{}});return function(){}});dem("tinymce.plugins.code.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};define("ephox.katamari.api.Cell",[],function(){var Cell=function(initial){var value=initial;var get=function(){return value};var set=function(v){value=v};var clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}};return Cell});defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});define("tinymce.plugins.fullscreen.api.Api",[],function(){var get=function(fullscreenState){return{isFullscreen:function(){return fullscreenState.get()!==null}}};return{get:get}});defineGlobal("global!document",document);defineGlobal("global!window",window);define("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.DOMUtils")});define("tinymce.plugins.fullscreen.api.Events",[],function(){var fireFullscreenStateChanged=function(editor,state){editor.fire("FullscreenStateChanged",{state:state})};return{fireFullscreenStateChanged:fireFullscreenStateChanged}});define("tinymce.plugins.fullscreen.core.Actions",["global!document","global!window","tinymce.core.dom.DOMUtils","tinymce.plugins.fullscreen.api.Events"],function(document,window,DOMUtils,Events){var DOM=DOMUtils.DOM;var getWindowSize=function(){var w,h,win=window,doc=document;var body=doc.body;if(body.offsetWidth){w=body.offsetWidth;h=body.offsetHeight}if(win.innerWidth&&win.innerHeight){w=win.innerWidth;h=win.innerHeight}return{w:w,h:h}};var getScrollPos=function(){var vp=DOM.getViewPort();return{x:vp.x,y:vp.y}};var setScrollPos=function(pos){window.scrollTo(pos.x,pos.y)};var toggleFullscreen=function(editor,fullscreenState){var body=document.body,documentElement=document.documentElement,editorContainerStyle;var editorContainer,iframe,iframeStyle;var fullscreenInfo=fullscreenState.get();var resize=function(){DOM.setStyle(iframe,"height",getWindowSize().h-(editorContainer.clientHeight-iframe.clientHeight))};var removeResize=function(){DOM.unbind(window,"resize",resize)};editorContainer=editor.getContainer();editorContainerStyle=editorContainer.style;iframe=editor.getContentAreaContainer().firstChild;iframeStyle=iframe.style;if(!fullscreenInfo){var newFullScreenInfo={scrollPos:getScrollPos(),containerWidth:editorContainerStyle.width,containerHeight:editorContainerStyle.height,iframeWidth:iframeStyle.width,iframeHeight:iframeStyle.height,resizeHandler:resize,removeHandler:removeResize};iframeStyle.width=iframeStyle.height="100%";editorContainerStyle.width=editorContainerStyle.height="";DOM.addClass(body,"mce-fullscreen");DOM.addClass(documentElement,"mce-fullscreen");DOM.addClass(editorContainer,"mce-fullscreen");DOM.bind(window,"resize",resize);editor.on("remove",removeResize);resize();fullscreenState.set(newFullScreenInfo);Events.fireFullscreenStateChanged(editor,true)}else{iframeStyle.width=fullscreenInfo.iframeWidth;iframeStyle.height=fullscreenInfo.iframeHeight;if(fullscreenInfo.containerWidth){editorContainerStyle.width=fullscreenInfo.containerWidth}if(fullscreenInfo.containerHeight){editorContainerStyle.height=fullscreenInfo.containerHeight}DOM.removeClass(body,"mce-fullscreen");DOM.removeClass(documentElement,"mce-fullscreen");DOM.removeClass(editorContainer,"mce-fullscreen");setScrollPos(fullscreenInfo.scrollPos);DOM.unbind(window,"resize",fullscreenInfo.resizeHandler);editor.off("remove",fullscreenInfo.removeHandler);fullscreenState.set(null);Events.fireFullscreenStateChanged(editor,false)}};return{toggleFullscreen:toggleFullscreen}});define("tinymce.plugins.fullscreen.api.Commands",["tinymce.plugins.fullscreen.core.Actions"],function(Actions){var register=function(editor,fullscreenState){editor.addCommand("mceFullScreen",function(){Actions.toggleFullscreen(editor,fullscreenState)})};return{register:register}});define("tinymce.plugins.fullscreen.ui.Buttons",[],function(){var postRender=function(editor){return function(e){var ctrl=e.control;editor.on("FullscreenStateChanged",function(e){ctrl.active(e.state)})}};var register=function(editor){editor.addMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Ctrl+Shift+F",selectable:true,cmd:"mceFullScreen",onPostRender:postRender(editor),context:"view"});editor.addButton("fullscreen",{active:false,tooltip:"Fullscreen",cmd:"mceFullScreen",onPostRender:postRender(editor)})};return{register:register}});define("tinymce.plugins.fullscreen.Plugin",["ephox.katamari.api.Cell","tinymce.core.PluginManager","tinymce.plugins.fullscreen.api.Api","tinymce.plugins.fullscreen.api.Commands","tinymce.plugins.fullscreen.ui.Buttons"],function(Cell,PluginManager,Api,Commands,Buttons){PluginManager.add("fullscreen",function(editor){var fullscreenState=Cell(null);Commands.register(editor,fullscreenState);Buttons.register(editor);editor.addShortcut("Ctrl+Shift+F","","mceFullScreen");return Api.get(fullscreenState)});return function(){}});dem("tinymce.plugins.fullscreen.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});define("tinymce.plugins.hr.api.Commands",[],function(){var register=function(editor){editor.addCommand("InsertHorizontalRule",function(){editor.execCommand("mceInsertContent",false,"<hr />")})};return{register:register}});define("tinymce.plugins.hr.ui.Buttons",[],function(){var register=function(editor){editor.addButton("hr",{icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"});editor.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})};return{register:register}});define("tinymce.plugins.hr.Plugin",["tinymce.core.PluginManager","tinymce.plugins.hr.api.Commands","tinymce.plugins.hr.ui.Buttons"],function(PluginManager,Commands,Buttons){PluginManager.add("hr",function(editor){Commands.register(editor);Buttons.register(editor)});return function(){}});dem("tinymce.plugins.hr.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});defineGlobal("global!Math",Math);defineGlobal("global!RegExp",RegExp);define("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Tools")});define("tinymce.plugins.image.api.Settings",[],function(){var hasDimensions=function(editor){return editor.settings.image_dimensions===false?false:true};var hasAdvTab=function(editor){return editor.settings.image_advtab===true?true:false};var getPrependUrl=function(editor){return editor.getParam("image_prepend_url","")};var getClassList=function(editor){return editor.getParam("image_class_list")};var hasDescription=function(editor){return editor.settings.image_description===false?false:true};var hasImageTitle=function(editor){return editor.settings.image_title===true?true:false};var hasImageCaption=function(editor){return editor.settings.image_caption===true?true:false};var getImageList=function(editor){return editor.getParam("image_list",false)};var hasUploadUrl=function(editor){return editor.getParam("images_upload_url",false)};var hasUploadHandler=function(editor){return editor.getParam("images_upload_handler",false)};var getUploadUrl=function(editor){return editor.getParam("images_upload_url")};var getUploadHandler=function(editor){return editor.getParam("images_upload_handler")};var getUploadBasePath=function(editor){return editor.getParam("images_upload_base_path")};var getUploadCredentials=function(editor){return editor.getParam("images_upload_credentials")};return{hasDimensions:hasDimensions,hasAdvTab:hasAdvTab,getPrependUrl:getPrependUrl,getClassList:getClassList,hasDescription:hasDescription,hasImageTitle:hasImageTitle,hasImageCaption:hasImageCaption,getImageList:getImageList,hasUploadUrl:hasUploadUrl,hasUploadHandler:hasUploadHandler,getUploadUrl:getUploadUrl,getUploadHandler:getUploadHandler,getUploadBasePath:getUploadBasePath,getUploadCredentials:getUploadCredentials}});defineGlobal("global!document",document);define("ephox.katamari.api.Global",[],function(){var global=typeof window!=="undefined"?window:Function("return this;")();return global});define("ephox.katamari.api.Resolve",["ephox.katamari.api.Global"],function(Global){var path=function(parts,scope){var o=scope!==undefined?scope:Global;for(var i=0;i<parts.length&&o!==undefined&&o!==null;++i){o=o[parts[i]]}return o};var resolve=function(p,scope){var parts=p.split(".");return path(parts,scope)};var step=function(o,part){if(o[part]===undefined||o[part]===null){o[part]={}}return o[part]};var forge=function(parts,target){var o=target!==undefined?target:Global;for(var i=0;i<parts.length;++i){o=step(o,parts[i])}return o};var namespace=function(name,target){var parts=name.split(".");return forge(parts,target)};return{path:path,resolve:resolve,forge:forge,namespace:namespace}});define("ephox.sand.util.Global",["ephox.katamari.api.Resolve"],function(Resolve){var unsafe=function(name,scope){return Resolve.resolve(name,scope)};var getOrDie=function(name,scope){var actual=unsafe(name,scope);if(actual===undefined){throw name+" not available on this browser"}return actual};return{getOrDie:getOrDie}});define("ephox.sand.api.FileReader",["ephox.sand.util.Global"],function(Global){return function(){var f=Global.getOrDie("FileReader");return new f}});define("tinymce.core.util.Promise",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Promise")});define("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.XHR")});define("tinymce.plugins.image.core.Utils",["global!Math","global!document","ephox.sand.api.FileReader","tinymce.core.util.Promise","tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.image.api.Settings"],function(Math,document,FileReader,Promise,Tools,XHR,Settings){var parseIntAndGetMax=function(val1,val2){return Math.max(parseInt(val1,10),parseInt(val2,10))};var getImageSize=function(url,callback){var img=document.createElement("img");function done(width,height){if(img.parentNode){img.parentNode.removeChild(img)}callback({width:width,height:height})}img.onload=function(){var width=parseIntAndGetMax(img.width,img.clientWidth);var height=parseIntAndGetMax(img.height,img.clientHeight);done(width,height)};img.onerror=function(){done()};var style=img.style;style.visibility="hidden";style.position="fixed";style.bottom=style.left=0;style.width=style.height="auto";document.body.appendChild(img);img.src=url};var buildListItems=function(inputList,itemCallback,startItems){function appendItems(values,output){output=output||[];Tools.each(values,function(item){var menuItem={text:item.text||item.title};if(item.menu){menuItem.menu=appendItems(item.menu)}else{menuItem.value=item.value;itemCallback(menuItem)}output.push(menuItem)});return output}return appendItems(inputList,startItems||[])};var removePixelSuffix=function(value){if(value){value=value.replace(/px$/,"")}return value};var addPixelSuffix=function(value){if(value.length>0&&/^[0-9]+$/.test(value)){value+="px"}return value};var mergeMargins=function(css){if(css.margin){var splitMargin=css.margin.split(" ");switch(splitMargin.length){case 1:css["margin-top"]=css["margin-top"]||splitMargin[0];css["margin-right"]=css["margin-right"]||splitMargin[0];css["margin-bottom"]=css["margin-bottom"]||splitMargin[0];css["margin-left"]=css["margin-left"]||splitMargin[0];break;case 2:css["margin-top"]=css["margin-top"]||splitMargin[0];css["margin-right"]=css["margin-right"]||splitMargin[1];css["margin-bottom"]=css["margin-bottom"]||splitMargin[0];css["margin-left"]=css["margin-left"]||splitMargin[1];break;case 3:css["margin-top"]=css["margin-top"]||splitMargin[0];css["margin-right"]=css["margin-right"]||splitMargin[1];css["margin-bottom"]=css["margin-bottom"]||splitMargin[2];css["margin-left"]=css["margin-left"]||splitMargin[1];break;case 4:css["margin-top"]=css["margin-top"]||splitMargin[0];css["margin-right"]=css["margin-right"]||splitMargin[1];css["margin-bottom"]=css["margin-bottom"]||splitMargin[2];css["margin-left"]=css["margin-left"]||splitMargin[3]}delete css.margin}return css};var createImageList=function(editor,callback){var imageList=Settings.getImageList(editor);if(typeof imageList==="string"){XHR.send({url:imageList,success:function(text){callback(JSON.parse(text))}})}else if(typeof imageList==="function"){imageList(callback)}else{callback(imageList)}};var waitLoadImage=function(editor,data,imgElm){function selectImage(){imgElm.onload=imgElm.onerror=null;if(editor.selection){editor.selection.select(imgElm);editor.nodeChanged()}}imgElm.onload=function(){if(!data.width&&!data.height&&Settings.hasDimensions(editor)){editor.dom.setAttribs(imgElm,{width:imgElm.clientWidth,height:imgElm.clientHeight})}selectImage()};imgElm.onerror=selectImage};var blobToDataUri=function(blob){return new Promise(function(resolve,reject){var reader=new FileReader;reader.onload=function(){resolve(reader.result)};reader.onerror=function(){reject(FileReader.error.message)};reader.readAsDataURL(blob)})};return{getImageSize:getImageSize,buildListItems:buildListItems,removePixelSuffix:removePixelSuffix,addPixelSuffix:addPixelSuffix,mergeMargins:mergeMargins,createImageList:createImageList,waitLoadImage:waitLoadImage,blobToDataUri:blobToDataUri}});define("tinymce.plugins.image.ui.AdvTab",["tinymce.plugins.image.api.Settings","tinymce.plugins.image.core.Utils"],function(Settings,Utils){var updateVSpaceHSpaceBorder=function(editor){return function(evt){var dom=editor.dom;var rootControl=evt.control.rootControl;if(!Settings.hasAdvTab(editor)){return}var data=rootControl.toJSON();var css=dom.parseStyle(data.style);rootControl.find("#vspace").value("");rootControl.find("#hspace").value("");css=Utils.mergeMargins(css);if(css["margin-top"]&&css["margin-bottom"]||css["margin-right"]&&css["margin-left"]){if(css["margin-top"]===css["margin-bottom"]){rootControl.find("#vspace").value(Utils.removePixelSuffix(css["margin-top"]))}else{rootControl.find("#vspace").value("")}if(css["margin-right"]===css["margin-left"]){rootControl.find("#hspace").value(Utils.removePixelSuffix(css["margin-right"]))}else{rootControl.find("#hspace").value("")}}if(css["border-width"]){rootControl.find("#border").value(Utils.removePixelSuffix(css["border-width"]))}rootControl.find("#style").value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))))}};var makeTab=function(editor,updateStyle){return{title:"Advanced",type:"form",pack:"start",items:[{label:"Style",name:"style",type:"textbox",onchange:updateVSpaceHSpaceBorder(editor)},{type:"form",layout:"grid",packV:"start",columns:2,padding:0,alignH:["left","right"],defaults:{type:"textbox",maxWidth:50,onchange:function(evt){updateStyle(editor,evt.control.rootControl)}},items:[{label:"Vertical space",name:"vspace"},{label:"Horizontal space",name:"hspace"},{label:"Border",name:"border"}]}]}};return{makeTab:makeTab}});define("tinymce.plugins.image.ui.SizeManager",[],function(){var doSyncSize=function(widthCtrl,heightCtrl){widthCtrl.state.set("oldVal",widthCtrl.value());heightCtrl.state.set("oldVal",heightCtrl.value())};var doSizeControls=function(win,f){var widthCtrl=win.find("#width")[0];var heightCtrl=win.find("#height")[0];var constrained=win.find("#constrain")[0];if(widthCtrl&&heightCtrl&&constrained){f(widthCtrl,heightCtrl,constrained.checked())}};var doUpdateSize=function(widthCtrl,heightCtrl,isContrained){var oldWidth=widthCtrl.state.get("oldVal");var oldHeight=heightCtrl.state.get("oldVal");var newWidth=widthCtrl.value();var newHeight=heightCtrl.value();if(isContrained&&oldWidth&&oldHeight&&newWidth&&newHeight){if(newWidth!==oldWidth){newHeight=Math.round(newWidth/oldWidth*newHeight);if(!isNaN(newHeight)){heightCtrl.value(newHeight)}}else{newWidth=Math.round(newHeight/oldHeight*newWidth);if(!isNaN(newWidth)){widthCtrl.value(newWidth)}}}doSyncSize(widthCtrl,heightCtrl)};var syncSize=function(win){doSizeControls(win,doSyncSize)};var updateSize=function(win){doSizeControls(win,doUpdateSize)};var createUi=function(){var recalcSize=function(evt){updateSize(evt.control.rootControl)};return{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:5,onchange:recalcSize,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:5,onchange:recalcSize,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:true,text:"Constrain proportions"}]}};return{createUi:createUi,syncSize:syncSize,updateSize:updateSize}});define("tinymce.plugins.image.ui.MainTab",["tinymce.core.util.Tools","tinymce.plugins.image.api.Settings","tinymce.plugins.image.core.Utils","tinymce.plugins.image.ui.SizeManager"],function(Tools,Settings,Utils,SizeManager){var onSrcChange=function(evt,editor){var srcURL,prependURL,absoluteURLPattern,meta=evt.meta||{};var control=evt.control;var rootControl=control.rootControl;var imageListCtrl=rootControl.find("#image-list")[0];if(imageListCtrl){imageListCtrl.value(editor.convertURL(control.value(),"src"))}Tools.each(meta,function(value,key){rootControl.find("#"+key).value(value)});if(!meta.width&&!meta.height){srcURL=editor.convertURL(control.value(),"src");prependURL=Settings.getPrependUrl(editor);absoluteURLPattern=new RegExp("^(?:[a-z]+:)?//","i");if(prependURL&&!absoluteURLPattern.test(srcURL)&&srcURL.substring(0,prependURL.length)!==prependURL){srcURL=prependURL+srcURL}control.value(srcURL);Utils.getImageSize(editor.documentBaseURI.toAbsolute(control.value()),function(data){if(data.width&&data.height&&Settings.hasDimensions(editor)){rootControl.find("#width").value(data.width);rootControl.find("#height").value(data.height);SizeManager.updateSize(rootControl)}})}};var onBeforeCall=function(evt){evt.meta=evt.control.rootControl.toJSON()};var getGeneralItems=function(editor,imageListCtrl){var generalFormItems=[{name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:true,onchange:function(evt){onSrcChange(evt,editor)},onbeforecall:onBeforeCall},imageListCtrl];if(Settings.hasDescription(editor)){generalFormItems.push({name:"alt",type:"textbox",label:"Image description"})}if(Settings.hasImageTitle(editor)){generalFormItems.push({name:"title",type:"textbox",label:"Image Title"})}if(Settings.hasDimensions(editor)){generalFormItems.push(SizeManager.createUi())}if(Settings.getClassList(editor)){generalFormItems.push({name:"class",type:"listbox",label:"Class",values:Utils.buildListItems(Settings.getClassList(editor),function(item){if(item.value){item.textStyle=function(){return editor.formatter.getCssText({inline:"img",classes:[item.value]})}}})})}if(Settings.hasImageCaption(editor)){generalFormItems.push({name:"caption",type:"checkbox",label:"Caption"})}return generalFormItems};var makeTab=function(editor,imageListCtrl){return{title:"General",type:"form",items:getGeneralItems(editor,imageListCtrl)}};return{makeTab:makeTab,getGeneralItems:getGeneralItems}});define("ephox.sand.api.URL",["ephox.sand.util.Global"],function(Global){var url=function(){return Global.getOrDie("URL")};var createObjectURL=function(blob){return url().createObjectURL(blob)};var revokeObjectURL=function(u){url().revokeObjectURL(u)};return{createObjectURL:createObjectURL,revokeObjectURL:revokeObjectURL}});define("tinymce.core.ui.Factory",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.ui.Factory")});define("ephox.sand.api.XMLHttpRequest",["ephox.sand.util.Global"],function(Global){return function(){var f=Global.getOrDie("XMLHttpRequest");return new f}});defineGlobal("global!window",window);define("tinymce.plugins.image.core.Uploader",["ephox.sand.api.XMLHttpRequest","global!document","global!window","tinymce.core.util.Promise","tinymce.core.util.Tools"],function(XMLHttpRequest,document,window,Promise,Tools){var noop=function(){};var pathJoin=function(path1,path2){if(path1){return path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,"")}return path2};return function(settings){var defaultHandler=function(blobInfo,success,failure,progress){var xhr,formData;xhr=new XMLHttpRequest;xhr.open("POST",settings.url);xhr.withCredentials=settings.credentials;xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100)};xhr.onerror=function(){failure("Image upload failed due to a XHR Transport error. Code: "+xhr.status)};xhr.onload=function(){var json;if(xhr.status<200||xhr.status>=300){failure("HTTP Error: "+xhr.status);return}json=JSON.parse(xhr.responseText);if(!json||typeof json.location!=="string"){failure("Invalid JSON: "+xhr.responseText);return}success(pathJoin(settings.basePath,json.location))};formData=new window.FormData;formData.append("file",blobInfo.blob(),blobInfo.filename());xhr.send(formData)};var uploadBlob=function(blobInfo,handler){return new Promise(function(resolve,reject){try{handler(blobInfo,resolve,reject,noop)}catch(ex){reject(ex.message)}})};var isDefaultHandler=function(handler){return handler===defaultHandler};var upload=function(blobInfo){return!settings.url&&isDefaultHandler(settings.handler)?Promise.reject("Upload url missing from the settings."):uploadBlob(blobInfo,settings.handler)};settings=Tools.extend({credentials:false,handler:defaultHandler},settings);return{upload:upload}}});define("tinymce.plugins.image.ui.UploadTab",["ephox.sand.api.URL","tinymce.core.ui.Factory","tinymce.plugins.image.api.Settings","tinymce.plugins.image.core.Utils","tinymce.plugins.image.core.Uploader"],function(URL,Factory,Settings,Utils,Uploader){var onFileInput=function(editor){return function(evt){var Throbber=Factory.get("Throbber");var rootControl=evt.control.rootControl;var throbber=new Throbber(rootControl.getEl());var file=evt.control.value();var blobUri=URL.createObjectURL(file);var uploader=new Uploader({url:Settings.getUploadUrl(editor),basePath:Settings.getUploadBasePath(editor),credentials:Settings.getUploadCredentials(editor),handler:Settings.getUploadHandler(editor)});var finalize=function(){throbber.hide();URL.revokeObjectURL(blobUri)};throbber.show();return Utils.blobToDataUri(file).then(function(dataUrl){var blobInfo=editor.editorUpload.blobCache.create({blob:file,blobUri:blobUri,name:file.name?file.name.replace(/\.[^\.]+$/,""):null,base64:dataUrl.split(",")[1]});return uploader.upload(blobInfo).then(function(url){var src=rootControl.find("#src");src.value(url);rootControl.find("tabpanel")[0].activateTab(0);src.fire("change");finalize();return url})})["catch"](function(err){editor.windowManager.alert(err);finalize()})}};var acceptExts=".jpg,.jpeg,.png,.gif";var makeTab=function(editor){return{title:"Upload",type:"form",layout:"flex",direction:"column",align:"stretch",padding:"20 20 20 20",items:[{type:"container",layout:"flex",direction:"column",align:"center",spacing:10,items:[{text:"Browse for an image",type:"browsebutton",accept:acceptExts,onchange:onFileInput(editor)},{text:"OR",type:"label"}]},{text:"Drop an image here",type:"dropzone",accept:acceptExts,height:100,onchange:onFileInput(editor)}]}};return{makeTab:makeTab}});define("tinymce.plugins.image.ui.Dialog",["global!Math","global!RegExp","tinymce.core.util.Tools","tinymce.plugins.image.api.Settings","tinymce.plugins.image.core.Utils","tinymce.plugins.image.ui.AdvTab","tinymce.plugins.image.ui.MainTab","tinymce.plugins.image.ui.SizeManager","tinymce.plugins.image.ui.UploadTab"],function(Math,RegExp,Tools,Settings,Utils,AdvTab,MainTab,SizeManager,UploadTab){return function(editor){var updateStyle=function(editor,rootControl){if(!Settings.hasAdvTab(editor)){return}var dom=editor.dom;var data=rootControl.toJSON();var css=dom.parseStyle(data.style);css=Utils.mergeMargins(css);if(data.vspace){css["margin-top"]=css["margin-bottom"]=Utils.addPixelSuffix(data.vspace)}if(data.hspace){css["margin-left"]=css["margin-right"]=Utils.addPixelSuffix(data.hspace)}if(data.border){css["border-width"]=Utils.addPixelSuffix(data.border)}rootControl.find("#style").value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))))};function showDialog(imageList){var win,data={},imgElm,figureElm,dom=editor.dom;var imageListCtrl;function onSubmitForm(){var figureElm,oldImg;SizeManager.updateSize(win);updateStyle(editor,win);data=Tools.extend(data,win.toJSON());if(!data.alt){data.alt=""}if(!data.title){data.title=""}if(data.width===""){data.width=null}if(data.height===""){data.height=null}if(!data.style){data.style=null}data={src:data.src,alt:data.alt,title:data.title,width:data.width,height:data.height,style:data.style,caption:data.caption,class:data["class"]};editor.undoManager.transact(function(){if(!data.src){if(imgElm){var elm=dom.is(imgElm.parentNode,"figure.image")?imgElm.parentNode:imgElm;dom.remove(elm);editor.focus();editor.nodeChanged();if(dom.isEmpty(editor.getBody())){editor.setContent("");editor.selection.setCursorLocation()}}return}if(data.title===""){data.title=null}if(!imgElm){data.id="__mcenew";editor.focus();editor.selection.setContent(dom.createHTML("img",data));imgElm=dom.get("__mcenew");dom.setAttrib(imgElm,"id",null)}else{dom.setAttribs(imgElm,data)}editor.editorUpload.uploadImagesAuto();if(data.caption===false){if(dom.is(imgElm.parentNode,"figure.image")){figureElm=imgElm.parentNode;dom.insertAfter(imgElm,figureElm);dom.remove(figureElm)}}if(data.caption===true){if(!dom.is(imgElm.parentNode,"figure.image")){oldImg=imgElm;imgElm=imgElm.cloneNode(true);figureElm=dom.create("figure",{class:"image"});figureElm.appendChild(imgElm);figureElm.appendChild(dom.create("figcaption",{contentEditable:true},"Caption"));figureElm.contentEditable=false;var textBlock=dom.getParent(oldImg,function(node){return editor.schema.getTextBlockElements()[node.nodeName]});if(textBlock){dom.split(textBlock,oldImg,figureElm)}else{dom.replace(figureElm,oldImg)}editor.selection.select(figureElm)}return}Utils.waitLoadImage(editor,data,imgElm)})}imgElm=editor.selection.getNode();figureElm=dom.getParent(imgElm,"figure.image");if(figureElm){imgElm=dom.select("img",figureElm)[0]}if(imgElm&&(imgElm.nodeName!=="IMG"||imgElm.getAttribute("data-mce-object")||imgElm.getAttribute("data-mce-placeholder"))){imgElm=null}if(imgElm){data={src:dom.getAttrib(imgElm,"src"),alt:dom.getAttrib(imgElm,"alt"),title:dom.getAttrib(imgElm,"title"),class:dom.getAttrib(imgElm,"class"),width:dom.getAttrib(imgElm,"width"),height:dom.getAttrib(imgElm,"height"),caption:!!figureElm}}if(imageList){imageListCtrl={type:"listbox",label:"Image list",name:"image-list",values:Utils.buildListItems(imageList,function(item){item.value=editor.convertURL(item.value||item.url,"src")},[{text:"None",value:""}]),value:data.src&&editor.convertURL(data.src,"src"),onselect:function(e){var altCtrl=win.find("#alt");if(!altCtrl.value()||e.lastControl&&altCtrl.value()===e.lastControl.text()){altCtrl.value(e.control.text())}win.find("#src").value(e.control.value()).fire("change")},onPostRender:function(){imageListCtrl=this}}}if(Settings.hasAdvTab(editor)||Settings.hasUploadUrl(editor)||Settings.hasUploadHandler(editor)){var body=[MainTab.makeTab(editor,imageListCtrl)];if(Settings.hasAdvTab(editor)){if(imgElm){if(imgElm.style.marginLeft&&imgElm.style.marginRight&&imgElm.style.marginLeft===imgElm.style.marginRight){data.hspace=Utils.removePixelSuffix(imgElm.style.marginLeft)}if(imgElm.style.marginTop&&imgElm.style.marginBottom&&imgElm.style.marginTop===imgElm.style.marginBottom){data.vspace=Utils.removePixelSuffix(imgElm.style.marginTop)}if(imgElm.style.borderWidth){data.border=Utils.removePixelSuffix(imgElm.style.borderWidth)}data.style=editor.dom.serializeStyle(editor.dom.parseStyle(editor.dom.getAttrib(imgElm,"style")))}body.push(AdvTab.makeTab(editor,updateStyle))}if(Settings.hasUploadUrl(editor)||Settings.hasUploadHandler(editor)){body.push(UploadTab.makeTab(editor))}win=editor.windowManager.open({title:"Insert/edit image",data:data,bodyType:"tabpanel",body:body,onSubmit:onSubmitForm})}else{win=editor.windowManager.open({title:"Insert/edit image",data:data,body:MainTab.getGeneralItems(editor,imageListCtrl),onSubmit:onSubmitForm})}SizeManager.syncSize(win)}function open(){Utils.createImageList(editor,showDialog)}return{open:open}}});define("tinymce.plugins.image.api.Commands",["tinymce.plugins.image.ui.Dialog"],function(Dialog){var register=function(editor){editor.addCommand("mceImage",Dialog(editor).open)};return{register:register}});define("tinymce.plugins.image.core.FilterContent",["tinymce.core.util.Tools"],function(Tools){var hasImageClass=function(node){var className=node.attr("class");return className&&/\bimage\b/.test(className)};var toggleContentEditableState=function(state){return function(nodes){var i=nodes.length,node;var toggleContentEditable=function(node){node.attr("contenteditable",state?"true":null)};while(i--){node=nodes[i];if(hasImageClass(node)){node.attr("contenteditable",state?"false":null);Tools.each(node.getAll("figcaption"),toggleContentEditable)}}}};var setup=function(editor){editor.on("preInit",function(){editor.parser.addNodeFilter("figure",toggleContentEditableState(true));editor.serializer.addNodeFilter("figure",toggleContentEditableState(false))})};return{setup:setup}});define("tinymce.plugins.image.ui.Buttons",["tinymce.plugins.image.ui.Dialog"],function(Dialog){var register=function(editor){editor.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:Dialog(editor).open,stateSelector:"img:not([data-mce-object],[data-mce-placeholder]),figure.image"});editor.addMenuItem("image",{icon:"image",text:"Image",onclick:Dialog(editor).open,context:"insert",prependToContext:true})};return{register:register}});define("tinymce.plugins.image.Plugin",["tinymce.core.PluginManager","tinymce.plugins.image.api.Commands","tinymce.plugins.image.core.FilterContent","tinymce.plugins.image.ui.Buttons"],function(PluginManager,Commands,FilterContent,Buttons){PluginManager.add("image",function(editor){FilterContent.setup(editor);Buttons.register(editor);Commands.register(editor)});return function(){}});dem("tinymce.plugins.image.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});define("tinymce.core.util.VK",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.VK")});define("tinymce.plugins.link.api.Settings",[],function(){var assumeExternalTargets=function(editorSettings){return typeof editorSettings.link_assume_external_targets==="boolean"?editorSettings.link_assume_external_targets:false};var hasContextToolbar=function(editorSettings){return typeof editorSettings.link_context_toolbar==="boolean"?editorSettings.link_context_toolbar:false};var getLinkList=function(editorSettings){return editorSettings.link_list};var hasDefaultLinkTarget=function(editorSettings){return typeof editorSettings.default_link_target==="string"};var getDefaultLinkTarget=function(editorSettings){return editorSettings.default_link_target};var getTargetList=function(editorSettings){return editorSettings.target_list};var setTargetList=function(editor,list){editor.settings.target_list=list};var shouldShowTargetList=function(editorSettings){return getTargetList(editorSettings)!==false};var getRelList=function(editorSettings){return editorSettings.rel_list};var hasRelList=function(editorSettings){return getRelList(editorSettings)!==undefined};var getLinkClassList=function(editorSettings){return editorSettings.link_class_list};var hasLinkClassList=function(editorSettings){return getLinkClassList(editorSettings)!==undefined};var shouldShowLinkTitle=function(editorSettings){return editorSettings.link_title!==false};var allowUnsafeLinkTarget=function(editorSettings){return typeof editorSettings.allow_unsafe_link_target==="boolean"?editorSettings.allow_unsafe_link_target:false};return{assumeExternalTargets:assumeExternalTargets,hasContextToolbar:hasContextToolbar,getLinkList:getLinkList,hasDefaultLinkTarget:hasDefaultLinkTarget,getDefaultLinkTarget:getDefaultLinkTarget,getTargetList:getTargetList,setTargetList:setTargetList,shouldShowTargetList:shouldShowTargetList,getRelList:getRelList,hasRelList:hasRelList,getLinkClassList:getLinkClassList,hasLinkClassList:hasLinkClassList,shouldShowLinkTitle:shouldShowLinkTitle,allowUnsafeLinkTarget:allowUnsafeLinkTarget}});defineGlobal("global!document",document);defineGlobal("global!window",window);define("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.DOMUtils")});define("tinymce.core.Env",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.Env")});define("tinymce.plugins.link.core.OpenUrl",["global!document","global!window","tinymce.core.dom.DOMUtils","tinymce.core.Env"],function(document,window,DOMUtils,Env){var appendClickRemove=function(link,evt){document.body.appendChild(link);link.dispatchEvent(evt);document.body.removeChild(link)};var open=function(url){if(!Env.ie||Env.ie>10){var link=document.createElement("a");link.target="_blank";link.href=url;link.rel="noreferrer noopener";var evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);appendClickRemove(link,evt)}else{var win=window.open("","_blank");if(win){win.opener=null;var doc=win.document;doc.open();doc.write('<meta http-equiv="refresh" content="0; url='+DOMUtils.DOM.encode(url)+'">');doc.close()}}};return{open:open}});defineGlobal("global!RegExp",RegExp);define("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Tools")});define("tinymce.plugins.link.core.Utils",["global!RegExp","tinymce.core.util.Tools","tinymce.plugins.link.api.Settings"],function(RegExp,Tools,Settings){var toggleTargetRules=function(rel,isUnsafe){var rules=["noopener"];var newRel=rel?rel.split(/\s+/):[];var toString=function(rel){return Tools.trim(rel.sort().join(" "))};var addTargetRules=function(rel){rel=removeTargetRules(rel);return rel.length?rel.concat(rules):rules};var removeTargetRules=function(rel){return rel.filter(function(val){return Tools.inArray(rules,val)===-1})};newRel=isUnsafe?addTargetRules(newRel):removeTargetRules(newRel);return newRel.length?toString(newRel):null};var trimCaretContainers=function(text){return text.replace(/\uFEFF/g,"")};var getAnchorElement=function(editor,selectedElm){selectedElm=selectedElm||editor.selection.getNode();if(isImageFigure(selectedElm)){return editor.dom.select("a[href]",selectedElm)[0]}else{return editor.dom.getParent(selectedElm,"a[href]")}};var getAnchorText=function(selection,anchorElm){var text=anchorElm?anchorElm.innerText||anchorElm.textContent:selection.getContent({format:"text"});return trimCaretContainers(text)};var isLink=function(elm){return elm&&elm.nodeName==="A"&&elm.href};var hasLinks=function(elements){return Tools.grep(elements,isLink).length>0};var isOnlyTextSelected=function(html){if(/</.test(html)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(html)||html.indexOf("href=")===-1)){return false}return true};var isImageFigure=function(node){return node&&node.nodeName==="FIGURE"&&/\bimage\b/i.test(node.className)};var link=function(editor,attachState){return function(data){editor.undoManager.transact(function(){var selectedElm=editor.selection.getNode();var anchorElm=getAnchorElement(editor,selectedElm);var linkAttrs={href:data.href,target:data.target?data.target:null,rel:data.rel?data.rel:null,class:data["class"]?data["class"]:null,title:data.title?data.title:null};if(!Settings.hasRelList(editor.settings)&&Settings.allowUnsafeLinkTarget(editor.settings)===false){linkAttrs.rel=toggleTargetRules(linkAttrs.rel,linkAttrs.target==="_blank")}if(data.href===attachState.href){attachState.attach();attachState={}}if(anchorElm){editor.focus();if(data.hasOwnProperty("text")){if("innerText"in anchorElm){anchorElm.innerText=data.text}else{anchorElm.textContent=data.text}}editor.dom.setAttribs(anchorElm,linkAttrs);editor.selection.select(anchorElm);editor.undoManager.add()}else{if(isImageFigure(selectedElm)){linkImageFigure(editor,selectedElm,linkAttrs)}else if(data.hasOwnProperty("text")){editor.insertContent(editor.dom.createHTML("a",linkAttrs,editor.dom.encode(data.text)))}else{editor.execCommand("mceInsertLink",false,linkAttrs)}}})}};var unlink=function(editor){return function(){editor.undoManager.transact(function(){var node=editor.selection.getNode();if(isImageFigure(node)){unlinkImageFigure(editor,node)}else{editor.execCommand("unlink")}})}};var unlinkImageFigure=function(editor,fig){var a,img;img=editor.dom.select("img",fig)[0];if(img){a=editor.dom.getParents(img,"a[href]",fig)[0];if(a){a.parentNode.insertBefore(img,a);editor.dom.remove(a)}}};var linkImageFigure=function(editor,fig,attrs){var a,img;img=editor.dom.select("img",fig)[0];if(img){a=editor.dom.create("a",attrs);img.parentNode.insertBefore(a,img);a.appendChild(img)}};return{link:link,unlink:unlink,isLink:isLink,hasLinks:hasLinks,isOnlyTextSelected:isOnlyTextSelected,getAnchorElement:getAnchorElement,getAnchorText:getAnchorText,toggleTargetRules:toggleTargetRules}});define("tinymce.core.util.Delay",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Delay")});define("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.XHR")});define("tinymce.plugins.link.ui.Dialog",["tinymce.core.util.Delay","tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.link.api.Settings","tinymce.plugins.link.core.Utils"],function(Delay,Tools,XHR,Settings,Utils){var attachState={};var createLinkList=function(editor,callback){var linkList=Settings.getLinkList(editor.settings);if(typeof linkList==="string"){XHR.send({url:linkList,success:function(text){callback(editor,JSON.parse(text))}})}else if(typeof linkList==="function"){linkList(function(list){callback(editor,list)})}else{callback(editor,linkList)}};var buildListItems=function(inputList,itemCallback,startItems){var appendItems=function(values,output){output=output||[];Tools.each(values,function(item){var menuItem={text:item.text||item.title};if(item.menu){menuItem.menu=appendItems(item.menu)}else{menuItem.value=item.value;if(itemCallback){itemCallback(menuItem)}}output.push(menuItem)});return output};return appendItems(inputList,startItems||[])};var delayedConfirm=function(editor,message,callback){var rng=editor.selection.getRng();Delay.setEditorTimeout(editor,function(){editor.windowManager.confirm(message,function(state){editor.selection.setRng(rng);callback(state)})})};var showDialog=function(editor,linkList){var data={},selection=editor.selection,dom=editor.dom,anchorElm,initialText;var win,onlyText,textListCtrl,linkListCtrl,relListCtrl,targetListCtrl,classListCtrl,linkTitleCtrl,value;var linkListChangeHandler=function(e){var textCtrl=win.find("#text");if(!textCtrl.value()||e.lastControl&&textCtrl.value()===e.lastControl.text()){textCtrl.value(e.control.text())}win.find("#href").value(e.control.value())};var buildAnchorListControl=function(url){var anchorList=[];Tools.each(editor.dom.select("a:not([href])"),function(anchor){var id=anchor.name||anchor.id;if(id){anchorList.push({text:id,value:"#"+id,selected:url.indexOf("#"+id)!==-1})}});if(anchorList.length){anchorList.unshift({text:"None",value:""});return{name:"anchor",type:"listbox",label:"Anchors",values:anchorList,onselect:linkListChangeHandler}}};var updateText=function(){if(!initialText&&onlyText&&!data.text){this.parent().parent().find("#text")[0].value(this.value())}};var urlChange=function(e){var meta=e.meta||{};if(linkListCtrl){linkListCtrl.value(editor.convertURL(this.value(),"href"))}Tools.each(e.meta,function(value,key){var inp=win.find("#"+key);if(key==="text"){if(initialText.length===0){inp.value(value);data.text=value}}else{inp.value(value)}});if(meta.attach){attachState={href:this.value(),attach:meta.attach}}if(!meta.text){updateText.call(this)}};var onBeforeCall=function(e){e.meta=win.toJSON()};onlyText=Utils.isOnlyTextSelected(selection.getContent());anchorElm=Utils.getAnchorElement(editor);data.text=initialText=Utils.getAnchorText(editor.selection,anchorElm);data.href=anchorElm?dom.getAttrib(anchorElm,"href"):"";if(anchorElm){data.target=dom.getAttrib(anchorElm,"target")}else if(Settings.hasDefaultLinkTarget(editor.settings)){data.target=Settings.getDefaultLinkTarget(editor.settings)}if(value=dom.getAttrib(anchorElm,"rel")){data.rel=value}if(value=dom.getAttrib(anchorElm,"class")){data["class"]=value}if(value=dom.getAttrib(anchorElm,"title")){data.title=value}if(onlyText){textListCtrl={name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){data.text=this.value()}}}if(linkList){linkListCtrl={type:"listbox",label:"Link list",values:buildListItems(linkList,function(item){item.value=editor.convertURL(item.value||item.url,"href")},[{text:"None",value:""}]),onselect:linkListChangeHandler,value:editor.convertURL(data.href,"href"),onPostRender:function(){linkListCtrl=this}}}if(Settings.shouldShowTargetList(editor.settings)){if(Settings.getTargetList(editor.settings)===undefined){Settings.setTargetList(editor,[{text:"None",value:""},{text:"New window",value:"_blank"}])}targetListCtrl={name:"target",type:"listbox",label:"Target",values:buildListItems(Settings.getTargetList(editor.settings))}}if(Settings.hasRelList(editor.settings)){relListCtrl={name:"rel",type:"listbox",label:"Rel",values:buildListItems(Settings.getRelList(editor.settings),function(item){if(Settings.allowUnsafeLinkTarget(editor.settings)===false){item.value=Utils.toggleTargetRules(item.value,data.target==="_blank")}})}}if(Settings.hasLinkClassList(editor.settings)){classListCtrl={name:"class",type:"listbox",label:"Class",values:buildListItems(Settings.getLinkClassList(editor.settings),function(item){if(item.value){item.textStyle=function(){return editor.formatter.getCssText({inline:"a",classes:[item.value]})}}})}}if(Settings.shouldShowLinkTitle(editor.settings)){linkTitleCtrl={name:"title",type:"textbox",label:"Title",value:data.title}}win=editor.windowManager.open({title:"Insert link",data:data,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:true,label:"Url",onchange:urlChange,onkeyup:updateText,onbeforecall:onBeforeCall},textListCtrl,linkTitleCtrl,buildAnchorListControl(data.href),linkListCtrl,relListCtrl,targetListCtrl,classListCtrl],onSubmit:function(e){var assumeExternalTargets=Settings.assumeExternalTargets(editor.settings);var insertLink=Utils.link(editor,attachState);var removeLink=Utils.unlink(editor);var resultData=Tools.extend({},data,e.data);var href=resultData.href;if(!href){removeLink();return}if(!onlyText||resultData.text===initialText){delete resultData.text}if(href.indexOf("@")>0&&href.indexOf("//")===-1&&href.indexOf("mailto:")===-1){delayedConfirm(editor,"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(state){if(state){resultData.href="mailto:"+href}insertLink(resultData)});return}if(assumeExternalTargets===true&&!/^\w+:/i.test(href)||assumeExternalTargets===false&&/^\s*www[\.|\d\.]/i.test(href)){delayedConfirm(editor,"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(state){if(state){resultData.href="http://"+href}insertLink(resultData)});return}insertLink(resultData)}})};var open=function(editor){createLinkList(editor,showDialog)};return{open:open}});define("tinymce.plugins.link.core.Actions",["tinymce.core.util.VK","tinymce.plugins.link.api.Settings","tinymce.plugins.link.core.OpenUrl","tinymce.plugins.link.core.Utils","tinymce.plugins.link.ui.Dialog"],function(VK,Settings,OpenUrl,Utils,Dialog){var getLink=function(editor,elm){return editor.dom.getParent(elm,"a[href]")};var getSelectedLink=function(editor){return getLink(editor,editor.selection.getStart())};var getHref=function(elm){var href=elm.getAttribute("data-mce-href");return href?href:elm.getAttribute("href")};var isContextMenuVisible=function(editor){var contextmenu=editor.plugins.contextmenu;return contextmenu?contextmenu.isContextMenuVisible():false};var hasOnlyAltModifier=function(e){return e.altKey===true&&e.shiftKey===false&&e.ctrlKey===false&&e.metaKey===false};var gotoLink=function(editor,a){if(a){var href=getHref(a);if(/^#/.test(href)){var targetEl=editor.$(href);if(targetEl.length){editor.selection.scrollIntoView(targetEl[0],true)}}else{OpenUrl.open(a.href)}}};var openDialog=function(editor){return function(){Dialog.open(editor)}};var gotoSelectedLink=function(editor){return function(){gotoLink(editor,getSelectedLink(editor))}};var leftClickedOnAHref=function(editor){return function(elm){var sel,rng,node;if(Settings.hasContextToolbar(editor.settings)&&!isContextMenuVisible(editor)&&Utils.isLink(elm)){sel=editor.selection;rng=sel.getRng();node=rng.startContainer;if(node.nodeType===3&&sel.isCollapsed()&&rng.startOffset>0&&rng.startOffset<node.data.length){return true}}return false}};var setupGotoLinks=function(editor){editor.on("click",function(e){var link=getLink(editor,e.target);if(link&&VK.metaKeyPressed(e)){e.preventDefault();gotoLink(editor,link)}});editor.on("keydown",function(e){var link=getSelectedLink(editor);if(link&&e.keyCode===13&&hasOnlyAltModifier(e)){e.preventDefault();gotoLink(editor,link)}})};var toggleActiveState=function(editor){return function(){var self=this;editor.on("nodechange",function(e){self.active(!editor.readonly&&!!Utils.getAnchorElement(editor,e.element))})}};var toggleViewLinkState=function(editor){return function(){var self=this;var toggleVisibility=function(e){if(Utils.hasLinks(e.parents)){self.show()}else{self.hide()}};if(!Utils.hasLinks(editor.dom.getParents(editor.selection.getStart()))){self.hide()}editor.on("nodechange",toggleVisibility);self.on("remove",function(){editor.off("nodechange",toggleVisibility)})}};return{openDialog:openDialog,gotoSelectedLink:gotoSelectedLink,leftClickedOnAHref:leftClickedOnAHref,setupGotoLinks:setupGotoLinks,toggleActiveState:toggleActiveState,toggleViewLinkState:toggleViewLinkState}});define("tinymce.plugins.link.api.Commands",["tinymce.plugins.link.core.Actions"],function(Actions){var register=function(editor){editor.addCommand("mceLink",Actions.openDialog(editor))};return{register:register}});define("tinymce.plugins.link.core.Keyboard",["tinymce.plugins.link.core.Actions"],function(Actions){var setup=function(editor){editor.addShortcut("Meta+K","",Actions.openDialog(editor))};return{setup:setup}});define("tinymce.plugins.link.ui.Controls",["tinymce.plugins.link.core.Actions","tinymce.plugins.link.core.Utils"],function(Actions,Utils){var setupButtons=function(editor){editor.addButton("link",{active:false,icon:"link",tooltip:"Insert/edit link",onclick:Actions.openDialog(editor),onpostrender:Actions.toggleActiveState(editor)});editor.addButton("unlink",{active:false,icon:"unlink",tooltip:"Remove link",onclick:Utils.unlink(editor),onpostrender:Actions.toggleActiveState(editor)});if(editor.addContextToolbar){editor.addButton("openlink",{icon:"newtab",tooltip:"Open link",onclick:Actions.gotoSelectedLink(editor)})}};var setupMenuItems=function(editor){editor.addMenuItem("openlink",{text:"Open link",icon:"newtab",onclick:Actions.gotoSelectedLink(editor),onPostRender:Actions.toggleViewLinkState(editor),prependToContext:true});editor.addMenuItem("link",{icon:"link",text:"Link",shortcut:"Meta+K",onclick:Actions.openDialog(editor),stateSelector:"a[href]",context:"insert",prependToContext:true})};var setupContextToolbars=function(editor){if(editor.addContextToolbar){editor.addContextToolbar(Actions.leftClickedOnAHref(editor),"openlink | link unlink")}};return{setupButtons:setupButtons,setupMenuItems:setupMenuItems,setupContextToolbars:setupContextToolbars}});define("tinymce.plugins.link.Plugin",["tinymce.core.PluginManager","tinymce.plugins.link.api.Commands","tinymce.plugins.link.core.Actions","tinymce.plugins.link.core.Keyboard","tinymce.plugins.link.ui.Controls"],function(PluginManager,Commands,Actions,Keyboard,Controls){PluginManager.add("link",function(editor){Controls.setupButtons(editor);Controls.setupMenuItems(editor);Controls.setupContextToolbars(editor);Actions.setupGotoLinks(editor);Commands.register(editor);Keyboard.setup(editor)});return function(){}});dem("tinymce.plugins.link.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});define("tinymce.core.api.dom.RangeUtils",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.RangeUtils")});define("tinymce.core.dom.TreeWalker",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.TreeWalker")});define("tinymce.core.util.VK",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.VK")});define("tinymce.core.api.dom.BookmarkManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.BookmarkManager")});define("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Tools")});define("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.DOMUtils")});define("tinymce.plugins.lists.core.NodeType",[],function(){var isTextNode=function(node){return node&&node.nodeType===3};var isListNode=function(node){return node&&/^(OL|UL|DL)$/.test(node.nodeName)};var isListItemNode=function(node){return node&&/^(LI|DT|DD)$/.test(node.nodeName)};var isTableCellNode=function(node){return node&&/^(TH|TD)$/.test(node.nodeName)};var isBr=function(node){return node&&node.nodeName==="BR"};var isFirstChild=function(node){return node.parentNode.firstChild===node};var isLastChild=function(node){return node.parentNode.lastChild===node};var isTextBlock=function(editor,node){return node&&!!editor.schema.getTextBlockElements()[node.nodeName]};var isBlock=function(node,blockElements){return node&&node.nodeName in blockElements};var isBogusBr=function(dom,node){if(!isBr(node)){return false}if(dom.isBlock(node.nextSibling)&&!isBr(node.previousSibling)){return true}return false};var isEmpty=function(dom,elm,keepBookmarks){var empty=dom.isEmpty(elm);if(keepBookmarks&&dom.select("span[data-mce-type=bookmark]",elm).length>0){return false}return empty};var isChildOfBody=function(dom,elm){return dom.isChildOf(elm,dom.getRoot())};return{isTextNode:isTextNode,isListNode:isListNode,isListItemNode:isListItemNode,isTableCellNode:isTableCellNode,isBr:isBr,isFirstChild:isFirstChild,isLastChild:isLastChild,isTextBlock:isTextBlock,isBlock:isBlock,isBogusBr:isBogusBr,isEmpty:isEmpty,isChildOfBody:isChildOfBody}});define("tinymce.plugins.lists.core.Range",["tinymce.core.api.dom.RangeUtils","tinymce.plugins.lists.core.NodeType"],function(RangeUtils,NodeType){var getNormalizedEndPoint=function(container,offset){var node=RangeUtils.getNode(container,offset);if(NodeType.isListItemNode(container)&&NodeType.isTextNode(node)){var textNodeOffset=offset>=container.childNodes.length?node.data.length:0;return{container:node,offset:textNodeOffset}}return{container:container,offset:offset}};var normalizeRange=function(rng){var outRng=rng.cloneRange();var rangeStart=getNormalizedEndPoint(rng.startContainer,rng.startOffset);outRng.setStart(rangeStart.container,rangeStart.offset);var rangeEnd=getNormalizedEndPoint(rng.endContainer,rng.endOffset);outRng.setEnd(rangeEnd.container,rangeEnd.offset);return outRng};return{getNormalizedEndPoint:getNormalizedEndPoint,normalizeRange:normalizeRange}});define("tinymce.plugins.lists.core.Bookmark",["tinymce.core.dom.DOMUtils","tinymce.plugins.lists.core.NodeType","tinymce.plugins.lists.core.Range"],function(DOMUtils,NodeType,Range){var DOM=DOMUtils.DOM;var createBookmark=function(rng){var bookmark={};var setupEndPoint=function(start){var offsetNode,container,offset;container=rng[start?"startContainer":"endContainer"];offset=rng[start?"startOffset":"endOffset"];if(container.nodeType===1){offsetNode=DOM.create("span",{"data-mce-type":"bookmark"});if(container.hasChildNodes()){offset=Math.min(offset,container.childNodes.length-1);if(start){container.insertBefore(offsetNode,container.childNodes[offset])}else{DOM.insertAfter(offsetNode,container.childNodes[offset])}}else{container.appendChild(offsetNode)}container=offsetNode;offset=0}bookmark[start?"startContainer":"endContainer"]=container;bookmark[start?"startOffset":"endOffset"]=offset};setupEndPoint(true);if(!rng.collapsed){setupEndPoint()}return bookmark};var resolveBookmark=function(bookmark){function restoreEndPoint(start){var container,offset,node;var nodeIndex=function(container){var node=container.parentNode.firstChild,idx=0;while(node){if(node===container){return idx}if(node.nodeType!==1||node.getAttribute("data-mce-type")!=="bookmark"){idx++}node=node.nextSibling}return-1};container=node=bookmark[start?"startContainer":"endContainer"];offset=bookmark[start?"startOffset":"endOffset"];if(!container){return}if(container.nodeType===1){offset=nodeIndex(container);container=container.parentNode;DOM.remove(node);if(!container.hasChildNodes()&&DOM.isBlock(container)){container.appendChild(DOM.create("br"))}}bookmark[start?"startContainer":"endContainer"]=container;bookmark[start?"startOffset":"endOffset"]=offset}restoreEndPoint(true);restoreEndPoint();var rng=DOM.createRng();rng.setStart(bookmark.startContainer,bookmark.startOffset);if(bookmark.endContainer){rng.setEnd(bookmark.endContainer,bookmark.endOffset)}return Range.normalizeRange(rng)};return{createBookmark:createBookmark,resolveBookmark:resolveBookmark}});define("tinymce.plugins.lists.core.NormalizeLists",["tinymce.core.dom.DOMUtils","tinymce.core.util.Tools","tinymce.plugins.lists.core.NodeType"],function(DOMUtils,Tools,NodeType){var DOM=DOMUtils.DOM;var normalizeList=function(dom,ul){var sibling,parentNode=ul.parentNode;if(parentNode.nodeName==="LI"&&parentNode.firstChild===ul){sibling=parentNode.previousSibling;if(sibling&&sibling.nodeName==="LI"){sibling.appendChild(ul);if(NodeType.isEmpty(dom,parentNode)){DOM.remove(parentNode)}}else{DOM.setStyle(parentNode,"listStyleType","none")}}if(NodeType.isListNode(parentNode)){sibling=parentNode.previousSibling;if(sibling&&sibling.nodeName==="LI"){sibling.appendChild(ul)}}};var normalizeLists=function(dom,element){Tools.each(Tools.grep(dom.select("ol,ul",element)),function(ul){normalizeList(dom,ul)})};return{normalizeList:normalizeList,normalizeLists:normalizeLists}});define("tinymce.core.dom.DomQuery",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.DomQuery")});define("tinymce.plugins.lists.core.Selection",["tinymce.core.dom.DomQuery","tinymce.core.util.Tools","tinymce.plugins.lists.core.NodeType"],function(DomQuery,Tools,NodeType){var getParentList=function(editor){var selectionStart=editor.selection.getStart(true);return editor.dom.getParent(selectionStart,"OL,UL,DL",getClosestListRootElm(editor,selectionStart))};var isParentListSelected=function(parentList,selectedBlocks){return parentList&&selectedBlocks.length===1&&selectedBlocks[0]===parentList};var findSubLists=function(parentList){return Tools.grep(parentList.querySelectorAll("ol,ul,dl"),function(elm){return NodeType.isListNode(elm)})};var getSelectedSubLists=function(editor){var parentList=getParentList(editor);var selectedBlocks=editor.selection.getSelectedBlocks();if(isParentListSelected(parentList,selectedBlocks)){return findSubLists(parentList)}else{return Tools.grep(selectedBlocks,function(elm){return NodeType.isListNode(elm)&&parentList!==elm})}};var findParentListItemsNodes=function(editor,elms){var listItemsElms=Tools.map(elms,function(elm){var parentLi=editor.dom.getParent(elm,"li,dd,dt",getClosestListRootElm(editor,elm));return parentLi?parentLi:elm});return DomQuery.unique(listItemsElms)};var getSelectedListItems=function(editor){var selectedBlocks=editor.selection.getSelectedBlocks();return Tools.grep(findParentListItemsNodes(editor,selectedBlocks),function(block){return NodeType.isListItemNode(block)})};var getClosestListRootElm=function(editor,elm){var parentTableCell=editor.dom.getParents(elm,"TD,TH");var root=parentTableCell.length>0?parentTableCell[0]:editor.getBody();return root};return{getParentList:getParentList,getSelectedSubLists:getSelectedSubLists,getSelectedListItems:getSelectedListItems,getClosestListRootElm:getClosestListRootElm}});define("tinymce.core.Env",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.Env")});define("tinymce.plugins.lists.core.TextBlock",["tinymce.core.dom.DOMUtils","tinymce.core.Env","tinymce.plugins.lists.core.NodeType"],function(DOMUtils,Env,NodeType){var DOM=DOMUtils.DOM;var createNewTextBlock=function(editor,contentNode,blockName){var node,textBlock,fragment=DOM.createFragment(),hasContentNode;var blockElements=editor.schema.getBlockElements();if(editor.settings.forced_root_block){blockName=blockName||editor.settings.forced_root_block}if(blockName){textBlock=DOM.create(blockName);if(textBlock.tagName===editor.settings.forced_root_block){DOM.setAttribs(textBlock,editor.settings.forced_root_block_attrs)}if(!NodeType.isBlock(contentNode.firstChild,blockElements)){fragment.appendChild(textBlock)}}if(contentNode){while(node=contentNode.firstChild){var nodeName=node.nodeName;if(!hasContentNode&&(nodeName!=="SPAN"||node.getAttribute("data-mce-type")!=="bookmark")){hasContentNode=true}if(NodeType.isBlock(node,blockElements)){fragment.appendChild(node);textBlock=null}else{if(blockName){if(!textBlock){textBlock=DOM.create(blockName);fragment.appendChild(textBlock)}textBlock.appendChild(node)}else{fragment.appendChild(node)}}}}if(!editor.settings.forced_root_block){fragment.appendChild(DOM.create("br"))}else{if(!hasContentNode&&(!Env.ie||Env.ie>10)){textBlock.appendChild(DOM.create("br",{"data-mce-bogus":"1"}))}}return fragment};return{createNewTextBlock:createNewTextBlock}});define("tinymce.plugins.lists.core.SplitList",["tinymce.core.dom.DOMUtils","tinymce.plugins.lists.core.NodeType","tinymce.plugins.lists.core.TextBlock","tinymce.core.util.Tools"],function(DOMUtils,NodeType,TextBlock,Tools){var DOM=DOMUtils.DOM;var splitList=function(editor,ul,li,newBlock){var tmpRng,fragment,bookmarks,node;var removeAndKeepBookmarks=function(targetNode){Tools.each(bookmarks,function(node){targetNode.parentNode.insertBefore(node,li.parentNode)});DOM.remove(targetNode)};bookmarks=DOM.select('span[data-mce-type="bookmark"]',ul);newBlock=newBlock||TextBlock.createNewTextBlock(editor,li);tmpRng=DOM.createRng();tmpRng.setStartAfter(li);tmpRng.setEndAfter(ul);fragment=tmpRng.extractContents();for(node=fragment.firstChild;node;node=node.firstChild){if(node.nodeName==="LI"&&editor.dom.isEmpty(node)){DOM.remove(node);break}}if(!editor.dom.isEmpty(fragment)){DOM.insertAfter(fragment,ul)}DOM.insertAfter(newBlock,ul);if(NodeType.isEmpty(editor.dom,li.parentNode)){removeAndKeepBookmarks(li.parentNode)}DOM.remove(li);if(NodeType.isEmpty(editor.dom,ul)){DOM.remove(ul)}};return{splitList:splitList}});define("tinymce.plugins.lists.actions.Outdent",["tinymce.core.dom.DOMUtils","tinymce.plugins.lists.core.Bookmark","tinymce.plugins.lists.core.NodeType","tinymce.plugins.lists.core.NormalizeLists","tinymce.plugins.lists.core.Selection","tinymce.plugins.lists.core.SplitList","tinymce.plugins.lists.core.TextBlock"],function(DOMUtils,Bookmark,NodeType,NormalizeLists,Selection,SplitList,TextBlock){var DOM=DOMUtils.DOM;var removeEmptyLi=function(dom,li){if(NodeType.isEmpty(dom,li)){DOM.remove(li)}};var outdent=function(editor,li){var ul=li.parentNode,ulParent=ul.parentNode,newBlock;if(ul===editor.getBody()){return true}if(li.nodeName==="DD"){DOM.rename(li,"DT");return true}if(NodeType.isFirstChild(li)&&NodeType.isLastChild(li)){if(ulParent.nodeName==="LI"){DOM.insertAfter(li,ulParent);removeEmptyLi(editor.dom,ulParent);DOM.remove(ul)}else if(NodeType.isListNode(ulParent)){DOM.remove(ul,true)}else{ulParent.insertBefore(TextBlock.createNewTextBlock(editor,li),ul);DOM.remove(ul)}return true}else if(NodeType.isFirstChild(li)){if(ulParent.nodeName==="LI"){DOM.insertAfter(li,ulParent);li.appendChild(ul);removeEmptyLi(editor.dom,ulParent)}else if(NodeType.isListNode(ulParent)){ulParent.insertBefore(li,ul)}else{ulParent.insertBefore(TextBlock.createNewTextBlock(editor,li),ul);DOM.remove(li)}return true}else if(NodeType.isLastChild(li)){if(ulParent.nodeName==="LI"){DOM.insertAfter(li,ulParent)}else if(NodeType.isListNode(ulParent)){DOM.insertAfter(li,ul)}else{DOM.insertAfter(TextBlock.createNewTextBlock(editor,li),ul);DOM.remove(li)}return true}if(ulParent.nodeName==="LI"){ul=ulParent;newBlock=TextBlock.createNewTextBlock(editor,li,"LI")}else if(NodeType.isListNode(ulParent)){newBlock=TextBlock.createNewTextBlock(editor,li,"LI")}else{newBlock=TextBlock.createNewTextBlock(editor,li)}SplitList.splitList(editor,ul,li,newBlock);NormalizeLists.normalizeLists(editor.dom,ul.parentNode);return true};var outdentSelection=function(editor){var listElements=Selection.getSelectedListItems(editor);if(listElements.length){var bookmark=Bookmark.createBookmark(editor.selection.getRng(true));var i,y;var root=Selection.getClosestListRootElm(editor,editor.selection.getStart(true));i=listElements.length;while(i--){var node=listElements[i].parentNode;while(node&&node!==root){y=listElements.length;while(y--){if(listElements[y]===node){listElements.splice(i,1);break}}node=node.parentNode}}for(i=0;i<listElements.length;i++){if(!outdent(editor,listElements[i])&&i===0){break}}editor.selection.setRng(Bookmark.resolveBookmark(bookmark));editor.nodeChanged();return true}};return{outdent:outdent,outdentSelection:outdentSelection}});define("tinymce.plugins.lists.actions.ToggleList",["tinymce.core.api.dom.BookmarkManager","tinymce.core.util.Tools","tinymce.plugins.lists.actions.Outdent","tinymce.plugins.lists.core.Bookmark","tinymce.plugins.lists.core.NodeType","tinymce.plugins.lists.core.NormalizeLists","tinymce.plugins.lists.core.Selection","tinymce.plugins.lists.core.SplitList"],function(BookmarkManager,Tools,Outdent,Bookmark,NodeType,NormalizeLists,Selection,SplitList){var updateListStyle=function(dom,el,detail){var type=detail["list-style-type"]?detail["list-style-type"]:null;dom.setStyle(el,"list-style-type",type)};var setAttribs=function(elm,attrs){Tools.each(attrs,function(value,key){elm.setAttribute(key,value)})};var updateListAttrs=function(dom,el,detail){setAttribs(el,detail["list-attributes"]);Tools.each(dom.select("li",el),function(li){setAttribs(li,detail["list-item-attributes"])})};var updateListWithDetails=function(dom,el,detail){updateListStyle(dom,el,detail);updateListAttrs(dom,el,detail)};var getEndPointNode=function(editor,rng,start,root){var container,offset;container=rng[start?"startContainer":"endContainer"];offset=rng[start?"startOffset":"endOffset"];if(container.nodeType===1){container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container}if(!start&&NodeType.isBr(container.nextSibling)){container=container.nextSibling}while(container.parentNode!==root){if(NodeType.isTextBlock(editor,container)){return container}if(/^(TD|TH)$/.test(container.parentNode.nodeName)){return container}container=container.parentNode}return container};var getSelectedTextBlocks=function(editor,rng,root){var textBlocks=[],dom=editor.dom;var startNode=getEndPointNode(editor,rng,true,root);var endNode=getEndPointNode(editor,rng,false,root);var block,siblings=[];for(var node=startNode;node;node=node.nextSibling){siblings.push(node);if(node===endNode){break}}Tools.each(siblings,function(node){if(NodeType.isTextBlock(editor,node)){textBlocks.push(node);block=null;return}if(dom.isBlock(node)||NodeType.isBr(node)){if(NodeType.isBr(node)){dom.remove(node)}block=null;return}var nextSibling=node.nextSibling;if(BookmarkManager.isBookmarkNode(node)){if(NodeType.isTextBlock(editor,nextSibling)||!nextSibling&&node.parentNode===root){block=null;return}}if(!block){block=dom.create("p");node.parentNode.insertBefore(block,node);textBlocks.push(block)}block.appendChild(node)});return textBlocks};var hasCompatibleStyle=function(dom,sib,detail){var sibStyle=dom.getStyle(sib,"list-style-type");var detailStyle=detail?detail["list-style-type"]:"";detailStyle=detailStyle===null?"":detailStyle;return sibStyle===detailStyle};var applyList=function(editor,listName,detail){var rng=editor.selection.getRng(true),bookmark,listItemName="LI";var root=Selection.getClosestListRootElm(editor,editor.selection.getStart(true));var dom=editor.dom;detail=detail?detail:{};if(dom.getContentEditable(editor.selection.getNode())==="false"){return}listName=listName.toUpperCase();if(listName==="DL"){listItemName="DT"}bookmark=Bookmark.createBookmark(rng);Tools.each(getSelectedTextBlocks(editor,rng,root),function(block){var listBlock,sibling;sibling=block.previousSibling;if(sibling&&NodeType.isListNode(sibling)&&sibling.nodeName===listName&&hasCompatibleStyle(dom,sibling,detail)){listBlock=sibling;block=dom.rename(block,listItemName);sibling.appendChild(block)}else{listBlock=dom.create(listName);block.parentNode.insertBefore(listBlock,block);listBlock.appendChild(block);block=dom.rename(block,listItemName)}updateListWithDetails(dom,listBlock,detail);mergeWithAdjacentLists(editor.dom,listBlock)});editor.selection.setRng(Bookmark.resolveBookmark(bookmark))};var removeList=function(editor){var bookmark=Bookmark.createBookmark(editor.selection.getRng(true));var root=Selection.getClosestListRootElm(editor,editor.selection.getStart(true));var listItems=Selection.getSelectedListItems(editor);var emptyListItems=Tools.grep(listItems,function(li){return editor.dom.isEmpty(li)});listItems=Tools.grep(listItems,function(li){return!editor.dom.isEmpty(li)});Tools.each(emptyListItems,function(li){if(NodeType.isEmpty(editor.dom,li)){Outdent.outdent(editor,li);return}});Tools.each(listItems,function(li){var node,rootList;if(li.parentNode===editor.getBody()){return}for(node=li;node&&node!==root;node=node.parentNode){if(NodeType.isListNode(node)){rootList=node}}SplitList.splitList(editor,rootList,li);NormalizeLists.normalizeLists(editor.dom,rootList.parentNode)});editor.selection.setRng(Bookmark.resolveBookmark(bookmark))};var isValidLists=function(list1,list2){return list1&&list2&&NodeType.isListNode(list1)&&list1.nodeName===list2.nodeName};var hasSameListStyle=function(dom,list1,list2){var targetStyle=dom.getStyle(list1,"list-style-type",true);var style=dom.getStyle(list2,"list-style-type",true);return targetStyle===style};var hasSameClasses=function(elm1,elm2){return elm1.className===elm2.className};var shouldMerge=function(dom,list1,list2){return isValidLists(list1,list2)&&hasSameListStyle(dom,list1,list2)&&hasSameClasses(list1,list2)};var mergeWithAdjacentLists=function(dom,listBlock){var sibling,node;sibling=listBlock.nextSibling;if(shouldMerge(dom,listBlock,sibling)){while(node=sibling.firstChild){listBlock.appendChild(node)}dom.remove(sibling)}sibling=listBlock.previousSibling;if(shouldMerge(dom,listBlock,sibling)){while(node=sibling.lastChild){listBlock.insertBefore(node,listBlock.firstChild)}dom.remove(sibling)}};var updateList=function(dom,list,listName,detail){if(list.nodeName!==listName){var newList=dom.rename(list,listName);updateListWithDetails(dom,newList,detail)}else{updateListWithDetails(dom,list,detail)}};var toggleMultipleLists=function(editor,parentList,lists,listName,detail){if(parentList.nodeName===listName&&!hasListStyleDetail(detail)){removeList(editor,listName)}else{var bookmark=Bookmark.createBookmark(editor.selection.getRng(true));Tools.each([parentList].concat(lists),function(elm){updateList(editor.dom,elm,listName,detail)});editor.selection.setRng(Bookmark.resolveBookmark(bookmark))}};var hasListStyleDetail=function(detail){return"list-style-type"in detail};var toggleSingleList=function(editor,parentList,listName,detail){if(parentList===editor.getBody()){return}if(parentList){if(parentList.nodeName===listName&&!hasListStyleDetail(detail)){removeList(editor,listName)}else{var bookmark=Bookmark.createBookmark(editor.selection.getRng(true));updateListWithDetails(editor.dom,parentList,detail);mergeWithAdjacentLists(editor.dom,editor.dom.rename(parentList,listName));editor.selection.setRng(Bookmark.resolveBookmark(bookmark))}}else{applyList(editor,listName,detail)}};var toggleList=function(editor,listName,detail){var parentList=Selection.getParentList(editor);var selectedSubLists=Selection.getSelectedSubLists(editor);detail=detail?detail:{};if(parentList&&selectedSubLists.length>0){toggleMultipleLists(editor,parentList,selectedSubLists,listName,detail)}else{toggleSingleList(editor,parentList,listName,detail)}};return{toggleList:toggleList,removeList:removeList,mergeWithAdjacentLists:mergeWithAdjacentLists}});define("tinymce.plugins.lists.core.Delete",["tinymce.core.api.dom.RangeUtils","tinymce.core.dom.TreeWalker","tinymce.core.util.VK","tinymce.plugins.lists.actions.ToggleList","tinymce.plugins.lists.core.Bookmark","tinymce.plugins.lists.core.NodeType","tinymce.plugins.lists.core.NormalizeLists","tinymce.plugins.lists.core.Range","tinymce.plugins.lists.core.Selection"],function(RangeUtils,TreeWalker,VK,ToggleList,Bookmark,NodeType,NormalizeLists,Range,Selection){var findNextCaretContainer=function(editor,rng,isForward,root){var node=rng.startContainer,offset=rng.startOffset;var nonEmptyBlocks,walker;if(node.nodeType===3&&(isForward?offset<node.data.length:offset>0)){return node}nonEmptyBlocks=editor.schema.getNonEmptyElements();if(node.nodeType===1){node=RangeUtils.getNode(node,offset)}walker=new TreeWalker(node,root);if(isForward){if(NodeType.isBogusBr(editor.dom,node)){walker.next()}}while(node=walker[isForward?"next":"prev2"]()){if(node.nodeName==="LI"&&!node.hasChildNodes()){return node}if(nonEmptyBlocks[node.nodeName]){return node}if(node.nodeType===3&&node.data.length>0){return node}}};var hasOnlyOneBlockChild=function(dom,elm){var childNodes=elm.childNodes;return childNodes.length===1&&!NodeType.isListNode(childNodes[0])&&dom.isBlock(childNodes[0])};var unwrapSingleBlockChild=function(dom,elm){if(hasOnlyOneBlockChild(dom,elm)){dom.remove(elm.firstChild,true)}};var moveChildren=function(dom,fromElm,toElm){var node,targetElm;targetElm=hasOnlyOneBlockChild(dom,toElm)?toElm.firstChild:toElm;unwrapSingleBlockChild(dom,fromElm);if(!NodeType.isEmpty(dom,fromElm,true)){while(node=fromElm.firstChild){targetElm.appendChild(node)}}};var mergeLiElements=function(dom,fromElm,toElm){var node,listNode,ul=fromElm.parentNode;if(!NodeType.isChildOfBody(dom,fromElm)||!NodeType.isChildOfBody(dom,toElm)){return}if(NodeType.isListNode(toElm.lastChild)){listNode=toElm.lastChild}if(ul===toElm.lastChild){if(NodeType.isBr(ul.previousSibling)){dom.remove(ul.previousSibling)}}node=toElm.lastChild;if(node&&NodeType.isBr(node)&&fromElm.hasChildNodes()){dom.remove(node)}if(NodeType.isEmpty(dom,toElm,true)){dom.$(toElm).empty()}moveChildren(dom,fromElm,toElm);if(listNode){toElm.appendChild(listNode)}dom.remove(fromElm);if(NodeType.isEmpty(dom,ul)&&ul!==dom.getRoot()){dom.remove(ul)}};var mergeIntoEmptyLi=function(editor,fromLi,toLi){editor.dom.$(toLi).empty();mergeLiElements(editor.dom,fromLi,toLi);editor.selection.setCursorLocation(toLi)};var mergeForward=function(editor,rng,fromLi,toLi){var dom=editor.dom;if(dom.isEmpty(toLi)){mergeIntoEmptyLi(editor,fromLi,toLi)}else{var bookmark=Bookmark.createBookmark(rng);mergeLiElements(dom,fromLi,toLi);editor.selection.setRng(Bookmark.resolveBookmark(bookmark))}};var mergeBackward=function(editor,rng,fromLi,toLi){var bookmark=Bookmark.createBookmark(rng);mergeLiElements(editor.dom,fromLi,toLi);var resolvedBookmark=Bookmark.resolveBookmark(bookmark);editor.selection.setRng(resolvedBookmark)};var backspaceDeleteFromListToListCaret=function(editor,isForward){var dom=editor.dom,selection=editor.selection;var selectionStartElm=selection.getStart();var root=Selection.getClosestListRootElm(editor,selectionStartElm);var li=dom.getParent(selection.getStart(),"LI",root);var ul,rng,otherLi;if(li){ul=li.parentNode;if(ul===editor.getBody()&&NodeType.isEmpty(dom,ul)){return true}rng=Range.normalizeRange(selection.getRng(true));otherLi=dom.getParent(findNextCaretContainer(editor,rng,isForward,root),"LI",root);if(otherLi&&otherLi!==li){if(isForward){mergeForward(editor,rng,otherLi,li)}else{mergeBackward(editor,rng,li,otherLi)}return true}else if(!otherLi){if(!isForward&&ToggleList.removeList(editor,ul.nodeName)){return true}}}return false};var removeBlock=function(dom,block,root){var parentBlock=dom.getParent(block.parentNode,dom.isBlock,root);dom.remove(block);if(parentBlock&&dom.isEmpty(parentBlock)){dom.remove(parentBlock)}};var backspaceDeleteIntoListCaret=function(editor,isForward){var dom=editor.dom;var selectionStartElm=editor.selection.getStart();var root=Selection.getClosestListRootElm(editor,selectionStartElm);var block=dom.getParent(selectionStartElm,dom.isBlock,root);if(block&&dom.isEmpty(block)){var rng=Range.normalizeRange(editor.selection.getRng(true));var otherLi=dom.getParent(findNextCaretContainer(editor,rng,isForward,root),"LI",root);if(otherLi){editor.undoManager.transact(function(){removeBlock(dom,block,root);ToggleList.mergeWithAdjacentLists(dom,otherLi.parentNode);editor.selection.select(otherLi,true);editor.selection.collapse(isForward)});return true}}return false};var backspaceDeleteCaret=function(editor,isForward){return backspaceDeleteFromListToListCaret(editor,isForward)||backspaceDeleteIntoListCaret(editor,isForward)};var backspaceDeleteRange=function(editor){var selectionStartElm=editor.selection.getStart();var root=Selection.getClosestListRootElm(editor,selectionStartElm);var startListParent=editor.dom.getParent(selectionStartElm,"LI,DT,DD",root);if(startListParent||Selection.getSelectedListItems(editor).length>0){editor.undoManager.transact(function(){editor.execCommand("Delete");NormalizeLists.normalizeLists(editor.dom,editor.getBody())});return true}return false};var backspaceDelete=function(editor,isForward){return editor.selection.isCollapsed()?backspaceDeleteCaret(editor,isForward):backspaceDeleteRange(editor)};var setup=function(editor){editor.on("keydown",function(e){if(e.keyCode===VK.BACKSPACE){if(backspaceDelete(editor,false)){e.preventDefault()}}else if(e.keyCode===VK.DELETE){if(backspaceDelete(editor,true)){e.preventDefault()}}})};return{setup:setup,backspaceDelete:backspaceDelete}});define("tinymce.plugins.lists.api.Api",["tinymce.plugins.lists.core.Delete"],function(Delete){var get=function(editor){return{backspaceDelete:function(isForward){Delete.backspaceDelete(editor,isForward)}}};return{get:get}});define("tinymce.plugins.lists.actions.Indent",["tinymce.core.dom.DOMUtils","tinymce.plugins.lists.core.Bookmark","tinymce.plugins.lists.core.NodeType","tinymce.plugins.lists.core.Selection"],function(DOMUtils,Bookmark,NodeType,Selection){var DOM=DOMUtils.DOM;var mergeLists=function(from,to){var node;if(NodeType.isListNode(from)){while(node=from.firstChild){to.appendChild(node)}DOM.remove(from)}};var indent=function(li){var sibling,newList,listStyle;if(li.nodeName==="DT"){DOM.rename(li,"DD");return true}sibling=li.previousSibling;if(sibling&&NodeType.isListNode(sibling)){sibling.appendChild(li);return true}if(sibling&&sibling.nodeName==="LI"&&NodeType.isListNode(sibling.lastChild)){sibling.lastChild.appendChild(li);mergeLists(li.lastChild,sibling.lastChild);return true}sibling=li.nextSibling;if(sibling&&NodeType.isListNode(sibling)){sibling.insertBefore(li,sibling.firstChild);return true}sibling=li.previousSibling;if(sibling&&sibling.nodeName==="LI"){newList=DOM.create(li.parentNode.nodeName);listStyle=DOM.getStyle(li.parentNode,"listStyleType");if(listStyle){DOM.setStyle(newList,"listStyleType",listStyle)}sibling.appendChild(newList);newList.appendChild(li);mergeLists(li.lastChild,newList);return true}return false};var indentSelection=function(editor){var listElements=Selection.getSelectedListItems(editor);if(listElements.length){var bookmark=Bookmark.createBookmark(editor.selection.getRng(true));for(var i=0;i<listElements.length;i++){if(!indent(listElements[i])&&i===0){break}}editor.selection.setRng(Bookmark.resolveBookmark(bookmark));editor.nodeChanged();return true}};return{indentSelection:indentSelection}});define("tinymce.plugins.lists.api.Commands",["tinymce.plugins.lists.actions.Indent","tinymce.plugins.lists.actions.Outdent","tinymce.plugins.lists.actions.ToggleList"],function(Indent,Outdent,ToggleList){var queryListCommandState=function(editor,listName){return function(){var parentList=editor.dom.getParent(editor.selection.getStart(),"UL,OL,DL");return parentList&&parentList.nodeName===listName}};var register=function(editor){editor.on("BeforeExecCommand",function(e){var cmd=e.command.toLowerCase(),isHandled;if(cmd==="indent"){if(Indent.indentSelection(editor)){isHandled=true}}else if(cmd==="outdent"){if(Outdent.outdentSelection(editor)){isHandled=true}}if(isHandled){editor.fire("ExecCommand",{command:e.command});e.preventDefault();return true}});editor.addCommand("InsertUnorderedList",function(ui,detail){ToggleList.toggleList(editor,"UL",detail)});editor.addCommand("InsertOrderedList",function(ui,detail){ToggleList.toggleList(editor,"OL",detail)});editor.addCommand("InsertDefinitionList",function(ui,detail){ToggleList.toggleList(editor,"DL",detail)});editor.addQueryStateHandler("InsertUnorderedList",queryListCommandState(editor,"UL"));editor.addQueryStateHandler("InsertOrderedList",queryListCommandState(editor,"OL"));editor.addQueryStateHandler("InsertDefinitionList",queryListCommandState(editor,"DL"))};return{register:register}});define("tinymce.plugins.lists.api.Settings",[],function(){var shouldIndentOnTab=function(editor){return editor.getParam("lists_indent_on_tab",true)};return{shouldIndentOnTab:shouldIndentOnTab}});define("tinymce.plugins.lists.core.Keyboard",["tinymce.core.util.VK","tinymce.plugins.lists.actions.Indent","tinymce.plugins.lists.actions.Outdent","tinymce.plugins.lists.api.Settings","tinymce.plugins.lists.core.Delete"],function(VK,Indent,Outdent,Settings,Delete){var setupTabKey=function(editor){editor.on("keydown",function(e){if(e.keyCode!==VK.TAB||VK.metaKeyPressed(e)){return}if(editor.dom.getParent(editor.selection.getStart(),"LI,DT,DD")){e.preventDefault();if(e.shiftKey){Outdent.outdentSelection(editor)}else{Indent.indentSelection(editor)}}})};var setup=function(editor){if(Settings.shouldIndentOnTab(editor)){setupTabKey(editor)}Delete.setup(editor)};return{setup:setup}});define("tinymce.plugins.lists.ui.Buttons",["tinymce.core.util.Tools","tinymce.plugins.lists.core.NodeType","tinymce.plugins.lists.core.Selection"],function(Tools,NodeType,Selection){var findIndex=function(list,predicate){for(var index=0;index<list.length;index++){var element=list[index];if(predicate(element)){return index}}return-1};var listState=function(editor,listName){return function(e){var ctrl=e.control;editor.on("NodeChange",function(e){var tableCellIndex=findIndex(e.parents,NodeType.isTableCellNode);var parents=tableCellIndex!==-1?e.parents.slice(0,tableCellIndex):e.parents;var lists=Tools.grep(parents,NodeType.isListNode);ctrl.active(lists.length>0&&lists[0].nodeName===listName)})}};var indentPostRender=function(editor){return function(e){var ctrl=e.control;editor.on("nodechange",function(){var listItemBlocks=Selection.getSelectedListItems(editor);var disable=listItemBlocks.length>0&&NodeType.isFirstChild(listItemBlocks[0]);ctrl.disabled(disable)})}};var register=function(editor){var hasPlugin=function(editor,plugin){var plugins=editor.settings.plugins?editor.settings.plugins:"";return Tools.inArray(plugins.split(/[ ,]/),plugin)!==-1};if(!hasPlugin(editor,"advlist")){editor.addButton("numlist",{active:false,title:"Numbered list",cmd:"InsertOrderedList",onPostRender:listState(editor,"OL")});editor.addButton("bullist",{active:false,title:"Bullet list",cmd:"InsertUnorderedList",onPostRender:listState(editor,"UL")})}editor.addButton("indent",{icon:"indent",title:"Increase indent",cmd:"Indent",onPostRender:indentPostRender(editor)})};return{register:register}});define("tinymce.plugins.lists.Plugin",["tinymce.core.PluginManager","tinymce.plugins.lists.api.Api","tinymce.plugins.lists.api.Commands","tinymce.plugins.lists.core.Keyboard","tinymce.plugins.lists.ui.Buttons"],function(PluginManager,Api,Commands,Keyboard,Buttons){PluginManager.add("lists",function(editor){Keyboard.setup(editor);Buttons.register(editor);Commands.register(editor);return Api.get(editor)});return function(){}});dem("tinymce.plugins.lists.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};define("ephox.katamari.api.Cell",[],function(){var Cell=function(initial){var value=initial;var get=function(){return value};var set=function(v){value=v};var clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}};return Cell});defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});defineGlobal("global!window",window);define("tinymce.plugins.paste.alien.DetectProPlugin",["global!window","tinymce.core.PluginManager"],function(window,PluginManager){var hasProPlugin=function(editor){if(/(^|[ ,])powerpaste([, ]|$)/.test(editor.settings.plugins)&&PluginManager.get("powerpaste")){if(typeof window.console!=="undefined"&&window.console.log){window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option.")}return true}else{return false}};return{hasProPlugin:hasProPlugin}});define("tinymce.plugins.paste.api.Api",[],function(Actions){var get=function(clipboard,quirks){return{clipboard:clipboard,quirks:quirks}};return{get:get}});define("tinymce.plugins.paste.api.Events",[],function(){var firePastePreProcess=function(editor,html,internal,isWordHtml){return editor.fire("PastePreProcess",{content:html,internal:internal,wordContent:isWordHtml})};var firePastePostProcess=function(editor,node,internal,isWordHtml){return editor.fire("PastePostProcess",{node:node,internal:internal,wordContent:isWordHtml})};var firePastePlainTextToggle=function(editor,state){return editor.fire("PastePlainTextToggle",{state:state})};var firePaste=function(editor,ieFake){return editor.fire("paste",{ieFake:ieFake})};return{firePastePreProcess:firePastePreProcess,firePastePostProcess:firePastePostProcess,firePastePlainTextToggle:firePastePlainTextToggle,firePaste:firePaste}});define("tinymce.plugins.paste.api.Settings",[],function(){var shouldPlainTextInform=function(editor){return editor.getParam("paste_plaintext_inform",true)};var shouldBlockDrop=function(editor){return editor.getParam("paste_block_drop",false)};var shouldPasteDataImages=function(editor){return editor.getParam("paste_data_images",false)};var shouldFilterDrop=function(editor){return editor.getParam("paste_filter_drop",true)};var getPreProcess=function(editor){return editor.getParam("paste_preprocess")};var getPostProcess=function(editor){return editor.getParam("paste_postprocess")};var getWebkitStyles=function(editor){return editor.getParam("paste_webkit_styles")};var shouldRemoveWebKitStyles=function(editor){return editor.getParam("paste_remove_styles_if_webkit",true)};var shouldMergeFormats=function(editor){return editor.getParam("paste_merge_formats",true)};var isSmartPasteEnabled=function(editor){return editor.getParam("smart_paste",true)};var isPasteAsTextEnabled=function(editor){return editor.getParam("paste_as_text",false)};var getRetainStyleProps=function(editor){return editor.getParam("paste_retain_style_properties")};var getWordValidElements=function(editor){var defaultValidElements="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,"+"-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,"+"td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody";return editor.getParam("paste_word_valid_elements",defaultValidElements)};var shouldConvertWordFakeLists=function(editor){return editor.getParam("paste_convert_word_fake_lists",true)};var shouldUseDefaultFilters=function(editor){return editor.getParam("paste_enable_default_filters",true)};return{shouldPlainTextInform:shouldPlainTextInform,shouldBlockDrop:shouldBlockDrop,shouldPasteDataImages:shouldPasteDataImages,shouldFilterDrop:shouldFilterDrop,getPreProcess:getPreProcess,getPostProcess:getPostProcess,getWebkitStyles:getWebkitStyles,shouldRemoveWebKitStyles:shouldRemoveWebKitStyles,shouldMergeFormats:shouldMergeFormats,isSmartPasteEnabled:isSmartPasteEnabled,isPasteAsTextEnabled:isPasteAsTextEnabled,getRetainStyleProps:getRetainStyleProps,getWordValidElements:getWordValidElements,shouldConvertWordFakeLists:shouldConvertWordFakeLists,shouldUseDefaultFilters:shouldUseDefaultFilters}});define("tinymce.plugins.paste.core.Actions",["tinymce.plugins.paste.api.Events","tinymce.plugins.paste.api.Settings"],function(Events,Settings){var shouldInformUserAboutPlainText=function(editor,userIsInformedState){return userIsInformedState.get()===false&&Settings.shouldPlainTextInform(editor)};var displayNotification=function(editor,message){editor.notificationManager.open({text:editor.translate(message),type:"info"})};var togglePlainTextPaste=function(editor,clipboard,userIsInformedState){if(clipboard.pasteFormat==="text"){clipboard.pasteFormat="html";Events.firePastePlainTextToggle(editor,false)}else{clipboard.pasteFormat="text";Events.firePastePlainTextToggle(editor,true);if(shouldInformUserAboutPlainText(editor,userIsInformedState)){displayNotification(editor,"Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.");userIsInformedState.set(true)}}editor.focus()};return{togglePlainTextPaste:togglePlainTextPaste}});define("tinymce.plugins.paste.api.Commands",["tinymce.plugins.paste.core.Actions"],function(Actions){var register=function(editor,clipboard,userIsInformedState){editor.addCommand("mceTogglePlainTextPaste",function(){Actions.togglePlainTextPaste(editor,clipboard,userIsInformedState)});editor.addCommand("mceInsertClipboardContent",function(ui,value){if(value.content){clipboard.pasteHtml(value.content,value.internal)}if(value.text){clipboard.pasteText(value.text)}})};return{register:register}});defineGlobal("global!Image",Image);defineGlobal("global!navigator",navigator);define("tinymce.core.Env",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.Env")});define("tinymce.core.util.Delay",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Delay")});define("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Tools")});define("tinymce.core.util.VK",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.VK")});define("tinymce.plugins.paste.core.InternalHtml",[],function(){var internalMimeType="x-tinymce/html";var internalMark="\x3c!-- "+internalMimeType+" --\x3e";var mark=function(html){return internalMark+html};var unmark=function(html){return html.replace(internalMark,"")};var isMarked=function(html){return html.indexOf(internalMark)!==-1};return{mark:mark,unmark:unmark,isMarked:isMarked,internalHtmlMime:function(){return internalMimeType}}});define("tinymce.core.html.Entities",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.html.Entities")});define("tinymce.plugins.paste.core.Newlines",["tinymce.core.util.Tools","tinymce.core.html.Entities"],function(Tools,Entities){var isPlainText=function(text){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(text)};var toBRs=function(text){return text.replace(/\r?\n/g,"<br>")};var openContainer=function(rootTag,rootAttrs){var key,attrs=[];var tag="<"+rootTag;if(typeof rootAttrs==="object"){for(key in rootAttrs){if(rootAttrs.hasOwnProperty(key)){attrs.push(key+'="'+Entities.encodeAllRaw(rootAttrs[key])+'"')}}if(attrs.length){tag+=" "+attrs.join(" ")}}return tag+">"};var toBlockElements=function(text,rootTag,rootAttrs){var blocks=text.split(/\n\n/);var tagOpen=openContainer(rootTag,rootAttrs);var tagClose="</"+rootTag+">";var paragraphs=Tools.map(blocks,function(p){return p.split(/\n/).join("<br />")});var stitch=function(p){return tagOpen+p+tagClose};return paragraphs.length===1?paragraphs[0]:Tools.map(paragraphs,stitch).join("")};var convert=function(text,rootTag,rootAttrs){return rootTag?toBlockElements(text,rootTag,rootAttrs):toBRs(text)};return{isPlainText:isPlainText,convert:convert,toBRs:toBRs,toBlockElements:toBlockElements}});define("tinymce.plugins.paste.core.PasteBin",["tinymce.core.util.Tools","tinymce.core.Env"],function(Tools,Env){return function(editor){var lastRng;var pasteBinDefaultContent="%MCEPASTEBIN%";var create=function(){var dom=editor.dom,body=editor.getBody();var viewport=editor.dom.getViewPort(editor.getWin()),scrollTop=viewport.y,top=20;var pasteBinElm;var scrollContainer;lastRng=editor.selection.getRng();if(editor.inline){scrollContainer=editor.selection.getScrollContainer();if(scrollContainer&&scrollContainer.scrollTop>0){scrollTop=scrollContainer.scrollTop}}function getCaretRect(rng){var rects,textNode,node,container=rng.startContainer;rects=rng.getClientRects();if(rects.length){return rects[0]}if(!rng.collapsed||container.nodeType!==1){return}node=container.childNodes[lastRng.startOffset];while(node&&node.nodeType===3&&!node.data.length){node=node.nextSibling}if(!node){return}if(node.tagName==="BR"){textNode=dom.doc.createTextNode("\ufeff");node.parentNode.insertBefore(textNode,node);rng=dom.createRng();rng.setStartBefore(textNode);rng.setEndAfter(textNode);rects=rng.getClientRects();dom.remove(textNode)}if(rects.length){return rects[0]}}if(lastRng.getClientRects){var rect=getCaretRect(lastRng);if(rect){top=scrollTop+(rect.top-dom.getPos(body).y)}else{top=scrollTop;var container=lastRng.startContainer;if(container){if(container.nodeType===3&&container.parentNode!==body){container=container.parentNode}if(container.nodeType===1){top=dom.getPos(container,scrollContainer||body).y}}}}pasteBinElm=editor.dom.add(editor.getBody(),"div",{id:"mcepastebin",contentEditable:true,"data-mce-bogus":"all",style:"position: absolute; top: "+top+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0"},pasteBinDefaultContent);if(Env.ie||Env.gecko){dom.setStyle(pasteBinElm,"left",dom.getStyle(body,"direction",true)==="rtl"?65535:-65535)}dom.bind(pasteBinElm,"beforedeactivate focusin focusout",function(e){e.stopPropagation()});pasteBinElm.focus();editor.selection.select(pasteBinElm,true)};var remove=function(){if(getEl()){var pasteBinClone;while(pasteBinClone=editor.dom.get("mcepastebin")){editor.dom.remove(pasteBinClone);editor.dom.unbind(pasteBinClone)}if(lastRng){editor.selection.setRng(lastRng)}}lastRng=null};var getEl=function(){return editor.dom.get("mcepastebin")};var getHtml=function(){var pasteBinElm,pasteBinClones,i,dirtyWrappers,cleanWrapper;var copyAndRemove=function(toElm,fromElm){toElm.appendChild(fromElm);editor.dom.remove(fromElm,true)};pasteBinClones=Tools.grep(editor.getBody().childNodes,function(elm){return elm.id==="mcepastebin"});pasteBinElm=pasteBinClones.shift();Tools.each(pasteBinClones,function(pasteBinClone){copyAndRemove(pasteBinElm,pasteBinClone)});dirtyWrappers=editor.dom.select("div[id=mcepastebin]",pasteBinElm);for(i=dirtyWrappers.length-1;i>=0;i--){cleanWrapper=editor.dom.create("div");pasteBinElm.insertBefore(cleanWrapper,dirtyWrappers[i]);copyAndRemove(cleanWrapper,dirtyWrappers[i])}return pasteBinElm?pasteBinElm.innerHTML:""};var getLastRng=function(){return lastRng};var isDefaultContent=function(content){return content===pasteBinDefaultContent};var isPasteBin=function(elm){return elm&&elm.id==="mcepastebin"};var isDefault=function(){var pasteBinElm=getEl();return isPasteBin(pasteBinElm)&&isDefaultContent(pasteBinElm.innerHTML)};return{create:create,remove:remove,getEl:getEl,getHtml:getHtml,getLastRng:getLastRng,isDefault:isDefault,isDefaultContent:isDefaultContent}}});define("tinymce.core.html.DomParser",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.html.DomParser")});define("tinymce.core.html.Node",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.html.Node")});define("tinymce.core.html.Schema",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.html.Schema")});define("tinymce.core.html.Serializer",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.html.Serializer")});define("tinymce.plugins.paste.core.Utils",["global!navigator","tinymce.core.html.DomParser","tinymce.core.html.Schema","tinymce.core.util.Tools"],function(navigator,DomParser,Schema,Tools){function filter(content,items){Tools.each(items,function(v){if(v.constructor===RegExp){content=content.replace(v,"")}else{content=content.replace(v[0],v[1])}});return content}function innerText(html){var schema=new Schema,domParser=new DomParser({},schema),text="";var shortEndedElements=schema.getShortEndedElements();var ignoreElements=Tools.makeMap("script noscript style textarea video audio iframe object"," ");var blockElements=schema.getBlockElements();function walk(node){var name=node.name,currentNode=node;if(name==="br"){text+="\n";return}if(shortEndedElements[name]){text+=" "}if(ignoreElements[name]){text+=" ";return}if(node.type===3){text+=node.value}if(!node.shortEnded){if(node=node.firstChild){do{walk(node)}while(node=node.next)}}if(blockElements[name]&&currentNode.next){text+="\n";if(name==="p"){text+="\n"}}}html=filter(html,[/<!\[[^\]]+\]>/g]);walk(domParser.parse(html));return text}function trimHtml(html){function trimSpaces(all,s1,s2){if(!s1&&!s2){return" "}return"¬†"}html=filter(html,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,trimSpaces],/<br class="Apple-interchange-newline">/g,/<br>$/i]);return html}function createIdGenerator(prefix){var count=0;return function(){return prefix+count++}}var isMsEdge=function(){return navigator.userAgent.indexOf(" Edge/")!==-1};return{filter:filter,innerText:innerText,trimHtml:trimHtml,createIdGenerator:createIdGenerator,isMsEdge:isMsEdge}});define("tinymce.plugins.paste.core.WordFilter",["tinymce.core.html.DomParser","tinymce.core.html.Node","tinymce.core.html.Schema","tinymce.core.html.Serializer","tinymce.core.util.Tools","tinymce.plugins.paste.api.Settings","tinymce.plugins.paste.core.Utils"],function(DomParser,Node,Schema,Serializer,Tools,Settings,Utils){function isWordContent(content){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(content)||/class="OutlineElement/.test(content)||/id="?docs\-internal\-guid\-/.test(content)}function isNumericList(text){var found,patterns;patterns=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/];text=text.replace(/^[\u00a0 ]+/,"");Tools.each(patterns,function(pattern){if(pattern.test(text)){found=true;return false}});return found}function isBulletList(text){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(text)}function convertFakeListsToProperLists(node){var currentListNode,prevListNode,lastLevel=1;function getText(node){var txt="";if(node.type===3){return node.value}if(node=node.firstChild){do{txt+=getText(node)}while(node=node.next)}return txt}function trimListStart(node,regExp){if(node.type===3){if(regExp.test(node.value)){node.value=node.value.replace(regExp,"");return false}}if(node=node.firstChild){do{if(!trimListStart(node,regExp)){return false}}while(node=node.next)}return true}function removeIgnoredNodes(node){if(node._listIgnore){node.remove();return}if(node=node.firstChild){do{removeIgnoredNodes(node)}while(node=node.next)}}function convertParagraphToLi(paragraphNode,listName,start){var level=paragraphNode._listLevel||lastLevel;if(level!==lastLevel){if(level<lastLevel){if(currentListNode){currentListNode=currentListNode.parent.parent}}else{prevListNode=currentListNode;currentListNode=null}}if(!currentListNode||currentListNode.name!==listName){prevListNode=prevListNode||currentListNode;currentListNode=new Node(listName,1);if(start>1){currentListNode.attr("start",""+start)}paragraphNode.wrap(currentListNode)}else{currentListNode.append(paragraphNode)}paragraphNode.name="li";if(level>lastLevel&&prevListNode){prevListNode.lastChild.append(currentListNode)}lastLevel=level;removeIgnoredNodes(paragraphNode);trimListStart(paragraphNode,/^\u00a0+/);trimListStart(paragraphNode,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);trimListStart(paragraphNode,/^\u00a0+/)}var elements=[],child=node.firstChild;while(typeof child!=="undefined"&&child!==null){elements.push(child);child=child.walk();if(child!==null){while(typeof child!=="undefined"&&child.parent!==node){child=child.walk()}}}for(var i=0;i<elements.length;i++){node=elements[i];if(node.name==="p"&&node.firstChild){var nodeText=getText(node);if(isBulletList(nodeText)){convertParagraphToLi(node,"ul");continue}if(isNumericList(nodeText)){var matches=/([0-9]+)\./.exec(nodeText);var start=1;if(matches){start=parseInt(matches[1],10)}convertParagraphToLi(node,"ol",start);continue}if(node._listLevel){convertParagraphToLi(node,"ul",1);continue}currentListNode=null}else{prevListNode=currentListNode;currentListNode=null}}}function filterStyles(editor,validStyles,node,styleValue){var outputStyles={},matches,styles=editor.dom.parseStyle(styleValue);Tools.each(styles,function(value,name){switch(name){case"mso-list":matches=/\w+ \w+([0-9]+)/i.exec(styleValue);if(matches){node._listLevel=parseInt(matches[1],10)}if(/Ignore/i.test(value)&&node.firstChild){node._listIgnore=true;node.firstChild._listIgnore=true}break;case"horiz-align":name="text-align";break;case"vert-align":name="vertical-align";break;case"font-color":case"mso-foreground":name="color";break;case"mso-background":case"mso-highlight":name="background";break;case"font-weight":case"font-style":if(value!=="normal"){outputStyles[name]=value}return;case"mso-element":if(/^(comment|comment-list)$/i.test(value)){node.remove();return}break}if(name.indexOf("mso-comment")===0){node.remove();return}if(name.indexOf("mso-")===0){return}if(Settings.getRetainStyleProps(editor)==="all"||validStyles&&validStyles[name]){outputStyles[name]=value}});if(/(bold)/i.test(outputStyles["font-weight"])){delete outputStyles["font-weight"];node.wrap(new Node("b",1))}if(/(italic)/i.test(outputStyles["font-style"])){delete outputStyles["font-style"];node.wrap(new Node("i",1))}outputStyles=editor.dom.serializeStyle(outputStyles,node.name);if(outputStyles){return outputStyles}return null}var filterWordContent=function(editor,content){var retainStyleProperties,validStyles;retainStyleProperties=Settings.getRetainStyleProps(editor);if(retainStyleProperties){validStyles=Tools.makeMap(retainStyleProperties.split(/[, ]/))}content=Utils.filter(content,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"¬†"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(str,spaces){return spaces.length>0?spaces.replace(/./," ").slice(Math.floor(spaces.length/2)).split("").join("¬†"):""}]]);var validElements=Settings.getWordValidElements(editor);var schema=new Schema({valid_elements:validElements,valid_children:"-li[p]"});Tools.each(schema.elements,function(rule){if(!rule.attributes["class"]){rule.attributes["class"]={};rule.attributesOrder.push("class")}if(!rule.attributes.style){rule.attributes.style={};rule.attributesOrder.push("style")}});var domParser=new DomParser({},schema);domParser.addAttributeFilter("style",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];node.attr("style",filterStyles(editor,validStyles,node,node.attr("style")));if(node.name==="span"&&node.parent&&!node.attributes.length){node.unwrap()}}});domParser.addAttributeFilter("class",function(nodes){var i=nodes.length,node,className;while(i--){node=nodes[i];className=node.attr("class");if(/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)){node.remove()}node.attr("class",null)}});domParser.addNodeFilter("del",function(nodes){var i=nodes.length;while(i--){nodes[i].remove()}});domParser.addNodeFilter("a",function(nodes){var i=nodes.length,node,href,name;while(i--){node=nodes[i];href=node.attr("href");name=node.attr("name");if(href&&href.indexOf("#_msocom_")!==-1){node.remove();continue}if(href&&href.indexOf("file://")===0){href=href.split("#")[1];if(href){href="#"+href}}if(!href&&!name){node.unwrap()}else{if(name&&!/^_?(?:toc|edn|ftn)/i.test(name)){node.unwrap();continue}node.attr({href:href,name:name})}}});var rootNode=domParser.parse(content);if(Settings.shouldConvertWordFakeLists(editor)){convertFakeListsToProperLists(rootNode)}content=new Serializer({validate:editor.settings.validate},schema).serialize(rootNode);return content};var preProcess=function(editor,content){return Settings.shouldUseDefaultFilters(editor)?filterWordContent(editor,content):content};return{preProcess:preProcess,isWordContent:isWordContent}});define("tinymce.plugins.paste.core.ProcessFilters",["tinymce.plugins.paste.api.Events","tinymce.plugins.paste.core.WordFilter"],function(Events,WordFilter){var processResult=function(content,cancelled){return{content:content,cancelled:cancelled}};var postProcessFilter=function(editor,html,internal,isWordHtml){var tempBody=editor.dom.create("div",{style:"display:none"},html);var postProcessArgs=Events.firePastePostProcess(editor,tempBody,internal,isWordHtml);return processResult(postProcessArgs.node.innerHTML,postProcessArgs.isDefaultPrevented())};var filterContent=function(editor,content,internal,isWordHtml){var preProcessArgs=Events.firePastePreProcess(editor,content,internal,isWordHtml);if(editor.hasEventListeners("PastePostProcess")&&!preProcessArgs.isDefaultPrevented()){return postProcessFilter(editor,preProcessArgs.content,internal,isWordHtml)}else{return processResult(preProcessArgs.content,preProcessArgs.isDefaultPrevented())}};var process=function(editor,html,internal){var isWordHtml=WordFilter.isWordContent(html);var content=isWordHtml?WordFilter.preProcess(editor,html):html;return filterContent(editor,content,internal,isWordHtml)};return{process:process}});define("tinymce.plugins.paste.core.SmartPaste",["tinymce.core.util.Tools","tinymce.plugins.paste.api.Settings"],function(Tools,Settings){var isAbsoluteUrl=function(url){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(url)};var isImageUrl=function(url){return isAbsoluteUrl(url)&&/.(gif|jpe?g|png)$/.test(url)};var createImage=function(editor,url,pasteHtml){editor.undoManager.extra(function(){pasteHtml(editor,url)},function(){editor.insertContent('<img src="'+url+'">')});return true};var createLink=function(editor,url,pasteHtml){editor.undoManager.extra(function(){pasteHtml(editor,url)},function(){editor.execCommand("mceInsertLink",false,url)});return true};var linkSelection=function(editor,html,pasteHtml){return editor.selection.isCollapsed()===false&&isAbsoluteUrl(html)?createLink(editor,html,pasteHtml):false};var insertImage=function(editor,html,pasteHtml){return isImageUrl(html)?createImage(editor,html,pasteHtml):false};var pasteHtml=function(editor,html){editor.insertContent(html,{merge:Settings.shouldMergeFormats(editor),paste:true});return true};var smartInsertContent=function(editor,html){Tools.each([linkSelection,insertImage,pasteHtml],function(action){return action(editor,html,pasteHtml)!==true})};var insertContent=function(editor,html){if(Settings.isSmartPasteEnabled(editor)===false){pasteHtml(editor,html)}else{smartInsertContent(editor,html)}};return{isImageUrl:isImageUrl,isAbsoluteUrl:isAbsoluteUrl,insertContent:insertContent}});define("tinymce.plugins.paste.core.Clipboard",["global!Image","global!navigator","global!window","tinymce.core.Env","tinymce.core.util.Delay","tinymce.core.util.Tools","tinymce.core.util.VK","tinymce.plugins.paste.api.Events","tinymce.plugins.paste.api.Settings","tinymce.plugins.paste.core.InternalHtml","tinymce.plugins.paste.core.Newlines","tinymce.plugins.paste.core.PasteBin","tinymce.plugins.paste.core.ProcessFilters","tinymce.plugins.paste.core.SmartPaste","tinymce.plugins.paste.core.Utils"],function(Image,navigator,window,Env,Delay,Tools,VK,Events,Settings,InternalHtml,Newlines,PasteBin,ProcessFilters,SmartPaste,Utils){return function(editor){var self=this,keyboardPasteTimeStamp=0;var pasteBin=new PasteBin(editor);var keyboardPastePlainTextState;var mceInternalUrlPrefix="data:text/mce-internal,";var uniqueId=Utils.createIdGenerator("mceclip");self.pasteFormat=Settings.isPasteAsTextEnabled(editor)?"text":"html";function pasteHtml(html,internalFlag){var internal=internalFlag?internalFlag:InternalHtml.isMarked(html);var args=ProcessFilters.process(editor,InternalHtml.unmark(html),internal);if(args.cancelled===false){SmartPaste.insertContent(editor,args.content)}}function pasteText(text){text=editor.dom.encode(text).replace(/\r\n/g,"\n");text=Newlines.convert(text,editor.settings.forced_root_block,editor.settings.forced_root_block_attrs);pasteHtml(text,false)}function getDataTransferItems(dataTransfer){var items={};if(dataTransfer){if(dataTransfer.getData){var legacyText=dataTransfer.getData("Text");if(legacyText&&legacyText.length>0){if(legacyText.indexOf(mceInternalUrlPrefix)===-1){items["text/plain"]=legacyText}}}if(dataTransfer.types){for(var i=0;i<dataTransfer.types.length;i++){var contentType=dataTransfer.types[i];try{items[contentType]=dataTransfer.getData(contentType)}catch(ex){items[contentType]=""}}}}return items}function getClipboardContent(clipboardEvent){var content=getDataTransferItems(clipboardEvent.clipboardData||editor.getDoc().dataTransfer);return Utils.isMsEdge()?Tools.extend(content,{"text/html":""}):content}function hasHtmlOrText(content){return hasContentType(content,"text/html")||hasContentType(content,"text/plain")}function getBase64FromUri(uri){var idx;idx=uri.indexOf(",");if(idx!==-1){return uri.substr(idx+1)}return null}function isValidDataUriImage(settings,imgElm){return settings.images_dataimg_filter?settings.images_dataimg_filter(imgElm):true}function extractFilename(str){var m=str.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return m?editor.dom.encode(m[1]):null}function pasteImage(rng,reader,blob){if(rng){editor.selection.setRng(rng);rng=null}var dataUri=reader.result;var base64=getBase64FromUri(dataUri);var id=uniqueId();var name=editor.settings.images_reuse_filename&&blob.name?extractFilename(blob.name):id;var img=new Image;img.src=dataUri;if(isValidDataUriImage(editor.settings,img)){var blobCache=editor.editorUpload.blobCache;var blobInfo,existingBlobInfo;existingBlobInfo=blobCache.findFirst(function(cachedBlobInfo){return cachedBlobInfo.base64()===base64});if(!existingBlobInfo){blobInfo=blobCache.create(id,blob,base64,name);blobCache.add(blobInfo)}else{blobInfo=existingBlobInfo}pasteHtml('<img src="'+blobInfo.blobUri()+'">',false)}else{pasteHtml('<img src="'+dataUri+'">',false)}}function pasteImageData(e,rng){var dataTransfer=e.clipboardData||e.dataTransfer;function processItems(items){var i,item,reader,hadImage=false;if(items){for(i=0;i<items.length;i++){item=items[i];if(/^image\/(jpeg|png|gif|bmp)$/.test(item.type)){var blob=item.getAsFile?item.getAsFile():item;reader=new window.FileReader;reader.onload=pasteImage.bind(null,rng,reader,blob);reader.readAsDataURL(blob);e.preventDefault();hadImage=true}}}return hadImage}if(editor.settings.paste_data_images&&dataTransfer){return processItems(dataTransfer.items)||processItems(dataTransfer.files)}}function isBrokenAndroidClipboardEvent(e){var clipboardData=e.clipboardData;return navigator.userAgent.indexOf("Android")!==-1&&clipboardData&&clipboardData.items&&clipboardData.items.length===0}function hasContentType(clipboardContent,mimeType){return mimeType in clipboardContent&&clipboardContent[mimeType].length>0}function isKeyboardPasteEvent(e){return VK.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45}function registerEventHandlers(){editor.on("keydown",function(e){function removePasteBinOnKeyUp(e){if(isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()){pasteBin.remove()}}if(isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()){keyboardPastePlainTextState=e.shiftKey&&e.keyCode===86;if(keyboardPastePlainTextState&&Env.webkit&&navigator.userAgent.indexOf("Version/")!==-1){return}e.stopImmediatePropagation();keyboardPasteTimeStamp=(new Date).getTime();if(Env.ie&&keyboardPastePlainTextState){e.preventDefault();Events.firePaste(editor,true);return}pasteBin.remove();pasteBin.create();editor.once("keyup",removePasteBinOnKeyUp);editor.once("paste",function(){editor.off("keyup",removePasteBinOnKeyUp)})}});function insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal){var content,isPlainTextHtml;if(hasContentType(clipboardContent,"text/html")){content=clipboardContent["text/html"]}else{content=pasteBin.getHtml();internal=internal?internal:InternalHtml.isMarked(content);if(pasteBin.isDefaultContent(content)){plainTextMode=true}}content=Utils.trimHtml(content);pasteBin.remove();isPlainTextHtml=internal===false&&Newlines.isPlainText(content);if(!content.length||isPlainTextHtml){plainTextMode=true}if(plainTextMode){if(hasContentType(clipboardContent,"text/plain")&&isPlainTextHtml){content=clipboardContent["text/plain"]}else{content=Utils.innerText(content)}}if(pasteBin.isDefaultContent(content)){if(!isKeyBoardPaste){editor.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")}return}if(plainTextMode){pasteText(content)}else{pasteHtml(content,internal)}}var getLastRng=function(){return pasteBin.getLastRng()||editor.selection.getRng()};editor.on("paste",function(e){var clipboardTimer=(new Date).getTime();var clipboardContent=getClipboardContent(e);var clipboardDelay=(new Date).getTime()-clipboardTimer;var isKeyBoardPaste=(new Date).getTime()-keyboardPasteTimeStamp-clipboardDelay<1e3;var plainTextMode=self.pasteFormat==="text"||keyboardPastePlainTextState;var internal=hasContentType(clipboardContent,InternalHtml.internalHtmlMime());keyboardPastePlainTextState=false;if(e.isDefaultPrevented()||isBrokenAndroidClipboardEvent(e)){pasteBin.remove();return}if(!hasHtmlOrText(clipboardContent)&&pasteImageData(e,getLastRng())){pasteBin.remove();return}if(!isKeyBoardPaste){e.preventDefault()}if(Env.ie&&(!isKeyBoardPaste||e.ieFake)&&!hasContentType(clipboardContent,"text/html")){pasteBin.create();editor.dom.bind(pasteBin.getEl(),"paste",function(e){e.stopPropagation()});editor.getDoc().execCommand("Paste",false,null);clipboardContent["text/html"]=pasteBin.getHtml()}if(hasContentType(clipboardContent,"text/html")){e.preventDefault();if(!internal){internal=InternalHtml.isMarked(clipboardContent["text/html"])}insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal)}else{Delay.setEditorTimeout(editor,function(){insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal)},0)}})}self.pasteHtml=pasteHtml;self.pasteText=pasteText;self.pasteImageData=pasteImageData;self.getDataTransferItems=getDataTransferItems;self.hasHtmlOrText=hasHtmlOrText;self.hasContentType=hasContentType;editor.on("preInit",function(){registerEventHandlers();editor.parser.addNodeFilter("img",function(nodes,name,args){function isPasteInsert(args){return args.data&&args.data.paste===true}function remove(node){if(!node.attr("data-mce-object")&&src!==Env.transparentSrc){node.remove()}}function isWebKitFakeUrl(src){return src.indexOf("webkit-fake-url")===0}function isDataUri(src){return src.indexOf("data:")===0}if(!editor.settings.paste_data_images&&isPasteInsert(args)){var i=nodes.length;while(i--){var src=nodes[i].attributes.map.src;if(!src){continue}if(isWebKitFakeUrl(src)){remove(nodes[i])}else if(!editor.settings.allow_html_data_urls&&isDataUri(src)){remove(nodes[i])}}}})})}});defineGlobal("global!setTimeout",setTimeout);define("tinymce.plugins.paste.core.CutCopy",["global!setTimeout","tinymce.core.Env","tinymce.plugins.paste.core.InternalHtml","tinymce.plugins.paste.core.Utils"],function(setTimeout,Env,InternalHtml,Utils){var noop=function(){};var hasWorkingClipboardApi=function(clipboardData){return Env.iOS===false&&clipboardData!==undefined&&typeof clipboardData.setData==="function"&&Utils.isMsEdge()!==true};var setHtml5Clipboard=function(clipboardData,html,text){if(hasWorkingClipboardApi(clipboardData)){try{clipboardData.clearData();clipboardData.setData("text/html",html);clipboardData.setData("text/plain",text);clipboardData.setData(InternalHtml.internalHtmlMime(),html);return true}catch(e){return false}}else{return false}};var setClipboardData=function(evt,data,fallback,done){if(setHtml5Clipboard(evt.clipboardData,data.html,data.text)){evt.preventDefault();done()}else{fallback(data.html,done)}};var fallback=function(editor){return function(html,done){var markedHtml=InternalHtml.mark(html);var outer=editor.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"});var inner=editor.dom.create("div",{contenteditable:"true"},markedHtml);editor.dom.setStyles(outer,{position:"fixed",left:"-3000px",width:"1000px",overflow:"hidden"});outer.appendChild(inner);editor.dom.add(editor.getBody(),outer);var range=editor.selection.getRng();inner.focus();var offscreenRange=editor.dom.createRng();offscreenRange.selectNodeContents(inner);editor.selection.setRng(offscreenRange);setTimeout(function(){outer.parentNode.removeChild(outer);editor.selection.setRng(range);done()},0)}};var getData=function(editor){return{html:editor.selection.getContent({contextual:true}),text:editor.selection.getContent({format:"text"})}};var cut=function(editor){return function(evt){if(editor.selection.isCollapsed()===false){setClipboardData(evt,getData(editor),fallback(editor),function(){setTimeout(function(){editor.execCommand("Delete")},0)})}}};var copy=function(editor){return function(evt){if(editor.selection.isCollapsed()===false){setClipboardData(evt,getData(editor),fallback(editor),noop)}}};var register=function(editor){editor.on("cut",cut(editor));editor.on("copy",copy(editor))};return{register:register}});define("tinymce.core.api.dom.RangeUtils",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.RangeUtils")});define("tinymce.plugins.paste.core.DragDrop",["tinymce.core.api.dom.RangeUtils","tinymce.core.util.Delay","tinymce.plugins.paste.api.Settings","tinymce.plugins.paste.core.InternalHtml","tinymce.plugins.paste.core.Utils"],function(RangeUtils,Delay,Settings,InternalHtml,Utils){var getCaretRangeFromEvent=function(editor,e){return RangeUtils.getCaretRangeFromPoint(e.clientX,e.clientY,editor.getDoc())};var isPlainTextFileUrl=function(content){var plainTextContent=content["text/plain"];return plainTextContent?plainTextContent.indexOf("file://")===0:false};var setFocusedRange=function(editor,rng){editor.focus();editor.selection.setRng(rng)};var setup=function(editor,clipboard,draggingInternallyState){if(Settings.shouldBlockDrop(editor)){editor.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault();e.stopPropagation()})}if(!Settings.shouldPasteDataImages(editor)){editor.on("drop",function(e){var dataTransfer=e.dataTransfer;if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length>0){e.preventDefault()}})}editor.on("drop",function(e){var dropContent,rng;rng=getCaretRangeFromEvent(editor,e);if(e.isDefaultPrevented()||draggingInternallyState.get()){return}dropContent=clipboard.getDataTransferItems(e.dataTransfer);var internal=clipboard.hasContentType(dropContent,InternalHtml.internalHtmlMime());if((!clipboard.hasHtmlOrText(dropContent)||isPlainTextFileUrl(dropContent))&&clipboard.pasteImageData(e,rng)){return}if(rng&&Settings.shouldFilterDrop(editor)){var content=dropContent["mce-internal"]||dropContent["text/html"]||dropContent["text/plain"];if(content){e.preventDefault();Delay.setEditorTimeout(editor,function(){editor.undoManager.transact(function(){if(dropContent["mce-internal"]){editor.execCommand("Delete")}setFocusedRange(editor,rng);content=Utils.trimHtml(content);if(!dropContent["text/html"]){clipboard.pasteText(content)}else{clipboard.pasteHtml(content,internal)}})})}}});editor.on("dragstart",function(e){draggingInternallyState.set(true)});editor.on("dragover dragend",function(e){if(Settings.shouldPasteDataImages(editor)&&draggingInternallyState.get()===false){e.preventDefault();setFocusedRange(editor,getCaretRangeFromEvent(editor,e))}if(e.type==="dragend"){draggingInternallyState.set(false)}})};return{setup:setup}});define("tinymce.plugins.paste.core.PrePostProcess",["tinymce.plugins.paste.api.Settings"],function(Settings){var setup=function(editor){var plugin=editor.plugins.paste;var preProcess=Settings.getPreProcess(editor);if(preProcess){editor.on("PastePreProcess",function(e){preProcess.call(plugin,plugin,e)})}var postProcess=Settings.getPostProcess(editor);if(postProcess){editor.on("PastePostProcess",function(e){postProcess.call(plugin,plugin,e)})}};return{setup:setup}});define("tinymce.plugins.paste.core.Quirks",["tinymce.core.Env","tinymce.core.util.Tools","tinymce.plugins.paste.api.Settings","tinymce.plugins.paste.core.Utils","tinymce.plugins.paste.core.WordFilter"],function(Env,Tools,Settings,Utils,WordFilter){function addPreProcessFilter(editor,filterFunc){editor.on("PastePreProcess",function(e){e.content=filterFunc(editor,e.content,e.internal,e.wordContent)})}function addPostProcessFilter(editor,filterFunc){editor.on("PastePostProcess",function(e){filterFunc(editor,e.node)})}function removeExplorerBrElementsAfterBlocks(editor,html){if(!WordFilter.isWordContent(html)){return html}var blockElements=[];Tools.each(editor.schema.getBlockElements(),function(block,blockName){blockElements.push(blockName)});var explorerBlocksRegExp=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+blockElements.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");html=Utils.filter(html,[[explorerBlocksRegExp,"$1"]]);html=Utils.filter(html,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]);return html}function removeWebKitStyles(editor,content,internal,isWordHtml){if(isWordHtml||internal){return content}var webKitStyles=Settings.getWebkitStyles(editor);if(Settings.shouldRemoveWebKitStyles(editor)===false||webKitStyles==="all"){return content}if(webKitStyles){webKitStyles=webKitStyles.split(/[, ]/)}if(webKitStyles){var dom=editor.dom,node=editor.selection.getNode();content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(all,before,value,after){var inputStyles=dom.parseStyle(dom.decode(value),"span");var outputStyles={};if(webKitStyles==="none"){return before+after}for(var i=0;i<webKitStyles.length;i++){var inputValue=inputStyles[webKitStyles[i]],currentValue=dom.getStyle(node,webKitStyles[i],true);if(/color/.test(webKitStyles[i])){inputValue=dom.toHex(inputValue);currentValue=dom.toHex(currentValue)}if(currentValue!==inputValue){outputStyles[webKitStyles[i]]=inputValue}}outputStyles=dom.serializeStyle(outputStyles,"span");if(outputStyles){return before+' style="'+outputStyles+'"'+after}return before+after})}else{content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3")}content=content.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(all,before,value,after){return before+' style="'+value+'"'+after});return content}function removeUnderlineAndFontInAnchor(editor,root){editor.$("a",root).find("font,u").each(function(i,node){editor.dom.remove(node,true)})}var setup=function(editor){if(Env.webkit){addPreProcessFilter(editor,removeWebKitStyles)}if(Env.ie){addPreProcessFilter(editor,removeExplorerBrElementsAfterBlocks);addPostProcessFilter(editor,removeUnderlineAndFontInAnchor)}};return{setup:setup}});defineGlobal("global!Array",Array);defineGlobal("global!Error",Error);define("ephox.katamari.api.Fun",["global!Array","global!Error"],function(Array,Error){var noop=function(){};var noarg=function(f){return function(){return f()}};var compose=function(fa,fb){return function(){return fa(fb.apply(null,arguments))}};var constant=function(value){return function(){return value}};var identity=function(x){return x};var tripleEquals=function(a,b){return a===b};var curry=function(f){var args=new Array(arguments.length-1);for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}return function(){var newArgs=new Array(arguments.length);for(var j=0;j<newArgs.length;j++){newArgs[j]=arguments[j]}var all=args.concat(newArgs);return f.apply(null,all)}};var not=function(f){return function(){return!f.apply(null,arguments)}};var die=function(msg){return function(){throw new Error(msg)}};var apply=function(f){return f()};var call=function(f){f()};var never=constant(false);var always=constant(true);return{noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always}});define("tinymce.plugins.paste.ui.Buttons",["ephox.katamari.api.Fun"],function(Fun){var stateChange=function(editor,clipboard,e){var ctrl=e.control;ctrl.active(clipboard.pasteFormat==="text");editor.on("PastePlainTextToggle",function(e){ctrl.active(e.state)})};var register=function(editor,clipboard){var postRender=Fun.curry(stateChange,editor,clipboard);editor.addButton("pastetext",{active:false,icon:"pastetext",tooltip:"Paste as text",cmd:"mceTogglePlainTextPaste",onPostRender:postRender});editor.addMenuItem("pastetext",{text:"Paste as text",selectable:true,active:clipboard.pasteFormat,cmd:"mceTogglePlainTextPaste",onPostRender:postRender})};return{register:register}});define("tinymce.plugins.paste.Plugin",["ephox.katamari.api.Cell","tinymce.core.PluginManager","tinymce.plugins.paste.alien.DetectProPlugin","tinymce.plugins.paste.api.Api","tinymce.plugins.paste.api.Commands","tinymce.plugins.paste.core.Clipboard","tinymce.plugins.paste.core.CutCopy","tinymce.plugins.paste.core.DragDrop","tinymce.plugins.paste.core.PrePostProcess","tinymce.plugins.paste.core.Quirks","tinymce.plugins.paste.ui.Buttons"],function(Cell,PluginManager,DetectProPlugin,Api,Commands,Clipboard,CutCopy,DragDrop,PrePostProcess,Quirks,Buttons){var userIsInformedState=Cell(false);PluginManager.add("paste",function(editor){if(DetectProPlugin.hasProPlugin(editor)===false){var clipboard=new Clipboard(editor);var quirks=Quirks.setup(editor);var draggingInternallyState=Cell(false);Buttons.register(editor,clipboard);Commands.register(editor,clipboard,userIsInformedState);PrePostProcess.setup(editor);CutCopy.register(editor);DragDrop.setup(editor,clipboard,draggingInternallyState);return Api.get(clipboard,quirks)}});return function(){}});dem("tinymce.plugins.paste.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};define("ephox.katamari.api.Cell",[],function(){var Cell=function(initial){var value=initial;var get=function(){return value};var set=function(v){value=v};var clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}};return Cell});defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});define("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Tools")});define("tinymce.plugins.searchreplace.core.FindReplaceText",[],function(){function isContentEditableFalse(node){return node&&node.nodeType===1&&node.contentEditable==="false"}function findAndReplaceDOMText(regex,node,replacementNode,captureGroup,schema){var m,matches=[],text,count=0,doc;var blockElementsMap,hiddenTextElementsMap,shortEndedElementsMap;doc=node.ownerDocument;blockElementsMap=schema.getBlockElements();hiddenTextElementsMap=schema.getWhiteSpaceElements();shortEndedElementsMap=schema.getShortEndedElements();function getMatchIndexes(m,captureGroup){captureGroup=captureGroup||0;if(!m[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}var index=m.index;if(captureGroup>0){var cg=m[captureGroup];if(!cg){throw"Invalid capture group"}index+=m[0].indexOf(cg);m[0]=cg}return[index,index+m[0].length,[m[0]]]}function getText(node){var txt;if(node.nodeType===3){return node.data}if(hiddenTextElementsMap[node.nodeName]&&!blockElementsMap[node.nodeName]){return""}txt="";if(isContentEditableFalse(node)){return"\n"}if(blockElementsMap[node.nodeName]||shortEndedElementsMap[node.nodeName]){txt+="\n"}if(node=node.firstChild){do{txt+=getText(node)}while(node=node.nextSibling)}return txt}function stepThroughMatches(node,matches,replaceFn){var startNode,endNode,startNodeIndex,endNodeIndex,innerNodes=[],atIndex=0,curNode=node,matchLocation=matches.shift(),matchIndex=0;out:while(true){if(blockElementsMap[curNode.nodeName]||shortEndedElementsMap[curNode.nodeName]||isContentEditableFalse(curNode)){atIndex++}if(curNode.nodeType===3){if(!endNode&&curNode.length+atIndex>=matchLocation[1]){endNode=curNode;endNodeIndex=matchLocation[1]-atIndex}else if(startNode){innerNodes.push(curNode)}if(!startNode&&curNode.length+atIndex>matchLocation[0]){startNode=curNode;startNodeIndex=matchLocation[0]-atIndex}atIndex+=curNode.length}if(startNode&&endNode){curNode=replaceFn({startNode:startNode,startNodeIndex:startNodeIndex,endNode:endNode,endNodeIndex:endNodeIndex,innerNodes:innerNodes,match:matchLocation[2],matchIndex:matchIndex});atIndex-=endNode.length-endNodeIndex;startNode=null;endNode=null;innerNodes=[];matchLocation=matches.shift();matchIndex++;if(!matchLocation){break}}else if((!hiddenTextElementsMap[curNode.nodeName]||blockElementsMap[curNode.nodeName])&&curNode.firstChild){if(!isContentEditableFalse(curNode)){curNode=curNode.firstChild;continue}}else if(curNode.nextSibling){curNode=curNode.nextSibling;continue}while(true){if(curNode.nextSibling){curNode=curNode.nextSibling;break}else if(curNode.parentNode!==node){curNode=curNode.parentNode}else{break out}}}}function genReplacer(nodeName){var makeReplacementNode;if(typeof nodeName!=="function"){var stencilNode=nodeName.nodeType?nodeName:doc.createElement(nodeName);makeReplacementNode=function(fill,matchIndex){var clone=stencilNode.cloneNode(false);clone.setAttribute("data-mce-index",matchIndex);if(fill){clone.appendChild(doc.createTextNode(fill))}return clone}}else{makeReplacementNode=nodeName}return function(range){var before,after,parentNode,startNode=range.startNode,endNode=range.endNode,matchIndex=range.matchIndex;if(startNode===endNode){var node=startNode;parentNode=node.parentNode;if(range.startNodeIndex>0){before=doc.createTextNode(node.data.substring(0,range.startNodeIndex));parentNode.insertBefore(before,node)}var el=makeReplacementNode(range.match[0],matchIndex);parentNode.insertBefore(el,node);if(range.endNodeIndex<node.length){after=doc.createTextNode(node.data.substring(range.endNodeIndex));parentNode.insertBefore(after,node)}node.parentNode.removeChild(node);return el}before=doc.createTextNode(startNode.data.substring(0,range.startNodeIndex));after=doc.createTextNode(endNode.data.substring(range.endNodeIndex));var elA=makeReplacementNode(startNode.data.substring(range.startNodeIndex),matchIndex);var innerEls=[];for(var i=0,l=range.innerNodes.length;i<l;++i){var innerNode=range.innerNodes[i];var innerEl=makeReplacementNode(innerNode.data,matchIndex);innerNode.parentNode.replaceChild(innerEl,innerNode);innerEls.push(innerEl)}var elB=makeReplacementNode(endNode.data.substring(0,range.endNodeIndex),matchIndex);parentNode=startNode.parentNode;parentNode.insertBefore(before,startNode);parentNode.insertBefore(elA,startNode);parentNode.removeChild(startNode);parentNode=endNode.parentNode;parentNode.insertBefore(elB,endNode);parentNode.insertBefore(after,endNode);parentNode.removeChild(endNode);return elB}}text=getText(node);if(!text){return}if(regex.global){while(m=regex.exec(text)){matches.push(getMatchIndexes(m,captureGroup))}}else{m=text.match(regex);matches.push(getMatchIndexes(m,captureGroup))}if(matches.length){count=matches.length;stepThroughMatches(node,matches,genReplacer(replacementNode))}return count}return{findAndReplaceDOMText:findAndReplaceDOMText}});define("tinymce.plugins.searchreplace.core.Actions",["tinymce.core.util.Tools","tinymce.plugins.searchreplace.core.FindReplaceText"],function(Tools,FindReplaceText){var getElmIndex=function(elm){var value=elm.getAttribute("data-mce-index");if(typeof value==="number"){return""+value}return value};var markAllMatches=function(editor,currentIndexState,regex){var node,marker;marker=editor.dom.create("span",{"data-mce-bogus":1});marker.className="mce-match-marker";node=editor.getBody();done(editor,currentIndexState,false);return FindReplaceText.findAndReplaceDOMText(regex,node,marker,false,editor.schema)};var unwrap=function(node){var parentNode=node.parentNode;if(node.firstChild){parentNode.insertBefore(node.firstChild,node)}node.parentNode.removeChild(node)};var findSpansByIndex=function(editor,index){var nodes,spans=[];nodes=Tools.toArray(editor.getBody().getElementsByTagName("span"));if(nodes.length){for(var i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);if(nodeIndex===null||!nodeIndex.length){continue}if(nodeIndex===index.toString()){spans.push(nodes[i])}}}return spans};var moveSelection=function(editor,currentIndexState,forward){var testIndex=currentIndexState.get(),dom=editor.dom;forward=forward!==false;if(forward){testIndex++}else{testIndex--}dom.removeClass(findSpansByIndex(editor,currentIndexState.get()),"mce-match-marker-selected");var spans=findSpansByIndex(editor,testIndex);if(spans.length){dom.addClass(findSpansByIndex(editor,testIndex),"mce-match-marker-selected");editor.selection.scrollIntoView(spans[0]);return testIndex}return-1};var removeNode=function(dom,node){var parent=node.parentNode;dom.remove(node);if(dom.isEmpty(parent)){dom.remove(parent)}};var find=function(editor,currentIndexState,text,matchCase,wholeWord){text=text.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");text=text.replace(/\s/g,"\\s");text=wholeWord?"\\b"+text+"\\b":text;var count=markAllMatches(editor,currentIndexState,new RegExp(text,matchCase?"g":"gi"));if(count){currentIndexState.set(-1);currentIndexState.set(moveSelection(editor,currentIndexState,true))}return count};var next=function(editor,currentIndexState){var index=moveSelection(editor,currentIndexState,true);if(index!==-1){currentIndexState.set(index)}};var prev=function(editor,currentIndexState){var index=moveSelection(editor,currentIndexState,false);if(index!==-1){currentIndexState.set(index)}};var isMatchSpan=function(node){var matchIndex=getElmIndex(node);return matchIndex!==null&&matchIndex.length>0};var replace=function(editor,currentIndexState,text,forward,all){var i,nodes,node,matchIndex,currentMatchIndex,nextIndex=currentIndexState.get(),hasMore;forward=forward!==false;node=editor.getBody();nodes=Tools.grep(Tools.toArray(node.getElementsByTagName("span")),isMatchSpan);for(i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);matchIndex=currentMatchIndex=parseInt(nodeIndex,10);if(all||matchIndex===currentIndexState.get()){if(text.length){nodes[i].firstChild.nodeValue=text;unwrap(nodes[i])}else{removeNode(editor.dom,nodes[i])}while(nodes[++i]){matchIndex=parseInt(getElmIndex(nodes[i]),10);if(matchIndex===currentMatchIndex){removeNode(editor.dom,nodes[i])}else{i--;break}}if(forward){nextIndex--}}else if(currentMatchIndex>currentIndexState.get()){nodes[i].setAttribute("data-mce-index",currentMatchIndex-1)}}currentIndexState.set(nextIndex);if(forward){hasMore=hasNext(editor,currentIndexState);next(editor,currentIndexState)}else{hasMore=hasPrev(editor,currentIndexState);prev(editor,currentIndexState)}return!all&&hasMore};var done=function(editor,currentIndexState,keepEditorSelection){var i,nodes,startContainer,endContainer;nodes=Tools.toArray(editor.getBody().getElementsByTagName("span"));for(i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);if(nodeIndex!==null&&nodeIndex.length){if(nodeIndex===currentIndexState.get().toString()){if(!startContainer){startContainer=nodes[i].firstChild}endContainer=nodes[i].firstChild}unwrap(nodes[i])}}if(startContainer&&endContainer){var rng=editor.dom.createRng();rng.setStart(startContainer,0);rng.setEnd(endContainer,endContainer.data.length);if(keepEditorSelection!==false){editor.selection.setRng(rng)}return rng}};var hasNext=function(editor,currentIndexState){return findSpansByIndex(editor,currentIndexState.get()+1).length>0};var hasPrev=function(editor,currentIndexState){return findSpansByIndex(editor,currentIndexState.get()-1).length>0};return{done:done,find:find,next:next,prev:prev,replace:replace,hasNext:hasNext,hasPrev:hasPrev}});define("tinymce.plugins.searchreplace.api.Api",["tinymce.plugins.searchreplace.core.Actions"],function(Actions){var get=function(editor,currentIndexState){var done=function(keepEditorSelection){return Actions.done(editor,currentIndexState,keepEditorSelection)};var find=function(text,matchCase,wholeWord){return Actions.find(editor,currentIndexState,text,matchCase,wholeWord)};var next=function(){return Actions.next(editor,currentIndexState)};var prev=function(){return Actions.prev(editor,currentIndexState)};var replace=function(text,forward,all){return Actions.replace(editor,currentIndexState,text,forward,all)};return{done:done,find:find,next:next,prev:prev,replace:replace}};return{get:get}});define("tinymce.plugins.searchreplace.ui.Dialog",["tinymce.core.util.Tools","tinymce.plugins.searchreplace.core.Actions"],function(Tools,Actions){var open=function(editor,currentIndexState){var last={},selectedText;editor.undoManager.add();selectedText=Tools.trim(editor.selection.getContent({format:"text"}));function updateButtonStates(){win.statusbar.find("#next").disabled(Actions.hasNext(editor,currentIndexState)===false);win.statusbar.find("#prev").disabled(Actions.hasPrev(editor,currentIndexState)===false)}function notFoundAlert(){editor.windowManager.alert("Could not find the specified string.",function(){win.find("#find")[0].focus()})}var win=editor.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){editor.focus();Actions.done(editor,currentIndexState);editor.undoManager.add()},onSubmit:function(e){var count,caseState,text,wholeWord;e.preventDefault();caseState=win.find("#case").checked();wholeWord=win.find("#words").checked();text=win.find("#find").value();if(!text.length){Actions.done(editor,currentIndexState,false);win.statusbar.items().slice(1).disabled(true);return}if(last.text===text&&last.caseState===caseState&&last.wholeWord===wholeWord){if(!Actions.hasNext(editor,currentIndexState)){notFoundAlert();return}Actions.next(editor,currentIndexState);updateButtonStates();return}count=Actions.find(editor,currentIndexState,text,caseState,wholeWord);if(!count){notFoundAlert()}win.statusbar.items().slice(1).disabled(count===0);updateButtonStates();last={text:text,caseState:caseState,wholeWord:wholeWord}},buttons:[{text:"Find",subtype:"primary",onclick:function(){win.submit()}},{text:"Replace",disabled:true,onclick:function(){if(!Actions.replace(editor,currentIndexState,win.find("#replace").value())){win.statusbar.items().slice(1).disabled(true);currentIndexState.set(-1);last={}}}},{text:"Replace all",disabled:true,onclick:function(){Actions.replace(editor,currentIndexState,win.find("#replace").value(),true,true);win.statusbar.items().slice(1).disabled(true);last={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:true,onclick:function(){Actions.prev(editor,currentIndexState);updateButtonStates()}},{text:"Next",name:"next",disabled:true,onclick:function(){Actions.next(editor,currentIndexState);updateButtonStates()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:selectedText},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})};return{open:open}});define("tinymce.plugins.searchreplace.api.Commands",["tinymce.plugins.searchreplace.ui.Dialog"],function(Dialog){var register=function(editor,currentIndexState){editor.addCommand("SearchReplace",function(){Dialog.open(editor,currentIndexState)})};return{register:register}});define("tinymce.plugins.searchreplace.ui.Buttons",["tinymce.plugins.searchreplace.ui.Dialog"],function(Dialog){var showDialog=function(editor,currentIndexState){return function(){Dialog.open(editor,currentIndexState)}};var register=function(editor,currentIndexState){editor.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:showDialog(editor,currentIndexState),separator:"before",context:"edit"});editor.addButton("searchreplace",{tooltip:"Find and replace",onclick:showDialog(editor,currentIndexState)});editor.shortcuts.add("Meta+F","",showDialog(editor,currentIndexState))};return{register:register}});define("tinymce.plugins.searchreplace.Plugin",["ephox.katamari.api.Cell","tinymce.core.PluginManager","tinymce.plugins.searchreplace.api.Api","tinymce.plugins.searchreplace.api.Commands","tinymce.plugins.searchreplace.ui.Buttons"],function(Cell,PluginManager,Api,Commands,Buttons){PluginManager.add("searchreplace",function(editor){var currentIndexState=Cell(-1);Commands.register(editor,currentIndexState);Buttons.register(editor,currentIndexState);return Api.get(editor,currentIndexState)});return function(){}});dem("tinymce.plugins.searchreplace.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});defineGlobal("global!Array",Array);defineGlobal("global!Error",Error);define("ephox.katamari.api.Fun",["global!Array","global!Error"],function(Array,Error){var noop=function(){};var noarg=function(f){return function(){return f()}};var compose=function(fa,fb){return function(){return fa(fb.apply(null,arguments))}};var constant=function(value){return function(){return value}};var identity=function(x){return x};var tripleEquals=function(a,b){return a===b};var curry=function(f){var args=new Array(arguments.length-1);for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}return function(){var newArgs=new Array(arguments.length);for(var j=0;j<newArgs.length;j++){newArgs[j]=arguments[j]}var all=args.concat(newArgs);return f.apply(null,all)}};var not=function(f){return function(){return!f.apply(null,arguments)}};var die=function(msg){return function(){throw new Error(msg)}};var apply=function(f){return f()};var call=function(f){f()};var never=constant(false);var always=constant(true);return{noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always}});defineGlobal("global!Object",Object);define("ephox.katamari.api.Option",["ephox.katamari.api.Fun","global!Object"],function(Fun,Object){var never=Fun.never;var always=Fun.always;var none=function(){return NONE};var NONE=function(){var eq=function(o){return o.isNone()};var call=function(thunk){return thunk()};var id=function(n){return n};var noop=function(){};var me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},or:id,orThunk:call,map:none,ap:none,each:noop,bind:none,flatten:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:Fun.constant("none()")};if(Object.freeze){Object.freeze(me)}return me}();var some=function(a){var constant_a=function(){return a};var self=function(){return me};var map=function(f){return some(f(a))};var bind=function(f){return f(a)};var me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,or:self,orThunk:self,map:map,ap:function(optfab){return optfab.fold(none,function(fab){return some(fab(a))})},each:function(f){f(a)},bind:bind,flatten:constant_a,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return me};var from=function(value){return value===null||value===undefined?NONE:some(value)};return{some:some,none:none,from:from}});defineGlobal("global!String",String);define("ephox.katamari.api.Arr",["ephox.katamari.api.Option","global!Array","global!Error","global!String"],function(Option,Array,Error,String){var rawIndexOf=function(){var pIndexOf=Array.prototype.indexOf;var fastIndex=function(xs,x){return pIndexOf.call(xs,x)};var slowIndex=function(xs,x){return slowIndexOf(xs,x)};return pIndexOf===undefined?slowIndex:fastIndex}();var indexOf=function(xs,x){var r=rawIndexOf(xs,x);return r===-1?Option.none():Option.some(r)};var contains=function(xs,x){return rawIndexOf(xs,x)>-1};var exists=function(xs,pred){return findIndex(xs,pred).isSome()};var range=function(num,f){var r=[];for(var i=0;i<num;i++){r.push(f(i))}return r};var chunk=function(array,size){var r=[];for(var i=0;i<array.length;i+=size){var s=array.slice(i,i+size);r.push(s)}return r};var map=function(xs,f){var len=xs.length;var r=new Array(len);for(var i=0;i<len;i++){var x=xs[i];r[i]=f(x,i,xs)}return r};var each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];f(x,i,xs)}};var eachr=function(xs,f){for(var i=xs.length-1;i>=0;i--){var x=xs[i];f(x,i,xs)}};var partition=function(xs,pred){var pass=[];var fail=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];var arr=pred(x,i,xs)?pass:fail;arr.push(x)}return{pass:pass,fail:fail}};var filter=function(xs,pred){var r=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs)){r.push(x)}}return r};var groupBy=function(xs,f){if(xs.length===0){return[]}else{var wasType=f(xs[0]);var r=[];var group=[];for(var i=0,len=xs.length;i<len;i++){var x=xs[i];var type=f(x);if(type!==wasType){r.push(group);group=[]}wasType=type;group.push(x)}if(group.length!==0){r.push(group)}return r}};var foldr=function(xs,f,acc){eachr(xs,function(x){acc=f(acc,x)});return acc};var foldl=function(xs,f,acc){each(xs,function(x){acc=f(acc,x)});return acc};var find=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs)){return Option.some(x)}}return Option.none()};var findIndex=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs)){return Option.some(i)}}return Option.none()};var slowIndexOf=function(xs,x){for(var i=0,len=xs.length;i<len;++i){if(xs[i]===x){return i}}return-1};var push=Array.prototype.push;var flatten=function(xs){var r=[];for(var i=0,len=xs.length;i<len;++i){if(!Array.prototype.isPrototypeOf(xs[i])){throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs)}push.apply(r,xs[i])}return r};var bind=function(xs,f){var output=map(xs,f);return flatten(output)};var forall=function(xs,pred){for(var i=0,len=xs.length;i<len;++i){var x=xs[i];if(pred(x,i,xs)!==true){return false}}return true};var equal=function(a1,a2){return a1.length===a2.length&&forall(a1,function(x,i){return x===a2[i]})};var slice=Array.prototype.slice;var reverse=function(xs){var r=slice.call(xs,0);r.reverse();return r};var difference=function(a1,a2){return filter(a1,function(x){return!contains(a2,x)})};var mapToObject=function(xs,f){var r={};for(var i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r};var pure=function(x){return[x]};var sort=function(xs,comparator){var copy=slice.call(xs,0);copy.sort(comparator);return copy};var head=function(xs){return xs.length===0?Option.none():Option.some(xs[0])};var last=function(xs){return xs.length===0?Option.none():Option.some(xs[xs.length-1])};return{map:map,each:each,eachr:eachr,partition:partition,filter:filter,groupBy:groupBy,indexOf:indexOf,foldr:foldr,foldl:foldl,find:find,findIndex:findIndex,flatten:flatten,bind:bind,forall:forall,exists:exists,contains:contains,equal:equal,reverse:reverse,chunk:chunk,difference:difference,mapToObject:mapToObject,pure:pure,sort:sort,range:range,head:head,last:last}});define("ephox.katamari.api.Obj",["ephox.katamari.api.Option","global!Object"],function(Option,Object){var keys=function(){var fastKeys=Object.keys;var slowKeys=function(o){var r=[];for(var i in o){if(o.hasOwnProperty(i)){r.push(i)}}return r};return fastKeys===undefined?slowKeys:fastKeys}();var each=function(obj,f){var props=keys(obj);for(var k=0,len=props.length;k<len;k++){var i=props[k];var x=obj[i];f(x,i,obj)}};var objectMap=function(obj,f){return tupleMap(obj,function(x,i,obj){return{k:i,v:f(x,i,obj)}})};var tupleMap=function(obj,f){var r={};each(obj,function(x,i){var tuple=f(x,i,obj);r[tuple.k]=tuple.v});return r};var bifilter=function(obj,pred){var t={};var f={};each(obj,function(x,i){var branch=pred(x,i)?t:f;branch[i]=x});return{t:t,f:f}};var mapToArray=function(obj,f){var r=[];each(obj,function(value,name){r.push(f(value,name))});return r};var find=function(obj,pred){var props=keys(obj);for(var k=0,len=props.length;k<len;k++){var i=props[k];var x=obj[i];if(pred(x,i,obj)){return Option.some(x)}}return Option.none()};var values=function(obj){return mapToArray(obj,function(v){return v})};var size=function(obj){return values(obj).length};return{bifilter:bifilter,each:each,map:objectMap,mapToArray:mapToArray,tupleMap:tupleMap,find:find,keys:keys,values:values,size:size}});define("ephox.katamari.data.Immutable",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","global!Array","global!Error"],function(Arr,Fun,Array,Error){return function(){var fields=arguments;return function(){var values=new Array(arguments.length);for(var i=0;i<values.length;i++){values[i]=arguments[i]}if(fields.length!==values.length){throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments")}var struct={};Arr.each(fields,function(name,i){struct[name]=Fun.constant(values[i])});return struct}}});define("ephox.katamari.api.Type",["global!Array","global!String"],function(Array,String){var typeOf=function(x){if(x===null){return"null"}var t=typeof x;if(t==="object"&&Array.prototype.isPrototypeOf(x)){return"array"}if(t==="object"&&String.prototype.isPrototypeOf(x)){return"string"}return t};var isType=function(type){return function(value){return typeOf(value)===type}};return{isString:isType("string"),isObject:isType("object"),isArray:isType("array"),isNull:isType("null"),isBoolean:isType("boolean"),isUndefined:isType("undefined"),isFunction:isType("function"),isNumber:isType("number")}});define("ephox.katamari.util.BagUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Type","global!Error"],function(Arr,Type,Error){var sort=function(arr){return arr.slice(0).sort()};var reqMessage=function(required,keys){throw new Error("All required keys ("+sort(required).join(", ")+") were not specified. Specified keys were: "+sort(keys).join(", ")+".")};var unsuppMessage=function(unsupported){throw new Error("Unsupported keys for object: "+sort(unsupported).join(", "))};var validateStrArr=function(label,array){if(!Type.isArray(array)){throw new Error("The "+label+" fields must be an array. Was: "+array+".")}Arr.each(array,function(a){if(!Type.isString(a)){throw new Error("The value "+a+" in the "+label+" fields was not a string.")}})};var invalidTypeMessage=function(incorrect,type){throw new Error("All values need to be of type: "+type+". Keys ("+sort(incorrect).join(", ")+") were not.")};var checkDupes=function(everything){var sorted=sort(everything);var dupe=Arr.find(sorted,function(s,i){return i<sorted.length-1&&s===sorted[i+1]});dupe.each(function(d){throw new Error("The field: "+d+" occurs more than once in the combined fields: ["+sorted.join(", ")+"].")})};return{sort:sort,reqMessage:reqMessage,unsuppMessage:unsuppMessage,validateStrArr:validateStrArr,invalidTypeMessage:invalidTypeMessage,checkDupes:checkDupes}});define("ephox.katamari.data.MixedBag",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.katamari.util.BagUtils","global!Error","global!Object"],function(Arr,Fun,Obj,Option,BagUtils,Error,Object){return function(required,optional){var everything=required.concat(optional);if(everything.length===0){throw new Error("You must specify at least one required or optional field.")}BagUtils.validateStrArr("required",required);BagUtils.validateStrArr("optional",optional);BagUtils.checkDupes(everything);return function(obj){var keys=Obj.keys(obj);var allReqd=Arr.forall(required,function(req){return Arr.contains(keys,req)});if(!allReqd){BagUtils.reqMessage(required,keys)}var unsupported=Arr.filter(keys,function(key){return!Arr.contains(everything,key)});if(unsupported.length>0){BagUtils.unsuppMessage(unsupported)}var r={};Arr.each(required,function(req){r[req]=Fun.constant(obj[req])});Arr.each(optional,function(opt){r[opt]=Fun.constant(Object.prototype.hasOwnProperty.call(obj,opt)?Option.some(obj[opt]):Option.none())});return r}}});define("ephox.katamari.api.Struct",["ephox.katamari.data.Immutable","ephox.katamari.data.MixedBag"],function(Immutable,MixedBag){return{immutable:Immutable,immutableBag:MixedBag}});define("ephox.snooker.api.Structs",["ephox.katamari.api.Struct"],function(Struct){var dimensions=Struct.immutable("width","height");var grid=Struct.immutable("rows","columns");var address=Struct.immutable("row","column");var coords=Struct.immutable("x","y");var detail=Struct.immutable("element","rowspan","colspan");var detailnew=Struct.immutable("element","rowspan","colspan","isNew");var extended=Struct.immutable("element","rowspan","colspan","row","column");var rowdata=Struct.immutable("element","cells","section");var elementnew=Struct.immutable("element","isNew");var rowdatanew=Struct.immutable("element","cells","section","isNew");var rowcells=Struct.immutable("cells","section");var rowdetails=Struct.immutable("details","section");var bounds=Struct.immutable("startRow","startCol","finishRow","finishCol");return{dimensions:dimensions,grid:grid,address:address,coords:coords,extended:extended,detail:detail,detailnew:detailnew,rowdata:rowdata,elementnew:elementnew,rowdatanew:rowdatanew,rowcells:rowcells,rowdetails:rowdetails,bounds:bounds}});define("global!console",[],function(){if(typeof console==="undefined"){console={log:function(){}}}return console});defineGlobal("global!document",document);define("ephox.sugar.api.node.Element",["ephox.katamari.api.Fun","ephox.katamari.api.Option","global!Error","global!console","global!document"],function(Fun,Option,Error,console,document){var fromHtml=function(html,scope){var doc=scope||document;var div=doc.createElement("div");div.innerHTML=html;if(!div.hasChildNodes()||div.childNodes.length>1){console.error("HTML does not have a single root node",html);throw"HTML must have a single root node"}return fromDom(div.childNodes[0])};var fromTag=function(tag,scope){var doc=scope||document;var node=doc.createElement(tag);return fromDom(node)};var fromText=function(text,scope){var doc=scope||document;var node=doc.createTextNode(text);return fromDom(node)};var fromDom=function(node){if(node===null||node===undefined){throw new Error("Node cannot be null or undefined")}return{dom:Fun.constant(node)}};var fromPoint=function(doc,x,y){return Option.from(doc.dom().elementFromPoint(x,y)).map(fromDom)};return{fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,fromPoint:fromPoint}});define("ephox.sugar.api.node.NodeTypes",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}});define("ephox.sugar.api.search.Selectors",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.node.NodeTypes","global!Error","global!document"],function(Arr,Option,Element,NodeTypes,Error,document){var ELEMENT=NodeTypes.ELEMENT;var DOCUMENT=NodeTypes.DOCUMENT;var is=function(element,selector){var elem=element.dom();if(elem.nodeType!==ELEMENT){return false}else if(elem.matches!==undefined){return elem.matches(selector)}else if(elem.msMatchesSelector!==undefined){return elem.msMatchesSelector(selector)}else if(elem.webkitMatchesSelector!==undefined){return elem.webkitMatchesSelector(selector)}else if(elem.mozMatchesSelector!==undefined){return elem.mozMatchesSelector(selector)}else{throw new Error("Browser lacks native selectors")}};var bypassSelector=function(dom){return dom.nodeType!==ELEMENT&&dom.nodeType!==DOCUMENT||dom.childElementCount===0};var all=function(selector,scope){var base=scope===undefined?document:scope.dom();return bypassSelector(base)?[]:Arr.map(base.querySelectorAll(selector),Element.fromDom)};var one=function(selector,scope){var base=scope===undefined?document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map(Element.fromDom)};return{all:all,is:is,one:one}});define("ephox.sugar.alien.Recurse",[],function(){var toArray=function(target,f){var r=[];var recurse=function(e){r.push(e);return f(e)};var cur=f(target);do{cur=cur.bind(recurse)}while(cur.isSome());return r};return{toArray:toArray}});define("ephox.katamari.api.Global",[],function(){var global=typeof window!=="undefined"?window:Function("return this;")();return global});define("ephox.katamari.api.Resolve",["ephox.katamari.api.Global"],function(Global){var path=function(parts,scope){var o=scope!==undefined?scope:Global;for(var i=0;i<parts.length&&o!==undefined&&o!==null;++i){o=o[parts[i]]}return o};var resolve=function(p,scope){var parts=p.split(".");return path(parts,scope)};var step=function(o,part){if(o[part]===undefined||o[part]===null){o[part]={}}return o[part]};var forge=function(parts,target){var o=target!==undefined?target:Global;for(var i=0;i<parts.length;++i){o=step(o,parts[i])}return o};var namespace=function(name,target){var parts=name.split(".");return forge(parts,target)};return{path:path,resolve:resolve,forge:forge,namespace:namespace}});define("ephox.sand.util.Global",["ephox.katamari.api.Resolve"],function(Resolve){var unsafe=function(name,scope){return Resolve.resolve(name,scope)};var getOrDie=function(name,scope){var actual=unsafe(name,scope);if(actual===undefined){throw name+" not available on this browser"}return actual};return{getOrDie:getOrDie}});define("ephox.sand.api.Node",["ephox.sand.util.Global"],function(Global){var node=function(){var f=Global.getOrDie("Node");return f};var compareDocumentPosition=function(a,b,match){return(a.compareDocumentPosition(b)&match)!==0};var documentPositionPreceding=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_PRECEDING)};var documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_CONTAINED_BY)};return{documentPositionPreceding:documentPositionPreceding,documentPositionContainedBy:documentPositionContainedBy}});define("ephox.katamari.api.Thunk",[],function(){var cached=function(f){var called=false;var r;return function(){if(!called){called=true;r=f.apply(null,arguments)}return r}};return{cached:cached}});defineGlobal("global!Number",Number);define("ephox.sand.detect.Version",["ephox.katamari.api.Arr","global!Number","global!String"],function(Arr,Number,String){var firstMatch=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s)){return x}}return undefined};var find=function(regexes,agent){var r=firstMatch(regexes,agent);if(!r){return{major:0,minor:0}}var group=function(i){return Number(agent.replace(r,"$"+i))};return nu(group(1),group(2))};var detect=function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();if(versionRegexes.length===0){return unknown()}return find(versionRegexes,cleanedAgent)};var unknown=function(){return nu(0,0)};var nu=function(major,minor){return{major:major,minor:minor}};return{nu:nu,detect:detect,unknown:unknown}});define("ephox.sand.core.Browser",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(Fun,Version){var edge="Edge";var chrome="Chrome";var ie="IE";var opera="Opera";var firefox="Firefox";var safari="Safari";var isBrowser=function(name,current){return function(){return current===name}};var unknown=function(){return nu({current:undefined,version:Version.unknown()})};var nu=function(info){var current=info.current;var version=info.version;return{current:current,version:version,isEdge:isBrowser(edge,current),isChrome:isBrowser(chrome,current),isIE:isBrowser(ie,current),isOpera:isBrowser(opera,current),isFirefox:isBrowser(firefox,current),isSafari:isBrowser(safari,current)}};return{unknown:unknown,nu:nu,edge:Fun.constant(edge),chrome:Fun.constant(chrome),ie:Fun.constant(ie),opera:Fun.constant(opera),firefox:Fun.constant(firefox),safari:Fun.constant(safari)}});define("ephox.sand.core.OperatingSystem",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(Fun,Version){var windows="Windows";var ios="iOS";var android="Android";var linux="Linux";var osx="OSX";var solaris="Solaris";var freebsd="FreeBSD";var isOS=function(name,current){return function(){return current===name}};var unknown=function(){return nu({current:undefined,version:Version.unknown()})};var nu=function(info){var current=info.current;var version=info.version;return{current:current,version:version,isWindows:isOS(windows,current),isiOS:isOS(ios,current),isAndroid:isOS(android,current),isOSX:isOS(osx,current),isLinux:isOS(linux,current),isSolaris:isOS(solaris,current),isFreeBSD:isOS(freebsd,current)}};return{unknown:unknown,nu:nu,windows:Fun.constant(windows),ios:Fun.constant(ios),android:Fun.constant(android),linux:Fun.constant(linux),osx:Fun.constant(osx),solaris:Fun.constant(solaris),freebsd:Fun.constant(freebsd)}});define("ephox.sand.detect.DeviceType",["ephox.katamari.api.Fun"],function(Fun){return function(os,browser,userAgent){var isiPad=os.isiOS()&&/ipad/i.test(userAgent)===true;var isiPhone=os.isiOS()&&!isiPad;var isAndroid3=os.isAndroid()&&os.version.major===3;var isAndroid4=os.isAndroid()&&os.version.major===4;var isTablet=isiPad||isAndroid3||isAndroid4&&/mobile/i.test(userAgent)===true;var isTouch=os.isiOS()||os.isAndroid();var isPhone=isTouch&&!isTablet;var iOSwebview=browser.isSafari()&&os.isiOS()&&/safari/i.test(userAgent)===false;return{isiPad:Fun.constant(isiPad),isiPhone:Fun.constant(isiPhone),isTablet:Fun.constant(isTablet),isPhone:Fun.constant(isPhone),isTouch:Fun.constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:Fun.constant(iOSwebview)}}});define("ephox.sand.detect.UaString",["ephox.katamari.api.Arr","ephox.sand.detect.Version","global!String"],function(Arr,Version,String){var detect=function(candidates,userAgent){var agent=String(userAgent).toLowerCase();return Arr.find(candidates,function(candidate){return candidate.search(agent)})};var detectBrowser=function(browsers,userAgent){return detect(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})};var detectOs=function(oses,userAgent){return detect(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})};return{detectBrowser:detectBrowser,detectOs:detectOs}});define("ephox.katamari.str.StrAppend",[],function(){var addToStart=function(str,prefix){return prefix+str};var addToEnd=function(str,suffix){return str+suffix};var removeFromStart=function(str,numChars){return str.substring(numChars)};var removeFromEnd=function(str,numChars){return str.substring(0,str.length-numChars)};return{addToStart:addToStart,addToEnd:addToEnd,removeFromStart:removeFromStart,removeFromEnd:removeFromEnd}});define("ephox.katamari.str.StringParts",["ephox.katamari.api.Option","global!Error"],function(Option,Error){var first=function(str,count){return str.substr(0,count)};var last=function(str,count){return str.substr(str.length-count,str.length)};var head=function(str){return str===""?Option.none():Option.some(str.substr(0,1))};var tail=function(str){return str===""?Option.none():Option.some(str.substring(1))};return{first:first,last:last,head:head,tail:tail}});define("ephox.katamari.api.Strings",["ephox.katamari.str.StrAppend","ephox.katamari.str.StringParts","global!Error"],function(StrAppend,StringParts,Error){var checkRange=function(str,substr,start){if(substr===""){return true}if(str.length<substr.length){return false}var x=str.substr(start,start+substr.length);return x===substr};var supplant=function(str,obj){var isStringOrNumber=function(a){var t=typeof a;return t==="string"||t==="number"};return str.replace(/\${([^{}]*)}/g,function(a,b){var value=obj[b];return isStringOrNumber(value)?value:a})};var removeLeading=function(str,prefix){return startsWith(str,prefix)?StrAppend.removeFromStart(str,prefix.length):str};var removeTrailing=function(str,prefix){return endsWith(str,prefix)?StrAppend.removeFromEnd(str,prefix.length):str};var ensureLeading=function(str,prefix){return startsWith(str,prefix)?str:StrAppend.addToStart(str,prefix)};var ensureTrailing=function(str,prefix){return endsWith(str,prefix)?str:StrAppend.addToEnd(str,prefix)};var contains=function(str,substr){return str.indexOf(substr)!==-1};var capitalize=function(str){return StringParts.head(str).bind(function(head){return StringParts.tail(str).map(function(tail){return head.toUpperCase()+tail})}).getOr(str)};var startsWith=function(str,prefix){return checkRange(str,prefix,0)};var endsWith=function(str,suffix){return checkRange(str,suffix,str.length-suffix.length)};var trim=function(str){return str.replace(/^\s+|\s+$/g,"")};var lTrim=function(str){return str.replace(/^\s+/g,"")};var rTrim=function(str){return str.replace(/\s+$/g,"")};return{supplant:supplant,startsWith:startsWith,removeLeading:removeLeading,removeTrailing:removeTrailing,ensureLeading:ensureLeading,ensureTrailing:ensureTrailing,endsWith:endsWith,contains:contains,trim:trim,lTrim:lTrim,rTrim:rTrim,capitalize:capitalize}});define("ephox.sand.info.PlatformInfo",["ephox.katamari.api.Fun","ephox.katamari.api.Strings"],function(Fun,Strings){var normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;var checkContains=function(target){return function(uastring){return Strings.contains(uastring,target)}};var browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){var monstrosity=Strings.contains(uastring,"edge/")&&Strings.contains(uastring,"chrome")&&Strings.contains(uastring,"safari")&&Strings.contains(uastring,"applewebkit");return monstrosity}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return Strings.contains(uastring,"chrome")&&!Strings.contains(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return Strings.contains(uastring,"msie")||Strings.contains(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(Strings.contains(uastring,"safari")||Strings.contains(uastring,"mobile/"))&&Strings.contains(uastring,"applewebkit")}}];var oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return Strings.contains(uastring,"iphone")||Strings.contains(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]}];return{browsers:Fun.constant(browsers),oses:Fun.constant(oses)}});define("ephox.sand.core.PlatformDetection",["ephox.sand.core.Browser","ephox.sand.core.OperatingSystem","ephox.sand.detect.DeviceType","ephox.sand.detect.UaString","ephox.sand.info.PlatformInfo"],function(Browser,OperatingSystem,DeviceType,UaString,PlatformInfo){var detect=function(userAgent){var browsers=PlatformInfo.browsers();var oses=PlatformInfo.oses();var browser=UaString.detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu);var os=UaString.detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu);var deviceType=DeviceType(os,browser,userAgent);return{browser:browser,os:os,deviceType:deviceType}};return{detect:detect}});defineGlobal("global!navigator",navigator);define("ephox.sand.api.PlatformDetection",["ephox.katamari.api.Thunk","ephox.sand.core.PlatformDetection","global!navigator"],function(Thunk,PlatformDetection,navigator){var detect=Thunk.cached(function(){var userAgent=navigator.userAgent;return PlatformDetection.detect(userAgent)});return{detect:detect}});define("ephox.sugar.api.dom.Compare",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sand.api.Node","ephox.sand.api.PlatformDetection","ephox.sugar.api.search.Selectors"],function(Arr,Fun,Node,PlatformDetection,Selectors){var eq=function(e1,e2){return e1.dom()===e2.dom()};var isEqualNode=function(e1,e2){return e1.dom().isEqualNode(e2.dom())};var member=function(element,elements){return Arr.exists(elements,Fun.curry(eq,element))};var regularContains=function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1===d2?false:d1.contains(d2)};var ieContains=function(e1,e2){return Node.documentPositionContainedBy(e1.dom(),e2.dom())};var browser=PlatformDetection.detect().browser;var contains=browser.isIE()?ieContains:regularContains;return{eq:eq,isEqualNode:isEqualNode,member:member,contains:contains,is:Selectors.is}});define("ephox.sugar.api.search.Traverse",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.alien.Recurse","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(Type,Arr,Fun,Option,Struct,Recurse,Compare,Element){var owner=function(element){return Element.fromDom(element.dom().ownerDocument)};var documentElement=function(element){var doc=owner(element);return Element.fromDom(doc.dom().documentElement)};var defaultView=function(element){var el=element.dom();var defaultView=el.ownerDocument.defaultView;return Element.fromDom(defaultView)};var parent=function(element){var dom=element.dom();return Option.from(dom.parentNode).map(Element.fromDom)};var findIndex=function(element){return parent(element).bind(function(p){var kin=children(p);return Arr.findIndex(kin,function(elem){return Compare.eq(element,elem)})})};var parents=function(element,isRoot){var stop=Type.isFunction(isRoot)?isRoot:Fun.constant(false);var dom=element.dom();var ret=[];while(dom.parentNode!==null&&dom.parentNode!==undefined){var rawParent=dom.parentNode;var parent=Element.fromDom(rawParent);ret.push(parent);if(stop(parent)===true){break}else{dom=rawParent}}return ret};var siblings=function(element){var filterSelf=function(elements){return Arr.filter(elements,function(x){return!Compare.eq(element,x)})};return parent(element).map(children).map(filterSelf).getOr([])};var offsetParent=function(element){var dom=element.dom();return Option.from(dom.offsetParent).map(Element.fromDom)};var prevSibling=function(element){var dom=element.dom();return Option.from(dom.previousSibling).map(Element.fromDom)};var nextSibling=function(element){var dom=element.dom();return Option.from(dom.nextSibling).map(Element.fromDom)};var prevSiblings=function(element){return Arr.reverse(Recurse.toArray(element,prevSibling))};var nextSiblings=function(element){return Recurse.toArray(element,nextSibling)};var children=function(element){var dom=element.dom();return Arr.map(dom.childNodes,Element.fromDom)};var child=function(element,index){var children=element.dom().childNodes;return Option.from(children[index]).map(Element.fromDom)};var firstChild=function(element){return child(element,0)};var lastChild=function(element){return child(element,element.dom().childNodes.length-1)};var childNodesCount=function(element){return element.dom().childNodes.length};var hasChildNodes=function(element){return element.dom().hasChildNodes()};var spot=Struct.immutable("element","offset");var leaf=function(element,offset){var cs=children(element);return cs.length>0&&offset<cs.length?spot(cs[offset],0):spot(element,offset)};return{owner:owner,defaultView:defaultView,documentElement:documentElement,parent:parent,findIndex:findIndex,parents:parents,siblings:siblings,prevSibling:prevSibling,offsetParent:offsetParent,prevSiblings:prevSiblings,nextSibling:nextSibling,nextSiblings:nextSiblings,children:children,child:child,firstChild:firstChild,lastChild:lastChild,childNodesCount:childNodesCount,hasChildNodes:hasChildNodes,leaf:leaf}});define("ephox.snooker.util.LayerSelector",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.search.Selectors","ephox.sugar.api.search.Traverse"],function(Arr,Fun,Selectors,Traverse){var firstLayer=function(scope,selector){return filterFirstLayer(scope,selector,Fun.constant(true))};var filterFirstLayer=function(scope,selector,predicate){return Arr.bind(Traverse.children(scope),function(x){return Selectors.is(x,selector)?predicate(x)?[x]:[]:filterFirstLayer(x,selector,predicate)})};return{firstLayer:firstLayer,filterFirstLayer:filterFirstLayer}});define("ephox.sugar.api.node.Node",["ephox.sugar.api.node.NodeTypes"],function(NodeTypes){var name=function(element){var r=element.dom().nodeName;return r.toLowerCase()};var type=function(element){return element.dom().nodeType};var value=function(element){return element.dom().nodeValue};var isType=function(t){return function(element){return type(element)===t}};var isComment=function(element){return type(element)===NodeTypes.COMMENT||name(element)==="#comment"};var isElement=isType(NodeTypes.ELEMENT);var isText=isType(NodeTypes.TEXT);var isDocument=isType(NodeTypes.DOCUMENT);return{name:name,type:type,value:value,isElement:isElement,isText:isText,isDocument:isDocument,isComment:isComment}});define("ephox.sugar.api.properties.Attr",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.sugar.api.node.Node","global!Error","global!console"],function(Type,Arr,Obj,Node,Error,console){var rawSet=function(dom,key,value){if(Type.isString(value)||Type.isBoolean(value)||Type.isNumber(value)){dom.setAttribute(key,value+"")}else{console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom);throw new Error("Attribute value was not simple")}};var set=function(element,key,value){rawSet(element.dom(),key,value)};var setAll=function(element,attrs){var dom=element.dom();Obj.each(attrs,function(v,k){rawSet(dom,k,v)})};var get=function(element,key){var v=element.dom().getAttribute(key);return v===null?undefined:v};var has=function(element,key){var dom=element.dom();return dom&&dom.hasAttribute?dom.hasAttribute(key):false};var remove=function(element,key){element.dom().removeAttribute(key)};var hasNone=function(element){var attrs=element.dom().attributes;return attrs===undefined||attrs===null||attrs.length===0};var clone=function(element){return Arr.foldl(element.dom().attributes,function(acc,attr){acc[attr.name]=attr.value;return acc},{})};var transferOne=function(source,destination,attr){if(has(source,attr)&&!has(destination,attr)){set(destination,attr,get(source,attr))}};var transfer=function(source,destination,attrs){if(!Node.isElement(source)||!Node.isElement(destination)){return}Arr.each(attrs,function(attr){transferOne(source,destination,attr)})};return{clone:clone,set:set,setAll:setAll,get:get,has:has,remove:remove,hasNone:hasNone,transfer:transfer}});define("ephox.sugar.api.node.Body",["ephox.katamari.api.Thunk","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","global!document"],function(Thunk,Element,Node,document){var inBody=function(element){var dom=Node.isText(element)?element.dom().parentNode:element.dom();return dom!==undefined&&dom!==null&&dom.ownerDocument.body.contains(dom)};var body=Thunk.cached(function(){return getBody(Element.fromDom(document))});var getBody=function(doc){var body=doc.dom().body;if(body===null||body===undefined){throw"Body is not available yet"}return Element.fromDom(body)};return{body:body,getBody:getBody,inBody:inBody}});define("ephox.sugar.api.search.PredicateFilter",["ephox.katamari.api.Arr","ephox.sugar.api.node.Body","ephox.sugar.api.search.Traverse"],function(Arr,Body,Traverse){var all=function(predicate){return descendants(Body.body(),predicate)};var ancestors=function(scope,predicate,isRoot){return Arr.filter(Traverse.parents(scope,isRoot),predicate)};var siblings=function(scope,predicate){return Arr.filter(Traverse.siblings(scope),predicate)};var children=function(scope,predicate){return Arr.filter(Traverse.children(scope),predicate)};var descendants=function(scope,predicate){var result=[];Arr.each(Traverse.children(scope),function(x){if(predicate(x)){result=result.concat([x])}result=result.concat(descendants(x,predicate))});return result};return{all:all,ancestors:ancestors,siblings:siblings,children:children,descendants:descendants}});define("ephox.sugar.api.search.SelectorFilter",["ephox.sugar.api.search.PredicateFilter","ephox.sugar.api.search.Selectors"],function(PredicateFilter,Selectors){var all=function(selector){return Selectors.all(selector)};var ancestors=function(scope,selector,isRoot){return PredicateFilter.ancestors(scope,function(e){return Selectors.is(e,selector)},isRoot)};var siblings=function(scope,selector){return PredicateFilter.siblings(scope,function(e){return Selectors.is(e,selector)})};var children=function(scope,selector){return PredicateFilter.children(scope,function(e){return Selectors.is(e,selector)})};var descendants=function(scope,selector){return Selectors.all(selector,scope)};return{all:all,ancestors:ancestors,siblings:siblings,children:children,descendants:descendants}});define("ephox.sugar.impl.ClosestOrAncestor",["ephox.katamari.api.Type","ephox.katamari.api.Option"],function(Type,Option){return function(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):Type.isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}});define("ephox.sugar.api.search.PredicateFind",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Body","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.impl.ClosestOrAncestor"],function(Type,Arr,Fun,Option,Body,Compare,Element,ClosestOrAncestor){var first=function(predicate){return descendant(Body.body(),predicate)};var ancestor=function(scope,predicate,isRoot){var element=scope.dom();var stop=Type.isFunction(isRoot)?isRoot:Fun.constant(false);while(element.parentNode){element=element.parentNode;var el=Element.fromDom(element);if(predicate(el)){return Option.some(el)}else if(stop(el)){break}}return Option.none()};var closest=function(scope,predicate,isRoot){var is=function(scope){return predicate(scope)};return ClosestOrAncestor(is,ancestor,scope,predicate,isRoot)};var sibling=function(scope,predicate){var element=scope.dom();if(!element.parentNode){return Option.none()}return child(Element.fromDom(element.parentNode),function(x){return!Compare.eq(scope,x)&&predicate(x)})};var child=function(scope,predicate){var result=Arr.find(scope.dom().childNodes,Fun.compose(predicate,Element.fromDom));return result.map(Element.fromDom)};var descendant=function(scope,predicate){var descend=function(element){for(var i=0;i<element.childNodes.length;i++){if(predicate(Element.fromDom(element.childNodes[i]))){return Option.some(Element.fromDom(element.childNodes[i]))}var res=descend(element.childNodes[i]);if(res.isSome()){return res}}return Option.none()};return descend(scope.dom())};return{first:first,ancestor:ancestor,closest:closest,sibling:sibling,child:child,descendant:descendant}});define("ephox.sugar.api.search.SelectorFind",["ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Selectors","ephox.sugar.impl.ClosestOrAncestor"],function(PredicateFind,Selectors,ClosestOrAncestor){var first=function(selector){return Selectors.one(selector)};var ancestor=function(scope,selector,isRoot){return PredicateFind.ancestor(scope,function(e){return Selectors.is(e,selector)},isRoot)};var sibling=function(scope,selector){return PredicateFind.sibling(scope,function(e){return Selectors.is(e,selector)})};var child=function(scope,selector){return PredicateFind.child(scope,function(e){return Selectors.is(e,selector)})};var descendant=function(scope,selector){return Selectors.one(selector,scope)};var closest=function(scope,selector,isRoot){return ClosestOrAncestor(Selectors.is,ancestor,scope,selector,isRoot)};return{first:first,ancestor:ancestor,sibling:sibling,child:child,descendant:descendant,closest:closest}});defineGlobal("global!parseInt",parseInt);define("ephox.snooker.api.TableLookup",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.Structs","ephox.snooker.util.LayerSelector","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Selectors","ephox.sugar.api.search.Traverse","global!parseInt"],function(Arr,Fun,Option,Structs,LayerSelector,Attr,Node,SelectorFilter,SelectorFind,Selectors,Traverse,parseInt){var lookup=function(tags,element,_isRoot){var isRoot=_isRoot!==undefined?_isRoot:Fun.constant(false);if(isRoot(element)){return Option.none()}if(Arr.contains(tags,Node.name(element))){return Option.some(element)}var isRootOrUpperTable=function(element){return Selectors.is(element,"table")||isRoot(element)};return SelectorFind.ancestor(element,tags.join(","),isRootOrUpperTable)};var cell=function(element,isRoot){return lookup(["td","th"],element,isRoot)};var cells=function(ancestor){return LayerSelector.firstLayer(ancestor,"th,td")};var notCell=function(element,isRoot){return lookup(["caption","tr","tbody","tfoot","thead"],element,isRoot)};var neighbours=function(selector,element){return Traverse.parent(element).map(function(parent){return SelectorFilter.children(parent,selector)})};var neighbourCells=Fun.curry(neighbours,"th,td");var neighbourRows=Fun.curry(neighbours,"tr");var firstCell=function(ancestor){return SelectorFind.descendant(ancestor,"th,td")};var table=function(element,isRoot){return SelectorFind.closest(element,"table",isRoot)};var row=function(element,isRoot){return lookup(["tr"],element,isRoot)};var rows=function(ancestor){return LayerSelector.firstLayer(ancestor,"tr")};var attr=function(element,property){return parseInt(Attr.get(element,property),10)};var grid=function(element,rowProp,colProp){var rows=attr(element,rowProp);var cols=attr(element,colProp);return Structs.grid(rows,cols)};return{cell:cell,firstCell:firstCell,cells:cells,neighbourCells:neighbourCells,table:table,row:row,rows:rows,notCell:notCell,neighbourRows:neighbourRows,attr:attr,grid:grid}});define("ephox.snooker.model.DetailsList",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.api.TableLookup","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Node","ephox.sugar.api.search.Traverse"],function(Arr,Structs,TableLookup,Attr,Node,Traverse){var fromTable=function(table){var rows=TableLookup.rows(table);return Arr.map(rows,function(row){var element=row;var parent=Traverse.parent(element);var parentSection=parent.bind(function(parent){var parentName=Node.name(parent);return parentName==="tfoot"||parentName==="thead"||parentName==="tbody"?parentName:"tbody"});var cells=Arr.map(TableLookup.cells(row),function(cell){var rowspan=Attr.has(cell,"rowspan")?parseInt(Attr.get(cell,"rowspan"),10):1;var colspan=Attr.has(cell,"colspan")?parseInt(Attr.get(cell,"colspan"),10):1;return Structs.detail(cell,rowspan,colspan)});return Structs.rowdata(element,cells,parentSection)})};var fromPastedRows=function(rows,example){return Arr.map(rows,function(row){var cells=Arr.map(TableLookup.cells(row),function(cell){var rowspan=Attr.has(cell,"rowspan")?parseInt(Attr.get(cell,"rowspan"),10):1;var colspan=Attr.has(cell,"colspan")?parseInt(Attr.get(cell,"colspan"),10):1;return Structs.detail(cell,rowspan,colspan)});return Structs.rowdata(row,cells,example.section())})};return{fromTable:fromTable,fromPastedRows:fromPastedRows}});defineGlobal("global!Math",Math);define("ephox.snooker.model.Warehouse",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.Structs","global!Math"],function(Arr,Fun,Option,Structs,Math){var key=function(row,column){return row+","+column};var getAt=function(warehouse,row,column){var raw=warehouse.access()[key(row,column)];return raw!==undefined?Option.some(raw):Option.none()};var findItem=function(warehouse,item,comparator){var filtered=filterItems(warehouse,function(detail){return comparator(item,detail.element())});return filtered.length>0?Option.some(filtered[0]):Option.none()};var filterItems=function(warehouse,predicate){var all=Arr.bind(warehouse.all(),function(r){return r.cells()});return Arr.filter(all,predicate)};var generate=function(list){var access={};var cells=[];var maxRows=list.length;var maxColumns=0;Arr.each(list,function(details,r){var currentRow=[];Arr.each(details.cells(),function(detail,c){var start=0;while(access[key(r,start)]!==undefined){start++}var current=Structs.extended(detail.element(),detail.rowspan(),detail.colspan(),r,start);for(var i=0;i<detail.colspan();i++){for(var j=0;j<detail.rowspan();j++){var cr=r+j;var cc=start+i;var newpos=key(cr,cc);access[newpos]=current;maxColumns=Math.max(maxColumns,cc+1)}}currentRow.push(current)});cells.push(Structs.rowdata(details.element(),currentRow,details.section()))});var grid=Structs.grid(maxRows,maxColumns);return{grid:Fun.constant(grid),access:Fun.constant(access),all:Fun.constant(cells)}};var justCells=function(warehouse){var rows=Arr.map(warehouse.all(),function(w){return w.cells()});return Arr.flatten(rows)};return{generate:generate,getAt:getAt,findItem:findItem,filterItems:filterItems,justCells:justCells}});define("ephox.sugar.impl.Style",[],function(){var isSupported=function(dom){return dom.style!==undefined};return{isSupported:isSupported}});defineGlobal("global!window",window);define("ephox.sugar.api.properties.Css",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Body","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.impl.Style","ephox.katamari.api.Strings","global!Error","global!console","global!window"],function(Type,Arr,Obj,Option,Attr,Body,Element,Node,Style,Strings,Error,console,window){var internalSet=function(dom,property,value){if(!Type.isString(value)){console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom);throw new Error("CSS value must be a string: "+value)}if(Style.isSupported(dom)){dom.style.setProperty(property,value)}};var internalRemove=function(dom,property){if(Style.isSupported(dom)){dom.style.removeProperty(property)}};var set=function(element,property,value){var dom=element.dom();internalSet(dom,property,value)};var setAll=function(element,css){var dom=element.dom();Obj.each(css,function(v,k){internalSet(dom,k,v)})};var setOptions=function(element,css){var dom=element.dom();Obj.each(css,function(v,k){v.fold(function(){internalRemove(dom,k)},function(value){internalSet(dom,k,value)})})};var get=function(element,property){var dom=element.dom();var styles=window.getComputedStyle(dom);var r=styles.getPropertyValue(property);var v=r===""&&!Body.inBody(element)?getUnsafeProperty(dom,property):r;return v===null?undefined:v};var getUnsafeProperty=function(dom,property){return Style.isSupported(dom)?dom.style.getPropertyValue(property):""};var getRaw=function(element,property){var dom=element.dom();var raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return r.length>0})};var getAllRaw=function(element){var css={};var dom=element.dom();if(Style.isSupported(dom)){for(var i=0;i<dom.style.length;i++){var ruleName=dom.style.item(i);css[ruleName]=dom.style[ruleName]}}return css};var isValidValue=function(tag,property,value){var element=Element.fromTag(tag);set(element,property,value);var style=getRaw(element,property);return style.isSome()};var remove=function(element,property){var dom=element.dom();internalRemove(dom,property);if(Attr.has(element,"style")&&Strings.trim(Attr.get(element,"style"))===""){Attr.remove(element,"style")}};var preserve=function(element,f){var oldStyles=Attr.get(element,"style");var result=f(element);var restore=oldStyles===undefined?Attr.remove:Attr.set;restore(element,"style",oldStyles);return result};var copy=function(source,target){var sourceDom=source.dom();var targetDom=target.dom();if(Style.isSupported(sourceDom)&&Style.isSupported(targetDom)){targetDom.style.cssText=sourceDom.style.cssText}};var reflow=function(e){return e.dom().offsetWidth};var transferOne=function(source,destination,style){getRaw(source,style).each(function(value){if(getRaw(destination,style).isNone()){set(destination,style,value)}})};var transfer=function(source,destination,styles){if(!Node.isElement(source)||!Node.isElement(destination)){return}Arr.each(styles,function(style){transferOne(source,destination,style)})};return{copy:copy,set:set,preserve:preserve,setAll:setAll,setOptions:setOptions,remove:remove,get:get,getRaw:getRaw,getAllRaw:getAllRaw,isValidValue:isValidValue,reflow:reflow,transfer:transfer}});define("ephox.sugar.api.dom.Insert",["ephox.sugar.api.search.Traverse"],function(Traverse){var before=function(marker,element){var parent=Traverse.parent(marker);parent.each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})};var after=function(marker,element){var sibling=Traverse.nextSibling(marker);sibling.fold(function(){var parent=Traverse.parent(marker);parent.each(function(v){append(v,element)})},function(v){before(v,element)})};var prepend=function(parent,element){var firstChild=Traverse.firstChild(parent);firstChild.fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})};var append=function(parent,element){parent.dom().appendChild(element.dom())};var appendAt=function(parent,element,index){Traverse.child(parent,index).fold(function(){append(parent,element)},function(v){before(v,element)})};var wrap=function(element,wrapper){before(element,wrapper);append(wrapper,element)};return{before:before,after:after,prepend:prepend,append:append,appendAt:appendAt,wrap:wrap}});define("ephox.sugar.api.dom.InsertAll",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert"],function(Arr,Insert){var before=function(marker,elements){Arr.each(elements,function(x){Insert.before(marker,x)})};var after=function(marker,elements){Arr.each(elements,function(x,i){var e=i===0?marker:elements[i-1];Insert.after(e,x)})};var prepend=function(parent,elements){Arr.each(elements.slice().reverse(),function(x){Insert.prepend(parent,x)})};var append=function(parent,elements){Arr.each(elements,function(x){Insert.append(parent,x)})};return{before:before,after:after,prepend:prepend,append:append}});define("ephox.sugar.api.dom.Remove",["ephox.katamari.api.Arr","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.search.Traverse"],function(Arr,InsertAll,Traverse){var empty=function(element){element.dom().textContent="";Arr.each(Traverse.children(element),function(rogue){remove(rogue)})};var remove=function(element){var dom=element.dom();if(dom.parentNode!==null){dom.parentNode.removeChild(dom)}};var unwrap=function(wrapper){var children=Traverse.children(wrapper);if(children.length>0){InsertAll.before(wrapper,children)}remove(wrapper)};return{empty:empty,remove:remove,unwrap:unwrap}});define("ephox.snooker.api.CopySelected",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Struct","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.util.LayerSelector","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Selectors"],function(Arr,Obj,Struct,DetailsList,Warehouse,LayerSelector,Attr,Css,Element,Insert,Remove,Selectors){var stats=Struct.immutable("minRow","minCol","maxRow","maxCol");var findSelectedStats=function(house,isSelected){var totalColumns=house.grid().columns();var totalRows=house.grid().rows();var minRow=totalRows;var minCol=totalColumns;var maxRow=0;var maxCol=0;Obj.each(house.access(),function(detail){if(isSelected(detail)){var startRow=detail.row();var endRow=startRow+detail.rowspan()-1;var startCol=detail.column();var endCol=startCol+detail.colspan()-1;if(startRow<minRow){minRow=startRow}else if(endRow>maxRow){maxRow=endRow}if(startCol<minCol){minCol=startCol}else if(endCol>maxCol){maxCol=endCol}}});return stats(minRow,minCol,maxRow,maxCol)};var makeCell=function(list,seenSelected,rowIndex){var row=list[rowIndex].element();var td=Element.fromTag("td");Insert.append(td,Element.fromTag("br"));var f=seenSelected?Insert.append:Insert.prepend;f(row,td)};var fillInGaps=function(list,house,stats,isSelected){var totalColumns=house.grid().columns();var totalRows=house.grid().rows();for(var i=0;i<totalRows;i++){var seenSelected=false;for(var j=0;j<totalColumns;j++){if(!(i<stats.minRow()||i>stats.maxRow()||j<stats.minCol()||j>stats.maxCol())){var needCell=Warehouse.getAt(house,i,j).filter(isSelected).isNone();if(needCell){makeCell(list,seenSelected,i)}else{seenSelected=true}}}}};var clean=function(table,stats){var emptyRows=Arr.filter(LayerSelector.firstLayer(table,"tr"),function(row){return row.dom().childElementCount===0});Arr.each(emptyRows,Remove.remove);if(stats.minCol()===stats.maxCol()||stats.minRow()===stats.maxRow()){Arr.each(LayerSelector.firstLayer(table,"th,td"),function(cell){Attr.remove(cell,"rowspan");Attr.remove(cell,"colspan")})}Attr.remove(table,"width");Attr.remove(table,"height");Css.remove(table,"width");Css.remove(table,"height")};var extract=function(table,selectedSelector){var isSelected=function(detail){return Selectors.is(detail.element(),selectedSelector)};var list=DetailsList.fromTable(table);var house=Warehouse.generate(list);var stats=findSelectedStats(house,isSelected);var selector="th:not("+selectedSelector+")"+",td:not("+selectedSelector+")";var unselectedCells=LayerSelector.filterFirstLayer(table,"th,td",function(cell){return Selectors.is(cell,selector)});Arr.each(unselectedCells,Remove.remove);fillInGaps(list,house,stats,isSelected);clean(table,stats);return table};return{extract:extract}});define("ephox.sugar.api.dom.Replication",["ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Traverse"],function(Attr,Element,Insert,InsertAll,Remove,Traverse){var clone=function(original,deep){return Element.fromDom(original.dom().cloneNode(deep))};var shallow=function(original){return clone(original,false)};var deep=function(original){return clone(original,true)};var shallowAs=function(original,tag){var nu=Element.fromTag(tag);var attributes=Attr.clone(original);Attr.setAll(nu,attributes);return nu};var copy=function(original,tag){var nu=shallowAs(original,tag);var cloneChildren=Traverse.children(deep(original));InsertAll.append(nu,cloneChildren);return nu};var mutate=function(original,tag){var nu=shallowAs(original,tag);Insert.before(original,nu);var children=Traverse.children(original);InsertAll.append(nu,children);Remove.remove(original);return nu};return{shallow:shallow,shallowAs:shallowAs,deep:deep,copy:copy,mutate:mutate}});define("ephox.sugar.impl.NodeValue",["ephox.sand.api.PlatformDetection","ephox.katamari.api.Option","global!Error"],function(PlatformDetection,Option,Error){return function(is,name){var get=function(element){if(!is(element)){throw new Error("Can only get "+name+" value of a "+name+" node")}return getOption(element).getOr("")};var getOptionIE10=function(element){try{return getOptionSafe(element)}catch(e){return Option.none()}};var getOptionSafe=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()};var browser=PlatformDetection.detect().browser;var getOption=browser.isIE()&&browser.version.major===10?getOptionIE10:getOptionSafe;var set=function(element,value){if(!is(element)){throw new Error("Can only set raw "+name+" value of a "+name+" node")}element.dom().nodeValue=value};return{get:get,getOption:getOption,set:set}}});define("ephox.sugar.api.node.Text",["ephox.sugar.api.node.Node","ephox.sugar.impl.NodeValue"],function(Node,NodeValue){var api=NodeValue(Node.isText,"text");var get=function(element){return api.get(element)};var getOption=function(element){return api.getOption(element)};var set=function(element,value){api.set(element,value)};return{get:get,getOption:getOption,set:set}});define("ephox.sugar.api.selection.Awareness",["ephox.katamari.api.Arr","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.Traverse"],function(Arr,Node,Text,Traverse){var getEnd=function(element){return Node.name(element)==="img"?1:Text.getOption(element).fold(function(){return Traverse.children(element).length},function(v){return v.length})};var isEnd=function(element,offset){return getEnd(element)===offset};var isStart=function(element,offset){return offset===0};var NBSP="¬†";var isTextNodeWithCursorPosition=function(el){return Text.getOption(el).filter(function(text){return text.trim().length!==0||text.indexOf(NBSP)>-1}).isSome()};var elementsWithCursorPosition=["img","br"];var isCursorPosition=function(elem){var hasCursorPosition=isTextNodeWithCursorPosition(elem);return hasCursorPosition||Arr.contains(elementsWithCursorPosition,Node.name(elem))};return{getEnd:getEnd,isEnd:isEnd,isStart:isStart,isCursorPosition:isCursorPosition}});define("ephox.sugar.api.selection.CursorPosition",["ephox.katamari.api.Option","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Awareness"],function(Option,PredicateFind,Traverse,Awareness){var first=function(element){return PredicateFind.descendant(element,Awareness.isCursorPosition)};var last=function(element){return descendantRtl(element,Awareness.isCursorPosition)};var descendantRtl=function(scope,predicate){var descend=function(element){var children=Traverse.children(element);for(var i=children.length-1;i>=0;i--){var child=children[i];if(predicate(child)){return Option.some(child)}var res=descend(child);if(res.isSome()){return res}}return Option.none()};return descend(scope)};return{first:first,last:last}});define("ephox.snooker.api.TableFill",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.CursorPosition"],function(Arr,Obj,Compare,Insert,Replication,Element,Node,Attr,Css,SelectorFilter,Traverse,CursorPosition){var cell=function(){var td=Element.fromTag("td");Insert.append(td,Element.fromTag("br"));return td};var replace=function(cell,tag,attrs){var replica=Replication.copy(cell,tag);Obj.each(attrs,function(v,k){if(v===null){Attr.remove(replica,k)}else{Attr.set(replica,k,v)}});return replica};var pasteReplace=function(cellContent){return cellContent};var newRow=function(doc){return function(){return Element.fromTag("tr",doc.dom())}};var cloneFormats=function(oldCell,newCell,formats){var first=CursorPosition.first(oldCell);return first.map(function(firstText){var formatSelector=formats.join(",");var parents=SelectorFilter.ancestors(firstText,formatSelector,function(element){return Compare.eq(element,oldCell)});return Arr.foldr(parents,function(last,parent){var clonedFormat=Replication.shallow(parent);Insert.append(last,clonedFormat);return clonedFormat},newCell)}).getOr(newCell)};var cellOperations=function(mutate,doc,formatsToClone){var newCell=function(prev){var doc=Traverse.owner(prev.element());var td=Element.fromTag(Node.name(prev.element()),doc.dom());var formats=formatsToClone.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]);var lastNode=formats.length>0?cloneFormats(prev.element(),td,formats):td;Insert.append(lastNode,Element.fromTag("br"));Css.copy(prev.element(),td);Css.remove(td,"height");if(prev.colspan()!==1){Css.remove(prev.element(),"width")}mutate(prev.element(),td);return td};return{row:newRow(doc),cell:newCell,replace:replace,gap:cell}};var paste=function(doc){return{row:newRow(doc),cell:cell,replace:pasteReplace,gap:cell}};return{cellOperations:cellOperations,paste:paste}});define("ephox.sugar.api.node.Elements",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","global!document"],function(Arr,Element,Traverse,document){var fromHtml=function(html,scope){var doc=scope||document;var div=doc.createElement("div");div.innerHTML=html;return Traverse.children(Element.fromDom(div))};var fromTags=function(tags,scope){return Arr.map(tags,function(x){return Element.fromTag(x,scope)})};var fromText=function(texts,scope){return Arr.map(texts,function(x){return Element.fromText(x,scope)})};var fromDom=function(nodes){return Arr.map(nodes,Element.fromDom)};return{fromHtml:fromHtml,fromTags:fromTags,fromText:fromText,fromDom:fromDom}});define("ephox.boss.common.TagBoundaries",[],function(){return["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"]});define("ephox.boss.api.DomUniverse",["ephox.boss.common.TagBoundaries","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.properties.Attr","ephox.sugar.api.dom.Compare","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFilter","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.node.Text","ephox.sugar.api.search.Traverse"],function(TagBoundaries,Arr,Fun,Attr,Compare,Css,Element,Insert,InsertAll,Node,PredicateFilter,PredicateFind,Remove,SelectorFilter,SelectorFind,Text,Traverse){return function(){var clone=function(element){return Element.fromDom(element.dom().cloneNode(false))};var isBoundary=function(element){if(!Node.isElement(element)){return false}if(Node.name(element)==="body"){return true}return Arr.contains(TagBoundaries,Node.name(element))};var isEmptyTag=function(element){if(!Node.isElement(element)){return false}return Arr.contains(["br","img","hr","input"],Node.name(element))};var comparePosition=function(element,other){return element.dom().compareDocumentPosition(other.dom())};var copyAttributesTo=function(source,destination){var as=Attr.clone(source);Attr.setAll(destination,as)};return{up:Fun.constant({selector:SelectorFind.ancestor,closest:SelectorFind.closest,predicate:PredicateFind.ancestor,all:Traverse.parents}),down:Fun.constant({selector:SelectorFilter.descendants,predicate:PredicateFilter.descendants}),styles:Fun.constant({get:Css.get,getRaw:Css.getRaw,set:Css.set,remove:Css.remove}),attrs:Fun.constant({get:Attr.get,set:Attr.set,remove:Attr.remove,copyTo:copyAttributesTo}),insert:Fun.constant({before:Insert.before,after:Insert.after,afterAll:InsertAll.after,append:Insert.append,appendAll:InsertAll.append,prepend:Insert.prepend,wrap:Insert.wrap}),remove:Fun.constant({unwrap:Remove.unwrap,remove:Remove.remove}),create:Fun.constant({nu:Element.fromTag,clone:clone,text:Element.fromText}),query:Fun.constant({comparePosition:comparePosition,prevSibling:Traverse.prevSibling,nextSibling:Traverse.nextSibling}),property:Fun.constant({children:Traverse.children,name:Node.name,parent:Traverse.parent,isText:Node.isText,isComment:Node.isComment,isElement:Node.isElement,getText:Text.get,setText:Text.set,isBoundary:isBoundary,isEmptyTag:isEmptyTag}),eq:Compare.eq,is:Compare.is}}});define("ephox.robin.parent.Breaker",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct"],function(Arr,Fun,Option,Struct){var leftRight=Struct.immutable("left","right");var bisect=function(universe,parent,child){var children=universe.property().children(parent);var index=Arr.findIndex(children,Fun.curry(universe.eq,child));return index.map(function(ind){return{before:Fun.constant(children.slice(0,ind)),after:Fun.constant(children.slice(ind+1))}})};var breakToRight=function(universe,parent,child){return bisect(universe,parent,child).map(function(parts){var second=universe.create().clone(parent);universe.insert().appendAll(second,parts.after());universe.insert().after(parent,second);return leftRight(parent,second)})};var breakToLeft=function(universe,parent,child){return bisect(universe,parent,child).map(function(parts){var prior=universe.create().clone(parent);universe.insert().appendAll(prior,parts.before().concat([child]));universe.insert().appendAll(parent,parts.after());universe.insert().before(parent,prior);return leftRight(prior,parent)})};var breakPath=function(universe,item,isTop,breaker){var result=Struct.immutable("first","second","splits");var next=function(child,group,splits){var fallback=result(child,Option.none(),splits);if(isTop(child)){return result(child,group,splits)}else{return universe.property().parent(child).bind(function(parent){return breaker(universe,parent,child).map(function(breakage){var extra=[{first:breakage.left,second:breakage.right}];var nextChild=isTop(parent)?parent:breakage.left();return next(nextChild,Option.some(breakage.right()),splits.concat(extra))}).getOr(fallback)})}};return next(item,Option.none(),[])};return{breakToLeft:breakToLeft,breakToRight:breakToRight,breakPath:breakPath}});define("ephox.robin.parent.Shared",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option"],function(Arr,Fun,Option){var all=function(universe,look,elements,f){var head=elements[0];var tail=elements.slice(1);return f(universe,look,head,tail)};var oneAll=function(universe,look,elements){return elements.length>0?all(universe,look,elements,unsafeOne):Option.none()};var unsafeOne=function(universe,look,head,tail){var start=look(universe,head);return Arr.foldr(tail,function(b,a){var current=look(universe,a);return commonElement(universe,b,current)},start)};var commonElement=function(universe,start,end){return start.bind(function(s){return end.filter(Fun.curry(universe.eq,s))})};return{oneAll:oneAll}});define("ephox.robin.parent.Subset",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","global!Math"],function(Arr,Fun,Option,Math){var eq=function(universe,item){return Fun.curry(universe.eq,item)};var unsafeSubset=function(universe,common,ps1,ps2){var children=universe.property().children(common);if(universe.eq(common,ps1[0])){return Option.some([ps1[0]])}if(universe.eq(common,ps2[0])){return Option.some([ps2[0]])}var finder=function(ps){var topDown=Arr.reverse(ps);var index=Arr.findIndex(topDown,eq(universe,common)).getOr(-1);var item=index<topDown.length-1?topDown[index+1]:topDown[index];return Arr.findIndex(children,eq(universe,item))};var startIndex=finder(ps1);var endIndex=finder(ps2);return startIndex.bind(function(sIndex){return endIndex.map(function(eIndex){var first=Math.min(sIndex,eIndex);var last=Math.max(sIndex,eIndex);return children.slice(first,last+1)})})};var ancestors=function(universe,start,end,_isRoot){var isRoot=_isRoot!==undefined?_isRoot:Fun.constant(false);var ps1=[start].concat(universe.up().all(start));var ps2=[end].concat(universe.up().all(end));var prune=function(path){var index=Arr.findIndex(path,isRoot);return index.fold(function(){return path},function(ind){return path.slice(0,ind+1)})};var pruned1=prune(ps1);var pruned2=prune(ps2);var shared=Arr.find(pruned1,function(x){return Arr.exists(pruned2,eq(universe,x))});return{firstpath:Fun.constant(pruned1),secondpath:Fun.constant(pruned2),shared:Fun.constant(shared)}};var subset=function(universe,start,end){var ancs=ancestors(universe,start,end);return ancs.shared().bind(function(shared){return unsafeSubset(universe,shared,ancs.firstpath(),ancs.secondpath())})};return{subset:subset,ancestors:ancestors}});define("ephox.robin.api.general.Parent",["ephox.robin.parent.Breaker","ephox.robin.parent.Shared","ephox.robin.parent.Subset"],function(Breaker,Shared,Subset){var sharedOne=function(universe,look,elements){return Shared.oneAll(universe,look,elements)};var subset=function(universe,start,finish){return Subset.subset(universe,start,finish)};var ancestors=function(universe,start,finish,_isRoot){return Subset.ancestors(universe,start,finish,_isRoot)};var breakToLeft=function(universe,parent,child){return Breaker.breakToLeft(universe,parent,child)};var breakToRight=function(universe,parent,child){return Breaker.breakToRight(universe,parent,child)};var breakPath=function(universe,child,isTop,breaker){return Breaker.breakPath(universe,child,isTop,breaker)};return{sharedOne:sharedOne,subset:subset,ancestors:ancestors,breakToLeft:breakToLeft,breakToRight:breakToRight,breakPath:breakPath}});define("ephox.robin.api.dom.DomParent",["ephox.boss.api.DomUniverse","ephox.robin.api.general.Parent"],function(DomUniverse,Parent){var universe=DomUniverse();var sharedOne=function(look,elements){return Parent.sharedOne(universe,function(universe,element){return look(element)},elements)};var subset=function(start,finish){return Parent.subset(universe,start,finish)};var ancestors=function(start,finish,_isRoot){return Parent.ancestors(universe,start,finish,_isRoot)};var breakToLeft=function(parent,child){return Parent.breakToLeft(universe,parent,child)};var breakToRight=function(parent,child){return Parent.breakToRight(universe,parent,child)};var breakPath=function(child,isTop,breaker){return Parent.breakPath(universe,child,isTop,function(u,p,c){return breaker(p,c)})};return{sharedOne:sharedOne,subset:subset,ancestors:ancestors,breakToLeft:breakToLeft,breakToRight:breakToRight,breakPath:breakPath}});define("ephox.snooker.selection.CellBounds",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.model.Warehouse"],function(Fun,Option,Warehouse){var inSelection=function(bounds,detail){var leftEdge=detail.column();var rightEdge=detail.column()+detail.colspan()-1;var topEdge=detail.row();var bottomEdge=detail.row()+detail.rowspan()-1;return leftEdge<=bounds.finishCol()&&rightEdge>=bounds.startCol()&&(topEdge<=bounds.finishRow()&&bottomEdge>=bounds.startRow())};var isWithin=function(bounds,detail){return detail.column()>=bounds.startCol()&&detail.column()+detail.colspan()-1<=bounds.finishCol()&&detail.row()>=bounds.startRow()&&detail.row()+detail.rowspan()-1<=bounds.finishRow()};var isRectangular=function(warehouse,bounds){var isRect=true;var detailIsWithin=Fun.curry(isWithin,bounds);for(var i=bounds.startRow();i<=bounds.finishRow();i++){for(var j=bounds.startCol();j<=bounds.finishCol();j++){isRect=isRect&&Warehouse.getAt(warehouse,i,j).exists(detailIsWithin)}}return isRect?Option.some(bounds):Option.none()};return{inSelection:inSelection,isWithin:isWithin,isRectangular:isRectangular}});define("ephox.snooker.selection.CellGroup",["ephox.snooker.api.Structs","ephox.snooker.model.Warehouse","ephox.snooker.selection.CellBounds","ephox.sugar.api.dom.Compare","global!Math"],function(Structs,Warehouse,CellBounds,Compare,Math){var getBounds=function(detailA,detailB){return Structs.bounds(Math.min(detailA.row(),detailB.row()),Math.min(detailA.column(),detailB.column()),Math.max(detailA.row()+detailA.rowspan()-1,detailB.row()+detailB.rowspan()-1),Math.max(detailA.column()+detailA.colspan()-1,detailB.column()+detailB.colspan()-1))};var getAnyBox=function(warehouse,startCell,finishCell){var startCoords=Warehouse.findItem(warehouse,startCell,Compare.eq);var finishCoords=Warehouse.findItem(warehouse,finishCell,Compare.eq);return startCoords.bind(function(sc){return finishCoords.map(function(fc){return getBounds(sc,fc)})})};var getBox=function(warehouse,startCell,finishCell){return getAnyBox(warehouse,startCell,finishCell).bind(function(bounds){return CellBounds.isRectangular(warehouse,bounds)})};return{getAnyBox:getAnyBox,getBox:getBox}});define("ephox.snooker.selection.CellFinder",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.model.Warehouse","ephox.snooker.selection.CellBounds","ephox.snooker.selection.CellGroup","ephox.sugar.api.dom.Compare"],function(Arr,Fun,Warehouse,CellBounds,CellGroup,Compare){var moveBy=function(warehouse,cell,row,column){return Warehouse.findItem(warehouse,cell,Compare.eq).bind(function(detail){var startRow=row>0?detail.row()+detail.rowspan()-1:detail.row();var startCol=column>0?detail.column()+detail.colspan()-1:detail.column();var dest=Warehouse.getAt(warehouse,startRow+row,startCol+column);return dest.map(function(d){return d.element()})})};var intercepts=function(warehouse,start,finish){return CellGroup.getAnyBox(warehouse,start,finish).map(function(bounds){var inside=Warehouse.filterItems(warehouse,Fun.curry(CellBounds.inSelection,bounds));return Arr.map(inside,function(detail){return detail.element()})})};var parentCell=function(warehouse,innerCell){var isContainedBy=function(c1,c2){return Compare.contains(c2,c1)};return Warehouse.findItem(warehouse,innerCell,isContainedBy).bind(function(detail){return detail.element()})};return{moveBy:moveBy,intercepts:intercepts,parentCell:parentCell}});define("ephox.snooker.api.TablePositions",["ephox.snooker.api.TableLookup","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.selection.CellFinder","ephox.snooker.selection.CellGroup","ephox.sugar.api.dom.Compare"],function(TableLookup,DetailsList,Warehouse,CellFinder,CellGroup,Compare){var moveBy=function(cell,deltaRow,deltaColumn){return TableLookup.table(cell).bind(function(table){var warehouse=getWarehouse(table);return CellFinder.moveBy(warehouse,cell,deltaRow,deltaColumn)})};var intercepts=function(table,first,last){var warehouse=getWarehouse(table);return CellFinder.intercepts(warehouse,first,last)};var nestedIntercepts=function(table,first,firstTable,last,lastTable){var warehouse=getWarehouse(table);var startCell=Compare.eq(table,firstTable)?first:CellFinder.parentCell(warehouse,first);var lastCell=Compare.eq(table,lastTable)?last:CellFinder.parentCell(warehouse,last);return CellFinder.intercepts(warehouse,startCell,lastCell)};var getBox=function(table,first,last){var warehouse=getWarehouse(table);return CellGroup.getBox(warehouse,first,last)};var getWarehouse=function(table){var list=DetailsList.fromTable(table);return Warehouse.generate(list)};return{moveBy:moveBy,intercepts:intercepts,nestedIntercepts:nestedIntercepts,getBox:getBox}});define("ephox.darwin.selection.CellSelection",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.robin.api.dom.DomParent","ephox.snooker.api.TablePositions","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Selectors"],function(Arr,Fun,Option,DomParent,TablePositions,Compare,SelectorFilter,SelectorFind,Selectors){var lookupTable=function(container,isRoot){return SelectorFind.ancestor(container,"table")};var identify=function(start,finish,isRoot){if(Compare.eq(start,finish)){return Option.some([start])}else{return lookupTable(start,isRoot).bind(function(startTable){return lookupTable(finish,isRoot).bind(function(finishTable){if(Compare.eq(startTable,finishTable)){return TablePositions.intercepts(startTable,start,finish)}else if(Compare.contains(startTable,finishTable)){return TablePositions.nestedIntercepts(startTable,start,startTable,finish,finishTable)}else if(Compare.contains(finishTable,startTable)){return TablePositions.nestedIntercepts(finishTable,start,startTable,finish,finishTable)}else{return DomParent.ancestors(start,finish).shared().bind(function(lca){return SelectorFind.closest(lca,"table",isRoot).bind(function(lcaTable){return TablePositions.nestedIntercepts(lcaTable,start,startTable,finish,finishTable)})})}})})}};var retrieve=function(container,selector){var sels=SelectorFilter.descendants(container,selector);return sels.length>0?Option.some(sels):Option.none()};var getLast=function(boxes,lastSelectedSelector){return Arr.find(boxes,function(box){return Selectors.is(box,lastSelectedSelector)})};var getEdges=function(container,firstSelectedSelector,lastSelectedSelector){return SelectorFind.descendant(container,firstSelectedSelector).bind(function(first){return SelectorFind.descendant(container,lastSelectedSelector).bind(function(last){return DomParent.sharedOne(lookupTable,[first,last]).map(function(tbl){return{first:Fun.constant(first),last:Fun.constant(last),table:Fun.constant(tbl)}})})})};var expandTo=function(finish,firstSelectedSelector){return SelectorFind.ancestor(finish,"table").bind(function(table){return SelectorFind.descendant(table,firstSelectedSelector).bind(function(start){return identify(start,finish).map(function(boxes){return{boxes:Fun.constant(boxes),start:Fun.constant(start),finish:Fun.constant(finish)}})})})};var shiftSelection=function(boxes,deltaRow,deltaColumn,firstSelectedSelector,lastSelectedSelector){return getLast(boxes,lastSelectedSelector).bind(function(last){return TablePositions.moveBy(last,deltaRow,deltaColumn).bind(function(finish){return expandTo(finish,firstSelectedSelector)})})};return{identify:identify,retrieve:retrieve,shiftSelection:shiftSelection,getEdges:getEdges}});define("ephox.darwin.api.TableSelection",["ephox.darwin.selection.CellSelection","ephox.katamari.api.Option","ephox.snooker.api.TablePositions","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind"],function(CellSelection,Option,TablePositions,Compare,SelectorFind){var retrieve=function(container,selector){return CellSelection.retrieve(container,selector)};var retrieveBox=function(container,firstSelectedSelector,lastSelectedSelector){return CellSelection.getEdges(container,firstSelectedSelector,lastSelectedSelector).bind(function(edges){var isRoot=function(ancestor){return Compare.eq(container,ancestor)};var firstAncestor=SelectorFind.ancestor(edges.first(),"thead,tfoot,tbody,table",isRoot);var lastAncestor=SelectorFind.ancestor(edges.last(),"thead,tfoot,tbody,table",isRoot);return firstAncestor.bind(function(fA){return lastAncestor.bind(function(lA){return Compare.eq(fA,lA)?TablePositions.getBox(edges.table(),edges.first(),edges.last()):Option.none()})})})};return{retrieve:retrieve,retrieveBox:retrieveBox}});define("tinymce.plugins.table.selection.Ephemera",["ephox.katamari.api.Fun"],function(Fun){var selected="data-mce-selected";var selectedSelector="td["+selected+"],th["+selected+"]";var attributeSelector="["+selected+"]";var firstSelected="data-mce-first-selected";var firstSelectedSelector="td["+firstSelected+"],th["+firstSelected+"]";var lastSelected="data-mce-last-selected";var lastSelectedSelector="td["+lastSelected+"],th["+lastSelected+"]";return{selected:Fun.constant(selected),selectedSelector:Fun.constant(selectedSelector),attributeSelector:Fun.constant(attributeSelector),firstSelected:Fun.constant(firstSelected),firstSelectedSelector:Fun.constant(firstSelectedSelector),lastSelected:Fun.constant(lastSelected),lastSelectedSelector:Fun.constant(lastSelectedSelector)}});define("ephox.katamari.api.Adt",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Type","global!Array","global!Error","global!console"],function(Arr,Obj,Type,Array,Error,console){var generate=function(cases){if(!Type.isArray(cases)){throw new Error("cases must be an array")}if(cases.length===0){throw new Error("there must be at least one case")}var constructors=[];var adt={};Arr.each(cases,function(acase,count){var keys=Obj.keys(acase);if(keys.length!==1){throw new Error("one and only one name per case")}var key=keys[0];var value=acase[key];if(adt[key]!==undefined){throw new Error("duplicate key detected:"+key)}else if(key==="cata"){throw new Error("cannot have a case named cata (sorry)")}else if(!Type.isArray(value)){throw new Error("case arguments must be an array")}constructors.push(key);adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length){throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength)}var args=new Array(argLength);for(var i=0;i<args.length;i++){args[i]=arguments[i]}var match=function(branches){var branchKeys=Obj.keys(branches);if(constructors.length!==branchKeys.length){throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","))}var allReqd=Arr.forall(constructors,function(reqKey){return Arr.contains(branchKeys,reqKey)});if(!allReqd){throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "))}return branches[key].apply(null,args)};return{fold:function(){if(arguments.length!==cases.length){throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length)}var target=arguments[count];return target.apply(null,args)},match:match,log:function(label){console.log(label,{constructors:constructors,constructor:key,params:args})}}}});return adt};return{generate:generate}});define("tinymce.plugins.table.selection.SelectionTypes",["ephox.katamari.api.Adt"],function(Adt){var type=Adt.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]);var cata=function(subject,onNone,onMultiple,onSingle){return subject.fold(onNone,onMultiple,onSingle)};return{cata:cata,none:type.none,multiple:type.multiple,single:type.single}});define("tinymce.plugins.table.queries.CellOperations",["ephox.darwin.api.TableSelection","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.properties.Attr","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.SelectionTypes"],function(TableSelection,Arr,Fun,Option,Attr,Ephemera,SelectionTypes){var selection=function(cell,selections){return SelectionTypes.cata(selections.get(),Fun.constant([]),Fun.identity,Fun.constant([cell]))};var unmergable=function(cell,selections){var hasSpan=function(elem){return Attr.has(elem,"rowspan")&&parseInt(Attr.get(elem,"rowspan"),10)>1||Attr.has(elem,"colspan")&&parseInt(Attr.get(elem,"colspan"),10)>1};var candidates=selection(cell,selections);return candidates.length>0&&Arr.forall(candidates,hasSpan)?Option.some(candidates):Option.none()};var mergable=function(table,selections){return SelectionTypes.cata(selections.get(),Option.none,function(cells,_env){if(cells.length===0){return Option.none()}return TableSelection.retrieveBox(table,Ephemera.firstSelectedSelector(),Ephemera.lastSelectedSelector()).bind(function(bounds){return cells.length>1?Option.some({bounds:Fun.constant(bounds),cells:Fun.constant(cells)}):Option.none()})},Option.none)};return{mergable:mergable,unmergable:unmergable,selection:selection}});define("tinymce.plugins.table.queries.TableTargets",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","tinymce.plugins.table.queries.CellOperations"],function(Fun,Option,Struct,CellOperations){var noMenu=function(cell){return{element:Fun.constant(cell),mergable:Option.none,unmergable:Option.none,selection:Fun.constant([cell])}};var forMenu=function(selections,table,cell){return{element:Fun.constant(cell),mergable:Fun.constant(CellOperations.mergable(table,selections)),unmergable:Fun.constant(CellOperations.unmergable(cell,selections)),selection:Fun.constant(CellOperations.selection(cell,selections))}};var notCell=function(element){return noMenu(element)};var paste=Struct.immutable("element","clipboard","generators");var pasteRows=function(selections,table,cell,clipboard,generators){return{element:Fun.constant(cell),mergable:Option.none,unmergable:Option.none,selection:Fun.constant(CellOperations.selection(cell,selections)),clipboard:Fun.constant(clipboard),generators:Fun.constant(generators)}};return{noMenu:noMenu,forMenu:forMenu,notCell:notCell,paste:paste,pasteRows:pasteRows}});define("tinymce.plugins.table.actions.Clipboard",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.CopySelected","ephox.snooker.api.TableFill","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.node.Elements","ephox.sugar.api.node.Node","tinymce.plugins.table.queries.TableTargets","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.SelectionTypes"],function(Arr,Fun,Option,CopySelected,TableFill,TableLookup,Replication,Element,Elements,Node,TableTargets,Ephemera,SelectionTypes){var extractSelected=function(cells){return TableLookup.table(cells[0]).map(Replication.deep).map(function(replica){return[CopySelected.extract(replica,Ephemera.attributeSelector())]})};var serializeElement=function(editor,elm){return editor.selection.serializer.serialize(elm.dom(),{})};var registerEvents=function(editor,selections,actions,cellSelection){editor.on("BeforeGetContent",function(e){var multiCellContext=function(cells){e.preventDefault();extractSelected(cells).each(function(elements){e.content=Arr.map(elements,function(elm){return serializeElement(editor,elm)}).join("")})};if(e.selection===true){SelectionTypes.cata(selections.get(),Fun.noop,multiCellContext,Fun.noop)}});editor.on("BeforeSetContent",function(e){if(e.selection===true&&e.paste===true){var cellOpt=Option.from(editor.dom.getParent(editor.selection.getStart(),"th,td"));cellOpt.each(function(domCell){var cell=Element.fromDom(domCell);var table=TableLookup.table(cell);table.bind(function(table){var elements=Arr.filter(Elements.fromHtml(e.content),function(content){return Node.name(content)!=="meta"});if(elements.length===1&&Node.name(elements[0])==="table"){e.preventDefault();var doc=Element.fromDom(editor.getDoc());var generators=TableFill.paste(doc);var targets=TableTargets.paste(cell,elements[0],generators);actions.pasteCells(table,targets).each(function(rng){editor.selection.setRng(rng);editor.focus();cellSelection.clear(table)})}})})}})};return{registerEvents:registerEvents}});define("ephox.snooker.operate.Render",["ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll"],function(Attr,Css,Element,Insert,InsertAll){var makeTable=function(){return Element.fromTag("table")};var tableBody=function(){return Element.fromTag("tbody")};var tableRow=function(){return Element.fromTag("tr")};var tableHeaderCell=function(){return Element.fromTag("th")};var tableCell=function(){return Element.fromTag("td")};var render=function(rows,columns,rowHeaders,columnHeaders){var table=makeTable();Css.setAll(table,{"border-collapse":"collapse",width:"100%"});Attr.set(table,"border","1");var tbody=tableBody();Insert.append(table,tbody);var trs=[];for(var i=0;i<rows;i++){var tr=tableRow();for(var j=0;j<columns;j++){var td=i<rowHeaders||j<columnHeaders?tableHeaderCell():tableCell();if(j<columnHeaders){Attr.set(td,"scope","row")}if(i<rowHeaders){Attr.set(td,"scope","col")}Insert.append(td,Element.fromTag("br"));Css.set(td,"width",100/columns+"%");Insert.append(tr,td)}trs.push(tr)}InsertAll.append(tbody,trs);return table};return{render:render}});define("ephox.snooker.api.TableRender",["ephox.snooker.operate.Render"],function(Render){return{render:Render.render}});define("ephox.sugar.api.properties.Html",["ephox.sugar.api.node.Element","ephox.sugar.api.node.Elements","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Traverse"],function(Element,Elements,Insert,InsertAll,Remove,Traverse){var get=function(element){return element.dom().innerHTML};var set=function(element,content){var owner=Traverse.owner(element);var docDom=owner.dom();var fragment=Element.fromDom(docDom.createDocumentFragment());var contentElements=Elements.fromHtml(content,docDom);InsertAll.append(fragment,contentElements);Remove.empty(element);Insert.append(element,fragment)};var getOuter=function(element){var container=Element.fromTag("div");var clone=Element.fromDom(element.dom().cloneNode(true));Insert.append(container,clone);return get(container)};return{get:get,set:set,getOuter:getOuter}});define("tinymce.plugins.table.actions.InsertTable",["ephox.katamari.api.Fun","ephox.snooker.api.TableRender","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Html","ephox.sugar.api.search.SelectorFind"],function(Fun,TableRender,Element,Attr,Html,SelectorFind){var placeCaretInCell=function(editor,cell){editor.selection.select(cell.dom(),true);editor.selection.collapse(true)};var selectFirstCellInTable=function(editor,tableElm){SelectorFind.descendant(tableElm,"td,th").each(Fun.curry(placeCaretInCell,editor))};var insert=function(editor,columns,rows){var tableElm;var renderedHtml=TableRender.render(rows,columns,0,0);Attr.set(renderedHtml,"id","__mce");var html=Html.getOuter(renderedHtml);editor.insertContent(html);tableElm=editor.dom.get("__mce");editor.dom.setAttrib(tableElm,"id",null);editor.$("tr",tableElm).each(function(index,row){editor.fire("newrow",{node:row});editor.$("th,td",row).each(function(index,cell){editor.fire("newcell",{node:cell})})});editor.dom.setAttribs(tableElm,editor.settings.table_default_attributes||{});editor.dom.setStyles(tableElm,editor.settings.table_default_styles||{});selectFirstCellInTable(editor,Element.fromDom(tableElm));return tableElm};return{insert:insert}});define("ephox.sugar.impl.Dimension",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.sugar.api.properties.Css","ephox.sugar.impl.Style"],function(Type,Arr,Css,Style){return function(name,getOffset){var set=function(element,h){if(!Type.isNumber(h)&&!h.match(/^[0-9]+$/)){throw name+".set accepts only positive integer values. Value was "+h}var dom=element.dom();if(Style.isSupported(dom)){dom.style[name]=h+"px"}};var get=function(element){var r=getOffset(element);if(r<=0||r===null){var css=Css.get(element,name);return parseFloat(css)||0}return r};var getOuter=get;var aggregate=function(element,properties){return Arr.foldl(properties,function(acc,property){var val=Css.get(element,property);var value=val===undefined?0:parseInt(val,10);return isNaN(value)?acc:acc+value},0)};var max=function(element,value,properties){var cumulativeInclusions=aggregate(element,properties);var absoluteMax=value>cumulativeInclusions?value-cumulativeInclusions:0;return absoluteMax};return{set:set,get:get,getOuter:getOuter,aggregate:aggregate,max:max}}});define("ephox.sugar.api.view.Height",["ephox.sugar.api.node.Body","ephox.sugar.api.properties.Css","ephox.sugar.impl.Dimension"],function(Body,Css,Dimension){var api=Dimension("height",function(element){return Body.inBody(element)?element.dom().getBoundingClientRect().height:element.dom().offsetHeight});var set=function(element,h){api.set(element,h)};var get=function(element){return api.get(element)};var getOuter=function(element){return api.getOuter(element)};var setMax=function(element,value){var inclusions=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"];var absMax=api.max(element,value,inclusions);Css.set(element,"max-height",absMax+"px")};return{set:set,get:get,getOuter:getOuter,setMax:setMax}});define("ephox.sugar.api.view.Width",["ephox.sugar.api.properties.Css","ephox.sugar.impl.Dimension"],function(Css,Dimension){var api=Dimension("width",function(element){return element.dom().offsetWidth});var set=function(element,h){api.set(element,h)};var get=function(element){return api.get(element)};var getOuter=function(element){return api.getOuter(element)};var setMax=function(element,value){var inclusions=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"];var absMax=api.max(element,value,inclusions);Css.set(element,"max-width",absMax+"px")};return{set:set,get:get,getOuter:getOuter,setMax:setMax}});define("ephox.snooker.resize.RuntimeSize",["ephox.sand.api.PlatformDetection","ephox.sugar.api.properties.Css","ephox.sugar.api.view.Height","ephox.sugar.api.view.Width"],function(PlatformDetection,Css,Height,Width){var platform=PlatformDetection.detect();var needManualCalc=function(){return platform.browser.isIE()||platform.browser.isEdge()};var toNumber=function(px,fallback){var num=parseFloat(px);return isNaN(num)?fallback:num};var getProp=function(elm,name,fallback){return toNumber(Css.get(elm,name),fallback)};var getCalculatedHeight=function(cell){var paddingTop=getProp(cell,"padding-top",0);var paddingBottom=getProp(cell,"padding-bottom",0);var borderTop=getProp(cell,"border-top-width",0);var borderBottom=getProp(cell,"border-bottom-width",0);var height=cell.dom().getBoundingClientRect().height;var boxSizing=Css.get(cell,"box-sizing");var borders=borderTop+borderBottom;return boxSizing==="border-box"?height:height-paddingTop-paddingBottom-borders};var getWidth=function(cell){return getProp(cell,"width",Width.get(cell))};var getHeight=function(cell){return needManualCalc()?getCalculatedHeight(cell):getProp(cell,"height",Height.get(cell))};return{getWidth:getWidth,getHeight:getHeight}});define("ephox.snooker.resize.Sizes",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Strings","ephox.snooker.api.TableLookup","ephox.snooker.resize.RuntimeSize","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.view.Height","ephox.sugar.api.view.Width","global!Math","global!parseInt"],function(Fun,Option,Strings,TableLookup,RuntimeSize,Node,Attr,Css,Height,Width,Math,parseInt){var genericSizeRegex=/(\d+(\.\d+)?)(\w|%)*/;var percentageBasedSizeRegex=/(\d+(\.\d+)?)%/;var pixelBasedSizeRegex=/(\d+(\.\d+)?)px|em/;var setPixelWidth=function(cell,amount){Css.set(cell,"width",amount+"px")};var setPercentageWidth=function(cell,amount){Css.set(cell,"width",amount+"%")};var setHeight=function(cell,amount){Css.set(cell,"height",amount+"px")};var getHeightValue=function(cell){return Css.getRaw(cell,"height").getOrThunk(function(){return RuntimeSize.getHeight(cell)+"px"})};var convert=function(cell,number,getter,setter){var newSize=TableLookup.table(cell).map(function(table){var total=getter(table);return Math.floor(number/100*total)}).getOr(number);setter(cell,newSize);return newSize};var normalizePixelSize=function(value,cell,getter,setter){var number=parseInt(value,10);return Strings.endsWith(value,"%")&&Node.name(cell)!=="table"?convert(cell,number,getter,setter):number};var getTotalHeight=function(cell){var value=getHeightValue(cell);if(!value){return Height.get(cell)}return normalizePixelSize(value,cell,Height.get,setHeight)};var get=function(cell,type,f){var v=f(cell);var span=getSpan(cell,type);return v/span};var getSpan=function(cell,type){return Attr.has(cell,type)?parseInt(Attr.get(cell,type),10):1};var getRawWidth=function(element){var cssWidth=Css.getRaw(element,"width");return cssWidth.fold(function(){return Option.from(Attr.get(element,"width"))},function(width){return Option.some(width)})};var normalizePercentageWidth=function(cellWidth,tableSize){return cellWidth/tableSize.pixelWidth()*100};var choosePercentageSize=function(element,width,tableSize){if(percentageBasedSizeRegex.test(width)){var percentMatch=percentageBasedSizeRegex.exec(width);return parseFloat(percentMatch[1],10)}else{var fallbackWidth=Width.get(element);var intWidth=parseInt(fallbackWidth,10);return normalizePercentageWidth(intWidth,tableSize)}};var getPercentageWidth=function(cell,tableSize){var width=getRawWidth(cell);return width.fold(function(){var width=Width.get(cell);var intWidth=parseInt(width,10);return normalizePercentageWidth(intWidth,tableSize)},function(width){return choosePercentageSize(cell,width,tableSize)})};var normalizePixelWidth=function(cellWidth,tableSize){return cellWidth/100*tableSize.pixelWidth()};var choosePixelSize=function(element,width,tableSize){if(pixelBasedSizeRegex.test(width)){var pixelMatch=pixelBasedSizeRegex.exec(width);return parseInt(pixelMatch[1],10)}else if(percentageBasedSizeRegex.test(width)){var percentMatch=percentageBasedSizeRegex.exec(width);var floatWidth=parseFloat(percentMatch[1],10);return normalizePixelWidth(floatWidth,tableSize)}else{var fallbackWidth=Width.get(element);return parseInt(fallbackWidth,10)}};var getPixelWidth=function(cell,tableSize){var width=getRawWidth(cell);return width.fold(function(){var width=Width.get(cell);var intWidth=parseInt(width,10);return intWidth},function(width){return choosePixelSize(cell,width,tableSize)})};var getHeight=function(cell){return get(cell,"rowspan",getTotalHeight)};var getGenericWidth=function(cell){var width=getRawWidth(cell);return width.bind(function(width){if(genericSizeRegex.test(width)){var match=genericSizeRegex.exec(width);return Option.some({width:Fun.constant(match[1]),unit:Fun.constant(match[3])})}else{return Option.none()}})};var setGenericWidth=function(cell,amount,unit){Css.set(cell,"width",amount+unit)};return{percentageBasedSizeRegex:Fun.constant(percentageBasedSizeRegex),pixelBasedSizeRegex:Fun.constant(pixelBasedSizeRegex),setPixelWidth:setPixelWidth,setPercentageWidth:setPercentageWidth,setHeight:setHeight,getPixelWidth:getPixelWidth,getPercentageWidth:getPercentageWidth,getGenericWidth:getGenericWidth,setGenericWidth:setGenericWidth,getHeight:getHeight,getRawWidth:getRawWidth}});define("ephox.snooker.api.CellMutations",["ephox.snooker.resize.Sizes"],function(Sizes){var halve=function(main,other){var width=Sizes.getGenericWidth(main);width.each(function(width){var newWidth=width.width()/2;Sizes.setGenericWidth(main,newWidth,width.unit());Sizes.setGenericWidth(other,newWidth,width.unit())})};return{halve:halve}});define("ephox.sugar.api.view.Position",["ephox.katamari.api.Fun"],function(Fun){var r=function(left,top){var translate=function(x,y){return r(left+x,top+y)};return{left:Fun.constant(left),top:Fun.constant(top),translate:translate}};return r});define("ephox.sugar.api.dom.Dom",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","global!document"],function(Fun,Compare,Element,Node,PredicateFind,document){var attached=function(element,scope){var doc=scope||Element.fromDom(document.documentElement);return PredicateFind.ancestor(element,Fun.curry(Compare.eq,doc)).isSome()};var windowOf=function(element){var dom=element.dom();if(dom===dom.window){return element}return Node.isDocument(element)?dom.defaultView||dom.parentWindow:null};return{attached:attached,windowOf:windowOf}});define("ephox.sugar.api.view.Location",["ephox.sugar.api.view.Position","ephox.sugar.api.dom.Dom","ephox.sugar.api.node.Element"],function(Position,Dom,Element){var boxPosition=function(dom){var box=dom.getBoundingClientRect();return Position(box.left,box.top)};var firstDefinedOrZero=function(a,b){return a!==undefined?a:b!==undefined?b:0};var absolute=function(element){var doc=element.dom().ownerDocument;var body=doc.body;var win=Dom.windowOf(Element.fromDom(doc));var html=doc.documentElement;var scrollTop=firstDefinedOrZero(win.pageYOffset,html.scrollTop);var scrollLeft=firstDefinedOrZero(win.pageXOffset,html.scrollLeft);var clientTop=firstDefinedOrZero(html.clientTop,body.clientTop);var clientLeft=firstDefinedOrZero(html.clientLeft,body.clientLeft);return viewport(element).translate(scrollLeft-clientLeft,scrollTop-clientTop)};var relative=function(element){var dom=element.dom();return Position(dom.offsetLeft,dom.offsetTop)};var viewport=function(element){var dom=element.dom();var doc=dom.ownerDocument;var body=doc.body;var html=Element.fromDom(doc.documentElement);if(body===dom){return Position(body.offsetLeft,body.offsetTop)}if(!Dom.attached(element,html)){return Position(0,0)}return boxPosition(dom)};return{absolute:absolute,relative:relative,viewport:viewport}});define("ephox.snooker.resize.BarPositions",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Struct","ephox.sugar.api.view.Height","ephox.sugar.api.view.Location","ephox.sugar.api.view.Width"],function(Arr,Fun,Struct,Height,Location,Width){var rowInfo=Struct.immutable("row","y");var colInfo=Struct.immutable("col","x");var rtlEdge=function(cell){var pos=Location.absolute(cell);return pos.left()+Width.getOuter(cell)};var ltrEdge=function(cell){return Location.absolute(cell).left()};var getLeftEdge=function(index,cell){return colInfo(index,ltrEdge(cell))};var getRightEdge=function(index,cell){return colInfo(index,rtlEdge(cell))};var getTop=function(cell){return Location.absolute(cell).top()};var getTopEdge=function(index,cell){return rowInfo(index,getTop(cell))};var getBottomEdge=function(index,cell){return rowInfo(index,getTop(cell)+Height.getOuter(cell))};var findPositions=function(getInnerEdge,getOuterEdge,array){if(array.length===0){return[]}var lines=Arr.map(array.slice(1),function(cellOption,index){return cellOption.map(function(cell){return getInnerEdge(index,cell)})});var lastLine=array[array.length-1].map(function(cell){return getOuterEdge(array.length-1,cell)});return lines.concat([lastLine])};var negate=function(step,_table){return-step};var height={delta:Fun.identity,positions:Fun.curry(findPositions,getTopEdge,getBottomEdge),edge:getTop};var ltr={delta:Fun.identity,edge:ltrEdge,positions:Fun.curry(findPositions,getLeftEdge,getRightEdge)};var rtl={delta:negate,edge:rtlEdge,positions:Fun.curry(findPositions,getRightEdge,getLeftEdge)};return{height:height,rtl:rtl,ltr:ltr}});define("ephox.snooker.api.ResizeDirection",["ephox.snooker.resize.BarPositions"],function(BarPositions){return{ltr:BarPositions.ltr,rtl:BarPositions.rtl}});define("ephox.snooker.api.TableDirection",["ephox.snooker.api.ResizeDirection"],function(ResizeDirection){return function(directionAt){var auto=function(table){return directionAt(table).isRtl()?ResizeDirection.rtl:ResizeDirection.ltr};var delta=function(amount,table){return auto(table).delta(amount,table)};var positions=function(cols,table){return auto(table).positions(cols,table)};var edge=function(cell){return auto(cell).edge(cell)};return{delta:delta,edge:edge,positions:positions}}});define("ephox.snooker.api.TableGridSize",["ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse"],function(DetailsList,Warehouse){var getGridSize=function(table){var input=DetailsList.fromTable(table);var warehouse=Warehouse.generate(input);return warehouse.grid()};return{getGridSize:getGridSize}});define("ephox.katamari.api.Cell",[],function(){var Cell=function(initial){var value=initial;var get=function(){return value};var set=function(v){value=v};var clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}};return Cell});define("ephox.katamari.api.Contracts",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Type","ephox.katamari.util.BagUtils","global!Error"],function(Arr,Fun,Obj,Type,BagUtils,Error){var base=function(handleUnsupported,required){return baseWith(handleUnsupported,required,{validate:Type.isFunction,label:"function"})};var baseWith=function(handleUnsupported,required,pred){if(required.length===0){throw new Error("You must specify at least one required field.")}BagUtils.validateStrArr("required",required);BagUtils.checkDupes(required);return function(obj){var keys=Obj.keys(obj);var allReqd=Arr.forall(required,function(req){return Arr.contains(keys,req)});if(!allReqd){BagUtils.reqMessage(required,keys)}handleUnsupported(required,keys);var invalidKeys=Arr.filter(required,function(key){return!pred.validate(obj[key],key)});if(invalidKeys.length>0){BagUtils.invalidTypeMessage(invalidKeys,pred.label)}return obj}};var handleExact=function(required,keys){var unsupported=Arr.filter(keys,function(key){return!Arr.contains(required,key)});if(unsupported.length>0){BagUtils.unsuppMessage(unsupported)}};var allowExtra=Fun.noop;return{exactly:Fun.curry(base,handleExact),ensure:Fun.curry(base,allowExtra),ensureWith:Fun.curry(baseWith,allowExtra)}});define("ephox.snooker.api.Generators",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Cell","ephox.katamari.api.Contracts","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","global!parseInt"],function(Arr,Fun,Option,Cell,Contracts,Attr,Css,parseInt){var elementToData=function(element){var colspan=Attr.has(element,"colspan")?parseInt(Attr.get(element,"colspan"),10):1;var rowspan=Attr.has(element,"rowspan")?parseInt(Attr.get(element,"rowspan"),10):1;return{element:Fun.constant(element),colspan:Fun.constant(colspan),rowspan:Fun.constant(rowspan)}};var modification=function(generators,_toData){contract(generators);var position=Cell(Option.none());var toData=_toData!==undefined?_toData:elementToData;var nu=function(data){return generators.cell(data)};var nuFrom=function(element){var data=toData(element);return nu(data)};var add=function(element){var replacement=nuFrom(element);if(position.get().isNone()){position.set(Option.some(replacement))}recent=Option.some({item:element,replacement:replacement});return replacement};var recent=Option.none();var getOrInit=function(element,comparator){return recent.fold(function(){return add(element)},function(p){return comparator(element,p.item)?p.replacement:add(element)})};return{getOrInit:getOrInit,cursor:position.get}};var transform=function(scope,tag){return function(generators){var position=Cell(Option.none());contract(generators);var list=[];var find=function(element,comparator){return Arr.find(list,function(x){return comparator(x.item,element)})};var makeNew=function(element){var cell=generators.replace(element,tag,{scope:scope});list.push({item:element,sub:cell});if(position.get().isNone()){position.set(Option.some(cell))}return cell};var replaceOrInit=function(element,comparator){return find(element,comparator).fold(function(){return makeNew(element)},function(p){return comparator(element,p.item)?p.sub:makeNew(element)})};return{replaceOrInit:replaceOrInit,cursor:position.get}}};var merging=function(generators){contract(generators);var position=Cell(Option.none());var combine=function(cell){if(position.get().isNone()){position.set(Option.some(cell))}return function(){var raw=generators.cell({element:Fun.constant(cell),colspan:Fun.constant(1),rowspan:Fun.constant(1)});Css.remove(raw,"width");Css.remove(cell,"width");return raw}};return{combine:combine,cursor:position.get}};var contract=Contracts.exactly(["cell","row","replace","gap"]);return{modification:modification,transform:transform,merging:merging}});define("ephox.robin.api.general.Structure",["ephox.katamari.api.Arr"],function(Arr){var blockList=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];var isList=function(universe,item){var tagName=universe.property().name(item);return Arr.contains(["ol","ul"],tagName)};var isBlock=function(universe,item){var tagName=universe.property().name(item);return Arr.contains(blockList,tagName)};var isFormatting=function(universe,item){var tagName=universe.property().name(item);return Arr.contains(["address","pre","p","h1","h2","h3","h4","h5","h6"],tagName)};var isHeading=function(universe,item){var tagName=universe.property().name(item);return Arr.contains(["h1","h2","h3","h4","h5","h6"],tagName)};var isContainer=function(universe,item){return Arr.contains(["div","li","td","th","blockquote","body","caption"],universe.property().name(item))};var isEmptyTag=function(universe,item){return Arr.contains(["br","img","hr","input"],universe.property().name(item))};var isFrame=function(universe,item){return universe.property().name(item)==="iframe"};var isInline=function(universe,item){return!(isBlock(universe,item)||isEmptyTag(universe,item))&&universe.property().name(item)!=="li"};return{isBlock:isBlock,isList:isList,isFormatting:isFormatting,isHeading:isHeading,isContainer:isContainer,isEmptyTag:isEmptyTag,isFrame:isFrame,isInline:isInline}});define("ephox.robin.api.dom.DomStructure",["ephox.boss.api.DomUniverse","ephox.robin.api.general.Structure"],function(DomUniverse,Structure){var universe=DomUniverse();var isBlock=function(element){return Structure.isBlock(universe,element)};var isList=function(element){return Structure.isList(universe,element)};var isFormatting=function(element){return Structure.isFormatting(universe,element)};var isHeading=function(element){return Structure.isHeading(universe,element)};var isContainer=function(element){return Structure.isContainer(universe,element)};var isEmptyTag=function(element){return Structure.isEmptyTag(universe,element)};var isFrame=function(element){return Structure.isFrame(universe,element)};var isInline=function(element){return Structure.isInline(universe,element)};return{isBlock:isBlock,isList:isList,isFormatting:isFormatting,isHeading:isHeading,isContainer:isContainer,isEmptyTag:isEmptyTag,isFrame:isFrame,isInline:isInline}});define("ephox.snooker.api.TableContent",["ephox.katamari.api.Arr","ephox.robin.api.dom.DomStructure","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.CursorPosition"],function(Arr,DomStructure,Compare,InsertAll,Remove,Element,Node,Text,PredicateFind,Traverse,CursorPosition){var merge=function(cells){var isBr=function(el){return Node.name(el)==="br"};var advancedBr=function(children){return Arr.forall(children,function(c){return isBr(c)||Node.isText(c)&&Text.get(c).trim().length===0})};var isListItem=function(el){return Node.name(el)==="li"||PredicateFind.ancestor(el,DomStructure.isList).isSome()};var siblingIsBlock=function(el){return Traverse.nextSibling(el).map(function(rightSibling){if(DomStructure.isBlock(rightSibling)){return true}if(DomStructure.isEmptyTag(rightSibling)){return Node.name(rightSibling)==="img"?false:true}}).getOr(false)};var markCell=function(cell){return CursorPosition.last(cell).bind(function(rightEdge){var rightSiblingIsBlock=siblingIsBlock(rightEdge);return Traverse.parent(rightEdge).map(function(parent){return rightSiblingIsBlock===true||isListItem(parent)||isBr(rightEdge)||DomStructure.isBlock(parent)&&!Compare.eq(cell,parent)?[]:[Element.fromTag("br")]})}).getOr([])};var markContent=function(){var content=Arr.bind(cells,function(cell){var children=Traverse.children(cell);return advancedBr(children)?[]:children.concat(markCell(cell))});return content.length===0?[Element.fromTag("br")]:content};var contents=markContent();Remove.empty(cells[0]);InsertAll.append(cells[0],contents)};return{merge:merge}});define("ephox.snooker.model.GridRow",["ephox.katamari.api.Arr","ephox.snooker.api.Structs"],function(Arr,Structs){var addCell=function(gridRow,index,cell){var cells=gridRow.cells();var before=cells.slice(0,index);var after=cells.slice(index);var newCells=before.concat([cell]).concat(after);return setCells(gridRow,newCells)};var mutateCell=function(gridRow,index,cell){var cells=gridRow.cells();cells[index]=cell};var setCells=function(gridRow,cells){return Structs.rowcells(cells,gridRow.section())};var mapCells=function(gridRow,f){var cells=gridRow.cells();var r=Arr.map(cells,f);return Structs.rowcells(r,gridRow.section())};var getCell=function(gridRow,index){return gridRow.cells()[index]};var getCellElement=function(gridRow,index){return getCell(gridRow,index).element()};var cellLength=function(gridRow){return gridRow.cells().length};return{addCell:addCell,setCells:setCells,mutateCell:mutateCell,getCell:getCell,getCellElement:getCellElement,mapCells:mapCells,cellLength:cellLength}});define("ephox.katamari.api.Merger",["ephox.katamari.api.Type","global!Array","global!Error"],function(Type,Array,Error){var shallow=function(old,nu){return nu};var deep=function(old,nu){var bothObjects=Type.isObject(old)&&Type.isObject(nu);return bothObjects?deepMerge(old,nu):nu};var baseMerge=function(merger){return function(){var objects=new Array(arguments.length);for(var i=0;i<objects.length;i++){objects[i]=arguments[i]}if(objects.length===0){throw new Error("Can't merge zero objects")}var ret={};for(var j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject){if(curObject.hasOwnProperty(key)){ret[key]=merger(ret[key],curObject[key])}}}return ret}};var deepMerge=baseMerge(deep);var merge=baseMerge(shallow);return{deepMerge:deepMerge,merge:merge}});define("ephox.katamari.api.Options",["ephox.katamari.api.Option"],function(Option){var cat=function(arr){var r=[];var push=function(x){r.push(x)};for(var i=0;i<arr.length;i++){arr[i].each(push)}return r};var findMap=function(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome()){return r}}return Option.none()};var liftN=function(arr,f){var r=[];for(var i=0;i<arr.length;i++){var x=arr[i];if(x.isSome()){r.push(x.getOrDie())}else{return Option.none()}}return Option.some(f.apply(null,r))};return{cat:cat,findMap:findMap,liftN:liftN}});define("ephox.snooker.model.TableGrid",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.model.GridRow"],function(Arr,Fun,GridRow){var getColumn=function(grid,index){return Arr.map(grid,function(row){return GridRow.getCell(row,index)})};var getRow=function(grid,index){return grid[index]};var findDiff=function(xs,comp){if(xs.length===0){return 0}var first=xs[0];var index=Arr.findIndex(xs,function(x){return!comp(first.element(),x.element())});return index.fold(function(){return xs.length},function(ind){return ind})};var subgrid=function(grid,row,column,comparator){var restOfRow=getRow(grid,row).cells().slice(column);var endColIndex=findDiff(restOfRow,comparator);var restOfColumn=getColumn(grid,column).slice(row);var endRowIndex=findDiff(restOfColumn,comparator);return{colspan:Fun.constant(endColIndex),rowspan:Fun.constant(endRowIndex)}};return{subgrid:subgrid}});define("ephox.snooker.model.Transitions",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.model.TableGrid","ephox.snooker.model.Warehouse"],function(Arr,Structs,TableGrid,Warehouse){var toDetails=function(grid,comparator){var seen=Arr.map(grid,function(row,ri){return Arr.map(row.cells(),function(col,ci){return false})});var updateSeen=function(ri,ci,rowspan,colspan){for(var r=ri;r<ri+rowspan;r++){for(var c=ci;c<ci+colspan;c++){seen[r][c]=true}}};return Arr.map(grid,function(row,ri){var details=Arr.bind(row.cells(),function(cell,ci){if(seen[ri][ci]===false){var result=TableGrid.subgrid(grid,ri,ci,comparator);updateSeen(ri,ci,result.rowspan(),result.colspan());return[Structs.detailnew(cell.element(),result.rowspan(),result.colspan(),cell.isNew())]}else{return[]}});return Structs.rowdetails(details,row.section())})};var toGrid=function(warehouse,generators,isNew){var grid=[];for(var i=0;i<warehouse.grid().rows();i++){var rowCells=[];for(var j=0;j<warehouse.grid().columns();j++){var element=Warehouse.getAt(warehouse,i,j).map(function(item){return Structs.elementnew(item.element(),isNew)}).getOrThunk(function(){return Structs.elementnew(generators.gap(),true)});rowCells.push(element)}var row=Structs.rowcells(rowCells,warehouse.all()[i].section());grid.push(row)}return grid};return{toDetails:toDetails,toGrid:toGrid}});define("ephox.snooker.operate.Redraw",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.dom.Replication","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse"],function(Arr,Fun,Attr,Element,Insert,InsertAll,Remove,Replication,SelectorFind,Traverse){var setIfNot=function(element,property,value,ignore){if(value===ignore){Attr.remove(element,property)}else{Attr.set(element,property,value)}};var render=function(table,grid){var newRows=[];var newCells=[];var renderSection=function(gridSection,sectionName){var section=SelectorFind.child(table,sectionName).getOrThunk(function(){var tb=Element.fromTag(sectionName,Traverse.owner(table).dom());Insert.append(table,tb);return tb});Remove.empty(section);var rows=Arr.map(gridSection,function(row){if(row.isNew()){newRows.push(row.element())}var tr=row.element();Remove.empty(tr);Arr.each(row.cells(),function(cell){if(cell.isNew()){newCells.push(cell.element())}setIfNot(cell.element(),"colspan",cell.colspan(),1);setIfNot(cell.element(),"rowspan",cell.rowspan(),1);Insert.append(tr,cell.element())});return tr});InsertAll.append(section,rows)};var removeSection=function(sectionName){SelectorFind.child(table,sectionName).bind(Remove.remove)};var renderOrRemoveSection=function(gridSection,sectionName){if(gridSection.length>0){renderSection(gridSection,sectionName)}else{removeSection(sectionName)}};var headSection=[];var bodySection=[];var footSection=[];Arr.each(grid,function(row){switch(row.section()){case"thead":headSection.push(row);break;case"tbody":bodySection.push(row);break;case"tfoot":footSection.push(row);break}});renderOrRemoveSection(headSection,"thead");renderOrRemoveSection(bodySection,"tbody");renderOrRemoveSection(footSection,"tfoot");return{newRows:Fun.constant(newRows),newCells:Fun.constant(newCells)}};var copy=function(grid){var rows=Arr.map(grid,function(row){var tr=Replication.shallow(row.element());Arr.each(row.cells(),function(cell){var clonedCell=Replication.deep(cell.element());setIfNot(clonedCell,"colspan",cell.colspan(),1);setIfNot(clonedCell,"rowspan",cell.rowspan(),1);Insert.append(tr,clonedCell)});return tr});return rows};return{render:render,copy:copy}});define("ephox.snooker.util.Util",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.katamari.api.Options","global!Math"],function(Arr,Option,Options,Math){var repeat=function(repititions,f){var r=[];for(var i=0;i<repititions;i++){r.push(f(i))}return r};var range=function(start,end){var r=[];for(var i=start;i<end;i++){r.push(i)}return r};var unique=function(xs,comparator){var result=[];Arr.each(xs,function(x,i){if(i<xs.length-1&&!comparator(x,xs[i+1])){result.push(x)}else if(i===xs.length-1){result.push(x)}});return result};var deduce=function(xs,index){if(index<0||index>=xs.length-1){return Option.none()}var current=xs[index].fold(function(){var rest=Arr.reverse(xs.slice(0,index));return Options.findMap(rest,function(a,i){return a.map(function(aa){return{value:aa,delta:i+1}})})},function(c){return Option.some({value:c,delta:0})});var next=xs[index+1].fold(function(){var rest=xs.slice(index+1);return Options.findMap(rest,function(a,i){return a.map(function(aa){return{value:aa,delta:i+1}})})},function(n){return Option.some({value:n,delta:1})});return current.bind(function(c){return next.map(function(n){var extras=n.delta+c.delta;return Math.abs(n.value-c.value)/extras})})};return{repeat:repeat,range:range,unique:unique,deduce:deduce}});define("ephox.snooker.lookup.Blocks",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.model.Warehouse","ephox.snooker.util.Util"],function(Arr,Fun,Option,Warehouse,Util){var columns=function(warehouse){var grid=warehouse.grid();var cols=Util.range(0,grid.columns());var rows=Util.range(0,grid.rows());return Arr.map(cols,function(col){var getBlock=function(){return Arr.bind(rows,function(r){return Warehouse.getAt(warehouse,r,col).filter(function(detail){return detail.column()===col}).fold(Fun.constant([]),function(detail){return[detail]})})};var isSingle=function(detail){return detail.colspan()===1};var getFallback=function(){return Warehouse.getAt(warehouse,0,col)};return decide(getBlock,isSingle,getFallback)})};var decide=function(getBlock,isSingle,getFallback){var inBlock=getBlock();var singleInBlock=Arr.find(inBlock,isSingle);var detailOption=singleInBlock.orThunk(function(){return Option.from(inBlock[0]).orThunk(getFallback)});return detailOption.map(function(detail){return detail.element()})};var rows=function(warehouse){var grid=warehouse.grid();var rows=Util.range(0,grid.rows());var cols=Util.range(0,grid.columns());return Arr.map(rows,function(row){var getBlock=function(){return Arr.bind(cols,function(c){return Warehouse.getAt(warehouse,row,c).filter(function(detail){return detail.row()===row}).fold(Fun.constant([]),function(detail){return[detail]})})};var isSingle=function(detail){return detail.rowspan()===1};var getFallback=function(){return Warehouse.getAt(warehouse,row,0)};return decide(getBlock,isSingle,getFallback)})};return{columns:columns,rows:rows}});define("ephox.snooker.resize.Bar",["ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element"],function(Attr,Css,Element){var col=function(column,x,y,w,h){var blocker=Element.fromTag("div");Css.setAll(blocker,{position:"absolute",left:x-w/2+"px",top:y+"px",height:h+"px",width:w+"px"});Attr.set(blocker,"data-column",column);return blocker};var row=function(row,x,y,w,h){var blocker=Element.fromTag("div");Css.setAll(blocker,{position:"absolute",left:x+"px",top:y-h/2+"px",height:h+"px",width:w+"px"});Attr.set(blocker,"data-row",row);return blocker};return{col:col,row:row}});define("ephox.katamari.api.Namespace",[],function(){var css=function(namespace){var dashNamespace=namespace.replace(/\./g,"-");var resolve=function(str){return dashNamespace+"-"+str};return{resolve:resolve}};return{css:css}});define("ephox.snooker.style.Styles",["ephox.katamari.api.Namespace"],function(Namespace){var styles=Namespace.css("ephox-snooker");return{resolve:styles.resolve}});define("ephox.sugar.api.properties.Toggler",[],function(){return function(turnOff,turnOn,initial){var active=initial||false;var on=function(){turnOn();active=true};var off=function(){turnOff();active=false};var toggle=function(){var f=active?off:on;f()};var isOn=function(){return active};return{on:on,off:off,toggle:toggle,isOn:isOn}}});define("ephox.sugar.api.properties.AttrList",["ephox.katamari.api.Arr","ephox.sugar.api.properties.Attr"],function(Arr,Attr){var read=function(element,attr){var value=Attr.get(element,attr);return value===undefined||value===""?[]:value.split(" ")};var add=function(element,attr,id){var old=read(element,attr);var nu=old.concat([id]);Attr.set(element,attr,nu.join(" "))};var remove=function(element,attr,id){var nu=Arr.filter(read(element,attr),function(v){return v!==id});if(nu.length>0){Attr.set(element,attr,nu.join(" "))}else{Attr.remove(element,attr)}};return{read:read,add:add,remove:remove}});define("ephox.sugar.impl.ClassList",["ephox.katamari.api.Arr","ephox.sugar.api.properties.AttrList"],function(Arr,AttrList){var supports=function(element){return element.dom().classList!==undefined};var get=function(element){return AttrList.read(element,"class")};var add=function(element,clazz){return AttrList.add(element,"class",clazz)};var remove=function(element,clazz){return AttrList.remove(element,"class",clazz)};var toggle=function(element,clazz){if(Arr.contains(get(element),clazz)){remove(element,clazz)}else{add(element,clazz)}};return{get:get,add:add,remove:remove,toggle:toggle,supports:supports}});define("ephox.sugar.api.properties.Class",["ephox.sugar.api.properties.Toggler","ephox.sugar.api.properties.Attr","ephox.sugar.impl.ClassList"],function(Toggler,Attr,ClassList){var add=function(element,clazz){if(ClassList.supports(element)){element.dom().classList.add(clazz)}else{ClassList.add(element,clazz)}};var cleanClass=function(element){var classList=ClassList.supports(element)?element.dom().classList:ClassList.get(element);if(classList.length===0){Attr.remove(element,"class")}};var remove=function(element,clazz){if(ClassList.supports(element)){var classList=element.dom().classList;classList.remove(clazz)}else{ClassList.remove(element,clazz)}cleanClass(element)};var toggle=function(element,clazz){return ClassList.supports(element)?element.dom().classList.toggle(clazz):ClassList.toggle(element,clazz)};var toggler=function(element,clazz){var hasClasslist=ClassList.supports(element);var classList=element.dom().classList;var off=function(){if(hasClasslist){classList.remove(clazz)}else{ClassList.remove(element,clazz)}};var on=function(){if(hasClasslist){classList.add(clazz)}else{ClassList.add(element,clazz)}};return Toggler(off,on,has(element,clazz))};var has=function(element,clazz){return ClassList.supports(element)&&element.dom().classList.contains(clazz)};return{add:add,remove:remove,toggle:toggle,toggler:toggler,has:has}});define("ephox.snooker.resize.Bars",["ephox.katamari.api.Arr","ephox.snooker.lookup.Blocks","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.resize.Bar","ephox.snooker.style.Styles","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Css","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.view.Height","ephox.sugar.api.view.Location","ephox.sugar.api.view.Width"],function(Arr,Blocks,DetailsList,Warehouse,Bar,Styles,Insert,Remove,Class,Css,SelectorFilter,Height,Location,Width){var resizeBar=Styles.resolve("resizer-bar");var resizeRowBar=Styles.resolve("resizer-rows");var resizeColBar=Styles.resolve("resizer-cols");var BAR_THICKNESS=7;var clear=function(wire){var previous=SelectorFilter.descendants(wire.parent(),"."+resizeBar);Arr.each(previous,Remove.remove)};var drawBar=function(wire,positions,create){var origin=wire.origin();Arr.each(positions,function(cpOption,i){cpOption.each(function(cp){var bar=create(origin,cp);Class.add(bar,resizeBar);Insert.append(wire.parent(),bar)})})};var refreshCol=function(wire,colPositions,position,tableHeight){drawBar(wire,colPositions,function(origin,cp){var colBar=Bar.col(cp.col(),cp.x()-origin.left(),position.top()-origin.top(),BAR_THICKNESS,tableHeight);Class.add(colBar,resizeColBar);return colBar})};var refreshRow=function(wire,rowPositions,position,tableWidth){drawBar(wire,rowPositions,function(origin,cp){var rowBar=Bar.row(cp.row(),position.left()-origin.left(),cp.y()-origin.top(),tableWidth,BAR_THICKNESS);Class.add(rowBar,resizeRowBar);return rowBar})};var refreshGrid=function(wire,table,rows,cols,hdirection,vdirection){var position=Location.absolute(table);var rowPositions=rows.length>0?hdirection.positions(rows,table):[];refreshRow(wire,rowPositions,position,Width.getOuter(table));var colPositions=cols.length>0?vdirection.positions(cols,table):[];refreshCol(wire,colPositions,position,Height.getOuter(table))};var refresh=function(wire,table,hdirection,vdirection){clear(wire,table);var list=DetailsList.fromTable(table);var warehouse=Warehouse.generate(list);var rows=Blocks.rows(warehouse);var cols=Blocks.columns(warehouse);refreshGrid(wire,table,rows,cols,hdirection,vdirection)};var each=function(wire,f){var bars=SelectorFilter.descendants(wire.parent(),"."+resizeBar);Arr.each(bars,f)};var hide=function(wire){each(wire,function(bar){Css.set(bar,"display","none")})};var show=function(wire){each(wire,function(bar){Css.set(bar,"display","block")})};var isRowBar=function(element){return Class.has(element,resizeRowBar)};var isColBar=function(element){return Class.has(element,resizeColBar)};return{refresh:refresh,hide:hide,show:show,destroy:clear,isRowBar:isRowBar,isColBar:isColBar}});define("ephox.snooker.model.RunOperation",["ephox.katamari.api.Arr","ephox.katamari.api.Merger","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.snooker.api.Structs","ephox.snooker.api.TableLookup","ephox.snooker.model.DetailsList","ephox.snooker.model.Transitions","ephox.snooker.model.Warehouse","ephox.snooker.operate.Redraw","ephox.snooker.resize.BarPositions","ephox.snooker.resize.Bars","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.Traverse"],function(Arr,Merger,Fun,Option,Options,Structs,TableLookup,DetailsList,Transitions,Warehouse,Redraw,BarPositions,Bars,Compare,Traverse){var fromWarehouse=function(warehouse,generators){return Transitions.toGrid(warehouse,generators,false)};var deriveRows=function(rendered,generators){var findRow=function(details){var rowOfCells=Options.findMap(details,function(detail){return Traverse.parent(detail.element()).map(function(row){var isNew=Traverse.parent(row).isNone();return Structs.elementnew(row,isNew)})});return rowOfCells.getOrThunk(function(){return Structs.elementnew(generators.row(),true)})};return Arr.map(rendered,function(details){var row=findRow(details.details());return Structs.rowdatanew(row.element(),details.details(),details.section(),row.isNew())})};var toDetailList=function(grid,generators){var rendered=Transitions.toDetails(grid,Compare.eq);return deriveRows(rendered,generators)};var findInWarehouse=function(warehouse,element){var all=Arr.flatten(Arr.map(warehouse.all(),function(r){return r.cells()}));return Arr.find(all,function(e){return Compare.eq(element,e.element())})};var run=function(operation,extract,adjustment,postAction,genWrappers){return function(wire,table,target,generators,direction){var input=DetailsList.fromTable(table);var warehouse=Warehouse.generate(input);var output=extract(warehouse,target).map(function(info){var model=fromWarehouse(warehouse,generators);var result=operation(model,info,Compare.eq,genWrappers(generators));var grid=toDetailList(result.grid(),generators);return{grid:Fun.constant(grid),cursor:result.cursor}});return output.fold(function(){return Option.none()},function(out){var newElements=Redraw.render(table,out.grid());adjustment(table,out.grid(),direction);postAction(table);Bars.refresh(wire,table,BarPositions.height,direction);return Option.some({cursor:out.cursor,newRows:newElements.newRows,newCells:newElements.newCells})})}};var onCell=function(warehouse,target){return TableLookup.cell(target.element()).bind(function(cell){return findInWarehouse(warehouse,cell)})};var onPaste=function(warehouse,target){return TableLookup.cell(target.element()).bind(function(cell){return findInWarehouse(warehouse,cell).map(function(details){return Merger.merge(details,{generators:target.generators,clipboard:target.clipboard})})})};var onPasteRows=function(warehouse,target){var details=Arr.map(target.selection(),function(cell){return TableLookup.cell(cell).bind(function(lc){return findInWarehouse(warehouse,lc)})});var cells=Options.cat(details);return cells.length>0?Option.some(Merger.merge({cells:cells},{generators:target.generators,clipboard:target.clipboard})):Option.none()};var onMergable=function(warehouse,target){return target.mergable()};var onUnmergable=function(warehouse,target){return target.unmergable()};var onCells=function(warehouse,target){var details=Arr.map(target.selection(),function(cell){return TableLookup.cell(cell).bind(function(lc){return findInWarehouse(warehouse,lc)})});var cells=Options.cat(details);return cells.length>0?Option.some(cells):Option.none()};return{run:run,toDetailList:toDetailList,onCell:onCell,onCells:onCells,onPaste:onPaste,onPasteRows:onPasteRows,onMergable:onMergable,onUnmergable:onUnmergable}});define("ephox.katamari.api.Result",["ephox.katamari.api.Fun","ephox.katamari.api.Option"],function(Fun,Option){var value=function(o){var is=function(v){return o===v};var or=function(opt){return value(o)};var orThunk=function(f){return value(o)};var map=function(f){return value(f(o))};var each=function(f){f(o)};var bind=function(f){return f(o)};var fold=function(_,onValue){return onValue(o)};var exists=function(f){return f(o)};var forall=function(f){return f(o)};var toOption=function(){return Option.some(o)};return{is:is,isValue:Fun.constant(true),isError:Fun.constant(false),getOr:Fun.constant(o),getOrThunk:Fun.constant(o),getOrDie:Fun.constant(o),or:or,orThunk:orThunk,fold:fold,map:map,each:each,bind:bind,exists:exists,forall:forall,toOption:toOption}};var error=function(message){var getOrThunk=function(f){return f()};var getOrDie=function(){return Fun.die(message)()};var or=function(opt){return opt};var orThunk=function(f){return f()};var map=function(f){return error(message)};var bind=function(f){return error(message)};var fold=function(onError,_){return onError(message)};return{is:Fun.constant(false),isValue:Fun.constant(false),isError:Fun.constant(true),getOr:Fun.identity,getOrThunk:getOrThunk,getOrDie:getOrDie,or:or,orThunk:orThunk,fold:fold,map:map,each:Fun.noop,bind:bind,exists:Fun.constant(false),forall:Fun.constant(true),toOption:Option.none}};return{value:value,error:error}});define("ephox.snooker.model.Fitment",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Result","ephox.snooker.api.Structs","ephox.snooker.model.GridRow","ephox.snooker.util.Util","global!Array","global!Error","global!Math"],function(Arr,Fun,Result,Structs,GridRow,Util,Array,Error,Math){var measure=function(startAddress,gridA,gridB){if(startAddress.row()>=gridA.length||startAddress.column()>GridRow.cellLength(gridA[0])){return Result.error("invalid start address out of table bounds, row: "+startAddress.row()+", column: "+startAddress.column())}var rowRemainder=gridA.slice(startAddress.row());var colRemainder=rowRemainder[0].cells().slice(startAddress.column());var colRequired=GridRow.cellLength(gridB[0]);var rowRequired=gridB.length;return Result.value({rowDelta:Fun.constant(rowRemainder.length-rowRequired),colDelta:Fun.constant(colRemainder.length-colRequired)})};var measureWidth=function(gridA,gridB){var colLengthA=GridRow.cellLength(gridA[0]);var colLengthB=GridRow.cellLength(gridB[0]);return{rowDelta:Fun.constant(0),colDelta:Fun.constant(colLengthA-colLengthB)}};var fill=function(cells,generator){return Arr.map(cells,function(){return Structs.elementnew(generator.cell(),true)})};var rowFill=function(grid,amount,generator){return grid.concat(Util.repeat(amount,function(_row){return GridRow.setCells(grid[grid.length-1],fill(grid[grid.length-1].cells(),generator))}))};var colFill=function(grid,amount,generator){return Arr.map(grid,function(row){return GridRow.setCells(row,row.cells().concat(fill(Util.range(0,amount),generator)))})};var tailor=function(gridA,delta,generator){var fillCols=delta.colDelta()<0?colFill:Fun.identity;var fillRows=delta.rowDelta()<0?rowFill:Fun.identity;var modifiedCols=fillCols(gridA,Math.abs(delta.colDelta()),generator);var tailoredGrid=fillRows(modifiedCols,Math.abs(delta.rowDelta()),generator);return tailoredGrid};return{measure:measure,measureWidth:measureWidth,tailor:tailor}});define("ephox.snooker.operate.MergingOperations",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.Structs","ephox.snooker.model.GridRow"],function(Arr,Option,Structs,GridRow){var merge=function(grid,bounds,comparator,substitution){if(grid.length===0){return grid}for(var i=bounds.startRow();i<=bounds.finishRow();i++){for(var j=bounds.startCol();j<=bounds.finishCol();j++){GridRow.mutateCell(grid[i],j,Structs.elementnew(substitution(),false))}}return grid};var unmerge=function(grid,target,comparator,substitution){var first=true;for(var i=0;i<grid.length;i++){for(var j=0;j<GridRow.cellLength(grid[0]);j++){var current=GridRow.getCellElement(grid[i],j);var isToReplace=comparator(current,target);if(isToReplace===true&&first===false){GridRow.mutateCell(grid[i],j,Structs.elementnew(substitution(),true))}else if(isToReplace===true){first=false}}}return grid};var uniqueCells=function(row,comparator){return Arr.foldl(row,function(rest,cell){return Arr.exists(rest,function(currentCell){return comparator(currentCell.element(),cell.element())})?rest:rest.concat([cell])},[])};var splitRows=function(grid,index,comparator,substitution){if(index>0&&index<grid.length){var rowPrevCells=grid[index-1].cells();var cells=uniqueCells(rowPrevCells,comparator);Arr.each(cells,function(cell){var replacement=Option.none();for(var i=index;i<grid.length;i++){for(var j=0;j<GridRow.cellLength(grid[0]);j++){var current=grid[i].cells()[j];var isToReplace=comparator(current.element(),cell.element());if(isToReplace){if(replacement.isNone()){replacement=Option.some(substitution())}replacement.each(function(sub){GridRow.mutateCell(grid[i],j,Structs.elementnew(sub,true))})}}}})}return grid};return{merge:merge,unmerge:unmerge,splitRows:splitRows}});define("ephox.snooker.model.TableMerge",["ephox.katamari.api.Fun","ephox.snooker.api.Structs","ephox.snooker.model.Fitment","ephox.snooker.model.GridRow","ephox.snooker.operate.MergingOperations"],function(Fun,Structs,Fitment,GridRow,MergingOperations){var isSpanning=function(grid,row,col,comparator){var candidate=GridRow.getCell(grid[row],col);var matching=Fun.curry(comparator,candidate.element());var currentRow=grid[row];return grid.length>1&&GridRow.cellLength(currentRow)>1&&(col>0&&matching(GridRow.getCellElement(currentRow,col-1))||col<currentRow.length-1&&matching(GridRow.getCellElement(currentRow,col+1))||row>0&&matching(GridRow.getCellElement(grid[row-1],col))||row<grid.length-1&&matching(GridRow.getCellElement(grid[row+1],col)))};var mergeTables=function(startAddress,gridA,gridB,generator,comparator){var startRow=startAddress.row();var startCol=startAddress.column();var mergeHeight=gridB.length;var mergeWidth=GridRow.cellLength(gridB[0]);var endRow=startRow+mergeHeight;var endCol=startCol+mergeWidth;for(var r=startRow;r<endRow;r++){for(var c=startCol;c<endCol;c++){if(isSpanning(gridA,r,c,comparator)){MergingOperations.unmerge(gridA,GridRow.getCellElement(gridA[r],c),comparator,generator.cell)}var newCell=GridRow.getCellElement(gridB[r-startRow],c-startCol);var replacement=generator.replace(newCell);GridRow.mutateCell(gridA[r],c,Structs.elementnew(replacement,true))}}return gridA};var merge=function(startAddress,gridA,gridB,generator,comparator){var result=Fitment.measure(startAddress,gridA,gridB);return result.map(function(delta){var fittedGrid=Fitment.tailor(gridA,delta,generator);return mergeTables(startAddress,fittedGrid,gridB,generator,comparator)})};var insert=function(index,gridA,gridB,generator,comparator){MergingOperations.splitRows(gridA,index,comparator,generator.cell);var delta=Fitment.measureWidth(gridB,gridA);var fittedNewGrid=Fitment.tailor(gridB,delta,generator);var secondDelta=Fitment.measureWidth(gridA,fittedNewGrid);var fittedOldGrid=Fitment.tailor(gridA,secondDelta,generator);return fittedOldGrid.slice(0,index).concat(fittedNewGrid).concat(fittedOldGrid.slice(index,fittedOldGrid.length))};return{merge:merge,insert:insert}});define("ephox.snooker.operate.ModificationOperations",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.model.GridRow"],function(Arr,Structs,GridRow){var insertRowAt=function(grid,index,example,comparator,substitution){var before=grid.slice(0,index);var after=grid.slice(index);var between=GridRow.mapCells(grid[example],function(ex,c){var withinSpan=index>0&&index<grid.length&&comparator(GridRow.getCellElement(grid[index-1],c),GridRow.getCellElement(grid[index],c));var ret=withinSpan?GridRow.getCell(grid[index],c):Structs.elementnew(substitution(ex.element(),comparator),true);return ret});return before.concat([between]).concat(after)};var insertColumnAt=function(grid,index,example,comparator,substitution){return Arr.map(grid,function(row){var withinSpan=index>0&&index<GridRow.cellLength(row)&&comparator(GridRow.getCellElement(row,index-1),GridRow.getCellElement(row,index));var sub=withinSpan?GridRow.getCell(row,index):Structs.elementnew(substitution(GridRow.getCellElement(row,example),comparator),true);return GridRow.addCell(row,index,sub)})};var splitCellIntoColumns=function(grid,exampleRow,exampleCol,comparator,substitution){var index=exampleCol+1;return Arr.map(grid,function(row,i){var isTargetCell=i===exampleRow;var sub=isTargetCell?Structs.elementnew(substitution(GridRow.getCellElement(row,exampleCol),comparator),true):GridRow.getCell(row,exampleCol);return GridRow.addCell(row,index,sub)})};var splitCellIntoRows=function(grid,exampleRow,exampleCol,comparator,substitution){var index=exampleRow+1;var before=grid.slice(0,index);var after=grid.slice(index);var between=GridRow.mapCells(grid[exampleRow],function(ex,i){var isTargetCell=i===exampleCol;return isTargetCell?Structs.elementnew(substitution(ex.element(),comparator),true):ex});return before.concat([between]).concat(after)};var deleteColumnsAt=function(grid,start,finish){var rows=Arr.map(grid,function(row){var cells=row.cells().slice(0,start).concat(row.cells().slice(finish+1));return Structs.rowcells(cells,row.section())});return Arr.filter(rows,function(row){return row.cells().length>0})};var deleteRowsAt=function(grid,start,finish){return grid.slice(0,start).concat(grid.slice(finish+1))};return{insertRowAt:insertRowAt,insertColumnAt:insertColumnAt,splitCellIntoColumns:splitCellIntoColumns,splitCellIntoRows:splitCellIntoRows,deleteRowsAt:deleteRowsAt,deleteColumnsAt:deleteColumnsAt}});define("ephox.snooker.operate.TransformOperations",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.model.GridRow"],function(Arr,Structs,GridRow){var replaceIn=function(grid,targets,comparator,substitution){var isTarget=function(cell){return Arr.exists(targets,function(target){return comparator(cell.element(),target.element())})};return Arr.map(grid,function(row){return GridRow.mapCells(row,function(cell){return isTarget(cell)?Structs.elementnew(substitution(cell.element(),comparator),true):cell})})};var notStartRow=function(grid,rowIndex,colIndex,comparator){return GridRow.getCellElement(grid[rowIndex],colIndex)!==undefined&&(rowIndex>0&&comparator(GridRow.getCellElement(grid[rowIndex-1],colIndex),GridRow.getCellElement(grid[rowIndex],colIndex)))};var notStartColumn=function(row,index,comparator){return index>0&&comparator(GridRow.getCellElement(row,index-1),GridRow.getCellElement(row,index))};var replaceColumn=function(grid,index,comparator,substitution){var targets=Arr.bind(grid,function(row,i){var alreadyAdded=notStartRow(grid,i,index,comparator)||notStartColumn(row,index,comparator);return alreadyAdded?[]:[GridRow.getCell(row,index)]});return replaceIn(grid,targets,comparator,substitution)};var replaceRow=function(grid,index,comparator,substitution){var targetRow=grid[index];var targets=Arr.bind(targetRow.cells(),function(item,i){var alreadyAdded=notStartRow(grid,index,i,comparator)||notStartColumn(targetRow,i,comparator);return alreadyAdded?[]:[item]});return replaceIn(grid,targets,comparator,substitution)};return{replaceColumn:replaceColumn,replaceRow:replaceRow}});define("ephox.snooker.calc.ColumnContext",[],function(){var none=function(){return folder(function(n,o,l,m,r){return n()})};var only=function(index){return folder(function(n,o,l,m,r){return o(index)})};var left=function(index,next){return folder(function(n,o,l,m,r){return l(index,next)})};var middle=function(prev,index,next){return folder(function(n,o,l,m,r){return m(prev,index,next)})};var right=function(prev,index){return folder(function(n,o,l,m,r){return r(prev,index)})};var folder=function(fold){return{fold:fold}};return{none:none,only:only,left:left,middle:middle,right:right}});define("ephox.snooker.calc.Deltas",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.calc.ColumnContext","global!Math"],function(Arr,Fun,ColumnContext,Math){var neighbours=function(input,index){if(input.length===0){return ColumnContext.none()}if(input.length===1){return ColumnContext.only(0)}if(index===0){return ColumnContext.left(0,1)}if(index===input.length-1){return ColumnContext.right(index-1,index)}if(index>0&&index<input.length-1){return ColumnContext.middle(index-1,index,index+1)}return ColumnContext.none()};var determine=function(input,column,step,tableSize){var result=input.slice(0);var context=neighbours(input,column);var zero=function(array){return Arr.map(array,Fun.constant(0))};var onNone=Fun.constant(zero(result));var onOnly=function(index){return tableSize.singleColumnWidth(result[index],step)};var onChange=function(index,next){if(step>=0){var newNext=Math.max(tableSize.minCellWidth(),result[next]-step);return zero(result.slice(0,index)).concat([step,newNext-result[next]]).concat(zero(result.slice(next+1)))}else{var newThis=Math.max(tableSize.minCellWidth(),result[index]+step);var diffx=result[index]-newThis;return zero(result.slice(0,index)).concat([newThis-result[index],diffx]).concat(zero(result.slice(next+1)))}};var onLeft=onChange;var onMiddle=function(prev,index,next){return onChange(index,next)};var onRight=function(prev,index){if(step>=0){return zero(result.slice(0,index)).concat([step])}else{var size=Math.max(tableSize.minCellWidth(),result[index]+step);return zero(result.slice(0,index)).concat([size-result[index]])}};return context.fold(onNone,onOnly,onLeft,onMiddle,onRight)};return{determine:determine}});define("ephox.snooker.util.CellUtils",["ephox.katamari.api.Fun","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","global!parseInt"],function(Fun,Attr,Css,parseInt){var getSpan=function(cell,type){return Attr.has(cell,type)&&parseInt(Attr.get(cell,type),10)>1};var hasColspan=function(cell){return getSpan(cell,"colspan")};var hasRowspan=function(cell){return getSpan(cell,"rowspan")};var getInt=function(element,property){return parseInt(Css.get(element,property),10)};return{hasColspan:hasColspan,hasRowspan:hasRowspan,minWidth:Fun.constant(10),minHeight:Fun.constant(10),getInt:getInt}});define("ephox.snooker.resize.ColumnSizes",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.lookup.Blocks","ephox.snooker.resize.Sizes","ephox.snooker.util.CellUtils","ephox.snooker.util.Util","ephox.sugar.api.properties.Css"],function(Arr,Fun,Blocks,Sizes,CellUtils,Util,Css){var getRaw=function(cell,property,getter){return Css.getRaw(cell,property).fold(function(){return getter(cell)+"px"},function(raw){return raw})};var getRawW=function(cell){return getRaw(cell,"width",Sizes.getPixelWidth)};var getRawH=function(cell){return getRaw(cell,"height",Sizes.getHeight)};var getWidthFrom=function(warehouse,direction,getWidth,fallback,tableSize){var columns=Blocks.columns(warehouse);var backups=Arr.map(columns,function(cellOption){return cellOption.map(direction.edge)});return Arr.map(columns,function(cellOption,c){var columnCell=cellOption.filter(Fun.not(CellUtils.hasColspan));return columnCell.fold(function(){var deduced=Util.deduce(backups,c);return fallback(deduced)},function(cell){return getWidth(cell,tableSize)})})};var getDeduced=function(deduced){return deduced.map(function(d){return d+"px"}).getOr("")};var getRawWidths=function(warehouse,direction){return getWidthFrom(warehouse,direction,getRawW,getDeduced)};var getPercentageWidths=function(warehouse,direction,tableSize){return getWidthFrom(warehouse,direction,Sizes.getPercentageWidth,function(deduced){return deduced.fold(function(){return tableSize.minCellWidth()},function(cellWidth){return cellWidth/tableSize.pixelWidth()*100})},tableSize)};var getPixelWidths=function(warehouse,direction,tableSize){return getWidthFrom(warehouse,direction,Sizes.getPixelWidth,function(deduced){return deduced.getOrThunk(tableSize.minCellWidth)},tableSize)};var getHeightFrom=function(warehouse,direction,getHeight,fallback){var rows=Blocks.rows(warehouse);var backups=Arr.map(rows,function(cellOption){return cellOption.map(direction.edge)});return Arr.map(rows,function(cellOption,c){var rowCell=cellOption.filter(Fun.not(CellUtils.hasRowspan));return rowCell.fold(function(){var deduced=Util.deduce(backups,c);return fallback(deduced)},function(cell){return getHeight(cell)})})};var getPixelHeights=function(warehouse,direction){return getHeightFrom(warehouse,direction,Sizes.getHeight,function(deduced){return deduced.getOrThunk(CellUtils.minHeight)})};var getRawHeights=function(warehouse,direction){return getHeightFrom(warehouse,direction,getRawH,getDeduced)};return{getRawWidths:getRawWidths,getPixelWidths:getPixelWidths,getPercentageWidths:getPercentageWidths,getPixelHeights:getPixelHeights,getRawHeights:getRawHeights}});define("ephox.snooker.resize.Recalculations",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.model.Warehouse","global!parseInt"],function(Arr,Fun,Warehouse,parseInt){var total=function(start,end,measures){var r=0;for(var i=start;i<end;i++){r+=measures[i]!==undefined?measures[i]:0}return r};var recalculateWidth=function(warehouse,widths){var all=Warehouse.justCells(warehouse);return Arr.map(all,function(cell){var width=total(cell.column(),cell.column()+cell.colspan(),widths);return{element:cell.element,width:Fun.constant(width),colspan:cell.colspan}})};var recalculateHeight=function(warehouse,heights){var all=Warehouse.justCells(warehouse);return Arr.map(all,function(cell){var height=total(cell.row(),cell.row()+cell.rowspan(),heights);return{element:cell.element,height:Fun.constant(height),rowspan:cell.rowspan}})};var matchRowHeight=function(warehouse,heights){return Arr.map(warehouse.all(),function(row,i){return{element:row.element,height:Fun.constant(heights[i])}})};return{recalculateWidth:recalculateWidth,recalculateHeight:recalculateHeight,matchRowHeight:matchRowHeight}});define("ephox.snooker.resize.TableSize",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.resize.ColumnSizes","ephox.snooker.resize.Sizes","ephox.snooker.util.CellUtils","ephox.sugar.api.view.Width","global!Math"],function(Arr,Fun,ColumnSizes,Sizes,CellUtils,Width,Math){var percentageSize=function(width,element){var floatWidth=parseFloat(width,10);var pixelWidth=Width.get(element);var getCellDelta=function(delta){return delta/pixelWidth*100};var singleColumnWidth=function(width,_delta){return[100-width]};var minCellWidth=function(){return CellUtils.minWidth()/pixelWidth*100};var setTableWidth=function(table,_newWidths,delta){var total=floatWidth+delta;Sizes.setPercentageWidth(table,total)};return{width:Fun.constant(floatWidth),pixelWidth:Fun.constant(pixelWidth),getWidths:ColumnSizes.getPercentageWidths,getCellDelta:getCellDelta,singleColumnWidth:singleColumnWidth,minCellWidth:minCellWidth,setElementWidth:Sizes.setPercentageWidth,setTableWidth:setTableWidth}};var pixelSize=function(width){var intWidth=parseInt(width,10);var getCellDelta=Fun.identity;var singleColumnWidth=function(width,delta){var newNext=Math.max(CellUtils.minWidth(),width+delta);return[newNext-width]};var setTableWidth=function(table,newWidths,_delta){var total=Arr.foldr(newWidths,function(b,a){return b+a},0);Sizes.setPixelWidth(table,total)};return{width:Fun.constant(intWidth),pixelWidth:Fun.constant(intWidth),getWidths:ColumnSizes.getPixelWidths,getCellDelta:getCellDelta,singleColumnWidth:singleColumnWidth,minCellWidth:CellUtils.minWidth,setElementWidth:Sizes.setPixelWidth,setTableWidth:setTableWidth}};var chooseSize=function(element,width){if(Sizes.percentageBasedSizeRegex().test(width)){var percentMatch=Sizes.percentageBasedSizeRegex().exec(width);return percentageSize(percentMatch[1],element)}else if(Sizes.pixelBasedSizeRegex().test(width)){var pixelMatch=Sizes.pixelBasedSizeRegex().exec(width);return pixelSize(pixelMatch[1])}else{var fallbackWidth=Width.get(element);return pixelSize(fallbackWidth)}};var getTableSize=function(element){var width=Sizes.getRawWidth(element);return width.fold(function(){var fallbackWidth=Width.get(element);return pixelSize(fallbackWidth)},function(width){return chooseSize(element,width)})};return{getTableSize:getTableSize}});define("ephox.snooker.resize.Adjustments",["ephox.katamari.api.Arr","ephox.snooker.calc.Deltas","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.resize.ColumnSizes","ephox.snooker.resize.Recalculations","ephox.snooker.resize.Sizes","ephox.snooker.resize.TableSize","ephox.snooker.util.CellUtils","global!Math"],function(Arr,Deltas,DetailsList,Warehouse,ColumnSizes,Recalculations,Sizes,TableSize,CellUtils,Math){var getWarehouse=function(list){return Warehouse.generate(list)};var sumUp=function(newSize){return Arr.foldr(newSize,function(b,a){return b+a},0)};var getTableWarehouse=function(table){var list=DetailsList.fromTable(table);return getWarehouse(list)};var adjustWidth=function(table,delta,index,direction){var tableSize=TableSize.getTableSize(table);var step=tableSize.getCellDelta(delta);var warehouse=getTableWarehouse(table);var widths=tableSize.getWidths(warehouse,direction,tableSize);var deltas=Deltas.determine(widths,index,step,tableSize);var newWidths=Arr.map(deltas,function(dx,i){return dx+widths[i]});var newSizes=Recalculations.recalculateWidth(warehouse,newWidths);Arr.each(newSizes,function(cell){tableSize.setElementWidth(cell.element(),cell.width())});if(index===warehouse.grid().columns()-1){tableSize.setTableWidth(table,newWidths,step)}};var adjustHeight=function(table,delta,index,direction){var warehouse=getTableWarehouse(table);var heights=ColumnSizes.getPixelHeights(warehouse,direction);var newHeights=Arr.map(heights,function(dy,i){return index===i?Math.max(delta+dy,CellUtils.minHeight()):dy});var newCellSizes=Recalculations.recalculateHeight(warehouse,newHeights);var newRowSizes=Recalculations.matchRowHeight(warehouse,newHeights);Arr.each(newRowSizes,function(row){Sizes.setHeight(row.element(),row.height())});Arr.each(newCellSizes,function(cell){Sizes.setHeight(cell.element(),cell.height())});var total=sumUp(newHeights);Sizes.setHeight(table,total)};var adjustWidthTo=function(table,list,direction){var tableSize=TableSize.getTableSize(table);var warehouse=getWarehouse(list);var widths=tableSize.getWidths(warehouse,direction,tableSize);var newSizes=Recalculations.recalculateWidth(warehouse,widths);Arr.each(newSizes,function(cell){tableSize.setElementWidth(cell.element(),cell.width())});var total=Arr.foldr(widths,function(b,a){return a+b},0);if(newSizes.length>0){tableSize.setElementWidth(table,total)}};return{adjustWidth:adjustWidth,adjustHeight:adjustHeight,adjustWidthTo:adjustWidthTo}});define("ephox.snooker.api.TableOperations",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.snooker.api.Generators","ephox.snooker.api.Structs","ephox.snooker.api.TableContent","ephox.snooker.api.TableLookup","ephox.snooker.model.DetailsList","ephox.snooker.model.GridRow","ephox.snooker.model.RunOperation","ephox.snooker.model.TableMerge","ephox.snooker.model.Transitions","ephox.snooker.model.Warehouse","ephox.snooker.operate.MergingOperations","ephox.snooker.operate.ModificationOperations","ephox.snooker.operate.TransformOperations","ephox.snooker.resize.Adjustments","ephox.sugar.api.dom.Remove"],function(Arr,Fun,Option,Struct,Generators,Structs,TableContent,TableLookup,DetailsList,GridRow,RunOperation,TableMerge,Transitions,Warehouse,MergingOperations,ModificationOperations,TransformOperations,Adjustments,Remove){var prune=function(table){var cells=TableLookup.cells(table);if(cells.length===0){Remove.remove(table)}};var outcome=Struct.immutable("grid","cursor");var elementFromGrid=function(grid,row,column){return findIn(grid,row,column).orThunk(function(){return findIn(grid,0,0)})};var findIn=function(grid,row,column){return Option.from(grid[row]).bind(function(r){return Option.from(r.cells()[column]).bind(function(c){return Option.from(c.element())})})};var bundle=function(grid,row,column){return outcome(grid,findIn(grid,row,column))};var uniqueRows=function(details){return Arr.foldl(details,function(rest,detail){return Arr.exists(rest,function(currentDetail){return currentDetail.row()===detail.row()})?rest:rest.concat([detail])},[]).sort(function(detailA,detailB){return detailA.row()-detailB.row()})};var uniqueColumns=function(details){return Arr.foldl(details,function(rest,detail){return Arr.exists(rest,function(currentDetail){return currentDetail.column()===detail.column()})?rest:rest.concat([detail])},[]).sort(function(detailA,detailB){return detailA.column()-detailB.column()})};var insertRowBefore=function(grid,detail,comparator,genWrappers){var example=detail.row();var targetIndex=detail.row();var newGrid=ModificationOperations.insertRowAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,targetIndex,detail.column())};var insertRowsBefore=function(grid,details,comparator,genWrappers){var example=details[0].row();var targetIndex=details[0].row();var rows=uniqueRows(details);var newGrid=Arr.foldl(rows,function(newGrid,_row){return ModificationOperations.insertRowAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,targetIndex,details[0].column())};var insertRowAfter=function(grid,detail,comparator,genWrappers){var example=detail.row();var targetIndex=detail.row()+detail.rowspan();var newGrid=ModificationOperations.insertRowAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,targetIndex,detail.column())};var insertRowsAfter=function(grid,details,comparator,genWrappers){var rows=uniqueRows(details);var example=rows[rows.length-1].row();var targetIndex=rows[rows.length-1].row()+rows[rows.length-1].rowspan();var newGrid=Arr.foldl(rows,function(newGrid,_row){return ModificationOperations.insertRowAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,targetIndex,details[0].column())};var insertColumnBefore=function(grid,detail,comparator,genWrappers){var example=detail.column();var targetIndex=detail.column();var newGrid=ModificationOperations.insertColumnAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),targetIndex)};var insertColumnsBefore=function(grid,details,comparator,genWrappers){var columns=uniqueColumns(details);var example=columns[0].column();var targetIndex=columns[0].column();var newGrid=Arr.foldl(columns,function(newGrid,_row){return ModificationOperations.insertColumnAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,details[0].row(),targetIndex)};var insertColumnAfter=function(grid,detail,comparator,genWrappers){var example=detail.column();var targetIndex=detail.column()+detail.colspan();var newGrid=ModificationOperations.insertColumnAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),targetIndex)};var insertColumnsAfter=function(grid,details,comparator,genWrappers){var example=details[details.length-1].column();var targetIndex=details[details.length-1].column()+details[details.length-1].colspan();var columns=uniqueColumns(details);var newGrid=Arr.foldl(columns,function(newGrid,_row){return ModificationOperations.insertColumnAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,details[0].row(),targetIndex)};var makeRowHeader=function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations.replaceRow(grid,detail.row(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())};var makeColumnHeader=function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations.replaceColumn(grid,detail.column(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())};var unmakeRowHeader=function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations.replaceRow(grid,detail.row(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())};var unmakeColumnHeader=function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations.replaceColumn(grid,detail.column(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())};var splitCellIntoColumns=function(grid,detail,comparator,genWrappers){var newGrid=ModificationOperations.splitCellIntoColumns(grid,detail.row(),detail.column(),comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),detail.column())};var splitCellIntoRows=function(grid,detail,comparator,genWrappers){var newGrid=ModificationOperations.splitCellIntoRows(grid,detail.row(),detail.column(),comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),detail.column())};var eraseColumns=function(grid,details,comparator,_genWrappers){var columns=uniqueColumns(details);var newGrid=ModificationOperations.deleteColumnsAt(grid,columns[0].column(),columns[columns.length-1].column());var cursor=elementFromGrid(newGrid,details[0].row(),details[0].column());return outcome(newGrid,cursor)};var eraseRows=function(grid,details,comparator,_genWrappers){var rows=uniqueRows(details);var newGrid=ModificationOperations.deleteRowsAt(grid,rows[0].row(),rows[rows.length-1].row());var cursor=elementFromGrid(newGrid,details[0].row(),details[0].column());return outcome(newGrid,cursor)};var mergeCells=function(grid,mergable,comparator,_genWrappers){var cells=mergable.cells();TableContent.merge(cells);var newGrid=MergingOperations.merge(grid,mergable.bounds(),comparator,Fun.constant(cells[0]));return outcome(newGrid,Option.from(cells[0]))};var unmergeCells=function(grid,unmergable,comparator,genWrappers){var newGrid=Arr.foldr(unmergable,function(b,cell){return MergingOperations.unmerge(b,cell,comparator,genWrappers.combine(cell))},grid);return outcome(newGrid,Option.from(unmergable[0]))};var pasteCells=function(grid,pasteDetails,comparator,genWrappers){var gridify=function(table,generators){var list=DetailsList.fromTable(table);var wh=Warehouse.generate(list);return Transitions.toGrid(wh,generators,true)};var gridB=gridify(pasteDetails.clipboard(),pasteDetails.generators());var startAddress=Structs.address(pasteDetails.row(),pasteDetails.column());var mergedGrid=TableMerge.merge(startAddress,grid,gridB,pasteDetails.generators(),comparator);return mergedGrid.fold(function(){return outcome(grid,Option.some(pasteDetails.element()))},function(nuGrid){var cursor=elementFromGrid(nuGrid,pasteDetails.row(),pasteDetails.column());return outcome(nuGrid,cursor)})};var gridifyRows=function(rows,generators,example){var pasteDetails=DetailsList.fromPastedRows(rows,example);var wh=Warehouse.generate(pasteDetails);return Transitions.toGrid(wh,generators,true)};var pasteRowsBefore=function(grid,pasteDetails,comparator,genWrappers){var example=grid[pasteDetails.cells[0].row()];var index=pasteDetails.cells[0].row();var gridB=gridifyRows(pasteDetails.clipboard(),pasteDetails.generators(),example);var mergedGrid=TableMerge.insert(index,grid,gridB,pasteDetails.generators(),comparator);var cursor=elementFromGrid(mergedGrid,pasteDetails.cells[0].row(),pasteDetails.cells[0].column());return outcome(mergedGrid,cursor)};var pasteRowsAfter=function(grid,pasteDetails,comparator,genWrappers){var example=grid[pasteDetails.cells[0].row()];var index=pasteDetails.cells[pasteDetails.cells.length-1].row()+pasteDetails.cells[pasteDetails.cells.length-1].rowspan();var gridB=gridifyRows(pasteDetails.clipboard(),pasteDetails.generators(),example);var mergedGrid=TableMerge.insert(index,grid,gridB,pasteDetails.generators(),comparator);var cursor=elementFromGrid(mergedGrid,pasteDetails.cells[0].row(),pasteDetails.cells[0].column());return outcome(mergedGrid,cursor)};var resize=Adjustments.adjustWidthTo;return{insertRowBefore:RunOperation.run(insertRowBefore,RunOperation.onCell,Fun.noop,Fun.noop,Generators.modification),insertRowsBefore:RunOperation.run(insertRowsBefore,RunOperation.onCells,Fun.noop,Fun.noop,Generators.modification),insertRowAfter:RunOperation.run(insertRowAfter,RunOperation.onCell,Fun.noop,Fun.noop,Generators.modification),insertRowsAfter:RunOperation.run(insertRowsAfter,RunOperation.onCells,Fun.noop,Fun.noop,Generators.modification),insertColumnBefore:RunOperation.run(insertColumnBefore,RunOperation.onCell,resize,Fun.noop,Generators.modification),insertColumnsBefore:RunOperation.run(insertColumnsBefore,RunOperation.onCells,resize,Fun.noop,Generators.modification),insertColumnAfter:RunOperation.run(insertColumnAfter,RunOperation.onCell,resize,Fun.noop,Generators.modification),insertColumnsAfter:RunOperation.run(insertColumnsAfter,RunOperation.onCells,resize,Fun.noop,Generators.modification),splitCellIntoColumns:RunOperation.run(splitCellIntoColumns,RunOperation.onCell,resize,Fun.noop,Generators.modification),splitCellIntoRows:RunOperation.run(splitCellIntoRows,RunOperation.onCell,Fun.noop,Fun.noop,Generators.modification),eraseColumns:RunOperation.run(eraseColumns,RunOperation.onCells,resize,prune,Generators.modification),eraseRows:RunOperation.run(eraseRows,RunOperation.onCells,Fun.noop,prune,Generators.modification),makeColumnHeader:RunOperation.run(makeColumnHeader,RunOperation.onCell,Fun.noop,Fun.noop,Generators.transform("row","th")),unmakeColumnHeader:RunOperation.run(unmakeColumnHeader,RunOperation.onCell,Fun.noop,Fun.noop,Generators.transform(null,"td")),makeRowHeader:RunOperation.run(makeRowHeader,RunOperation.onCell,Fun.noop,Fun.noop,Generators.transform("col","th")),unmakeRowHeader:RunOperation.run(unmakeRowHeader,RunOperation.onCell,Fun.noop,Fun.noop,Generators.transform(null,"td")),mergeCells:RunOperation.run(mergeCells,RunOperation.onMergable,Fun.noop,Fun.noop,Generators.merging),unmergeCells:RunOperation.run(unmergeCells,RunOperation.onUnmergable,resize,Fun.noop,Generators.merging),pasteCells:RunOperation.run(pasteCells,RunOperation.onPaste,resize,Fun.noop,Generators.modification),pasteRowsBefore:RunOperation.run(pasteRowsBefore,RunOperation.onPasteRows,Fun.noop,Fun.noop,Generators.modification),pasteRowsAfter:RunOperation.run(pasteRowsAfter,RunOperation.onPasteRows,Fun.noop,Fun.noop,Generators.modification)}});define("tinymce.plugins.table.alien.Util",["ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(Compare,Element){var getBody=function(editor){return Element.fromDom(editor.getBody())};var getIsRoot=function(editor){return function(element){return Compare.eq(element,getBody(editor))}};var removePxSuffix=function(size){return size?size.replace(/px$/,""):""};var addSizeSuffix=function(size){if(/^[0-9]+$/.test(size)){size+="px"}return size};return{getBody:getBody,getIsRoot:getIsRoot,addSizeSuffix:addSizeSuffix,removePxSuffix:removePxSuffix}});define("ephox.sugar.api.properties.Direction",["ephox.sugar.api.properties.Css"],function(Css){var onDirection=function(isLtr,isRtl){return function(element){return getDirection(element)==="rtl"?isRtl:isLtr}};var getDirection=function(element){return Css.get(element,"direction")==="rtl"?"rtl":"ltr"};return{onDirection:onDirection,getDirection:getDirection}});define("tinymce.plugins.table.queries.Direction",["ephox.katamari.api.Fun","ephox.sugar.api.properties.Direction"],function(Fun,Direction){var ltr={isRtl:Fun.constant(false)};var rtl={isRtl:Fun.constant(true)};var directionAt=function(element){var dir=Direction.getDirection(element);return dir==="rtl"?rtl:ltr};return{directionAt:directionAt}});define("tinymce.plugins.table.actions.TableActions",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.CellMutations","ephox.snooker.api.TableDirection","ephox.snooker.api.TableFill","ephox.snooker.api.TableGridSize","ephox.snooker.api.TableOperations","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.Direction"],function(Arr,Fun,Option,CellMutations,TableDirection,TableFill,TableGridSize,TableOperations,Element,Node,Attr,SelectorFilter,Util,Direction){return function(editor,lazyWire){var isTableBody=function(editor){return Node.name(Util.getBody(editor))==="table"};var lastRowGuard=function(table){var size=TableGridSize.getGridSize(table);return isTableBody(editor)===false||size.rows()>1};var lastColumnGuard=function(table){var size=TableGridSize.getGridSize(table);return isTableBody(editor)===false||size.columns()>1};var fireNewRow=function(node){editor.fire("newrow",{node:node.dom()});return node.dom()};var fireNewCell=function(node){editor.fire("newcell",{node:node.dom()});return node.dom()};var cloneFormatsArray;if(editor.settings.table_clone_elements!==false){if(typeof editor.settings.table_clone_elements=="string"){cloneFormatsArray=editor.settings.table_clone_elements.split(/[ ,]/)}else if(Array.isArray(editor.settings.table_clone_elements)){cloneFormatsArray=editor.settings.table_clone_elements}}var cloneFormats=Option.from(cloneFormatsArray);var execute=function(operation,guard,mutate,lazyWire){return function(table,target){var dataStyleCells=SelectorFilter.descendants(table,"td[data-mce-style],th[data-mce-style]");Arr.each(dataStyleCells,function(cell){Attr.remove(cell,"data-mce-style")});var wire=lazyWire();var doc=Element.fromDom(editor.getDoc());var direction=TableDirection(Direction.directionAt);var generators=TableFill.cellOperations(mutate,doc,cloneFormats);return guard(table)?operation(wire,table,target,generators,direction).bind(function(result){Arr.each(result.newRows(),function(row){fireNewRow(row)});Arr.each(result.newCells(),function(cell){fireNewCell(cell)});return result.cursor().map(function(cell){var rng=editor.dom.createRng();rng.setStart(cell.dom(),0);rng.setEnd(cell.dom(),0);return rng})}):Option.none()}};var deleteRow=execute(TableOperations.eraseRows,lastRowGuard,Fun.noop,lazyWire);var deleteColumn=execute(TableOperations.eraseColumns,lastColumnGuard,Fun.noop,lazyWire);var insertRowsBefore=execute(TableOperations.insertRowsBefore,Fun.always,Fun.noop,lazyWire);var insertRowsAfter=execute(TableOperations.insertRowsAfter,Fun.always,Fun.noop,lazyWire);var insertColumnsBefore=execute(TableOperations.insertColumnsBefore,Fun.always,CellMutations.halve,lazyWire);var insertColumnsAfter=execute(TableOperations.insertColumnsAfter,Fun.always,CellMutations.halve,lazyWire);var mergeCells=execute(TableOperations.mergeCells,Fun.always,Fun.noop,lazyWire);var unmergeCells=execute(TableOperations.unmergeCells,Fun.always,Fun.noop,lazyWire);var pasteRowsBefore=execute(TableOperations.pasteRowsBefore,Fun.always,Fun.noop,lazyWire);var pasteRowsAfter=execute(TableOperations.pasteRowsAfter,Fun.always,Fun.noop,lazyWire);var pasteCells=execute(TableOperations.pasteCells,Fun.always,Fun.noop,lazyWire);return{deleteRow:deleteRow,deleteColumn:deleteColumn,insertRowsBefore:insertRowsBefore,insertRowsAfter:insertRowsAfter,insertColumnsBefore:insertColumnsBefore,insertColumnsAfter:insertColumnsAfter,mergeCells:mergeCells,unmergeCells:unmergeCells,pasteRowsBefore:pasteRowsBefore,pasteRowsAfter:pasteRowsAfter,pasteCells:pasteCells}}});define("ephox.snooker.api.CopyRows",["ephox.snooker.model.DetailsList","ephox.snooker.model.RunOperation","ephox.snooker.model.Transitions","ephox.snooker.model.Warehouse","ephox.snooker.operate.Redraw"],function(DetailsList,RunOperation,Transitions,Warehouse,Redraw){var copyRows=function(table,target,generators){var list=DetailsList.fromTable(table);var house=Warehouse.generate(list);var details=RunOperation.onCells(house,target);return details.map(function(selectedCells){var grid=Transitions.toGrid(house,generators,false);var slicedGrid=grid.slice(selectedCells[0].row(),selectedCells[selectedCells.length-1].row()+selectedCells[selectedCells.length-1].rowspan());var slicedDetails=RunOperation.toDetailList(slicedGrid,generators);return Redraw.copy(slicedDetails)})};return{copyRows:copyRows}});define("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Tools")});define("tinymce.core.Env",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.Env")});define("tinymce.plugins.table.actions.Styles",["tinymce.core.util.Tools"],function(Tools){var getTDTHOverallStyle=function(dom,elm,name){var cells=dom.select("td,th",elm),firstChildStyle;var checkChildren=function(firstChildStyle,elms){for(var i=0;i<elms.length;i++){var currentStyle=dom.getStyle(elms[i],name);if(typeof firstChildStyle==="undefined"){firstChildStyle=currentStyle}if(firstChildStyle!=currentStyle){return""}}return firstChildStyle};firstChildStyle=checkChildren(firstChildStyle,cells);return firstChildStyle};var applyAlign=function(editor,elm,name){if(name){editor.formatter.apply("align"+name,{},elm)}};var applyVAlign=function(editor,elm,name){if(name){editor.formatter.apply("valign"+name,{},elm)}};var unApplyAlign=function(editor,elm){Tools.each("left center right".split(" "),function(name){editor.formatter.remove("align"+name,{},elm)})};var unApplyVAlign=function(editor,elm){Tools.each("top middle bottom".split(" "),function(name){editor.formatter.remove("valign"+name,{},elm)})};return{applyAlign:applyAlign,applyVAlign:applyVAlign,unApplyAlign:unApplyAlign,unApplyVAlign:unApplyVAlign,getTDTHOverallStyle:getTDTHOverallStyle}});define("tinymce.plugins.table.ui.Helpers",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.alien.Util"],function(Fun,Tools,Util){var buildListItems=function(inputList,itemCallback,startItems){var appendItems=function(values,output){output=output||[];Tools.each(values,function(item){var menuItem={text:item.text||item.title};if(item.menu){menuItem.menu=appendItems(item.menu)}else{menuItem.value=item.value;if(itemCallback){itemCallback(menuItem)}}output.push(menuItem)});return output};return appendItems(inputList,startItems||[])};var updateStyleField=function(editor,evt){var dom=editor.dom;var rootControl=evt.control.rootControl;var data=rootControl.toJSON();var css=dom.parseStyle(data.style);if(evt.control.name()==="style"){rootControl.find("#borderStyle").value(css["border-style"]||"")[0].fire("select");rootControl.find("#borderColor").value(css["border-color"]||"")[0].fire("change");rootControl.find("#backgroundColor").value(css["background-color"]||"")[0].fire("change");rootControl.find("#width").value(css.width||"").fire("change");rootControl.find("#height").value(css.height||"").fire("change")}else{css["border-style"]=data.borderStyle;css["border-color"]=data.borderColor;css["background-color"]=data.backgroundColor;css.width=data.width?Util.addSizeSuffix(data.width):"";css.height=data.height?Util.addSizeSuffix(data.height):""}rootControl.find("#style").value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))))};var extractAdvancedStyles=function(dom,elm){var css=dom.parseStyle(dom.getAttrib(elm,"style"));var data={};if(css["border-style"]){data.borderStyle=css["border-style"]}if(css["border-color"]){data.borderColor=css["border-color"]}if(css["background-color"]){data.backgroundColor=css["background-color"]}data.style=dom.serializeStyle(css);return data};var createStyleForm=function(editor){var createColorPickAction=function(){var colorPickerCallback=editor.settings.color_picker_callback;if(colorPickerCallback){return function(evt){return colorPickerCallback.call(editor,function(value){evt.control.value(value).fire("change")},evt.control.value())}}};return{title:"Advanced",type:"form",defaults:{onchange:Fun.curry(updateStyleField,editor)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:Fun.curry(updateStyleField,editor),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:createColorPickAction()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:createColorPickAction()}]}]}};return{createStyleForm:createStyleForm,buildListItems:buildListItems,updateStyleField:updateStyleField,extractAdvancedStyles:extractAdvancedStyles}});define("tinymce.plugins.table.ui.TableDialog",["ephox.katamari.api.Fun","tinymce.core.Env","tinymce.core.util.Tools","tinymce.plugins.table.actions.InsertTable","tinymce.plugins.table.actions.Styles","tinymce.plugins.table.alien.Util","tinymce.plugins.table.ui.Helpers"],function(Fun,Env,Tools,InsertTable,Styles,Util,Helpers){function styleTDTH(dom,elm,name,value){if(elm.tagName==="TD"||elm.tagName==="TH"){dom.setStyle(elm,name,value)}else{if(elm.children){for(var i=0;i<elm.children.length;i++){styleTDTH(dom,elm.children[i],name,value)}}}}var extractDataFromElement=function(editor,tableElm){var dom=editor.dom;var data={width:dom.getStyle(tableElm,"width")||dom.getAttrib(tableElm,"width"),height:dom.getStyle(tableElm,"height")||dom.getAttrib(tableElm,"height"),cellspacing:dom.getStyle(tableElm,"border-spacing")||dom.getAttrib(tableElm,"cellspacing"),cellpadding:dom.getAttrib(tableElm,"data-mce-cell-padding")||dom.getAttrib(tableElm,"cellpadding")||Styles.getTDTHOverallStyle(editor.dom,tableElm,"padding"),border:dom.getAttrib(tableElm,"data-mce-border")||dom.getAttrib(tableElm,"border")||Styles.getTDTHOverallStyle(editor.dom,tableElm,"border"),borderColor:dom.getAttrib(tableElm,"data-mce-border-color"),caption:!!dom.select("caption",tableElm)[0],class:dom.getAttrib(tableElm,"class")};Tools.each("left center right".split(" "),function(name){if(editor.formatter.matchNode(tableElm,"align"+name)){data.align=name}});if(editor.settings.table_advtab!==false){Tools.extend(data,Helpers.extractAdvancedStyles(dom,tableElm))}return data};var applyDataToElement=function(editor,tableElm,data){var dom=editor.dom;var attrs={},styles={};attrs["class"]=data["class"];styles.height=Util.addSizeSuffix(data.height);if(dom.getAttrib(tableElm,"width")&&!editor.settings.table_style_by_css){attrs.width=Util.removePxSuffix(data.width)}else{styles.width=Util.addSizeSuffix(data.width)}if(editor.settings.table_style_by_css){styles["border-width"]=Util.addSizeSuffix(data.border);styles["border-spacing"]=Util.addSizeSuffix(data.cellspacing);Tools.extend(attrs,{"data-mce-border-color":data.borderColor,"data-mce-cell-padding":data.cellpadding,"data-mce-border":data.border})}else{Tools.extend(attrs,{border:data.border,cellpadding:data.cellpadding,cellspacing:data.cellspacing})}if(editor.settings.table_style_by_css){if(tableElm.children){for(var i=0;i<tableElm.children.length;i++){styleTDTH(dom,tableElm.children[i],{"border-width":Util.addSizeSuffix(data.border),"border-color":data.borderColor,padding:Util.addSizeSuffix(data.cellpadding)})}}}if(data.style){Tools.extend(styles,dom.parseStyle(data.style))}else{styles=Tools.extend({},dom.parseStyle(dom.getAttrib(tableElm,"style")),styles)}attrs.style=dom.serializeStyle(styles);dom.setAttribs(tableElm,attrs)};var onSubmitTableForm=function(editor,tableElm,evt){var dom=editor.dom;var captionElm;var data;Helpers.updateStyleField(editor,evt);data=evt.control.rootControl.toJSON();if(data["class"]===false){delete data["class"]}editor.undoManager.transact(function(){if(!tableElm){tableElm=InsertTable.insert(editor,data.cols||1,data.rows||1)}applyDataToElement(editor,tableElm,data);captionElm=dom.select("caption",tableElm)[0];if(captionElm&&!data.caption){dom.remove(captionElm)}if(!captionElm&&data.caption){captionElm=dom.create("caption");captionElm.innerHTML=!Env.ie?'<br data-mce-bogus="1"/>':"¬†";tableElm.insertBefore(captionElm,tableElm.firstChild)}Styles.unApplyAlign(editor,tableElm);if(data.align){Styles.applyAlign(editor,tableElm,data.align)}editor.focus();editor.addVisual()})};var open=function(editor,isProps){var dom=editor.dom,tableElm,colsCtrl,rowsCtrl,classListCtrl,data={},generalTableForm;if(isProps===true){tableElm=dom.getParent(editor.selection.getStart(),"table");if(tableElm){data=extractDataFromElement(editor,tableElm)}}else{colsCtrl={label:"Cols",name:"cols"};rowsCtrl={label:"Rows",name:"rows"}}if(editor.settings.table_class_list){if(data["class"]){data["class"]=data["class"].replace(/\s*mce\-item\-table\s*/g,"")}classListCtrl={name:"class",type:"listbox",label:"Class",values:Helpers.buildListItems(editor.settings.table_class_list,function(item){if(item.value){item.textStyle=function(){return editor.formatter.getCssText({block:"table",classes:[item.value]})}}})}}generalTableForm={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:false,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:editor.settings.table_appearance_options!==false?[colsCtrl,rowsCtrl,{label:"Width",name:"width",onchange:Fun.curry(Helpers.updateStyleField,editor)},{label:"Height",name:"height",onchange:Fun.curry(Helpers.updateStyleField,editor)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[colsCtrl,rowsCtrl,{label:"Width",name:"width",onchange:Fun.curry(Helpers.updateStyleField,editor)},{label:"Height",name:"height",onchange:Fun.curry(Helpers.updateStyleField,editor)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},classListCtrl]};if(editor.settings.table_advtab!==false){editor.windowManager.open({title:"Table properties",data:data,bodyType:"tabpanel",body:[{title:"General",type:"form",items:generalTableForm},Helpers.createStyleForm(editor)],onsubmit:Fun.curry(onSubmitTableForm,editor,tableElm)})}else{editor.windowManager.open({title:"Table properties",data:data,body:generalTableForm,onsubmit:Fun.curry(onSubmitTableForm,editor,tableElm)})}};return{open:open}});define("tinymce.plugins.table.ui.RowDialog",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.actions.Styles","tinymce.plugins.table.alien.Util","tinymce.plugins.table.ui.Helpers"],function(Fun,Tools,Styles,Util,Helpers){var extractDataFromElement=function(editor,elm){var dom=editor.dom;var data={height:dom.getStyle(elm,"height")||dom.getAttrib(elm,"height"),scope:dom.getAttrib(elm,"scope"),class:dom.getAttrib(elm,"class")};data.type=elm.parentNode.nodeName.toLowerCase();Tools.each("left center right".split(" "),function(name){if(editor.formatter.matchNode(elm,"align"+name)){data.align=name}});if(editor.settings.table_row_advtab!==false){Tools.extend(data,Helpers.extractAdvancedStyles(dom,elm))}return data};var switchRowType=function(dom,rowElm,toType){var tableElm=dom.getParent(rowElm,"table");var oldParentElm=rowElm.parentNode;var parentElm=dom.select(toType,tableElm)[0];if(!parentElm){parentElm=dom.create(toType);if(tableElm.firstChild){if(tableElm.firstChild.nodeName==="CAPTION"){dom.insertAfter(parentElm,tableElm.firstChild)}else{tableElm.insertBefore(parentElm,tableElm.firstChild)}}else{tableElm.appendChild(parentElm)}}parentElm.appendChild(rowElm);if(!oldParentElm.hasChildNodes()){dom.remove(oldParentElm)}};function onSubmitRowForm(editor,rows,evt){var dom=editor.dom;var data;function setAttrib(elm,name,value){if(value){dom.setAttrib(elm,name,value)}}function setStyle(elm,name,value){if(value){dom.setStyle(elm,name,value)}}Helpers.updateStyleField(editor,evt);data=evt.control.rootControl.toJSON();editor.undoManager.transact(function(){Tools.each(rows,function(rowElm){setAttrib(rowElm,"scope",data.scope);setAttrib(rowElm,"style",data.style);setAttrib(rowElm,"class",data["class"]);setStyle(rowElm,"height",Util.addSizeSuffix(data.height));if(data.type!==rowElm.parentNode.nodeName.toLowerCase()){switchRowType(editor.dom,rowElm,data.type)}if(rows.length===1){Styles.unApplyAlign(editor,rowElm)}if(data.align){Styles.applyAlign(editor,rowElm,data.align)}});editor.focus()})}var open=function(editor){var dom=editor.dom,tableElm,cellElm,rowElm,classListCtrl,data,rows=[],generalRowForm;tableElm=editor.dom.getParent(editor.selection.getStart(),"table");cellElm=editor.dom.getParent(editor.selection.getStart(),"td,th");Tools.each(tableElm.rows,function(row){Tools.each(row.cells,function(cell){if(dom.getAttrib(cell,"data-mce-selected")||cell==cellElm){rows.push(row);return false}})});rowElm=rows[0];if(!rowElm){return}if(rows.length>1){data={height:"",scope:"",class:"",align:"",type:rowElm.parentNode.nodeName.toLowerCase()}}else{data=extractDataFromElement(editor,rowElm)}if(editor.settings.table_row_class_list){classListCtrl={name:"class",type:"listbox",label:"Class",values:Helpers.buildListItems(editor.settings.table_row_class_list,function(item){if(item.value){item.textStyle=function(){return editor.formatter.getCssText({block:"tr",classes:[item.value]})}}})}}generalRowForm={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},classListCtrl]};if(editor.settings.table_row_advtab!==false){editor.windowManager.open({title:"Row properties",data:data,bodyType:"tabpanel",body:[{title:"General",type:"form",items:generalRowForm},Helpers.createStyleForm(dom)],onsubmit:Fun.curry(onSubmitRowForm,editor,rows)})}else{editor.windowManager.open({title:"Row properties",data:data,body:generalRowForm,onsubmit:Fun.curry(onSubmitRowForm,editor,rows)})}};return{open:open}});define("tinymce.plugins.table.ui.CellDialog",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.actions.Styles","tinymce.plugins.table.alien.Util","tinymce.plugins.table.ui.Helpers"],function(Fun,Tools,Styles,Util,Helpers){var updateStyles=function(elm,cssText){elm.style.cssText+=";"+cssText};var extractDataFromElement=function(editor,elm){var dom=editor.dom;var data={width:dom.getStyle(elm,"width")||dom.getAttrib(elm,"width"),height:dom.getStyle(elm,"height")||dom.getAttrib(elm,"height"),scope:dom.getAttrib(elm,"scope"),class:dom.getAttrib(elm,"class")};data.type=elm.nodeName.toLowerCase();Tools.each("left center right".split(" "),function(name){if(editor.formatter.matchNode(elm,"align"+name)){data.align=name}});Tools.each("top middle bottom".split(" "),function(name){if(editor.formatter.matchNode(elm,"valign"+name)){data.valign=name}});if(editor.settings.table_cell_advtab!==false){Tools.extend(data,Helpers.extractAdvancedStyles(dom,elm))}return data};var onSubmitCellForm=function(editor,cells,evt){var dom=editor.dom;var data;function setAttrib(elm,name,value){if(value){dom.setAttrib(elm,name,value)}}function setStyle(elm,name,value){if(value){dom.setStyle(elm,name,value)}}Helpers.updateStyleField(editor,evt);data=evt.control.rootControl.toJSON();editor.undoManager.transact(function(){Tools.each(cells,function(cellElm){setAttrib(cellElm,"scope",data.scope);if(cells.length===1){setAttrib(cellElm,"style",data.style)}else{updateStyles(cellElm,data.style)}setAttrib(cellElm,"class",data["class"]);setStyle(cellElm,"width",Util.addSizeSuffix(data.width));setStyle(cellElm,"height",Util.addSizeSuffix(data.height));if(data.type&&cellElm.nodeName.toLowerCase()!==data.type){cellElm=dom.rename(cellElm,data.type)}if(cells.length===1){Styles.unApplyAlign(editor,cellElm);Styles.unApplyVAlign(editor,cellElm)}if(data.align){Styles.applyAlign(editor,cellElm,data.align)}if(data.valign){Styles.applyVAlign(editor,cellElm,data.valign)}});editor.focus()})};var open=function(editor){var cellElm,data,classListCtrl,cells=[];cells=editor.dom.select("td[data-mce-selected],th[data-mce-selected]");cellElm=editor.dom.getParent(editor.selection.getStart(),"td,th");if(!cells.length&&cellElm){cells.push(cellElm)}cellElm=cellElm||cells[0];if(!cellElm){return}if(cells.length>1){data={width:"",height:"",scope:"",class:"",align:"",style:"",type:cellElm.nodeName.toLowerCase()}}else{data=extractDataFromElement(editor,cellElm)}if(editor.settings.table_cell_class_list){classListCtrl={name:"class",type:"listbox",label:"Class",values:Helpers.buildListItems(editor.settings.table_cell_class_list,function(item){if(item.value){item.textStyle=function(){return editor.formatter.getCssText({block:"td",classes:[item.value]})}}})}}var generalCellForm={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:false,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:Fun.curry(Helpers.updateStyleField,editor)},{label:"Height",name:"height",onchange:Fun.curry(Helpers.updateStyleField,editor)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},classListCtrl]};if(editor.settings.table_cell_advtab!==false){editor.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:data,body:[{title:"General",type:"form",items:generalCellForm},Helpers.createStyleForm(editor)],onsubmit:Fun.curry(onSubmitCellForm,editor,cells)})}else{editor.windowManager.open({title:"Cell properties",data:data,body:generalCellForm,onsubmit:Fun.curry(onSubmitCellForm,editor,cells)})}};return{open:open}});define("tinymce.plugins.table.actions.TableCommands",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.CopyRows","ephox.snooker.api.TableFill","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","tinymce.core.util.Tools","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.TableTargets","tinymce.plugins.table.ui.TableDialog","tinymce.plugins.table.ui.RowDialog","tinymce.plugins.table.ui.CellDialog"],function(Arr,Fun,Option,CopyRows,TableFill,TableLookup,Insert,Remove,Replication,Element,Tools,Util,TableTargets,TableDialog,RowDialog,CellDialog){var each=Tools.each;var clipboardRows=Option.none();var getClipboardRows=function(){return clipboardRows.fold(function(){return},function(rows){return Arr.map(rows,function(row){return row.dom()})})};var setClipboardRows=function(rows){var sugarRows=Arr.map(rows,Element.fromDom);clipboardRows=Option.from(sugarRows)};var registerCommands=function(editor,actions,cellSelection,selections){var isRoot=Util.getIsRoot(editor);var eraseTable=function(){var cell=Element.fromDom(editor.dom.getParent(editor.selection.getStart(),"th,td"));var table=TableLookup.table(cell,isRoot);table.filter(Fun.not(isRoot)).each(function(table){var cursor=Element.fromText("");Insert.after(table,cursor);Remove.remove(table);var rng=editor.dom.createRng();rng.setStart(cursor.dom(),0);rng.setEnd(cursor.dom(),0);editor.selection.setRng(rng)})};var getSelectionStartCell=function(){return Element.fromDom(editor.dom.getParent(editor.selection.getStart(),"th,td"))};var getTableFromCell=function(cell){return TableLookup.table(cell,isRoot)};var actOnSelection=function(execute){var cell=getSelectionStartCell();var table=getTableFromCell(cell);table.each(function(table){var targets=TableTargets.forMenu(selections,table,cell);execute(table,targets).each(function(rng){editor.selection.setRng(rng);editor.focus();cellSelection.clear(table)})})};var copyRowSelection=function(execute){var cell=getSelectionStartCell();var table=getTableFromCell(cell);return table.bind(function(table){var doc=Element.fromDom(editor.getDoc());var targets=TableTargets.forMenu(selections,table,cell);var generators=TableFill.cellOperations(Fun.noop,doc,Option.none());return CopyRows.copyRows(table,targets,generators)})};var pasteOnSelection=function(execute){clipboardRows.each(function(rows){var clonedRows=Arr.map(rows,function(row){return Replication.deep(row)});var cell=getSelectionStartCell();var table=getTableFromCell(cell);table.bind(function(table){var doc=Element.fromDom(editor.getDoc());var generators=TableFill.paste(doc);var targets=TableTargets.pasteRows(selections,table,cell,clonedRows,generators);execute(table,targets).each(function(rng){editor.selection.setRng(rng);editor.focus();cellSelection.clear(table)})})})};each({mceTableSplitCells:function(){actOnSelection(actions.unmergeCells)},mceTableMergeCells:function(){actOnSelection(actions.mergeCells)},mceTableInsertRowBefore:function(){actOnSelection(actions.insertRowsBefore)},mceTableInsertRowAfter:function(){actOnSelection(actions.insertRowsAfter)},mceTableInsertColBefore:function(){actOnSelection(actions.insertColumnsBefore)},mceTableInsertColAfter:function(){actOnSelection(actions.insertColumnsAfter)},mceTableDeleteCol:function(){actOnSelection(actions.deleteColumn)},mceTableDeleteRow:function(){actOnSelection(actions.deleteRow)},mceTableCutRow:function(grid){clipboardRows=copyRowSelection();actOnSelection(actions.deleteRow)},mceTableCopyRow:function(grid){clipboardRows=copyRowSelection()},mceTablePasteRowBefore:function(grid){pasteOnSelection(actions.pasteRowsBefore)},mceTablePasteRowAfter:function(grid){pasteOnSelection(actions.pasteRowsAfter)},mceTableDelete:eraseTable},function(func,name){editor.addCommand(name,func)});each({mceInsertTable:Fun.curry(TableDialog.open,editor),mceTableProps:Fun.curry(TableDialog.open,editor,true),mceTableRowProps:Fun.curry(RowDialog.open,editor),mceTableCellProps:Fun.curry(CellDialog.open,editor)},function(func,name){editor.addCommand(name,function(ui,val){func(val)})})};return{registerCommands:registerCommands,getClipboardRows:getClipboardRows,setClipboardRows:setClipboardRows}});define("ephox.snooker.api.ResizeWire",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.view.Location","ephox.sugar.api.view.Position"],function(Fun,Option,Element,Location,Position){var only=function(element){var parent=Option.from(element.dom().documentElement).map(Element.fromDom).getOr(element);return{parent:Fun.constant(parent),view:Fun.constant(element),origin:Fun.constant(Position(0,0))}};var detached=function(editable,chrome){var origin=Fun.curry(Location.absolute,chrome);return{parent:Fun.constant(chrome),view:Fun.constant(editable),origin:origin}};var body=function(editable,chrome){return{parent:Fun.constant(chrome),view:Fun.constant(editable),origin:Fun.constant(Position(0,0))}};return{only:only,detached:detached,body:body}});define("ephox.porkbun.Event",["ephox.katamari.api.Arr","ephox.katamari.api.Struct"],function(Arr,Struct){return function(fields){var struct=Struct.immutable.apply(null,fields);var handlers=[];var bind=function(handler){if(handler===undefined){throw"Event bind error: undefined handler"}handlers.push(handler)};var unbind=function(handler){handlers=Arr.filter(handlers,function(h){return h!==handler})};var trigger=function(){var event=struct.apply(null,arguments);Arr.each(handlers,function(handler){handler(event)})};return{bind:bind,unbind:unbind,trigger:trigger}}});define("ephox.porkbun.Events",["ephox.katamari.api.Obj"],function(Obj){var create=function(typeDefs){var registry=Obj.map(typeDefs,function(event){return{bind:event.bind,unbind:event.unbind}});var trigger=Obj.map(typeDefs,function(event){return event.trigger});return{registry:registry,trigger:trigger}};return{create:create}});define("ephox.dragster.api.DragApis",["ephox.katamari.api.Contracts"],function(Contracts){var mode=Contracts.exactly(["compare","extract","mutate","sink"]);var sink=Contracts.exactly(["element","start","stop","destroy"]);var api=Contracts.exactly(["forceDrop","drop","move","delayDrop"]);return{mode:mode,sink:sink,api:api}});define("ephox.dragster.style.Styles",["ephox.katamari.api.Namespace"],function(Namespace){var styles=Namespace.css("ephox-dragster");return{resolve:styles.resolve}});define("ephox.dragster.detect.Blocker",["ephox.dragster.style.Styles","ephox.katamari.api.Merger","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Remove"],function(Styles,Merger,Class,Css,Element,Remove){return function(options){var settings=Merger.merge({layerClass:Styles.resolve("blocker")},options);var div=Element.fromTag("div");Css.setAll(div,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"});Class.add(div,Styles.resolve("blocker"));Class.add(div,settings.layerClass);var element=function(){return div};var destroy=function(){Remove.remove(div)};return{element:element,destroy:destroy}}});define("ephox.sugar.impl.FilteredEvent",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element"],function(Fun,Element){var mkEvent=function(target,x,y,stop,prevent,kill,raw){return{target:Fun.constant(target),x:Fun.constant(x),y:Fun.constant(y),stop:stop,prevent:prevent,kill:kill,raw:Fun.constant(raw)}};var handle=function(filter,handler){return function(rawEvent){if(!filter(rawEvent)){return}var target=Element.fromDom(rawEvent.target);var stop=function(){rawEvent.stopPropagation()};var prevent=function(){rawEvent.preventDefault()};var kill=Fun.compose(prevent,stop);var evt=mkEvent(target,rawEvent.clientX,rawEvent.clientY,stop,prevent,kill,rawEvent);handler(evt)}};var binder=function(element,event,filter,handler,useCapture){var wrapped=handle(filter,handler);element.dom().addEventListener(event,wrapped,useCapture);return{unbind:Fun.curry(unbind,element,event,wrapped,useCapture)}};var bind=function(element,event,filter,handler){return binder(element,event,filter,handler,false)};var capture=function(element,event,filter,handler){return binder(element,event,filter,handler,true)};var unbind=function(element,event,handler,useCapture){element.dom().removeEventListener(event,handler,useCapture)};return{bind:bind,capture:capture}});define("ephox.sugar.api.events.DomEvent",["ephox.katamari.api.Fun","ephox.sugar.impl.FilteredEvent"],function(Fun,FilteredEvent){var filter=Fun.constant(true);var bind=function(element,event,handler){return FilteredEvent.bind(element,event,filter,handler)};var capture=function(element,event,handler){return FilteredEvent.capture(element,event,filter,handler)};return{bind:bind,capture:capture}});define("ephox.dragster.api.MouseDrag",["ephox.dragster.api.DragApis","ephox.dragster.detect.Blocker","ephox.katamari.api.Option","ephox.sugar.api.view.Position","ephox.sugar.api.events.DomEvent","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove"],function(DragApis,Blocker,Option,Position,DomEvent,Insert,Remove){var compare=function(old,nu){return Position(nu.left()-old.left(),nu.top()-old.top())};var extract=function(event){return Option.some(Position(event.x(),event.y()))};var mutate=function(mutation,info){mutation.mutate(info.left(),info.top())};var sink=function(dragApi,settings){var blocker=Blocker(settings);var mdown=DomEvent.bind(blocker.element(),"mousedown",dragApi.forceDrop);var mup=DomEvent.bind(blocker.element(),"mouseup",dragApi.drop);var mmove=DomEvent.bind(blocker.element(),"mousemove",dragApi.move);var mout=DomEvent.bind(blocker.element(),"mouseout",dragApi.delayDrop);var destroy=function(){blocker.destroy();mup.unbind();mmove.unbind();mout.unbind();mdown.unbind()};var start=function(parent){Insert.append(parent,blocker.element())};var stop=function(){Remove.remove(blocker.element())};return DragApis.sink({element:blocker.element,start:start,stop:stop,destroy:destroy})};return DragApis.mode({compare:compare,extract:extract,sink:sink,mutate:mutate})});define("ephox.dragster.detect.InDrag",["ephox.katamari.api.Option","ephox.porkbun.Event","ephox.porkbun.Events"],function(Option,Event,Events){return function(){var previous=Option.none();var reset=function(){previous=Option.none()};var update=function(mode,nu){var result=previous.map(function(old){return mode.compare(old,nu)});previous=Option.some(nu);return result};var onEvent=function(event,mode){var dataOption=mode.extract(event);dataOption.each(function(data){var offset=update(mode,data);offset.each(function(d){events.trigger.move(d)})})};var events=Events.create({move:Event(["info"])});return{onEvent:onEvent,reset:reset,events:events.registry}}});define("ephox.dragster.detect.NoDrag",["ephox.katamari.api.Fun"],function(Fun){return function(anchor){var onEvent=function(event,mode){};return{onEvent:onEvent,reset:Fun.noop}}});define("ephox.dragster.detect.Movement",["ephox.dragster.detect.InDrag","ephox.dragster.detect.NoDrag"],function(InDrag,NoDrag){return function(){var noDragState=NoDrag();var inDragState=InDrag();var dragState=noDragState;var on=function(){dragState.reset();dragState=inDragState};var off=function(){dragState.reset();dragState=noDragState};var onEvent=function(event,mode){dragState.onEvent(event,mode)};var isOn=function(){return dragState===inDragState};return{on:on,off:off,isOn:isOn,onEvent:onEvent,events:inDragState.events}}});defineGlobal("global!clearTimeout",clearTimeout);defineGlobal("global!setTimeout",setTimeout);define("ephox.katamari.api.Throttler",["global!clearTimeout","global!setTimeout"],function(clearTimeout,setTimeout){var adaptable=function(fn,rate){var timer=null;var args=null;var cancel=function(){if(timer!==null){clearTimeout(timer);timer=null;args=null}};var throttle=function(){args=arguments;if(timer===null){timer=setTimeout(function(){fn.apply(null,args);timer=null;args=null},rate)}};return{cancel:cancel,throttle:throttle}};var first=function(fn,rate){var timer=null;var cancel=function(){if(timer!==null){clearTimeout(timer);timer=null}};var throttle=function(){var args=arguments;if(timer===null){timer=setTimeout(function(){fn.apply(null,args);timer=null;args=null},rate)}};return{cancel:cancel,throttle:throttle}};var last=function(fn,rate){var timer=null;var cancel=function(){if(timer!==null){clearTimeout(timer);timer=null}};var throttle=function(){var args=arguments;if(timer!==null){clearTimeout(timer)}timer=setTimeout(function(){fn.apply(null,args);timer=null;args=null},rate)};return{cancel:cancel,throttle:throttle}};return{adaptable:adaptable,first:first,last:last}});define("ephox.dragster.core.Dragging",["ephox.dragster.api.DragApis","ephox.dragster.detect.Movement","ephox.katamari.api.Throttler","ephox.porkbun.Event","ephox.porkbun.Events","global!Array"],function(DragApis,Movement,Throttler,Event,Events,Array){var setup=function(mutation,mode,settings){var active=false;var events=Events.create({start:Event([]),stop:Event([])});var movement=Movement();var drop=function(){sink.stop();if(movement.isOn()){movement.off();events.trigger.stop()}};var throttledDrop=Throttler.last(drop,200);var go=function(parent){sink.start(parent);movement.on();events.trigger.start()};var mousemove=function(event,ui){throttledDrop.cancel();movement.onEvent(event,mode)};movement.events.move.bind(function(event){mode.mutate(mutation,event.info())});var on=function(){active=true};var off=function(){active=false};var runIfActive=function(f){return function(){var args=Array.prototype.slice.call(arguments,0);if(active){return f.apply(null,args)}}};var sink=mode.sink(DragApis.api({forceDrop:drop,drop:runIfActive(drop),move:runIfActive(mousemove),delayDrop:runIfActive(throttledDrop.throttle)}),settings);var destroy=function(){sink.destroy()};return{element:sink.element,go:go,on:on,off:off,destroy:destroy,events:events.registry}};return{setup:setup}});define("ephox.dragster.api.Dragger",["ephox.dragster.api.MouseDrag","ephox.dragster.core.Dragging","global!Array"],function(MouseDrag,Dragging,Array){var transform=function(mutation,options){var settings=options!==undefined?options:{};var mode=settings.mode!==undefined?settings.mode:MouseDrag;return Dragging.setup(mutation,mode,options)};return{transform:transform}});define("ephox.snooker.resize.Mutation",["ephox.porkbun.Event","ephox.porkbun.Events"],function(Event,Events){return function(){var events=Events.create({drag:Event(["xDelta","yDelta"])});var mutate=function(x,y){events.trigger.drag(x,y)};return{mutate:mutate,events:events.registry}}});define("ephox.snooker.resize.BarMutation",["ephox.katamari.api.Option","ephox.porkbun.Event","ephox.porkbun.Events","ephox.snooker.resize.Mutation"],function(Option,Event,Events,Mutation){return function(){var events=Events.create({drag:Event(["xDelta","yDelta","target"])});var target=Option.none();var delegate=Mutation();delegate.events.drag.bind(function(event){target.each(function(t){events.trigger.drag(event.xDelta(),event.yDelta(),t)})});var assign=function(t){target=Option.some(t)};var get=function(){return target};return{assign:assign,get:get,mutate:delegate.mutate,events:events.registry}}});define("ephox.sugar.api.search.SelectorExists",["ephox.sugar.api.search.SelectorFind"],function(SelectorFind){var any=function(selector){return SelectorFind.first(selector).isSome()};var ancestor=function(scope,selector,isRoot){return SelectorFind.ancestor(scope,selector,isRoot).isSome()};var sibling=function(scope,selector){return SelectorFind.sibling(scope,selector).isSome()};var child=function(scope,selector){return SelectorFind.child(scope,selector).isSome()};var descendant=function(scope,selector){return SelectorFind.descendant(scope,selector).isSome()};var closest=function(scope,selector,isRoot){return SelectorFind.closest(scope,selector,isRoot).isSome()};return{any:any,ancestor:ancestor,sibling:sibling,child:child,descendant:descendant,closest:closest}});define("ephox.snooker.resize.BarManager",["ephox.dragster.api.Dragger","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.porkbun.Event","ephox.porkbun.Events","ephox.snooker.resize.BarMutation","ephox.snooker.resize.Bars","ephox.snooker.style.Styles","ephox.snooker.util.CellUtils","ephox.sugar.api.dom.Compare","ephox.sugar.api.events.DomEvent","ephox.sugar.api.node.Body","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Css","ephox.sugar.api.search.SelectorExists","ephox.sugar.api.search.SelectorFind","global!parseInt"],function(Dragger,Fun,Option,Event,Events,BarMutation,Bars,Styles,CellUtils,Compare,DomEvent,Body,Node,Attr,Class,Css,SelectorExists,SelectorFind,parseInt){var resizeBarDragging=Styles.resolve("resizer-bar-dragging");return function(wire,direction,hdirection){var mutation=BarMutation();var resizing=Dragger.transform(mutation,{});var hoverTable=Option.none();var getResizer=function(element,type){return Option.from(Attr.get(element,type))};mutation.events.drag.bind(function(event){getResizer(event.target(),"data-row").each(function(_dataRow){var currentRow=CellUtils.getInt(event.target(),"top");Css.set(event.target(),"top",currentRow+event.yDelta()+"px")});getResizer(event.target(),"data-column").each(function(_dataCol){var currentCol=CellUtils.getInt(event.target(),"left");Css.set(event.target(),"left",currentCol+event.xDelta()+"px")})});var getDelta=function(target,direction){var newX=CellUtils.getInt(target,direction);var oldX=parseInt(Attr.get(target,"data-initial-"+direction),10);return newX-oldX};resizing.events.stop.bind(function(){mutation.get().each(function(target){hoverTable.each(function(table){getResizer(target,"data-row").each(function(row){var delta=getDelta(target,"top");Attr.remove(target,"data-initial-top");events.trigger.adjustHeight(table,delta,parseInt(row,10))});getResizer(target,"data-column").each(function(column){var delta=getDelta(target,"left");Attr.remove(target,"data-initial-left");events.trigger.adjustWidth(table,delta,parseInt(column,10))});Bars.refresh(wire,table,hdirection,direction)})})});var handler=function(target,direction){events.trigger.startAdjust();mutation.assign(target);Attr.set(target,"data-initial-"+direction,parseInt(Css.get(target,direction),10));Class.add(target,resizeBarDragging);Css.set(target,"opacity","0.2");resizing.go(wire.parent())};var mousedown=DomEvent.bind(wire.parent(),"mousedown",function(event){if(Bars.isRowBar(event.target())){handler(event.target(),"top")}if(Bars.isColBar(event.target())){handler(event.target(),"left")}});var isRoot=function(e){return Compare.eq(e,wire.view())};var mouseover=DomEvent.bind(wire.view(),"mouseover",function(event){if(Node.name(event.target())==="table"||SelectorExists.ancestor(event.target(),"table",isRoot)){hoverTable=Node.name(event.target())==="table"?Option.some(event.target()):SelectorFind.ancestor(event.target(),"table",isRoot);hoverTable.each(function(ht){Bars.refresh(wire,ht,hdirection,direction)})}else if(Body.inBody(event.target())){Bars.destroy(wire)}});var destroy=function(){mousedown.unbind();mouseover.unbind();resizing.destroy();Bars.destroy(wire)};var refresh=function(tbl){Bars.refresh(wire,tbl,hdirection,direction)};var events=Events.create({adjustHeight:Event(["table","delta","row"]),adjustWidth:Event(["table","delta","column"]),startAdjust:Event([])});return{destroy:destroy,refresh:refresh,on:resizing.on,off:resizing.off,hideBars:Fun.curry(Bars.hide,wire),showBars:Fun.curry(Bars.show,wire),events:events.registry}}});define("ephox.snooker.api.TableResize",["ephox.porkbun.Event","ephox.porkbun.Events","ephox.snooker.resize.Adjustments","ephox.snooker.resize.BarManager","ephox.snooker.resize.BarPositions"],function(Event,Events,Adjustments,BarManager,BarPositions){return function(wire,vdirection){var hdirection=BarPositions.height;var manager=BarManager(wire,vdirection,hdirection);var events=Events.create({beforeResize:Event(["table"]),afterResize:Event(["table"]),startDrag:Event([])});manager.events.adjustHeight.bind(function(event){events.trigger.beforeResize(event.table());var delta=hdirection.delta(event.delta(),event.table());Adjustments.adjustHeight(event.table(),delta,event.row(),hdirection);events.trigger.afterResize(event.table())});manager.events.startAdjust.bind(function(event){events.trigger.startDrag()});manager.events.adjustWidth.bind(function(event){events.trigger.beforeResize(event.table());var delta=vdirection.delta(event.delta(),event.table());Adjustments.adjustWidth(event.table(),delta,event.column(),vdirection);events.trigger.afterResize(event.table())});return{on:manager.on,off:manager.off,hideBars:manager.hideBars,showBars:manager.showBars,destroy:manager.destroy,events:events.registry}}});define("tinymce.plugins.table.actions.TableWire",["ephox.snooker.api.ResizeWire","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Body","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Css","tinymce.plugins.table.alien.Util"],function(ResizeWire,Insert,Remove,Body,Element,Css,Util){var createContainer=function(){var container=Element.fromTag("div");Css.setAll(container,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"});Insert.append(Body.body(),container);return container};var get=function(editor,container){return editor.inline?ResizeWire.body(Util.getBody(editor),createContainer()):ResizeWire.only(Element.fromDom(editor.getDoc()))};var remove=function(editor,wire){if(editor.inline){Remove.remove(wire.parent())}};return{get:get,remove:remove}});define("tinymce.plugins.table.actions.ResizeHandler",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.ResizeWire","ephox.snooker.api.TableDirection","ephox.snooker.api.TableResize","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter","tinymce.plugins.table.actions.TableWire","tinymce.plugins.table.queries.Direction","tinymce.core.util.Tools"],function(Arr,Option,ResizeWire,TableDirection,TableResize,Element,Attr,SelectorFilter,TableWire,Direction,Tools){return function(editor){var selectionRng=Option.none();var resize=Option.none();var wire=Option.none();var percentageBasedSizeRegex=/(\d+(\.\d+)?)%/;var startW,startRawW;var isTable=function(elm){return elm.nodeName==="TABLE"};var getRawWidth=function(elm){return editor.dom.getStyle(elm,"width")||editor.dom.getAttrib(elm,"width")};var lazyResize=function(){return resize};var lazyWire=function(){return wire.getOr(ResizeWire.only(Element.fromDom(editor.getBody())))};var destroy=function(){resize.each(function(sz){sz.destroy()});wire.each(function(w){TableWire.remove(editor,w)})};editor.on("init",function(){var direction=TableDirection(Direction.directionAt);var rawWire=TableWire.get(editor);wire=Option.some(rawWire);if(editor.settings.object_resizing&&editor.settings.table_resize_bars!==false&&(editor.settings.object_resizing===true||editor.settings.object_resizing==="table")){var sz=TableResize(rawWire,direction);sz.on();sz.events.startDrag.bind(function(event){selectionRng=Option.some(editor.selection.getRng())});sz.events.afterResize.bind(function(event){var table=event.table();var dataStyleCells=SelectorFilter.descendants(table,"td[data-mce-style],th[data-mce-style]");Arr.each(dataStyleCells,function(cell){Attr.remove(cell,"data-mce-style")});selectionRng.each(function(rng){editor.selection.setRng(rng);editor.focus()});editor.undoManager.add()});resize=Option.some(sz)}});editor.on("ObjectResizeStart",function(e){if(isTable(e.target)){startW=e.width;startRawW=getRawWidth(e.target)}});editor.on("ObjectResized",function(e){if(isTable(e.target)){var table=e.target;if(percentageBasedSizeRegex.test(startRawW)){var percentW=parseFloat(percentageBasedSizeRegex.exec(startRawW)[1],10);var targetPercentW=e.width*percentW/startW;editor.dom.setStyle(table,"width",targetPercentW+"%")}else{var newCellSizes=[];Tools.each(table.rows,function(row){Tools.each(row.cells,function(cell){var width=editor.dom.getStyle(cell,"width",true);newCellSizes.push({cell:cell,width:width})})});Tools.each(newCellSizes,function(newCellSize){editor.dom.setStyle(newCellSize.cell,"width",newCellSize.width);editor.dom.setAttrib(newCellSize.cell,"width",null)})}}});return{lazyResize:lazyResize,lazyWire:lazyWire,destroy:destroy}}});define("ephox.snooker.api.CellLocation",[],function(){var none=function(current){return folder(function(n,f,m,l){return n(current)})};var first=function(current){return folder(function(n,f,m,l){return f(current)})};var middle=function(current,target){return folder(function(n,f,m,l){return m(current,target)})};var last=function(current){return folder(function(n,f,m,l){return l(current)})};var folder=function(fold){return{fold:fold}};return{none:none,first:first,middle:middle,last:last}});define("ephox.snooker.api.CellNavigation",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.api.CellLocation","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Compare"],function(Arr,Fun,CellLocation,TableLookup,Compare){var detect=function(current,isRoot){return TableLookup.table(current,isRoot).bind(function(table){var all=TableLookup.cells(table);var index=Arr.findIndex(all,function(x){return Compare.eq(current,x)});return index.map(function(ind){return{index:Fun.constant(ind),all:Fun.constant(all)}})})};var next=function(current,isRoot){var detection=detect(current,isRoot);return detection.fold(function(){return CellLocation.none(current)},function(info){return info.index()+1<info.all().length?CellLocation.middle(current,info.all()[info.index()+1]):CellLocation.last(current)})};var prev=function(current,isRoot){var detection=detect(current,isRoot);return detection.fold(function(){return CellLocation.none()},function(info){return info.index()-1>=0?CellLocation.middle(current,info.all()[info.index()-1]):CellLocation.first(current)})};return{next:next,prev:prev}});define("ephox.sugar.api.selection.Situ",["ephox.katamari.api.Adt","ephox.katamari.api.Fun"],function(Adt,Fun){var adt=Adt.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]);var cata=function(subject,onBefore,onOn,onAfter){return subject.fold(onBefore,onOn,onAfter)};var getStart=function(situ){return situ.fold(Fun.identity,Fun.identity,Fun.identity)};return{before:adt.before,on:adt.on,after:adt.after,cata:cata,getStart:getStart}});define("ephox.sugar.api.selection.Selection",["ephox.katamari.api.Adt","ephox.katamari.api.Struct","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Situ"],function(Adt,Struct,Element,Traverse,Situ){var type=Adt.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]);var range=Struct.immutable("start","soffset","finish","foffset");var exactFromRange=function(simRange){return type.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())};var getStart=function(selection){return selection.match({domRange:function(rng){return Element.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return Situ.getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})};var getWin=function(selection){var start=getStart(selection);return Traverse.defaultView(start)};return{domRange:type.domRange,relative:type.relative,exact:type.exact,exactFromRange:exactFromRange,range:range,getWin:getWin}});define("ephox.sugar.api.dom.DocumentPosition",["ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse"],function(Compare,Element,Traverse){var makeRange=function(start,soffset,finish,foffset){var doc=Traverse.owner(start);var rng=doc.dom().createRange();rng.setStart(start.dom(),soffset);rng.setEnd(finish.dom(),foffset);return rng};var commonAncestorContainer=function(start,soffset,finish,foffset){var r=makeRange(start,soffset,finish,foffset);return Element.fromDom(r.commonAncestorContainer)};var after=function(start,soffset,finish,foffset){var r=makeRange(start,soffset,finish,foffset);var same=Compare.eq(start,finish)&&soffset===foffset;return r.collapsed&&!same};return{after:after,commonAncestorContainer:commonAncestorContainer}});define("ephox.sugar.api.node.Fragment",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","global!document"],function(Arr,Element,document){var fromElements=function(elements,scope){var doc=scope||document;var fragment=doc.createDocumentFragment();Arr.each(elements,function(element){fragment.appendChild(element.dom())});return Element.fromDom(fragment)};return{fromElements:fromElements}});define("ephox.sugar.selection.core.NativeRange",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(Fun,Option,Compare,Element){var selectNodeContents=function(win,element){var rng=win.document.createRange();selectNodeContentsUsing(rng,element);return rng};var selectNodeContentsUsing=function(rng,element){rng.selectNodeContents(element.dom())};var isWithin=function(outerRange,innerRange){return innerRange.compareBoundaryPoints(outerRange.END_TO_START,outerRange)<1&&innerRange.compareBoundaryPoints(outerRange.START_TO_END,outerRange)>-1};var create=function(win){return win.document.createRange()};var setStart=function(rng,situ){situ.fold(function(e){rng.setStartBefore(e.dom())},function(e,o){rng.setStart(e.dom(),o)},function(e){rng.setStartAfter(e.dom())})};var setFinish=function(rng,situ){situ.fold(function(e){rng.setEndBefore(e.dom())},function(e,o){rng.setEnd(e.dom(),o)},function(e){rng.setEndAfter(e.dom())})};var replaceWith=function(rng,fragment){deleteContents(rng);rng.insertNode(fragment.dom())};var isCollapsed=function(start,soffset,finish,foffset){return Compare.eq(start,finish)&&soffset===foffset};var relativeToNative=function(win,startSitu,finishSitu){var range=win.document.createRange();setStart(range,startSitu);setFinish(range,finishSitu);return range};var exactToNative=function(win,start,soffset,finish,foffset){var rng=win.document.createRange();rng.setStart(start.dom(),soffset);rng.setEnd(finish.dom(),foffset);return rng};var deleteContents=function(rng){rng.deleteContents()};var cloneFragment=function(rng){var fragment=rng.cloneContents();return Element.fromDom(fragment)};var toRect=function(rect){return{left:Fun.constant(rect.left),top:Fun.constant(rect.top),right:Fun.constant(rect.right),bottom:Fun.constant(rect.bottom),width:Fun.constant(rect.width),height:Fun.constant(rect.height)}};var getFirstRect=function(rng){var rects=rng.getClientRects();var rect=rects.length>0?rects[0]:rng.getBoundingClientRect();return rect.width>0||rect.height>0?Option.some(rect).map(toRect):Option.none()};var getBounds=function(rng){var rect=rng.getBoundingClientRect();return rect.width>0||rect.height>0?Option.some(rect).map(toRect):Option.none()};var toString=function(rng){return rng.toString()};return{create:create,replaceWith:replaceWith,selectNodeContents:selectNodeContents,selectNodeContentsUsing:selectNodeContentsUsing,isCollapsed:isCollapsed,relativeToNative:relativeToNative,exactToNative:exactToNative,deleteContents:deleteContents,cloneFragment:cloneFragment,getFirstRect:getFirstRect,getBounds:getBounds,isWithin:isWithin,toString:toString}});define("ephox.sugar.selection.core.SelectionDirection",["ephox.katamari.api.Adt","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Thunk","ephox.sugar.api.node.Element","ephox.sugar.selection.core.NativeRange"],function(Adt,Fun,Option,Thunk,Element,NativeRange){var adt=Adt.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);var fromRange=function(win,type,range){return type(Element.fromDom(range.startContainer),range.startOffset,Element.fromDom(range.endContainer),range.endOffset)};var getRanges=function(win,selection){return selection.match({domRange:function(rng){return{ltr:Fun.constant(rng),rtl:Option.none}},relative:function(startSitu,finishSitu){return{ltr:Thunk.cached(function(){return NativeRange.relativeToNative(win,startSitu,finishSitu)}),rtl:Thunk.cached(function(){return Option.some(NativeRange.relativeToNative(win,finishSitu,startSitu))})}},exact:function(start,soffset,finish,foffset){return{ltr:Thunk.cached(function(){return NativeRange.exactToNative(win,start,soffset,finish,foffset)}),rtl:Thunk.cached(function(){return Option.some(NativeRange.exactToNative(win,finish,foffset,start,soffset))})}}})};var doDiagnose=function(win,ranges){var rng=ranges.ltr();if(rng.collapsed){var reversed=ranges.rtl().filter(function(rev){return rev.collapsed===false});return reversed.map(function(rev){return adt.rtl(Element.fromDom(rev.endContainer),rev.endOffset,Element.fromDom(rev.startContainer),rev.startOffset)}).getOrThunk(function(){return fromRange(win,adt.ltr,rng)})}else{return fromRange(win,adt.ltr,rng)}};var diagnose=function(win,selection){var ranges=getRanges(win,selection);return doDiagnose(win,ranges)};var asLtrRange=function(win,selection){var diagnosis=diagnose(win,selection);return diagnosis.match({ltr:function(start,soffset,finish,foffset){var rng=win.document.createRange();rng.setStart(start.dom(),soffset);rng.setEnd(finish.dom(),foffset);return rng},rtl:function(start,soffset,finish,foffset){var rng=win.document.createRange();rng.setStart(finish.dom(),foffset);rng.setEnd(start.dom(),soffset);return rng}})};return{ltr:adt.ltr,rtl:adt.rtl,diagnose:diagnose,asLtrRange:asLtrRange}});define("ephox.sugar.selection.alien.Geometry",["global!Math"],function(Math){var searchForPoint=function(rectForOffset,x,y,maxX,length){if(length===0){return 0}else if(x===maxX){return length-1}var xDelta=maxX;for(var i=1;i<length;i++){var rect=rectForOffset(i);var curDeltaX=Math.abs(x-rect.left);if(y>rect.bottom){}else if(y<rect.top||curDeltaX>xDelta){return i-1}else{xDelta=curDeltaX}}return 0};var inRect=function(rect,x,y){return x>=rect.left&&x<=rect.right&&y>=rect.top&&y<=rect.bottom};return{inRect:inRect,searchForPoint:searchForPoint}});define("ephox.sugar.selection.query.TextPoint",["ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.node.Text","ephox.sugar.selection.alien.Geometry","global!Math"],function(Option,Options,Text,Geometry,Math){var locateOffset=function(doc,textnode,x,y,rect){var rangeForOffset=function(offset){var r=doc.dom().createRange();r.setStart(textnode.dom(),offset);r.collapse(true);return r};var rectForOffset=function(offset){var r=rangeForOffset(offset);return r.getBoundingClientRect()};var length=Text.get(textnode).length;var offset=Geometry.searchForPoint(rectForOffset,x,y,rect.right,length);return rangeForOffset(offset)};var locate=function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rects=r.getClientRects();var foundRect=Options.findMap(rects,function(rect){return Geometry.inRect(rect,x,y)?Option.some(rect):Option.none()});return foundRect.map(function(rect){return locateOffset(doc,node,x,y,rect)})};return{locate:locate}});define("ephox.sugar.selection.query.ContainerPoint",["ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.node.Node","ephox.sugar.api.search.Traverse","ephox.sugar.selection.alien.Geometry","ephox.sugar.selection.query.TextPoint","global!Math"],function(Option,Options,Node,Traverse,Geometry,TextPoint,Math){var searchInChildren=function(doc,node,x,y){var r=doc.dom().createRange();var nodes=Traverse.children(node);return Options.findMap(nodes,function(n){r.selectNode(n.dom());return Geometry.inRect(r.getBoundingClientRect(),x,y)?locateNode(doc,n,x,y):Option.none()})};var locateNode=function(doc,node,x,y){var locator=Node.isText(node)?TextPoint.locate:searchInChildren;return locator(doc,node,x,y)};var locate=function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rect=r.getBoundingClientRect();var boundedX=Math.max(rect.left,Math.min(rect.right,x));var boundedY=Math.max(rect.top,Math.min(rect.bottom,y));return locateNode(doc,node,boundedX,boundedY)};return{locate:locate}});define("ephox.sugar.selection.query.EdgePoint",["ephox.katamari.api.Option","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.CursorPosition"],function(Option,Traverse,CursorPosition){var COLLAPSE_TO_LEFT=true;var COLLAPSE_TO_RIGHT=false;var getCollapseDirection=function(rect,x){return x-rect.left<rect.right-x?COLLAPSE_TO_LEFT:COLLAPSE_TO_RIGHT};var createCollapsedNode=function(doc,target,collapseDirection){var r=doc.dom().createRange();r.selectNode(target.dom());r.collapse(collapseDirection);return r};var locateInElement=function(doc,node,x){var cursorRange=doc.dom().createRange();cursorRange.selectNode(node.dom());var rect=cursorRange.getBoundingClientRect();var collapseDirection=getCollapseDirection(rect,x);var f=collapseDirection===COLLAPSE_TO_LEFT?CursorPosition.first:CursorPosition.last;return f(node).map(function(target){return createCollapsedNode(doc,target,collapseDirection)})};var locateInEmpty=function(doc,node,x){var rect=node.dom().getBoundingClientRect();var collapseDirection=getCollapseDirection(rect,x);return Option.some(createCollapsedNode(doc,node,collapseDirection))};var search=function(doc,node,x){var f=Traverse.children(node).length===0?locateInEmpty:locateInElement;return f(doc,node,x)};return{search:search}});define("ephox.sugar.selection.query.CaretRange",["ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","ephox.sugar.selection.query.ContainerPoint","ephox.sugar.selection.query.EdgePoint","global!document","global!Math"],function(Option,Element,Traverse,Selection,ContainerPoint,EdgePoint,document,Math){var caretPositionFromPoint=function(doc,x,y){return Option.from(doc.dom().caretPositionFromPoint(x,y)).bind(function(pos){if(pos.offsetNode===null){return Option.none()}var r=doc.dom().createRange();r.setStart(pos.offsetNode,pos.offset);r.collapse();return Option.some(r)})};var caretRangeFromPoint=function(doc,x,y){return Option.from(doc.dom().caretRangeFromPoint(x,y))};var searchTextNodes=function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rect=r.getBoundingClientRect();var boundedX=Math.max(rect.left,Math.min(rect.right,x));var boundedY=Math.max(rect.top,Math.min(rect.bottom,y));return ContainerPoint.locate(doc,node,boundedX,boundedY)};var searchFromPoint=function(doc,x,y){return Element.fromPoint(doc,x,y).bind(function(elem){var fallback=function(){return EdgePoint.search(doc,elem,x)};return Traverse.children(elem).length===0?fallback():searchTextNodes(doc,elem,x,y).orThunk(fallback)})};var availableSearch=document.caretPositionFromPoint?caretPositionFromPoint:document.caretRangeFromPoint?caretRangeFromPoint:searchFromPoint;var fromPoint=function(win,x,y){var doc=Element.fromDom(win.document);return availableSearch(doc,x,y).map(function(rng){return Selection.range(Element.fromDom(rng.startContainer),rng.startOffset,Element.fromDom(rng.endContainer),rng.endOffset)})};return{fromPoint:fromPoint}});define("ephox.sugar.selection.query.Within",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.Selectors","ephox.sugar.selection.core.NativeRange","ephox.sugar.selection.core.SelectionDirection"],function(Arr,Element,Node,SelectorFilter,Selectors,NativeRange,SelectionDirection){var withinContainer=function(win,ancestor,outerRange,selector){var innerRange=NativeRange.create(win);var self=Selectors.is(ancestor,selector)?[ancestor]:[];var elements=self.concat(SelectorFilter.descendants(ancestor,selector));return Arr.filter(elements,function(elem){NativeRange.selectNodeContentsUsing(innerRange,elem);return NativeRange.isWithin(outerRange,innerRange)})};var find=function(win,selection,selector){var outerRange=SelectionDirection.asLtrRange(win,selection);var ancestor=Element.fromDom(outerRange.commonAncestorContainer);return Node.isElement(ancestor)?withinContainer(win,ancestor,outerRange,selector):[]};return{find:find}});define("ephox.sugar.selection.quirks.Prefilter",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.Situ"],function(Arr,Element,Node,Selection,Situ){var beforeSpecial=function(element,offset){var name=Node.name(element);if("input"===name){return Situ.after(element)}else if(!Arr.contains(["br","img"],name)){return Situ.on(element,offset)}else{return offset===0?Situ.before(element):Situ.after(element)}};var preprocessRelative=function(startSitu,finishSitu){var start=startSitu.fold(Situ.before,beforeSpecial,Situ.after);var finish=finishSitu.fold(Situ.before,beforeSpecial,Situ.after);return Selection.relative(start,finish)};var preprocessExact=function(start,soffset,finish,foffset){var startSitu=beforeSpecial(start,soffset);var finishSitu=beforeSpecial(finish,foffset);return Selection.relative(startSitu,finishSitu)};var preprocess=function(selection){return selection.match({domRange:function(rng){var start=Element.fromDom(rng.startContainer);var finish=Element.fromDom(rng.endContainer);return preprocessExact(start,rng.startOffset,finish,rng.endOffset)},relative:preprocessRelative,exact:preprocessExact})};return{beforeSpecial:beforeSpecial,preprocess:preprocess,preprocessRelative:preprocessRelative,preprocessExact:preprocessExact}});define("ephox.sugar.api.selection.WindowSelection",["ephox.katamari.api.Option","ephox.sugar.api.dom.DocumentPosition","ephox.sugar.api.node.Element","ephox.sugar.api.node.Fragment","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","ephox.sugar.selection.core.NativeRange","ephox.sugar.selection.core.SelectionDirection","ephox.sugar.selection.query.CaretRange","ephox.sugar.selection.query.Within","ephox.sugar.selection.quirks.Prefilter"],function(Option,DocumentPosition,Element,Fragment,Traverse,Selection,NativeRange,SelectionDirection,CaretRange,Within,Prefilter){var doSetNativeRange=function(win,rng){Option.from(win.getSelection()).each(function(selection){selection.removeAllRanges();selection.addRange(rng)})};var doSetRange=function(win,start,soffset,finish,foffset){var rng=NativeRange.exactToNative(win,start,soffset,finish,foffset);doSetNativeRange(win,rng)};var findWithin=function(win,selection,selector){return Within.find(win,selection,selector)};var setRangeFromRelative=function(win,relative){return SelectionDirection.diagnose(win,relative).match({ltr:function(start,soffset,finish,foffset){doSetRange(win,start,soffset,finish,foffset)},rtl:function(start,soffset,finish,foffset){var selection=win.getSelection();if(selection.extend){selection.collapse(start.dom(),soffset);selection.extend(finish.dom(),foffset)}else{doSetRange(win,finish,foffset,start,soffset)}}})};var setExact=function(win,start,soffset,finish,foffset){var relative=Prefilter.preprocessExact(start,soffset,finish,foffset);setRangeFromRelative(win,relative)};var setRelative=function(win,startSitu,finishSitu){var relative=Prefilter.preprocessRelative(startSitu,finishSitu);setRangeFromRelative(win,relative)};var toNative=function(selection){var win=Selection.getWin(selection).dom();var getDomRange=function(start,soffset,finish,foffset){return NativeRange.exactToNative(win,start,soffset,finish,foffset)};var filtered=Prefilter.preprocess(selection);return SelectionDirection.diagnose(win,filtered).match({ltr:getDomRange,rtl:getDomRange})};var readRange=function(selection){if(selection.rangeCount>0){var firstRng=selection.getRangeAt(0);var lastRng=selection.getRangeAt(selection.rangeCount-1);return Option.some(Selection.range(Element.fromDom(firstRng.startContainer),firstRng.startOffset,Element.fromDom(lastRng.endContainer),lastRng.endOffset))}else{return Option.none()}};var doGetExact=function(selection){var anchorNode=Element.fromDom(selection.anchorNode);var focusNode=Element.fromDom(selection.focusNode);return DocumentPosition.after(anchorNode,selection.anchorOffset,focusNode,selection.focusOffset)?Option.some(Selection.range(Element.fromDom(selection.anchorNode),selection.anchorOffset,Element.fromDom(selection.focusNode),selection.focusOffset)):readRange(selection)};var setToElement=function(win,element){var rng=NativeRange.selectNodeContents(win,element);doSetNativeRange(win,rng)};var forElement=function(win,element){var rng=NativeRange.selectNodeContents(win,element);return Selection.range(Element.fromDom(rng.startContainer),rng.startOffset,Element.fromDom(rng.endContainer),rng.endOffset)};var getExact=function(win){var selection=win.getSelection();return selection.rangeCount>0?doGetExact(selection):Option.none()};var get=function(win){return getExact(win).map(function(range){return Selection.exact(range.start(),range.soffset(),range.finish(),range.foffset())})};var getFirstRect=function(win,selection){var rng=SelectionDirection.asLtrRange(win,selection);return NativeRange.getFirstRect(rng)};var getBounds=function(win,selection){var rng=SelectionDirection.asLtrRange(win,selection);return NativeRange.getBounds(rng)};var getAtPoint=function(win,x,y){return CaretRange.fromPoint(win,x,y)};var getAsString=function(win,selection){var rng=SelectionDirection.asLtrRange(win,selection);return NativeRange.toString(rng)};var clear=function(win){var selection=win.getSelection();selection.removeAllRanges()};var clone=function(win,selection){var rng=SelectionDirection.asLtrRange(win,selection);return NativeRange.cloneFragment(rng)};var replace=function(win,selection,elements){var rng=SelectionDirection.asLtrRange(win,selection);var fragment=Fragment.fromElements(elements,win.document);NativeRange.replaceWith(rng,fragment)};var deleteAt=function(win,selection){var rng=SelectionDirection.asLtrRange(win,selection);NativeRange.deleteContents(rng)};return{setExact:setExact,getExact:getExact,get:get,setRelative:setRelative,toNative:toNative,setToElement:setToElement,clear:clear,clone:clone,replace:replace,deleteAt:deleteAt,forElement:forElement,getFirstRect:getFirstRect,getBounds:getBounds,getAtPoint:getAtPoint,findWithin:findWithin,getAsString:getAsString}});define("tinymce.core.util.VK",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.VK")});define("tinymce.plugins.table.queries.TabContext",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.CellNavigation","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.selection.CursorPosition","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.WindowSelection","tinymce.core.util.VK","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.TableTargets"],function(Arr,Option,CellNavigation,TableLookup,Compare,Element,Node,SelectorFilter,SelectorFind,CursorPosition,Selection,WindowSelection,VK,Util,TableTargets){var forward=function(editor,isRoot,cell,lazyWire){return go(editor,isRoot,CellNavigation.next(cell),lazyWire)};var backward=function(editor,isRoot,cell,lazyWire){return go(editor,isRoot,CellNavigation.prev(cell),lazyWire)};var getCellFirstCursorPosition=function(editor,cell){var selection=Selection.exact(cell,0,cell,0);return WindowSelection.toNative(selection)};var getNewRowCursorPosition=function(editor,table){var rows=SelectorFilter.descendants(table,"tr");return Arr.last(rows).bind(function(last){return SelectorFind.descendant(last,"td,th").map(function(first){return getCellFirstCursorPosition(editor,first)})})};var go=function(editor,isRoot,cell,actions,lazyWire){return cell.fold(Option.none,Option.none,function(current,next){return CursorPosition.first(next).map(function(cell){return getCellFirstCursorPosition(editor,cell)})},function(current){return TableLookup.table(current,isRoot).bind(function(table){var targets=TableTargets.noMenu(current);editor.undoManager.transact(function(){actions.insertRowsAfter(table,targets)});return getNewRowCursorPosition(editor,table)})})};var rootElements=["table","li","dl"];var handle=function(event,editor,actions,lazyWire){if(event.keyCode===VK.TAB){var body=Util.getBody(editor);var isRoot=function(element){var name=Node.name(element);return Compare.eq(element,body)||Arr.contains(rootElements,name)};var rng=editor.selection.getRng();if(rng.collapsed){var start=Element.fromDom(rng.startContainer);TableLookup.cell(start,isRoot).each(function(cell){event.preventDefault();var navigation=event.shiftKey?backward:forward;var rng=navigation(editor,isRoot,cell,actions,lazyWire);rng.each(function(range){editor.selection.setRng(range)})})}}};return{handle:handle}});define("ephox.darwin.api.Responses",["ephox.katamari.api.Struct"],function(Struct){var response=Struct.immutable("selection","kill");return{response:response}});define("ephox.darwin.api.SelectionKeys",[],function(){var isKey=function(key){return function(keycode){return keycode===key}};var isUp=isKey(38);var isDown=isKey(40);var isNavigation=function(keycode){return keycode>=37&&keycode<=40};return{ltr:{isBackward:isKey(37),isForward:isKey(39)},rtl:{isBackward:isKey(39),isForward:isKey(37)},isUp:isUp,isDown:isDown,isNavigation:isNavigation}});define("ephox.darwin.selection.Util",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.selection.Situ","ephox.sugar.selection.core.SelectionDirection"],function(Fun,Element,Situ,SelectionDirection){var convertToRange=function(win,selection){var rng=SelectionDirection.asLtrRange(win,selection);return{start:Fun.constant(Element.fromDom(rng.startContainer)),soffset:Fun.constant(rng.startOffset),finish:Fun.constant(Element.fromDom(rng.endContainer)),foffset:Fun.constant(rng.endOffset)}};var makeSitus=function(start,soffset,finish,foffset){return{start:Fun.constant(Situ.on(start,soffset)),finish:Fun.constant(Situ.on(finish,foffset))}};return{convertToRange:convertToRange,makeSitus:makeSitus}});define("ephox.darwin.api.WindowBridge",["ephox.darwin.selection.Util","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.Situ","ephox.sugar.api.selection.WindowSelection"],function(Util,Fun,Obj,Option,Element,Selection,Situ,WindowSelection){return function(win){var elementFromPoint=function(x,y){return Option.from(win.document.elementFromPoint(x,y)).map(Element.fromDom)};var getRect=function(element){return element.dom().getBoundingClientRect()};var getRangedRect=function(start,soffset,finish,foffset){var sel=Selection.exact(start,soffset,finish,foffset);return WindowSelection.getFirstRect(win,sel).map(function(structRect){return Obj.map(structRect,Fun.apply)})};var getSelection=function(){return WindowSelection.get(win).map(function(exactAdt){return Util.convertToRange(win,exactAdt)})};var fromSitus=function(situs){var relative=Selection.relative(situs.start(),situs.finish());return Util.convertToRange(win,relative)};var situsFromPoint=function(x,y){return WindowSelection.getAtPoint(win,x,y).map(function(exact){return{start:Fun.constant(Situ.on(exact.start(),exact.soffset())),finish:Fun.constant(Situ.on(exact.finish(),exact.foffset()))}})};var clearSelection=function(){WindowSelection.clear(win)};var selectContents=function(element){WindowSelection.setToElement(win,element)};var setSelection=function(sel){WindowSelection.setExact(win,sel.start(),sel.soffset(),sel.finish(),sel.foffset())};var setRelativeSelection=function(start,finish){WindowSelection.setRelative(win,start,finish)};var getInnerHeight=function(){return win.innerHeight};var getScrollY=function(){return win.scrollY};var scrollBy=function(x,y){win.scrollBy(x,y)};return{elementFromPoint:elementFromPoint,getRect:getRect,getRangedRect:getRangedRect,getSelection:getSelection,fromSitus:fromSitus,situsFromPoint:situsFromPoint,clearSelection:clearSelection,setSelection:setSelection,setRelativeSelection:setRelativeSelection,selectContents:selectContents,getInnerHeight:getInnerHeight,getScrollY:getScrollY,scrollBy:scrollBy}}});define("ephox.darwin.keyboard.KeySelection",["ephox.darwin.api.Responses","ephox.darwin.selection.CellSelection","ephox.darwin.selection.Util","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.selection.Awareness","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.Situ"],function(Responses,CellSelection,Util,Fun,Option,Compare,SelectorFind,Awareness,Selection,Situ){var sync=function(container,isRoot,start,soffset,finish,foffset,selectRange){if(!(Compare.eq(start,finish)&&soffset===foffset)){return SelectorFind.closest(start,"td,th",isRoot).bind(function(s){return SelectorFind.closest(finish,"td,th",isRoot).bind(function(f){return detect(container,isRoot,s,f,selectRange)})})}else{return Option.none()}};var detect=function(container,isRoot,start,finish,selectRange){if(!Compare.eq(start,finish)){var boxes=CellSelection.identify(start,finish,isRoot).getOr([]);if(boxes.length>0){selectRange(container,boxes,start,finish);return Option.some(Responses.response(Option.some(Util.makeSitus(start,0,start,Awareness.getEnd(start))),true))}}return Option.none()};var update=function(rows,columns,container,selected,annotations){var updateSelection=function(newSels){annotations.clear(container);annotations.selectRange(container,newSels.boxes(),newSels.start(),newSels.finish());return newSels.boxes()};return CellSelection.shiftSelection(selected,rows,columns,annotations.firstSelectedSelector(),annotations.lastSelectedSelector()).map(updateSelection)};return{sync:sync,detect:detect,update:update}});define("ephox.darwin.keyboard.Carets",["ephox.katamari.api.Struct"],function(Struct){var nu=Struct.immutableBag(["left","top","right","bottom"],[]);var moveDown=function(caret,amount){return nu({left:caret.left(),top:caret.top()+amount,right:caret.right(),bottom:caret.bottom()+amount})};var moveUp=function(caret,amount){return nu({left:caret.left(),top:caret.top()-amount,right:caret.right(),bottom:caret.bottom()-amount})};var moveBottomTo=function(caret,bottom){var height=caret.bottom()-caret.top();return nu({left:caret.left(),top:bottom-height,right:caret.right(),bottom:bottom})};var moveTopTo=function(caret,top){var height=caret.bottom()-caret.top();return nu({left:caret.left(),top:top,right:caret.right(),bottom:top+height})};var translate=function(caret,xDelta,yDelta){return nu({left:caret.left()+xDelta,top:caret.top()+yDelta,right:caret.right()+xDelta,bottom:caret.bottom()+yDelta})};var getTop=function(caret){return caret.top()};var getBottom=function(caret){return caret.bottom()};var toString=function(caret){return"("+caret.left()+", "+caret.top()+") -> ("+caret.right()+", "+caret.bottom()+")"};return{nu:nu,moveUp:moveUp,moveDown:moveDown,moveBottomTo:moveBottomTo,moveTopTo:moveTopTo,getTop:getTop,getBottom:getBottom,translate:translate,toString:toString}});define("ephox.darwin.keyboard.Rectangles",["ephox.darwin.keyboard.Carets","ephox.katamari.api.Option","ephox.sugar.api.node.Node","ephox.sugar.api.selection.Awareness"],function(Carets,Option,Node,Awareness){var getPartialBox=function(bridge,element,offset){if(offset>=0&&offset<Awareness.getEnd(element)){return bridge.getRangedRect(element,offset,element,offset+1)}else if(offset>0){return bridge.getRangedRect(element,offset-1,element,offset)}return Option.none()};var toCaret=function(rect){return Carets.nu({left:rect.left,top:rect.top,right:rect.right,bottom:rect.bottom})};var getElemBox=function(bridge,element){return Option.some(bridge.getRect(element))};var getBoxAt=function(bridge,element,offset){if(Node.isElement(element)){return getElemBox(bridge,element,offset).map(toCaret)}else if(Node.isText(element)){return getPartialBox(bridge,element,offset).map(toCaret)}else{return Option.none()}};var getEntireBox=function(bridge,element){if(Node.isElement(element)){return getElemBox(bridge,element).map(toCaret)}else if(Node.isText(element)){return bridge.getRangedRect(element,0,element,Awareness.getEnd(element)).map(toCaret)}else{return Option.none()}};return{getBoxAt:getBoxAt,getEntireBox:getEntireBox}});define("ephox.phoenix.gather.Walker",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.katamari.api.Struct"],function(Arr,Option,Struct){var traverse=Struct.immutable("item","mode");var backtrack=function(universe,item,direction,_transition){var transition=_transition!==undefined?_transition:sidestep;return universe.property().parent(item).map(function(p){return traverse(p,transition)})};var sidestep=function(universe,item,direction,_transition){var transition=_transition!==undefined?_transition:advance;return direction.sibling(universe,item).map(function(p){return traverse(p,transition)})};var advance=function(universe,item,direction,_transition){var transition=_transition!==undefined?_transition:advance;var children=universe.property().children(item);var result=direction.first(children);return result.map(function(r){return traverse(r,transition)})};var successors=[{current:backtrack,next:sidestep,fallback:Option.none()},{current:sidestep,next:advance,fallback:Option.some(backtrack)},{current:advance,next:advance,fallback:Option.some(sidestep)}];var go=function(universe,item,mode,direction,_rules){var rules=_rules!==undefined?_rules:successors;var ruleOpt=Arr.find(rules,function(succ){return succ.current===mode});return ruleOpt.bind(function(rule){return rule.current(universe,item,direction,rule.next).orThunk(function(){return rule.fallback.bind(function(fb){return go(universe,item,fb,direction)})})})};return{backtrack:backtrack,sidestep:sidestep,advance:advance,go:go}});define("ephox.phoenix.gather.Walkers",["ephox.katamari.api.Option"],function(Option){var left=function(){var sibling=function(universe,item){return universe.query().prevSibling(item)};var first=function(children){return children.length>0?Option.some(children[children.length-1]):Option.none()};return{sibling:sibling,first:first}};var right=function(){var sibling=function(universe,item){return universe.query().nextSibling(item)};var first=function(children){return children.length>0?Option.some(children[0]):Option.none()};return{sibling:sibling,first:first}};return{left:left,right:right}});define("ephox.phoenix.gather.Seeker",["ephox.katamari.api.Option","ephox.phoenix.gather.Walker","ephox.phoenix.gather.Walkers"],function(Option,Walker,Walkers){var hone=function(universe,item,predicate,mode,direction,isRoot){var next=Walker.go(universe,item,mode,direction);return next.bind(function(n){if(isRoot(n.item())){return Option.none()}else{return predicate(n.item())?Option.some(n.item()):hone(universe,n.item(),predicate,n.mode(),direction,isRoot)}})};var left=function(universe,item,predicate,isRoot){return hone(universe,item,predicate,Walker.sidestep,Walkers.left(),isRoot)};var right=function(universe,item,predicate,isRoot){return hone(universe,item,predicate,Walker.sidestep,Walkers.right(),isRoot)};return{left:left,right:right}});define("ephox.phoenix.api.general.Gather",["ephox.katamari.api.Fun","ephox.phoenix.gather.Seeker","ephox.phoenix.gather.Walker","ephox.phoenix.gather.Walkers"],function(Fun,Seeker,Walker,Walkers){var isLeaf=function(universe,element){return universe.property().children(element).length===0};var before=function(universe,item,isRoot){return seekLeft(universe,item,Fun.curry(isLeaf,universe),isRoot)};var after=function(universe,item,isRoot){return seekRight(universe,item,Fun.curry(isLeaf,universe),isRoot)};var seekLeft=function(universe,item,predicate,isRoot){return Seeker.left(universe,item,predicate,isRoot)};var seekRight=function(universe,item,predicate,isRoot){return Seeker.right(universe,item,predicate,isRoot)};var walkers=function(){return{left:Walkers.left,right:Walkers.right}};var walk=function(universe,item,mode,direction,_rules){return Walker.go(universe,item,mode,direction,_rules)};return{before:before,after:after,seekLeft:seekLeft,seekRight:seekRight,walkers:walkers,walk:walk,backtrack:Walker.backtrack,sidestep:Walker.sidestep,advance:Walker.advance}});define("ephox.phoenix.api.dom.DomGather",["ephox.boss.api.DomUniverse","ephox.phoenix.api.general.Gather"],function(DomUniverse,Gather){var universe=DomUniverse();var gather=function(element,prune,transform){return Gather.gather(universe,element,prune,transform)};var before=function(element,isRoot){return Gather.before(universe,element,isRoot)};var after=function(element,isRoot){return Gather.after(universe,element,isRoot)};var seekLeft=function(element,predicate,isRoot){return Gather.seekLeft(universe,element,predicate,isRoot)};var seekRight=function(element,predicate,isRoot){return Gather.seekRight(universe,element,predicate,isRoot)};var walkers=function(){return Gather.walkers()};var walk=function(item,mode,direction,_rules){return Gather.walk(universe,item,mode,direction,_rules)};return{gather:gather,before:before,after:after,seekLeft:seekLeft,seekRight:seekRight,walkers:walkers,walk:walk}});define("ephox.darwin.keyboard.Retries",["ephox.darwin.keyboard.Carets","ephox.darwin.keyboard.Rectangles","ephox.katamari.api.Adt","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.phoenix.api.dom.DomGather","ephox.robin.api.dom.DomStructure","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","global!Math"],function(Carets,Rectangles,Adt,Fun,Option,DomGather,DomStructure,Node,PredicateFind,Math){var JUMP_SIZE=5;var NUM_RETRIES=100;var adt=Adt.generate([{none:[]},{retry:["caret"]}]);var isOutside=function(caret,box){return caret.left()<box.left()||Math.abs(box.right()-caret.left())<1||caret.left()>box.right()};var inOutsideBlock=function(bridge,element,caret){return PredicateFind.closest(element,DomStructure.isBlock).fold(Fun.constant(false),function(cell){return Rectangles.getEntireBox(bridge,cell).exists(function(box){return isOutside(caret,box)})})};var adjustDown=function(bridge,element,guessBox,original,caret){var lowerCaret=Carets.moveDown(caret,JUMP_SIZE);if(Math.abs(guessBox.bottom()-original.bottom())<1){return adt.retry(lowerCaret)}else if(guessBox.top()>caret.bottom()){return adt.retry(lowerCaret)}else if(guessBox.top()===caret.bottom()){return adt.retry(Carets.moveDown(caret,1))}else{return inOutsideBlock(bridge,element,caret)?adt.retry(Carets.translate(lowerCaret,JUMP_SIZE,0)):adt.none()}};var adjustUp=function(bridge,element,guessBox,original,caret){var higherCaret=Carets.moveUp(caret,JUMP_SIZE);if(Math.abs(guessBox.top()-original.top())<1){return adt.retry(higherCaret)}else if(guessBox.bottom()<caret.top()){return adt.retry(higherCaret)}else if(guessBox.bottom()===caret.top()){return adt.retry(Carets.moveUp(caret,1))}else{return inOutsideBlock(bridge,element,caret)?adt.retry(Carets.translate(higherCaret,JUMP_SIZE,0)):adt.none()}};var upMovement={point:Carets.getTop,adjuster:adjustUp,move:Carets.moveUp,gather:DomGather.before};var downMovement={point:Carets.getBottom,adjuster:adjustDown,move:Carets.moveDown,gather:DomGather.after};var isAtTable=function(bridge,x,y){return bridge.elementFromPoint(x,y).filter(function(elm){return Node.name(elm)==="table"}).isSome()};var adjustForTable=function(bridge,movement,original,caret,numRetries){return adjustTil(bridge,movement,original,movement.move(caret,JUMP_SIZE),numRetries)};var adjustTil=function(bridge,movement,original,caret,numRetries){if(numRetries===0){return Option.some(caret)}if(isAtTable(bridge,caret.left(),movement.point(caret))){return adjustForTable(bridge,movement,original,caret,numRetries-1)}return bridge.situsFromPoint(caret.left(),movement.point(caret)).bind(function(guess){return guess.start().fold(Option.none,function(element,offset){return Rectangles.getEntireBox(bridge,element,offset).bind(function(guessBox){return movement.adjuster(bridge,element,guessBox,original,caret).fold(Option.none,function(newCaret){return adjustTil(bridge,movement,original,newCaret,numRetries-1)})}).orThunk(function(){return Option.some(caret)})},Option.none)})};var ieTryDown=function(bridge,caret){return bridge.situsFromPoint(caret.left(),caret.bottom()+JUMP_SIZE)};var ieTryUp=function(bridge,caret){return bridge.situsFromPoint(caret.left(),caret.top()-JUMP_SIZE)};var checkScroll=function(movement,adjusted,bridge){if(movement.point(adjusted)>bridge.getInnerHeight()){return Option.some(movement.point(adjusted)-bridge.getInnerHeight())}else if(movement.point(adjusted)<0){return Option.some(-movement.point(adjusted))}else{return Option.none()}};var retry=function(movement,bridge,caret){var moved=movement.move(caret,JUMP_SIZE);var adjusted=adjustTil(bridge,movement,caret,moved,NUM_RETRIES).getOr(moved);return checkScroll(movement,adjusted,bridge).fold(function(){return bridge.situsFromPoint(adjusted.left(),movement.point(adjusted))},function(delta){bridge.scrollBy(0,delta);return bridge.situsFromPoint(adjusted.left(),movement.point(adjusted)-delta)})};return{tryUp:Fun.curry(retry,upMovement),tryDown:Fun.curry(retry,downMovement),ieTryUp:ieTryUp,ieTryDown:ieTryDown,getJumpSize:Fun.constant(JUMP_SIZE)}});define("ephox.darwin.navigation.BeforeAfter",["ephox.katamari.api.Adt","ephox.robin.api.dom.DomParent","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.selection.Awareness"],function(Adt,DomParent,Compare,SelectorFind,Awareness){var adt=Adt.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]);var isOverlapping=function(bridge,before,after){var beforeBounds=bridge.getRect(before);var afterBounds=bridge.getRect(after);return afterBounds.right>beforeBounds.left&&afterBounds.left<beforeBounds.right};var verify=function(bridge,before,beforeOffset,after,afterOffset,failure,isRoot){return SelectorFind.closest(after,"td,th",isRoot).bind(function(afterCell){return SelectorFind.closest(before,"td,th",isRoot).map(function(beforeCell){if(!Compare.eq(afterCell,beforeCell)){return DomParent.sharedOne(isRow,[afterCell,beforeCell]).fold(function(){return isOverlapping(bridge,beforeCell,afterCell)?adt.success():failure(beforeCell)},function(sharedRow){return failure(beforeCell)})}else{return Compare.eq(after,afterCell)&&Awareness.getEnd(afterCell)===afterOffset?failure(beforeCell):adt.none("in same cell")}})}).getOr(adt.none("default"))};var isRow=function(elem){return SelectorFind.closest(elem,"tr")};var cata=function(subject,onNone,onSuccess,onFailedUp,onFailedDown){return subject.fold(onNone,onSuccess,onFailedUp,onFailedDown)};return{verify:verify,cata:cata,adt:adt}});define("ephox.phoenix.api.data.Spot",["ephox.katamari.api.Struct"],function(Struct){var point=Struct.immutable("element","offset");var delta=Struct.immutable("element","deltaOffset");var range=Struct.immutable("element","start","finish");var points=Struct.immutable("begin","end");var text=Struct.immutable("element","text");return{point:point,delta:delta,range:range,points:points,text:text}});define("ephox.sugar.api.search.ElementAddress",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse"],function(Arr,Fun,Option,Struct,Compare,PredicateFind,SelectorFilter,SelectorFind,Traverse){var inAncestor=Struct.immutable("ancestor","descendants","element","index");var inParent=Struct.immutable("parent","children","element","index");var childOf=function(element,ancestor){return PredicateFind.closest(element,function(elem){return Traverse.parent(elem).exists(function(parent){return Compare.eq(parent,ancestor)})})};var indexInParent=function(element){return Traverse.parent(element).bind(function(parent){var children=Traverse.children(parent);return indexOf(children,element).map(function(index){return inParent(parent,children,element,index)})})};var indexOf=function(elements,element){return Arr.findIndex(elements,Fun.curry(Compare.eq,element))};var selectorsInParent=function(element,selector){return Traverse.parent(element).bind(function(parent){var children=SelectorFilter.children(parent,selector);return indexOf(children,element).map(function(index){return inParent(parent,children,element,index)})})};var descendantsInAncestor=function(element,ancestorSelector,descendantSelector){return SelectorFind.closest(element,ancestorSelector).bind(function(ancestor){var descendants=SelectorFilter.descendants(ancestor,descendantSelector);return indexOf(descendants,element).map(function(index){return inAncestor(ancestor,descendants,element,index)})})};return{childOf:childOf,indexOf:indexOf,indexInParent:indexInParent,selectorsInParent:selectorsInParent,descendantsInAncestor:descendantsInAncestor}});define("ephox.darwin.navigation.BrTags",["ephox.darwin.navigation.BeforeAfter","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.phoenix.api.data.Spot","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.ElementAddress","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Awareness","ephox.sugar.api.selection.Situ"],function(BeforeAfter,Fun,Option,Spot,Node,Text,ElementAddress,Traverse,Awareness,Situ){var isBr=function(elem){return Node.name(elem)==="br"};var gatherer=function(cand,gather,isRoot){return gather(cand,isRoot).bind(function(target){return Node.isText(target)&&Text.get(target).trim().length===0?gatherer(target,gather,isRoot):Option.some(target)})};var handleBr=function(isRoot,element,direction){return direction.traverse(element).orThunk(function(){return gatherer(element,direction.gather,isRoot)}).map(direction.relative)};var findBr=function(element,offset){return Traverse.child(element,offset).filter(isBr).orThunk(function(){return Traverse.child(element,offset-1).filter(isBr)})};var handleParent=function(isRoot,element,offset,direction){return findBr(element,offset).bind(function(br){return direction.traverse(br).fold(function(){return gatherer(br,direction.gather,isRoot).map(direction.relative)},function(adjacent){return ElementAddress.indexInParent(adjacent).map(function(info){return Situ.on(info.parent(),info.index())})})})};var tryBr=function(isRoot,element,offset,direction){var target=isBr(element)?handleBr(isRoot,element,direction):handleParent(isRoot,element,offset,direction);return target.map(function(tgt){return{start:Fun.constant(tgt),finish:Fun.constant(tgt)}})};var process=function(analysis){return BeforeAfter.cata(analysis,function(message){return Option.none("BR ADT: none")},function(){return Option.none()},function(cell){return Option.some(Spot.point(cell,0))},function(cell){return Option.some(Spot.point(cell,Awareness.getEnd(cell)))})};return{tryBr:tryBr,process:process}});define("ephox.darwin.keyboard.TableKeys",["ephox.darwin.keyboard.Carets","ephox.darwin.keyboard.Rectangles","ephox.darwin.keyboard.Retries","ephox.darwin.navigation.BeforeAfter","ephox.darwin.navigation.BrTags","ephox.katamari.api.Option","ephox.phoenix.api.data.Spot","ephox.sand.api.PlatformDetection","ephox.sugar.api.dom.Compare","ephox.sugar.api.selection.Awareness"],function(Carets,Rectangles,Retries,BeforeAfter,BrTags,Option,Spot,PlatformDetection,Compare,Awareness){var MAX_RETRIES=20;var platform=PlatformDetection.detect();var findSpot=function(bridge,isRoot,direction){return bridge.getSelection().bind(function(sel){return BrTags.tryBr(isRoot,sel.finish(),sel.foffset(),direction).fold(function(){return Option.some(Spot.point(sel.finish(),sel.foffset()))},function(brNeighbour){var range=bridge.fromSitus(brNeighbour);var analysis=BeforeAfter.verify(bridge,sel.finish(),sel.foffset(),range.finish(),range.foffset(),direction.failure,isRoot);return BrTags.process(analysis)})})};var scan=function(bridge,isRoot,element,offset,direction,numRetries){if(numRetries===0){return Option.none()}return tryCursor(bridge,isRoot,element,offset,direction).bind(function(situs){var range=bridge.fromSitus(situs);var analysis=BeforeAfter.verify(bridge,element,offset,range.finish(),range.foffset(),direction.failure,isRoot);return BeforeAfter.cata(analysis,function(){return Option.none()},function(){return Option.some(situs)},function(cell){if(Compare.eq(element,cell)&&offset===0){return tryAgain(bridge,element,offset,Carets.moveUp,direction)}else{return scan(bridge,isRoot,cell,0,direction,numRetries-1)}},function(cell){if(Compare.eq(element,cell)&&offset===Awareness.getEnd(cell)){return tryAgain(bridge,element,offset,Carets.moveDown,direction)}else{return scan(bridge,isRoot,cell,Awareness.getEnd(cell),direction,numRetries-1)}})})};var tryAgain=function(bridge,element,offset,move,direction){return Rectangles.getBoxAt(bridge,element,offset).bind(function(box){return tryAt(bridge,direction,move(box,Retries.getJumpSize()))})};var tryAt=function(bridge,direction,box){if(platform.browser.isChrome()||platform.browser.isSafari()||platform.browser.isFirefox()||platform.browser.isEdge()){return direction.otherRetry(bridge,box)}else if(platform.browser.isIE()){return direction.ieRetry(bridge,box)}else{return Option.none()}};var tryCursor=function(bridge,isRoot,element,offset,direction){return Rectangles.getBoxAt(bridge,element,offset).bind(function(box){return tryAt(bridge,direction,box)})};var handle=function(bridge,isRoot,direction){return findSpot(bridge,isRoot,direction).bind(function(spot){return scan(bridge,isRoot,spot.element(),spot.offset(),direction,MAX_RETRIES).map(bridge.fromSitus)})};return{handle:handle}});define("ephox.sugar.api.search.PredicateExists",["ephox.sugar.api.search.PredicateFind"],function(PredicateFind){var any=function(predicate){return PredicateFind.first(predicate).isSome()};var ancestor=function(scope,predicate,isRoot){return PredicateFind.ancestor(scope,predicate,isRoot).isSome()};var closest=function(scope,predicate,isRoot){return PredicateFind.closest(scope,predicate,isRoot).isSome()};var sibling=function(scope,predicate){return PredicateFind.sibling(scope,predicate).isSome()};var child=function(scope,predicate){return PredicateFind.child(scope,predicate).isSome()};var descendant=function(scope,predicate){return PredicateFind.descendant(scope,predicate).isSome()};return{any:any,ancestor:ancestor,closest:closest,sibling:sibling,child:child,descendant:descendant}});define("ephox.darwin.keyboard.VerticalMovement",["ephox.darwin.api.Responses","ephox.darwin.keyboard.KeySelection","ephox.darwin.keyboard.TableKeys","ephox.darwin.selection.Util","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sand.api.PlatformDetection","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.PredicateExists","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Awareness","ephox.sugar.api.selection.CursorPosition"],function(Responses,KeySelection,TableKeys,Util,Arr,Fun,Option,PlatformDetection,Compare,PredicateExists,SelectorFilter,SelectorFind,Traverse,Awareness,CursorPosition){var detection=PlatformDetection.detect();var inSameTable=function(elem,table){return PredicateExists.ancestor(elem,function(e){return Traverse.parent(e).exists(function(p){return Compare.eq(p,table)})})};var simulate=function(bridge,isRoot,direction,initial,anchor){return SelectorFind.closest(initial,"td,th",isRoot).bind(function(start){return SelectorFind.closest(start,"table",isRoot).bind(function(table){if(!inSameTable(anchor,table)){return Option.none()}return TableKeys.handle(bridge,isRoot,direction).bind(function(range){return SelectorFind.closest(range.finish(),"td,th",isRoot).map(function(finish){return{start:Fun.constant(start),finish:Fun.constant(finish),range:Fun.constant(range)}})})})})};var navigate=function(bridge,isRoot,direction,initial,anchor,precheck){if(detection.browser.isIE()){return Option.none()}else{return precheck(initial,isRoot).orThunk(function(){return simulate(bridge,isRoot,direction,initial,anchor).map(function(info){var range=info.range();return Responses.response(Option.some(Util.makeSitus(range.start(),range.soffset(),range.finish(),range.foffset())),true)})})}};var firstUpCheck=function(initial,isRoot){return SelectorFind.closest(initial,"tr",isRoot).bind(function(startRow){return SelectorFind.closest(startRow,"table",isRoot).bind(function(table){var rows=SelectorFilter.descendants(table,"tr");if(Compare.eq(startRow,rows[0])){return Traverse.prevSibling(table).bind(CursorPosition.last).map(function(last){var lastOffset=Awareness.getEnd(last);return Responses.response(Option.some(Util.makeSitus(last,lastOffset,last,lastOffset)),true)})}else{return Option.none()}})})};var lastDownCheck=function(initial,isRoot){return SelectorFind.closest(initial,"tr",isRoot).bind(function(startRow){return SelectorFind.closest(startRow,"table",isRoot).bind(function(table){var rows=SelectorFilter.descendants(table,"tr");if(Compare.eq(startRow,rows[rows.length-1])){return Traverse.nextSibling(table).bind(CursorPosition.first).map(function(first){return Responses.response(Option.some(Util.makeSitus(first,0,first,0)),true)})}else{return Option.none()}})})};var select=function(bridge,container,isRoot,direction,initial,anchor,selectRange){return simulate(bridge,isRoot,direction,initial,anchor).bind(function(info){return KeySelection.detect(container,isRoot,info.start(),info.finish(),selectRange)})};return{navigate:navigate,select:select,firstUpCheck:firstUpCheck,lastDownCheck:lastDownCheck}});define("ephox.darwin.mouse.MouseSelection",["ephox.darwin.selection.CellSelection","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind"],function(CellSelection,Option,Compare,SelectorFind){var findCell=function(target,isRoot){return SelectorFind.closest(target,"td,th",isRoot)};return function(bridge,container,isRoot,annotations){var cursor=Option.none();var clearState=function(){cursor=Option.none()};var mousedown=function(event){annotations.clear(container);cursor=findCell(event.target(),isRoot)};var mouseover=function(event){cursor.each(function(start){annotations.clear(container);findCell(event.target(),isRoot).each(function(finish){var boxes=CellSelection.identify(start,finish,isRoot).getOr([]);if(boxes.length>1||boxes.length===1&&!Compare.eq(start,finish)){annotations.selectRange(container,boxes,start,finish);bridge.selectContents(finish)}})})};var mouseup=function(){cursor.each(clearState)};return{mousedown:mousedown,mouseover:mouseover,mouseup:mouseup}}});define("ephox.darwin.navigation.KeyDirection",["ephox.darwin.keyboard.Retries","ephox.darwin.navigation.BeforeAfter","ephox.phoenix.api.dom.DomGather","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Situ"],function(Retries,BeforeAfter,DomGather,Traverse,Situ){return{down:{traverse:Traverse.nextSibling,gather:DomGather.after,relative:Situ.before,otherRetry:Retries.tryDown,ieRetry:Retries.ieTryDown,failure:BeforeAfter.adt.failedDown},up:{traverse:Traverse.prevSibling,gather:DomGather.before,relative:Situ.before,otherRetry:Retries.tryUp,ieRetry:Retries.ieTryUp,failure:BeforeAfter.adt.failedUp}}});define("ephox.darwin.api.InputHandlers",["ephox.darwin.api.Responses","ephox.darwin.api.SelectionKeys","ephox.darwin.api.WindowBridge","ephox.darwin.keyboard.KeySelection","ephox.darwin.keyboard.VerticalMovement","ephox.darwin.mouse.MouseSelection","ephox.darwin.navigation.KeyDirection","ephox.darwin.selection.CellSelection","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.katamari.api.Struct","ephox.sugar.api.selection.Situ"],function(Responses,SelectionKeys,WindowBridge,KeySelection,VerticalMovement,MouseSelection,KeyDirection,CellSelection,Fun,Option,Options,Struct,Situ){var rc=Struct.immutable("rows","cols");var mouse=function(win,container,isRoot,annotations){var bridge=WindowBridge(win);var handlers=MouseSelection(bridge,container,isRoot,annotations);return{mousedown:handlers.mousedown,mouseover:handlers.mouseover,mouseup:handlers.mouseup}};var keyboard=function(win,container,isRoot,annotations){var bridge=WindowBridge(win);var clearToNavigate=function(){annotations.clear(container);return Option.none()};var keydown=function(event,start,soffset,finish,foffset,direction){var keycode=event.raw().which;var shiftKey=event.raw().shiftKey===true;var handler=CellSelection.retrieve(container,annotations.selectedSelector()).fold(function(){if(SelectionKeys.isDown(keycode)&&shiftKey){return Fun.curry(VerticalMovement.select,bridge,container,isRoot,KeyDirection.down,finish,start,annotations.selectRange)}else if(SelectionKeys.isUp(keycode)&&shiftKey){return Fun.curry(VerticalMovement.select,bridge,container,isRoot,KeyDirection.up,finish,start,annotations.selectRange)}else if(SelectionKeys.isDown(keycode)){return Fun.curry(VerticalMovement.navigate,bridge,isRoot,KeyDirection.down,finish,start,VerticalMovement.lastDownCheck)}else if(SelectionKeys.isUp(keycode)){return Fun.curry(VerticalMovement.navigate,bridge,isRoot,KeyDirection.up,finish,start,VerticalMovement.firstUpCheck)}else{return Option.none}},function(selected){var update=function(attempts){return function(){var navigation=Options.findMap(attempts,function(delta){return KeySelection.update(delta.rows(),delta.cols(),container,selected,annotations)});return navigation.fold(function(){return CellSelection.getEdges(container,annotations.firstSelectedSelector(),annotations.lastSelectedSelector()).map(function(edges){var relative=SelectionKeys.isDown(keycode)||direction.isForward(keycode)?Situ.after:Situ.before;bridge.setRelativeSelection(Situ.on(edges.first(),0),relative(edges.table()));annotations.clear(container);return Responses.response(Option.none(),true)})},function(_){return Option.some(Responses.response(Option.none(),true))})}};if(SelectionKeys.isDown(keycode)&&shiftKey){return update([rc(+1,0)])}else if(SelectionKeys.isUp(keycode)&&shiftKey){return update([rc(-1,0)])}else if(direction.isBackward(keycode)&&shiftKey){return update([rc(0,-1),rc(-1,0)])}else if(direction.isForward(keycode)&&shiftKey){return update([rc(0,+1),rc(+1,0)])}else if(SelectionKeys.isNavigation(keycode)&&shiftKey===false){return clearToNavigate}else{return Option.none}});return handler()};var keyup=function(event,start,soffset,finish,foffset){return CellSelection.retrieve(container,annotations.selectedSelector()).fold(function(){var keycode=event.raw().which;var shiftKey=event.raw().shiftKey===true;if(shiftKey===false){return Option.none()}if(SelectionKeys.isNavigation(keycode)){return KeySelection.sync(container,isRoot,start,soffset,finish,foffset,annotations.selectRange)}else{return Option.none()}},Option.none)};return{keydown:keydown,keyup:keyup}};return{mouse:mouse,keyboard:keyboard}});define("ephox.sugar.api.properties.Classes",["ephox.katamari.api.Arr","ephox.sugar.api.properties.Class","ephox.sugar.impl.ClassList","global!Array"],function(Arr,Class,ClassList,Array){var add=function(element,classes){Arr.each(classes,function(x){Class.add(element,x)})};var remove=function(element,classes){Arr.each(classes,function(x){Class.remove(element,x)})};var toggle=function(element,classes){Arr.each(classes,function(x){Class.toggle(element,x)})};var hasAll=function(element,classes){return Arr.forall(classes,function(clazz){return Class.has(element,clazz)})};var hasAny=function(element,classes){return Arr.exists(classes,function(clazz){return Class.has(element,clazz)})};var getNative=function(element){var classList=element.dom().classList;var r=new Array(classList.length);for(var i=0;i<classList.length;i++){r[i]=classList.item(i)}return r};var get=function(element){return ClassList.supports(element)?getNative(element):ClassList.get(element)};return{add:add,remove:remove,toggle:toggle,hasAll:hasAll,hasAny:hasAny,get:get}});define("ephox.sugar.api.properties.OnNode",["ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Classes"],function(Class,Classes){var addClass=function(clazz){return function(element){Class.add(element,clazz)}};var removeClass=function(clazz){return function(element){Class.remove(element,clazz)}};var removeClasses=function(classes){return function(element){Classes.remove(element,classes)}};var hasClass=function(clazz){return function(element){return Class.has(element,clazz)}};return{addClass:addClass,removeClass:removeClass,removeClasses:removeClasses,hasClass:hasClass}});define("ephox.darwin.api.SelectionAnnotation",["ephox.katamari.api.Arr","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.OnNode","ephox.sugar.api.search.SelectorFilter"],function(Arr,Attr,Class,OnNode,SelectorFilter){var byClass=function(ephemera){var addSelectionClass=OnNode.addClass(ephemera.selected());var removeSelectionClasses=OnNode.removeClasses([ephemera.selected(),ephemera.lastSelected(),ephemera.firstSelected()]);var clear=function(container){var sels=SelectorFilter.descendants(container,ephemera.selectedSelector());Arr.each(sels,removeSelectionClasses)};var selectRange=function(container,cells,start,finish){clear(container);Arr.each(cells,addSelectionClass);Class.add(start,ephemera.firstSelected());Class.add(finish,ephemera.lastSelected())};return{clear:clear,selectRange:selectRange,selectedSelector:ephemera.selectedSelector,firstSelectedSelector:ephemera.firstSelectedSelector,lastSelectedSelector:ephemera.lastSelectedSelector}};var byAttr=function(ephemera){var removeSelectionAttributes=function(element){Attr.remove(element,ephemera.selected());Attr.remove(element,ephemera.firstSelected());Attr.remove(element,ephemera.lastSelected())};var addSelectionAttribute=function(element){Attr.set(element,ephemera.selected(),"1")};var clear=function(container){var sels=SelectorFilter.descendants(container,ephemera.selectedSelector());Arr.each(sels,removeSelectionAttributes)};var selectRange=function(container,cells,start,finish){clear(container);Arr.each(cells,addSelectionAttribute);Attr.set(start,ephemera.firstSelected(),"1");Attr.set(finish,ephemera.lastSelected(),"1")};return{clear:clear,selectRange:selectRange,selectedSelector:ephemera.selectedSelector,firstSelectedSelector:ephemera.firstSelectedSelector,lastSelectedSelector:ephemera.lastSelectedSelector}};return{byClass:byClass,byAttr:byAttr}});define("tinymce.plugins.table.selection.CellSelection",["ephox.darwin.api.InputHandlers","ephox.darwin.api.SelectionAnnotation","ephox.darwin.api.SelectionKeys","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","ephox.sugar.selection.core.SelectionDirection","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.Direction","tinymce.plugins.table.selection.Ephemera"],function(InputHandlers,SelectionAnnotation,SelectionKeys,Fun,Option,Struct,TableLookup,Compare,Element,Node,Text,Attr,Traverse,Selection,SelectionDirection,Util,Direction,Ephemera){return function(editor,lazyResize){var handlerStruct=Struct.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]);var handlers=Option.none();var annotations=SelectionAnnotation.byAttr(Ephemera);editor.on("init",function(e){var win=editor.getWin();var body=Util.getBody(editor);var isRoot=Util.getIsRoot(editor);var syncSelection=function(){var sel=editor.selection;var start=Element.fromDom(sel.getStart());var end=Element.fromDom(sel.getEnd());var startTable=TableLookup.table(start);var endTable=TableLookup.table(end);var sameTable=startTable.bind(function(tableStart){return endTable.bind(function(tableEnd){return Compare.eq(tableStart,tableEnd)?Option.some(true):Option.none()})});sameTable.fold(function(){annotations.clear(body)},Fun.noop)};var mouseHandlers=InputHandlers.mouse(win,body,isRoot,annotations);var keyHandlers=InputHandlers.keyboard(win,body,isRoot,annotations);var handleResponse=function(event,response){if(response.kill()){event.kill()}response.selection().each(function(ns){var relative=Selection.relative(ns.start(),ns.finish());var rng=SelectionDirection.asLtrRange(win,relative);editor.selection.setRng(rng)})};var keyup=function(event){var wrappedEvent=wrapEvent(event);if(wrappedEvent.raw().shiftKey&&SelectionKeys.isNavigation(wrappedEvent.raw().which)){var rng=editor.selection.getRng();var start=Element.fromDom(rng.startContainer);var end=Element.fromDom(rng.endContainer);keyHandlers.keyup(wrappedEvent,start,rng.startOffset,end,rng.endOffset).each(function(response){handleResponse(wrappedEvent,response)})}};var checkLast=function(last){return!Attr.has(last,"data-mce-bogus")&&Node.name(last)!=="br"&&!(Node.isText(last)&&Text.get(last).length===0)};var getLast=function(){var body=Element.fromDom(editor.getBody());var lastChild=Traverse.lastChild(body);var getPrevLast=function(last){return Traverse.prevSibling(last).bind(function(prevLast){return checkLast(prevLast)?Option.some(prevLast):getPrevLast(prevLast)})};return lastChild.bind(function(last){return checkLast(last)?Option.some(last):getPrevLast(last)})};var keydown=function(event){var wrappedEvent=wrapEvent(event);lazyResize().each(function(resize){resize.hideBars()});if(event.which===40){getLast().each(function(last){if(Node.name(last)==="table"){if(editor.settings.forced_root_block){editor.dom.add(editor.getBody(),editor.settings.forced_root_block,editor.settings.forced_root_block_attrs,"<br/>")}else{editor.dom.add(editor.getBody(),"br")}}})}var rng=editor.selection.getRng();var startContainer=Element.fromDom(editor.selection.getStart());var start=Element.fromDom(rng.startContainer);var end=Element.fromDom(rng.endContainer);var direction=Direction.directionAt(startContainer).isRtl()?SelectionKeys.rtl:SelectionKeys.ltr;keyHandlers.keydown(wrappedEvent,start,rng.startOffset,end,rng.endOffset,direction).each(function(response){handleResponse(wrappedEvent,response)});lazyResize().each(function(resize){resize.showBars()})};var wrapEvent=function(event){var target=Element.fromDom(event.target);var stop=function(){event.stopPropagation()};var prevent=function(){event.preventDefault()};var kill=Fun.compose(prevent,stop);return{target:Fun.constant(target),x:Fun.constant(event.x),y:Fun.constant(event.y),stop:stop,prevent:prevent,kill:kill,raw:Fun.constant(event)}};var isLeftMouse=function(raw){return raw.button===0};var isLeftButtonPressed=function(raw){if(raw.buttons===undefined){return true}return(raw.buttons&1)!==0};var mouseDown=function(e){if(isLeftMouse(e)){mouseHandlers.mousedown(wrapEvent(e))}};var mouseOver=function(e){if(isLeftButtonPressed(e)){mouseHandlers.mouseover(wrapEvent(e))}};var mouseUp=function(e){if(isLeftMouse){mouseHandlers.mouseup(wrapEvent(e))}};editor.on("mousedown",mouseDown);editor.on("mouseover",mouseOver);editor.on("mouseup",mouseUp);editor.on("keyup",keyup);editor.on("keydown",keydown);editor.on("nodechange",syncSelection);handlers=Option.some(handlerStruct({mousedown:mouseDown,mouseover:mouseOver,mouseup:mouseUp,keyup:keyup,keydown:keydown}))});var destroy=function(){handlers.each(function(handlers){})};return{clear:annotations.clear,destroy:destroy}}});define("tinymce.plugins.table.selection.Selections",["ephox.darwin.api.TableSelection","tinymce.plugins.table.alien.Util","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.SelectionTypes"],function(TableSelection,Util,Ephemera,SelectionTypes){return function(editor){var get=function(){var body=Util.getBody(editor);return TableSelection.retrieve(body,Ephemera.selectedSelector()).fold(function(){if(editor.selection.getStart()===undefined){return SelectionTypes.none()}else{return SelectionTypes.single(editor.selection)}},function(cells){return SelectionTypes.multiple(cells)})};return{get:get}}});define("tinymce.plugins.table.ui.Buttons",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.ui.TableDialog"],function(Fun,Tools,TableDialog){var each=Tools.each;var addButtons=function(editor){var menuItems=[];each("inserttable tableprops deletetable | cell row column".split(" "),function(name){if(name=="|"){menuItems.push({text:"-"})}else{menuItems.push(editor.menuItems[name])}});editor.addButton("table",{type:"menubutton",title:"Table",menu:menuItems});function cmd(command){return function(){editor.execCommand(command)}}editor.addButton("tableprops",{title:"Table properties",onclick:Fun.curry(TableDialog.open,editor,true),icon:"table"});editor.addButton("tabledelete",{title:"Delete table",onclick:cmd("mceTableDelete")});editor.addButton("tablecellprops",{title:"Cell properties",onclick:cmd("mceTableCellProps")});editor.addButton("tablemergecells",{title:"Merge cells",onclick:cmd("mceTableMergeCells")});editor.addButton("tablesplitcells",{title:"Split cell",onclick:cmd("mceTableSplitCells")});editor.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:cmd("mceTableInsertRowBefore")});editor.addButton("tableinsertrowafter",{title:"Insert row after",onclick:cmd("mceTableInsertRowAfter")});editor.addButton("tabledeleterow",{title:"Delete row",onclick:cmd("mceTableDeleteRow")});editor.addButton("tablerowprops",{title:"Row properties",onclick:cmd("mceTableRowProps")});editor.addButton("tablecutrow",{title:"Cut row",onclick:cmd("mceTableCutRow")});editor.addButton("tablecopyrow",{title:"Copy row",onclick:cmd("mceTableCopyRow")});editor.addButton("tablepasterowbefore",{title:"Paste row before",onclick:cmd("mceTablePasteRowBefore")});editor.addButton("tablepasterowafter",{title:"Paste row after",onclick:cmd("mceTablePasteRowAfter")});editor.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:cmd("mceTableInsertColBefore")});editor.addButton("tableinsertcolafter",{title:"Insert column after",onclick:cmd("mceTableInsertColAfter")});editor.addButton("tabledeletecol",{title:"Delete column",onclick:cmd("mceTableDeleteCol")})};var addToolbars=function(editor){var isTable=function(table){var selectorMatched=editor.dom.is(table,"table")&&editor.getBody().contains(table);return selectorMatched};var toolbarItems=editor.settings.table_toolbar;if(toolbarItems===""||toolbarItems===false){return}if(!toolbarItems){toolbarItems="tableprops tabledelete | "+"tableinsertrowbefore tableinsertrowafter tabledeleterow | "+"tableinsertcolbefore tableinsertcolafter tabledeletecol"}editor.addContextToolbar(isTable,toolbarItems)};return{addButtons:addButtons,addToolbars:addToolbars}});define("tinymce.plugins.table.ui.MenuItems",["ephox.katamari.api.Fun","ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.TableLookup","ephox.sugar.api.node.Element","tinymce.plugins.table.actions.InsertTable","tinymce.plugins.table.queries.TableTargets","tinymce.plugins.table.ui.TableDialog"],function(Fun,Arr,Option,TableLookup,Element,InsertTable,TableTargets,TableDialog){var addMenuItems=function(editor,selections){var targets=Option.none();var tableCtrls=[];var cellCtrls=[];var mergeCtrls=[];var unmergeCtrls=[];var noTargetDisable=function(ctrl){ctrl.disabled(true)};var ctrlEnable=function(ctrl){ctrl.disabled(false)};var pushTable=function(){var self=this;tableCtrls.push(self);targets.fold(function(){noTargetDisable(self)},function(targets){ctrlEnable(self)})};var pushCell=function(){var self=this;cellCtrls.push(self);targets.fold(function(){noTargetDisable(self)},function(targets){ctrlEnable(self)})};var pushMerge=function(){var self=this;mergeCtrls.push(self);targets.fold(function(){noTargetDisable(self)},function(targets){self.disabled(targets.mergable().isNone())})};var pushUnmerge=function(){var self=this;unmergeCtrls.push(self);targets.fold(function(){noTargetDisable(self)},function(targets){self.disabled(targets.unmergable().isNone())})};var setDisabledCtrls=function(){targets.fold(function(){Arr.each(tableCtrls,noTargetDisable);Arr.each(cellCtrls,noTargetDisable);Arr.each(mergeCtrls,noTargetDisable);Arr.each(unmergeCtrls,noTargetDisable)},function(targets){Arr.each(tableCtrls,ctrlEnable);Arr.each(cellCtrls,ctrlEnable);Arr.each(mergeCtrls,function(mergeCtrl){mergeCtrl.disabled(targets.mergable().isNone())});Arr.each(unmergeCtrls,function(unmergeCtrl){unmergeCtrl.disabled(targets.unmergable().isNone())})})};editor.on("init",function(){editor.on("nodechange",function(e){var cellOpt=Option.from(editor.dom.getParent(editor.selection.getStart(),"th,td"));targets=cellOpt.bind(function(cellDom){var cell=Element.fromDom(cellDom);var table=TableLookup.table(cell);return table.map(function(table){return TableTargets.forMenu(selections,table,cell)})});setDisabledCtrls()})});var generateTableGrid=function(){var html="";html='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var y=0;y<10;y++){html+="<tr>";for(var x=0;x<10;x++){html+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(y*10+x)+'" href="#" '+'data-mce-x="'+x+'" data-mce-y="'+y+'"></a></td>'}html+="</tr>"}html+="</table>";html+='<div class="mce-text-center" role="presentation">1 x 1</div>';return html};var selectGrid=function(editor,tx,ty,control){var table=control.getEl().getElementsByTagName("table")[0];var x,y,focusCell,cell,active;var rtl=control.isRtl()||control.parent().rel=="tl-tr";table.nextSibling.innerHTML=tx+1+" x "+(ty+1);if(rtl){tx=9-tx}for(y=0;y<10;y++){for(x=0;x<10;x++){cell=table.rows[y].childNodes[x].firstChild;active=(rtl?x>=tx:x<=tx)&&y<=ty;editor.dom.toggleClass(cell,"mce-active",active);if(active){focusCell=cell}}}return focusCell.parentNode};var insertTable=editor.settings.table_grid===false?{text:"Table",icon:"table",context:"table",onclick:Fun.curry(TableDialog.open,editor)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:true,onclick:function(e){if(e.aria){this.parent().hideAll();e.stopImmediatePropagation();TableDialog.open(editor)}},onshow:function(){selectGrid(editor,0,0,this.menu.items()[0])},onhide:function(){var elements=this.menu.items()[0].getEl().getElementsByTagName("a");editor.dom.removeClass(elements,"mce-active");editor.dom.addClass(elements[0],"mce-active")},menu:[{type:"container",html:generateTableGrid(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var target=e.target,x,y;if(target.tagName.toUpperCase()=="A"){x=parseInt(target.getAttribute("data-mce-x"),10);y=parseInt(target.getAttribute("data-mce-y"),10);if(this.isRtl()||this.parent().rel=="tl-tr"){x=9-x}if(x!==this.lastX||y!==this.lastY){selectGrid(editor,x,y,e.control);this.lastX=x;this.lastY=y}}},onclick:function(e){var self=this;if(e.target.tagName.toUpperCase()=="A"){e.preventDefault();e.stopPropagation();self.parent().cancel();editor.undoManager.transact(function(){InsertTable.insert(editor,self.lastX+1,self.lastY+1)});editor.addVisual()}}}]};function cmd(command){return function(){editor.execCommand(command)}}var tableProperties={text:"Table properties",context:"table",onPostRender:pushTable,onclick:Fun.curry(TableDialog.open,editor,true)};var deleteTable={text:"Delete table",context:"table",onPostRender:pushTable,cmd:"mceTableDelete"};var row={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:cmd("mceTableInsertRowBefore"),onPostRender:pushCell},{text:"Insert row after",onclick:cmd("mceTableInsertRowAfter"),onPostRender:pushCell},{text:"Delete row",onclick:cmd("mceTableDeleteRow"),onPostRender:pushCell},{text:"Row properties",onclick:cmd("mceTableRowProps"),onPostRender:pushCell},{text:"-"},{text:"Cut row",onclick:cmd("mceTableCutRow"),onPostRender:pushCell},{text:"Copy row",onclick:cmd("mceTableCopyRow"),onPostRender:pushCell},{text:"Paste row before",onclick:cmd("mceTablePasteRowBefore"),onPostRender:pushCell},{text:"Paste row after",onclick:cmd("mceTablePasteRowAfter"),onPostRender:pushCell}]};var column={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:cmd("mceTableInsertColBefore"),onPostRender:pushCell},{text:"Insert column after",onclick:cmd("mceTableInsertColAfter"),onPostRender:pushCell},{text:"Delete column",onclick:cmd("mceTableDeleteCol"),onPostRender:pushCell}]};var cell={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:cmd("mceTableCellProps"),onPostRender:pushCell},{text:"Merge cells",onclick:cmd("mceTableMergeCells"),onPostRender:pushMerge},{text:"Split cell",onclick:cmd("mceTableSplitCells"),onPostRender:pushUnmerge}]};editor.addMenuItem("inserttable",insertTable);editor.addMenuItem("tableprops",tableProperties);editor.addMenuItem("deletetable",deleteTable);editor.addMenuItem("row",row);editor.addMenuItem("column",column);editor.addMenuItem("cell",cell)};return{addMenuItems:addMenuItems}});define("tinymce.plugins.table.Plugin",["tinymce.core.PluginManager","tinymce.plugins.table.actions.Clipboard","tinymce.plugins.table.actions.InsertTable","tinymce.plugins.table.actions.TableActions","tinymce.plugins.table.actions.TableCommands","tinymce.plugins.table.actions.ResizeHandler","tinymce.plugins.table.queries.TabContext","tinymce.plugins.table.selection.CellSelection","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.Selections","tinymce.plugins.table.ui.Buttons","tinymce.plugins.table.ui.MenuItems"],function(PluginManager,Clipboard,InsertTable,TableActions,TableCommands,ResizeHandler,TabContext,CellSelection,Ephemera,Selections,Buttons,MenuItems){function Plugin(editor){var self=this;var resizeHandler=ResizeHandler(editor);var cellSelection=CellSelection(editor,resizeHandler.lazyResize);var actions=TableActions(editor,resizeHandler.lazyWire);var selections=Selections(editor);TableCommands.registerCommands(editor,actions,cellSelection,selections);Clipboard.registerEvents(editor,selections,actions,cellSelection);MenuItems.addMenuItems(editor,selections);Buttons.addButtons(editor);Buttons.addToolbars(editor);editor.on("PreInit",function(){editor.serializer.addTempAttr(Ephemera.firstSelected());editor.serializer.addTempAttr(Ephemera.lastSelected())});if(editor.settings.table_tab_navigation!==false){editor.on("keydown",function(e){TabContext.handle(e,editor,actions,resizeHandler.lazyWire)})}editor.on("remove",function(){resizeHandler.destroy();cellSelection.destroy()});self.insertTable=function(columns,rows){return InsertTable.insert(editor,columns,rows)};self.setClipboardRows=TableCommands.setClipboardRows;self.getClipboardRows=TableCommands.getClipboardRows}PluginManager.add("table",Plugin);return function(){}});dem("tinymce.plugins.table.Plugin")()})();(function(){var defs={};var instantiate=function(id){var actual=defs[id];var dependencies=actual.deps;var definition=actual.defn;var len=dependencies.length;var instances=new Array(len);for(var i=0;i<len;++i){instances[i]=dem(dependencies[i])}var defResult=definition.apply(null,instances);if(defResult===undefined){throw"module ["+id+"] returned undefined"}actual.instance=defResult};var def=function(id,dependencies,definition){if(typeof id!=="string"){throw"module id must be a string"}else if(dependencies===undefined){throw"no dependencies for "+id}else if(definition===undefined){throw"no definition function for "+id}defs[id]={deps:dependencies,defn:definition,instance:undefined}};var dem=function(id){var actual=defs[id];if(actual===undefined){throw"module ["+id+"] was undefined"}else if(actual.instance===undefined){instantiate(id)}return actual.instance};var define=def;var defineGlobal=function(id,ref){define(id,[],function(){return ref})};defineGlobal("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);define("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.PluginManager")});define("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.dom.DOMUtils")});define("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.Tools")});define("tinymce.plugins.textcolor.api.Settings",[],function(){var defaultColorMap=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"];var getTextColorMap=function(editor){return editor.getParam("textcolor_map",defaultColorMap)};var getForeColorMap=function(editor){return editor.getParam("forecolor_map",getTextColorMap(editor))};var getBackColorMap=function(editor){return editor.getParam("backcolor_map",getTextColorMap(editor))};var getTextColorRows=function(editor){return editor.getParam("textcolor_rows",5)};var getTextColorCols=function(editor){return editor.getParam("textcolor_cols",8)};var getForeColorRows=function(editor){return editor.getParam("forecolor_rows",getTextColorRows(editor))};var getBackColorRows=function(editor){return editor.getParam("backcolor_rows",getTextColorRows(editor))};var getForeColorCols=function(editor){return editor.getParam("forecolor_cols",getTextColorCols(editor))};var getBackColorCols=function(editor){return editor.getParam("backcolor_cols",getTextColorCols(editor))};var getColorPickerCallback=function(editor){return editor.getParam("color_picker_callback",null)};var hasColorPicker=function(editor){return typeof getColorPickerCallback(editor)==="function"};return{getForeColorMap:getForeColorMap,getBackColorMap:getBackColorMap,getForeColorRows:getForeColorRows,getBackColorRows:getBackColorRows,getForeColorCols:getForeColorCols,getBackColorCols:getBackColorCols,getColorPickerCallback:getColorPickerCallback,hasColorPicker:hasColorPicker}});define("tinymce.plugins.textcolor.core.TextColor",[],function(){var getCurrentColor=function(editor,format){var color;editor.dom.getParents(editor.selection.getStart(),function(elm){var value;if(value=elm.style[format==="forecolor"?"color":"background-color"]){color=value}});return color};var mapColors=function(colorMap){var i,colors=[];for(i=0;i<colorMap.length;i+=2){colors.push({text:colorMap[i+1],color:"#"+colorMap[i]})}return colors};var applyFormat=function(editor,format,value){editor.undoManager.transact(function(){editor.focus();editor.formatter.apply(format,{value:value});editor.nodeChanged()})};var removeFormat=function(editor,format){editor.undoManager.transact(function(){editor.focus();editor.formatter.remove(format,{value:null},null,true);editor.nodeChanged()})};return{getCurrentColor:getCurrentColor,mapColors:mapColors,applyFormat:applyFormat,removeFormat:removeFormat}});define("tinymce.core.util.I18n",["global!tinymce.util.Tools.resolve"],function(resolve){return resolve("tinymce.util.I18n")});define("tinymce.plugins.textcolor.ui.ColorPickerHtml",["tinymce.core.dom.DOMUtils","tinymce.core.util.I18n","tinymce.plugins.textcolor.api.Settings","tinymce.plugins.textcolor.core.TextColor"],function(DOMUtils,I18n,Settings,TextColor){var getHtml=function(cols,rows,colorMap,hasColorPicker){var colors,color,html,last,x,y,i,count=0,id=DOMUtils.DOM.uniqueId("mcearia");var getColorCellHtml=function(color,title){var isNoColor=color==="transparent";return'<td class="mce-grid-cell'+(isNoColor?" mce-colorbtn-trans":"")+'">'+'<div id="'+id+"-"+count+++'"'+' data-mce-color="'+(color?color:"")+'"'+' role="option"'+' tabIndex="-1"'+' style="'+(color?"background-color: "+color:"")+'"'+' title="'+I18n.translate(title)+'">'+(isNoColor?"&#215;":"")+"</div>"+"</td>"};colors=TextColor.mapColors(colorMap);colors.push({text:I18n.translate("No color"),color:"transparent"});html='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>';last=colors.length-1;for(y=0;y<rows;y++){html+="<tr>";for(x=0;x<cols;x++){i=y*cols+x;if(i>last){html+="<td></td>"}else{color=colors[i];html+=getColorCellHtml(color.color,color.text)}}html+="</tr>"}if(hasColorPicker){html+="<tr>"+'<td colspan="'+cols+'" class="mce-custom-color-btn">'+'<div id="'+id+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" '+'role="button" tabindex="-1" aria-labelledby="'+id+'-c" style="width: 100%">'+'<button type="button" role="presentation" tabindex="-1">'+I18n.translate("Custom...")+"</button>"+"</div>"+"</td>"+"</tr>";html+="<tr>";for(x=0;x<cols;x++){html+=getColorCellHtml("","Custom color")}html+="</tr>"}html+="</tbody></table>";return html};return{getHtml:getHtml}});define("tinymce.plugins.textcolor.ui.Buttons",["tinymce.core.dom.DOMUtils","tinymce.core.util.Tools","tinymce.plugins.textcolor.api.Settings","tinymce.plugins.textcolor.core.TextColor","tinymce.plugins.textcolor.ui.ColorPickerHtml"],function(DOMUtils,Tools,Settings,TextColor,ColorPickerHtml){var setDivColor=function setDivColor(div,value){div.style.background=value;div.setAttribute("data-mce-color",value)};var onButtonClick=function(editor){return function(e){var ctrl=e.control;if(ctrl._color){TextColor.applyFormat(editor,ctrl.settings.format,ctrl._color)}else{TextColor.removeFormat(editor,ctrl.settings.format)}}};var onPanelClick=function(editor,cols){return function(e){var buttonCtrl=this.parent(),value;var currentColor=TextColor.getCurrentColor(editor,buttonCtrl.settings.format);var selectColor=function(value){buttonCtrl.hidePanel();buttonCtrl.color(value);TextColor.applyFormat(editor,buttonCtrl.settings.format,value)};var resetColor=function(){buttonCtrl.hidePanel();buttonCtrl.resetColor();TextColor.removeFormat(editor,buttonCtrl.settings.format)};if(DOMUtils.DOM.getParent(e.target,".mce-custom-color-btn")){buttonCtrl.hidePanel();var colorPickerCallback=Settings.getColorPickerCallback(editor);colorPickerCallback.call(editor,function(value){var tableElm=buttonCtrl.panel.getEl().getElementsByTagName("table")[0];var customColorCells,div,i;customColorCells=Tools.map(tableElm.rows[tableElm.rows.length-1].childNodes,function(elm){return elm.firstChild});for(i=0;i<customColorCells.length;i++){div=customColorCells[i];if(!div.getAttribute("data-mce-color")){break}}if(i===cols){for(i=0;i<cols-1;i++){setDivColor(customColorCells[i],customColorCells[i+1].getAttribute("data-mce-color"))}}setDivColor(div,value);selectColor(value)},currentColor)}value=e.target.getAttribute("data-mce-color");if(value){if(this.lastId){DOMUtils.DOM.get(this.lastId).setAttribute("aria-selected",false)}e.target.setAttribute("aria-selected",true);this.lastId=e.target.id;if(value==="transparent"){resetColor()}else{selectColor(value)}}else if(value!==null){buttonCtrl.hidePanel()}}};var renderColorPicker=function(editor,foreColor){return function(){var cols=foreColor?Settings.getForeColorCols(editor):Settings.getBackColorCols(editor);var rows=foreColor?Settings.getForeColorRows(editor):Settings.getBackColorRows(editor);var colorMap=foreColor?Settings.getForeColorMap(editor):Settings.getBackColorMap(editor);var hasColorPicker=Settings.hasColorPicker(editor);return ColorPickerHtml.getHtml(cols,rows,colorMap,hasColorPicker)}};var register=function(editor){editor.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:true,html:renderColorPicker(editor,true),onclick:onPanelClick(editor,Settings.getForeColorCols(editor))},onclick:onButtonClick(editor)});editor.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:true,html:renderColorPicker(editor,false),onclick:onPanelClick(editor,Settings.getBackColorCols(editor))},onclick:onButtonClick(editor)})};return{register:register}});define("tinymce.plugins.textcolor.Plugin",["tinymce.core.PluginManager","tinymce.plugins.textcolor.ui.Buttons"],function(PluginManager,Buttons){PluginManager.add("textcolor",function(editor){Buttons.register(editor)});return function(){}});dem("tinymce.plugins.textcolor.Plugin")()})();const url=new URL(window.location.href);const baseConfig={menu:{edit:{title:"Edit",items:"undo redo | cut copy paste | selectall | searchreplace"},insert:{title:"Insert",items:"image link | inserttable hr"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | removeformat"},tools:{title:"Tools",items:"code fullscreen"}},toolbar:["bold italic underline | forecolor backcolor styleselect formatselect fontselect fontsizeselect | image link unlink","alignleft aligncenter alignright alignjustify alignnone | bullist numlist | outdent indent blockquote"],plugins:["code","hr","lists","link","image","paste","searchreplace","fullscreen","table","textcolor"],min_height:300,branding:false,relative_urls:false,remove_script_host:true,document_base_url:`${url.origin}${url.pathname}tinymce`,skin:"lightgray",skin_url:"skins/lightgray",theme:"modern",theme_url:"themes/modern/theme.js",body_class:"Wyswyg__body",mobile:{theme:"mobile",theme_url:"themes/mobile/theme.js"}};var script$21=function(){this.editor=null;this.on("mount",()=>{tinymce$1.init(objectAssign({},baseConfig,{selector:`.Wyswyg__editor${this._riot_id}`,init_instance_callback:editor=>{this.editor=editor;!!this.opts.val&&this.editor.setContent(this.opts.val);this.editor.on("Change",this.handleEditorChange);this.editor.on("focus",this.handleEditorFocus);this.editor.on("blur",this.handleEditorBlur)}}))}).on("before-unmount",()=>{tinymce$1.remove(`.Wyswyg__editor${this._riot_id}`);this.editor.off("Change",this.handleEditorChange);this.editor.off("focus",this.handleEditorFocus);this.editor.off("blur",this.handleEditorBlur);this.editor.destroy();this.editor=null});this.handleEditorChange=throttle_1(()=>{if(!this.opts.onchange){return}const html=this.editor.getContent();this.opts.onchange(html)},1e3);this.handleEditorFocus=(()=>{if(!this.opts.onfocus){return}this.opts.onfocus()});this.handleEditorBlur=(()=>{if(!this.opts.onblur){return}this.opts.onblur()});this.handleBlockerTap=(e=>{e.stopPropagation()})};riot$1.tag2("viron-wyswyg",'<form class="Wyswyg__form"> <textarea class="Wyswyg__editor{_riot_id}"></textarea> </form> <div class="Wyswyg__blocker" if="{opts.ispreview}" onclick="{getClickHandler(\'handleBlockerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBlockerTap\')}"></div>',"","class=\"Wyswyg {'Wyswyg--disabled': opts.isdisabled, 'Wyswyg--error': opts.haserror}\"",function(opts){this.external(script$21)});var script$22=function(){this.isVisible=false;this.on("mount",()=>{if(this.opts.ispreview){return}setTimeout(()=>{if(!this.isMounted){return}this.isVisible=true;this.update()},100)})};riot$1.tag2("viron-parameters-popover",'<div class="Parameters_Popover__message">{opts.message}</div> <div class="Parameters_Popover__arrow"></div>',"","class=\"Parameters_Popover {'Parameters_Popover--visible': isVisible}\"",function(opts){this.external(script$22)});function isInteger(val){return isNumber_1(val)&&val%1===0}var isInteger_1=isInteger;const UI_TEXTINPUT="textinput";const UI_TEXTAREA="textarea";const UI_HTML="html";const UI_NUMBERINPUT="numberinput";const UI_CHECKBOX="checkbox";const UI_SELECT="select";const UI_UPLOADER="uploader";const UI_WYSWYG="wyswyg";const UI_PUG="pug";const UI_NULL="null";const UI_AUTOCOMPLETE="autocomplete";const UI_BASE64="base64";const trimNull=obj=>{const ret=deepClone_1(obj);const trim=val=>{let loop;if(isObject_1(val)){loop=forOwn_1$2}else if(isArray_1$1(val)){loop=forEach_1$2}else{return}loop(val,(v,k)=>{if(isNull_1(v)){val[k]=undefined}if(isObject_1(v)||isArray_1$1(v)){trim(v)}})};trim(ret);return ret};const checkParameterObject=(parameterObject,val)=>{const name=parameterObject.name;const _default=parameterObject.default;const required=parameterObject.required;const _in=parameterObject.in;if(!isUndefined(val[name])){return}if(!isUndefined(_default)){val[name]=deepClone_1(_default);return}if(!required){return}if(contains_1$2(["formData","header","path","query"],_in)){return}const schema=parameterObject.schema;if(contains_1$2(["boolean","integer","number","null","string"],schema.type)){return}if(schema.type==="object"){val[name]={};generateDefaultProperties(schema,val[name])}if(schema.type==="array"){val=[];const minItems=schema.minItems;if(isInteger_1(minItems)&&minItems>0){times_1(minItems,()=>{val.push(generateDefaultItem(schema.items))})}}};const generateDefaultProperties=(schemaObject,val)=>{if(val===void 0)val={};const properties=schemaObject.properties;const required=schemaObject.required||[];forOwn_1$2(properties,(property,key)=>{if(contains_1$2(["boolean","integer","number","null","string"],property.type)){if(!isUndefined(val[key])){return}if(isUndefined(property.default)){return}val[key]=property.default}if(property.type==="object"){if(!contains_1$2(required,key)){return}val[key]={};generateDefaultProperties(property,val[key])}if(property.type==="array"){if(!contains_1$2(required,key)){return}val[key]=[];const minItems=property.minItems;if(isInteger_1(minItems)&&minItems>0){times_1(minItems,()=>{val[key].push(generateDefaultItem(property.items))})}}});return val};const generateDefaultItem=itemsObject=>{if(isArray_1$1(itemsObject)){itemsObject=itemsObject[0]}if(contains_1$2(["boolean","integer","number","null","string"],itemsObject.type)){return itemsObject.default}if(itemsObject.type==="object"&&itemsObject){return generateDefaultProperties(itemsObject)}if(itemsObject.type==="array"){if(!itemsObject.required){return undefined}const ret=[];const minItems=itemsObject.minItems;if(isInteger_1(minItems)&&minItems>0){times_1(minItems,()=>{ret.push(generateDefaultItem(itemsObject.items))})}return ret}return undefined};var util={getUIType:formObject=>{if(!!formObject.enum){return UI_SELECT}if(!!formObject["x-autocomplete"]){return UI_AUTOCOMPLETE}const type=formObject.type;const format=formObject.format;switch(type){case"string":switch(format){case"date-time":return UI_TEXTINPUT;case"multiline":return UI_TEXTAREA;case"wyswyg":return UI_WYSWYG;case"pug":return UI_PUG;case"html":return UI_HTML;case"base64":return UI_BASE64;default:return UI_TEXTINPUT}case"number":case"integer":return UI_NUMBERINPUT;case"boolean":return UI_CHECKBOX;case"file":return UI_UPLOADER;case"null":return UI_NULL;default:break}},getSpreadStyle:formObject=>{if(!!formObject.enum){return"spreadMedium"}switch(formObject.type){case"string":switch(formObject.format){case"base64":return"spreadSmall";case"multiline":case"wyswyg":case"pug":case"html":return"spreadFull";case"date-time":return"spreadMedium";default:return"spreadLarge"}case"number":case"integer":return"spreadMedium";case"boolean":case"file":case"null":default:return"spreadSmall"}},generateInitialVal:(parameterObjects,initialVal)=>{if(parameterObjects===void 0)parameterObjects=[];if(initialVal===void 0)initialVal={};const val=trimNull(initialVal);forEach_1$2(parameterObjects,parameterObject=>{checkParameterObject(parameterObject,val)});return val},generateDefaultProperties:generateDefaultProperties,generateDefaultItem:generateDefaultItem,trimNull:trimNull};var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray$4(input){return input instanceof Array||Object.prototype.toString.call(input)==="[object Array]"}function isObject$3(input){return input!=null&&Object.prototype.toString.call(input)==="[object Object]"}function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(obj).length===0}else{var k;for(k in obj){if(obj.hasOwnProperty(k)){return false}}return true}}function isUndefined$2(input){return input===void 0}function isNumber$3(input){return typeof input==="number"||Object.prototype.toString.call(input)==="[object Number]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map$3(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend$2(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}var some$3;if(Array.prototype.some){some$3=Array.prototype.some}else{some$3=function(fun){var t=Object(this);var len=t.length>>>0;for(var i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true}}return false}}function isValid$3(m){if(m._isValid==null){var flags=getParsingFlags(m);var parsedParts=some$3.call(flags.parsedDateParts,function(i){return i!=null});var isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid}else{return isNowValid}}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend$2(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(!isUndefined$2(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject}if(!isUndefined$2(from._i)){to._i=from._i}if(!isUndefined$2(from._f)){to._f=from._f}if(!isUndefined$2(from._l)){to._l=from._l}if(!isUndefined$2(from._strict)){to._strict=from._strict}if(!isUndefined$2(from._tzm)){to._tzm=from._tzm}if(!isUndefined$2(from._isUTC)){to._isUTC=from._isUTC}if(!isUndefined$2(from._offset)){to._offset=from._offset}if(!isUndefined$2(from._pf)){to._pf=getParsingFlags(from)}if(!isUndefined$2(from._locale)){to._locale=from._locale}if(momentProperties.length>0){for(i=0;i<momentProperties.length;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined$2(val)){to[prop]=val}}}return to}var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function absFloor(number){if(number<0){return Math.ceil(number)||0}else{return Math.floor(number)}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber)}return value}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function warn(msg){if(hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend$2(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg)}if(firstTime){var args=[];var arg;for(var i=0;i<arguments.length;i++){arg="";if(typeof arguments[i]==="object"){arg+="\n["+i+"] ";for(var key in arguments[0]){arg+=key+": "+arguments[0][key]+", "}arg=arg.slice(0,-2)}else{arg=arguments[i]}args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg)}if(!deprecations[name]){warn(msg);deprecations[name]=true}}hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction$1(input){return input instanceof Function||Object.prototype.toString.call(input)==="[object Function]"}function set(config){var prop,i;for(i in config){prop=config[i];if(isFunction$1(prop)){this[i]=prop}else{this["_"+i]=prop}}this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var res=extend$2({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject$3(parentConfig[prop])&&isObject$3(childConfig[prop])){res[prop]={};extend$2(res[prop],parentConfig[prop]);extend$2(res[prop],childConfig[prop])}else if(childConfig[prop]!=null){res[prop]=childConfig[prop]}else{delete res[prop]}}}for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject$3(parentConfig[prop])){res[prop]=extend$2({},res[prop])}}return res}function Locale(config){if(config!=null){this.set(config)}}var keys$1;if(Object.keys){keys$1=Object.keys}else{keys$1=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i)}}return res}}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar["sameElse"];return isFunction$1(output)?output.call(mom,now):output}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format}this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});return this._longDateFormat[key]}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d";var defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction$1(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction$1(format)?format(output):format.replace(/%s/i,output)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function getPrioritizedUnits(unitsObj){var units=[];for(var u in unitsObj){units.push({unit:u,priority:priorities[u]})}units.sort(function(a,b){return a.priority-b.priority});return units}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var formatFunctions={};var formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="",i;for(i=0;i<length;i++){output+=isFunction$1(array[i])?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var match1=/\d/;var match2=/\d\d/;var match3=/\d{3}/;var match4=/\d{4}/;var match6=/[+-]?\d{6}/;var match1to2=/\d\d?/;var match3to4=/\d\d\d\d?/;var match5to6=/\d\d\d\d\d\d?/;var match1to3=/\d{1,3}/;var match1to4=/\d{1,4}/;var match1to6=/[+-]?\d{1,6}/;var matchUnsigned=/\d+/;var matchSigned=/[+-]?\d+/;var matchOffset=/Z|[+-]\d\d:?\d\d/gi;var matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi;var matchTimestamp=/[+-]?\d+(\.\d{1,3})?/;var matchWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;var regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction$1(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return regexEscape$1(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))}function regexEscape$1(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==="string"){token=[token]}if(isNumber$3(callback)){func=function(input,array){array[callback]=toInt(input)}}for(i=0;i<token.length;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0;var MONTH=1;var DATE=2;var HOUR=3;var MINUTE=4;var SECOND=5;var MILLISECOND=6;var WEEK=7;var WEEKDAY=8;addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?""+y:"+"+y});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,true],0,"year");addUnitAlias("year","y");addUnitPriority("year",1);addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input)});addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)});addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)});function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",true);function getIsLeapYear(){return isLeapYear(this.year())}function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this}else{return get$1(this,unit)}}}function get$1(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==="FullYear"&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))}else{mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}}function stringGet(units){units=normalizeUnits(units);if(isFunction$1(this[units])){return this[units]()}return this}function stringSet(units,value){if(typeof units==="object"){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units);for(var i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit])}}else{units=normalizeUnits(units);if(isFunction$1(this[units])){return this[units](value)}}return this}function mod(n,x){return(n%x+x)%x}var indexOf$4;if(Array.prototype.indexOf){indexOf$4=Array.prototype.indexOf}else{indexOf$4=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i}}return-1}}function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN}var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?isLeapYear(year)?29:28:31-modMonth%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)});addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)});addUnitAlias("month","M");addUnitPriority("month",8);addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)});addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)});addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1});addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function localeMonths(m,format){if(!m){return isArray$4(this._months)?this._months:this._months["standalone"]}return isArray$4(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]}var defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function localeMonthsShort(m,format){if(!m){return isArray$4(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return isArray$4(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2e3,i]);this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase()}}if(strict){if(format==="MMM"){ii=indexOf$4.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf$4.call(this._longMonthsParse,llc);return ii!==-1?ii:null}}else{if(format==="MMM"){ii=indexOf$4.call(this._shortMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._longMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf$4.call(this._longMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}}}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom}if(typeof value==="string"){if(/^\d+$/.test(value)){value=toInt(value)}else{value=mom.localeData().monthsParse(value);if(!isNumber$3(value)){return mom}}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this}else{return get$1(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}var defaultMonthsShortRegex=matchWord;function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!hasOwnProp(this,"_monthsShortRegex")){this._monthsShortRegex=defaultMonthsShortRegex}return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex}}var defaultMonthsRegex=matchWord;function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!hasOwnProp(this,"_monthsRegex")){this._monthsRegex=defaultMonthsRegex}return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex}}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2e3,i]);shortPieces.push(this.monthsShort(mom,""));longPieces.push(this.months(mom,""));mixedPieces.push(this.months(mom,""));mixedPieces.push(this.monthsShort(mom,""))}shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape$1(shortPieces[i]);longPieces[i]=regexEscape$1(longPieces[i])}for(i=0;i<24;i++){mixedPieces[i]=regexEscape$1(mixedPieces[i])}this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<100&&y>=0&&isFinite(date.getFullYear())){date.setFullYear(y)}return date}function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<100&&y>=0&&isFinite(date.getUTCFullYear())){date.setUTCFullYear(y)}return date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year)}else{resYear=year;resDayOfYear=dayOfYear}return{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy)}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1}else{resYear=mom.year();resWeek=week}return{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addUnitPriority("week",5);addUnitPriority("isoWeek",5);addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)});addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)});addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addUnitPriority("day",11);addUnitPriority("weekday",11);addUnitPriority("isoWeekday",11);addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)});addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)});addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)});addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}});addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});function parseWeekday(input,locale){if(typeof input!=="string"){return input}if(!isNaN(input)){return parseInt(input,10)}input=locale.weekdaysParse(input);if(typeof input==="number"){return input}return null}function parseIsoWeekday(input,locale){if(typeof input==="string"){return locale.weekdaysParse(input)%7||7}return isNaN(input)?null:input}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function localeWeekdays(m,format){if(!m){return isArray$4(this._weekdays)?this._weekdays:this._weekdays["standalone"]}return isArray$4(this._weekdays)?this._weekdays[m.day()]:this._weekdays[this._weekdays.isFormat.test(format)?"format":"standalone"][m.day()]}var defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function localeWeekdaysShort(m){return m?this._weekdaysShort[m.day()]:this._weekdaysShort}var defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function localeWeekdaysMin(m){return m?this._weekdaysMin[m.day()]:this._weekdaysMin}function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2e3,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase()}}if(strict){if(format==="dddd"){ii=indexOf$4.call(this._weekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf$4.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf$4.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}}else{if(format==="dddd"){ii=indexOf$4.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf$4.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf$4.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf$4.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}}}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".",".?")+"$","i");this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".",".?")+"$","i");this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".",".?")+"$","i")}if(!this._weekdaysParse[i]){regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="dddd"&&this._fullWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="ddd"&&this._shortWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="dd"&&this._minWeekdaysParse[i].test(weekdayName)){return i}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}else{return this.day()||7}}var defaultWeekdaysRegex=matchWord;function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!hasOwnProp(this,"_weekdaysRegex")){this._weekdaysRegex=defaultWeekdaysRegex}return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex}}var defaultWeekdaysShortRegex=matchWord;function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!hasOwnProp(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=defaultWeekdaysShortRegex}return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}var defaultWeekdaysMinRegex=matchWord;function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!hasOwnProp(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=defaultWeekdaysMinRegex}return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);minp=this.weekdaysMin(mom,"");shortp=this.weekdaysShort(mom,"");longp=this.weekdays(mom,"");minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp)}minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<7;i++){shortPieces[i]=regexEscape$1(shortPieces[i]);longPieces[i]=regexEscape$1(longPieces[i]);mixedPieces[i]=regexEscape$1(mixedPieces[i])}this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}meridiem("a",true);meridiem("A",false);addUnitAlias("hour","h");addUnitPriority("hour",13);function matchMeridiem(isStrict,locale){return locale._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("k",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput});addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input});addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true});addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true});addParseToken("hmmss",function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true});addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos))});addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2))});function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var getSetHour=makeGetSet("Hours",true);var baseConfig$1={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={};var localeFamilies={};var globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&typeof module!=="undefined"&&module&&module.exports){try{oldLocale=globalLocale._abbr;var aliasedRequire=require;aliasedRequire("./locale/"+name);getSetGlobalLocale(oldLocale)}catch(e){}}return locales[name]}function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined$2(values)){data=getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}}return globalLocale._abbr}function defineLocale(name,config){if(config!==null){var parentConfig=baseConfig$1;config.abbr=name;if(locales[name]!=null){deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");parentConfig=locales[name]._config}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[]}localeFamilies[config.parentLocale].push({name:name,config:config});return null}}locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)})}getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig$1;tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config}config=mergeConfigs(parentConfig,config);locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale;getSetGlobalLocale(name)}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale}else if(locales[name]!=null){delete locales[name]}}}return locales[name]}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray$4(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}function listLocales(){return keys$1(locales)}function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK}if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY}getParsingFlags(m).overflow=overflow}return m}function defaults$2(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]}return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear!=null){yearToUse=defaults$2(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}if(config._w&&typeof config._w.d!=="undefined"&&config._w.d!==config._d.getDay()){getParsingFlags(config).weekdayMismatch=true}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults$2(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults$2(w.W,1);weekday=defaults$2(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;var curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults$2(w.gg,config._a[YEAR],curWeek.year);week=defaults$2(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true}}else{weekday=dow}}if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var tzRegex=/Z|[+-]\d\d(?::?\d\d)?/;var isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/]];var isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]];var aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break}}if(dateFormat==null){config._isValid=false;return}if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}}if(timeFormat==null){config._isValid=false;return}}if(!allowTime&&timeFormat!=null){config._isValid=false;return}if(match[4]){if(tzRegex.exec(match[4])){tzFormat="Z"}else{config._isValid=false;return}}config._f=dateFormat+(timeFormat||"")+(tzFormat||"");configFromStringAndFormat(config)}else{config._isValid=false}}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10))}return result}function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2e3+year}else if(year<=999){return 1900+year}return year}function preprocessRFC2822(s){return s.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false}}return true}var obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset]}else if(militaryOffset){return 0}else{var hm=parseInt(numOffset,10);var m=hm%100,h=(hm-m)/100;return h*60+m}}function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i));if(match){var parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return}config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid}else{return}configFromRFC2822(config);if(config._isValid===false){delete config._isValid}else{return}hooks.createFromInputFallback(config)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return}if(config._f===hooks.RFC_2822){configFromRFC2822(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!isValid$3(tempConfig)){continue}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend$2(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i);config._a=map$3([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)});configFromArray(config)}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||format===undefined&&input===""){return createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isDate(input)){config._d=input}else if(isArray$4(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else{configFromInput(config)}if(!isValid$3(config)){config._d=null}return config}function configFromInput(config){var input=config._i;if(isUndefined$2(input)){config._d=new Date(hooks.now())}else if(isDate(input)){config._d=new Date(input.valueOf())}else if(typeof input==="string"){configFromString(config)}else if(isArray$4(input)){config._a=map$3(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(isObject$3(input)){configFromObject(config)}else if(isNumber$3(input)){config._d=new Date(input)}else{hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(locale===true||locale===false){strict=locale;locale=undefined}if(isObject$3(input)&&isObjectEmpty(input)||isArray$4(input)&&input.length===0){input=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other}else{return createInvalid()}});var prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other}else{return createInvalid()}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray$4(moments[0])){moments=moments[0]}if(!moments.length){return createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i]}}return res}function min$1(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max$1(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}var now$2=function(){return Date.now?Date.now():+new Date};var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(m){for(var key in m){if(!(indexOf$4.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false}}var unitHasDecimal=false;for(var i=0;i<ordering.length;++i){if(m[ordering[i]]){if(unitHasDecimal){return false}if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true}}}return true}function isValid$4(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*1e3*60*60;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){if(number<0){return Math.round(-1*number)*-1}else{return Math.round(number)}}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":");offset("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||"").match(matcher);if(matches===null){return null}var chunk=matches[matches.length-1]||[];var parts=(chunk+"").match(chunkOffset)||["-",0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res}else{return createLocal(input).local()}}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15}hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN}if(input!=null){if(typeof input==="string"){input=offsetFromString(matchShortOffset,input);if(input===null){return this}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone)}else{this.utcOffset(0,true)}}return this}function hasAlignedHourOffset(input){if(!this.isValid()){return false}input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined$2(this._isDSTShifted)){return this._isDSTShifted}var c={};copyConfig(c,this);c=prepareConfig(c);if(c._a){var other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:false}function isUtcOffset(){return this.isValid()?this._isUTC:false}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false}var aspNetRegex=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(isNumber$3(input)){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else if(!!(match=aspNetRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1e3))*sign}}else if(!!(match=isoRegex.exec(input))){sign=match[1]==="-"?-1:match[1]==="+"?1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}return ret}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0}}other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");tmp=val;val=period;period=tmp}val=typeof val==="string"?+val:val;dur=createDuration(val,period);addSubtract(this,dur,direction);return this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return}updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get$1(mom,"Month")+months*isAdding)}if(days){set$1(mom,"Date",get$1(mom,"Date")+days*isAdding)}if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding)}if(updateOffset){hooks.updateOffset(mom,days||months)}}var add=createAdder(1,"add");var subtract=createAdder(-1,"subtract");function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,"days",true);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"}function calendar$1(time,formats){var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse";var output=formats&&(isFunction$1(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))}function clone$2(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(!isUndefined$2(units)?units:"millisecond");if(units==="millisecond"){return this.valueOf()>localInput.valueOf()}else{return localInput.valueOf()<this.clone().startOf(units).valueOf()}}function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(!isUndefined$2(units)?units:"millisecond");if(units==="millisecond"){return this.valueOf()<localInput.valueOf()}else{return this.clone().endOf(units).valueOf()<localInput.valueOf()}}function isBetween(from,to,units,inclusivity){inclusivity=inclusivity||"()";return(inclusivity[0]==="("?this.isAfter(from,units):!this.isBefore(from,units))&&(inclusivity[1]===")"?this.isBefore(to,units):!this.isAfter(to,units))}function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units||"millisecond");if(units==="millisecond"){return this.valueOf()===localInput.valueOf()}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()}}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,delta,output;if(!this.isValid()){return NaN}that=cloneWithOffset(input,this);if(!that.isValid()){return NaN}zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)}function monthDiff(a,b){var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString$3(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(){if(!this.isValid()){return null}var m=this.clone().utc();if(m.year()<0||m.year()>9999){return formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}if(isFunction$1(Date.prototype.toISOString)){return this.toDate().toISOString()}return formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function inspect(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var func="moment";var zone="";if(!this.isLocal()){func=this.utcOffset()===0?"moment.utc":"moment.parseZone";zone="Z"}var prefix="["+func+'("]';var year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";var datetime="-MM-DD[T]HH:mm:ss.SSS";var suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix)}function format$2(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat}var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}function startOf(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}if(units==="isoWeek"){this.isoWeekday(1)}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this}function endOf(units){units=normalizeUnits(units);if(units===undefined||units==="millisecond"){return this}if(units==="date"){units="day"}return this.startOf(units).add(1,units==="isoWeek"?"week":units).subtract(1,"ms")}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject$2(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$5(){return isValid$3(this)}function parsingFlags(){return extend$2({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addUnitPriority("weekYear",1);addUnitPriority("isoWeekYear",1);addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)});addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget}return setWeekAll.call(this,input,week,weekday,dow,doy)}}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this}addFormatToken("Q",0,"Qo","quarter");addUnitAlias("quarter","Q");addUnitPriority("quarter",7);addRegexToken("Q",match1);addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addUnitPriority("date",9);addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0],10)});var getSetDayOfMonth=makeGetSet("Date",true);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addUnitPriority("dayOfYear",4);addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addUnitPriority("minute",14);addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addUnitPriority("second",15);addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addUnitAlias("millisecond","ms");addUnitPriority("millisecond",16);addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token;for(token="SSSS";token.length<=9;token+="S"){addRegexToken(token,matchUnsigned)}function parseMs(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)}for(token="S";token.length<=9;token+="S"){addParseToken(token,parseMs)}var getSetMillisecond=makeGetSet("Milliseconds",false);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone$2;proto.diff=diff;proto.endOf=endOf;proto.format=format$2;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$5;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject$2;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;proto.toJSON=toJSON;proto.toString=toString$3;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(string){return string}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$2(format,index,field,setter){var locale=getLocale();var utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber$3(format)){index=format;format=undefined}format=format||"";if(index!=null){return get$2(format,index,field,"month")}var i;var out=[];for(i=0;i<12;i++){out[i]=get$2(format,i,field,"month")}return out}function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==="boolean"){if(isNumber$3(format)){index=format;format=undefined}format=format||""}else{format=localeSorted;index=format;localeSorted=false;if(isNumber$3(format)){index=format;format=undefined}format=format||""}var locale=getLocale(),shift=localeSorted?locale._week.dow:0;if(index!=null){return get$2(format,(index+shift)%7,field,"day")}var i;var out=[];for(i=0;i<7;i++){out[i]=get$2(format,(i+shift)%7,field,"day")}return out}function listMonths(format,index){return listMonthsImpl(format,index,"months")}function listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}getSetGlobalLocale("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this}function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function add$1(input,value){return addSubtract$1(this,input,value,1)}function subtract$1(input,value){return addSubtract$1(this,input,value,-1)}function absCeil(number){if(number<0){return Math.floor(number)}else{return Math.ceil(number)}}function bubble(){var milliseconds=this._milliseconds;var days=this._days;var months=this._months;var data=this._data;var seconds,minutes,hours,years,monthsFromDays;if(!(milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0)){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0}data.milliseconds=milliseconds%1e3;seconds=absFloor(milliseconds/1e3);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this}function daysToMonths(days){return days*4800/146097}function monthsToDays(months){return months*146097/4800}function as(units){if(!this.isValid()){return NaN}var days;var months;var milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==="month"||units==="year"){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);return units==="month"?months:months/12}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return days*24+milliseconds/36e5;case"minute":return days*1440+milliseconds/6e4;case"second":return days*86400+milliseconds/1e3;case"millisecond":return Math.floor(days*864e5)+milliseconds;default:throw new Error("Unknown unit "+units)}}}function valueOf$1(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms");var asSeconds=makeAs("s");var asMinutes=makeAs("m");var asHours=makeAs("h");var asDays=makeAs("d");var asWeeks=makeAs("w");var asMonths=makeAs("M");var asYears=makeAs("y");function clone$3(){return createDuration(this)}function get$3(units){units=normalizeUnits(units);return this.isValid()?this[units+"s"]():NaN}function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds");var seconds=makeGetter("seconds");var minutes=makeGetter("minutes");var hours=makeGetter("hours");var days=makeGetter("days");var months=makeGetter("months");var years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round;var thresholds={ss:44,s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime$1(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs();var seconds=round(duration.as("s"));var minutes=round(duration.as("m"));var hours=round(duration.as("h"));var days=round(duration.as("d"));var months=round(duration.as("M"));var years=round(duration.as("y"));var a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days]||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a)}function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round}if(typeof roundingFunction==="function"){round=roundingFunction;return true}return false}function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false}if(limit===undefined){return thresholds[threshold]}thresholds[threshold]=limit;if(threshold==="s"){thresholds.ss=limit-1}return true}function humanize(withSuffix){if(!this.isValid()){return this.localeData().invalidDate()}var locale=this.localeData();var output=relativeTime$1(this,!withSuffix,locale);if(withSuffix){output=locale.pastFuture(+this,output)}return locale.postformat(output)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate()}var seconds=abs$1(this._milliseconds)/1e3;var days=abs$1(this._days);var months=abs$1(this._months);var minutes,hours,years;minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;var Y=years;var M=months;var D=days;var h=hours;var m=minutes;var s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"";var total=this.asSeconds();if(!total){return"P0D"}var totalSign=total<0?"-":"";var ymSign=sign(this._months)!==sign(total)?"-":"";var daysSign=sign(this._days)!==sign(total)?"-":"";var hmsSign=sign(this._milliseconds)!==sign(total)?"-":"";return totalSign+"P"+(Y?ymSign+Y+"Y":"")+(M?ymSign+M+"M":"")+(D?daysSign+D+"D":"")+(h||m||s?"T":"")+(h?hmsSign+h+"H":"")+(m?hmsSign+m+"M":"")+(s?hmsSign+s+"S":"")}var proto$2=Duration.prototype;proto$2.isValid=isValid$4;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$3;proto$2.get=get$3;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(input,array,config){config._d=new Date(parseFloat(input,10)*1e3)});addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))});hooks.version="2.19.2";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min$1;hooks.max=max$1;hooks.now=now$2;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;"use strict";var internals={rfc3986:{}};internals.generate=function(){var or="|";var digit="0-9";var digitOnly="["+digit+"]";var alpha="a-zA-Z";var alphaOnly="["+alpha+"]";internals.rfc3986.cidr=digitOnly+or+"[1-2]"+digitOnly+or+"3"+"[0-2]";var hexDigit=digit+"A-Fa-f";var hexDigitOnly="["+hexDigit+"]";var unreserved=alpha+digit+"-\\._~";var subDelims="!\\$&'\\(\\)\\*\\+,;=";var pctEncoded="%"+hexDigit;var pchar=unreserved+pctEncoded+subDelims+":@";var pcharOnly="["+pchar+"]";var zeroPad="0?";var decOctect="(?:"+zeroPad+zeroPad+digitOnly+or+zeroPad+"[1-9]"+digitOnly+or+"1"+digitOnly+digitOnly+or+"2"+"[0-4]"+digitOnly+or+"25"+"[0-5])";internals.rfc3986.IPv4address="(?:"+decOctect+"\\.){3}"+decOctect;var h16=hexDigitOnly+"{1,4}";var ls32="(?:"+h16+":"+h16+"|"+internals.rfc3986.IPv4address+")";var IPv6SixHex="(?:"+h16+":){6}"+ls32;var IPv6FiveHex="::(?:"+h16+":){5}"+ls32;var IPv6FourHex="(?:"+h16+")?::(?:"+h16+":){4}"+ls32;var IPv6ThreeHex="(?:(?:"+h16+":){0,1}"+h16+")?::(?:"+h16+":){3}"+ls32;var IPv6TwoHex="(?:(?:"+h16+":){0,2}"+h16+")?::(?:"+h16+":){2}"+ls32;var IPv6OneHex="(?:(?:"+h16+":){0,3}"+h16+")?::"+h16+":"+ls32;var IPv6NoneHex="(?:(?:"+h16+":){0,4}"+h16+")?::"+ls32;var IPv6NoneHex2="(?:(?:"+h16+":){0,5}"+h16+")?::"+h16;var IPv6NoneHex3="(?:(?:"+h16+":){0,6}"+h16+")?::";internals.rfc3986.IPv6address="(?:"+IPv6SixHex+or+IPv6FiveHex+or+IPv6FourHex+or+IPv6ThreeHex+or+IPv6TwoHex+or+IPv6OneHex+or+IPv6NoneHex+or+IPv6NoneHex2+or+IPv6NoneHex3+")";internals.rfc3986.IPvFuture="v"+hexDigitOnly+"+\\.["+unreserved+subDelims+":]+";internals.rfc3986.scheme=alphaOnly+"["+alpha+digit+"+-\\.]*";var userinfo="["+unreserved+pctEncoded+subDelims+":]*";internals.rfc3986.IPLiteral="\\[(?:"+internals.rfc3986.IPv6address+or+internals.rfc3986.IPvFuture+")\\]";var regName="["+unreserved+pctEncoded+subDelims+"]{0,255}";var host="(?:"+internals.rfc3986.IPLiteral+or+internals.rfc3986.IPv4address+or+regName+")";var port=digitOnly+"*";var authority="(?:"+userinfo+"@)?"+host+"(?::"+port+")?";var segment=pcharOnly+"*";var segmentNz=pcharOnly+"+";var pathAbEmpty="(?:\\/"+segment+")*";var pathAbsolute="\\/(?:"+segmentNz+pathAbEmpty+")?";var pathRootless=segmentNz+pathAbEmpty;internals.rfc3986.hierPart="(?:"+"(?:\\/\\/"+authority+pathAbEmpty+")"+or+pathAbsolute+or+pathRootless+")";internals.rfc3986.query="["+pchar+"\\/\\?]*(?=#|$)";internals.rfc3986.fragment="["+pchar+"\\/\\?]*";internals.rfc3986.uri="^(?:"+internals.rfc3986.scheme+":"+internals.rfc3986.hierPart+")(?:\\?"+internals.rfc3986.query+")?"+"(?:#"+internals.rfc3986.fragment+")?$"};internals.generate();var rfc3986=internals.rfc3986;const resultTemplate={isValid:true,message:""};const multipleOf=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"multipleOf")){return result}const multipleOf=constraints.multipleOf;if(!isNumber_1(multipleOf)||multipleOf<0){return result}if(value%multipleOf!==0){result.isValid=false;result.message=`${multipleOf}„ÅßÂâ≤„ÇäÂàá„Çå„ÇãÊï∞ÂÄ§„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`}return result};const maximumAndExclusiveMaximum=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"maximum")){return result}const maximum=constraints.maximum;if(!isNumber_1(maximum)){return result}const exclusiveMaximum=!!constraints.exclusiveMaximum;if(exclusiveMaximum){if(value>=maximum){result.isValid=false;result.message=`${maximum}„Çà„ÇäÂ∞è„Åï„ÅÑÊï∞ÂÄ§„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}}else{if(value>maximum){result.isValid=false;result.message=`${maximum}‰ª•‰∏ã„ÅÆÊï∞ÂÄ§„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}}return result};const minimumAndExclusiveMinimum=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"minimum")){return result}const minimum=constraints.minimum;if(!isNumber_1(minimum)){return result}const exclusiveMinimum=!!constraints.exclusiveMinimum;if(exclusiveMinimum){if(value<=minimum){result.isValid=false;result.message=`${minimum}„Çà„ÇäÂ§ß„Åç„ÅÑÊï∞ÂÄ§„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}}else{if(value<minimum){result.isValid=false;result.message=`${minimum}‰ª•‰∏ä„ÅÆÊï∞ÂÄ§„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}}return result};const maxLength=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"maxLength")){return result}const maxLength=constraints.maxLength;if(!isInteger_1(maxLength)||maxLength<0){return result}if(value.length>maxLength){result.isValid=false;result.message=`ÊñáÂ≠óÊï∞„Çí${maxLength}‰ª•‰∏ã„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}return result};const minLength=(value,constraints)=>{const result=objectAssign({},resultTemplate);const minLength=constraints.minLength||0;if(value.length<minLength){result.isValid=false;result.message=`ÊñáÂ≠óÊï∞„Çí${minLength}‰ª•‰∏ä„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}return result};const pattern=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"pattern")){return result}const pattern=constraints.pattern;if(!value.match(pattern)){result.isValid=false;result.message=`${pattern}„Å´„Éû„ÉÉ„ÉÅ„Åï„Åõ„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}return result};const additionalItemsAndItems=(value,constraints)=>{const result=objectAssign({},resultTemplate);let items;let additionalItems;if(hasOwn_1$2(constraints,"items")){items=constraints.items}else{items={}}if(hasOwn_1$2(constraints,"additionalItems")){additionalItems=constraints.additionalItems}else{additionalItems={}}if(isUndefined(items)||isObject_1(items)){return result}if(isBoolean_1(additionalItems)&&additionalItems||isObject_1(additionalItems)){return result}if(isBoolean_1(additionalItems)&&!additionalItems&&isArray_1$1(items)){if(value.length<=items.length){return result}}result.isValid=false;result.message=`Ë¶ÅÁ¥†Êï∞„Çí${items.length}‰ª•‰∏ã„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result};const maxItems=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"maxItems")){return result}const maxItems=constraints.maxItems;if(!isInteger_1(maxItems)||maxItems<0){return result}if(value.length>maxItems){result.isValid=false;result.message=`Ë¶ÅÁ¥†Êï∞„Çí${maxItems}‰ª•‰∏ã„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}return result};const minItems=(value,constraints)=>{const result=objectAssign({},resultTemplate);const minItems=constraints.minItems||0;if(value.length<minItems){result.isValid=false;result.message=`Ë¶ÅÁ¥†Êï∞„Çí${minItems}‰ª•‰∏ä„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}return result};const uniqueItems=(value,constraints)=>{const result=objectAssign({},resultTemplate);const uniqueItems=constraints.uniqueItems||false;if(!uniqueItems){return result}if(value.length!==unique_1$1(value,(a,b)=>{a=JSON.stringify(deepClone_1(a));b=JSON.stringify(deepClone_1(b));return a===b}).length){result.isValid=false;result.message="ÂÜÖÂÆπ„ÅåÈáçË§á„Åó„Å™„ÅÑË¶ÅÁ¥†„ÅßÊßãÊàê„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ";return result}return result};const maxProperties=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"maxProperties")){return result}const maxProperties=constraints.maxProperties;if(!isInteger_1(maxProperties)||maxProperties<0){return result}if(size_1(value)>maxProperties){result.isValid=false;result.message=`Ë¶ÅÁ¥†Êï∞„Çí${maxProperties}‰ª•‰∏ã„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}return result};const minProperties=(value,constraints)=>{const result=objectAssign({},resultTemplate);const minProperties=constraints.minProperties||0;if(size_1(value)<minProperties){result.isValid=false;result.message=`Ë¶ÅÁ¥†Êï∞„Çí${minProperties}‰ª•‰∏ä„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`;return result}return result};const required=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"required")){return result}const required=constraints.required;if(!isArray_1$1(required)||!required.length){return result}forEach_1$2(required,key=>{if(!hasOwn_1$2(value,key)){result.isValid=false;result.message=`Ë¶ÅÁ¥†„Å´${key}„ÇíÂê´„ÇÅ„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`}});return result};const additionalPropertiesAndPropertiesAndPatternProperties=(value,constraints)=>{const result=objectAssign({},resultTemplate);let additionalProperties;if(!hasOwn_1$2(constraints,"properties")){}else{}if(!hasOwn_1$2(constraints,"patternProperties")){}else{}if(!hasOwn_1$2(constraints,"additionalProperties")){additionalProperties={}}else{additionalProperties=constraints.additionalProperties}if(isBoolean_1(additionalProperties)&&additionalProperties||isObject_1(additionalProperties)){return result}if(isBoolean_1(additionalProperties)&&!additionalProperties){}return result};const dependencies=(value,constraints)=>{const result=objectAssign({},resultTemplate);return result};const _enum=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"enum")){return result}const _enum=constraints.enum;if(!isArray_1$1(_enum)){return result}let isFound=false;forEach_1$2(_enum,item=>{if(value===item){isFound=true}});if(!isFound){result.isValid=false;result.message=`${JSON.stringify(_enum)}„ÅÆ„ÅÑ„Åö„Çå„Åã„ÅÆÂÄ§„ÇíË®≠ÂÆö„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`}return result};const _type=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"type")){return result}let types;if(isArray_1$1(constraints.type)){types=constraints.type}else{types=[constraints.type]}let isValid=false;forEach_1$2(types,type=>{switch(type){case"integer":case"number":if(isNumber_1(value)){isValid=true}break;case"string":if(isString_1(value)){isValid=true}break;case"array":if(isArray_1$1(value)){isValid=true}break;case"object":if(isObject_1(value)){isValid=true}break;case"boolean":if(isBoolean_1(value)){isValid=true}break;case"null":if(isNull_1(value)){isValid=true}break;case"file":if(!!value&&isString_1(value.name)){isValid=true}break;default:break}});if(!isValid){result.isValid=false;result.message=`Âûã„Çí${JSON.stringify(types)}„ÅÆ„ÅÑ„Åö„Çå„Åã„Å´„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ`}return result};const allOf=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"allOf")){return result}const allOf=constraints.allOf;if(!isArray_1$1(allOf)){return result}return result};const anyOf=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"anyOf")){return result}const anyOf=constraints.anyOf;if(!isArray_1$1(anyOf)){return result}return result};const oneOf=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"oneOf")){return result}const oneOf=constraints.oneOf;if(!isArray_1$1(oneOf)){return result}return result};const not=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"not")){return result}const not=constraints.not;if(!isArray_1$1(not)){return result}return result};const definitions=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"definitions")){return result}const definitions=constraints.definitions;if(!isArray_1$1(definitions)){return result}return result};const format$1=(value,constraints)=>{const result=objectAssign({},resultTemplate);if(!hasOwn_1$2(constraints,"format")){return result}const format=constraints.format;if(!isString_1(format)){return result}switch(format){case"date-time":{if(!isString_1(value)){return result}const pattern=/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12]\d|3[01])T([01]\d|2[0-3]):([0-5]\d):([0-5]\d|60)(\.\d+)?(([Zz])|([\+\-])([01]\d|2[0-3]):([0-5]\d))$/;const isMatch=value.match(pattern);if(isNull_1(isMatch)){result.isValid=false;result.message='"date-time"„Å´Ââá„Å£„Åü„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';return result}const isValid=hooks(value).isValid();if(!isValid){result.isValid=false;result.message="Â≠òÂú®„Åô„ÇãÊó•‰ªò„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ";return result}break}case"email":{if(!isString_1(value)){return result}const pattern=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;const isMatch=value.match(pattern);if(isNull_1(isMatch)){result.isValid=false;result.message='"email"„Å´Ââá„Å£„Åü„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';return result}break}case"hostname":{if(!isString_1(value)){return result}if(value.length>255){result.isValid=false;result.message='"hostname"„ÅØ255ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';return result}const pattern=/^[a-z\d]([a-z\d\-]{0,61}[a-z\d])?(\.[a-z\d]([a-z\d\-]{0,61}[‚Äå‚Äãa-z\d])?)*$/i;const isMatch=value.match(pattern);if(isNull_1(isMatch)){result.isValid=false;result.message='"hostname"„Å´Ââá„Å£„Åü„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';return result}break}case"ipv4":{if(!isString_1(value)){return result}const pattern=/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;const isMatch=value.match(pattern);if(isNull_1(isMatch)){result.isValid=false;result.message='"ipv4"„Å´Ââá„Å£„Åü„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';return result}break}case"ipv6":{if(!isString_1(value)){return result}if(value.match(/::/)){let targetColon=7;if(value.match(/((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)){targetColon=6}if(value.match(/^::/)){value=value.replace("::","0::")}if(value.match(/::$/)){value=value.replace("::","::0")}while(value.match(/:/g).length<targetColon){value=value.replace("::",":0::")}value=value.replace("::",":0:")}let patterns=[/^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/,/^([0-9a-fA-F]{1,4}:){6}((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/];let matchResult=false;forEach_1$2(patterns,pattern=>{const isMatch=value.match(pattern);if(!isNull_1(isMatch)){matchResult=true}});if(!matchResult){result.isValid=false;result.message='"ipv6"„Å´Ââá„Å£„Åü„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';return result}break}case"uri":{if(!isString_1(value)){return result}const pattern=rfc3986.uri;const isMatch=value.match(pattern);if(isNull_1(isMatch)){result.isValid=false;result.message='"uri"„Å´Ââá„Å£„Åü„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';return result}break}default:break}return result};var validator={errors:(value,schemaObject)=>{const results=[];if(isUndefined(value)){if(schemaObject.required){return["ÂøÖÈ†àÈ†ÖÁõÆ„Åß„Åô„ÄÇ"]}return results}const result=_type(value,schemaObject);if(!result.isValid){return[result.message]}const type=schemaObject.type;switch(type){case"number":results.push(multipleOf(value,schemaObject));results.push(maximumAndExclusiveMaximum(value,schemaObject));results.push(minimumAndExclusiveMinimum(value,schemaObject));break;case"string":results.push(maxLength(value,schemaObject));results.push(minLength(value,schemaObject));results.push(pattern(value,schemaObject));break;case"array":results.push(additionalItemsAndItems(value,schemaObject));results.push(maxItems(value,schemaObject));results.push(minItems(value,schemaObject));results.push(uniqueItems(value,schemaObject));break;case"object":results.push(maxProperties(value,schemaObject));results.push(minProperties(value,schemaObject));results.push(required(value,schemaObject));results.push(additionalPropertiesAndPropertiesAndPatternProperties(value,schemaObject));results.push(dependencies(value,schemaObject));break;default:break}results.push(_enum(value,schemaObject));results.push(allOf(value,schemaObject));results.push(anyOf(value,schemaObject));results.push(oneOf(value,schemaObject));results.push(not(value,schemaObject));results.push(definitions(value,schemaObject));results.push(format$1(value,schemaObject));return map_1$1(reject_1$1(results,result=>{return result.isValid}),result=>{return result.message})}};var script$23=function(){const formObject=this.opts.formobject;this.title=formObject.name;if(formObject.required){this.title=`${this.title} *`}this.description=formObject.description;this.autocompleteConfig=formObject["x-autocomplete"];this.accept=formObject["x-accept"]||"*";this.mimeType=formObject["x-mime-type"];this.isDisabled=this.opts.isdisabled;if(formObject.readOnly){this.isDisabled=true}this.uiType=(()=>{if(!this.opts.ispreview&&!formObject.readOnly||formObject.type!=="string"||!this.opts.val){return util.getUIType(formObject)}const split=this.opts.val.split(".");if(split.length<2){return util.getUIType(formObject)}const suffix=split[split.length-1];if(contains_1$2(["png","jpg","jpeg","gif"],suffix)){return"image"}return util.getUIType(formObject)})();this.errors=[];this.hasError=false;const validate=()=>{this.errors=validator.errors(this.opts.val,formObject);this.hasError=!!this.errors.length};this.isFocus=false;this.getSelectOptions=(()=>{const options=[];if(isUndefined(this.opts.val)){options.push({label:"-- select an option --",value:undefined,isSelected:true,isDiabled:true})}forEach_1$2(formObject.enum,(v,idx)=>{options.push({id:`select_${idx}`,label:v,value:v,isSelected:v===this.opts.val})});return options});validate();this.on("update",()=>{validate()});const change=value=>{if(!this.opts.onchange){return}this.opts.onchange(this.opts.identifier,value)};this.handleFormFocus=(()=>{this.isFocus=true;this.update()});this.handleFormBlur=(()=>{this.isFocus=false;this.update()});this.handleTextinputChange=(newValue=>{let ret;if(!newValue){ret=undefined}else{ret=newValue}change(ret)});this.handleTextareaChange=(newValue=>{let ret;if(!newValue){ret=undefined}else{ret=newValue}change(ret)});this.handleHtmlChange=(newValue=>{let ret;if(!newValue){ret=undefined}else{ret=newValue}change(ret)});this.handlePugChange=(newValue=>{let ret;if(!newValue){ret=undefined}else{ret=newValue}change(ret)});this.handleNumberinputChange=(newValue=>{let ret;if(!isNumber_1(newValue)){ret=undefined}else{ret=newValue}change(ret)});this.handleCheckboxChange=(isChecked=>{change(isChecked)});this.handleSelectChange=(newOptions=>{const option=find_1$2(newOptions,option=>{return option.isSelected});const value=option?option.label:undefined;change(value)});this.handleUploaderChange=(newFile=>{let ret;if(!newFile){ret=undefined}else{ret=newFile}change(ret)});this.handleBase64Change=(newValue=>{let ret;if(!newValue){ret=undefined}else{ret=newValue}change(ret)});this.handleAutocompleteChange=(newText=>{switch(formObject.type){case"string":if(!newText){newText=undefined}break;case"number":case"integer":newText=Number(newText);if(!isNumber_1(newText)){newText=undefined}break}change(newText)});this.handleWyswygChange=(newValue=>{let ret;if(!newValue){ret=undefined}else{ret=newValue}change(ret)})};riot$1.tag2("viron-parameters-form",'<div class="Parameters_Form__head" if="{uiType !== \'checkbox\'}"> <div class="Parameters_Form__title">{title}</div> <div class="Parameters_Form__description" if="{!!description}">{description}</div> </div> <div class="Parameters_Form__body"> <div class="Parameters_Form__error" if="{hasError &amp;&amp; isFocus}"> <viron-parameters-popover theme="{opts.theme}" ispreview="{opts.ispreview}" message="{errors[0]}"></viron-parameters-popover> </div> <virtual if="{uiType === \'textinput\'}"> <viron-textinput val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handleTextinputChange}" onfocus="{handleFormFocus}" onblur="{handleFormBlur}"></viron-textinput> </virtual> <virtual if="{uiType === \'textarea\'}"> <viron-textarea val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handleTextareaChange}" onfocus="{handleFormFocus}" onblur="{handleFormBlur}"></viron-textarea> </virtual> <virtual if="{uiType === \'numberinput\'}"> <viron-numberinput val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handleNumberinputChange}" onfocus="{handleFormFocus}" onblur="{handleFormBlur}"></viron-numberinput> </virtual> <virtual if="{uiType === \'checkbox\'}"> <viron-checkbox ischecked="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" label="{title}" onchange="{handleCheckboxChange}"></viron-checkbox> </virtual> <virtual if="{uiType === \'select\'}"> <viron-select options="{getSelectOptions()}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handleSelectChange}"></viron-select> </virtual> <virtual if="{uiType === \'uploader\'}"> <viron-uploader accept="{accept}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handleUploaderChange}"></viron-uploader> </virtual> <virtual if="{uiType === \'base64\'}"> <viron-base64 val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" mimetype="{mimeType}" onchange="{handleBase64Change}"></viron-base64> </virtual> <virtual if="{uiType === \'html\'}"> <viron-html val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handleHtmlChange}" onfocus="{handleFormFocus}" onblur="{handleFormBlur}"></viron-html> </virtual> <virtual if="{uiType === \'pug\'}"> <viron-pug val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handlePugChange}" onfocus="{handleFormFocus}" onblur="{handleFormBlur}"></viron-pug> </virtual> <virtual if="{uiType === \'autocomplete\'}"> <viron-autocomplete val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" config="{autocompleteConfig}" onchange="{handleAutocompleteChange}" onfocus="{handleFormFocus}" onblur="{handleFormBlur}"></viron-autocomplete> </virtual> <virtual if="{uiType === \'wyswyg\'}"> <viron-wyswyg val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isDisabled}" iserror="{hasError}" onchange="{handleWyswygChange}"></viron-wyswyg> </virtual> <virtual if="{uiType === \'image\'}"> <viron-image val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview || isDisabled}"></viron-image> </virtual> <virtual if="{uiType === \'null\'}"> <div>TODO</div> </virtual> </div>',"",'class="Parameters_Form"',function(opts){this.external(script$23)});var script$24=function(){const propertiesObject=this.propertiesObject=this.opts.propertiesobject;this.errors=[];this.hasError=false;const validate=()=>{this.errors=validator.errors(this.opts.val,objectAssign({required:this.opts.required},propertiesObject));this.hasError=!!this.errors.length};validate();this.on("update",()=>{validate()});this.isFormMode=(property=>{return contains_1$2(["boolean","integer","number","null","string"],property.type)});this.isPropertiesMode=(property=>{return property.type==="object"});this.isItemsMode=(property=>{return property.type==="array"});this.getVal=(key=>{if(!isObject_1(this.opts.val)){return undefined}return this.opts.val[key]});this.getFormObject=((key,property)=>{const ret=deepClone_1(property);ret.name=key;ret.required=contains_1$2(propertiesObject.required,key);return ret});this.getPropertiesObject=((key,property)=>{const ret=deepClone_1(property);return ret});this.getSchemaObject=((key,property)=>{const ret=deepClone_1(property);return ret});this.getRequired=(key=>{return contains_1$2(propertiesObject.required,key)});this.getSpreadStyle=((key,property)=>{if(contains_1$2(["array","object"],property.type)){return"spreadFull"}const formObject=this.getFormObject(key,property);return util.getSpreadStyle(formObject)});this.handlePropertyChange=((key,newVal)=>{if(!this.opts.onchange){return}let ret=this.opts.val||{};ret[key]=newVal;forOwn_1$2(ret,(val,key)=>{if(isUndefined(val)){delete ret[key]}});if(!size_1(ret)){ret=undefined}this.opts.onchange(this.opts.identifier,ret)})};riot$1.tag2("viron-parameters-properties",'<div class="Parameters_Properties__head"> <div class="Parameters_Properties__label">{opts.label}{opts.required ? \' *\' : \'\'}</div> </div> <div class="Parameters_Properties__error" if="{hasError}">{errors[0]}</div> <div class="Parameters_Properties__body"> <div class="Parameters_Properties__item {\'Parameters_Properties__item--\' + parent.getSpreadStyle(key, property)}" each="{property, key in propertiesObject.properties}"> <virtual if="{isFormMode(property)}"> <viron-parameters-form no-reorder identifier="{key}" val="{parent.getVal(key)}" theme="{parent.opts.theme}" ispreview="{parent.opts.ispreview}" formobject="{parent.getFormObject(key, property)}" onchange="{parent.handlePropertyChange}"></viron-parameters-form> </virtual> <virtual if="{isPropertiesMode(property)}"> <viron-parameters-properties no-reorder label="{key}" identifier="{key}" val="{parent.getVal(key)}" theme="{parent.opts.theme}" ispreview="{parent.opts.ispreview}" required="{parent.getRequired(key)}" propertiesobject="{parent.getPropertiesObject(key, property)}" onchange="{parent.handlePropertyChange}"></viron-parameters-properties> </virtual> <virtual if="{isItemsMode(property)}"> <viron-parameters-items no-reorder label="{key}" identifier="{key}" val="{parent.getVal(key)}" theme="{parent.opts.theme}" ispreview="{parent.opts.ispreview}" required="{parent.getRequired(key)}" schemaobject="{parent.getSchemaObject(key, property)}" onchange="{parent.handlePropertyChange}"></viron-parameters-items> </virtual> </div> </div>',"",'class="Parameters_Properties"',function(opts){this.external(script$24)});function append$1(arr1,arr2){if(arr2==null){return arr1}var pad=arr1.length,i=-1,len=arr2.length;while(++i<len){arr1[pad+i]=arr2[i]}return arr1}var append_1$1=append$1;var keys$2=Object.keys||function(obj){var keys=[];forOwn_1$2(obj,function(val,key){keys.push(key)});return keys};var keys_1$1=keys$2;var script$25=function(){const schemaObject=this.schemaObject=this.opts.schemaobject;const itemsObject=this.opts.schemaobject.items;this.isFormMode=contains_1$2(["boolean","integer","number","null","string"],itemsObject.type);this.isPropertiesMode=itemsObject.type==="object";this.isItemsMode=itemsObject.type==="array";if(this.isFormMode){const formObject=deepClone_1(itemsObject);this.formObject=formObject}if(this.isPropertiesMode){const propertiesObject=deepClone_1(itemsObject);this.propertiesObject=propertiesObject}if(this.isItemsMode){const _itemsObject=deepClone_1(itemsObject.items);this.itemsObject=_itemsObject}this.errors=[];this.hasError=false;const validate=()=>{this.errors=validator.errors(this.opts.val,objectAssign({required:this.opts.required},schemaObject));this.hasError=!!this.errors.length};this.itemsOpened=[];times_1((this.opts.val||[]).length,idx=>{this.itemsOpened[idx]=false});validate();this.on("update",()=>{validate()});this.isItemOpened=(idx=>{return this.itemsOpened[idx]});this.getBriefItemTitle=((val,idx)=>{if(this.isFormMode){switch(this.formObject.type){case"string":return val||"-";case"number":case"integer":return isUndefined(val)?"-":String(val);case"boolean":return isBoolean_1(val)?String(val):"-";case"file":return"file";case"null":return isNull_1(val)?"null":"-";default:return"-"}}if(this.isPropertiesMode){let ret;const properties=this.propertiesObject.properties;const _keys=keys_1$1(properties);forEach_1$2(_keys,key=>{if(!isUndefined(ret)){return}if(isUndefined(val[key])){return}if(isObject_1(val[key])){ret="{Object}"}else if(isArray_1$1(val[key])){ret="[Array]"}else{ret=String(val[key])}});if(!ret){ret="-"}return ret}if(this.isItemsMode){return`[${idx}]`}return"-"});this.getBriefItemDescription=(val=>{if(!this.isPropertiesMode){return"-"}let ret="";const properties=this.propertiesObject.properties;const _keys=keys_1$1(properties);forEach_1$2(_keys,key=>{const k=properties[key].description||key;let v="-";if(!isUndefined(val[key])){if(isObject_1(val[key])){v="{Object}"}else if(isArray_1$1(val[key])){v="[Array]"}else{v=String(val[key])}}ret=`${ret} ${k}:${v}`});return ret});this.handleAddButtonTap=(()=>{if(this.opts.ispreview){return}if(!this.opts.onchange){return}let ret=this.opts.val||[];let newItem=null;if(this.isFormMode){newItem=this.formObject.default}else if(this.isPropertiesMode){newItem=util.generateDefaultProperties(this.propertiesObject)}else if(this.isItemsMode){newItem=[]}ret=append_1$1([newItem],ret);this.itemsOpened=append_1$1([false],this.itemsOpened);this.update();this.opts.onchange(this.opts.identifier,ret)});this.handleOpenAllButtonTap=(()=>{this.itemsOpened=map_1$1(this.itemsOpened,()=>{return true});this.update()});this.handleRemoveButtonTap=(e=>{if(this.opts.ispreview){return}if(!this.opts.onchange){return}const idx=e.item.idx;let ret=this.opts.val;ret.splice(idx,1);if(!ret.length){ret=undefined}this.itemsOpened.splice(idx,1);this.update();this.opts.onchange(this.opts.identifier,ret)});this.handleCloseButtonTap=(e=>{const idx=e.item.idx;this.itemsOpened[idx]=false;this.update()});this.handleItemBriefTap=(e=>{const idx=e.item.idx;this.itemsOpened[idx]=true;this.update()});this.handleItemChange=((idx,newVal)=>{if(!this.opts.onchange){return}const ret=this.opts.val;ret[idx]=newVal;this.opts.onchange(this.opts.identifier,ret)})};riot$1.tag2("viron-parameters-items",'<div class="Parameters_Items__head"> <div class="Parameters_Items__addButton" if="{!opts.ispreview}" onclick="{getClickHandler(\'handleAddButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleAddButtonTap\')}"> <viron-icon-plus></viron-icon-plus> </div> <div class="Parameters_Items__headContent"> <div class="Parameters_Items__label">{opts.label}{opts.required ? \' *\' : \'\'}</div> <div class="Parameters_Items__error" if="{hasError}">{errors[0]}</div> </div> <div class="Parameters_Items__openButton" onclick="{getClickHandler(\'handleOpenAllButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleOpenAllButtonTap\')}">È†ÖÁõÆ„Çí„Åô„Åπ„Å¶Èñã„Åè</div> </div> <div class="Parameters_Items__body" if="{!!opts.val &amp;&amp; !!opts.val.length}"> <div class="Parameters_Items__item {\'Parameters_Items__item--opened\': parent.isItemOpened(idx)}" each="{val, idx in opts.val}"> <div class="Parameters_Items__itemDetail"> <div class="Parameters_Items__itemHead"> <div class="Parameters_Items__removeButton" if="{!parent.opts.ispreview}" onclick="{getClickHandler(\'handleRemoveButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleRemoveButtonTap\')}">„Åì„ÅÆÈ†ÖÁõÆ„ÇíÂâäÈô§</div> </div> <div class="Parameters_Items__itemBody"> <virtual if="{parent.isFormMode}"> <viron-parameters-form no-reorder identifier="{idx}" val="{val}" theme="{parent.opts.theme}" ispreview="{parent.opts.ispreview}" formobject="{parent.formObject}" onchange="{parent.handleItemChange}"></viron-parameters-form> </virtual> <virtual if="{parent.isPropertiesMode}"> <viron-parameters-properties no-reorder label="{parent.opts.label}[{idx}]" identifier="{idx}" val="{val}" theme="{parent.opts.theme}" ispreview="{parent.opts.ispreview}" propertiesobject="{parent.propertiesObject}" onchange="{parent.handleItemChange}"></viron-parameters-properties> </virtual> <virtual if="{parent.isItemsMode}"> <viron-parameters-items no-reorder label="{parent.opts.label}[{idx}]" identifier="{idx}" val="{val}" theme="{parent.opts.theme}" ispreview="{parent.opts.ispreview}" schemaobject="{parent.schemaObject.items}" onchange="{parent.handleItemChange}"></viron-parameters-items> </virtual> </div> <div class="Parameters_Items__itemTail"> <div class="Parameters_Items__removeButton" if="{!parent.opts.ispreview}" onclick="{getClickHandler(\'handleRemoveButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleRemoveButtonTap\')}">„Åì„ÅÆÈ†ÖÁõÆ„ÇíÂâäÈô§</div> <div class="Parameters_Items__closeButton" onclick="{getClickHandler(\'handleCloseButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCloseButtonTap\')}"> <div class="Parameters_Items__closeButtonLabel">„Å®„Åò„Çã</div> <viron-icon-check></viron-icon-check> </div> </div> </div> <div class="Parameters_Items__itemBrief" onclick="{getClickHandler(\'handleItemBriefTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleItemBriefTap\')}"> <div class="Parameters_Items__itemBriefTitle">{parent.getBriefItemTitle(val, idx)}</div> <div class="Parameters_Items__itemBriefDescription" if="{parent.isPropertiesMode}">{parent.getBriefItemDescription(val)}</div> </div> </div> </div>',"",'class="Parameters_Items"',function(opts){this.external(script$25)});var script$26=function(){const parameterObject=this.parameterObject=this.opts.parameterobject;this.isFormMode=false;this.formObject=null;this.isFormDisabled=false;this.isPropertiesMode=false;this.propertiesObject=null;this.propertiesLabel=null;this.isItemsMode=false;this.schemaObject=null;this.itemsLabel=null;this.spreadStyle="spreadSmall";if(contains_1$2(["query","header","path","formData"],parameterObject.in)){if(contains_1$2(["string","number","integer","boolean","file"],parameterObject.type)){this.isFormMode=true;const formObject=deepClone_1(parameterObject);delete formObject.in;this.formObject=formObject;this.spreadStyle=util.getSpreadStyle(formObject);if(parameterObject.in==="path"&&parameterObject.name===this.opts.primary){this.isFormDisabled=true}}else{this.isItemsMode=true;const schemaObject=deepClone_1(parameterObject);this.schemaObject=schemaObject;this.itemsLabel=parameterObject.description||parameterObject.name;this.spreadStyle="spreadFull"}}else{const schema=parameterObject.schema;if(contains_1$2(["boolean","integer","number","null","string"],schema.type)){this.isFormMode=true;const formObject=deepClone_1(parameterObject.schema);this.formObject=formObject;this.spreadStyle=util.getSpreadStyle(formObject)}else if(schema.type==="object"){this.isPropertiesMode=true;const propertiesObject=deepClone_1(schema);this.propertiesObject=propertiesObject;this.propertiesLabel=parameterObject.description||parameterObject.name;this.spreadStyle="spreadFull"}else{this.isItemsMode=true;const schemaObject=deepClone_1(schema);this.schemaObject=schemaObject;this.itemsLabel=parameterObject.description||parameterObject.name;this.spreadStyle="spreadFull"}}this.handleValChange=((key,newVal)=>{if(!this.opts.onchange){return}this.opts.onchange(key,newVal)})};riot$1.tag2("viron-parameters-parameter",'<virtual if="{isFormMode}"> <viron-parameters-form formobject="{formObject}" identifier="{parameterObject.name}" val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" isdisabled="{isFormDisabled}" onchange="{handleValChange}"></viron-parameters-form> </virtual> <virtual if="{isPropertiesMode}"> <viron-parameters-properties label="{propertiesLabel}" identifier="{parameterObject.name}" val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" required="{parameterObject.required}" propertiesobject="{propertiesObject}" onchange="{handleValChange}"></viron-parameters-properties> </virtual> <virtual if="{isItemsMode}"> <viron-parameters-items label="{itemsLabel}" identifier="{parameterObject.name}" val="{opts.val}" theme="{opts.theme}" ispreview="{opts.ispreview}" required="{parameterObject.required}" schemaobject="{schemaObject}" onchange="{handleValChange}"></viron-parameters-items> </virtual>',"","class=\"Parameters_Parameter {'Parameters_Parameter--' + spreadStyle}\"",function(opts){this.external(script$26)});var script$27=function(){this.handleValChange=((key,newVal)=>{if(!this.opts.onchange){return}const ret=this.opts.val;ret[key]=newVal;forOwn_1$2(ret,(val,key)=>{if(isUndefined(val)){delete ret[key]}});this.opts.onchange(ret)})};riot$1.tag2("viron-parameters",'<viron-parameters-parameter each="{parameterObject in opts.parameterobjects}" val="{parent.opts.val[parameterObject.name]}" theme="{parent.opts.theme}" ispreview="{parent.opts.ispreview}" parameterobject="{parameterObject}" primary="{parent.opts.primary}" onchange="{parent.handleValChange}"></viron-parameters-parameter>',"",'class="Parameters"',function(opts){this.external(script$27)});riot$1.tag2("viron-icon-arrow-up",'<svg viewbox="-3494.002 14063 16.002 10.037"> <path d="M1706.943-16726.971l-5.963-5.963-1.433-1.434a.122.122,0,0,1-.019-.021l-.384-.385a.2.2,0,0,1,0-.283l7.8-7.8a.2.2,0,0,1,.281,0l1.84,1.842a.2.2,0,0,1,0,.281l-5.82,5.82,5.82,5.818a.2.2,0,0,1,0,.281l-1.84,1.842a.2.2,0,0,1-.141.059A.2.2,0,0,1,1706.943-16726.971Z" transform="translate(-20220.914 12363.916) rotate(90)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconArrowUp {opts.class}"',function(opts){});riot$1.tag2("viron-icon-down",'<svg viewbox="-9481.5 13487.999 7.4 4.2"> <path d="M.8,5.6a.553.553,0,0,0-.4.9L3.6,9.7a.6.6,0,0,0,.4.1.6.6,0,0,0,.4-.1L7.6,6.5c.2-.3,0-.9-.4-.9Z" transform="translate(-9481.778 13482.399)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconDown {opts.class}"',function(opts){});riot$1.tag2("viron-icon-edit",'<svg viewbox="-3404.002 14060.125 15.979 15.873"> <path d="M1816-16708.127a.946.946,0,0,1-1-1v-12a.946.946,0,0,1,1-1h9.5l-2.6,2.6h-5.3v8.8h8.8v-5.2l2.6-2.6v9.4a.942.942,0,0,1-1,1Zm5.3-5.9c-.1,0-.1,0-.1-.1-.2,0-.2-.1-.2-.1v-1.9c0-.1.1-.2.3-.2a.1.1,0,0,1,.1.1l1.8,1.795c.1.1,0,.2,0,.3l-.1.1Zm2.5-1-1.8-1.9a.189.189,0,0,1,0-.3l4.7-4.7a.2.2,0,0,1,.3,0l1.8,1.8a.189.189,0,0,1,0,.3l-4.7,4.8Zm5.7-5.7-1.8-1.8a.194.194,0,0,1,0-.3l1.1-1.1a.19.19,0,0,1,.3,0l1.8,1.8a.189.189,0,0,1,0,.3l-1.1,1.1a.219.219,0,0,1-.151.072A.219.219,0,0,1,1829.5-16720.723Z" transform="translate(-5219 30784.125)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconEdit {opts.class}"',function(opts){});riot$1.tag2("viron-icon-exclamation-circle",'<svg viewbox="-2882 10816 16 16"> <g transform="translate(-3247 10632.5)"> <g transform="translate(365 183.5)"> <circle cx="8" cy="8" r="8"></circle> <circle cx="8" cy="8" r="7.25"></circle> </g> <g transform="translate(9.621 -0.445)"> <rect width="5" height="2" rx="0.4" transform="translate(362.379 192.945) rotate(-90)"></rect> <rect width="2" height="2" rx="0.4" transform="translate(362.379 195.945) rotate(-90)"></rect> </g> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconExclamationCircle {opts.class}"',function(opts){});riot$1.tag2("viron-icon-logo",'<svg viewbox="0 0 200 184.62"> <path class="IconLogo__right" d="M200,43a43,43,0,0,0-80.28-21.5L63.87,118.26a43,43,0,1,0,73.38,44.85l.06,0,56.93-98.61h0A42.77,42.77,0,0,0,200,43Z"></path> <path class="IconLogo__left" d="M100,55.63l0,.06L80.28,21.53a43,43,0,1,0-74.5,43h0L62.7,163.16l.06,0a43,43,0,0,0,74.49,0l.06,0,12.4-21.48Z"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconLogo {opts.class}"',function(opts){});riot$1.tag2("viron-icon-menu",'<svg viewbox="-3635 13999.001 24 9.4"> <g transform="translate(-3357.6 14031.401) rotate(180)"> <rect width="16" height="3" rx="0.4" transform="translate(261.4 29.4)"></rect> <rect width="16" height="3" rx="0.4" transform="translate(253.4 23)"></rect> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconMenu {opts.class}"',function(opts){});riot$1.tag2("viron-icon-menu-invert",'<svg viewbox="-3595 13999.001 24 9.4"> <g transform="translate(-3317.6 14031.401) rotate(180)"> <rect width="16" height="3" rx="0.4" transform="translate(253.4 29.4)"></rect> <rect class="cls-1" width="16" height="3" rx="0.4" transform="translate(261.4 23)"></rect> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconMenuInvert {opts.class}"',function(opts){});riot$1.tag2("viron-icon-move",'<svg viewbox="-1076 13435 16 16"> <path d="M15.83,7.6,13.545,5.317a.571.571,0,0,0-.973.4V6.862H9.143V3.434h1.143a.568.568,0,0,0,.4-.973L8.4.175a.561.561,0,0,0-.8,0L5.312,2.46a.571.571,0,0,0,.4.973H6.857V6.862H3.429V5.719a.568.568,0,0,0-.973-.4L.17,7.6a.561.561,0,0,0,0,.8l2.286,2.286a.572.572,0,0,0,.973-.4V9.148H6.857v3.429H5.714a.568.568,0,0,0-.4.973L7.6,15.835a.561.561,0,0,0,.8,0l2.286-2.286a.572.572,0,0,0-.4-.973H9.143V9.148h3.429v1.143a.568.568,0,0,0,.973.4L15.83,8.407a.561.561,0,0,0,0-.8Z" transform="translate(-1076 13434.995)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconMove {opts.class}"',function(opts){});riot$1.tag2("viron-icon-plus-circle",'<svg viewbox="-2912 10816 16 16"> <g transform="translate(-3277 10632.5)"> <g transform="translate(365 183.5)"> <circle cx="8" cy="8" r="8"></circle> <circle cx="8" cy="8" r="7.25"></circle> </g> <g transform="translate(9.621 -0.445)"> <rect width="8" height="2" rx="0.4" transform="translate(367.379 192.945) rotate(180)"></rect> <rect width="8" height="2" rx="0.4" transform="translate(362.379 195.945) rotate(-90)"></rect> </g> </g> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconPlusCircle {opts.class}"',function(opts){});riot$1.tag2("viron-icon-square",'<svg viewbox="-3674 14061 15.998 13.998"> <path d="M1869-16726h-14a1,1,0,0,1-1-1v-12a1,1,0,0,1,1-1h14a1,1,0,0,1,1,1v12A1,1,0,0,1,1869-16726Zm-12-11v8h10v-8Z" transform="translate(-5528 30801)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconSquare {opts.class}"',function(opts){});riot$1.tag2("viron-icon-star",'<svg viewbox="-1994 12644 16 15.329"> <path d="M15.652,7.994a1.148,1.148,0,0,0-.636-1.957l-3.874-.563A.506.506,0,0,1,10.76,5.2L9.028,1.686a1.147,1.147,0,0,0-2.058,0L5.238,5.2a.507.507,0,0,1-.382.277L.983,6.037A1.148,1.148,0,0,0,.346,7.994l2.8,2.732a.507.507,0,0,1,.146.449l-.661,3.858a1.123,1.123,0,0,0,.25.93,1.159,1.159,0,0,0,1.414.279l3.465-1.822a.519.519,0,0,1,.472,0L11.7,16.242a1.136,1.136,0,0,0,.534.134,1.151,1.151,0,0,0,.88-.413,1.123,1.123,0,0,0,.25-.93L12.7,11.175a.507.507,0,0,1,.146-.449Z" transform="translate(-1993.999 12642.953)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconStar {opts.class}"',function(opts){});riot$1.tag2("viron-icon-up",'<svg viewbox="-9451.9 13487.801 7.4 4.2"> <path d="M.8,5.6a.553.553,0,0,0-.4.9L3.6,9.7a.6.6,0,0,0,.4.1.6.6,0,0,0,.4-.1L7.6,6.5c.2-.3,0-.9-.4-.9Z" transform="translate(-9444.222 13497.601) rotate(180)"></path> </svg> <div class="Icon__catcher" if="{!opts.nocatcher}"></div>',"",'class="icon Icon IconUp {opts.class}"',function(opts){});var script$29=function(){this.handlePositiveSelect=(()=>{this.close();if(!this.opts.onPositiveSelect){return}this.opts.onPositiveSelect()});this.handleNegativeSelect=(()=>{this.close();if(!this.opts.onNegativeSelect){return}this.opts.onNegativSselect()})};riot$1.tag2("viron-dialog",'<div class="Dialog__icon" if="{!!opts.icon}"> <div data-is="viron-icon-{opts.icon}"></div> </div> <div class="Dialog__title" if="{!!opts.title}">{opts.title}</div> <div class="Dialog__message" if="{!!opts.message}">{opts.message}</div> <div class="Dialog__control"> <viron-button label="{opts.labelPositive || \'OK\'}" onselect="{handlePositiveSelect}"></viron-button> <viron-button label="{opts.labelNegative || \'„Ç≠„É£„É≥„Çª„É´\'}" theme="ghost" onselect="{handleNegativeSelect}"></viron-button> </div>',"",'class="Dialog"',function(opts){this.external(script$29)});var script$28=function(){const store=this.riotx.get();const operationObject=this.opts.operationObject;this.layoutType=store.getter("layout.type");this.val=util.generateInitialVal(operationObject.parameters,this.opts.initialVal);this.title=operationObject.summary||operationObject.operationId;this.submitLabel=null;this.submitModifier=null;let successMessage=null;const method=store.getter("oas.pathItemObjectMethodNameByOperationId",operationObject.operationId);switch(method){case"get":this.submitLabel="ÂèñÂæó„Åô„Çã";this.successMessage="ÂèñÂæó„Åó„Åæ„Åó„Åü„ÄÇ";break;case"post":this.submitLabel="Êñ∞Ë¶è‰ΩúÊàê„Åô„Çã";successMessage="Êñ∞Ë¶è‰ΩúÊàê„Åó„Åæ„Åó„Åü„ÄÇ";break;case"put":this.submitLabel="‰øùÂ≠ò„Åô„Çã";successMessage="‰øùÂ≠ò„Åó„Åæ„Åó„Åü„ÄÇ";break;case"delete":this.submitLabel="ÂâäÈô§„Åô„Çã";this.submitModifier="emphasised";successMessage="ÂâäÈô§„Åó„Åæ„Åó„Åü„ÄÇ";break;default:this.submitLabel="ÂÆüË°å„Åô„Çã";successMessage="ÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ";break}const operate=()=>{Promise.resolve().then(()=>store.action("components.operate",operationObject,this.val)).then(()=>{this.close();this.opts.onSuccess();return store.action("toasts.add",{message:successMessage})}).catch(err=>{if(err.status===401){return store.action("modals.add","viron-error",{title:"Ë™çË®ºÂàá„Çå"}).then(()=>{this.getRouter().navigateTo("/")})}return store.action("modals.add","viron-error",{error:err})})};this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.update()});this.handleCancelTap=(()=>{this.close()});this.handleParametersChange=(newValue=>{this.val=newValue;this.update()});this.handleSubmitTap=(()=>{Promise.resolve().then(()=>store.action("modals.add","viron-dialog",{title:this.title,message:"Êú¨ÂΩì„Å´ÂÆüË°å„Åó„Åæ„Åô„ÅãÔºü",labelPositive:this.submitLabel,onPositiveSelect:()=>{operate()}}))})};riot$1.tag2("viron-components-page-operation",'<div class="ComponentsPage_Operation__head"> <div class="ComponentsPage_Operation__title">{title}</div> <div class="ComponentsPage_Operation__cancel" onclick="{getClickHandler(\'handleCancelTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCancelTap\')}">„Ç≠„É£„É≥„Çª„É´</div> </div> <div class="ComponentsPage_Operation__body"> <viron-parameters val="{val}" parameterobjects="{opts.operationObject.parameters}" primary="{opts.primary}" onchange="{handleParametersChange}"></viron-parameters> </div> <div class="ComponentsPage_Operation__tail"> <div class="ComponentsPage_Operation__submit ComponentsPage_Operation__submit--{submitModifier}" onclick="{getClickHandler(\'handleSubmitTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleSubmitTap\')}">{submitLabel}</div> </div>',"",'class="ComponentsPage_Operation ComponentsPage_Operation--{layoutType}"',function(opts){this.external(script$28)});var script$31=function(){this.list=this.opts.list||[];this.size=this.opts.size||this.list.length;if(this.size>this.list.length){this.size=this.list.length}const itemHeight=50;this.bodyHeight=itemHeight*this.size;this.bodyTop=0;this.hasControlButtons=this.list.length>this.size;this.currentIdx=0;this.maxIdx=this.list.length-this.size;this.handlePrevItemTap=(()=>{this.currentIdx=this.currentIdx-1;if(this.currentIdx<0){this.currentIdx=0}this.bodyTop=this.currentIdx*itemHeight;this.update()});this.handleNextItemTap=(()=>{this.currentIdx=this.currentIdx+1;if(this.currentIdx>this.maxIdx){this.currentIdx=this.maxIdx}this.bodyTop=this.currentIdx*itemHeight;this.update()});this.handleItemTap=(e=>{if(!this.opts.onselect){return}const id=e.item.item.id;this.opts.onselect(id)})};riot$1.tag2("viron-list",'<div class="List__item" if="{hasControlButtons}" onclick="{getClickHandler(\'handlePrevItemTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePrevItemTap\')}"> <viron-icon-up class="List__icon"></viron-icon-up> <div class="List__label">Êàª„Çã</div> </div> <div class="List__body" riot-style="height:{bodyHeight}px;"> <div class="List__itemsWrapper" riot-style="top:-{bodyTop}px;"> <div class="List__item" each="{item in list}" onclick="{getClickHandler(\'handleItemTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleItemTap\')}"> <div class="List__label">{item.label}</div> </div> </div> </div> <div class="List__item" if="{hasControlButtons}" onclick="{getClickHandler(\'handleNextItemTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleNextItemTap\')}"> <viron-icon-down class="List__icon"></viron-icon-down> <div class="List__label">„Åï„Çâ„Å´Ë°®Á§∫</div> </div>',"",'class="List"',function(opts){this.external(script$31)});var script$32=function(){this.list=map_1$1(this.opts.operations,operation=>{return{id:operation.operationId,label:operation.summary||operation.operationId}});this.handleItemSelect=(operationId=>{this.close();const operationObject=find_1$2(this.opts.operations,operation=>{return operation.operationId===operationId});this.opts.onSelect(operationObject)})};riot$1.tag2("viron-components-page-table-operations",'<viron-list list="{list}" size="{5}" onselect="{handleItemSelect}"></viron-list>',"",'class="ComponentsPage_Card_Table_Operations"',function(opts){this.external(script$32)});var script$30=function(){const store=this.riotx.get();const dataList=this.opts.dataList;const initialSelectedIdx=this.opts.selectedIdx;this.layoutType=store.getter("layout.type");this.parameterObjects=this.opts.parameterObjects;this.operations=this.opts.operations||[];this.val=null;this.selectedIdx=null;this.isPrevButtonDisabled=false;this.isNextButtonDisabled=false;const changeData=idx=>{this.val=util.generateInitialVal(this.parameterObjects,dataList[idx]);this.selectedIdx=idx;this.isPrevButtonDisabled=idx===0;this.isNextButtonDisabled=idx===dataList.length-1};changeData(initialSelectedIdx);this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.update()});this.handleOperationsButtonTap=(e=>{const rect=e.currentTarget.getBoundingClientRect();store.action("popovers.add","viron-components-page-table-operations",{operations:this.operations,onSelect:operationObject=>{this.opts.onOperationSelect(operationObject,this.selectedIdx);this.close()}},{x:rect.left+rect.width/2,y:rect.bottom,width:240,direction:"TR"})});this.handleBackButtonTap=(()=>{this.close()});this.handlePrevButtonTap=(()=>{if(this.isPrevButtonDisabled){return}changeData(this.selectedIdx-1);this.update()});this.handleNextButtonTap=(()=>{if(this.isNextButtonDisabled){return}changeData(this.selectedIdx+1);this.update()})};riot$1.tag2("viron-components-page-preview",'<div class="ComponentsPage_Preview__head"> <div class="ComponentsPage_Preview__title">„Éó„É¨„Éì„É•„Éº</div> <div class="ComponentsPage_Preview__operationsButton" if="{!!this.operations.length}" onclick="{getClickHandler(\'handleOperationsButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleOperationsButtonTap\')}"> <viron-icon-setting></viron-icon-setting> </div> <div class="ComponentsPage_Preview__backButton" onclick="{getClickHandler(\'handleBackButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleBackButtonTap\')}"> <viron-icon-arrow-left></viron-icon-arrow-left> </div> </div> <div class="ComponentsPage_Preview__body"> <viron-parameters val="{val}" ispreview="{true}" parameterobjects="{parameterObjects}"></viron-parameters> </div> <div class="ComponentsPage_Preview__tail"> <div class="ComponentsPage_Preview__prevButton {\'ComponentsPage_Preview__prevButton--disabled\': isPrevButtonDisabled}" onclick="{getClickHandler(\'handlePrevButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePrevButtonTap\')}"> <viron-icon-arrow-up></viron-icon-arrow-up> </div> <div class="ComponentsPage_Preview__nextButton {\'ComponentsPage_Preview__prevButton--disabled\': isNextButtonDisabled}" onclick="{getClickHandler(\'handleNextButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleNextButtonTap\')}"> <viron-icon-arrow-down></viron-icon-arrow-down> </div> </div>',"",'class="ComponentsPage_Preview ComponentsPage_Preview--{layoutType}"',function(opts){this.external(script$30)});var script$33=function(){const store=this.riotx.get();this.layoutType=store.getter("layout.type");this.val=util.generateInitialVal(this.opts.parameterObjects,this.opts.initialVal);this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.update()});this.handleCloseButtonTap=(()=>{this.close()});this.handleParametersChange=(newValue=>{this.val=newValue;this.update()});this.handleSearchButtonTap=(()=>{if(!this.opts.onSearch){this.close();return}this.opts.onSearch(this.val);this.close()})};riot$1.tag2("viron-components-page-search",'<div class="ComponentsPage_Search__head"> <div class="ComponentsPage_Search__closeButton" onclick="{getClickHandler(\'handleCloseButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCloseButtonTap\')}"> <viron-icon-close></viron-icon-close> </div> <div class="ComponentsPage_Search__title">Ê§úÁ¥¢</div> <div class="ComponentsPage_Search__description">„ÇØ„Ç®„É™„Éë„É©„É°„Éº„Çø„ÇíÊåáÂÆö„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ</div> </div> <div class="ComponentsPage_Search__body"> <viron-parameters val="{val}" theme="ghost" parameterobjects="{opts.parameterObjects}" onchange="{handleParametersChange}"></viron-parameters> </div> <div class="ComponentsPage_Search__tail"> <viron-button label="Ê§úÁ¥¢„Åô„Çã" onselect="{handleSearchButtonTap}"></viron-button> </div>',"",'class="ComponentsPage_Search ComponentsPage_Search--{layoutType}"',function(opts){this.external(script$33)});var script$6=function(){const store=this.riotx.get();const getData=pagination=>{if(!pagination&&this.hasPagination){pagination={};const size=this.pagination.size;const current=this.pagination.current;pagination.limit=size;pagination.offset=(current-1)*size}const queries=objectAssign({},this.searchQueries,pagination);return Promise.resolve().then(()=>{this.isLoading=true;this.update()}).then(()=>Promise.all([new Promise(resolve=>setTimeout(resolve,300)),store.action("components.get",this.opts.id,this.opts.def,queries)])).then(()=>{this.isLoading=false;this.update()}).catch(err=>{this.isLoading=false;if(err.status===401){this.error="Ë™çË®º„Ç®„É©„Éº„ÄÇ"}else{const api=this.opts.def.api;this.error=`[${api.method.toUpperCase()} ${api.path}]ÈÄö‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ`}this.update()})};const validate=data=>{if(!data){return"TODO: „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏"}if(!isArray_1$1(data)){return"TODO: „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏"}if(!data.length){return"0‰ª∂"}if(!isObject_1(data[0])){return"TODO: „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏"}return null};const createInitialValueAndOpenOperationDrawer=(operationObject,rowData)=>{const initialVal={};forEach_1$2(operationObject.parameters||[],parameterObject=>{const name=parameterObject.name;const _in=parameterObject.in;if(_in==="body"){initialVal[name]={};forOwn_1$2(parameterObject.schema.properties||{},(val,key)=>{if(!isUndefined(rowData[key])&&!isNull_1(rowData[key])){initialVal[name][key]=rowData[key]}})}else{if(!isUndefined(rowData[name])&&!isNull_1(rowData[name])){initialVal[name]=rowData[name]}}});openOperationDrawer(operationObject,deepClone_1(initialVal))};const openOperationDrawer=(operationObject,initialVal)=>{store.action("drawers.add","viron-components-page-operation",{operationObject:operationObject,initialVal:initialVal,primary:this.primary,onSuccess:()=>{getData()}})};this.data=null;this.columns=[];this.visibleColumnKeys=null;this.tableOperations=[];this.rowOperations=[];this.postOperation=null;this.searchParameters=[];this.primary=null;this.isLoading=true;this.error=null;this.hasPagination=false;this.pagination=null;this.paginationSize=store.getter("layout.isDesktop")?5:3;this.searchQueries={};forOwn_1$2(this.opts.crosssearchqueries,(value,key)=>{if(!isUndefined(value)){this.searchQueries[key]=value}});this.hasSearchQueries=!!size_1(this.searchQueries);this.autoRefreshSec=null;let autoRefreshIntervalId=null;const activateAutoRefresh=()=>{if(!this.autoRefreshSec){return}if(autoRefreshIntervalId){return}autoRefreshIntervalId=window.setInterval(()=>{getData()},this.autoRefreshSec*1e3)};const inactivateAutoRefresh=()=>{window.clearInterval(autoRefreshIntervalId);autoRefreshIntervalId=null};this.listen("layout",()=>{this.paginationSize=store.getter("layout.isDesktop")?5:3;this.update()});this.listen(this.opts.id,()=>{this.data=store.getter("components.response",this.opts.id);this.columns=store.getter("components.columns",this.opts.id);this.tableOperations=store.getter("components.operations",this.opts.id,"table");this.rowOperations=store.getter("components.operations",this.opts.id,"row");this.postOperation=store.getter("components.postOperation",this.opts.id,"table");this.searchParameters=store.getter("components.searchParameters",this.opts.id);this.primary=store.getter("components.primary",this.opts.id);this.error=validate(this.data);this.hasPagination=store.getter("components.hasPagination",this.opts.id);this.pagination=store.getter("components.pagination",this.opts.id);this.autoRefreshSec=store.getter("components.autoRefreshSec",this.opts.id);activateAutoRefresh();this.update()});this.getFilteredColumns=(()=>{if(!this.visibleColumnKeys){return this.columns}return filter_1$1(this.columns,column=>{return contains_1$2(this.visibleColumnKeys,column.key)})});let prevCrossSearchQueries=objectAssign(this.opts.crosssearchqueries);this.on("mount",()=>{getData()}).on("updated",()=>{const newCrossSearchQueries=this.opts.crosssearchqueries;let isCrossSearchQueriesChanged=false;forOwn_1$2(newCrossSearchQueries,(value,key)=>{if(value!==prevCrossSearchQueries[key]){isCrossSearchQueriesChanged=true}});if(size_1(newCrossSearchQueries)!==size_1(prevCrossSearchQueries)){isCrossSearchQueriesChanged=true}if(isCrossSearchQueriesChanged){forOwn_1$2(newCrossSearchQueries,(value,key)=>{if(!isUndefined(value)){this.searchQueries[key]=value}else{delete this.searchQueries[key]}});this.hasSearchQueries=!!size_1(this.searchQueries);getData()}prevCrossSearchQueries=objectAssign({},this.opts.crosssearchqueries)}).on("unmount",()=>{inactivateAutoRefresh();store.action("components.remove",this.opts.id)});this.handlePostButtonTap=(()=>{openOperationDrawer(this.postOperation)});this.handleSearchButtonTap=(()=>{store.action("drawers.add","viron-components-page-search",{parameterObjects:this.searchParameters,initialVal:this.searchQueries,onSearch:newSearchQueries=>{this.searchQueries=newSearchQueries;this.hasSearchQueries=!!size_1(newSearchQueries);getData()}},{isNarrow:true})});this.handleFilterButtonTap=(()=>{store.action("drawers.add","viron-components-page-filter",{columns:this.columns,selectedColumnKeys:this.visibleColumnKeys,onChange:newSelectedColumnKeys=>{this.visibleColumnKeys=newSelectedColumnKeys;getData()}},{isNarrow:true})});this.handleReloadButtonTap=(()=>{getData()});this.handleSettingButtonTap=(()=>{const rect=this.refs.settingIcon.root.getBoundingClientRect();store.action("popovers.add","viron-components-page-table-operations",{operations:this.tableOperations,onSelect:operationObject=>{openOperationDrawer(operationObject)}},{x:rect.left+rect.width/2,y:rect.bottom,width:240,direction:"TR"})});this.handleRowTap=(e=>{const name="preview";const properties={};forEach_1$2(this.columns,column=>{const property=deepClone_1(column);const key=property.key;delete property.key;properties[key]=property});const parameterObjects=[{in:"body",name:name,schema:{type:"object",properties:properties}}];const dataList=[];forEach_1$2(this.data,data=>{const d={};d[name]=deepClone_1(data);dataList.push(d)});store.action("drawers.add","viron-components-page-preview",{parameterObjects:parameterObjects,dataList:dataList,selectedIdx:e.item.idx,operations:this.rowOperations,onOperationSelect:(operationObject,dataListIdx)=>{createInitialValueAndOpenOperationDrawer(operationObject,this.data[dataListIdx])}})});this.handleRowSettingButtonTap=(e=>{e.stopPropagation();const rowData=e.item.row;const rect=e.currentTarget.getBoundingClientRect();store.action("popovers.add","viron-components-page-table-operations",{operations:this.rowOperations,onSelect:operationObject=>{createInitialValueAndOpenOperationDrawer(operationObject,rowData)}},{x:rect.left+rect.width/2,y:rect.bottom,width:240,direction:"TR"})});this.handlePaginationChange=(newPage=>{const size=this.pagination.size;getData({limit:size,offset:(newPage-1)*size})})};riot$1.tag2("viron-components-page-table",'<div class="ComponentsPage_Card_Table__head"> <div class="ComponentsPage_Card_Table__headAside"> <div class="ComponentsPage_Card_Table__postOperation" if="{postOperation}" onclick="{getClickHandler(\'handlePostButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePostButtonTap\')}"> <viron-icon-plus></viron-icon-plus> </div> <div class="ComponentsPage_Card_Table__title">{opts.def.name}</div> </div> <div class="ComponentsPage_Card_Table__headAside"> <div class="ComponentsPage_Card_Table__control"> <viron-icon-search class="ComponentsPage_Card_Table__searchIcon {\'ComponentsPage_Card_Table__searchIcon--active\': hasSearchQueries}" if="{searchParameters.length}" onclick="{getClickHandler(\'handleSearchButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleSearchButtonTap\')}"></viron-icon-search> <viron-icon-filter class="ComponentsPage_Card_Table__filterIcon {\'ComponentsPage_Card_Table__filterIcon--active\': !!visibleColumnKeys}" onclick="{getClickHandler(\'handleFilterButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleFilterButtonTap\')}"></viron-icon-filter> <viron-icon-reload onclick="{getClickHandler(\'handleReloadButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleReloadButtonTap\')}"></viron-icon-reload> <viron-icon-setting if="{tableOperations.length}" ref="settingIcon" onclick="{getClickHandler(\'handleSettingButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleSettingButtonTap\')}"></viron-icon-setting> </div> </div> </div> <div class="ComponentsPage_Card_Table__body"> <virtual if="{isLoading}"> <div class="ComponentsPage_Card_Table__progressWrapper"> <div class="ComponentsPage_Card_Table__progress"> <viron-icon-reload></viron-icon-reload> </div> </div> </virtual> <virtual if="{!isLoading}"> <virtual if="{!!error}"> <div class="ComponentsPage_Card_Table__errorWrapper"> <div class="ComponentsPage_Card_Table__error">{error}</div> </div> </virtual> <virtual if="{!error}"> <div class="ComponentsPage_Card_Table__tableWrapper"> <table class="ComponentsPage_Card_Table__table"> <thead class="ComponentsPage_Card_Table__thead"> <tr class="ComponentsPage_Card_Table__theadRow"> <th class="ComponentsPage_Card_Table__th" each="{column in getFilteredColumns()}">{column.description || column.key}</th> <th class="ComponentsPage_Card_Table__th ComponentsPage_Card_Table__th--sticky" if="{rowOperations.length}">Êìç‰Ωú</th> </tr> </thead> <tbody class="ComponentsPage_Card_Table__tbody"> <tr class="ComponentsPage_Card_Table__tbodyRow" each="{row, idx in data}" onclick="{getClickHandler(\'handleRowTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleRowTap\')}"> <td each="{column in parent.getFilteredColumns()}" data-is="viron-components-page-table-cell" data="{row[column.key]}" column="{column}"></td> <td class="ComponentsPage_Card_Table__td ComponentsPage_Card_Table__td--sticky" if="{rowOperations.length}"> <viron-icon-setting ref="rowSettingIcon" onclick="{getClickHandler(\'handleRowSettingButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleRowSettingButtonTap\')}"></viron-icon-setting> </td> </tr> </tbody> </table> </div> </virtual> </virtual> </div> <div class="ComponentsPage_Card_Table__tail" if="{hasPagination}"> <viron-pagination max="{pagination.max}" size="{paginationSize}" current="{pagination.current}" onchange="{handlePaginationChange}"></viron-pagination> </div> <div class="ComponentsPage_Card_Table__blocker" if="{isLoading}"></div>',"",'class="ComponentsPage_Card_Table"',function(opts){this.external(script$6)});var script$34=function(){this.componentId=getComponentStateName(this._riot_id);this.cardType=null;this.columnSize="columnSpreadSmall";this.rowSize="rowSpreadSmall";switch(this.opts.def.style){case"chart":this.cardType="chart";this.columnSize="columnSpreadSmall";this.rowSize="rowSpreadMedium";break;case"table":this.cardType="table";this.columnSize="columnSpreadFull";this.rowSize="rowSpreadLarge";break;case"number":this.cardType="number";this.columnSize="columnSpreadSmall";this.rowSize="rowSpreadSmall";break;default:break}};riot$1.tag2("viron-components-page-card",'<div data-is="viron-components-page-{cardType}" id="{componentId}" def="{opts.def}" crosssearchqueries="{opts.crosssearchqueries}"></div>',"",'class="ComponentsPage_Card ComponentsPage_Card--{columnSize} ComponentsPage_Card--{rowSize}"',function(opts){this.external(script$34)});var script$35=function(){const store=this.riotx.get();this.name=store.getter("page.name");this.components=store.getter("page.components");this.layoutType=store.getter("layout.type");this.isDesktop=store.getter("layout.isDesktop");this.parameterObjectsForCrossSearch=store.getter("components.parameterObjectsForCrossSearch");this.isCrossSearchEnabled=this.parameterObjectsForCrossSearch.length>=2;this.crossSearchQueries={};this.hasCrossSearchQueries=false;this.listen("page",()=>{this.name=store.getter("page.name");this.components=store.getter("page.components");this.crossSearchQueries={};this.hasCrossSearchQueries=false;this.update()});this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.isDesktop=store.getter("layout.isDesktop");this.update()});this.listen("components",()=>{this.parameterObjectsForCrossSearch=store.getter("components.parameterObjectsForCrossSearch");this.isCrossSearchEnabled=this.parameterObjectsForCrossSearch.length>=2;this.update()});this.getCrossSearchQueriesByDef=(def=>{const ret={};forEach_1$2(def.query,query=>{ret[query.key]=this.crossSearchQueries[query.key]});return ret});this.handleCrossSearchTap=(()=>{store.action("drawers.add","viron-components-page-search",{parameterObjects:this.parameterObjectsForCrossSearch,initialVal:this.crossSearchQueries,onSearch:newSearchQueries=>{this.crossSearchQueries=newSearchQueries;this.hasCrossSearchQueries=!!size_1(newSearchQueries);this.update()}},{isNarrow:true})})};riot$1.tag2("viron-components-page",'<div class="ComponentsPage__head"> <div class="ComponentsPage__name">{name}</div> <div class="ComponentsPage__control" if="{isDesktop}"> <div class="ComponentsPage__crossSearch {\'ComponentsPage__crossSearch--active\': hasCrossSearchQueries}" if="{isCrossSearchEnabled}" onclick="{getClickHandler(\'handleCrossSearchTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCrossSearchTap\')}"> <viron-icon-search></viron-icon-search> <div>ÂÖ®‰ΩìÊ§úÁ¥¢</div> </div> </div> </div> <div class="ComponentsPage__container"> <viron-components-page-card each="{component in components}" def="{component}" crosssearchqueries="{parent.getCrossSearchQueriesByDef(component)}"></viron-components-page-card> </div>',"",'class="ComponentsPage ComponentsPage--{layoutType}"',function(opts){this.external(script$35)});var script$36=function(){};riot$1.tag2("viron-tag",'<div class="Tag__label">{opts.label}</div>',"",'class="Tag"',function(opts){this.external(script$36)});var qrious=createCommonjsModule(function(module,exports){(function(global,factory){module.exports=factory()})(commonjsGlobal,function(){"use strict";var Constructor=function(){};var hasOwnProperty=Object.prototype.hasOwnProperty;var slice=Array.prototype.slice;function createObject(prototype,properties){var result;if(typeof Object.create==="function"){result=Object.create(prototype)}else{Constructor.prototype=prototype;result=new Constructor;Constructor.prototype=null}if(properties){extendObject(true,result,properties)}return result}function extend(name,constructor,prototype,statics){var superConstructor=this;if(typeof name!=="string"){statics=prototype;prototype=constructor;constructor=name;name=null}if(typeof constructor!=="function"){statics=prototype;prototype=constructor;constructor=function(){return superConstructor.apply(this,arguments)}}extendObject(false,constructor,superConstructor,statics);constructor.prototype=createObject(superConstructor.prototype,prototype);constructor.prototype.constructor=constructor;constructor.class_=name||superConstructor.class_;constructor.super_=superConstructor;return constructor}function extendObject(own,target,sources){sources=slice.call(arguments,2);var property;var source;for(var i=0,length=sources.length;i<length;i++){source=sources[i];for(property in source){if(!own||hasOwnProperty.call(source,property)){target[property]=source[property]}}}}var extend_1=extend;function Nevis(){}Nevis.class_="Nevis";Nevis.super_=Object;Nevis.extend=extend_1;var nevis=Nevis;var lite=nevis;var Renderer=lite.extend(function(qrious,element,enabled){this.qrious=qrious;this.element=element;this.element.qrious=qrious;this.enabled=Boolean(enabled)},{draw:function(frame){},getElement:function(){if(!this.enabled){this.enabled=true;this.render()}return this.element},getModuleSize:function(frame){var qrious=this.qrious;var padding=qrious.padding||0;var pixels=Math.floor((qrious.size-padding*2)/frame.width);return Math.max(1,pixels)},getOffset:function(frame){var qrious=this.qrious;var padding=qrious.padding;if(padding!=null){return padding}var moduleSize=this.getModuleSize(frame);var offset=Math.floor((qrious.size-moduleSize*frame.width)/2);return Math.max(0,offset)},render:function(frame){if(this.enabled){this.resize();this.reset();this.draw(frame)}},reset:function(){},resize:function(){}});var Renderer_1=Renderer;var CanvasRenderer=Renderer_1.extend({draw:function(frame){var i,j;var qrious=this.qrious;var moduleSize=this.getModuleSize(frame);var offset=this.getOffset(frame);var context=this.element.getContext("2d");context.fillStyle=qrious.foreground;context.globalAlpha=qrious.foregroundAlpha;for(i=0;i<frame.width;i++){for(j=0;j<frame.width;j++){if(frame.buffer[j*frame.width+i]){context.fillRect(moduleSize*i+offset,moduleSize*j+offset,moduleSize,moduleSize)}}}},reset:function(){var qrious=this.qrious;var context=this.element.getContext("2d");var size=qrious.size;context.lineWidth=1;context.clearRect(0,0,size,size);context.fillStyle=qrious.background;context.globalAlpha=qrious.backgroundAlpha;context.fillRect(0,0,size,size)},resize:function(){var element=this.element;element.width=element.height=this.qrious.size}});var CanvasRenderer_1=CanvasRenderer;var Alignment=lite.extend(null,{BLOCK:[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28]});var Alignment_1=Alignment;var ErrorCorrection=lite.extend(null,{BLOCKS:[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],FINAL_FORMAT:[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],LEVELS:{L:1,M:2,Q:3,H:4}});var ErrorCorrection_1=ErrorCorrection;var Galois=lite.extend(null,{EXPONENT:[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],LOG:[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175]});var Galois_1=Galois;var Version=lite.extend(null,{BLOCK:[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177]});var Version_1=Version;var Frame=lite.extend(function(options){var dataBlock,eccBlock,index,neccBlock1,neccBlock2;var valueLength=options.value.length;this._badness=[];this._level=ErrorCorrection_1.LEVELS[options.level];this._polynomial=[];this._value=options.value;this._version=0;this._stringBuffer=[];while(this._version<40){this._version++;index=(this._level-1)*4+(this._version-1)*16;neccBlock1=ErrorCorrection_1.BLOCKS[index++];neccBlock2=ErrorCorrection_1.BLOCKS[index++];dataBlock=ErrorCorrection_1.BLOCKS[index++];eccBlock=ErrorCorrection_1.BLOCKS[index];index=dataBlock*(neccBlock1+neccBlock2)+neccBlock2-3+(this._version<=9);if(valueLength<=index){break}}this._dataBlock=dataBlock;this._eccBlock=eccBlock;this._neccBlock1=neccBlock1;this._neccBlock2=neccBlock2;var width=this.width=17+4*this._version;this.buffer=Frame._createArray(width*width);this._ecc=Frame._createArray(dataBlock+(dataBlock+eccBlock)*(neccBlock1+neccBlock2)+neccBlock2);this._mask=Frame._createArray((width*(width+1)+1)/2);this._insertFinders();this._insertAlignments();this.buffer[8+width*(width-8)]=1;this._insertTimingGap();this._reverseMask();this._insertTimingRowAndColumn();this._insertVersion();this._syncMask();this._convertBitStream(valueLength);this._calculatePolynomial();this._appendEccToData();this._interleaveBlocks();this._pack();this._finish()},{_addAlignment:function(x,y){var i;var buffer=this.buffer;var width=this.width;buffer[x+width*y]=1;for(i=-2;i<2;i++){buffer[x+i+width*(y-2)]=1;buffer[x-2+width*(y+i+1)]=1;buffer[x+2+width*(y+i)]=1;buffer[x+i+1+width*(y+2)]=1}for(i=0;i<2;i++){this._setMask(x-1,y+i);this._setMask(x+1,y-i);this._setMask(x-i,y-1);this._setMask(x+i,y+1)}},_appendData:function(data,dataLength,ecc,eccLength){var bit,i,j;var polynomial=this._polynomial;var stringBuffer=this._stringBuffer;for(i=0;i<eccLength;i++){stringBuffer[ecc+i]=0}for(i=0;i<dataLength;i++){bit=Galois_1.LOG[stringBuffer[data+i]^stringBuffer[ecc]];if(bit!==255){for(j=1;j<eccLength;j++){stringBuffer[ecc+j-1]=stringBuffer[ecc+j]^Galois_1.EXPONENT[Frame._modN(bit+polynomial[eccLength-j])]}}else{for(j=ecc;j<ecc+eccLength;j++){stringBuffer[j]=stringBuffer[j+1]}}stringBuffer[ecc+eccLength-1]=bit===255?0:Galois_1.EXPONENT[Frame._modN(bit+polynomial[0])]}},_appendEccToData:function(){var i;var data=0;var dataBlock=this._dataBlock;var ecc=this._calculateMaxLength();var eccBlock=this._eccBlock;for(i=0;i<this._neccBlock1;i++){this._appendData(data,dataBlock,ecc,eccBlock);data+=dataBlock;ecc+=eccBlock}for(i=0;i<this._neccBlock2;i++){this._appendData(data,dataBlock+1,ecc,eccBlock);data+=dataBlock+1;ecc+=eccBlock}},_applyMask:function(mask){var r3x,r3y,x,y;var buffer=this.buffer;var width=this.width;switch(mask){case 0:for(y=0;y<width;y++){for(x=0;x<width;x++){if(!(x+y&1)&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break;case 1:for(y=0;y<width;y++){for(x=0;x<width;x++){if(!(y&1)&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break;case 2:for(y=0;y<width;y++){for(r3x=0,x=0;x<width;x++,r3x++){if(r3x===3){r3x=0}if(!r3x&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break;case 3:for(r3y=0,y=0;y<width;y++,r3y++){if(r3y===3){r3y=0}for(r3x=r3y,x=0;x<width;x++,r3x++){if(r3x===3){r3x=0}if(!r3x&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break;case 4:for(y=0;y<width;y++){for(r3x=0,r3y=y>>1&1,x=0;x<width;x++,r3x++){if(r3x===3){r3x=0;r3y=!r3y}if(!r3y&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break;case 5:for(r3y=0,y=0;y<width;y++,r3y++){if(r3y===3){r3y=0}for(r3x=0,x=0;x<width;x++,r3x++){if(r3x===3){r3x=0}if(!((x&y&1)+!(!r3x|!r3y))&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break;case 6:for(r3y=0,y=0;y<width;y++,r3y++){if(r3y===3){r3y=0}for(r3x=0,x=0;x<width;x++,r3x++){if(r3x===3){r3x=0}if(!((x&y&1)+(r3x&&r3x===r3y)&1)&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break;case 7:for(r3y=0,y=0;y<width;y++,r3y++){if(r3y===3){r3y=0}for(r3x=0,x=0;x<width;x++,r3x++){if(r3x===3){r3x=0}if(!((r3x&&r3x===r3y)+(x+y&1)&1)&&!this._isMasked(x,y)){buffer[x+y*width]^=1}}}break}},_calculateMaxLength:function(){return this._dataBlock*(this._neccBlock1+this._neccBlock2)+this._neccBlock2},_calculatePolynomial:function(){var i,j;var eccBlock=this._eccBlock;var polynomial=this._polynomial;polynomial[0]=1;for(i=0;i<eccBlock;i++){polynomial[i+1]=1;for(j=i;j>0;j--){polynomial[j]=polynomial[j]?polynomial[j-1]^Galois_1.EXPONENT[Frame._modN(Galois_1.LOG[polynomial[j]]+i)]:polynomial[j-1]}polynomial[0]=Galois_1.EXPONENT[Frame._modN(Galois_1.LOG[polynomial[0]]+i)]}for(i=0;i<=eccBlock;i++){polynomial[i]=Galois_1.LOG[polynomial[i]]}},_checkBadness:function(){var b,b1,h,x,y;var bad=0;var badness=this._badness;var buffer=this.buffer;var width=this.width;for(y=0;y<width-1;y++){for(x=0;x<width-1;x++){if(buffer[x+width*y]&&buffer[x+1+width*y]&&buffer[x+width*(y+1)]&&buffer[x+1+width*(y+1)]||!(buffer[x+width*y]||buffer[x+1+width*y]||buffer[x+width*(y+1)]||buffer[x+1+width*(y+1)])){bad+=Frame.N2}}}var bw=0;for(y=0;y<width;y++){h=0;badness[0]=0;for(b=0,x=0;x<width;x++){b1=buffer[x+width*y];if(b===b1){badness[h]++}else{badness[++h]=1}b=b1;bw+=b?1:-1}bad+=this._getBadness(h)}if(bw<0){bw=-bw}var count=0;var big=bw;big+=big<<2;big<<=1;while(big>width*width){big-=width*width;count++}bad+=count*Frame.N4;for(x=0;x<width;x++){h=0;badness[0]=0;for(b=0,y=0;y<width;y++){b1=buffer[x+width*y];if(b===b1){badness[h]++}else{badness[++h]=1}b=b1}bad+=this._getBadness(h)}return bad},_convertBitStream:function(length){var bit,i;var ecc=this._ecc;var version=this._version;for(i=0;i<length;i++){ecc[i]=this._value.charCodeAt(i)}var stringBuffer=this._stringBuffer=ecc.slice();var maxLength=this._calculateMaxLength();if(length>=maxLength-2){length=maxLength-2;if(version>9){length--}}var index=length;if(version>9){stringBuffer[index+2]=0;stringBuffer[index+3]=0;while(index--){bit=stringBuffer[index];stringBuffer[index+3]|=255&bit<<4;stringBuffer[index+2]=bit>>4}stringBuffer[2]|=255&length<<4;stringBuffer[1]=length>>4;stringBuffer[0]=64|length>>12}else{stringBuffer[index+1]=0;stringBuffer[index+2]=0;while(index--){bit=stringBuffer[index];stringBuffer[index+2]|=255&bit<<4;stringBuffer[index+1]=bit>>4}stringBuffer[1]|=255&length<<4;stringBuffer[0]=64|length>>4}index=length+3-(version<10);while(index<maxLength){stringBuffer[index++]=236;stringBuffer[index++]=17}},_getBadness:function(length){var i;var badRuns=0;var badness=this._badness;for(i=0;i<=length;i++){if(badness[i]>=5){badRuns+=Frame.N1+badness[i]-5}}for(i=3;i<length-1;i+=2){if(badness[i-2]===badness[i+2]&&badness[i+2]===badness[i-1]&&badness[i-1]===badness[i+1]&&badness[i-1]*3===badness[i]&&(badness[i-3]===0||i+3>length||badness[i-3]*3>=badness[i]*4||badness[i+3]*3>=badness[i]*4)){badRuns+=Frame.N3}}return badRuns},_finish:function(){this._stringBuffer=this.buffer.slice();var currentMask,i;var bit=0;var mask=3e4;for(i=0;i<8;i++){this._applyMask(i);currentMask=this._checkBadness();if(currentMask<mask){mask=currentMask;bit=i}if(bit===7){break}this.buffer=this._stringBuffer.slice()}if(bit!==i){this._applyMask(bit)}mask=ErrorCorrection_1.FINAL_FORMAT[bit+(this._level-1<<3)];var buffer=this.buffer;var width=this.width;for(i=0;i<8;i++,mask>>=1){if(mask&1){buffer[width-1-i+width*8]=1;if(i<6){buffer[8+width*i]=1}else{buffer[8+width*(i+1)]=1}}}for(i=0;i<7;i++,mask>>=1){if(mask&1){buffer[8+width*(width-7+i)]=1;if(i){buffer[6-i+width*8]=1}else{buffer[7+width*8]=1}}}},_interleaveBlocks:function(){var i,j;var dataBlock=this._dataBlock;var ecc=this._ecc;var eccBlock=this._eccBlock;var k=0;var maxLength=this._calculateMaxLength();var neccBlock1=this._neccBlock1;var neccBlock2=this._neccBlock2;var stringBuffer=this._stringBuffer;for(i=0;i<dataBlock;i++){for(j=0;j<neccBlock1;j++){ecc[k++]=stringBuffer[i+j*dataBlock]}for(j=0;j<neccBlock2;j++){ecc[k++]=stringBuffer[neccBlock1*dataBlock+i+j*(dataBlock+1)]}}for(j=0;j<neccBlock2;j++){ecc[k++]=stringBuffer[neccBlock1*dataBlock+i+j*(dataBlock+1)]}for(i=0;i<eccBlock;i++){for(j=0;j<neccBlock1+neccBlock2;j++){ecc[k++]=stringBuffer[maxLength+i+j*eccBlock]}}this._stringBuffer=ecc},_insertAlignments:function(){var i,x,y;var version=this._version;var width=this.width;if(version>1){i=Alignment_1.BLOCK[version];y=width-7;for(;;){x=width-7;while(x>i-3){this._addAlignment(x,y);if(x<i){break}x-=i}if(y<=i+9){break}y-=i;this._addAlignment(6,y);this._addAlignment(y,6)}}},_insertFinders:function(){var i,j,x,y;var buffer=this.buffer;var width=this.width;for(i=0;i<3;i++){j=0;y=0;if(i===1){j=width-7}if(i===2){y=width-7}buffer[y+3+width*(j+3)]=1;for(x=0;x<6;x++){buffer[y+x+width*j]=1;buffer[y+width*(j+x+1)]=1;buffer[y+6+width*(j+x)]=1;buffer[y+x+1+width*(j+6)]=1}for(x=1;x<5;x++){this._setMask(y+x,j+1);this._setMask(y+1,j+x+1);this._setMask(y+5,j+x);this._setMask(y+x+1,j+5)}for(x=2;x<4;x++){buffer[y+x+width*(j+2)]=1;buffer[y+2+width*(j+x+1)]=1;buffer[y+4+width*(j+x)]=1;buffer[y+x+1+width*(j+4)]=1}}},_insertTimingGap:function(){var x,y;var width=this.width;for(y=0;y<7;y++){this._setMask(7,y);this._setMask(width-8,y);this._setMask(7,y+width-7)}for(x=0;x<8;x++){this._setMask(x,7);this._setMask(x+width-8,7);this._setMask(x,width-8)}},_insertTimingRowAndColumn:function(){var x;var buffer=this.buffer;var width=this.width;for(x=0;x<width-14;x++){if(x&1){this._setMask(8+x,6);this._setMask(6,8+x)}else{buffer[8+x+width*6]=1;buffer[6+width*(8+x)]=1}}},_insertVersion:function(){var i,j,x,y;var buffer=this.buffer;var version=this._version;var width=this.width;if(version>6){i=Version_1.BLOCK[version-7];j=17;for(x=0;x<6;x++){for(y=0;y<3;y++,j--){if(1&(j>11?version>>j-12:i>>j)){buffer[5-x+width*(2-y+width-11)]=1;buffer[2-y+width-11+width*(5-x)]=1}else{this._setMask(5-x,2-y+width-11);this._setMask(2-y+width-11,5-x)}}}}},_isMasked:function(x,y){var bit=Frame._getMaskBit(x,y);return this._mask[bit]===1},_pack:function(){var bit,i,j;var k=1;var v=1;var width=this.width;var x=width-1;var y=width-1;var length=(this._dataBlock+this._eccBlock)*(this._neccBlock1+this._neccBlock2)+this._neccBlock2;for(i=0;i<length;i++){bit=this._stringBuffer[i];for(j=0;j<8;j++,bit<<=1){if(128&bit){this.buffer[x+width*y]=1}do{if(v){x--}else{x++;if(k){if(y!==0){y--}else{x-=2;k=!k;if(x===6){x--;y=9}}}else if(y!==width-1){y++}else{x-=2;k=!k;if(x===6){x--;y-=8}}}v=!v}while(this._isMasked(x,y))}}},_reverseMask:function(){var x,y;var width=this.width;for(x=0;x<9;x++){this._setMask(x,8)}for(x=0;x<8;x++){this._setMask(x+width-8,8);this._setMask(8,x)}for(y=0;y<7;y++){this._setMask(8,y+width-7)}},_setMask:function(x,y){var bit=Frame._getMaskBit(x,y);this._mask[bit]=1},_syncMask:function(){var x,y;var width=this.width;for(y=0;y<width;y++){for(x=0;x<=y;x++){if(this.buffer[x+width*y]){this._setMask(x,y)}}}}},{_createArray:function(length){var i;var array=[];for(i=0;i<length;i++){array[i]=0}return array},_getMaskBit:function(x,y){var bit;if(x>y){bit=x;x=y;y=bit}bit=y;bit+=y*y;bit>>=1;bit+=x;return bit},_modN:function(x){while(x>=255){x-=255;x=(x>>8)+(x&255)}return x},N1:3,N2:3,N3:40,N4:10});var Frame_1=Frame;var ImageRenderer=Renderer_1.extend({draw:function(){this.element.src=this.qrious.toDataURL()},reset:function(){this.element.src=""},resize:function(){var element=this.element;element.width=element.height=this.qrious.size}});var ImageRenderer_1=ImageRenderer;var Option=lite.extend(function(name,modifiable,defaultValue,valueTransformer){this.name=name;this.modifiable=Boolean(modifiable);this.defaultValue=defaultValue;this._valueTransformer=valueTransformer},{transform:function(value){var transformer=this._valueTransformer;if(typeof transformer==="function"){return transformer(value,this)}return value}});var Option_1=Option;var Utilities=lite.extend(null,{abs:function(value){return value!=null?Math.abs(value):null},hasOwn:function(object,name){return Object.prototype.hasOwnProperty.call(object,name)},noop:function(){},toUpperCase:function(string){return string!=null?string.toUpperCase():null}});var Utilities_1=Utilities;var OptionManager=lite.extend(function(options){this.options={};options.forEach(function(option){this.options[option.name]=option},this)},{exists:function(name){return this.options[name]!=null},get:function(name,target){return OptionManager._get(this.options[name],target)},getAll:function(target){var name;var options=this.options;var result={};for(name in options){if(Utilities_1.hasOwn(options,name)){result[name]=OptionManager._get(options[name],target)}}return result},init:function(options,target,changeHandler){if(typeof changeHandler!=="function"){changeHandler=Utilities_1.noop}var name,option;for(name in this.options){if(Utilities_1.hasOwn(this.options,name)){option=this.options[name];OptionManager._set(option,option.defaultValue,target);OptionManager._createAccessor(option,target,changeHandler)}}this._setAll(options,target,true)},set:function(name,value,target){return this._set(name,value,target)},setAll:function(options,target){return this._setAll(options,target)},_set:function(name,value,target,allowUnmodifiable){var option=this.options[name];if(!option){throw new Error("Invalid option: "+name)}if(!option.modifiable&&!allowUnmodifiable){throw new Error("Option cannot be modified: "+name)}return OptionManager._set(option,value,target)},_setAll:function(options,target,allowUnmodifiable){if(!options){return false}var name;var changed=false;for(name in options){if(Utilities_1.hasOwn(options,name)&&this._set(name,options[name],target,allowUnmodifiable)){changed=true}}return changed}},{_createAccessor:function(option,target,changeHandler){var descriptor={get:function(){return OptionManager._get(option,target)}};if(option.modifiable){descriptor.set=function(value){if(OptionManager._set(option,value,target)){changeHandler(value,option)}}}Object.defineProperty(target,option.name,descriptor)},_get:function(option,target){return target["_"+option.name]},_set:function(option,value,target){var fieldName="_"+option.name;var oldValue=target[fieldName];var newValue=option.transform(value!=null?value:option.defaultValue);target[fieldName]=newValue;return newValue!==oldValue}});var OptionManager_1=OptionManager;var ServiceManager=lite.extend(function(){this._services={}},{getService:function(name){var service=this._services[name];if(!service){throw new Error("Service is not being managed with name: "+name)}return service},setService:function(name,service){if(this._services[name]){throw new Error("Service is already managed with name: "+name)}if(service){this._services[name]=service}}});var ServiceManager_1=ServiceManager;var optionManager=new OptionManager_1([new Option_1("background",true,"white"),new Option_1("backgroundAlpha",true,1,Utilities_1.abs),new Option_1("element"),new Option_1("foreground",true,"black"),new Option_1("foregroundAlpha",true,1,Utilities_1.abs),new Option_1("level",true,"L",Utilities_1.toUpperCase),new Option_1("mime",true,"image/png"),new Option_1("padding",true,null,Utilities_1.abs),new Option_1("size",true,100,Utilities_1.abs),new Option_1("value",true,"")]);var serviceManager=new ServiceManager_1;var QRious=lite.extend(function(options){optionManager.init(options,this,this.update.bind(this));var element=optionManager.get("element",this);var elementService=serviceManager.getService("element");var canvas=element&&elementService.isCanvas(element)?element:elementService.createCanvas();var image=element&&elementService.isImage(element)?element:elementService.createImage();this._canvasRenderer=new CanvasRenderer_1(this,canvas,true);this._imageRenderer=new ImageRenderer_1(this,image,image===element);this.update()},{get:function(){return optionManager.getAll(this)},set:function(options){if(optionManager.setAll(options,this)){this.update()}},toDataURL:function(mime){return this.canvas.toDataURL(mime||this.mime)},update:function(){var frame=new Frame_1({level:this.level,value:this.value});this._canvasRenderer.render(frame);this._imageRenderer.render(frame)}},{use:function(service){serviceManager.setService(service.getName(),service)}});Object.defineProperties(QRious.prototype,{canvas:{get:function(){return this._canvasRenderer.getElement()}},image:{get:function(){return this._imageRenderer.getElement()}}});var QRious_1$2=QRious;var index=QRious_1$2;var Service=lite.extend({getName:function(){}});var Service_1=Service;var ElementService=Service_1.extend({createCanvas:function(){},createImage:function(){},getName:function(){return"element"},isCanvas:function(element){},isImage:function(element){}});var ElementService_1=ElementService;var BrowserElementService=ElementService_1.extend({createCanvas:function(){return document.createElement("canvas")},createImage:function(){return document.createElement("img")},isCanvas:function(element){return element instanceof HTMLCanvasElement},isImage:function(element){return element instanceof HTMLImageElement}});var BrowserElementService_1=BrowserElementService;index.use(new BrowserElementService_1);var QRious_1=index;return QRious_1})});var script$39=function(){this.on("mount",()=>{new qrious(objectAssign({},this.opts.data,{element:this.refs.canvas}))})};riot$1.tag2("viron-qrcode",'<canvas class="Qrcode_canvas" ref="canvas"></canvas>',"",'class="Qrcode"',function(opts){this.external(script$39)});var script$40=function(){const store=this.riotx.get();const optimizedEndpoint=objectAssign({},{url:this.opts.endpoint.url,memo:this.opts.endpoint.memo});const version=store.getter("application.latestVersion");const encodedEndpoint=encodeURIComponent(JSON.stringify(optimizedEndpoint));const value=`https://cam-inc.github.io/viron/${version}/#/endpointimport?endpoint=${encodedEndpoint}`;this.data={level:"L",mime:"image/png",size:200,value:value}};riot$1.tag2("viron-endpoints-page-endpoint-menu-qrcode",'<div class="EndpointsPage_Endpoint_Menu_QRCode__title">QR„Ç≥„Éº„Éâ</div> <div class="EndpointsPage_Endpoint_Menu_QRCode__message">„É¢„Éê„Ç§„É´Á´ØÊú´„Å´„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíËøΩÂä†„Åß„Åç„Åæ„Åô„ÄÇ<br>„ÅäÂ•Ω„Åç„Å™QR„Ç≥„Éº„Éâ„É™„Éº„ÉÄ„Éº„ÅßË™≠„ÅøËæº„Çì„Åß‰∏ã„Åï„ÅÑ„ÄÇ</div> <div class="EndpointsPage_Endpoint_Menu_QRCode__canvas"> <viron-qrcode data="{data}"></viron-qrcode> </div>',"",'class="EndpointsPage_Endpoint_Menu_QRCode"',function(opts){this.external(script$40)});var script$38=function(){const store=this.riotx.get();const isSignined=!!this.opts.endpoint.token;const isDesktop=store.getter("layout.isDesktop");this.list=[];if(isDesktop){this.list.push({id:"qrcode",label:"QR„Ç≥„Éº„Éâ"})}this.list.push({id:"remove",label:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíÂâäÈô§"});if(isSignined){this.list.push({id:"signout",label:"„É≠„Ç∞„Ç¢„Ç¶„Éà"})}const showQRCode=()=>{Promise.resolve().then(()=>store.action("modals.add","viron-endpoints-page-endpoint-menu-qrcode",{endpoint:this.opts.endpoint})).then(()=>{this.close()}).catch(err=>store.action("modals.add","viron-error",{error:err}))};const removeEndpoint=()=>{Promise.resolve().then(()=>store.action("endpoints.remove",this.opts.endpoint.key)).then(()=>store.action("toasts.add",{message:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü„ÄÇ"})).then(()=>{this.close()}).catch(err=>store.action("modals.add","viron-error",{error:err}))};const signout=()=>{Promise.resolve().then(()=>store.action("auth.remove",this.opts.endpoint.key)).then(()=>store.action("toasts.add",{message:"„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åó„Åü„ÄÇ"})).then(()=>{this.close()}).catch(err=>store.action("modals.add","viron-error",{error:err}))};this.handleItemSelect=(id=>{switch(id){case"qrcode":showQRCode();break;case"remove":removeEndpoint();break;case"signout":signout();break;default:break}})};riot$1.tag2("viron-endpoints-page-endpoint-menu",'<viron-list list="{list}" onselect="{handleItemSelect}"></viron-list>',"",'class="EndpointsPage_Endpoint_Menu"',function(opts){this.external(script$38)});var script$41=function(){};riot$1.tag2("viron-horizontal-rule",'<div class="HorizontalRule__line"></div> <virtual if="{!!opts.label}"> <div class="HorizontalRule__label">{opts.label}</div> <div class="HorizontalRule__line"></div> </virtual>',"",'class="HorizontalRule"',function(opts){this.external(script$41)});var script$42=function(){const store=this.riotx.get();this.errorMessage=null;this.mailAddress="";this.password="";this.handleMailAddressChange=(newMailAddress=>{this.mailAddress=newMailAddress;this.update()});this.handlePasswordChange=(newPassword=>{this.password=newPassword;this.update()});this.handleSigninButtonSelect=(()=>{Promise.resolve().then(()=>store.action("auth.signinEmail",this.opts.endpointkey,this.opts.authtype,this.mailAddress,this.password)).then(()=>{this.opts.closer();this.getRouter().navigateTo(`/${this.opts.endpointkey}`)}).catch(()=>{this.errorMessage="„É≠„Ç∞„Ç§„É≥Âá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇÊ≠£„Åó„ÅÑ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Å®„Éë„Çπ„ÉØ„Éº„Éâ„Çí‰ΩøÁî®„Åó„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ‰ΩøÁî®„Åó„Åü„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Åå‰∫à„ÇÅÁÆ°ÁêÜËÄÖ„Å®„Åó„Å¶ÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ";this.update()})})};riot$1.tag2("viron-endpoints-page-endpoint-signin-email",'<div class="EndpointsPage_Endpoint_Signin_Email__error" if="{errorMessage}">{errorMessage}</div> <viron-textinput placeholder="ID„Åæ„Åü„ÅØ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ" val="{mailAddress}" onchange="{handleMailAddressChange}"></viron-textinput> <viron-textinput placeholder="„Éë„Çπ„ÉØ„Éº„Éâ" type="password" val="{password}" onchange="{handlePasswordChange}"></viron-textinput> <viron-button label="„É≠„Ç∞„Ç§„É≥" theme="secondary" onselect="{handleSigninButtonSelect}"></viron-button>',"",'class="EndpointsPage_Endpoint_Signin_Email"',function(opts){this.external(script$42)});var script$43=function(){const store=this.riotx.get();this.handleButtonSelect=(()=>{this.opts.closer();Promise.resolve().then(()=>store.action("auth.signinOAuth",this.opts.endpointkey,this.opts.authtype)).catch(err=>store.action("modals.add","viron-error",{error:err}))})};riot$1.tag2("viron-endpoints-page-endpoint-signin-oauth",'<viron-button label="{opts.authtype.provider}" theme="secondary" onselect="{handleButtonSelect}"></viron-button>',"",'class="EndpointsPage_Endpoint_Signin_Oauth"',function(opts){this.external(script$43)});var script$44=function(){const store=this.riotx.get();this.isDesktop=store.getter("layout.isDesktop");this.emails=filter_1$1(this.opts.authtypes,authtype=>{return authtype.type===constants$1.authtypeEmail});this.oauths=filter_1$1(this.opts.authtypes,authtype=>{return authtype.type===constants$1.authtypeOauth});this.listen("layout",()=>{this.isDesktop=store.getter("layout.isDesktop");this.update()});this.closer=(()=>{this.close()})};riot$1.tag2("viron-endpoints-page-endpoint-signin",'<div class="EndpointsPage_Endpoint_Signin__main"> <virtual if="{!!opts.endpoint.thumbnail}"> <div class="EndpointsPage_Endpoint_Signin__thumbnail" riot-style="background-image:url({opts.endpoint.thumbnail});"></div> </virtual> <virtual if="{!opts.endpoint.thumbnail}"> <div class="EndpointsPage_Endpoint_Signin__thumbnailDefault"> <viron-icon-star></viron-icon-star> </div> </virtual> <div class="EndpointsPage_Endpoint_Signin__name">{opts.endpoint.name || \'- - -\'}</div> <div class="EndpointsPage_Endpoint_Signin__emails" if="{!!emails.length}"> <viron-endpoints-page-endpoint-signin-email each="{authtype in emails}" authtype="{authtype}" endpointkey="{parent.opts.endpoint.key}" closer="{closer}"></viron-endpoints-page-endpoint-signin-email> </div> <virtual if="{!isDesktop &amp;&amp; !!oauths.length}"> <viron-horizontal-rule label="„Åæ„Åü„ÅØ"></viron-horizontal-rule> <div class="EndpointsPage_Endpoint_Signin__oauths"> <viron-endpoints-page-endpoint-signin-oauth each="{authtype in oauths}" authtype="{authtype}" endpointkey="{parent.opts.endpoint.key}" closer="{closer}"></viron-endpoints-page-endpoint-signin-oauth> </div> </virtual> </div> <div class="EndpointsPage_Endpoint_Signin__aside" if="{isDesktop &amp;&amp; !!oauths.length}"> <div class="EndpointsPage_Endpoint_Signin__oauthMessage">„Åæ„Åü„ÅØ„ÄÅ„Åì„Å°„Çâ„Çí<br>Âà©Áî®„Åó„Å¶„É≠„Ç∞„Ç§„É≥</div> <div class="EndpointsPage_Endpoint_Signin__oauths"> <viron-endpoints-page-endpoint-signin-oauth each="{authtype in oauths}" authtype="{authtype}" endpointkey="{parent.opts.endpoint.key}" closer="{closer}"></viron-endpoints-page-endpoint-signin-oauth> </div> </div>',"",'class="EndpointsPage_Endpoint_Signin"',function(opts){this.external(script$44)});var script$37=function(){const store=this.riotx.get();this.isSelfDragged=false;this.isDragging=store.getter("application.isDragging");this.isPrevDroppable=false;this.isNextDroppable=false;this.listen("application",()=>{if(!this.isMounted){return}this.isDragging=store.getter("application.isDragging");this.update()});this.handleDragStart=(e=>{e.dataTransfer.effectAllowed="move";e.dataTransfer.setData("text/plain",this.opts.endpoint.key);store.action("application.startDrag");this.isSelfDragged=true;this.update()});this.handleDrag=(()=>{});this.handleDragEnd=(()=>{store.action("application.endDrag");this.isSelfDragged=false;this.update()});this.handlePrevDragEnter=(e=>{e.preventDefault();this.isPrevDroppable=true;this.update()});this.handleNextDragEnter=(e=>{e.preventDefault();this.isNextDroppable=true;this.update()});this.handlePrevDragOver=(e=>{e.preventDefault()});this.handleNextDragOver=(e=>{e.preventDefault()});this.handlePrevDragLeave=(()=>{this.isPrevDroppable=false;this.update()});this.handleNextDragLeave=(()=>{this.isNextDroppable=false;this.update()});const sortEndpoints=(e,newOrder)=>{const endpointKey=e.dataTransfer.getData("text/plain");Promise.resolve().then(()=>store.action("endpoints.changeOrder",endpointKey,newOrder)).catch(err=>store.action("modals.add","viron-error",{error:err}))};this.handlePrevDrop=(e=>{this.isPrevDroppable=false;this.update();sortEndpoints(e,this.opts.endpoint.order)});this.handleNextDrop=(e=>{this.isNextDroppable=false;this.update();sortEndpoints(e,this.opts.endpoint.order+1)});this.handleTap=(()=>{const endpointKey=this.opts.endpoint.key;Promise.resolve().then(()=>store.action("auth.validate",endpointKey)).then(isValid=>{if(isValid){this.getRouter().navigateTo(`/${endpointKey}`);return Promise.resolve()}return Promise.resolve().then(()=>store.action("auth.getTypes",endpointKey)).then(authtypes=>store.action("modals.add","viron-endpoints-page-endpoint-signin",{endpoint:this.opts.endpoint,authtypes:authtypes},{isSpread:true}))}).catch(err=>store.action("modals.add","viron-error",{error:err}))});this.handleMenuTap=(e=>{e.stopPropagation();const rect=this.refs.menu.root.getBoundingClientRect();store.action("popovers.add","viron-endpoints-page-endpoint-menu",{endpoint:this.opts.endpoint},{x:rect.left+rect.width/2,y:rect.bottom,width:228,direction:"TR"})})};riot$1.tag2("viron-endpoints-page-endpoint",'<div class="EndpointsPage_Endpoint__dropareaMarker EndpointsPage_Endpoint__dropareaMarker--prev {\'EndpointsPage_Endpoint__dropareaMarker--active\': isPrevDroppable}"></div> <div class="EndpointsPage_Endpoint__content"> <div class="EndpointsPage_Endpoint__head"> <virtual if="{!!opts.endpoint.thumbnail}"> <div class="EndpointsPage_Endpoint__thumbnail" riot-style="background-image:url({opts.endpoint.thumbnail});"></div> </virtual> <virtual if="{!opts.endpoint.thumbnail}"> <div class="EndpointsPage_Endpoint__thumbnailDefault"> <viron-icon-star></viron-icon-star> </div> </virtual> <div class="EndpointsPage_Endpoint__headContent"> <div class="EndpointsPage_Endpoint__name">{opts.endpoint.name || \'- - -\'}</div> <div class="EndpointsPage_Endpoint__urlWrapper"> <div class="EndpointsPage_Endpoint__color EndpointsPage_Endpoint__color--{opts.endpoint.color || \'purple\'}"></div> <div class="EndpointsPage_Endpoint__url">{opts.endpoint.url}</div> </div> </div> <viron-icon-setting class="EndpointsPage_Endpoint__menu" ref="menu" onclick="{getClickHandler(\'handleMenuTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleMenuTap\')}"></viron-icon-setting> </div> <div class="EndpointsPage_Endpoint__body"> <div class="EndpointsPage_Endpoint__description">{!!opts.endpoint.thumbnail ? (opts.endpoint.description || \'-\') : \'„É≠„Ç∞„Ç§„É≥„ÅßÁÆ°ÁêÜÁîªÈù¢ÊÉÖÂ†±„ÇíÂèñÂæó„Åß„Åç„Åæ„Åô\'}</div> <div class="EndpointsPage_Endpoint__tags"> <viron-tag each="{tag in opts.endpoint.tags}" label="{tag}"></viron-tag> </div> </div> <div class="EndpointsPage_Endpoint__droparea EndpointsPage_Endpoint__droparea--prev" if="{isDragging &amp;&amp; !isSelfDragged}" ondragenter="{handlePrevDragEnter}" ondragover="{handlePrevDragOver}" ondragleave="{handlePrevDragLeave}" ondrop="{handlePrevDrop}"></div> <div class="EndpointsPage_Endpoint__droparea EndpointsPage_Endpoint__droparea--next" if="{isDragging &amp;&amp; !isSelfDragged}" ondragenter="{handleNextDragEnter}" ondragover="{handleNextDragOver}" ondragleave="{handleNextDragLeave}" ondrop="{handleNextDrop}"></div> </div> <div class="EndpointsPage_Endpoint__dropareaMarker EndpointsPage_Endpoint__dropareaMarker--next {\'EndpointsPage_Endpoint__dropareaMarker--active\': isNextDroppable}"></div>',"",'class="EndpointsPage_Endpoint" draggable="{opts.isdraggable}" ondragstart="{handleDragStart}" ondrag="{handleDrag}" ondragend="{handleDragEnd}" onclick="{getClickHandler(\'handleTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleTap\')}"',function(opts){this.external(script$37)});var script$45=function(){const store=this.riotx.get();this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.layoutType=store.getter("layout.type");this.endpoints=store.getter("endpoints.allByOrderFiltered");this.isDraggable=false;this.listen("application",()=>{this.endpoints=store.getter("endpoints.allByOrderFiltered");this.update()});this.listen("endpoints",()=>{this.endpoints=store.getter("endpoints.allByOrderFiltered");this.update()});this.listen("layout",()=>{this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.layoutType=store.getter("layout.type");if(!this.isDesktop){this.isDraggable=false}this.update()});this.handleOrderButtonTap=(()=>{if(!this.isDesktop){return}this.isDraggable=!this.isDraggable;this.update()})};riot$1.tag2("viron-endpoints-page",'<div class="EndpointsPage__head"> <div class="EndpointsPage__title">„Éõ„Éº„É†</div> <div class="EndpointsPage__orderButton {\'EndpointsPage__orderButton--active\': isDraggable}" if="{isDesktop}" onclick="{getClickHandler(\'handleOrderButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleOrderButtonTap\')}"> <viron-icon-move></viron-icon-move> </div> </div> <div class="EndpointsPage__container"> <viron-endpoints-page-endpoint each="{endpoint in endpoints}" endpoint="{endpoint}" isdraggable="{parent.isDraggable}"></viron-endpoints-page-endpoint> </div>',"",'class="EndpointsPage EndpointsPage--{layoutType}"',function(opts){this.external(script$45)});var script$46=function(){};riot$1.tag2("viron-notfound-page","<div>Not Found...</div>","",'class="NotfoundPage"',function(opts){this.external(script$46)});var script$47=function(){};riot$1.tag2("viron-application-blocker","","",'class="Application_Blocker"',function(opts){this.external(script$47)});var script$48=function(){this.isActive=false;this.on("mount",()=>{setTimeout(()=>{this.isActive=true;this.update()},100)})};riot$1.tag2("viron-application-dimmer","","","class=\"Application_Dimmer {'Application_Dimmer--active': isActive}\"",function(opts){this.external(script$48)});var script$49=function(){const store=this.riotx.get();let tag;const fadeIn=()=>{setTimeout(()=>{this.isVisible=true;this.update()},100)};const fadeOut=()=>{this.isVisible=false;this.update();setTimeout(()=>{store.action("drawers.remove",this.opts.id)},1e3)};this.layoutType=store.getter("layout.type");this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.update()});this.on("mount",()=>{tag=riot$1.mount(this.refs.content,this.opts.tagname,objectAssign({isDrawer:true,drawerCloser:fadeOut},this.opts.tagopts))[0];fadeIn();window.addEventListener("keydown",this.handleKeyDown)}).on("before-unmount",()=>{tag.unmount(true)}).on("unmount",()=>{window.removeEventListener("keydown",this.handleKeyDown)});this.handleTap=(()=>{fadeOut()});this.handleFrameTap=(e=>{e.stopPropagation()});this.handleKeyDown=(e=>{switch(e.keyCode){case 27:fadeOut();break;default:break}})};riot$1.tag2("viron-drawer",'<div class="Drawer__frame" onclick="{getClickHandler(\'handleFrameTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleFrameTap\')}"> <div class="Drawer__contentWrapper"> <div class="Drawer__content" ref="content"></div> </div> </div>',"","class=\"Drawer Drawer--{opts.theme} {isVisible ? 'Drawer--visible' : ''} Drawer--{layoutType} {opts.isnarrow ? 'Drawer--narrow' : ''}\" onclick=\"{getClickHandler('handleTap')}\" ontouchstart=\"{getTouchStartHandler()}\" ontouchmove=\"{getTouchMoveHandler()}\" ontouchend=\"{getTouchEndHandler('handleTap')}\"",function(opts){this.external(script$49)});var script$50=function(){const store=this.riotx.get();this.drawers=store.getter("drawers.all");this.listen("drawers",()=>{this.drawers=store.getter("drawers.all");this.update()})};riot$1.tag2("viron-application-drawers",'<virtual each="{drawers}"> <viron-drawer id="{id}" tagname="{tagName}" tagopts="{tagOpts}" theme="{drawerOpts.theme}" isnarrow="{drawerOpts.isNarrow}"></viron-drawer> </virtual>',"",'class="Application_Drawers"',function(opts){this.external(script$50)});var script$52=function(){const store=this.riotx.get();const maxSize=5;this.names=store.getter("endpoints.namesFiltered",maxSize);this._tags=store.getter("endpoints.tagsFiltered",maxSize);this.isEmpty=!this.names.length&&!this._tags.length;this.listen("application",()=>{this.names=store.getter("endpoints.namesFiltered",maxSize);this._tags=store.getter("endpoints.tagsFiltered",maxSize);this.isEmpty=!this.names.length&&!this._tags.length;this.update()});this.handleMouseDown=(e=>{e.stopPropagation();e.preventDefault()});this.handleItemTap=(e=>{const text=e.item.value||"";Promise.resolve().then(()=>store.action("application.updateEndpointFilterText",text)).catch(err=>store.action("modals.add","viron-error",{error:err}))})};riot$1.tag2("viron-application-header-filter-autocomplete",'<virtual if="{isEmpty}"> <div class="Application_Header_Filter_Autocomplete__empty">ÂÄôË£úÁÑ°„Åó</div> </virtual> <virtual if="{!isEmpty}"> <virtual if="{!!names.length}"> <div class="Application_Header_Filter_Autocomplete__list"> <div class="Application_Header_Filter_Autocomplete__label">„Ç´„Éº„Éâ</div> <div class="Application_Header_Filter_Autocomplete__item" each="{value in names}" onclick="{getClickHandler(\'handleItemTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleItemTap\')}">{value}</div> </div> </virtual> <virtual if="{!!_tags.length}"> <div class="Application_Header_Filter_Autocomplete__list"> <div class="Application_Header_Filter_Autocomplete__label">„Çø„Ç∞</div> <div class="Application_Header_Filter_Autocomplete__item" each="{value in _tags}" onclick="{getClickHandler(\'handleItemTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleItemTap\')}">{value}</div> </div> </virtual> </virtual>',"",'class="Application_Header_Filter_Autocomplete" onmousedown="{handleMouseDown}"',function(opts){this.external(script$52)});var script$51=function(){const store=this.riotx.get();this.isOpened=false;this.filterText=store.getter("application.endpointFilterText");this.listen("application",()=>{if(!this.refs.input){return}const newFilterText=store.getter("application.endpointFilterText");if(newFilterText!==this.filterText){this.refs.input.value=this.filterText=store.getter("application.endpointFilterText")}});this.handleCloseIconMouseDown=(e=>{e.stopPropagation();e.preventDefault()});this.handleCloseIconTap=(()=>{Promise.resolve().then(()=>store.action("application.resetEndpointFilterText")).catch(err=>store.action("modals.add","viron-error",{error:err}))});this.handleSearchIconMouseDown=(e=>{e.stopPropagation();e.preventDefault()});this.handleSearchIconTap=(()=>{if(this.isOpened){Promise.resolve().then(()=>store.action("application.updateEndpointFilterText",this.refs.input.value||"")).catch(err=>store.action("modals.add","viron-error",{error:err}));return}this.isOpened=true;this.update();if(this.isOpened){setTimeout(()=>{if(!this.refs.input){return}this.refs.input.value=store.getter("application.endpointFilterText");this.refs.input.focus()},100)}});this.handleFormSubmit=(()=>{Promise.resolve().then(()=>store.action("application.updateEndpointFilterText",this.refs.input.value||"")).catch(err=>store.action("modals.add","viron-error",{error:err}))});this.handleInputFocus=(()=>{new Promise(resolve=>{setTimeout(resolve,500)}).then(()=>{const rootElm=this.root;if(!rootElm){return}const rect=rootElm.getBoundingClientRect();store.action("popovers.add","viron-application-header-filter-autocomplete",null,{x:rect.left+rect.width/2,y:rect.bottom-10,width:rect.width,direction:"T"})})});this.handleInputBlur=(()=>{this.isOpened=false;this.update()});this.handleInputChange=(e=>{e.stopPropagation()});this.handleInputInput=(e=>{const text=e.target.value||"";Promise.resolve().then(()=>store.action("application.updateEndpointTempFilterText",text)).catch(err=>store.action("modals.add","viron-error",{error:err}))})};riot$1.tag2("viron-application-header-filter",'<viron-icon-close class="Application_Header_Filter__closeIcon" if="{isOpened}" onmousedown="{handleCloseIconMouseDown}" onclick="{getClickHandler(\'handleCloseIconTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCloseIconTap\')}"></viron-icon-close> <form class="Application_Header_Filter__form" if="{isOpened}" onsubmit="{handleFormSubmit}"> <input class="Application_Header_Filter__input" ref="input" placeholder="„Ç´„Éº„Éâ„ÇíÊ§úÁ¥¢" onfocus="{handleInputFocus}" onblur="{handleInputBlur}" oninput="{handleInputInput}" onchange="{handleInputChange}"> </form> <viron-icon-search class="Application_Header_Filter__searchIcon" onmousedown="{handleSearchIconMouseDown}" onclick="{getClickHandler(\'handleSearchIconTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleSearchIconTap\')}"></viron-icon-search> <div class="Application_Header_Filter__text" if="{!isOpened &amp;&amp; !!filterText}">filtered by: {filterText}</div>',"","class=\"Application_Header_Filter {'Application_Header_Filter--opened': isOpened}\"",function(opts){this.external(script$51)});var script$54=function(){const store=this.riotx.get();this.isOpened=false;this.getPagesHeight=(()=>{if(!this.isOpened){return 0}const elm=this.refs.pagesInner;if(!elm){return 0}const rect=elm.getBoundingClientRect();return rect.height});this.handleHeadTap=(()=>{this.isOpened=!this.isOpened;this.update()});this.handleIndependentHeadTap=(()=>{this.opts.closer();const id=this.opts.group.pages[0].id;this.getRouter().navigateTo(`/${store.getter("current.all")}/${id}`)});this.handlePageTap=(e=>{this.opts.closer();const id=e.item.page.id;this.getRouter().navigateTo(`/${store.getter("current.all")}/${id}`)})};riot$1.tag2("viron-application-menu-group",'<virtual if="{!opts.group.isIndependent}"> <div class="Application_Menu_Group__head" onclick="{getClickHandler(\'handleHeadTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleHeadTap\')}"> <div class="Application_Menu_Group__name">{opts.group.name}</div> <viron-icon-arrow-up class="Application_Menu_Group__arrow"></viron-icon-arrow-up> </div> <div class="Application_Menu_Group__pages" riot-style="height:{getPagesHeight()}px;"> <div class="Application_Menu_Group__pagesInner" ref="pagesInner"> <div class="Application_Menu_Group__page" each="{page in opts.group.pages}" onclick="{getClickHandler(\'handlePageTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handlePageTap\')}">{page.name}</div> </div> </div> </virtual> <virtual if="{opts.group.isIndependent}"> <div class="Application_Menu_Group__head" onclick="{getClickHandler(\'handleIndependentHeadTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleIndependentHeadTap\')}"> <div class="Application_Menu_Group__name">{opts.group.pages[0].name}</div> </div> </virtual>',"","class=\"Application_Menu_Group {'Application_Menu_Group--open': isOpened}\"",function(opts){this.external(script$54)});var script$55=function(){const store=this.riotx.get();this.closer=(()=>{this.close()});this.menu=store.getter("viron.menu");this.layoutType=store.getter("layout.type");this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.listen("viron",()=>{this.menu=store.getter("viron.menu");this.update()});this.listen("layout",()=>{if(!this.isMounted){return}this.layoutType=store.getter("layout.type");this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.update()});this.handleLogoTap=(()=>{this.close();this.getRouter().navigateTo("/")})};riot$1.tag2("viron-application-menu",'<div class="Application_Menu__bg"></div> <div class="Application_Menu__overlay"></div> <div class="Application_Menu__content"> <div class="Application_Menu__head"> <viron-icon-arrow-left class="Application_Menu__arrow"></viron-icon-arrow-left> <viron-icon-logo class="Application_Menu__logo" onclick="{getClickHandler(\'handleLogoTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleLogoTap\')}"></viron-icon-logo> </div> <div class="Application_Menu__body"> <div class="Application_Menu__section" each="{section in menu}"> <div class="Application_Menu__sectionName">{section.name}</div> <div class="Application_Menu__groups"> <viron-application-menu-group each="{group in section.groups}" group="{group}" closer="{parent.closer}"></viron-application-menu-group> </div> </div> </div> </div>',"",'class="Application_Menu Application_Menu--{layoutType}"',function(opts){this.external(script$55)});var script$57=function(){const store=this.riotx.get();this.handleClearButtonTap=(()=>{Promise.resolve().then(()=>store.action("endpoints.removeAll")).then(()=>{this.close();return store.action("toasts.add",{message:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà‰∏ÄË¶ß„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü„ÄÇ"})}).catch(err=>{this.close();return store.action("modals.add","viron-error",{error:err})})})};riot$1.tag2("viron-application-header-menu-clear",'<div class="Application_Header_Menu_Clear__title">ÂÖ®„Å¶„ÅÆ„Ç´„Éº„Éâ„ÇíÂâäÈô§</div> <div class="Application_Header_Menu_Clear__description">„Éõ„Éº„É†„ÅÆ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà‰∏ÄË¶ß„ÇíÁ©∫„Å´„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ</div> <div class="Application_Header_Menu_Clear__control"> <viron-button label="ÂâäÈô§„Åô„Çã" theme="secondary" onselect="{handleClearButtonTap}"></viron-button> </div>',"",'class="Application_Header_Menu_Clear"',function(opts){this.external(script$57)});var script$58=function(){};riot$1.tag2("viron-application-header-menu-credit","<div>TODO</div>","",'class="Application_Header_Menu_Credit"',function(opts){this.external(script$58)});var validUrl=createCommonjsModule(function(module){(function(module){"use strict";module.exports.is_uri=is_iri;module.exports.is_http_uri=is_http_iri;module.exports.is_https_uri=is_https_iri;module.exports.is_web_uri=is_web_iri;module.exports.isUri=is_iri;module.exports.isHttpUri=is_http_iri;module.exports.isHttpsUri=is_https_iri;module.exports.isWebUri=is_web_iri;var splitUri=function(uri){var splitted=uri.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return splitted};function is_iri(value){if(!value){return}if(/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(value)){return}if(/%[^0-9a-f]/i.test(value)){return}if(/%[0-9a-f](:?[^0-9a-f]|$)/i.test(value)){return}var splitted=[];var scheme="";var authority="";var path="";var query="";var fragment="";var out="";splitted=splitUri(value);scheme=splitted[1];authority=splitted[2];path=splitted[3];query=splitted[4];fragment=splitted[5];if(!(scheme&&scheme.length&&path.length>=0)){return}if(authority&&authority.length){if(!(path.length===0||/^\//.test(path))){return}}else{if(/^\/\//.test(path)){return}}if(!/^[a-z][a-z0-9\+\-\.]*$/.test(scheme.toLowerCase())){return}out+=scheme+":";if(authority&&authority.length){out+="//"+authority}out+=path;if(query&&query.length){out+="?"+query}if(fragment&&fragment.length){out+="#"+fragment}return out}function is_http_iri(value,allowHttps){if(!is_iri(value)){return}var splitted=[];var scheme="";var authority="";var path="";var port="";var query="";var fragment="";var out="";splitted=splitUri(value);scheme=splitted[1];authority=splitted[2];path=splitted[3];query=splitted[4];fragment=splitted[5];if(!scheme){return}if(allowHttps){if(scheme.toLowerCase()!="https"){return}}else{if(scheme.toLowerCase()!="http"){return}}if(!authority){return}if(/:(\d+)$/.test(authority)){port=authority.match(/:(\d+)$/)[0];authority=authority.replace(/:\d+$/,"")}out+=scheme+":";out+="//"+authority;if(port){out+=port}out+=path;if(query&&query.length){out+="?"+query}if(fragment&&fragment.length){out+="#"+fragment}return out}function is_https_iri(value){return is_http_iri(value,true)}function is_web_iri(value){return is_http_iri(value)||is_https_iri(value)}})(module)});var script$59=function(){const store=this.riotx.get();this.endpointURL="";this.errorMessage="";this.isLikelyToBeSelfSignedCertificate=false;const validate=endpointURL=>{if(!validUrl.isUri(endpointURL)){return"URL„Å´Ë™§„Çä„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ"}if(!!store.getter("endpoints.oneByURL",endpointURL)){return"Êó¢„Å´Â≠òÂú®„Åô„Çã„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Åß„Åô„ÄÇ"}return null};this.handleEndpointURLChange=(newEndpointURL=>{this.endpointURL=newEndpointURL;this.update()});this.handleSelfSignedCertificateButtonTap=(()=>{window.open(this.endpointURL,"_blank")});this.handleAddButtonSelect=(()=>{const errorMessage=validate(this.endpointURL);if(!!errorMessage){this.errorMessage=errorMessage;this.isLikelyToBeSelfSignedCertificate=false;this.update();return}Promise.resolve().then(()=>store.action("endpoints.add",this.endpointURL)).then(()=>store.action("toasts.add",{message:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü„ÄÇ"})).then(()=>{this.close()}).catch(err=>{switch(err.status){case 404:this.errorMessage="„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ";break;default:this.errorMessage="„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíËøΩÂä†Âá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ";break}if(this.endpointURL.startsWith("https://")){this.isLikelyToBeSelfSignedCertificate=true}else{this.isLikelyToBeSelfSignedCertificate=false}this.update()})})};riot$1.tag2("viron-application-header-menu-entry",'<div class="Application_Header_Menu_Entry__title">ÁÆ°ÁêÜÁîªÈù¢„ÇíËøΩÂä†</div> <div class="Application_Header_Menu_Entry__message" if="{!!errorMessage}">{errorMessage}</div> <div class="Application_Header_Menu_Entry__selfSignedCertificate" if="{!!isLikelyToBeSelfSignedCertificate}" onclick="{getClickHandler(\'handleSelfSignedCertificateButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleSelfSignedCertificateButtonTap\')}">Self-Signed Certificate?</div> <div class="Application_Header_Menu_Entry__inputs"> <viron-textinput placeholder="URL„ÅÆÂÖ•Âäõ" val="{endpointURL}" onchange="{handleEndpointURLChange}"></viron-textinput> </div> <div class="Application_Header_Menu_Entry__control"> <viron-button label="ËøΩÂä†" onselect="{handleAddButtonSelect}"></viron-button> </div>',"",'class="Application_Header_Menu_Entry"',function(opts){this.external(script$59)});var script$60=function(){const store=this.riotx.get();const endpoints=store.getter("endpoints.allWithoutToken");this.handleExportButtonTap=(()=>{Promise.resolve().then(()=>{download(JSON.stringify(endpoints),"endpoints.json","application/json")}).then(()=>{this.close();return store.action("toasts.add",{message:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà‰∏ÄË¶ß„ÇíÊõ∏„ÅçÂá∫„Åó„Åæ„Åó„Åü„ÄÇ"})}).catch(err=>{this.close();return store.action("modals.add","viron-error",{error:err})})})};riot$1.tag2("viron-application-header-menu-export",'<div class="Application_Header_Menu_Export__title">„Éõ„Éº„É†„Çí‰øùÂ≠ò</div> <div class="Application_Header_Menu_Export__description">„Éõ„Éº„É†„ÅÆ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà‰∏ÄË¶ß„Çíjson„Éï„Ç°„Ç§„É´„Å®„Åó„Å¶Êõ∏„ÅçÂá∫„Åó„Åæ„Åô„ÄÇ</div> <div class="Application_Header_Menu_Export__control"> <viron-button label="‰øùÂ≠ò„Åô„Çã" onselect="{handleExportButtonTap}"></viron-button> </div>',"",'class="Application_Header_Menu_Export"',function(opts){this.external(script$60)});var script$61=function(){const store=this.riotx.get();this.errorMessage=null;this.endpoints=null;this.handleFileChange=(jsonFile=>{if(!jsonFile){this.errorMessage=null;this.endpoints=null;this.update();return}if(!store.getter("ua.isEdge")&&jsonFile.type!=="application/json"){this.errorMessage="JSONÂΩ¢Âºè„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ";this.endpoints=null;this.update();return}const reader=new FileReader;reader.readAsText(jsonFile);reader.onerror=(err=>{this.endpoints=null;this.errorMessage=err.message||"„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ";this.update()});reader.onload=(event=>{const text=event.target.result;try{this.endpoints=JSON.parse(text);this.errorMessage=""}catch(e){this.endpoints=null;this.errorMessage=e.message||"JSONÂΩ¢Âºè„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ"}finally{this.update()}})});this.handleImportButtonTap=(()=>{if(!this.endpoints){return}Promise.resolve().then(()=>store.action("endpoints.mergeAll",this.endpoints)).then(()=>{this.close();return store.action("toasts.add",{message:"„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü„ÄÇ"})}).catch(err=>{this.close();return store.action("modals.add","viron-error",{error:err})})})};riot$1.tag2("viron-application-header-menu-import",'<div class="Application_Header_Menu_Import__title">„Éõ„Éº„É†„ÇíË™≠„ÅøËæº„Åø</div> <div class="Application_Header_Menu_Import__description">„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà‰∏ÄË¶ß„Çí„Éõ„Éº„É†„Å´ÂèçÊò†„Åó„Åæ„Åô„ÄÇ</div> <div class="Application_Header_Menu_Import__error" if="{errorMessage}">{errorMessage}</div> <div class="Application_Header_Menu_Import__control"> <viron-uploader accept="application/json" onchange="{handleFileChange}"></viron-uploader> <viron-button label="Ë™≠„ÅøËæº„ÇÄ" isdisabled="{!endpoints}" onselect="{handleImportButtonTap}"></viron-button> </div>',"",'class="Application_Header_Menu_Import"',function(opts){this.external(script$61)});var script$56=function(){const store=this.riotx.get();const isDesktop=store.getter("layout.isDesktop");const generalActions=[{label:"„ÇØ„É¨„Ç∏„ÉÉ„Éà",id:"show_credit"},{label:"„Éò„É´„Éó",id:"navigate_to_doc"}];const endpointActions=[];endpointActions.push({label:"ËøΩÂä†",id:"add_endpoint"});if(isDesktop){endpointActions.push({label:"„Éõ„Éº„É†„Çí‰øùÂ≠ò",id:"export_endpoints"});endpointActions.push({label:"„Éõ„Éº„É†„ÇíË™≠„ÅøËæº„Åø",id:"import_endpoints"})}endpointActions.push({label:"ÂÖ®„Å¶„ÅÆ„Ç´„Éº„Éâ„ÇíÂâäÈô§",id:"remove_all_endpoints"});this.actions=[];switch(this.opts.type){case"general":this.actions=generalActions;break;case"endpoint":this.actions=endpointActions;break;default:break}this.showEntryModal=(()=>{store.action("modals.add","viron-application-header-menu-entry")});this.showExportModal=(()=>{store.action("modals.add","viron-application-header-menu-export")});this.showImportModal=(()=>{store.action("modals.add","viron-application-header-menu-import")});this.showClearModal=(()=>{store.action("modals.add","viron-application-header-menu-clear")});this.showCreditModal=(()=>{store.action("modals.add","viron-application-header-menu-credit")});this.handleActionSelect=(id=>{switch(id){case"show_credit":this.showCreditModal();this.close();break;case"navigate_to_doc":window.open("https://cam-inc.github.io/viron-doc/","_blank");this.close();break;case"add_endpoint":this.showEntryModal();this.close();break;case"export_endpoints":this.showExportModal();this.close();break;case"import_endpoints":this.showImportModal();this.close();break;case"remove_all_endpoints":this.showClearModal();this.close();break;default:this.close();break}})};riot$1.tag2("viron-application-header-menu",'<viron-list list="{actions}" size="{5}" onselect="{handleActionSelect}"></viron-list>',"",'class="Application_Header_Menu"',function(opts){this.external(script$56)});var script$53=function(){const store=this.riotx.get();this.isTopPage=store.getter("location.isTop");this.isMenuOpened=store.getter("application.isMenuOpened");this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.name=store.getter("viron.name");this.thumbnail=store.getter("viron.thumbnail");this.color=store.getter("viron.color");this.listen("location",()=>{this.isTopPage=store.getter("location.isTop");this.update()});this.listen("application",()=>{this.isMenuOpened=store.getter("application.isMenuOpened");this.update()});this.listen("layout",()=>{this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.update()});this.listen("viron",()=>{this.name=store.getter("viron.name");this.thumbnail=store.getter("viron.thumbnail");this.color=store.getter("viron.color");this.update()});this.handleMenuToggleButtonTap=(()=>{if(!this.isMobile){store.action("application.toggleMenu");return}store.action("modals.add","viron-application-menu",null,{isSpread:true})});this.handleSquareIconTap=(()=>{const rect=this.refs.squareIcon.root.getBoundingClientRect();store.action("popovers.add","viron-application-header-menu",{type:"endpoint"},{x:rect.left+rect.width/2,y:rect.bottom,width:228,direction:"TR"})});this.handleDotsIconTap=(()=>{const rect=this.refs.dotsIcon.root.getBoundingClientRect();store.action("popovers.add","viron-application-header-menu",{type:"general"},{x:rect.left+rect.width/2,y:rect.bottom,width:228,direction:"TR"})})};riot$1.tag2("viron-application-header",'<div class="Application_Header__item"> <virtual if="{isTopPage &amp;&amp; isDesktop}"> <viron-application-header-filter></viron-application-header-filter> </virtual> <virtual if="{!isTopPage}"> <virtual if="{isMenuOpened}"> <viron-icon-menu class="Application_Header__menuIcon" onclick="{getClickHandler(\'handleMenuToggleButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleMenuToggleButtonTap\')}"></viron-icon-menu> </virtual> <virtual if="{!isMenuOpened}"> <viron-icon-menu-invert class="Application_Header__menuIcon" onclick="{getClickHandler(\'handleMenuToggleButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleMenuToggleButtonTap\')}"></viron-icon-menu-invert> </virtual> </virtual> </div> <div class="Application_Header__item" if="{isMobile}"> <div class="Application_Header__thumbnail" riot-style="background-image:url({thumbnail});"></div> </div> <div class="Application_Header__item Application_Header__item--tail"> <virtual if="{isTopPage}"> <viron-icon-square class="Application_Header__squareIcon" ref="squareIcon" onclick="{getClickHandler(\'handleSquareIconTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleSquareIconTap\')}"></viron-icon-square> </virtual> <virtual if="{!isTopPage}"> <virtual if="{!isMobile}"> <div class="Application_Header__info"> <div class="Application_Header__color Application_Header__color--{color}"></div> <div class="Application_Header__name">{name}</div> <viron-icon-arrow-right class="Application_Header__arrow"></viron-icon-arrow-right> <div class="Application_Header__thumbnail" riot-style="background-image:url({thumbnail});"></div> </div> </virtual> </virtual> <viron-icon-dots class="Application_Header__dotsIcon" ref="dotsIcon" onclick="{getClickHandler(\'handleDotsIconTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleDotsIconTap\')}"></viron-icon-dots> </div>',"",'class="Application_Header"',function(opts){this.external(script$53)});var script$62=function(){const store=this.riotx.get();this.path=this.opts.tagopts.path;const fadeIn=()=>{setTimeout(()=>{this.isVisible=true;this.update()},100)};const fadeOut=()=>{this.isVisible=false;this.update();setTimeout(()=>{store.action("mediapreviews.remove",this.opts.id)},1e3)};this.on("mount",()=>{fadeIn();window.addEventListener("keydown",this.handleKeyDown)}).on("unmount",()=>{window.removeEventListener("keydown",this.handleKeyDown)});this.handleTap=(()=>{fadeOut()});this.handleFrameTap=(e=>{e.stopPropagation()});this.handleCloseButtonTap=(()=>{fadeOut()});this.handleKeyDown=(e=>{switch(e.keyCode){case 27:fadeOut();break;default:break}})};riot$1.tag2("viron-mediapreview",'<div class="Mediapreview__frame" onclick="{getClickHandler(\'handleFrameTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleFrameTap\')}"> <div class="Mediapreview__image" riot-style="background-image: url({path});"></div> <div class="Mediapreview__closeButton" onclick="{getClickHandler(\'handleCloseButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCloseButtonTap\')}"> <viron-icon-close></viron-icon-close> </div> </div>',"",'class="Mediapreview {isVisible ? \'Mediapreview--visible\' : \'\'} Mediapreview--{opts.mediapreviewopts.theme}" onclick="{getClickHandler(\'handleTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleTap\')}"',function(opts){this.external(script$62)});var script$63=function(){const store=this.riotx.get();this.mediapreviews=store.getter("mediapreviews.all");this.listen("mediapreviews",()=>{this.mediapreviews=store.getter("mediapreviews.all");this.update()})};riot$1.tag2("viron-application-mediapreviews",'<virtual each="{mediapreviews}"> <viron-mediapreview id="{id}" tagopts="{tagOpts}" mediapreviewopts="{mediapreviewOpts}"></viron-mediapreview> </virtual>',"",'class="Application_Mediapreviews"',function(opts){this.external(script$63)});var script$64=function(){const store=this.riotx.get();let tag;const fadeIn=()=>{setTimeout(()=>{this.isVisible=true;this.update()},100)};const fadeOut=()=>{this.isVisible=false;this.update();setTimeout(()=>{store.action("modals.remove",this.opts.id)},1e3)};this.layoutType=store.getter("layout.type");this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.update()});this.on("mount",()=>{tag=riot$1.mount(this.refs.content,this.opts.tagname,objectAssign({isModal:true,modalCloser:fadeOut},this.opts.tagopts))[0];fadeIn();window.addEventListener("keydown",this.handleKeyDown)}).on("before-unmount",()=>{tag.unmount(true)}).on("unmount",()=>{window.removeEventListener("keydown",this.handleKeyDown)});this.handleTap=(()=>{fadeOut()});this.handleFrameTap=(e=>{e.stopPropagation()});this.handleCloseButtonTap=(()=>{fadeOut()});this.handleKeyDown=(e=>{switch(e.keyCode){case 27:fadeOut();break;default:break}})};riot$1.tag2("viron-modal",'<div class="Modal__frame" onclick="{getClickHandler(\'handleFrameTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleFrameTap\')}"> <div class="Modal__closeButton" onclick="{getClickHandler(\'handleCloseButtonTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleCloseButtonTap\')}"> <viron-icon-close></viron-icon-close> </div> <div class="Modal__content" ref="content"></div> </div>',"","class=\"Modal {isVisible ? 'Modal--visible' : ''} Modal--{opts.modalopts.theme} Modal--{layoutType} {opts.modalopts.isSpread ? 'Modal--spread': ''}\" onclick=\"{getClickHandler('handleTap')}\" ontouchstart=\"{getTouchStartHandler()}\" ontouchmove=\"{getTouchMoveHandler()}\" ontouchend=\"{getTouchEndHandler('handleTap')}\"",function(opts){this.external(script$64)});var script$65=function(){const store=this.riotx.get();this.modals=store.getter("modals.all");this.listen("modals",()=>{this.modals=store.getter("modals.all");this.update()})};riot$1.tag2("viron-application-modals",'<virtual each="{modals}"> <viron-modal id="{id}" tagname="{tagName}" tagopts="{tagOpts}" modalopts="{modalOpts}"></viron-modal> </virtual>',"",'class="Application_Modals"',function(opts){this.external(script$65)});const isTouchEventSupported$1="ontouchstart"in document;var script$66=function(){const store=this.riotx.get();let tag;const fadeIn=()=>{setTimeout(()=>{this.isVisible=true;this.update()},100)};const fadeOut=()=>{this.isVisible=false;this.update();setTimeout(()=>{store.action("popovers.remove",this.opts.id)},1e3)};this.isVisible=false;this.on("mount",()=>{tag=riot$1.mount(this.refs.content,this.opts.tagname,objectAssign({isPopover:true,popoverCloser:fadeOut},this.opts.tagopts))[0];fadeIn();window.addEventListener("resize",this.handleWindowResize);window.addEventListener("scroll",this.handleWindowScroll);window.addEventListener("click",this.handleWindowClick);window.addEventListener("touchend",this.handleWindowTouchEnd)}).on("before-unmount",()=>{tag.unmount(true)}).on("unmount",()=>{window.removeEventListener("resize",this.handleWindowResize);window.removeEventListener("scroll",this.handleWindowScroll);window.removeEventListener("click",this.handleWindowClick);window.removeEventListener("touchend",this.handleWindowTouchend)});this.getPosition=(()=>{const opts=this.opts.popoveropts;const styles=[];styles.push(`left:${opts.x}px;`);styles.push(`top:${opts.y}px;`);return styles.join("")});this.getSize=(()=>{const opts=this.opts.popoveropts;const styles=[];styles.push(`width:${opts.width}px;`);if(!!opts.height){styles.push(`height:${opts.height}px;`)}return styles.join("")});this.handleFrameInnerTap=(e=>{e.stopPropagation()});this.handleFrameInnerScroll=(e=>{e.stopPropagation()});this.handleWindowResize=(()=>{fadeOut()});this.handleWindowScroll=(()=>{fadeOut()});this.handleWindowClick=(()=>{if(isTouchEventSupported$1){return}fadeOut()});this.handleWindowTouchEnd=(()=>{fadeOut()})};riot$1.tag2("viron-popover",'<div class="Popover__frameOuter"> <div class="Popover__frameInner" riot-style="{getSize()};" onclick="{getClickHandler(\'handleFrameInnerTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleFrameInnerTap\')}" onscroll="{handleFrameInnerScroll}"> <div class="Popover__content" ref="content"></div> </div> </div> <div class="Popover__arrow"></div>',"","class=\"Popover {isVisible ? 'Popover--visible' : ''} Popover--{opts.popoveropts.direction}\" riot-style=\"{getPosition()};\"",function(opts){this.external(script$66)});var script$67=function(){const store=this.riotx.get();let tag;const fadeIn=()=>{setTimeout(()=>{this.isVisible=true;this.update()},100)};const fadeOut=()=>{this.isVisible=false;this.update();setTimeout(()=>{store.action("popovers.remove",this.opts.id)},1e3)};this.on("mount",()=>{tag=riot$1.mount(this.refs.content,this.opts.tagname,objectAssign({isPopover:true,popoverCloser:fadeOut},this.opts.tagopts))[0];fadeIn();window.addEventListener("keydown",this.handleKeyDown);window.addEventListener("resize",this.handleWindowResize)}).on("before-unmount",()=>{tag.unmount(true)}).on("unmount",()=>{window.removeEventListener("keydown",this.handleKeyDown);window.removeEventListener("resize",this.handleWindowResize)});this.handleTap=(()=>{fadeOut()});this.handleFrameTap=(e=>{e.stopPropagation()});this.handleKeyDown=(e=>{switch(e.keyCode){case 27:fadeOut();break;default:break}});this.handleWindowResize=(()=>{fadeOut()})};riot$1.tag2("viron-popover-spread",'<div class="PopoverSpread__frame" onclick="{getClickHandler(\'handleFrameTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleFrameTap\')}"> <div class="PopoverSpread__content" ref="content"></div> </div>',"",'class="PopoverSpread {isVisible ? \'PopoverSpread--visible\' : \'\'}" onclick="{getClickHandler(\'handleTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleTap\')}"',function(opts){this.external(script$67)});var script$68=function(){const store=this.riotx.get();this.popovers=store.getter("popovers.all");this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.listen("popovers",()=>{this.popovers=store.getter("popovers.all");this.update()});this.listen("layout",()=>{this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.update()})};riot$1.tag2("viron-application-popovers",'<virtual each="{popovers}"> <virtual if="{isDesktop}"> <viron-popover id="{id}" tagname="{tagName}" tagopts="{tagOpts}" popoveropts="{popoverOpts}"></viron-popover> </virtual> <virtual if="{isMobile}"> <viron-popover-spread id="{id}" tagname="{tagName}" tagopts="{tagOpts}" popoveropts="{popoverOpts}"></viron-popover-spread> </virtual> </virtual>',"",'class="Application_Popovers"',function(opts){this.external(script$68)});var script$69=function(){};riot$1.tag2("viron-application-poster",'<div class="Application_Poster__bg"></div> <div class="Application_Poster__overlay"></div> <div class="Application_Poster__content"> <viron-icon-logo class="Application_Poster__logo"></viron-icon-logo> <div>„Éõ„Éº„É†</div> </div>',"",'class="Application_Poster"',function(opts){this.external(script$69)});var script$70=function(){this.isAnimating=this.opts.isactive;this.on("update",()=>{if(this.opts.isactive){this.isAnimating=true}else if(this.isAnimating){setTimeout(()=>{this.isAnimating=false;this.update()},300)}})};riot$1.tag2("viron-application-progress-linear",'<div class="Application_ProgressLinear__bar"> <div class="Application_ProgressLinear__particle"></div> <div class="Application_ProgressLinear__particle"></div> </div>',"","class=\"Application_ProgressLinear {'Application_ProgressLinear--visible' : opts.isactive, 'Application_ProgressLinear--animating' : isAnimating}\"",function(opts){this.external(script$70)});var script$71=function(){};riot$1.tag2("viron-application-splash",'<div class="Application_Splash__container"> <viron-icon-logo class="Application_Splash__logo"></viron-icon-logo> <div class="Application_Splash__label">Viron</div> </div>',"",'class="Application_Splash"',function(opts){this.external(script$71)});var script$72=function(){const store=this.riotx.get();let autoHideTimerID;this.isVisible=false;const show=()=>{setTimeout(()=>{this.isVisible=true;this.update()},100)};const hide=()=>{this.isVisible=false;this.update();setTimeout(()=>{store.action("toasts.remove",this.opts.id)},1e3)};this.on("mount",()=>{show();if(this.opts.autohide){autoHideTimerID=setTimeout(()=>{hide()},this.opts.timeout)}}).on("unmount",()=>{clearTimeout(autoHideTimerID)});this.handleTap=(()=>{clearTimeout(autoHideTimerID);hide()})};riot$1.tag2("viron-toast",'<div class="Toast__message">{opts.message}</div>',"",'class="Toast {\'Toast--visible\' : isVisible, \'Toast--error\' : opts.iserror}" onclick="{getClickHandler(\'handleTap\')}" ontouchstart="{getTouchStartHandler()}" ontouchmove="{getTouchMoveHandler()}" ontouchend="{getTouchEndHandler(\'handleTap\')}"',function(opts){this.external(script$72)});var script$73=function(){const store=this.riotx.get();this.toasts=store.getter("toasts.all");this.listen("toasts",()=>{this.toasts=store.getter("toasts.all");this.update()})};riot$1.tag2("viron-application-toasts",'<virtual each="{toasts}"> <viron-toast id="{id}" message="{message}" autohide="{autoHide}" timeout="{timeout}" iserror="{isError}"></viron-toast> </virtual>',"",'class="Application_Toasts"',function(opts){this.external(script$73)});var script$74=function(){const store=this.riotx.get();this.isLaunched=store.getter("application.isLaunched");this.isNavigating=store.getter("application.isNavigating");this.isNetworking=store.getter("application.isNetworking");this.theme=store.getter("viron.theme");this.pageName=store.getter("location.name");this.isTopPage=store.getter("location.isTop");this.pageRoute=store.getter("location.route");this.endpointsCount=store.getter("endpoints.one");this.endpointFilterText=store.getter("application.endpointFilterText");this.usingBrowser=store.getter("ua.usingBrowser");this.layoutType=store.getter("layout.type");this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.isAsideClosed=!store.getter("location.isTop")&&!store.getter("application.isMenuOpened");this.listen("application",()=>{this.isLaunched=store.getter("application.isLaunched");if(this.isNavigating&&!store.getter("application.isNavigating")){this.refs.main.scrollTop=0}this.isNavigating=store.getter("application.isNavigating");this.isNetworking=store.getter("application.isNetworking");this.endpointFilterText=store.getter("application.endpointFilterText");this.isAsideClosed=!store.getter("location.isTop")&&!store.getter("application.isMenuOpened");this.update()});this.listen("viron",()=>{this.theme=store.getter("viron.theme");this.update()});this.listen("location",()=>{this.pageName=store.getter("location.name");this.isTopPage=store.getter("location.isTop");this.pageRoute=store.getter("location.route");this.isAsideClosed=!store.getter("location.isTop")&&!store.getter("application.isMenuOpened");this.update()});this.listen("endpoints",()=>{this.endpointsCount=store.getter("endpoints.count");this.update()});this.listen("ua",()=>{this.usingBrowser=store.getter("ua.usingBrowser");this.update()});this.listen("layout",()=>{this.layoutType=store.getter("layout.type");this.isDesktop=store.getter("layout.isDesktop");this.isMobile=store.getter("layout.isMobile");this.update()});const handleResize=throttle_1(()=>{const width=window.innerWidth;const height=window.innerHeight;store.action("layout.updateSize",width,height)},1e3);this.on("mount",()=>{window.addEventListener("resize",handleResize)}).on("unmount",()=>{window.removeEventListener("resize",handleResize)})};riot$1.tag2("viron",'<div class="Application__container"> <div class="Application__aside" if="{isDesktop}"> <div class="Application__asideAdjuster"> <div class="Application__asideContent"> <viron-application-poster if="{isTopPage}"></viron-application-poster> <viron-application-menu if="{!isTopPage}"></viron-application-menu> </div> </div> </div> <div class="Application__header"> <viron-application-header></viron-application-header> </div> <div class="Application__main" ref="main"> <div class="Application__page"> <div data-is="viron-{pageName}-page" route="{pageRoute}"></div> </div> </div> </div> <viron-application-drawers></viron-application-drawers> <viron-application-mediapreviews></viron-application-mediapreviews> <viron-application-modals></viron-application-modals> <viron-application-popovers></viron-application-popovers> <viron-application-toasts></viron-application-toasts> <viron-application-progress-linear isactive="{isNavigating || isNetworking}"></viron-application-progress-linear> <viron-application-dimmer if="{isNavigating}"></viron-application-dimmer> <viron-application-blocker if="{isNavigating}"></viron-application-blocker> <viron-application-splash if="{!isLaunched}"></viron-application-splash>',"","class=\"Application Application--{usingBrowser} Application--{layoutType} Application--{theme} {isAsideClosed ? 'Application--asideClosed' : ''}\"",function(opts){this.external(script$74)});window.addEventListener("load",()=>{let mainStore;Promise.resolve().then(()=>i18n.init()).then(()=>mixin.init()).then(()=>store.init()).then(store$$1=>{mainStore=store$$1;window.store=store$$1}).then(()=>{riot$1.mount("viron")}).then(()=>mainStore.action("endpoints.cleanup")).then(()=>Promise.all([mainStore.action("endpoints.tidyUpOrder"),mainStore.action("ua.setup")])).then(()=>router.init(mainStore)).catch(err=>mainStore.action("modals.add","viron-error",{message:"VironËµ∑Âãï„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇVironÊãÖÂΩìËÄÖ„Å´„ÅäÂïè„ÅÑÂêà„Çè„Åõ‰∏ã„Åï„ÅÑ„ÄÇ",error:err}))})})();
//# sourceMappingURL=app.min.js.map